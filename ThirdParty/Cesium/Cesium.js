(function(){var requirejs,require,define;(function(e){var t,r,i,n,a={},o={},s={},u={},l=Object.prototype.hasOwnProperty,c=[].slice,d=/\.js$/;function f(e,t){return l.call(e,t)}function h(e,t){var r,i,n,a,o,u,l,c,f,h,p,m,v=t&&t.split("/"),_=s.map,g=_&&_["*"]||{};if(e){e=e.split("/");o=e.length-1;if(s.nodeIdCompat&&d.test(e[o])){e[o]=e[o].replace(d,"")}if(e[0].charAt(0)==="."&&v){m=v.slice(0,v.length-1);e=m.concat(e)}for(f=0;f<e.length;f++){p=e[f];if(p==="."){e.splice(f,1);f-=1}else if(p===".."){if(f===0||f===1&&e[2]===".."||e[f-1]===".."){continue}else if(f>0){e.splice(f-1,2);f-=2}}}e=e.join("/")}if((v||g)&&_){r=e.split("/");for(f=r.length;f>0;f-=1){i=r.slice(0,f).join("/");if(v){for(h=v.length;h>0;h-=1){n=_[v.slice(0,h).join("/")];if(n){n=n[i];if(n){a=n;u=f;break}}}}if(a){break}if(!l&&g&&g[i]){l=g[i];c=f}}if(!a&&l){a=l;u=c}if(a){r.splice(0,u,a);e=r.join("/")}}return e}function p(t,i){return function(){var n=c.call(arguments,0);if(typeof n[0]!=="string"&&n.length===1){n.push(null)}return r.apply(e,n.concat([t,i]))}}function m(e){return function(t){return h(t,e)}}function v(e){return function(t){a[e]=t}}function _(r){if(f(o,r)){var i=o[r];delete o[r];u[r]=true;t.apply(e,i)}if(!f(a,r)&&!f(u,r)){throw new Error("No "+r)}return a[r]}function g(e){var t,r=e?e.indexOf("!"):-1;if(r>-1){t=e.substring(0,r);e=e.substring(r+1,e.length)}return[t,e]}function y(e){return e?g(e):[]}i=function(e,t){var r,i=g(e),n=i[0],a=t[1];e=i[1];if(n){n=h(n,a);r=_(n)}if(n){if(r&&r.normalize){e=r.normalize(e,m(a))}else{e=h(e,a)}}else{e=h(e,a);i=g(e);n=i[0];e=i[1];if(n){r=_(n)}}return{f:n?n+"!"+e:e,n:e,pr:n,p:r}};function w(e){return function(){return s&&s.config&&s.config[e]||{}}}n={require:function(e){return p(e)},exports:function(e){var t=a[e];if(typeof t!=="undefined"){return t}else{return a[e]={}}},module:function(e){return{id:e,uri:"",exports:a[e],config:w(e)}}};t=function(t,r,s,l){var c,d,h,m,g,w,C=[],b=typeof s,S;l=l||t;w=y(l);if(b==="undefined"||b==="function"){r=!r.length&&s.length?["require","exports","module"]:r;for(g=0;g<r.length;g+=1){m=i(r[g],w);d=m.f;if(d==="require"){C[g]=n.require(t)}else if(d==="exports"){C[g]=n.exports(t);S=true}else if(d==="module"){c=C[g]=n.module(t)}else if(f(a,d)||f(o,d)||f(u,d)){C[g]=_(d)}else if(m.p){m.p.load(m.n,p(l,true),v(d),{});C[g]=a[d]}else{throw new Error(t+" missing "+d)}}h=s?s.apply(a[t],C):undefined;if(t){if(c&&c.exports!==e&&c.exports!==a[t]){a[t]=c.exports}else if(h!==e||!S){a[t]=h}}}else if(t){a[t]=s}};requirejs=require=r=function(a,o,u,l,c){if(typeof a==="string"){if(n[a]){return n[a](o)}return _(i(a,y(o)).f)}else if(!a.splice){s=a;if(s.deps){r(s.deps,s.callback)}if(!o){return}if(o.splice){a=o;o=u;u=null}else{a=e}}o=o||function(){};if(typeof u==="function"){u=l;l=c}if(l){t(e,a,o,u)}else{setTimeout(function(){t(e,a,o,u)},4)}return r};r.config=function(e){return r(e)};requirejs._defined=a;define=function(e,t,r){if(typeof e!=="string"){throw new Error("See almond README: incorrect module build, no module name")}if(!t.splice){r=t;t=[]}if(!f(a,e)&&!f(o,e)){o[e]=[e,t,r]}};define.amd={jQuery:true}})();define("Core/appendForwardSlash",[],function(){"use strict";function e(e){if(e.length===0||e[e.length-1]!=="/"){e=e+"/"}return e}return e});define("Core/defined",[],function(){"use strict";function e(e){return e!==undefined&&e!==null}return e});define("Core/freezeObject",["./defined"],function(e){"use strict";var t=Object.freeze;if(!e(t)){t=function(e){return e}}return t});define("Core/defaultValue",["./freezeObject"],function(e){"use strict";function t(e,t){if(e!==undefined){return e}return t}t.EMPTY_OBJECT=e({});return t});define("Core/DeveloperError",["./defined"],function(e){"use strict";function t(e){this.name="DeveloperError";this.message=e;var t;try{throw new Error}catch(e){t=e.stack}this.stack=t}if(e(Object.create)){t.prototype=Object.create(Error.prototype);t.prototype.constructor=t}t.prototype.toString=function(){var t=this.name+": "+this.message;if(e(this.stack)){t+="\n"+this.stack.toString()}return t};t.throwInstantiationError=function(){throw new t("This function defines an interface and should not be called directly.")};return t});define("Core/arrayFill",["./defaultValue","./defined","./DeveloperError"],function(e,t,r){"use strict";function i(i,n,a,o){if(!t(i)||typeof i!=="object"){throw new r("array is required.")}if(!t(n)){throw new r("value is required.")}if(t(a)&&typeof a!=="number"){throw new r("start must be a valid index.")}if(t(o)&&typeof o!=="number"){throw new r("end must be a valid index.")}if(typeof i.fill==="function"){return i.fill(n,a,o)}var s=i.length>>>0;var u=e(a,0);var l=u<0?Math.max(s+u,0):Math.min(u,s);var c=e(o,s);var d=c<0?Math.max(s+c,0):Math.min(c,s);while(l<d){i[l]=n;l++}return i}return i});define("ThirdParty/mersenne-twister",[],function(){var e=function(e){if(e==undefined){e=(new Date).getTime()}this.N=624;this.M=397;this.MATRIX_A=2567483615;this.UPPER_MASK=2147483648;this.LOWER_MASK=2147483647;this.mt=new Array(this.N);this.mti=this.N+1;this.init_genrand(e)};e.prototype.init_genrand=function(e){this.mt[0]=e>>>0;for(this.mti=1;this.mti<this.N;this.mti++){var e=this.mt[this.mti-1]^this.mt[this.mti-1]>>>30;this.mt[this.mti]=(((e&4294901760)>>>16)*1812433253<<16)+(e&65535)*1812433253+this.mti;this.mt[this.mti]>>>=0}};e.prototype.genrand_int32=function(){var e;var t=new Array(0,this.MATRIX_A);if(this.mti>=this.N){var r;if(this.mti==this.N+1)this.init_genrand(5489);for(r=0;r<this.N-this.M;r++){e=this.mt[r]&this.UPPER_MASK|this.mt[r+1]&this.LOWER_MASK;this.mt[r]=this.mt[r+this.M]^e>>>1^t[e&1]}for(;r<this.N-1;r++){e=this.mt[r]&this.UPPER_MASK|this.mt[r+1]&this.LOWER_MASK;this.mt[r]=this.mt[r+(this.M-this.N)]^e>>>1^t[e&1]}e=this.mt[this.N-1]&this.UPPER_MASK|this.mt[0]&this.LOWER_MASK;this.mt[this.N-1]=this.mt[this.M-1]^e>>>1^t[e&1];this.mti=0}e=this.mt[this.mti++];e^=e>>>11;e^=e<<7&2636928640;e^=e<<15&4022730752;e^=e>>>18;return e>>>0};e.prototype.random=function(){return this.genrand_int32()*(1/4294967296)};return e});define("Core/Math",["../ThirdParty/mersenne-twister","./defaultValue","./defined","./DeveloperError"],function(e,t,r,i){"use strict";var n={};n.EPSILON1=.1;n.EPSILON2=.01;n.EPSILON3=.001;n.EPSILON4=1e-4;n.EPSILON5=1e-5;n.EPSILON6=1e-6;n.EPSILON7=1e-7;n.EPSILON8=1e-8;n.EPSILON9=1e-9;n.EPSILON10=1e-10;n.EPSILON11=1e-11;n.EPSILON12=1e-12;n.EPSILON13=1e-13;n.EPSILON14=1e-14;n.EPSILON15=1e-15;n.EPSILON16=1e-16;n.EPSILON17=1e-17;n.EPSILON18=1e-18;n.EPSILON19=1e-19;n.EPSILON20=1e-20;n.GRAVITATIONALPARAMETER=3986004418e5;n.SOLAR_RADIUS=6955e5;n.LUNAR_RADIUS=1737400;n.SIXTY_FOUR_KILOBYTES=64*1024;n.sign=function(e){if(e>0){return 1}if(e<0){return-1}return 0};n.signNotZero=function(e){return e<0?-1:1};n.toSNorm=function(e,r){r=t(r,255);return Math.round((n.clamp(e,-1,1)*.5+.5)*r)};n.fromSNorm=function(e,r){r=t(r,255);return n.clamp(e,0,r)/r*2-1};n.sinh=function(e){var t=Math.pow(Math.E,e);var r=Math.pow(Math.E,-1*e);return(t-r)*.5};n.cosh=function(e){var t=Math.pow(Math.E,e);var r=Math.pow(Math.E,-1*e);return(t+r)*.5};n.lerp=function(e,t,r){return(1-r)*e+r*t};n.PI=Math.PI;n.ONE_OVER_PI=1/Math.PI;n.PI_OVER_TWO=Math.PI*.5;n.PI_OVER_THREE=Math.PI/3;n.PI_OVER_FOUR=Math.PI/4;n.PI_OVER_SIX=Math.PI/6;n.THREE_PI_OVER_TWO=3*Math.PI*.5;n.TWO_PI=2*Math.PI;n.ONE_OVER_TWO_PI=1/(2*Math.PI);n.RADIANS_PER_DEGREE=Math.PI/180;n.DEGREES_PER_RADIAN=180/Math.PI;n.RADIANS_PER_ARCSECOND=n.RADIANS_PER_DEGREE/3600;n.toRadians=function(e){if(!r(e)){throw new i("degrees is required.")}return e*n.RADIANS_PER_DEGREE};n.toDegrees=function(e){if(!r(e)){throw new i("radians is required.")}return e*n.DEGREES_PER_RADIAN};n.convertLongitudeRange=function(e){if(!r(e)){throw new i("angle is required.")}var t=n.TWO_PI;var a=e-Math.floor(e/t)*t;if(a<-Math.PI){return a+t}if(a>=Math.PI){return a-t}return a};n.clampToLatitudeRange=function(e){if(!r(e)){throw new i("angle is required.")}return n.clamp(e,-1*n.PI_OVER_TWO,n.PI_OVER_TWO)};n.negativePiToPi=function(e){if(!r(e)){throw new i("angle is required.")}return n.zeroToTwoPi(e+n.PI)-n.PI};n.zeroToTwoPi=function(e){if(!r(e)){throw new i("angle is required.")}var t=n.mod(e,n.TWO_PI);if(Math.abs(t)<n.EPSILON14&&Math.abs(e)>n.EPSILON14){return n.TWO_PI}return t};n.mod=function(e,t){if(!r(e)){throw new i("m is required.")}if(!r(t)){throw new i("n is required.")}return(e%t+t)%t};n.equalsEpsilon=function(e,n,a,o){if(!r(e)){throw new i("left is required.")}if(!r(n)){throw new i("right is required.")}if(!r(a)){throw new i("relativeEpsilon is required.")}o=t(o,a);var s=Math.abs(e-n);return s<=o||s<=a*Math.max(Math.abs(e),Math.abs(n))};var a=[1];n.factorial=function(e){if(typeof e!=="number"||e<0){throw new i("A number greater than or equal to 0 is required.")}var t=a.length;if(e>=t){var r=a[t-1];for(var n=t;n<=e;n++){a.push(r*n)}}return a[e]};n.incrementWrap=function(e,n,a){a=t(a,0);if(!r(e)){throw new i("n is required.")}if(n<=a){throw new i("maximumValue must be greater than minimumValue.")}++e;if(e>n){e=a}return e};n.isPowerOfTwo=function(e){if(typeof e!=="number"||e<0){throw new i("A number greater than or equal to 0 is required.")}return e!==0&&(e&e-1)===0};n.nextPowerOfTwo=function(e){if(typeof e!=="number"||e<0){throw new i("A number greater than or equal to 0 is required.")}--e;e|=e>>1;e|=e>>2;e|=e>>4;e|=e>>8;e|=e>>16;++e;return e};n.clamp=function(e,t,n){if(!r(e)){throw new i("value is required")}if(!r(t)){throw new i("min is required.")}if(!r(n)){throw new i("max is required.")}return e<t?t:e>n?n:e};var o=new e;n.setRandomNumberSeed=function(t){if(!r(t)){throw new i("seed is required.")}o=new e(t)};n.nextRandomNumber=function(){return o.random()};n.acosClamped=function(e){if(!r(e)){throw new i("value is required.")}return Math.acos(n.clamp(e,-1,1))};n.asinClamped=function(e){if(!r(e)){throw new i("value is required.")}return Math.asin(n.clamp(e,-1,1))};n.chordLength=function(e,t){if(!r(e)){throw new i("angle is required.")}if(!r(t)){throw new i("radius is required.")}return 2*t*Math.sin(e*.5)};n.logBase=function(e,t){if(!r(e)){throw new i("number is required.")}if(!r(t)){throw new i("base is required.")}return Math.log(e)/Math.log(t)};n.fog=function(e,t){var r=e*t;return 1-Math.exp(-(r*r))};return n});define("Core/arrayRemoveDuplicates",["./defaultValue","./defined","./DeveloperError","./Math"],function(e,t,r,i){"use strict";var n=i.EPSILON10;function a(i,a,o){if(!t(a)){throw new r("equalsEpsilon is required.")}if(!t(i)){return undefined}o=e(o,false);var s=i.length;if(s<2){return i}var u;var l;var c;for(u=1;u<s;++u){l=i[u-1];c=i[u];if(a(l,c,n)){break}}if(u===s){if(o&&a(i[0],i[i.length-1],n)){return i.slice(1)}return i}var d=i.slice(0,u);for(;u<s;++u){c=i[u];if(!a(l,c,n)){d.push(c);l=c}}if(o&&d.length>1&&a(d[0],d[d.length-1],n)){d.shift()}return d}return a});define("Core/defineProperties",["./defined"],function(e){"use strict";var t=function(){try{return"x"in Object.defineProperty({},"x",{})}catch(e){return false}}();var r=Object.defineProperties;if(!t||!e(r)){r=function(e){return e}}return r});define("Core/AssociativeArray",["./defined","./defineProperties","./DeveloperError"],function(e,t,r){"use strict";function i(){this._array=[];this._hash={}}t(i.prototype,{length:{get:function(){return this._array.length}},values:{get:function(){return this._array}}});i.prototype.contains=function(t){if(typeof t!=="string"&&typeof t!=="number"){throw new r("key is required to be a string or number.")}return e(this._hash[t])};i.prototype.set=function(e,t){if(typeof e!=="string"&&typeof e!=="number"){throw new r("key is required to be a string or number.")}var i=this._hash[e];if(t!==i){this.remove(e);this._hash[e]=t;this._array.push(t)}};i.prototype.get=function(e){if(typeof e!=="string"&&typeof e!=="number"){throw new r("key is required to be a string or number.")}return this._hash[e]};i.prototype.remove=function(t){if(e(t)&&typeof t!=="string"&&typeof t!=="number"){throw new r("key is required to be a string or number.")}var i=this._hash[t];var n=e(i);if(n){var a=this._array;a.splice(a.indexOf(i),1);delete this._hash[t]}return n};i.prototype.removeAll=function(){var e=this._array;if(e.length>0){this._hash={};e.length=0}};return i});define("Core/Check",["./defined","./DeveloperError"],function(e,t){"use strict";var r={};r.typeOf={};function i(e){return e+" is required, actual value was undefined"}function n(e,t,r){return"Expected "+r+" to be typeof "+t+", actual typeof was "+e}r.defined=function(r,n){if(!e(n)){throw new t(i(r))}};r.typeOf.func=function(e,r){if(typeof r!=="function"){throw new t(n(typeof r,"function",e))}};r.typeOf.string=function(e,r){if(typeof r!=="string"){throw new t(n(typeof r,"string",e))}};r.typeOf.number=function(e,r){if(typeof r!=="number"){throw new t(n(typeof r,"number",e))}};r.typeOf.number.lessThan=function(e,i,n){r.typeOf.number(e,i);if(i>=n){throw new t("Expected "+e+" to be less than "+n+", actual value was "+i)}};r.typeOf.number.lessThanOrEquals=function(e,i,n){r.typeOf.number(e,i);if(i>n){throw new t("Expected "+e+" to be less than or equal to "+n+", actual value was "+i)}};r.typeOf.number.greaterThan=function(e,i,n){r.typeOf.number(e,i);if(i<=n){throw new t("Expected "+e+" to be greater than "+n+", actual value was "+i)}};r.typeOf.number.greaterThanOrEquals=function(e,i,n){r.typeOf.number(e,i);if(i<n){throw new t("Expected "+e+" to be greater than or equal to"+n+", actual value was "+i)}};r.typeOf.object=function(e,r){if(typeof r!=="object"){throw new t(n(typeof r,"object",e))}};r.typeOf.bool=function(e,r){if(typeof r!=="boolean"){throw new t(n(typeof r,"boolean",e))}};return r});define("Core/Cartesian2",["./Check","./defaultValue","./defined","./DeveloperError","./freezeObject","./Math"],function(e,t,r,i,n,a){"use strict";function o(e,r){this.x=t(e,0);this.y=t(r,0)}o.fromElements=function(e,t,i){if(!r(i)){return new o(e,t)}i.x=e;i.y=t;return i};o.clone=function(e,t){if(!r(e)){return undefined}if(!r(t)){return new o(e.x,e.y)}t.x=e.x;t.y=e.y;return t};o.fromCartesian3=o.clone;o.fromCartesian4=o.clone;o.packedLength=2;o.pack=function(r,i,n){e.typeOf.object("value",r);e.defined("array",i);n=t(n,0);i[n++]=r.x;i[n]=r.y;return i};o.unpack=function(i,n,a){e.defined("array",i);n=t(n,0);if(!r(a)){a=new o}a.x=i[n++];a.y=i[n];return a};o.packArray=function(t,i){e.defined("array",t);var n=t.length;if(!r(i)){i=new Array(n*2)}else{i.length=n*2}for(var a=0;a<n;++a){o.pack(t[a],i,a*2)}return i};o.unpackArray=function(t,i){e.defined("array",t);var n=t.length;if(!r(i)){i=new Array(n/2)}else{i.length=n/2}for(var a=0;a<n;a+=2){var s=a/2;i[s]=o.unpack(t,a,i[s])}return i};o.fromArray=o.unpack;o.maximumComponent=function(t){e.typeOf.object("cartesian",t);return Math.max(t.x,t.y)};o.minimumComponent=function(t){e.typeOf.object("cartesian",t);return Math.min(t.x,t.y)};o.minimumByComponent=function(t,r,i){e.typeOf.object("first",t);e.typeOf.object("second",r);e.typeOf.object("result",i);i.x=Math.min(t.x,r.x);i.y=Math.min(t.y,r.y);return i};o.maximumByComponent=function(t,r,i){e.typeOf.object("first",t);e.typeOf.object("second",r);e.typeOf.object("result",i);i.x=Math.max(t.x,r.x);i.y=Math.max(t.y,r.y);return i};o.magnitudeSquared=function(t){e.typeOf.object("cartesian",t);return t.x*t.x+t.y*t.y};o.magnitude=function(e){return Math.sqrt(o.magnitudeSquared(e))};var s=new o;o.distance=function(e,t){if(!r(e)||!r(t)){throw new i("left and right are required.")}o.subtract(e,t,s);return o.magnitude(s)};o.distanceSquared=function(e,t){if(!r(e)||!r(t)){throw new i("left and right are required.")}o.subtract(e,t,s);return o.magnitudeSquared(s)};o.normalize=function(t,r){e.typeOf.object("cartesian",t);e.typeOf.object("result",r);var n=o.magnitude(t);r.x=t.x/n;r.y=t.y/n;if(isNaN(r.x)||isNaN(r.y)){throw new i("normalized result is not a number")}return r};o.dot=function(t,r){e.typeOf.object("left",t);e.typeOf.object("right",r);return t.x*r.x+t.y*r.y};o.multiplyComponents=function(t,r,i){e.typeOf.object("left",t);e.typeOf.object("right",r);e.typeOf.object("result",i);i.x=t.x*r.x;i.y=t.y*r.y;return i};o.divideComponents=function(t,r,i){e.typeOf.object("left",t);e.typeOf.object("right",r);e.typeOf.object("result",i);i.x=t.x/r.x;i.y=t.y/r.y;return i};o.add=function(t,r,i){e.typeOf.object("left",t);e.typeOf.object("right",r);e.typeOf.object("result",i);i.x=t.x+r.x;i.y=t.y+r.y;return i};o.subtract=function(t,r,i){e.typeOf.object("left",t);e.typeOf.object("right",r);e.typeOf.object("result",i);i.x=t.x-r.x;i.y=t.y-r.y;return i};o.multiplyByScalar=function(t,r,i){e.typeOf.object("cartesian",t);e.typeOf.number("scalar",r);e.typeOf.object("result",i);i.x=t.x*r;i.y=t.y*r;return i};o.divideByScalar=function(t,r,i){e.typeOf.object("cartesian",t);e.typeOf.number("scalar",r);e.typeOf.object("result",i);i.x=t.x/r;i.y=t.y/r;return i};o.negate=function(t,r){e.typeOf.object("cartesian",t);e.typeOf.object("result",r);r.x=-t.x;r.y=-t.y;return r};o.abs=function(t,r){e.typeOf.object("cartesian",t);e.typeOf.object("result",r);r.x=Math.abs(t.x);r.y=Math.abs(t.y);return r};var u=new o;o.lerp=function(t,r,i,n){e.typeOf.object("start",t);e.typeOf.object("end",r);e.typeOf.number("t",i);e.typeOf.object("result",n);o.multiplyByScalar(r,i,u);n=o.multiplyByScalar(t,1-i,n);return o.add(u,n,n)};var l=new o;var c=new o;o.angleBetween=function(t,r){e.typeOf.object("left",t);e.typeOf.object("right",r);o.normalize(t,l);o.normalize(r,c);return a.acosClamped(o.dot(l,c))};var d=new o;o.mostOrthogonalAxis=function(t,r){e.typeOf.object("cartesian",t);e.typeOf.object("result",r);var i=o.normalize(t,d);o.abs(i,i);if(i.x<=i.y){r=o.clone(o.UNIT_X,r)}else{r=o.clone(o.UNIT_Y,r)}return r};o.equals=function(e,t){return e===t||r(e)&&r(t)&&e.x===t.x&&e.y===t.y};o.equalsArray=function(e,t,r){return e.x===t[r]&&e.y===t[r+1]};o.equalsEpsilon=function(e,t,i,n){return e===t||r(e)&&r(t)&&a.equalsEpsilon(e.x,t.x,i,n)&&a.equalsEpsilon(e.y,t.y,i,n)};o.ZERO=n(new o(0,0));o.UNIT_X=n(new o(1,0));o.UNIT_Y=n(new o(0,1));o.prototype.clone=function(e){return o.clone(this,e)};o.prototype.equals=function(e){return o.equals(this,e)};o.prototype.equalsEpsilon=function(e,t,r){return o.equalsEpsilon(this,e,t,r)};o.prototype.toString=function(){return"("+this.x+", "+this.y+")"};return o});define("Core/Cartesian3",["./Check","./defaultValue","./defined","./DeveloperError","./freezeObject","./Math"],function(e,t,r,i,n,a){"use strict";function o(e,r,i){this.x=t(e,0);this.y=t(r,0);this.z=t(i,0)}o.fromSpherical=function(i,n){e.typeOf.object("spherical",i);if(!r(n)){n=new o}var a=i.clock;var s=i.cone;var u=t(i.magnitude,1);var l=u*Math.sin(s);n.x=l*Math.cos(a);n.y=l*Math.sin(a);n.z=u*Math.cos(s);return n};o.fromElements=function(e,t,i,n){if(!r(n)){return new o(e,t,i)}n.x=e;n.y=t;n.z=i;return n};o.clone=function(e,t){if(!r(e)){return undefined}if(!r(t)){return new o(e.x,e.y,e.z)}t.x=e.x;t.y=e.y;t.z=e.z;return t};o.fromCartesian4=o.clone;o.packedLength=3;o.pack=function(r,i,n){e.typeOf.object("value",r);e.defined("array",i);n=t(n,0);i[n++]=r.x;i[n++]=r.y;i[n]=r.z;return i};o.unpack=function(i,n,a){e.defined("array",i);n=t(n,0);if(!r(a)){a=new o}a.x=i[n++];a.y=i[n++];a.z=i[n];return a};o.packArray=function(t,i){e.defined("array",t);var n=t.length;if(!r(i)){i=new Array(n*3)}else{i.length=n*3}for(var a=0;a<n;++a){o.pack(t[a],i,a*3)}return i};o.unpackArray=function(t,n){e.defined("array",t);e.typeOf.number.greaterThanOrEquals("array.length",t.length,3);if(t.length%3!==0){throw new i("array length must be a multiple of 3.")}var a=t.length;if(!r(n)){n=new Array(a/3)}else{n.length=a/3}for(var s=0;s<a;s+=3){var u=s/3;n[u]=o.unpack(t,s,n[u])}return n};o.fromArray=o.unpack;o.maximumComponent=function(t){e.typeOf.object("cartesian",t);return Math.max(t.x,t.y,t.z)};o.minimumComponent=function(t){e.typeOf.object("cartesian",t);return Math.min(t.x,t.y,t.z)};o.minimumByComponent=function(t,r,i){e.typeOf.object("first",t);e.typeOf.object("second",r);e.typeOf.object("result",i);i.x=Math.min(t.x,r.x);i.y=Math.min(t.y,r.y);i.z=Math.min(t.z,r.z);return i};o.maximumByComponent=function(t,r,i){e.typeOf.object("first",t);e.typeOf.object("second",r);e.typeOf.object("result",i);i.x=Math.max(t.x,r.x);i.y=Math.max(t.y,r.y);i.z=Math.max(t.z,r.z);return i};o.magnitudeSquared=function(t){e.typeOf.object("cartesian",t);return t.x*t.x+t.y*t.y+t.z*t.z};o.magnitude=function(e){return Math.sqrt(o.magnitudeSquared(e))};var s=new o;o.distance=function(t,r){e.typeOf.object("left",t);e.typeOf.object("right",r);o.subtract(t,r,s);return o.magnitude(s)};o.distanceSquared=function(t,r){e.typeOf.object("left",t);e.typeOf.object("right",r);o.subtract(t,r,s);return o.magnitudeSquared(s)};o.normalize=function(t,r){e.typeOf.object("cartesian",t);e.typeOf.object("result",r);var n=o.magnitude(t);r.x=t.x/n;r.y=t.y/n;r.z=t.z/n;if(isNaN(r.x)||isNaN(r.y)||isNaN(r.z)){throw new i("normalized result is not a number")}return r};o.dot=function(t,r){e.typeOf.object("left",t);e.typeOf.object("right",r);return t.x*r.x+t.y*r.y+t.z*r.z};o.multiplyComponents=function(t,r,i){e.typeOf.object("left",t);e.typeOf.object("right",r);e.typeOf.object("result",i);i.x=t.x*r.x;i.y=t.y*r.y;i.z=t.z*r.z;return i};o.divideComponents=function(e,t,n){if(!r(e)){throw new i("left is required")}if(!r(t)){throw new i("right is required")}if(!r(n)){throw new i("result is required")}n.x=e.x/t.x;n.y=e.y/t.y;n.z=e.z/t.z;return n};o.add=function(t,r,i){e.typeOf.object("left",t);e.typeOf.object("right",r);e.typeOf.object("result",i);i.x=t.x+r.x;i.y=t.y+r.y;i.z=t.z+r.z;return i};o.subtract=function(t,r,i){e.typeOf.object("left",t);e.typeOf.object("right",r);e.typeOf.object("result",i);i.x=t.x-r.x;i.y=t.y-r.y;i.z=t.z-r.z;return i};o.multiplyByScalar=function(t,r,i){e.typeOf.object("cartesian",t);e.typeOf.number("scalar",r);e.typeOf.object("result",i);i.x=t.x*r;i.y=t.y*r;i.z=t.z*r;return i};o.divideByScalar=function(t,r,i){e.typeOf.object("cartesian",t);e.typeOf.number("scalar",r);e.typeOf.object("result",i);i.x=t.x/r;i.y=t.y/r;i.z=t.z/r;return i};o.negate=function(t,r){e.typeOf.object("cartesian",t);e.typeOf.object("result",r);r.x=-t.x;r.y=-t.y;r.z=-t.z;return r};o.abs=function(t,r){e.typeOf.object("cartesian",t);e.typeOf.object("result",r);r.x=Math.abs(t.x);r.y=Math.abs(t.y);r.z=Math.abs(t.z);return r};var u=new o;o.lerp=function(t,r,i,n){e.typeOf.object("start",t);e.typeOf.object("end",r);e.typeOf.number("t",i);e.typeOf.object("result",n);o.multiplyByScalar(r,i,u);n=o.multiplyByScalar(t,1-i,n);return o.add(u,n,n)};var l=new o;var c=new o;o.angleBetween=function(t,r){e.typeOf.object("left",t);e.typeOf.object("right",r);o.normalize(t,l);o.normalize(r,c);var i=o.dot(l,c);var n=o.magnitude(o.cross(l,c,l));return Math.atan2(n,i)};var d=new o;o.mostOrthogonalAxis=function(t,r){e.typeOf.object("cartesian",t);e.typeOf.object("result",r);var i=o.normalize(t,d);o.abs(i,i);if(i.x<=i.y){if(i.x<=i.z){r=o.clone(o.UNIT_X,r)}else{r=o.clone(o.UNIT_Z,r)}}else{if(i.y<=i.z){r=o.clone(o.UNIT_Y,r)}else{r=o.clone(o.UNIT_Z,r)}}return r};o.equals=function(e,t){return e===t||r(e)&&r(t)&&e.x===t.x&&e.y===t.y&&e.z===t.z};o.equalsArray=function(e,t,r){return e.x===t[r]&&e.y===t[r+1]&&e.z===t[r+2]};o.equalsEpsilon=function(e,t,i,n){return e===t||r(e)&&r(t)&&a.equalsEpsilon(e.x,t.x,i,n)&&a.equalsEpsilon(e.y,t.y,i,n)&&a.equalsEpsilon(e.z,t.z,i,n)};o.cross=function(t,r,i){e.typeOf.object("left",t);e.typeOf.object("right",r);e.typeOf.object("result",i);var n=t.x;var a=t.y;var o=t.z;var s=r.x;var u=r.y;var l=r.z;var c=a*l-o*u;var d=o*s-n*l;var f=n*u-a*s;i.x=c;i.y=d;i.z=f;return i};o.fromDegrees=function(t,r,i,n,s){e.typeOf.number("longitude",t);e.typeOf.number("latitude",r);t=a.toRadians(t);r=a.toRadians(r);return o.fromRadians(t,r,i,n,s)};var f=new o;var h=new o;var p=new o(6378137*6378137,6378137*6378137,6356752.314245179*6356752.314245179);o.fromRadians=function(i,n,a,s,u){e.typeOf.number("longitude",i);e.typeOf.number("latitude",n);a=t(a,0);var l=r(s)?s.radiiSquared:p;var c=Math.cos(n);f.x=c*Math.cos(i);f.y=c*Math.sin(i);f.z=Math.sin(n);f=o.normalize(f,f);o.multiplyComponents(l,f,h);var d=Math.sqrt(o.dot(f,h));h=o.divideByScalar(h,d,h);f=o.multiplyByScalar(f,a,f);if(!r(u)){u=new o}return o.add(h,f,u)};o.fromDegreesArray=function(t,n,a){e.defined("coordinates",t);if(t.length<2||t.length%2!==0){throw new i("the number of coordinates must be a multiple of 2 and at least 2")}var s=t.length;if(!r(a)){a=new Array(s/2)}else{a.length=s/2}for(var u=0;u<s;u+=2){var l=t[u];var c=t[u+1];var d=u/2;a[d]=o.fromDegrees(l,c,0,n,a[d])}return a};o.fromRadiansArray=function(t,n,a){e.defined("coordinates",t);if(t.length<2||t.length%2!==0){throw new i("the number of coordinates must be a multiple of 2 and at least 2")}var s=t.length;if(!r(a)){a=new Array(s/2)}else{a.length=s/2}for(var u=0;u<s;u+=2){var l=t[u];var c=t[u+1];var d=u/2;a[d]=o.fromRadians(l,c,0,n,a[d])}return a};o.fromDegreesArrayHeights=function(t,n,a){e.defined("coordinates",t);if(t.length<3||t.length%3!==0){throw new i("the number of coordinates must be a multiple of 3 and at least 3")}var s=t.length;if(!r(a)){a=new Array(s/3)}else{a.length=s/3}for(var u=0;u<s;u+=3){var l=t[u];var c=t[u+1];var d=t[u+2];var f=u/3;a[f]=o.fromDegrees(l,c,d,n,a[f])}return a};o.fromRadiansArrayHeights=function(t,n,a){e.defined("coordinates",t);if(t.length<3||t.length%3!==0){throw new i("the number of coordinates must be a multiple of 3 and at least 3")}var s=t.length;if(!r(a)){a=new Array(s/3)}else{a.length=s/3}for(var u=0;u<s;u+=3){var l=t[u];var c=t[u+1];var d=t[u+2];var f=u/3;a[f]=o.fromRadians(l,c,d,n,a[f])}return a};o.ZERO=n(new o(0,0,0));o.UNIT_X=n(new o(1,0,0));o.UNIT_Y=n(new o(0,1,0));o.UNIT_Z=n(new o(0,0,1));o.prototype.clone=function(e){return o.clone(this,e)};o.prototype.equals=function(e){return o.equals(this,e)};o.prototype.equalsEpsilon=function(e,t,r){return o.equalsEpsilon(this,e,t,r)};o.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"};return o});define("Core/AttributeCompression",["./Cartesian2","./Cartesian3","./defined","./DeveloperError","./Math"],function(e,t,r,i,n){"use strict";var a={};a.octEncodeInRange=function(e,a,o){if(!r(e)){throw new i("vector is required.")}if(!r(o)){throw new i("result is required.")}var s=t.magnitudeSquared(e);if(Math.abs(s-1)>n.EPSILON6){throw new i("vector must be normalized.")}o.x=e.x/(Math.abs(e.x)+Math.abs(e.y)+Math.abs(e.z));o.y=e.y/(Math.abs(e.x)+Math.abs(e.y)+Math.abs(e.z));if(e.z<0){var u=o.x;var l=o.y;o.x=(1-Math.abs(l))*n.signNotZero(u);o.y=(1-Math.abs(u))*n.signNotZero(l)}o.x=n.toSNorm(o.x,a);o.y=n.toSNorm(o.y,a);return o};a.octEncode=function(e,t){return a.octEncodeInRange(e,255,t)};a.octDecodeInRange=function(e,a,o,s){if(!r(s)){throw new i("result is required.")}if(e<0||e>o||a<0||a>o){throw new i("x and y must be a signed normalized integer between 0 and "+o)}s.x=n.fromSNorm(e,o);s.y=n.fromSNorm(a,o);s.z=1-(Math.abs(s.x)+Math.abs(s.y));if(s.z<0){var u=s.x;s.x=(1-Math.abs(s.y))*n.signNotZero(u);s.y=(1-Math.abs(u))*n.signNotZero(s.y)}return t.normalize(s,s)};a.octDecode=function(e,t,r){return a.octDecodeInRange(e,t,255,r)};a.octPackFloat=function(e){if(!r(e)){throw new i("encoded is required.")}return 256*e.x+e.y};var o=new e;a.octEncodeFloat=function(e){a.octEncode(e,o);return a.octPackFloat(o)};a.octDecodeFloat=function(e,t){if(!r(e)){throw new i("value is required.")}var n=e/256;var o=Math.floor(n);var s=(n-o)*256;return a.octDecode(o,s,t)};a.octPack=function(e,t,n,s){if(!r(e)){throw new i("v1 is required.")}if(!r(t)){throw new i("v2 is required.")}if(!r(n)){throw new i("v3 is required.")}if(!r(s)){throw new i("result is required.")}var u=a.octEncodeFloat(e);var l=a.octEncodeFloat(t);var c=a.octEncode(n,o);s.x=65536*c.x+u;s.y=65536*c.y+l;return s};a.octUnpack=function(e,t,n,o){if(!r(e)){throw new i("packed is required.")}if(!r(t)){throw new i("v1 is required.")}if(!r(n)){throw new i("v2 is required.")}if(!r(o)){throw new i("v3 is required.")}var s=e.x/65536;var u=Math.floor(s);var l=(s-u)*65536;s=e.y/65536;var c=Math.floor(s);var d=(s-c)*65536;a.octDecodeFloat(l,t);a.octDecodeFloat(d,n);a.octDecode(u,c,o)};a.compressTextureCoordinates=function(e){if(!r(e)){throw new i("textureCoordinates is required.")}var t=e.x*4095|0;var n=e.y*4095|0;return 4096*t+n};a.decompressTextureCoordinates=function(e,t){if(!r(e)){throw new i("compressed is required.")}if(!r(t)){throw new i("result is required.")}var n=e/4096;var a=Math.floor(n);t.x=a/4095;t.y=(e-a*4096)/4095;return t};return a});define("Core/Intersect",["./freezeObject"],function(e){"use strict";var t={OUTSIDE:-1,INTERSECTING:0,INSIDE:1};return e(t)});define("Core/AxisAlignedBoundingBox",["./Cartesian3","./defaultValue","./defined","./DeveloperError","./Intersect"],function(e,t,r,i,n){"use strict";function a(i,n,a){this.minimum=e.clone(t(i,e.ZERO));this.maximum=e.clone(t(n,e.ZERO));if(!r(a)){a=e.add(this.minimum,this.maximum,new e);e.multiplyByScalar(a,.5,a)}else{a=e.clone(a)}this.center=a}a.fromPoints=function(t,i){if(!r(i)){i=new a}if(!r(t)||t.length===0){i.minimum=e.clone(e.ZERO,i.minimum);i.maximum=e.clone(e.ZERO,i.maximum);i.center=e.clone(e.ZERO,i.center);return i}var n=t[0].x;var o=t[0].y;var s=t[0].z;var u=t[0].x;var l=t[0].y;var c=t[0].z;var d=t.length;for(var f=1;f<d;f++){var h=t[f];var p=h.x;var m=h.y;var v=h.z;n=Math.min(p,n);u=Math.max(p,u);o=Math.min(m,o);l=Math.max(m,l);s=Math.min(v,s);c=Math.max(v,c)}var _=i.minimum;_.x=n;_.y=o;_.z=s;var g=i.maximum;g.x=u;g.y=l;g.z=c;var y=e.add(_,g,i.center);e.multiplyByScalar(y,.5,y);return i};a.clone=function(t,i){if(!r(t)){return undefined}if(!r(i)){return new a(t.minimum,t.maximum)}i.minimum=e.clone(t.minimum,i.minimum);i.maximum=e.clone(t.maximum,i.maximum);i.center=e.clone(t.center,i.center);return i};a.equals=function(t,i){return t===i||r(t)&&r(i)&&e.equals(t.center,i.center)&&e.equals(t.minimum,i.minimum)&&e.equals(t.maximum,i.maximum)};var o=new e;a.intersectPlane=function(t,a){if(!r(t)){throw new i("box is required.")}if(!r(a)){throw new i("plane is required.")}o=e.subtract(t.maximum,t.minimum,o);var s=e.multiplyByScalar(o,.5,o);var u=a.normal;var l=s.x*Math.abs(u.x)+s.y*Math.abs(u.y)+s.z*Math.abs(u.z);var c=e.dot(t.center,u)+a.distance;if(c-l>0){return n.INSIDE}if(c+l<0){return n.OUTSIDE}return n.INTERSECTING};a.prototype.clone=function(e){return a.clone(this,e)};a.prototype.intersectPlane=function(e){return a.intersectPlane(this,e)};a.prototype.equals=function(e){return a.equals(this,e)};return a});define("Core/barycentricCoordinates",["./Cartesian2","./Cartesian3","./defined","./DeveloperError"],function(e,t,r,i){"use strict";var n=new t;var a=new t;var o=new t;function s(s,u,l,c,d){if(!r(s)||!r(u)||!r(l)||!r(c)){throw new i("point, p0, p1, and p2 are required.")}if(!r(d)){d=new t}var f,h,p;var m,v,_,g,y;if(!r(u.z)){f=e.subtract(l,u,n);h=e.subtract(c,u,a);p=e.subtract(s,u,o);m=e.dot(f,f);v=e.dot(f,h);_=e.dot(f,p);g=e.dot(h,h);y=e.dot(h,p)}else{f=t.subtract(l,u,n);h=t.subtract(c,u,a);p=t.subtract(s,u,o);m=t.dot(f,f);v=t.dot(f,h);_=t.dot(f,p);g=t.dot(h,h);y=t.dot(h,p)}var w=1/(m*g-v*v);d.y=(g*_-v*y)*w;d.z=(m*y-v*_)*w;d.x=1-d.y-d.z;return d}return s});define("Core/binarySearch",["./defined","./DeveloperError"],function(e,t){"use strict";function r(r,i,n){if(!e(r)){throw new t("array is required.")}if(!e(i)){throw new t("itemToFind is required.")}if(!e(n)){throw new t("comparator is required.")}var a=0;var o=r.length-1;var s;var u;while(a<=o){s=~~((a+o)/2);u=n(r[s],i);if(u<0){a=s+1;continue}if(u>0){o=s-1;continue}return s}return~(o+1)}return r});define("Core/Credit",["./defined","./defineProperties","./DeveloperError"],function(e,t,r){"use strict";var i=0;var n={};function a(t,a,o){var s=e(o);var u=e(a);var l=e(t);if(!l&&!u&&!s){throw new r("text, imageUrl or link is required")}if(!l&&!u){t=o}this._text=t;this._imageUrl=a;this._link=o;this._hasLink=s;this._hasImage=u;var c;var d=JSON.stringify([t,a,o]);if(e(n[d])){c=n[d]}else{c=i++;n[d]=c}this._id=c}t(a.prototype,{text:{get:function(){return this._text}},imageUrl:{get:function(){return this._imageUrl}},link:{get:function(){return this._link}},id:{get:function(){return this._id}}});a.prototype.hasImage=function(){return this._hasImage};a.prototype.hasLink=function(){
return this._hasLink};a.equals=function(t,r){return t===r||e(t)&&e(r)&&t._id===r._id};a.prototype.equals=function(e){return a.equals(this,e)};return a});define("Core/BingMapsApi",["./Credit","./defined"],function(e,t){"use strict";var r={};r.defaultKey=undefined;var i=false;var n;var a="This application is using Cesium's default Bing Maps key.  Please create a new key for the application as soon as possible and prior to deployment by visiting https://www.bingmapsportal.com/, and provide your key to Cesium by setting the Cesium.BingMapsApi.defaultKey property before constructing the CesiumWidget or any other object that uses the Bing Maps API.";r.getKey=function(e){if(t(e)){return e}if(!t(r.defaultKey)){if(!i){console.log(a);i=true}return"AudaMP3YocqmIOQrFAValZ9d_tFqS4JWwiSEnvt2jwP5lizGzV_mJxLaKaI0fWRT"}return r.defaultKey};r.getErrorCredit=function(i){if(t(i)||t(r.defaultKey)){return undefined}if(!t(n)){n=new e(a)}return n};return r});define("ThirdParty/Uri",[],function(){function e(r){if(r instanceof e){this.scheme=r.scheme;this.authority=r.authority;this.path=r.path;this.query=r.query;this.fragment=r.fragment}else if(r){var i=t.exec(r);this.scheme=i[1];this.authority=i[2];this.path=i[3];this.query=i[4];this.fragment=i[5]}}e.prototype.scheme=null;e.prototype.authority=null;e.prototype.path="";e.prototype.query=null;e.prototype.fragment=null;var t=new RegExp("^(?:([^:/?#]+):)?(?://([^/?#]*))?([^?#]*)(?:\\?([^#]*))?(?:#(.*))?$");e.prototype.getScheme=function(){return this.scheme};e.prototype.getAuthority=function(){return this.authority};e.prototype.getPath=function(){return this.path};e.prototype.getQuery=function(){return this.query};e.prototype.getFragment=function(){return this.fragment};e.prototype.isAbsolute=function(){return!!this.scheme&&!this.fragment};e.prototype.isSameDocumentAs=function(e){return e.scheme==this.scheme&&e.authority==this.authority&&e.path==this.path&&e.query==this.query};e.prototype.equals=function(e){return this.isSameDocumentAs(e)&&e.fragment==this.fragment};e.prototype.normalize=function(){this.removeDotSegments();if(this.scheme)this.scheme=this.scheme.toLowerCase();if(this.authority)this.authority=this.authority.replace(n,o).replace(r,a);if(this.path)this.path=this.path.replace(r,a);if(this.query)this.query=this.query.replace(r,a);if(this.fragment)this.fragment=this.fragment.replace(r,a)};var r=/%[0-9a-z]{2}/gi;var i=/[a-zA-Z0-9\-\._~]/;var n=/(.*@)?([^@:]*)(:.*)?/;function a(e){var t=unescape(e);return i.test(t)?t:e.toUpperCase()}function o(e,t,r,i){return(t||"")+r.toLowerCase()+(i||"")}e.prototype.resolve=function(t){var r=new e;if(this.scheme){r.scheme=this.scheme;r.authority=this.authority;r.path=this.path;r.query=this.query}else{r.scheme=t.scheme;if(this.authority){r.authority=this.authority;r.path=this.path;r.query=this.query}else{r.authority=t.authority;if(this.path==""){r.path=t.path;r.query=this.query||t.query}else{if(this.path.charAt(0)=="/"){r.path=this.path;r.removeDotSegments()}else{if(t.authority&&t.path==""){r.path="/"+this.path}else{r.path=t.path.substring(0,t.path.lastIndexOf("/")+1)+this.path}r.removeDotSegments()}r.query=this.query}}}r.fragment=this.fragment;return r};e.prototype.removeDotSegments=function(){var e=this.path.split("/"),t=[],r,i=e[0]=="";if(i)e.shift();var n=e[0]==""?e.shift():null;while(e.length){r=e.shift();if(r==".."){t.pop()}else if(r!="."){t.push(r)}}if(r=="."||r=="..")t.push("");if(i)t.unshift("");this.path=t.join("/")};e.prototype.toString=function(){var e="";if(this.scheme)e+=this.scheme+":";if(this.authority)e+="//"+this.authority;e+=this.path;if(this.query)e+="?"+this.query;if(this.fragment)e+="#"+this.fragment;return e};return e});(function(e){"use strict";e("ThirdParty/when",[],function(){var e,t,r;i.defer=l;i.resolve=n;i.reject=a;i.join=p;i.all=h;i.map=m;i.reduce=v;i.any=f;i.some=d;i.chain=_;i.isPromise=c;function i(e,t,r,i){return n(e).then(t,r,i)}function n(e){var t,r;if(e instanceof o){t=e}else{if(c(e)){r=l();e.then(function(e){r.resolve(e)},function(e){r.reject(e)},function(e){r.progress(e)});t=r.promise}else{t=s(e)}}return t}function a(e){return i(e,u)}function o(e){this.then=e}o.prototype={always:function(e,t){return this.then(e,e,t)},otherwise:function(e){return this.then(r,e)},yield:function(e){return this.then(function(){return e})},spread:function(e){return this.then(function(t){return h(t,function(t){return e.apply(r,t)})})}};function s(e){var t=new o(function(t){try{return n(t?t(e):e)}catch(e){return u(e)}});return t}function u(e){var t=new o(function(t,r){try{return r?n(r(e)):u(e)}catch(e){return u(e)}});return t}function l(){var e,t,i,a,s,c,d;t=new o(f);e={then:f,resolve:h,reject:p,progress:m,promise:t,resolver:{resolve:h,reject:p,progress:m}};i=[];a=[];s=function(e,t,r){var n,o;n=l();o=typeof r==="function"?function(e){try{n.progress(r(e))}catch(e){n.progress(e)}}:function(e){n.progress(e)};i.push(function(r){r.then(e,t).then(n.resolve,n.reject,o)});a.push(o);return n.promise};c=function(e){g(a,e);return e};d=function(e){e=n(e);s=e.then;d=n;c=w;g(i,e);a=i=r;return e};return e;function f(e,t,r){return s(e,t,r)}function h(e){return d(e)}function p(e){return d(u(e))}function m(e){return c(e)}}function c(e){return e&&typeof e.then==="function"}function d(e,t,r,n,a){y(2,arguments);return i(e,function(e){var o,s,u,c,d,f,h,p,m,v;m=e.length>>>0;o=Math.max(0,Math.min(t,m));u=[];s=m-o+1;c=[];d=l();if(!o){d.resolve(u)}else{p=d.progress;h=function(e){c.push(e);if(!--s){f=h=w;d.reject(c)}};f=function(e){u.push(e);if(!--o){f=h=w;d.resolve(u)}};for(v=0;v<m;++v){if(v in e){i(e[v],g,_,p)}}}return d.then(r,n,a);function _(e){h(e)}function g(e){f(e)}})}function f(e,t,r,i){function n(e){return t?t(e[0]):e[0]}return d(e,1,n,r,i)}function h(e,t,r,i){y(1,arguments);return m(e,C).then(t,r,i)}function p(){return m(arguments,C)}function m(e,t){return i(e,function(e){var r,n,a,o,s,u;a=n=e.length>>>0;r=[];u=l();if(!a){u.resolve(r)}else{o=function e(n,o){i(n,t).then(function(e){r[o]=e;if(!--a){u.resolve(r)}},u.reject)};for(s=0;s<n;s++){if(s in e){o(e[s],s)}else{--a}}}return u.promise})}function v(r,n){var a=t.call(arguments,1);return i(r,function(t){var r;r=t.length;a[0]=function(e,t,a){return i(e,function(e){return i(t,function(t){return n(e,t,a,r)})})};return e.apply(t,a)})}function _(e,t,r){var n=arguments.length>2;return i(e,function(e){e=n?r:e;t.resolve(e);return e},function(e){t.reject(e);return u(e)},t.progress)}function g(e,t){var r,i=0;while(r=e[i++]){r(t)}}function y(e,t){var r,i=t.length;while(i>e){r=t[--i];if(r!=null&&typeof r!="function"){throw new Error("arg "+i+" must be a function")}}}function w(){}t=[].slice;e=[].reduce||function(e){var t,r,i,n,a;a=0;t=Object(this);n=t.length>>>0;r=arguments;if(r.length<=1){for(;;){if(a in t){i=t[a++];break}if(++a>=n){throw new TypeError}}}else{i=r[1]}for(;a<n;++a){if(a in t){i=e(i,t[a],a,t)}}return i};function C(e){return e}return i})})(typeof define=="function"&&define.amd?define:function(e){typeof exports==="object"?module.exports=e():this.when=e()});define("Core/combine",["./defaultValue","./defined"],function(e,t){"use strict";function r(i,n,a){a=e(a,false);var o={};var s=t(i);var u=t(n);var l;var c;var d;if(s){for(l in i){if(i.hasOwnProperty(l)){c=i[l];if(u&&a&&typeof c==="object"&&n.hasOwnProperty(l)){d=n[l];if(typeof d==="object"){o[l]=r(c,d,a)}else{o[l]=c}}else{o[l]=c}}}}if(u){for(l in n){if(n.hasOwnProperty(l)&&!o.hasOwnProperty(l)){d=n[l];o[l]=d}}}return o}return r});define("Core/isArray",["./defined"],function(e){"use strict";var t=Array.isArray;if(!e(t)){t=function(e){return Object.prototype.toString.call(e)==="[object Array]"}}return t});define("Core/objectToQuery",["./defined","./DeveloperError","./isArray"],function(e,t,r){"use strict";function i(i){if(!e(i)){throw new t("obj is required.")}var n="";for(var a in i){if(i.hasOwnProperty(a)){var o=i[a];var s=encodeURIComponent(a)+"=";if(r(o)){for(var u=0,l=o.length;u<l;++u){n+=s+encodeURIComponent(o[u])+"&"}}else{n+=s+encodeURIComponent(o)+"&"}}}n=n.slice(0,-1);return n}return i});define("Core/queryToObject",["./defined","./DeveloperError","./isArray"],function(e,t,r){"use strict";function i(i){if(!e(i)){throw new t("queryString is required.")}var n={};if(i===""){return n}var a=i.replace(/\+/g,"%20").split("&");for(var o=0,s=a.length;o<s;++o){var u=a[o].split("=");var l=decodeURIComponent(u[0]);var c=u[1];if(e(c)){c=decodeURIComponent(c)}else{c=""}var d=n[l];if(typeof d==="string"){n[l]=[d,c]}else if(r(d)){d.push(c)}else{n[l]=c}}return n}return i});define("Core/loadJsonp",["../ThirdParty/Uri","../ThirdParty/when","./combine","./defaultValue","./defined","./DeveloperError","./objectToQuery","./queryToObject"],function(e,t,r,i,n,a,o,s){"use strict";function u(l,c){if(!n(l)){throw new a("url is required.")}c=i(c,i.EMPTY_OBJECT);var d;do{d="loadJsonp"+Math.random().toString().substring(2,8)}while(n(window[d]));var f=t.defer();window[d]=function(e){f.resolve(e);try{delete window[d]}catch(e){window[d]=undefined}};var h=new e(l);var p=s(i(h.query,""));if(n(c.parameters)){p=r(c.parameters,p)}var m=i(c.callbackParameterName,"callback");p[m]=d;h.query=o(p);l=h.toString();var v=c.proxy;if(n(v)){l=v.getURL(l)}u.loadAndExecuteScript(l,d,f);return f.promise}u.loadAndExecuteScript=function(e,t,r){var i=document.createElement("script");i.async=true;i.src=e;var n=document.getElementsByTagName("head")[0];i.onload=function(){i.onload=undefined;n.removeChild(i)};i.onerror=function(e){r.reject(e)};n.appendChild(i)};u.defaultLoadAndExecuteScript=u.loadAndExecuteScript;return u});define("Core/scaleToGeodeticSurface",["./Cartesian3","./defined","./DeveloperError","./Math"],function(e,t,r,i){"use strict";var n=new e;var a=new e;function o(o,s,u,l,c){if(!t(o)){throw new r("cartesian is required.")}if(!t(s)){throw new r("oneOverRadii is required.")}if(!t(u)){throw new r("oneOverRadiiSquared is required.")}if(!t(l)){throw new r("centerToleranceSquared is required.")}var d=o.x;var f=o.y;var h=o.z;var p=s.x;var m=s.y;var v=s.z;var _=d*d*p*p;var g=f*f*m*m;var y=h*h*v*v;var w=_+g+y;var C=Math.sqrt(1/w);var b=e.multiplyByScalar(o,C,n);if(w<l){return!isFinite(C)?undefined:e.clone(b,c)}var S=u.x;var E=u.y;var T=u.z;var x=a;x.x=b.x*S*2;x.y=b.y*E*2;x.z=b.z*T*2;var A=(1-C)*e.magnitude(o)/(.5*e.magnitude(x));var P=0;var D;var M;var I;var O;var R;var N;var L;var B;var F;var k;var V;do{A-=P;I=1/(1+A*S);O=1/(1+A*E);R=1/(1+A*T);N=I*I;L=O*O;B=R*R;F=N*I;k=L*O;V=B*R;D=_*N+g*L+y*B-1;M=_*F*S+g*k*E+y*V*T;var z=-2*M;P=D/z}while(Math.abs(D)>i.EPSILON12);if(!t(c)){return new e(d*I,f*O,h*R)}c.x=d*I;c.y=f*O;c.z=h*R;return c}return o});define("Core/Cartographic",["./Cartesian3","./defaultValue","./defined","./DeveloperError","./freezeObject","./Math","./scaleToGeodeticSurface"],function(e,t,r,i,n,a,o){"use strict";function s(e,r,i){this.longitude=t(e,0);this.latitude=t(r,0);this.height=t(i,0)}s.fromRadians=function(e,n,a,o){if(!r(e)){throw new i("longitude is required.")}if(!r(n)){throw new i("latitude is required.")}a=t(a,0);if(!r(o)){return new s(e,n,a)}o.longitude=e;o.latitude=n;o.height=a;return o};s.fromDegrees=function(e,t,n,o){if(!r(e)){throw new i("longitude is required.")}if(!r(t)){throw new i("latitude is required.")}e=a.toRadians(e);t=a.toRadians(t);return s.fromRadians(e,t,n,o)};var u=new e;var l=new e;var c=new e;var d=new e(1/6378137,1/6378137,1/6356752.314245179);var f=new e(1/(6378137*6378137),1/(6378137*6378137),1/(6356752.314245179*6356752.314245179));var h=a.EPSILON1;s.fromCartesian=function(t,i,n){var p=r(i)?i.oneOverRadii:d;var m=r(i)?i.oneOverRadiiSquared:f;var v=r(i)?i._centerToleranceSquared:h;var _=o(t,p,m,v,l);if(!r(_)){return undefined}var g=e.multiplyComponents(_,m,u);g=e.normalize(g,g);var y=e.subtract(t,_,c);var w=Math.atan2(g.y,g.x);var C=Math.asin(g.z);var b=a.sign(e.dot(y,t))*e.magnitude(y);if(!r(n)){return new s(w,C,b)}n.longitude=w;n.latitude=C;n.height=b;return n};s.clone=function(e,t){if(!r(e)){return undefined}if(!r(t)){return new s(e.longitude,e.latitude,e.height)}t.longitude=e.longitude;t.latitude=e.latitude;t.height=e.height;return t};s.equals=function(e,t){return e===t||r(e)&&r(t)&&e.longitude===t.longitude&&e.latitude===t.latitude&&e.height===t.height};s.equalsEpsilon=function(e,t,n){if(typeof n!=="number"){throw new i("epsilon is required and must be a number.")}return e===t||r(e)&&r(t)&&Math.abs(e.longitude-t.longitude)<=n&&Math.abs(e.latitude-t.latitude)<=n&&Math.abs(e.height-t.height)<=n};s.ZERO=n(new s(0,0,0));s.prototype.clone=function(e){return s.clone(this,e)};s.prototype.equals=function(e){return s.equals(this,e)};s.prototype.equalsEpsilon=function(e,t){return s.equalsEpsilon(this,e,t)};s.prototype.toString=function(){return"("+this.longitude+", "+this.latitude+", "+this.height+")"};return s});define("Core/Ellipsoid",["./Cartesian3","./Cartographic","./defaultValue","./defined","./defineProperties","./DeveloperError","./freezeObject","./Math","./scaleToGeodeticSurface"],function(e,t,r,i,n,a,o,s,u){"use strict";function l(t,i,n,o){i=r(i,0);n=r(n,0);o=r(o,0);if(i<0||n<0||o<0){throw new a("All radii components must be greater than or equal to zero.")}t._radii=new e(i,n,o);t._radiiSquared=new e(i*i,n*n,o*o);t._radiiToTheFourth=new e(i*i*i*i,n*n*n*n,o*o*o*o);t._oneOverRadii=new e(i===0?0:1/i,n===0?0:1/n,o===0?0:1/o);t._oneOverRadiiSquared=new e(i===0?0:1/(i*i),n===0?0:1/(n*n),o===0?0:1/(o*o));t._minimumRadius=Math.min(i,n,o);t._maximumRadius=Math.max(i,n,o);t._centerToleranceSquared=s.EPSILON1;if(t._radiiSquared.z!==0){t._sqauredXOverSquaredZ=t._radiiSquared.x/t._radiiSquared.z}}function c(e,t,r){this._radii=undefined;this._radiiSquared=undefined;this._radiiToTheFourth=undefined;this._oneOverRadii=undefined;this._oneOverRadiiSquared=undefined;this._minimumRadius=undefined;this._maximumRadius=undefined;this._centerToleranceSquared=undefined;this._sqauredXOverSquaredZ=undefined;l(this,e,t,r)}n(c.prototype,{radii:{get:function(){return this._radii}},radiiSquared:{get:function(){return this._radiiSquared}},radiiToTheFourth:{get:function(){return this._radiiToTheFourth}},oneOverRadii:{get:function(){return this._oneOverRadii}},oneOverRadiiSquared:{get:function(){return this._oneOverRadiiSquared}},minimumRadius:{get:function(){return this._minimumRadius}},maximumRadius:{get:function(){return this._maximumRadius}}});c.clone=function(t,r){if(!i(t)){return undefined}var n=t._radii;if(!i(r)){return new c(n.x,n.y,n.z)}e.clone(n,r._radii);e.clone(t._radiiSquared,r._radiiSquared);e.clone(t._radiiToTheFourth,r._radiiToTheFourth);e.clone(t._oneOverRadii,r._oneOverRadii);e.clone(t._oneOverRadiiSquared,r._oneOverRadiiSquared);r._minimumRadius=t._minimumRadius;r._maximumRadius=t._maximumRadius;r._centerToleranceSquared=t._centerToleranceSquared;return r};c.fromCartesian3=function(e,t){if(!i(t)){t=new c}if(!i(e)){return t}l(t,e.x,e.y,e.z);return t};c.WGS84=o(new c(6378137,6378137,6356752.314245179));c.UNIT_SPHERE=o(new c(1,1,1));c.MOON=o(new c(s.LUNAR_RADIUS,s.LUNAR_RADIUS,s.LUNAR_RADIUS));c.prototype.clone=function(e){return c.clone(this,e)};c.packedLength=e.packedLength;c.pack=function(t,n,o){if(!i(t)){throw new a("value is required")}if(!i(n)){throw new a("array is required")}o=r(o,0);e.pack(t._radii,n,o);return n};c.unpack=function(t,n,o){if(!i(t)){throw new a("array is required")}n=r(n,0);var s=e.unpack(t,n);return c.fromCartesian3(s,o)};c.prototype.geocentricSurfaceNormal=e.normalize;c.prototype.geodeticSurfaceNormalCartographic=function(t,r){if(!i(t)){throw new a("cartographic is required.")}var n=t.longitude;var o=t.latitude;var s=Math.cos(o);var u=s*Math.cos(n);var l=s*Math.sin(n);var c=Math.sin(o);if(!i(r)){r=new e}r.x=u;r.y=l;r.z=c;return e.normalize(r,r)};c.prototype.geodeticSurfaceNormal=function(t,r){if(!i(r)){r=new e}r=e.multiplyComponents(t,this._oneOverRadiiSquared,r);return e.normalize(r,r)};var d=new e;var f=new e;c.prototype.cartographicToCartesian=function(t,r){var n=d;var a=f;this.geodeticSurfaceNormalCartographic(t,n);e.multiplyComponents(this._radiiSquared,n,a);var o=Math.sqrt(e.dot(n,a));e.divideByScalar(a,o,a);e.multiplyByScalar(n,t.height,n);if(!i(r)){r=new e}return e.add(a,n,r)};c.prototype.cartographicArrayToCartesianArray=function(e,t){if(!i(e)){throw new a("cartographics is required.")}var r=e.length;if(!i(t)){t=new Array(r)}else{t.length=r}for(var n=0;n<r;n++){t[n]=this.cartographicToCartesian(e[n],t[n])}return t};var h=new e;var p=new e;var m=new e;c.prototype.cartesianToCartographic=function(r,n){var a=this.scaleToGeodeticSurface(r,p);if(!i(a)){return undefined}var o=this.geodeticSurfaceNormal(a,h);var u=e.subtract(r,a,m);var l=Math.atan2(o.y,o.x);var c=Math.asin(o.z);var d=s.sign(e.dot(u,r))*e.magnitude(u);if(!i(n)){return new t(l,c,d)}n.longitude=l;n.latitude=c;n.height=d;return n};c.prototype.cartesianArrayToCartographicArray=function(e,t){if(!i(e)){throw new a("cartesians is required.")}var r=e.length;if(!i(t)){t=new Array(r)}else{t.length=r}for(var n=0;n<r;++n){t[n]=this.cartesianToCartographic(e[n],t[n])}return t};c.prototype.scaleToGeodeticSurface=function(e,t){return u(e,this._oneOverRadii,this._oneOverRadiiSquared,this._centerToleranceSquared,t)};c.prototype.scaleToGeocentricSurface=function(t,r){if(!i(t)){throw new a("cartesian is required.")}if(!i(r)){r=new e}var n=t.x;var o=t.y;var s=t.z;var u=this._oneOverRadiiSquared;var l=1/Math.sqrt(n*n*u.x+o*o*u.y+s*s*u.z);return e.multiplyByScalar(t,l,r)};c.prototype.transformPositionToScaledSpace=function(t,r){if(!i(r)){r=new e}return e.multiplyComponents(t,this._oneOverRadii,r)};c.prototype.transformPositionFromScaledSpace=function(t,r){if(!i(r)){r=new e}return e.multiplyComponents(t,this._radii,r)};c.prototype.equals=function(t){return this===t||i(t)&&e.equals(this._radii,t._radii)};c.prototype.toString=function(){return this._radii.toString()};c.prototype.getSurfaceNormalIntersectionWithZAxis=function(t,n,o){if(!i(t)){throw new a("position is required.")}if(!s.equalsEpsilon(this._radii.x,this._radii.y,s.EPSILON15)){throw new a("Ellipsoid must be an ellipsoid of revolution (radii.x == radii.y)")}if(this._radii.z===0){throw new a("Ellipsoid.radii.z must be greater than 0")}n=r(n,0);var u=this._sqauredXOverSquaredZ;if(!i(o)){o=new e}o.x=0;o.y=0;o.z=t.z*(1-u);if(Math.abs(o.z)>=this._radii.z-n){return undefined}return o};return c});define("Core/Rectangle",["./Cartographic","./Check","./defaultValue","./defined","./defineProperties","./Ellipsoid","./freezeObject","./Math"],function(e,t,r,i,n,a,o,s){"use strict";function u(e,t,i,n){this.west=r(e,0);this.south=r(t,0);this.east=r(i,0);this.north=r(n,0)}n(u.prototype,{width:{get:function(){return u.computeWidth(this)}},height:{get:function(){return u.computeHeight(this)}}});u.packedLength=4;u.pack=function(e,i,n){t.typeOf.object("value",e);t.defined("array",i);n=r(n,0);i[n++]=e.west;i[n++]=e.south;i[n++]=e.east;i[n]=e.north;return i};u.unpack=function(e,n,a){t.defined("array",e);n=r(n,0);if(!i(a)){a=new u}a.west=e[n++];a.south=e[n++];a.east=e[n++];a.north=e[n];return a};u.computeWidth=function(e){t.typeOf.object("rectangle",e);var r=e.east;var i=e.west;if(r<i){r+=s.TWO_PI}return r-i};u.computeHeight=function(e){t.typeOf.object("rectangle",e);return e.north-e.south};u.fromDegrees=function(e,t,n,a,o){e=s.toRadians(r(e,0));t=s.toRadians(r(t,0));n=s.toRadians(r(n,0));a=s.toRadians(r(a,0));if(!i(o)){return new u(e,t,n,a)}o.west=e;o.south=t;o.east=n;o.north=a;return o};u.fromRadians=function(e,t,n,a,o){if(!i(o)){return new u(e,t,n,a)}o.west=r(e,0);o.south=r(t,0);o.east=r(n,0);o.north=r(a,0);return o};u.fromCartographicArray=function(e,r){t.defined("cartographics",e);var n=Number.MAX_VALUE;var a=-Number.MAX_VALUE;var o=Number.MAX_VALUE;var l=-Number.MAX_VALUE;var c=Number.MAX_VALUE;var d=-Number.MAX_VALUE;for(var f=0,h=e.length;f<h;f++){var p=e[f];n=Math.min(n,p.longitude);a=Math.max(a,p.longitude);c=Math.min(c,p.latitude);d=Math.max(d,p.latitude);var m=p.longitude>=0?p.longitude:p.longitude+s.TWO_PI;o=Math.min(o,m);l=Math.max(l,m)}if(a-n>l-o){n=o;a=l;if(a>s.PI){a=a-s.TWO_PI}if(n>s.PI){n=n-s.TWO_PI}}if(!i(r)){return new u(n,c,a,d)}r.west=n;r.south=c;r.east=a;r.north=d;return r};u.fromCartesianArray=function(e,r,n){t.defined("cartesians",e);var a=Number.MAX_VALUE;var o=-Number.MAX_VALUE;var l=Number.MAX_VALUE;var c=-Number.MAX_VALUE;var d=Number.MAX_VALUE;var f=-Number.MAX_VALUE;for(var h=0,p=e.length;h<p;h++){var m=r.cartesianToCartographic(e[h]);a=Math.min(a,m.longitude);o=Math.max(o,m.longitude);d=Math.min(d,m.latitude);f=Math.max(f,m.latitude);var v=m.longitude>=0?m.longitude:m.longitude+s.TWO_PI;l=Math.min(l,v);c=Math.max(c,v)}if(o-a>c-l){a=l;o=c;if(o>s.PI){o=o-s.TWO_PI}if(a>s.PI){a=a-s.TWO_PI}}if(!i(n)){return new u(a,d,o,f)}n.west=a;n.south=d;n.east=o;n.north=f;return n};u.clone=function(e,t){if(!i(e)){return undefined}if(!i(t)){return new u(e.west,e.south,e.east,e.north)}t.west=e.west;t.south=e.south;t.east=e.east;t.north=e.north;return t};u.prototype.clone=function(e){return u.clone(this,e)};u.prototype.equals=function(e){return u.equals(this,e)};u.equals=function(e,t){return e===t||i(e)&&i(t)&&e.west===t.west&&e.south===t.south&&e.east===t.east&&e.north===t.north};u.prototype.equalsEpsilon=function(e,r){t.typeOf.number("epsilon",r);return i(e)&&Math.abs(this.west-e.west)<=r&&Math.abs(this.south-e.south)<=r&&Math.abs(this.east-e.east)<=r&&Math.abs(this.north-e.north)<=r};u.validate=function(e){t.typeOf.object("rectangle",e);var r=e.north;t.typeOf.number.greaterThanOrEquals("north",r,-s.PI_OVER_TWO);t.typeOf.number.lessThanOrEquals("north",r,s.PI_OVER_TWO);var i=e.south;t.typeOf.number.greaterThanOrEquals("south",i,-s.PI_OVER_TWO);t.typeOf.number.lessThanOrEquals("south",i,s.PI_OVER_TWO);var n=e.west;t.typeOf.number.greaterThanOrEquals("west",n,-Math.PI);t.typeOf.number.lessThanOrEquals("west",n,Math.PI);var a=e.east;t.typeOf.number.greaterThanOrEquals("east",a,-Math.PI);t.typeOf.number.lessThanOrEquals("east",a,Math.PI)};u.southwest=function(r,n){t.typeOf.object("rectangle",r);if(!i(n)){return new e(r.west,r.south)}n.longitude=r.west;n.latitude=r.south;n.height=0;return n};u.northwest=function(r,n){t.typeOf.object("rectangle",r);if(!i(n)){return new e(r.west,r.north)}n.longitude=r.west;n.latitude=r.north;n.height=0;return n};u.northeast=function(r,n){t.typeOf.object("rectangle",r);if(!i(n)){return new e(r.east,r.north)}n.longitude=r.east;n.latitude=r.north;n.height=0;return n};u.southeast=function(r,n){t.typeOf.object("rectangle",r);if(!i(n)){return new e(r.east,r.south)}n.longitude=r.east;n.latitude=r.south;n.height=0;return n};u.center=function(r,n){t.typeOf.object("rectangle",r);var a=r.east;var o=r.west;if(a<o){a+=s.TWO_PI}var u=s.negativePiToPi((o+a)*.5);var l=(r.south+r.north)*.5;if(!i(n)){return new e(u,l)}n.longitude=u;n.latitude=l;n.height=0;return n};u.intersection=function(e,r,n){t.typeOf.object("rectangle",e);t.typeOf.object("otherRectangle",r);var a=e.east;var o=e.west;var l=r.east;var c=r.west;if(a<o&&l>0){a+=s.TWO_PI}else if(l<c&&a>0){l+=s.TWO_PI}if(a<o&&c<0){c+=s.TWO_PI}else if(l<c&&o<0){o+=s.TWO_PI}var d=s.negativePiToPi(Math.max(o,c));var f=s.negativePiToPi(Math.min(a,l));if((e.west<e.east||r.west<r.east)&&f<=d){return undefined}var h=Math.max(e.south,r.south);var p=Math.min(e.north,r.north);if(h>=p){return undefined}if(!i(n)){return new u(d,h,f,p)}n.west=d;n.south=h;n.east=f;n.north=p;return n};u.simpleIntersection=function(e,r,n){t.typeOf.object("rectangle",e);t.typeOf.object("otherRectangle",r);var a=Math.max(e.west,r.west);var o=Math.max(e.south,r.south);var s=Math.min(e.east,r.east);var l=Math.min(e.north,r.north);if(o>=l||a>=s){return undefined}if(!i(n)){return new u(a,o,s,l)}n.west=a;n.south=o;n.east=s;n.north=l;return n};u.union=function(e,r,n){t.typeOf.object("rectangle",e);t.typeOf.object("otherRectangle",r);if(!i(n)){n=new u}var a=e.east;var o=e.west;var l=r.east;var c=r.west;if(a<o&&l>0){a+=s.TWO_PI}else if(l<c&&a>0){l+=s.TWO_PI}if(a<o&&c<0){c+=s.TWO_PI}else if(l<c&&o<0){o+=s.TWO_PI}var d=s.convertLongitudeRange(Math.min(o,c));var f=s.convertLongitudeRange(Math.max(a,l));n.west=d;n.south=Math.min(e.south,r.south);n.east=f;n.north=Math.max(e.north,r.north);return n};u.expand=function(e,r,n){t.typeOf.object("rectangle",e);t.typeOf.object("cartographic",r);if(!i(n)){n=new u}n.west=Math.min(e.west,r.longitude);n.south=Math.min(e.south,r.latitude);n.east=Math.max(e.east,r.longitude);n.north=Math.max(e.north,r.latitude);return n};u.contains=function(e,r){t.typeOf.object("rectangle",e);t.typeOf.object("cartographic",r);var i=r.longitude;var n=r.latitude;var a=e.west;var o=e.east;if(o<a){o+=s.TWO_PI;if(i<0){i+=s.TWO_PI}}return(i>a||s.equalsEpsilon(i,a,s.EPSILON14))&&(i<o||s.equalsEpsilon(i,o,s.EPSILON14))&&n>=e.south&&n<=e.north};var l=new e;u.subsample=function(e,n,o,c){t.typeOf.object("rectangle",e);n=r(n,a.WGS84);o=r(o,0);if(!i(c)){c=[]}var d=0;var f=e.north;var h=e.south;var p=e.east;var m=e.west;var v=l;v.height=o;v.longitude=m;v.latitude=f;c[d]=n.cartographicToCartesian(v,c[d]);d++;v.longitude=p;c[d]=n.cartographicToCartesian(v,c[d]);d++;v.latitude=h;c[d]=n.cartographicToCartesian(v,c[d]);d++;v.longitude=m;c[d]=n.cartographicToCartesian(v,c[d]);d++;if(f<0){v.latitude=f}else if(h>0){v.latitude=h}else{v.latitude=0}for(var _=1;_<8;++_){v.longitude=-Math.PI+_*s.PI_OVER_TWO;if(u.contains(e,v)){c[d]=n.cartographicToCartesian(v,c[d]);d++}}if(v.latitude===0){v.longitude=m;c[d]=n.cartographicToCartesian(v,c[d]);d++;v.longitude=p;c[d]=n.cartographicToCartesian(v,c[d]);d++}c.length=d;return c};u.MAX_VALUE=o(new u(-Math.PI,-s.PI_OVER_TWO,Math.PI,s.PI_OVER_TWO));return u});define("Core/BingMapsGeocoderService",["./BingMapsApi","./defaultValue","./defined","./defineProperties","./DeveloperError","./loadJsonp","./Rectangle"],function(e,t,r,i,n,a,o){"use strict";var s="https://dev.virtualearth.net/REST/v1/Locations";function u(i){i=t(i,t.EMPTY_OBJECT);if(!r(i.scene)){throw new n("options.scene is required.")}var a=i.key;this._key=e.getKey(a);if(r(a)){var o=e.getErrorCredit(a);if(r(o)){i.scene._frameState.creditDisplay.addDefaultCredit(o)}}}i(u.prototype,{url:{get:function(){return s}},key:{get:function(){return this._key}}});u.prototype.geocode=function(e){if(!r(e)){throw new n("query must be defined")}var t=this.key;var i=a(s,{parameters:{query:e,key:t},callbackParameterName:"jsonp"});return i.then(function(e){if(e.resourceSets.length===0){return[]}var t=e.resourceSets[0].resources;return t.map(function(e){var t=e.bbox;var r=t[0];var i=t[1];var n=t[2];var a=t[3];return{displayName:e.name,destination:o.fromDegrees(i,r,a,n)}})})};return u});define("Core/GeographicProjection",["./Cartesian3","./Cartographic","./defaultValue","./defined","./defineProperties","./DeveloperError","./Ellipsoid"],function(e,t,r,i,n,a,o){"use strict";function s(e){this._ellipsoid=r(e,o.WGS84);this._semimajorAxis=this._ellipsoid.maximumRadius;this._oneOverSemimajorAxis=1/this._semimajorAxis}n(s.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}});s.prototype.project=function(t,r){var n=this._semimajorAxis;var a=t.longitude*n;var o=t.latitude*n;var s=t.height;if(!i(r)){return new e(a,o,s)}r.x=a;r.y=o;r.z=s;return r};s.prototype.unproject=function(e,r){if(!i(e)){throw new a("cartesian is required")}var n=this._oneOverSemimajorAxis;var o=e.x*n;var s=e.y*n;var u=e.z;if(!i(r)){return new t(o,s,u)}r.longitude=o;r.latitude=s;r.height=u;return r};return s});define("Core/BoundingRectangle",["./Cartesian2","./Cartographic","./Check","./defaultValue","./defined","./GeographicProjection","./Intersect","./Rectangle"],function(e,t,r,i,n,a,o,s){"use strict";function u(e,t,r,n){this.x=i(e,0);this.y=i(t,0);this.width=i(r,0);this.height=i(n,0)}u.packedLength=4;u.pack=function(e,t,n){r.typeOf.object("value",e);r.defined("array",t);n=i(n,0);t[n++]=e.x;t[n++]=e.y;t[n++]=e.width;t[n]=e.height;return t};u.unpack=function(e,t,a){r.defined("array",e);t=i(t,0);if(!n(a)){a=new u}a.x=e[t++];a.y=e[t++];a.width=e[t++];a.height=e[t];return a};u.fromPoints=function(e,t){if(!n(t)){t=new u}if(!n(e)||e.length===0){t.x=0;t.y=0;t.width=0;t.height=0;return t}var r=e.length;var i=e[0].x;var a=e[0].y;var o=e[0].x;var s=e[0].y;for(var l=1;l<r;l++){var c=e[l];var d=c.x;var f=c.y;i=Math.min(d,i);o=Math.max(d,o);a=Math.min(f,a);s=Math.max(f,s)}t.x=i;t.y=a;t.width=o-i;t.height=s-a;return t};var l=new a;var c=new t;var d=new t;u.fromRectangle=function(t,r,a){if(!n(a)){a=new u}if(!n(t)){a.x=0;a.y=0;a.width=0;a.height=0;return a}r=i(r,l);var o=r.project(s.southwest(t,c));var f=r.project(s.northeast(t,d));e.subtract(f,o,f);a.x=o.x;a.y=o.y;a.width=f.x;a.height=f.y;return a};u.clone=function(e,t){if(!n(e)){return undefined}if(!n(t)){return new u(e.x,e.y,e.width,e.height)}t.x=e.x;t.y=e.y;t.width=e.width;t.height=e.height;return t};u.union=function(e,t,i){r.typeOf.object("left",e);r.typeOf.object("right",t);if(!n(i)){i=new u}var a=Math.min(e.x,t.x);var o=Math.min(e.y,t.y);var s=Math.max(e.x+e.width,t.x+t.width);var l=Math.max(e.y+e.height,t.y+t.height);i.x=a;i.y=o;i.width=s-a;i.height=l-o;return i};u.expand=function(e,t,i){r.typeOf.object("rectangle",e);r.typeOf.object("point",t);i=u.clone(e,i);var n=t.x-i.x;var a=t.y-i.y;if(n>i.width){i.width=n}else if(n<0){i.width-=n;i.x=t.x}if(a>i.height){i.height=a}else if(a<0){i.height-=a;i.y=t.y}return i};u.intersect=function(e,t){r.typeOf.object("left",e);r.typeOf.object("right",t);var i=e.x;var n=e.y;var a=t.x;var s=t.y;if(!(i>a+t.width||i+e.width<a||n+e.height<s||n>s+t.height)){return o.INTERSECTING}return o.OUTSIDE};u.equals=function(e,t){return e===t||n(e)&&n(t)&&e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height};u.prototype.clone=function(e){return u.clone(this,e)};u.prototype.intersect=function(e){return u.intersect(this,e)};u.prototype.equals=function(e){return u.equals(this,e)};return u});define("Core/Interval",["./defaultValue"],function(e){"use strict";function t(t,r){this.start=e(t,0);this.stop=e(r,0)}return t});define("Core/Matrix3",["./Cartesian3","./Check","./defaultValue","./defined","./defineProperties","./DeveloperError","./freezeObject","./Math"],function(e,t,r,i,n,a,o,s){"use strict";function u(e,t,i,n,a,o,s,u,l){this[0]=r(e,0);this[1]=r(n,0);this[2]=r(s,0);this[3]=r(t,0);this[4]=r(a,0);this[5]=r(u,0);this[6]=r(i,0);this[7]=r(o,0);this[8]=r(l,0)}u.packedLength=9;u.pack=function(e,i,n){t.typeOf.object("value",e);t.defined("array",i);n=r(n,0);i[n++]=e[0];i[n++]=e[1];i[n++]=e[2];i[n++]=e[3];i[n++]=e[4];i[n++]=e[5];i[n++]=e[6];i[n++]=e[7];i[n++]=e[8];return i};u.unpack=function(e,n,a){t.defined("array",e);n=r(n,0);if(!i(a)){a=new u}a[0]=e[n++];a[1]=e[n++];a[2]=e[n++];a[3]=e[n++];a[4]=e[n++];a[5]=e[n++];a[6]=e[n++];a[7]=e[n++];a[8]=e[n++];return a};u.clone=function(e,t){if(!i(e)){return undefined}if(!i(t)){return new u(e[0],e[3],e[6],e[1],e[4],e[7],e[2],e[5],e[8])}t[0]=e[0];t[1]=e[1];t[2]=e[2];t[3]=e[3];t[4]=e[4];t[5]=e[5];t[6]=e[6];t[7]=e[7];t[8]=e[8];return t};u.fromArray=function(e,n,a){t.defined("array",e);n=r(n,0);if(!i(a)){a=new u}a[0]=e[n];a[1]=e[n+1];a[2]=e[n+2];a[3]=e[n+3];a[4]=e[n+4];a[5]=e[n+5];a[6]=e[n+6];a[7]=e[n+7];a[8]=e[n+8];return a};u.fromColumnMajorArray=function(e,r){t.defined("values",e);return u.clone(e,r)};u.fromRowMajorArray=function(e,r){t.defined("values",e);if(!i(r)){return new u(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])}r[0]=e[0];r[1]=e[3];r[2]=e[6];r[3]=e[1];r[4]=e[4];r[5]=e[7];r[6]=e[2];r[7]=e[5];r[8]=e[8];return r};u.fromQuaternion=function(e,r){t.typeOf.object("quaternion",e);var n=e.x*e.x;var a=e.x*e.y;var o=e.x*e.z;var s=e.x*e.w;var l=e.y*e.y;var c=e.y*e.z;var d=e.y*e.w;var f=e.z*e.z;var h=e.z*e.w;var p=e.w*e.w;var m=n-l-f+p;var v=2*(a-h);var _=2*(o+d);var g=2*(a+h);var y=-n+l-f+p;var w=2*(c-s);var C=2*(o-d);var b=2*(c+s);var S=-n-l+f+p;if(!i(r)){return new u(m,v,_,g,y,w,C,b,S)}r[0]=m;r[1]=g;r[2]=C;r[3]=v;r[4]=y;r[5]=b;r[6]=_;r[7]=w;r[8]=S;return r};u.fromHeadingPitchRoll=function(e,r){t.typeOf.object("headingPitchRoll",e);var n=Math.cos(-e.pitch);var a=Math.cos(-e.heading);var o=Math.cos(e.roll);var s=Math.sin(-e.pitch);var l=Math.sin(-e.heading);var c=Math.sin(e.roll);var d=n*a;var f=-o*l+c*s*a;var h=c*l+o*s*a;var p=n*l;var m=o*a+c*s*l
;var v=-s*o+o*s*l;var _=-s;var g=c*n;var y=o*n;if(!i(r)){return new u(d,f,h,p,m,v,_,g,y)}r[0]=d;r[1]=p;r[2]=_;r[3]=f;r[4]=m;r[5]=g;r[6]=h;r[7]=v;r[8]=y;return r};u.fromScale=function(e,r){t.typeOf.object("scale",e);if(!i(r)){return new u(e.x,0,0,0,e.y,0,0,0,e.z)}r[0]=e.x;r[1]=0;r[2]=0;r[3]=0;r[4]=e.y;r[5]=0;r[6]=0;r[7]=0;r[8]=e.z;return r};u.fromUniformScale=function(e,r){t.typeOf.number("scale",e);if(!i(r)){return new u(e,0,0,0,e,0,0,0,e)}r[0]=e;r[1]=0;r[2]=0;r[3]=0;r[4]=e;r[5]=0;r[6]=0;r[7]=0;r[8]=e;return r};u.fromCrossProduct=function(e,r){t.typeOf.object("vector",e);if(!i(r)){return new u(0,-e.z,e.y,e.z,0,-e.x,-e.y,e.x,0)}r[0]=0;r[1]=e.z;r[2]=-e.y;r[3]=-e.z;r[4]=0;r[5]=e.x;r[6]=e.y;r[7]=-e.x;r[8]=0;return r};u.fromRotationX=function(e,r){t.typeOf.number("angle",e);var n=Math.cos(e);var a=Math.sin(e);if(!i(r)){return new u(1,0,0,0,n,-a,0,a,n)}r[0]=1;r[1]=0;r[2]=0;r[3]=0;r[4]=n;r[5]=a;r[6]=0;r[7]=-a;r[8]=n;return r};u.fromRotationY=function(e,r){t.typeOf.number("angle",e);var n=Math.cos(e);var a=Math.sin(e);if(!i(r)){return new u(n,0,a,0,1,0,-a,0,n)}r[0]=n;r[1]=0;r[2]=-a;r[3]=0;r[4]=1;r[5]=0;r[6]=a;r[7]=0;r[8]=n;return r};u.fromRotationZ=function(e,r){t.typeOf.number("angle",e);var n=Math.cos(e);var a=Math.sin(e);if(!i(r)){return new u(n,-a,0,a,n,0,0,0,1)}r[0]=n;r[1]=a;r[2]=0;r[3]=-a;r[4]=n;r[5]=0;r[6]=0;r[7]=0;r[8]=1;return r};u.toArray=function(e,r){t.typeOf.object("matrix",e);if(!i(r)){return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8]]}r[0]=e[0];r[1]=e[1];r[2]=e[2];r[3]=e[3];r[4]=e[4];r[5]=e[5];r[6]=e[6];r[7]=e[7];r[8]=e[8];return r};u.getElementIndex=function(e,r){t.typeOf.number.greaterThanOrEquals("row",r,0);t.typeOf.number.lessThanOrEquals("row",r,2);t.typeOf.number.greaterThanOrEquals("column",e,0);t.typeOf.number.lessThanOrEquals("column",e,2);return e*3+r};u.getColumn=function(e,r,i){t.typeOf.object("matrix",e);t.typeOf.number.greaterThanOrEquals("index",r,0);t.typeOf.number.lessThanOrEquals("index",r,2);t.typeOf.object("result",i);var n=r*3;var a=e[n];var o=e[n+1];var s=e[n+2];i.x=a;i.y=o;i.z=s;return i};u.setColumn=function(e,r,i,n){t.typeOf.object("matrix",e);t.typeOf.number.greaterThanOrEquals("index",r,0);t.typeOf.number.lessThanOrEquals("index",r,2);t.typeOf.object("cartesian",i);t.typeOf.object("result",n);n=u.clone(e,n);var a=r*3;n[a]=i.x;n[a+1]=i.y;n[a+2]=i.z;return n};u.getRow=function(e,r,i){t.typeOf.object("matrix",e);t.typeOf.number.greaterThanOrEquals("index",r,0);t.typeOf.number.lessThanOrEquals("index",r,2);t.typeOf.object("result",i);var n=e[r];var a=e[r+3];var o=e[r+6];i.x=n;i.y=a;i.z=o;return i};u.setRow=function(e,r,i,n){t.typeOf.object("matrix",e);t.typeOf.number.greaterThanOrEquals("index",r,0);t.typeOf.number.lessThanOrEquals("index",r,2);t.typeOf.object("cartesian",i);t.typeOf.object("result",n);n=u.clone(e,n);n[r]=i.x;n[r+3]=i.y;n[r+6]=i.z;return n};var l=new e;u.getScale=function(r,i){t.typeOf.object("matrix",r);t.typeOf.object("result",i);i.x=e.magnitude(e.fromElements(r[0],r[1],r[2],l));i.y=e.magnitude(e.fromElements(r[3],r[4],r[5],l));i.z=e.magnitude(e.fromElements(r[6],r[7],r[8],l));return i};var c=new e;u.getMaximumScale=function(t){u.getScale(t,c);return e.maximumComponent(c)};u.multiply=function(e,r,i){t.typeOf.object("left",e);t.typeOf.object("right",r);t.typeOf.object("result",i);var n=e[0]*r[0]+e[3]*r[1]+e[6]*r[2];var a=e[1]*r[0]+e[4]*r[1]+e[7]*r[2];var o=e[2]*r[0]+e[5]*r[1]+e[8]*r[2];var s=e[0]*r[3]+e[3]*r[4]+e[6]*r[5];var u=e[1]*r[3]+e[4]*r[4]+e[7]*r[5];var l=e[2]*r[3]+e[5]*r[4]+e[8]*r[5];var c=e[0]*r[6]+e[3]*r[7]+e[6]*r[8];var d=e[1]*r[6]+e[4]*r[7]+e[7]*r[8];var f=e[2]*r[6]+e[5]*r[7]+e[8]*r[8];i[0]=n;i[1]=a;i[2]=o;i[3]=s;i[4]=u;i[5]=l;i[6]=c;i[7]=d;i[8]=f;return i};u.add=function(e,r,i){t.typeOf.object("left",e);t.typeOf.object("right",r);t.typeOf.object("result",i);i[0]=e[0]+r[0];i[1]=e[1]+r[1];i[2]=e[2]+r[2];i[3]=e[3]+r[3];i[4]=e[4]+r[4];i[5]=e[5]+r[5];i[6]=e[6]+r[6];i[7]=e[7]+r[7];i[8]=e[8]+r[8];return i};u.subtract=function(e,r,i){t.typeOf.object("left",e);t.typeOf.object("right",r);t.typeOf.object("result",i);i[0]=e[0]-r[0];i[1]=e[1]-r[1];i[2]=e[2]-r[2];i[3]=e[3]-r[3];i[4]=e[4]-r[4];i[5]=e[5]-r[5];i[6]=e[6]-r[6];i[7]=e[7]-r[7];i[8]=e[8]-r[8];return i};u.multiplyByVector=function(e,r,i){t.typeOf.object("matrix",e);t.typeOf.object("cartesian",r);t.typeOf.object("result",i);var n=r.x;var a=r.y;var o=r.z;var s=e[0]*n+e[3]*a+e[6]*o;var u=e[1]*n+e[4]*a+e[7]*o;var l=e[2]*n+e[5]*a+e[8]*o;i.x=s;i.y=u;i.z=l;return i};u.multiplyByScalar=function(e,r,i){t.typeOf.object("matrix",e);t.typeOf.number("scalar",r);t.typeOf.object("result",i);i[0]=e[0]*r;i[1]=e[1]*r;i[2]=e[2]*r;i[3]=e[3]*r;i[4]=e[4]*r;i[5]=e[5]*r;i[6]=e[6]*r;i[7]=e[7]*r;i[8]=e[8]*r;return i};u.multiplyByScale=function(e,r,i){t.typeOf.object("matrix",e);t.typeOf.object("scale",r);t.typeOf.object("result",i);i[0]=e[0]*r.x;i[1]=e[1]*r.x;i[2]=e[2]*r.x;i[3]=e[3]*r.y;i[4]=e[4]*r.y;i[5]=e[5]*r.y;i[6]=e[6]*r.z;i[7]=e[7]*r.z;i[8]=e[8]*r.z;return i};u.negate=function(e,r){t.typeOf.object("matrix",e);t.typeOf.object("result",r);r[0]=-e[0];r[1]=-e[1];r[2]=-e[2];r[3]=-e[3];r[4]=-e[4];r[5]=-e[5];r[6]=-e[6];r[7]=-e[7];r[8]=-e[8];return r};u.transpose=function(e,r){t.typeOf.object("matrix",e);t.typeOf.object("result",r);var i=e[0];var n=e[3];var a=e[6];var o=e[1];var s=e[4];var u=e[7];var l=e[2];var c=e[5];var d=e[8];r[0]=i;r[1]=n;r[2]=a;r[3]=o;r[4]=s;r[5]=u;r[6]=l;r[7]=c;r[8]=d;return r};function d(e){var t=0;for(var r=0;r<9;++r){var i=e[r];t+=i*i}return Math.sqrt(t)}var f=[1,0,0];var h=[2,2,1];function p(e){var t=0;for(var r=0;r<3;++r){var i=e[u.getElementIndex(h[r],f[r])];t+=2*i*i}return Math.sqrt(t)}function m(e,t){var r=s.EPSILON15;var i=0;var n=1;for(var a=0;a<3;++a){var o=Math.abs(e[u.getElementIndex(h[a],f[a])]);if(o>i){n=a;i=o}}var l=1;var c=0;var d=f[n];var p=h[n];if(Math.abs(e[u.getElementIndex(p,d)])>r){var m=e[u.getElementIndex(p,p)];var v=e[u.getElementIndex(d,d)];var _=e[u.getElementIndex(p,d)];var g=(m-v)/2/_;var y;if(g<0){y=-1/(-g+Math.sqrt(1+g*g))}else{y=1/(g+Math.sqrt(1+g*g))}l=1/Math.sqrt(1+y*y);c=y*l}t=u.clone(u.IDENTITY,t);t[u.getElementIndex(d,d)]=t[u.getElementIndex(p,p)]=l;t[u.getElementIndex(p,d)]=c;t[u.getElementIndex(d,p)]=-c;return t}var v=new u;var _=new u;u.computeEigenDecomposition=function(e,r){t.typeOf.object("matrix",e);var n=s.EPSILON20;var a=10;var o=0;var l=0;if(!i(r)){r={}}var c=r.unitary=u.clone(u.IDENTITY,r.unitary);var f=r.diagonal=u.clone(e,r.diagonal);var h=n*d(f);while(l<a&&p(f)>h){m(f,v);u.transpose(v,_);u.multiply(f,v,f);u.multiply(_,f,f);u.multiply(c,v,c);if(++o>2){++l;o=0}}return r};u.abs=function(e,r){t.typeOf.object("matrix",e);t.typeOf.object("result",r);r[0]=Math.abs(e[0]);r[1]=Math.abs(e[1]);r[2]=Math.abs(e[2]);r[3]=Math.abs(e[3]);r[4]=Math.abs(e[4]);r[5]=Math.abs(e[5]);r[6]=Math.abs(e[6]);r[7]=Math.abs(e[7]);r[8]=Math.abs(e[8]);return r};u.determinant=function(e){t.typeOf.object("matrix",e);var r=e[0];var i=e[3];var n=e[6];var a=e[1];var o=e[4];var s=e[7];var u=e[2];var l=e[5];var c=e[8];return r*(o*c-l*s)+a*(l*n-i*c)+u*(i*s-o*n)};u.inverse=function(e,r){t.typeOf.object("matrix",e);t.typeOf.object("result",r);var i=e[0];var n=e[1];var o=e[2];var l=e[3];var c=e[4];var d=e[5];var f=e[6];var h=e[7];var p=e[8];var m=u.determinant(e);if(Math.abs(m)<=s.EPSILON15){throw new a("matrix is not invertible")}r[0]=c*p-h*d;r[1]=h*o-n*p;r[2]=n*d-c*o;r[3]=f*d-l*p;r[4]=i*p-f*o;r[5]=l*o-i*d;r[6]=l*h-f*c;r[7]=f*n-i*h;r[8]=i*c-l*n;var v=1/m;return u.multiplyByScalar(r,v,r)};u.equals=function(e,t){return e===t||i(e)&&i(t)&&e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]};u.equalsEpsilon=function(e,r,n){t.typeOf.number("epsilon",n);return e===r||i(e)&&i(r)&&Math.abs(e[0]-r[0])<=n&&Math.abs(e[1]-r[1])<=n&&Math.abs(e[2]-r[2])<=n&&Math.abs(e[3]-r[3])<=n&&Math.abs(e[4]-r[4])<=n&&Math.abs(e[5]-r[5])<=n&&Math.abs(e[6]-r[6])<=n&&Math.abs(e[7]-r[7])<=n&&Math.abs(e[8]-r[8])<=n};u.IDENTITY=o(new u(1,0,0,0,1,0,0,0,1));u.ZERO=o(new u(0,0,0,0,0,0,0,0,0));u.COLUMN0ROW0=0;u.COLUMN0ROW1=1;u.COLUMN0ROW2=2;u.COLUMN1ROW0=3;u.COLUMN1ROW1=4;u.COLUMN1ROW2=5;u.COLUMN2ROW0=6;u.COLUMN2ROW1=7;u.COLUMN2ROW2=8;n(u.prototype,{length:{get:function(){return u.packedLength}}});u.prototype.clone=function(e){return u.clone(this,e)};u.prototype.equals=function(e){return u.equals(this,e)};u.equalsArray=function(e,t,r){return e[0]===t[r]&&e[1]===t[r+1]&&e[2]===t[r+2]&&e[3]===t[r+3]&&e[4]===t[r+4]&&e[5]===t[r+5]&&e[6]===t[r+6]&&e[7]===t[r+7]&&e[8]===t[r+8]};u.prototype.equalsEpsilon=function(e,t){return u.equalsEpsilon(this,e,t)};u.prototype.toString=function(){return"("+this[0]+", "+this[3]+", "+this[6]+")\n"+"("+this[1]+", "+this[4]+", "+this[7]+")\n"+"("+this[2]+", "+this[5]+", "+this[8]+")"};return u});define("Core/Cartesian4",["./Check","./defaultValue","./defined","./DeveloperError","./freezeObject","./Math"],function(e,t,r,i,n,a){"use strict";function o(e,r,i,n){this.x=t(e,0);this.y=t(r,0);this.z=t(i,0);this.w=t(n,0)}o.fromElements=function(e,t,i,n,a){if(!r(a)){return new o(e,t,i,n)}a.x=e;a.y=t;a.z=i;a.w=n;return a};o.fromColor=function(t,i){e.typeOf.object("color",t);if(!r(i)){return new o(t.red,t.green,t.blue,t.alpha)}i.x=t.red;i.y=t.green;i.z=t.blue;i.w=t.alpha;return i};o.clone=function(e,t){if(!r(e)){return undefined}if(!r(t)){return new o(e.x,e.y,e.z,e.w)}t.x=e.x;t.y=e.y;t.z=e.z;t.w=e.w;return t};o.packedLength=4;o.pack=function(r,i,n){e.typeOf.object("value",r);e.defined("array",i);n=t(n,0);i[n++]=r.x;i[n++]=r.y;i[n++]=r.z;i[n]=r.w;return i};o.unpack=function(i,n,a){e.defined("array",i);n=t(n,0);if(!r(a)){a=new o}a.x=i[n++];a.y=i[n++];a.z=i[n++];a.w=i[n];return a};o.packArray=function(t,i){e.defined("array",t);var n=t.length;if(!r(i)){i=new Array(n*4)}else{i.length=n*4}for(var a=0;a<n;++a){o.pack(t[a],i,a*4)}return i};o.unpackArray=function(t,i){e.defined("array",t);var n=t.length;if(!r(i)){i=new Array(n/4)}else{i.length=n/4}for(var a=0;a<n;a+=4){var s=a/4;i[s]=o.unpack(t,a,i[s])}return i};o.fromArray=o.unpack;o.maximumComponent=function(t){e.typeOf.object("cartesian",t);return Math.max(t.x,t.y,t.z,t.w)};o.minimumComponent=function(t){e.typeOf.object("cartesian",t);return Math.min(t.x,t.y,t.z,t.w)};o.minimumByComponent=function(t,r,i){e.typeOf.object("first",t);e.typeOf.object("second",r);e.typeOf.object("result",i);i.x=Math.min(t.x,r.x);i.y=Math.min(t.y,r.y);i.z=Math.min(t.z,r.z);i.w=Math.min(t.w,r.w);return i};o.maximumByComponent=function(t,r,i){e.typeOf.object("first",t);e.typeOf.object("second",r);e.typeOf.object("result",i);i.x=Math.max(t.x,r.x);i.y=Math.max(t.y,r.y);i.z=Math.max(t.z,r.z);i.w=Math.max(t.w,r.w);return i};o.magnitudeSquared=function(t){e.typeOf.object("cartesian",t);return t.x*t.x+t.y*t.y+t.z*t.z+t.w*t.w};o.magnitude=function(e){return Math.sqrt(o.magnitudeSquared(e))};var s=new o;o.distance=function(t,r){e.typeOf.object("left",t);e.typeOf.object("right",r);o.subtract(t,r,s);return o.magnitude(s)};o.distanceSquared=function(t,r){e.typeOf.object("left",t);e.typeOf.object("right",r);o.subtract(t,r,s);return o.magnitudeSquared(s)};o.normalize=function(t,r){e.typeOf.object("cartesian",t);e.typeOf.object("result",r);var n=o.magnitude(t);r.x=t.x/n;r.y=t.y/n;r.z=t.z/n;r.w=t.w/n;if(isNaN(r.x)||isNaN(r.y)||isNaN(r.z)||isNaN(r.w)){throw new i("normalized result is not a number")}return r};o.dot=function(t,r){e.typeOf.object("left",t);e.typeOf.object("right",r);return t.x*r.x+t.y*r.y+t.z*r.z+t.w*r.w};o.multiplyComponents=function(t,r,i){e.typeOf.object("left",t);e.typeOf.object("right",r);e.typeOf.object("result",i);i.x=t.x*r.x;i.y=t.y*r.y;i.z=t.z*r.z;i.w=t.w*r.w;return i};o.divideComponents=function(t,r,i){e.typeOf.object("left",t);e.typeOf.object("right",r);e.typeOf.object("result",i);i.x=t.x/r.x;i.y=t.y/r.y;i.z=t.z/r.z;i.w=t.w/r.w;return i};o.add=function(t,r,i){e.typeOf.object("left",t);e.typeOf.object("right",r);e.typeOf.object("result",i);i.x=t.x+r.x;i.y=t.y+r.y;i.z=t.z+r.z;i.w=t.w+r.w;return i};o.subtract=function(t,r,i){e.typeOf.object("left",t);e.typeOf.object("right",r);e.typeOf.object("result",i);i.x=t.x-r.x;i.y=t.y-r.y;i.z=t.z-r.z;i.w=t.w-r.w;return i};o.multiplyByScalar=function(t,r,i){e.typeOf.object("cartesian",t);e.typeOf.number("scalar",r);e.typeOf.object("result",i);i.x=t.x*r;i.y=t.y*r;i.z=t.z*r;i.w=t.w*r;return i};o.divideByScalar=function(t,r,i){e.typeOf.object("cartesian",t);e.typeOf.number("scalar",r);e.typeOf.object("result",i);i.x=t.x/r;i.y=t.y/r;i.z=t.z/r;i.w=t.w/r;return i};o.negate=function(t,r){e.typeOf.object("cartesian",t);e.typeOf.object("result",r);r.x=-t.x;r.y=-t.y;r.z=-t.z;r.w=-t.w;return r};o.abs=function(t,r){e.typeOf.object("cartesian",t);e.typeOf.object("result",r);r.x=Math.abs(t.x);r.y=Math.abs(t.y);r.z=Math.abs(t.z);r.w=Math.abs(t.w);return r};var u=new o;o.lerp=function(t,r,i,n){e.typeOf.object("start",t);e.typeOf.object("end",r);e.typeOf.number("t",i);e.typeOf.object("result",n);o.multiplyByScalar(r,i,u);n=o.multiplyByScalar(t,1-i,n);return o.add(u,n,n)};var l=new o;o.mostOrthogonalAxis=function(t,r){e.typeOf.object("cartesian",t);e.typeOf.object("result",r);var i=o.normalize(t,l);o.abs(i,i);if(i.x<=i.y){if(i.x<=i.z){if(i.x<=i.w){r=o.clone(o.UNIT_X,r)}else{r=o.clone(o.UNIT_W,r)}}else if(i.z<=i.w){r=o.clone(o.UNIT_Z,r)}else{r=o.clone(o.UNIT_W,r)}}else if(i.y<=i.z){if(i.y<=i.w){r=o.clone(o.UNIT_Y,r)}else{r=o.clone(o.UNIT_W,r)}}else if(i.z<=i.w){r=o.clone(o.UNIT_Z,r)}else{r=o.clone(o.UNIT_W,r)}return r};o.equals=function(e,t){return e===t||r(e)&&r(t)&&e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w};o.equalsArray=function(e,t,r){return e.x===t[r]&&e.y===t[r+1]&&e.z===t[r+2]&&e.w===t[r+3]};o.equalsEpsilon=function(e,t,i,n){return e===t||r(e)&&r(t)&&a.equalsEpsilon(e.x,t.x,i,n)&&a.equalsEpsilon(e.y,t.y,i,n)&&a.equalsEpsilon(e.z,t.z,i,n)&&a.equalsEpsilon(e.w,t.w,i,n)};o.ZERO=n(new o(0,0,0,0));o.UNIT_X=n(new o(1,0,0,0));o.UNIT_Y=n(new o(0,1,0,0));o.UNIT_Z=n(new o(0,0,1,0));o.UNIT_W=n(new o(0,0,0,1));o.prototype.clone=function(e){return o.clone(this,e)};o.prototype.equals=function(e){return o.equals(this,e)};o.prototype.equalsEpsilon=function(e,t,r){return o.equalsEpsilon(this,e,t,r)};o.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+", "+this.w+")"};return o});define("Core/RuntimeError",["./defined"],function(e){"use strict";function t(e){this.name="RuntimeError";this.message=e;var t;try{throw new Error}catch(e){t=e.stack}this.stack=t}if(e(Object.create)){t.prototype=Object.create(Error.prototype);t.prototype.constructor=t}t.prototype.toString=function(){var t=this.name+": "+this.message;if(e(this.stack)){t+="\n"+this.stack.toString()}return t};return t});define("Core/Matrix4",["./Cartesian3","./Cartesian4","./Check","./defaultValue","./defined","./defineProperties","./freezeObject","./Math","./Matrix3","./RuntimeError"],function(e,t,r,i,n,a,o,s,u,l){"use strict";function c(e,t,r,n,a,o,s,u,l,c,d,f,h,p,m,v){this[0]=i(e,0);this[1]=i(a,0);this[2]=i(l,0);this[3]=i(h,0);this[4]=i(t,0);this[5]=i(o,0);this[6]=i(c,0);this[7]=i(p,0);this[8]=i(r,0);this[9]=i(s,0);this[10]=i(d,0);this[11]=i(m,0);this[12]=i(n,0);this[13]=i(u,0);this[14]=i(f,0);this[15]=i(v,0)}c.packedLength=16;c.pack=function(e,t,n){r.typeOf.object("value",e);r.defined("array",t);n=i(n,0);t[n++]=e[0];t[n++]=e[1];t[n++]=e[2];t[n++]=e[3];t[n++]=e[4];t[n++]=e[5];t[n++]=e[6];t[n++]=e[7];t[n++]=e[8];t[n++]=e[9];t[n++]=e[10];t[n++]=e[11];t[n++]=e[12];t[n++]=e[13];t[n++]=e[14];t[n]=e[15];return t};c.unpack=function(e,t,a){r.defined("array",e);t=i(t,0);if(!n(a)){a=new c}a[0]=e[t++];a[1]=e[t++];a[2]=e[t++];a[3]=e[t++];a[4]=e[t++];a[5]=e[t++];a[6]=e[t++];a[7]=e[t++];a[8]=e[t++];a[9]=e[t++];a[10]=e[t++];a[11]=e[t++];a[12]=e[t++];a[13]=e[t++];a[14]=e[t++];a[15]=e[t];return a};c.clone=function(e,t){if(!n(e)){return undefined}if(!n(t)){return new c(e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14],e[3],e[7],e[11],e[15])}t[0]=e[0];t[1]=e[1];t[2]=e[2];t[3]=e[3];t[4]=e[4];t[5]=e[5];t[6]=e[6];t[7]=e[7];t[8]=e[8];t[9]=e[9];t[10]=e[10];t[11]=e[11];t[12]=e[12];t[13]=e[13];t[14]=e[14];t[15]=e[15];return t};c.fromArray=c.unpack;c.fromColumnMajorArray=function(e,t){r.defined("values",e);return c.clone(e,t)};c.fromRowMajorArray=function(e,t){r.defined("values",e);if(!n(t)){return new c(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}t[0]=e[0];t[1]=e[4];t[2]=e[8];t[3]=e[12];t[4]=e[1];t[5]=e[5];t[6]=e[9];t[7]=e[13];t[8]=e[2];t[9]=e[6];t[10]=e[10];t[11]=e[14];t[12]=e[3];t[13]=e[7];t[14]=e[11];t[15]=e[15];return t};c.fromRotationTranslation=function(t,a,o){r.typeOf.object("rotation",t);a=i(a,e.ZERO);if(!n(o)){return new c(t[0],t[3],t[6],a.x,t[1],t[4],t[7],a.y,t[2],t[5],t[8],a.z,0,0,0,1)}o[0]=t[0];o[1]=t[1];o[2]=t[2];o[3]=0;o[4]=t[3];o[5]=t[4];o[6]=t[5];o[7]=0;o[8]=t[6];o[9]=t[7];o[10]=t[8];o[11]=0;o[12]=a.x;o[13]=a.y;o[14]=a.z;o[15]=1;return o};c.fromTranslationQuaternionRotationScale=function(e,t,i,a){r.typeOf.object("translation",e);r.typeOf.object("rotation",t);r.typeOf.object("scale",i);if(!n(a)){a=new c}var o=i.x;var s=i.y;var u=i.z;var l=t.x*t.x;var d=t.x*t.y;var f=t.x*t.z;var h=t.x*t.w;var p=t.y*t.y;var m=t.y*t.z;var v=t.y*t.w;var _=t.z*t.z;var g=t.z*t.w;var y=t.w*t.w;var w=l-p-_+y;var C=2*(d-g);var b=2*(f+v);var S=2*(d+g);var E=-l+p-_+y;var T=2*(m-h);var x=2*(f-v);var A=2*(m+h);var P=-l-p+_+y;a[0]=w*o;a[1]=S*o;a[2]=x*o;a[3]=0;a[4]=C*s;a[5]=E*s;a[6]=A*s;a[7]=0;a[8]=b*u;a[9]=T*u;a[10]=P*u;a[11]=0;a[12]=e.x;a[13]=e.y;a[14]=e.z;a[15]=1;return a};c.fromTranslationRotationScale=function(e,t){r.typeOf.object("translationRotationScale",e);return c.fromTranslationQuaternionRotationScale(e.translation,e.rotation,e.scale,t)};c.fromTranslation=function(e,t){r.typeOf.object("translation",e);return c.fromRotationTranslation(u.IDENTITY,e,t)};c.fromScale=function(e,t){r.typeOf.object("scale",e);if(!n(t)){return new c(e.x,0,0,0,0,e.y,0,0,0,0,e.z,0,0,0,0,1)}t[0]=e.x;t[1]=0;t[2]=0;t[3]=0;t[4]=0;t[5]=e.y;t[6]=0;t[7]=0;t[8]=0;t[9]=0;t[10]=e.z;t[11]=0;t[12]=0;t[13]=0;t[14]=0;t[15]=1;return t};c.fromUniformScale=function(e,t){r.typeOf.number("scale",e);if(!n(t)){return new c(e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,1)}t[0]=e;t[1]=0;t[2]=0;t[3]=0;t[4]=0;t[5]=e;t[6]=0;t[7]=0;t[8]=0;t[9]=0;t[10]=e;t[11]=0;t[12]=0;t[13]=0;t[14]=0;t[15]=1;return t};var d=new e;var f=new e;var h=new e;c.fromCamera=function(t,i){r.typeOf.object("camera",t);var a=t.position;var o=t.direction;var s=t.up;r.typeOf.object("camera.position",a);r.typeOf.object("camera.direction",o);r.typeOf.object("camera.up",s);e.normalize(o,d);e.normalize(e.cross(d,s,f),f);e.normalize(e.cross(f,d,h),h);var u=f.x;var l=f.y;var p=f.z;var m=d.x;var v=d.y;var _=d.z;var g=h.x;var y=h.y;var w=h.z;var C=a.x;var b=a.y;var S=a.z;var E=u*-C+l*-b+p*-S;var T=g*-C+y*-b+w*-S;var x=m*C+v*b+_*S;if(!n(i)){return new c(u,l,p,E,g,y,w,T,-m,-v,-_,x,0,0,0,1)}i[0]=u;i[1]=g;i[2]=-m;i[3]=0;i[4]=l;i[5]=y;i[6]=-v;i[7]=0;i[8]=p;i[9]=w;i[10]=-_;i[11]=0;i[12]=E;i[13]=T;i[14]=x;i[15]=1;return i};c.computePerspectiveFieldOfView=function(e,t,i,n,a){r.typeOf.number.greaterThan("fovY",e,0);r.typeOf.number.lessThan("fovY",e,Math.PI);r.typeOf.number.greaterThan("near",i,0);r.typeOf.number.greaterThan("far",n,0);r.typeOf.object("result",a);var o=Math.tan(e*.5);var s=1/o;var u=s/t;var l=(n+i)/(i-n);var c=2*n*i/(i-n);a[0]=u;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=s;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=l;a[11]=-1;a[12]=0;a[13]=0;a[14]=c;a[15]=0;return a};c.computeOrthographicOffCenter=function(e,t,i,n,a,o,s){r.typeOf.number("left",e);r.typeOf.number("right",t);r.typeOf.number("bottom",i);r.typeOf.number("top",n);r.typeOf.number("near",a);r.typeOf.number("far",o);r.typeOf.object("result",s);var u=1/(t-e);var l=1/(n-i);var c=1/(o-a);var d=-(t+e)*u;var f=-(n+i)*l;var h=-(o+a)*c;u*=2;l*=2;c*=-2;s[0]=u;s[1]=0;s[2]=0;s[3]=0;s[4]=0;s[5]=l;s[6]=0;s[7]=0;s[8]=0;s[9]=0;s[10]=c;s[11]=0;s[12]=d;s[13]=f;s[14]=h;s[15]=1;return s};c.computePerspectiveOffCenter=function(e,t,i,n,a,o,s){r.typeOf.number("left",e);r.typeOf.number("right",t);r.typeOf.number("bottom",i);r.typeOf.number("top",n);r.typeOf.number("near",a);r.typeOf.number("far",o);r.typeOf.object("result",s);var u=2*a/(t-e);var l=2*a/(n-i);var c=(t+e)/(t-e);var d=(n+i)/(n-i);var f=-(o+a)/(o-a);var h=-1;var p=-2*o*a/(o-a);s[0]=u;s[1]=0;s[2]=0;s[3]=0;s[4]=0;s[5]=l;s[6]=0;s[7]=0;s[8]=c;s[9]=d;s[10]=f;s[11]=h;s[12]=0;s[13]=0;s[14]=p;s[15]=0;return s};c.computeInfinitePerspectiveOffCenter=function(e,t,i,n,a,o){r.typeOf.number("left",e);r.typeOf.number("right",t);r.typeOf.number("bottom",i);r.typeOf.number("top",n);r.typeOf.number("near",a);r.typeOf.object("result",o);var s=2*a/(t-e);var u=2*a/(n-i);var l=(t+e)/(t-e);var c=(n+i)/(n-i);var d=-1;var f=-1;var h=-2*a;o[0]=s;o[1]=0;o[2]=0;o[3]=0;o[4]=0;o[5]=u;o[6]=0;o[7]=0;o[8]=l;o[9]=c;o[10]=d;o[11]=f;o[12]=0;o[13]=0;o[14]=h;o[15]=0;return o};c.computeViewportTransformation=function(e,t,n,a){r.typeOf.object("result",a);e=i(e,i.EMPTY_OBJECT);var o=i(e.x,0);var s=i(e.y,0);var u=i(e.width,0);var l=i(e.height,0);t=i(t,0);n=i(n,1);var c=u*.5;var d=l*.5;var f=(n-t)*.5;var h=c;var p=d;var m=f;var v=o+c;var _=s+d;var g=t+f;var y=1;a[0]=h;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=p;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=m;a[11]=0;a[12]=v;a[13]=_;a[14]=g;a[15]=y;return a};c.computeView=function(t,i,n,a,o){r.typeOf.object("position",t);r.typeOf.object("direction",i);r.typeOf.object("up",n);r.typeOf.object("right",a);r.typeOf.object("result",o);o[0]=a.x;o[1]=n.x;o[2]=-i.x;o[3]=0;o[4]=a.y;o[5]=n.y;o[6]=-i.y;o[7]=0;o[8]=a.z;o[9]=n.z;o[10]=-i.z;o[11]=0;o[12]=-e.dot(a,t);o[13]=-e.dot(n,t);o[14]=e.dot(i,t);o[15]=1;return o};c.toArray=function(e,t){r.typeOf.object("matrix",e);if(!n(t)){return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]]}t[0]=e[0];t[1]=e[1];t[2]=e[2];t[3]=e[3];t[4]=e[4];t[5]=e[5];t[6]=e[6];t[7]=e[7];t[8]=e[8];t[9]=e[9];t[10]=e[10];t[11]=e[11];t[12]=e[12];t[13]=e[13];t[14]=e[14];t[15]=e[15];return t};c.getElementIndex=function(e,t){r.typeOf.number.greaterThanOrEquals("row",t,0);r.typeOf.number.lessThanOrEquals("row",t,3);r.typeOf.number.greaterThanOrEquals("column",e,0);r.typeOf.number.lessThanOrEquals("column",e,3);return e*4+t};c.getColumn=function(e,t,i){r.typeOf.object("matrix",e);r.typeOf.number.greaterThanOrEquals("index",t,0);r.typeOf.number.lessThanOrEquals("index",t,3);r.typeOf.object("result",i);var n=t*4;var a=e[n];var o=e[n+1];var s=e[n+2];var u=e[n+3];i.x=a;i.y=o;i.z=s;i.w=u;return i};c.setColumn=function(e,t,i,n){r.typeOf.object("matrix",e);r.typeOf.number.greaterThanOrEquals("index",t,0);r.typeOf.number.lessThanOrEquals("index",t,3);r.typeOf.object("cartesian",i);r.typeOf.object("result",n);n=c.clone(e,n);var a=t*4;n[a]=i.x;n[a+1]=i.y;n[a+2]=i.z;n[a+3]=i.w;return n};c.setTranslation=function(e,t,i){r.typeOf.object("matrix",e);r.typeOf.object("translation",t);r.typeOf.object("result",i);i[0]=e[0];i[1]=e[1];i[2]=e[2];i[3]=e[3];i[4]=e[4];i[5]=e[5];i[6]=e[6];i[7]=e[7];i[8]=e[8];i[9]=e[9];i[10]=e[10];i[11]=e[11];i[12]=t.x;i[13]=t.y;i[14]=t.z;i[15]=e[15];return i};c.getRow=function(e,t,i){r.typeOf.object("matrix",e);r.typeOf.number.greaterThanOrEquals("index",t,0);r.typeOf.number.lessThanOrEquals("index",t,3);r.typeOf.object("result",i);var n=e[t];var a=e[t+4];var o=e[t+8];var s=e[t+12];i.x=n;i.y=a;i.z=o;i.w=s;return i};c.setRow=function(e,t,i,n){r.typeOf.object("matrix",e);r.typeOf.number.greaterThanOrEquals("index",t,0);r.typeOf.number.lessThanOrEquals("index",t,3);r.typeOf.object("cartesian",i);r.typeOf.object("result",n);n=c.clone(e,n);n[t]=i.x;n[t+4]=i.y;n[t+8]=i.z;n[t+12]=i.w;return n};var p=new e;c.getScale=function(t,i){r.typeOf.object("matrix",t);r.typeOf.object("result",i);i.x=e.magnitude(e.fromElements(t[0],t[1],t[2],p));i.y=e.magnitude(e.fromElements(t[4],t[5],t[6],p));i.z=e.magnitude(e.fromElements(t[8],t[9],t[10],p));return i};var m=new e;c.getMaximumScale=function(t){c.getScale(t,m);return e.maximumComponent(m)};c.multiply=function(e,t,i){r.typeOf.object("left",e);r.typeOf.object("right",t);r.typeOf.object("result",i);var n=e[0];var a=e[1];var o=e[2];var s=e[3];var u=e[4];var l=e[5];var c=e[6];var d=e[7];var f=e[8];var h=e[9];var p=e[10];var m=e[11];var v=e[12];var _=e[13];var g=e[14];var y=e[15];var w=t[0];var C=t[1];var b=t[2];var S=t[3];var E=t[4];var T=t[5];var x=t[6];var A=t[7];var P=t[8];var D=t[9];var M=t[10];var I=t[11];var O=t[12];var R=t[13];var N=t[14];var L=t[15];var B=n*w+u*C+f*b+v*S;var F=a*w+l*C+h*b+_*S;var k=o*w+c*C+p*b+g*S;var V=s*w+d*C+m*b+y*S;var z=n*E+u*T+f*x+v*A;var U=a*E+l*T+h*x+_*A;var q=o*E+c*T+p*x+g*A;var G=s*E+d*T+m*x+y*A;var H=n*P+u*D+f*M+v*I;var W=a*P+l*D+h*M+_*I;var j=o*P+c*D+p*M+g*I;var Y=s*P+d*D+m*M+y*I;var X=n*O+u*R+f*N+v*L;var Z=a*O+l*R+h*N+_*L;var K=o*O+c*R+p*N+g*L;var Q=s*O+d*R+m*N+y*L;i[0]=B;i[1]=F;i[2]=k;i[3]=V;i[4]=z;i[5]=U;i[6]=q;i[7]=G;i[8]=H;i[9]=W;i[10]=j;i[11]=Y;i[12]=X;i[13]=Z;i[14]=K;i[15]=Q;return i};c.add=function(e,t,i){r.typeOf.object("left",e);r.typeOf.object("right",t);r.typeOf.object("result",i);i[0]=e[0]+t[0];i[1]=e[1]+t[1];i[2]=e[2]+t[2];i[3]=e[3]+t[3];i[4]=e[4]+t[4];i[5]=e[5]+t[5];i[6]=e[6]+t[6];i[7]=e[7]+t[7];i[8]=e[8]+t[8];i[9]=e[9]+t[9];i[10]=e[10]+t[10];i[11]=e[11]+t[11];i[12]=e[12]+t[12];i[13]=e[13]+t[13];i[14]=e[14]+t[14];i[15]=e[15]+t[15];return i};c.subtract=function(e,t,i){r.typeOf.object("left",e);r.typeOf.object("right",t);r.typeOf.object("result",i);i[0]=e[0]-t[0];i[1]=e[1]-t[1];i[2]=e[2]-t[2];i[3]=e[3]-t[3];i[4]=e[4]-t[4];i[5]=e[5]-t[5];i[6]=e[6]-t[6];i[7]=e[7]-t[7];i[8]=e[8]-t[8];i[9]=e[9]-t[9];i[10]=e[10]-t[10];i[11]=e[11]-t[11];i[12]=e[12]-t[12];i[13]=e[13]-t[13];i[14]=e[14]-t[14];i[15]=e[15]-t[15];return i};c.multiplyTransformation=function(e,t,i){r.typeOf.object("left",e);r.typeOf.object("right",t);r.typeOf.object("result",i);var n=e[0];var a=e[1];var o=e[2];var s=e[4];var u=e[5];var l=e[6];var c=e[8];var d=e[9];var f=e[10];var h=e[12];var p=e[13];var m=e[14];var v=t[0];var _=t[1];var g=t[2];var y=t[4];var w=t[5];var C=t[6];var b=t[8];var S=t[9];var E=t[10];var T=t[12];var x=t[13];var A=t[14];var P=n*v+s*_+c*g;var D=a*v+u*_+d*g;var M=o*v+l*_+f*g;var I=n*y+s*w+c*C;var O=a*y+u*w+d*C;var R=o*y+l*w+f*C;var N=n*b+s*S+c*E;var L=a*b+u*S+d*E;var B=o*b+l*S+f*E;var F=n*T+s*x+c*A+h;var k=a*T+u*x+d*A+p;var V=o*T+l*x+f*A+m;i[0]=P;i[1]=D;i[2]=M;i[3]=0;i[4]=I;i[5]=O;i[6]=R;i[7]=0;i[8]=N;i[9]=L;i[10]=B;i[11]=0;i[12]=F;i[13]=k;i[14]=V;i[15]=1;return i};c.multiplyByMatrix3=function(e,t,i){r.typeOf.object("matrix",e);r.typeOf.object("rotation",t);r.typeOf.object("result",i);var n=e[0];var a=e[1];var o=e[2];var s=e[4];var u=e[5];var l=e[6];var c=e[8];var d=e[9];var f=e[10];var h=t[0];var p=t[1];var m=t[2];var v=t[3];var _=t[4];var g=t[5];var y=t[6];var w=t[7];var C=t[8];var b=n*h+s*p+c*m;var S=a*h+u*p+d*m;var E=o*h+l*p+f*m;var T=n*v+s*_+c*g;var x=a*v+u*_+d*g;var A=o*v+l*_+f*g;var P=n*y+s*w+c*C;var D=a*y+u*w+d*C;var M=o*y+l*w+f*C;i[0]=b;i[1]=S;i[2]=E;i[3]=0;i[4]=T;i[5]=x;i[6]=A;i[7]=0;i[8]=P;i[9]=D;i[10]=M;i[11]=0;i[12]=e[12];i[13]=e[13];i[14]=e[14];i[15]=e[15];return i};c.multiplyByTranslation=function(e,t,i){r.typeOf.object("matrix",e);r.typeOf.object("translation",t);r.typeOf.object("result",i);var n=t.x;var a=t.y;var o=t.z;var s=n*e[0]+a*e[4]+o*e[8]+e[12];var u=n*e[1]+a*e[5]+o*e[9]+e[13];var l=n*e[2]+a*e[6]+o*e[10]+e[14];i[0]=e[0];i[1]=e[1];i[2]=e[2];i[3]=e[3];i[4]=e[4];i[5]=e[5];i[6]=e[6];i[7]=e[7];i[8]=e[8];i[9]=e[9];i[10]=e[10];i[11]=e[11];i[12]=s;i[13]=u;i[14]=l;i[15]=e[15];return i};var v=new e;c.multiplyByUniformScale=function(e,t,i){r.typeOf.object("matrix",e);r.typeOf.number("scale",t);r.typeOf.object("result",i);v.x=t;v.y=t;v.z=t;return c.multiplyByScale(e,v,i)};c.multiplyByScale=function(e,t,i){r.typeOf.object("matrix",e);r.typeOf.object("scale",t);r.typeOf.object("result",i);var n=t.x;var a=t.y;var o=t.z;if(n===1&&a===1&&o===1){return c.clone(e,i)}i[0]=n*e[0];i[1]=n*e[1];i[2]=n*e[2];i[3]=0;i[4]=a*e[4];i[5]=a*e[5];i[6]=a*e[6];i[7]=0;i[8]=o*e[8];i[9]=o*e[9];i[10]=o*e[10];i[11]=0;i[12]=e[12];i[13]=e[13];i[14]=e[14];i[15]=1;return i};c.multiplyByVector=function(e,t,i){r.typeOf.object("matrix",e);r.typeOf.object("cartesian",t);r.typeOf.object("result",i);var n=t.x;var a=t.y;var o=t.z;var s=t.w;var u=e[0]*n+e[4]*a+e[8]*o+e[12]*s;var l=e[1]*n+e[5]*a+e[9]*o+e[13]*s;var c=e[2]*n+e[6]*a+e[10]*o+e[14]*s;var d=e[3]*n+e[7]*a+e[11]*o+e[15]*s;i.x=u;i.y=l;i.z=c;i.w=d;return i};c.multiplyByPointAsVector=function(e,t,i){r.typeOf.object("matrix",e);r.typeOf.object("cartesian",t);r.typeOf.object("result",i);var n=t.x;var a=t.y;var o=t.z;var s=e[0]*n+e[4]*a+e[8]*o;var u=e[1]*n+e[5]*a+e[9]*o;var l=e[2]*n+e[6]*a+e[10]*o;i.x=s;i.y=u;i.z=l;return i};c.multiplyByPoint=function(e,t,i){r.typeOf.object("matrix",e);r.typeOf.object("cartesian",t);r.typeOf.object("result",i);var n=t.x;var a=t.y;var o=t.z;var s=e[0]*n+e[4]*a+e[8]*o+e[12];var u=e[1]*n+e[5]*a+e[9]*o+e[13];var l=e[2]*n+e[6]*a+e[10]*o+e[14];i.x=s;i.y=u;i.z=l;return i};c.multiplyByScalar=function(e,t,i){r.typeOf.object("matrix",e);r.typeOf.number("scalar",t);r.typeOf.object("result",i);i[0]=e[0]*t;i[1]=e[1]*t;i[2]=e[2]*t;i[3]=e[3]*t;i[4]=e[4]*t;i[5]=e[5]*t;i[6]=e[6]*t;i[7]=e[7]*t;i[8]=e[8]*t;i[9]=e[9]*t;i[10]=e[10]*t;i[11]=e[11]*t;i[12]=e[12]*t;i[13]=e[13]*t;i[14]=e[14]*t;i[15]=e[15]*t;return i};c.negate=function(e,t){r.typeOf.object("matrix",e);r.typeOf.object("result",t);t[0]=-e[0];t[1]=-e[1];t[2]=-e[2];t[3]=-e[3];t[4]=-e[4];t[5]=-e[5];t[6]=-e[6];t[7]=-e[7];t[8]=-e[8];t[9]=-e[9];t[10]=-e[10];t[11]=-e[11];t[12]=-e[12];t[13]=-e[13];t[14]=-e[14];t[15]=-e[15];return t};c.transpose=function(e,t){r.typeOf.object("matrix",e);r.typeOf.object("result",t);var i=e[1];var n=e[2];var a=e[3];var o=e[6];var s=e[7];var u=e[11];t[0]=e[0];t[1]=e[4];t[2]=e[8];t[3]=e[12];t[4]=i;t[5]=e[5];t[6]=e[9];t[7]=e[13];t[8]=n;t[9]=o;t[10]=e[10];t[11]=e[14];t[12]=a;t[13]=s;t[14]=u;t[15]=e[15];return t};c.abs=function(e,t){r.typeOf.object("matrix",e);r.typeOf.object("result",t);t[0]=Math.abs(e[0]);t[1]=Math.abs(e[1]);t[2]=Math.abs(e[2]);t[3]=Math.abs(e[3]);t[4]=Math.abs(e[4]);t[5]=Math.abs(e[5]);t[6]=Math.abs(e[6]);t[7]=Math.abs(e[7]);t[8]=Math.abs(e[8]);t[9]=Math.abs(e[9]);t[10]=Math.abs(e[10]);t[11]=Math.abs(e[11]);t[12]=Math.abs(e[12]);t[13]=Math.abs(e[13]);t[14]=Math.abs(e[14]);t[15]=Math.abs(e[15]);return t};c.equals=function(e,t){return e===t||n(e)&&n(t)&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[3]===t[3]&&e[7]===t[7]&&e[11]===t[11]&&e[15]===t[15]};c.equalsEpsilon=function(e,t,i){r.typeOf.number("epsilon",i);return e===t||n(e)&&n(t)&&Math.abs(e[0]-t[0])<=i&&Math.abs(e[1]-t[1])<=i&&Math.abs(e[2]-t[2])<=i&&Math.abs(e[3]-t[3])<=i&&Math.abs(e[4]-t[4])<=i&&Math.abs(e[5]-t[5])<=i&&Math.abs(e[6]-t[6])<=i&&Math.abs(e[7]-t[7])<=i&&Math.abs(e[8]-t[8])<=i&&Math.abs(e[9]-t[9])<=i&&Math.abs(e[10]-t[10])<=i&&Math.abs(e[11]-t[11])<=i&&Math.abs(e[12]-t[12])<=i&&Math.abs(e[13]-t[13])<=i&&Math.abs(e[14]-t[14])<=i&&Math.abs(e[15]-t[15])<=i};c.getTranslation=function(e,t){r.typeOf.object("matrix",e);r.typeOf.object("result",t);t.x=e[12];t.y=e[13];t.z=e[14];return t};c.getRotation=function(e,t){r.typeOf.object("matrix",e);r.typeOf.object("result",t);t[0]=e[0];t[1]=e[1];t[2]=e[2];t[3]=e[4];t[4]=e[5];t[5]=e[6];t[6]=e[8];t[7]=e[9];t[8]=e[10];return t};var _=new u;var g=new u;var y=new t;var w=new t(0,0,0,1);c.inverse=function(e,i){r.typeOf.object("matrix",e);r.typeOf.object("result",i);if(u.equalsEpsilon(c.getRotation(e,_),g,s.EPSILON7)&&t.equals(c.getRow(e,3,y),w)){i[0]=0;i[1]=0;i[2]=0;i[3]=0;i[4]=0;i[5]=0;i[6]=0;i[7]=0;i[8]=0;i[9]=0;i[10]=0;i[11]=0;i[12]=-e[12];i[13]=-e[13];i[14]=-e[14];i[15]=1;return i}var n=e[0];var a=e[4];var o=e[8];var d=e[12];var f=e[1];var h=e[5];var p=e[9];var m=e[13];var v=e[2];var C=e[6];var b=e[10];var S=e[14];var E=e[3];var T=e[7];var x=e[11];var A=e[15];var P=b*A;var D=S*x;var M=C*A;var I=S*T;var O=C*x;var R=b*T;var N=v*A;var L=S*E;var B=v*x;var F=b*E;var k=v*T;var V=C*E;var z=P*h+I*p+O*m-(D*h+M*p+R*m);var U=D*f+N*p+F*m-(P*f+L*p+B*m);var q=M*f+L*h+k*m-(I*f+N*h+V*m);var G=R*f+B*h+V*p-(O*f+F*h+k*p);var H=D*a+M*o+R*d-(P*a+I*o+O*d);var W=P*n+L*o+B*d-(D*n+N*o+F*d)
;var j=I*n+N*a+V*d-(M*n+L*a+k*d);var Y=O*n+F*a+k*o-(R*n+B*a+V*o);P=o*m;D=d*p;M=a*m;I=d*h;O=a*p;R=o*h;N=n*m;L=d*f;B=n*p;F=o*f;k=n*h;V=a*f;var X=P*T+I*x+O*A-(D*T+M*x+R*A);var Z=D*E+N*x+F*A-(P*E+L*x+B*A);var K=M*E+L*T+k*A-(I*E+N*T+V*A);var Q=R*E+B*T+V*x-(O*E+F*T+k*x);var J=M*b+R*S+D*C-(O*S+P*C+I*b);var $=B*S+P*v+L*b-(N*b+F*S+D*v);var ee=N*C+V*S+I*v-(k*S+M*v+L*C);var te=k*b+O*v+F*C-(B*C+V*b+R*v);var re=n*z+a*U+o*q+d*G;if(Math.abs(re)<s.EPSILON20){throw new l("matrix is not invertible because its determinate is zero.")}re=1/re;i[0]=z*re;i[1]=U*re;i[2]=q*re;i[3]=G*re;i[4]=H*re;i[5]=W*re;i[6]=j*re;i[7]=Y*re;i[8]=X*re;i[9]=Z*re;i[10]=K*re;i[11]=Q*re;i[12]=J*re;i[13]=$*re;i[14]=ee*re;i[15]=te*re;return i};c.inverseTransformation=function(e,t){r.typeOf.object("matrix",e);r.typeOf.object("result",t);var i=e[0];var n=e[1];var a=e[2];var o=e[4];var s=e[5];var u=e[6];var l=e[8];var c=e[9];var d=e[10];var f=e[12];var h=e[13];var p=e[14];var m=-i*f-n*h-a*p;var v=-o*f-s*h-u*p;var _=-l*f-c*h-d*p;t[0]=i;t[1]=o;t[2]=l;t[3]=0;t[4]=n;t[5]=s;t[6]=c;t[7]=0;t[8]=a;t[9]=u;t[10]=d;t[11]=0;t[12]=m;t[13]=v;t[14]=_;t[15]=1;return t};c.IDENTITY=o(new c(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1));c.ZERO=o(new c(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0));c.COLUMN0ROW0=0;c.COLUMN0ROW1=1;c.COLUMN0ROW2=2;c.COLUMN0ROW3=3;c.COLUMN1ROW0=4;c.COLUMN1ROW1=5;c.COLUMN1ROW2=6;c.COLUMN1ROW3=7;c.COLUMN2ROW0=8;c.COLUMN2ROW1=9;c.COLUMN2ROW2=10;c.COLUMN2ROW3=11;c.COLUMN3ROW0=12;c.COLUMN3ROW1=13;c.COLUMN3ROW2=14;c.COLUMN3ROW3=15;a(c.prototype,{length:{get:function(){return c.packedLength}}});c.prototype.clone=function(e){return c.clone(this,e)};c.prototype.equals=function(e){return c.equals(this,e)};c.equalsArray=function(e,t,r){return e[0]===t[r]&&e[1]===t[r+1]&&e[2]===t[r+2]&&e[3]===t[r+3]&&e[4]===t[r+4]&&e[5]===t[r+5]&&e[6]===t[r+6]&&e[7]===t[r+7]&&e[8]===t[r+8]&&e[9]===t[r+9]&&e[10]===t[r+10]&&e[11]===t[r+11]&&e[12]===t[r+12]&&e[13]===t[r+13]&&e[14]===t[r+14]&&e[15]===t[r+15]};c.prototype.equalsEpsilon=function(e,t){return c.equalsEpsilon(this,e,t)};c.prototype.toString=function(){return"("+this[0]+", "+this[4]+", "+this[8]+", "+this[12]+")\n"+"("+this[1]+", "+this[5]+", "+this[9]+", "+this[13]+")\n"+"("+this[2]+", "+this[6]+", "+this[10]+", "+this[14]+")\n"+"("+this[3]+", "+this[7]+", "+this[11]+", "+this[15]+")"};return c});define("Core/BoundingSphere",["./Cartesian3","./Cartographic","./Check","./defaultValue","./defined","./Ellipsoid","./GeographicProjection","./Intersect","./Interval","./Matrix3","./Matrix4","./Rectangle"],function(e,t,r,i,n,a,o,s,u,l,c,d){"use strict";function f(t,r){this.center=e.clone(i(t,e.ZERO));this.radius=i(r,0)}var h=new e;var p=new e;var m=new e;var v=new e;var _=new e;var g=new e;var y=new e;var w=new e;var C=new e;var b=new e;var S=new e;var E=new e;f.fromPoints=function(t,r){if(!n(r)){r=new f}if(!n(t)||t.length===0){r.center=e.clone(e.ZERO,r.center);r.radius=0;return r}var i=e.clone(t[0],y);var a=e.clone(i,h);var o=e.clone(i,p);var s=e.clone(i,m);var u=e.clone(i,v);var l=e.clone(i,_);var c=e.clone(i,g);var d=t.length;for(var T=1;T<d;T++){e.clone(t[T],i);var x=i.x;var A=i.y;var P=i.z;if(x<a.x){e.clone(i,a)}if(x>u.x){e.clone(i,u)}if(A<o.y){e.clone(i,o)}if(A>l.y){e.clone(i,l)}if(P<s.z){e.clone(i,s)}if(P>c.z){e.clone(i,c)}}var D=e.magnitudeSquared(e.subtract(u,a,w));var M=e.magnitudeSquared(e.subtract(l,o,w));var I=e.magnitudeSquared(e.subtract(c,s,w));var O=a;var R=u;var N=D;if(M>N){N=M;O=o;R=l}if(I>N){N=I;O=s;R=c}var L=C;L.x=(O.x+R.x)*.5;L.y=(O.y+R.y)*.5;L.z=(O.z+R.z)*.5;var B=e.magnitudeSquared(e.subtract(R,L,w));var F=Math.sqrt(B);var k=b;k.x=a.x;k.y=o.y;k.z=s.z;var V=S;V.x=u.x;V.y=l.y;V.z=c.z;var z=e.multiplyByScalar(e.add(k,V,w),.5,E);var U=0;for(T=0;T<d;T++){e.clone(t[T],i);var q=e.magnitude(e.subtract(i,z,w));if(q>U){U=q}var G=e.magnitudeSquared(e.subtract(i,L,w));if(G>B){var H=Math.sqrt(G);F=(F+H)*.5;B=F*F;var W=H-F;L.x=(F*L.x+W*i.x)/H;L.y=(F*L.y+W*i.y)/H;L.z=(F*L.z+W*i.z)/H}}if(F<U){e.clone(L,r.center);r.radius=F}else{e.clone(z,r.center);r.radius=U}return r};var T=new o;var x=new e;var A=new e;var P=new t;var D=new t;f.fromRectangle2D=function(e,t,r){return f.fromRectangleWithHeights2D(e,t,0,0,r)};f.fromRectangleWithHeights2D=function(t,r,a,o,s){if(!n(s)){s=new f}if(!n(t)){s.center=e.clone(e.ZERO,s.center);s.radius=0;return s}r=i(r,T);d.southwest(t,P);P.height=a;d.northeast(t,D);D.height=o;var u=r.project(P,x);var l=r.project(D,A);var c=l.x-u.x;var h=l.y-u.y;var p=l.z-u.z;s.radius=Math.sqrt(c*c+h*h+p*p)*.5;var m=s.center;m.x=u.x+c*.5;m.y=u.y+h*.5;m.z=u.z+p*.5;return s};var M=[];f.fromRectangle3D=function(e,t,r,o){t=i(t,a.WGS84);r=i(r,0);var s;if(n(e)){s=d.subsample(e,t,r,M)}return f.fromPoints(s,o)};f.fromVertices=function(t,a,o,s){if(!n(s)){s=new f}if(!n(t)||t.length===0){s.center=e.clone(e.ZERO,s.center);s.radius=0;return s}a=i(a,e.ZERO);o=i(o,3);r.typeOf.number.greaterThanOrEquals("stride",o,3);var u=y;u.x=t[0]+a.x;u.y=t[1]+a.y;u.z=t[2]+a.z;var l=e.clone(u,h);var c=e.clone(u,p);var d=e.clone(u,m);var T=e.clone(u,v);var x=e.clone(u,_);var A=e.clone(u,g);var P=t.length;for(var D=0;D<P;D+=o){var M=t[D]+a.x;var I=t[D+1]+a.y;var O=t[D+2]+a.z;u.x=M;u.y=I;u.z=O;if(M<l.x){e.clone(u,l)}if(M>T.x){e.clone(u,T)}if(I<c.y){e.clone(u,c)}if(I>x.y){e.clone(u,x)}if(O<d.z){e.clone(u,d)}if(O>A.z){e.clone(u,A)}}var R=e.magnitudeSquared(e.subtract(T,l,w));var N=e.magnitudeSquared(e.subtract(x,c,w));var L=e.magnitudeSquared(e.subtract(A,d,w));var B=l;var F=T;var k=R;if(N>k){k=N;B=c;F=x}if(L>k){k=L;B=d;F=A}var V=C;V.x=(B.x+F.x)*.5;V.y=(B.y+F.y)*.5;V.z=(B.z+F.z)*.5;var z=e.magnitudeSquared(e.subtract(F,V,w));var U=Math.sqrt(z);var q=b;q.x=l.x;q.y=c.y;q.z=d.z;var G=S;G.x=T.x;G.y=x.y;G.z=A.z;var H=e.multiplyByScalar(e.add(q,G,w),.5,E);var W=0;for(D=0;D<P;D+=o){u.x=t[D]+a.x;u.y=t[D+1]+a.y;u.z=t[D+2]+a.z;var j=e.magnitude(e.subtract(u,H,w));if(j>W){W=j}var Y=e.magnitudeSquared(e.subtract(u,V,w));if(Y>z){var X=Math.sqrt(Y);U=(U+X)*.5;z=U*U;var Z=X-U;V.x=(U*V.x+Z*u.x)/X;V.y=(U*V.y+Z*u.y)/X;V.z=(U*V.z+Z*u.z)/X}}if(U<W){e.clone(V,s.center);s.radius=U}else{e.clone(H,s.center);s.radius=W}return s};f.fromEncodedCartesianVertices=function(t,r,i){if(!n(i)){i=new f}if(!n(t)||!n(r)||t.length!==r.length||t.length===0){i.center=e.clone(e.ZERO,i.center);i.radius=0;return i}var a=y;a.x=t[0]+r[0];a.y=t[1]+r[1];a.z=t[2]+r[2];var o=e.clone(a,h);var s=e.clone(a,p);var u=e.clone(a,m);var l=e.clone(a,v);var c=e.clone(a,_);var d=e.clone(a,g);var T=t.length;for(var x=0;x<T;x+=3){var A=t[x]+r[x];var P=t[x+1]+r[x+1];var D=t[x+2]+r[x+2];a.x=A;a.y=P;a.z=D;if(A<o.x){e.clone(a,o)}if(A>l.x){e.clone(a,l)}if(P<s.y){e.clone(a,s)}if(P>c.y){e.clone(a,c)}if(D<u.z){e.clone(a,u)}if(D>d.z){e.clone(a,d)}}var M=e.magnitudeSquared(e.subtract(l,o,w));var I=e.magnitudeSquared(e.subtract(c,s,w));var O=e.magnitudeSquared(e.subtract(d,u,w));var R=o;var N=l;var L=M;if(I>L){L=I;R=s;N=c}if(O>L){L=O;R=u;N=d}var B=C;B.x=(R.x+N.x)*.5;B.y=(R.y+N.y)*.5;B.z=(R.z+N.z)*.5;var F=e.magnitudeSquared(e.subtract(N,B,w));var k=Math.sqrt(F);var V=b;V.x=o.x;V.y=s.y;V.z=u.z;var z=S;z.x=l.x;z.y=c.y;z.z=d.z;var U=e.multiplyByScalar(e.add(V,z,w),.5,E);var q=0;for(x=0;x<T;x+=3){a.x=t[x]+r[x];a.y=t[x+1]+r[x+1];a.z=t[x+2]+r[x+2];var G=e.magnitude(e.subtract(a,U,w));if(G>q){q=G}var H=e.magnitudeSquared(e.subtract(a,B,w));if(H>F){var W=Math.sqrt(H);k=(k+W)*.5;F=k*k;var j=W-k;B.x=(k*B.x+j*a.x)/W;B.y=(k*B.y+j*a.y)/W;B.z=(k*B.z+j*a.z)/W}}if(k<q){e.clone(B,i.center);i.radius=k}else{e.clone(U,i.center);i.radius=q}return i};f.fromCornerPoints=function(t,i,a){r.typeOf.object("corner",t);r.typeOf.object("oppositeCorner",i);if(!n(a)){a=new f}var o=a.center;e.add(t,i,o);e.multiplyByScalar(o,.5,o);a.radius=e.distance(o,i);return a};f.fromEllipsoid=function(t,i){r.typeOf.object("ellipsoid",t);if(!n(i)){i=new f}e.clone(e.ZERO,i.center);i.radius=t.maximumRadius;return i};var I=new e;f.fromBoundingSpheres=function(t,r){if(!n(r)){r=new f}if(!n(t)||t.length===0){r.center=e.clone(e.ZERO,r.center);r.radius=0;return r}var i=t.length;if(i===1){return f.clone(t[0],r)}if(i===2){return f.union(t[0],t[1],r)}var a=[];for(var o=0;o<i;o++){a.push(t[o].center)}r=f.fromPoints(a,r);var s=r.center;var u=r.radius;for(o=0;o<i;o++){var l=t[o];u=Math.max(u,e.distance(s,l.center,I)+l.radius)}r.radius=u;return r};var O=new e;var R=new e;var N=new e;f.fromOrientedBoundingBox=function(t,r){if(!n(r)){r=new f}var i=t.halfAxes;var a=l.getColumn(i,0,O);var o=l.getColumn(i,1,R);var s=l.getColumn(i,2,N);var u=e.magnitude(a);var c=e.magnitude(o);var d=e.magnitude(s);r.center=e.clone(t.center,r.center);r.radius=Math.max(u,c,d);return r};f.clone=function(t,r){if(!n(t)){return undefined}if(!n(r)){return new f(t.center,t.radius)}r.center=e.clone(t.center,r.center);r.radius=t.radius;return r};f.packedLength=4;f.pack=function(e,t,n){r.typeOf.object("value",e);r.defined("array",t);n=i(n,0);var a=e.center;t[n++]=a.x;t[n++]=a.y;t[n++]=a.z;t[n]=e.radius;return t};f.unpack=function(e,t,a){r.defined("array",e);t=i(t,0);if(!n(a)){a=new f}var o=a.center;o.x=e[t++];o.y=e[t++];o.z=e[t++];a.radius=e[t];return a};var L=new e;var B=new e;f.union=function(t,i,a){r.typeOf.object("left",t);r.typeOf.object("right",i);if(!n(a)){a=new f}var o=t.center;var s=t.radius;var u=i.center;var l=i.radius;var c=e.subtract(u,o,L);var d=e.magnitude(c);if(s>=d+l){t.clone(a);return a}if(l>=d+s){i.clone(a);return a}var h=(s+d+l)*.5;var p=e.multiplyByScalar(c,(-s+h)/d,B);e.add(p,o,p);e.clone(p,a.center);a.radius=h;return a};var F=new e;f.expand=function(t,i,n){r.typeOf.object("sphere",t);r.typeOf.object("point",i);n=f.clone(t,n);var a=e.magnitude(e.subtract(i,n.center,F));if(a>n.radius){n.radius=a}return n};f.intersectPlane=function(t,i){r.typeOf.object("sphere",t);r.typeOf.object("plane",i);var n=t.center;var a=t.radius;var o=i.normal;var u=e.dot(o,n)+i.distance;if(u<-a){return s.OUTSIDE}else if(u<a){return s.INTERSECTING}return s.INSIDE};f.transform=function(e,t,i){r.typeOf.object("sphere",e);r.typeOf.object("transform",t);if(!n(i)){i=new f}i.center=c.multiplyByPoint(t,e.center,i.center);i.radius=c.getMaximumScale(t)*e.radius;return i};var k=new e;f.distanceSquaredTo=function(t,i){r.typeOf.object("sphere",t);r.typeOf.object("cartesian",i);var n=e.subtract(t.center,i,k);return e.magnitudeSquared(n)-t.radius*t.radius};f.transformWithoutScale=function(e,t,i){r.typeOf.object("sphere",e);r.typeOf.object("transform",t);if(!n(i)){i=new f}i.center=c.multiplyByPoint(t,e.center,i.center);i.radius=e.radius;return i};var V=new e;f.computePlaneDistances=function(t,i,a,o){r.typeOf.object("sphere",t);r.typeOf.object("position",i);r.typeOf.object("direction",a);if(!n(o)){o=new u}var s=e.subtract(t.center,i,V);var l=e.dot(a,s);o.start=l-t.radius;o.stop=l+t.radius;return o};var z=new e;var U=new e;var q=new e;var G=new e;var H=new e;var W=new t;var j=new Array(8);for(var Y=0;Y<8;++Y){j[Y]=new e}var X=new o;f.projectTo2D=function(t,n,a){r.typeOf.object("sphere",t);n=i(n,X);var o=n.ellipsoid;var s=t.center;var u=t.radius;var l=o.geodeticSurfaceNormal(s,z);var c=e.cross(e.UNIT_Z,l,U);e.normalize(c,c);var d=e.cross(l,c,q);e.normalize(d,d);e.multiplyByScalar(l,u,l);e.multiplyByScalar(d,u,d);e.multiplyByScalar(c,u,c);var h=e.negate(d,H);var p=e.negate(c,G);var m=j;var v=m[0];e.add(l,d,v);e.add(v,c,v);v=m[1];e.add(l,d,v);e.add(v,p,v);v=m[2];e.add(l,h,v);e.add(v,p,v);v=m[3];e.add(l,h,v);e.add(v,c,v);e.negate(l,l);v=m[4];e.add(l,d,v);e.add(v,c,v);v=m[5];e.add(l,d,v);e.add(v,p,v);v=m[6];e.add(l,h,v);e.add(v,p,v);v=m[7];e.add(l,h,v);e.add(v,c,v);var _=m.length;for(var g=0;g<_;++g){var y=m[g];e.add(s,y,y);var w=o.cartesianToCartographic(y,W);n.project(w,y)}a=f.fromPoints(m,a);s=a.center;var C=s.x;var b=s.y;var S=s.z;s.x=S;s.y=C;s.z=b;return a};f.isOccluded=function(e,t){r.typeOf.object("sphere",e);r.typeOf.object("occluder",t);return!t.isBoundingSphereVisible(e)};f.equals=function(t,r){return t===r||n(t)&&n(r)&&e.equals(t.center,r.center)&&t.radius===r.radius};f.prototype.intersectPlane=function(e){return f.intersectPlane(this,e)};f.prototype.distanceSquaredTo=function(e){return f.distanceSquaredTo(this,e)};f.prototype.computePlaneDistances=function(e,t,r){return f.computePlaneDistances(this,e,t,r)};f.prototype.isOccluded=function(e){return f.isOccluded(this,e)};f.prototype.equals=function(e){return f.equals(this,e)};f.prototype.clone=function(e){return f.clone(this,e)};return f});define("Core/Fullscreen",["./defined","./defineProperties"],function(e,t){"use strict";var r;var i={requestFullscreen:undefined,exitFullscreen:undefined,fullscreenEnabled:undefined,fullscreenElement:undefined,fullscreenchange:undefined,fullscreenerror:undefined};var n={};t(n,{element:{get:function(){if(!n.supportsFullscreen()){return undefined}return document[i.fullscreenElement]}},changeEventName:{get:function(){if(!n.supportsFullscreen()){return undefined}return i.fullscreenchange}},errorEventName:{get:function(){if(!n.supportsFullscreen()){return undefined}return i.fullscreenerror}},enabled:{get:function(){if(!n.supportsFullscreen()){return undefined}return document[i.fullscreenEnabled]}},fullscreen:{get:function(){if(!n.supportsFullscreen()){return undefined}return n.element!==null}}});n.supportsFullscreen=function(){if(e(r)){return r}r=false;var t=document.body;if(typeof t.requestFullscreen==="function"){i.requestFullscreen="requestFullscreen";i.exitFullscreen="exitFullscreen";i.fullscreenEnabled="fullscreenEnabled";i.fullscreenElement="fullscreenElement";i.fullscreenchange="fullscreenchange";i.fullscreenerror="fullscreenerror";r=true;return r}var n=["webkit","moz","o","ms","khtml"];var a;for(var o=0,s=n.length;o<s;++o){var u=n[o];a=u+"RequestFullscreen";if(typeof t[a]==="function"){i.requestFullscreen=a;r=true}else{a=u+"RequestFullScreen";if(typeof t[a]==="function"){i.requestFullscreen=a;r=true}}a=u+"ExitFullscreen";if(typeof document[a]==="function"){i.exitFullscreen=a}else{a=u+"CancelFullScreen";if(typeof document[a]==="function"){i.exitFullscreen=a}}a=u+"FullscreenEnabled";if(document[a]!==undefined){i.fullscreenEnabled=a}else{a=u+"FullScreenEnabled";if(document[a]!==undefined){i.fullscreenEnabled=a}}a=u+"FullscreenElement";if(document[a]!==undefined){i.fullscreenElement=a}else{a=u+"FullScreenElement";if(document[a]!==undefined){i.fullscreenElement=a}}a=u+"fullscreenchange";if(document["on"+a]!==undefined){if(u==="ms"){a="MSFullscreenChange"}i.fullscreenchange=a}a=u+"fullscreenerror";if(document["on"+a]!==undefined){if(u==="ms"){a="MSFullscreenError"}i.fullscreenerror=a}}return r};n.requestFullscreen=function(e,t){if(!n.supportsFullscreen()){return}e[i.requestFullscreen]({vrDisplay:t})};n.exitFullscreen=function(){if(!n.supportsFullscreen()){return}document[i.exitFullscreen]()};return n});define("Core/FeatureDetection",["./defaultValue","./defined","./Fullscreen"],function(e,t,r){"use strict";var i;if(typeof navigator!=="undefined"){i=navigator}else{i={}}function n(e){var t=e.split(".");for(var r=0,i=t.length;r<i;++r){t[r]=parseInt(t[r],10)}return t}var a;var o;function s(){if(!t(a)){a=false;if(!S()){var e=/ Chrome\/([\.0-9]+)/.exec(i.userAgent);if(e!==null){a=true;o=n(e[1])}}}return a}function u(){return s()&&o}var l;var c;function d(){if(!t(l)){l=false;if(!s()&&!S()&&/ Safari\/[\.0-9]+/.test(i.userAgent)){var e=/ Version\/([\.0-9]+)/.exec(i.userAgent);if(e!==null){l=true;c=n(e[1])}}}return l}function f(){return d()&&c}var h;var p;function m(){if(!t(h)){h=false;var e=/ AppleWebKit\/([\.0-9]+)(\+?)/.exec(i.userAgent);if(e!==null){h=true;p=n(e[1]);p.isNightly=!!e[2]}}return h}function v(){return m()&&p}var _;var g;function y(){if(!t(_)){_=false;var e;if(i.appName==="Microsoft Internet Explorer"){e=/MSIE ([0-9]{1,}[\.0-9]{0,})/.exec(i.userAgent);if(e!==null){_=true;g=n(e[1])}}else if(i.appName==="Netscape"){e=/Trident\/.*rv:([0-9]{1,}[\.0-9]{0,})/.exec(i.userAgent);if(e!==null){_=true;g=n(e[1])}}}return _}function w(){return y()&&g}var C;var b;function S(){if(!t(C)){C=false;var e=/ Edge\/([\.0-9]+)/.exec(i.userAgent);if(e!==null){C=true;b=n(e[1])}}return C}function E(){return S()&&b}var T;var x;function A(){if(!t(T)){T=false;var e=/Firefox\/([\.0-9]+)/.exec(i.userAgent);if(e!==null){T=true;x=n(e[1])}}return T}var P;function D(){if(!t(P)){P=/Windows/i.test(i.appVersion)}return P}function M(){return A()&&x}var I;function O(){if(!t(I)){I=typeof PointerEvent!=="undefined"&&(!t(i.pointerEnabled)||i.pointerEnabled)}return I}var R;var N;function L(){if(!t(N)){var e=document.createElement("canvas");e.setAttribute("style","image-rendering: -moz-crisp-edges;"+"image-rendering: pixelated;");var r=e.style.imageRendering;N=t(r)&&r!=="";if(N){R=r}}return N}function B(){return L()?R:undefined}var F={isChrome:s,chromeVersion:u,isSafari:d,safariVersion:f,isWebkit:m,webkitVersion:v,isInternetExplorer:y,internetExplorerVersion:w,isEdge:S,edgeVersion:E,isFirefox:A,firefoxVersion:M,isWindows:D,hardwareConcurrency:e(i.hardwareConcurrency,3),supportsPointerEvents:O,supportsImageRenderingPixelated:L,imageRenderingValue:B};F.supportsFullscreen=function(){return r.supportsFullscreen()};F.supportsTypedArrays=function(){return typeof ArrayBuffer!=="undefined"};F.supportsWebWorkers=function(){return typeof Worker!=="undefined"};return F});define("Core/WebGLConstants",["./freezeObject"],function(e){"use strict";var t={DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,FUNC_ADD:32774,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,BLEND_COLOR:32773,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,STREAM_DRAW:35040,STATIC_DRAW:35044,DYNAMIC_DRAW:35048,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,CULL_FACE:2884,BLEND:3042,DITHER:3024,STENCIL_TEST:2960,DEPTH_TEST:2929,SCISSOR_TEST:3089,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CW:2304,CCW:2305,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_UNIFORMS:35718,ACTIVE_ATTRIBUTES:35721,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,NOTEQUAL:517,GEQUAL:518,ALWAYS:519,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,VENDOR:7936,RENDERER:7937,VERSION:7938,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,TEXTURE1:33985,TEXTURE2:33986,TEXTURE3:33987,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE30:34014,TEXTURE31:34015,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,IMPLEMENTATION_COLOR_READ_TYPE:35738,IMPLEMENTATION_COLOR_READ_FORMAT:35739,COMPILE_STATUS:35713,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,DOUBLE:5130,READ_BUFFER:3074,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_ROWS:3315,UNPACK_SKIP_PIXELS:3316,PACK_ROW_LENGTH:3330,PACK_SKIP_ROWS:3331,PACK_SKIP_PIXELS:3332,COLOR:6144,DEPTH:6145,STENCIL:6146,RED:6403,RGB8:32849,RGBA8:32856,RGB10_A2:32857,TEXTURE_BINDING_3D:32874,UNPACK_SKIP_IMAGES:32877,UNPACK_IMAGE_HEIGHT:32878,TEXTURE_3D:32879,TEXTURE_WRAP_R:32882,MAX_3D_TEXTURE_SIZE:32883,UNSIGNED_INT_2_10_10_10_REV:33640,MAX_ELEMENTS_VERTICES:33e3,MAX_ELEMENTS_INDICES:33001,TEXTURE_MIN_LOD:33082,TEXTURE_MAX_LOD:33083,TEXTURE_BASE_LEVEL:33084,TEXTURE_MAX_LEVEL:33085,MIN:32775,MAX:32776,DEPTH_COMPONENT24:33190,MAX_TEXTURE_LOD_BIAS:34045,TEXTURE_COMPARE_MODE:34892,TEXTURE_COMPARE_FUNC:34893,CURRENT_QUERY:34917,QUERY_RESULT:34918,QUERY_RESULT_AVAILABLE:34919,STREAM_READ:35041,STREAM_COPY:35042,STATIC_READ:35045,STATIC_COPY:35046,DYNAMIC_READ:35049,DYNAMIC_COPY:35050,MAX_DRAW_BUFFERS:34852,DRAW_BUFFER0:34853,DRAW_BUFFER1:34854,DRAW_BUFFER2:34855,DRAW_BUFFER3:34856,DRAW_BUFFER4:34857,DRAW_BUFFER5:34858,DRAW_BUFFER6:34859,DRAW_BUFFER7:34860,DRAW_BUFFER8:34861,DRAW_BUFFER9:34862,DRAW_BUFFER10:34863,DRAW_BUFFER11:34864,DRAW_BUFFER12:34865,DRAW_BUFFER13:34866,DRAW_BUFFER14:34867,DRAW_BUFFER15:34868,MAX_FRAGMENT_UNIFORM_COMPONENTS:35657,MAX_VERTEX_UNIFORM_COMPONENTS:35658,SAMPLER_3D:35679,SAMPLER_2D_SHADOW:35682,FRAGMENT_SHADER_DERIVATIVE_HINT:35723,PIXEL_PACK_BUFFER:35051,PIXEL_UNPACK_BUFFER:35052,PIXEL_PACK_BUFFER_BINDING:35053,PIXEL_UNPACK_BUFFER_BINDING:35055,FLOAT_MAT2x3:35685,FLOAT_MAT2x4:35686,FLOAT_MAT3x2:35687,FLOAT_MAT3x4:35688,FLOAT_MAT4x2:35689,FLOAT_MAT4x3:35690,SRGB:35904,SRGB8:35905,SRGB8_ALPHA8:35907,COMPARE_REF_TO_TEXTURE:34894,RGBA32F:34836,RGB32F:34837,RGBA16F:34842,RGB16F:34843,VERTEX_ATTRIB_ARRAY_INTEGER:35069,MAX_ARRAY_TEXTURE_LAYERS:35071,MIN_PROGRAM_TEXEL_OFFSET:35076,MAX_PROGRAM_TEXEL_OFFSET:35077,MAX_VARYING_COMPONENTS:35659,TEXTURE_2D_ARRAY:35866,TEXTURE_BINDING_2D_ARRAY:35869,R11F_G11F_B10F:35898,UNSIGNED_INT_10F_11F_11F_REV:35899,RGB9_E5:35901,UNSIGNED_INT_5_9_9_9_REV:35902,TRANSFORM_FEEDBACK_BUFFER_MODE:35967,MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS:35968,TRANSFORM_FEEDBACK_VARYINGS:35971,TRANSFORM_FEEDBACK_BUFFER_START:35972,TRANSFORM_FEEDBACK_BUFFER_SIZE:35973,TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN:35976,RASTERIZER_DISCARD:35977,MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS:35978,MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS:35979,INTERLEAVED_ATTRIBS:35980,SEPARATE_ATTRIBS:35981,TRANSFORM_FEEDBACK_BUFFER:35982,TRANSFORM_FEEDBACK_BUFFER_BINDING:35983,RGBA32UI:36208,RGB32UI:36209,RGBA16UI:36214,RGB16UI:36215,RGBA8UI:36220,RGB8UI:36221,RGBA32I:36226,RGB32I:36227,RGBA16I:36232,RGB16I:36233,RGBA8I:36238,RGB8I:36239,RED_INTEGER:36244,RGB_INTEGER:36248,RGBA_INTEGER:36249,SAMPLER_2D_ARRAY:36289,SAMPLER_2D_ARRAY_SHADOW:36292,SAMPLER_CUBE_SHADOW:36293,UNSIGNED_INT_VEC2:36294,UNSIGNED_INT_VEC3:36295,UNSIGNED_INT_VEC4:36296,INT_SAMPLER_2D:36298,INT_SAMPLER_3D:36299,INT_SAMPLER_CUBE:36300,INT_SAMPLER_2D_ARRAY:36303,UNSIGNED_INT_SAMPLER_2D:36306,UNSIGNED_INT_SAMPLER_3D:36307,UNSIGNED_INT_SAMPLER_CUBE:36308,UNSIGNED_INT_SAMPLER_2D_ARRAY:36311,DEPTH_COMPONENT32F:36012,DEPTH32F_STENCIL8:36013,FLOAT_32_UNSIGNED_INT_24_8_REV:36269,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE:33297,FRAMEBUFFER_ATTACHMENT_RED_SIZE:33298,FRAMEBUFFER_ATTACHMENT_GREEN_SIZE:33299,FRAMEBUFFER_ATTACHMENT_BLUE_SIZE:33300,FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE:33301,FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE:33302,FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE:33303,FRAMEBUFFER_DEFAULT:33304,UNSIGNED_INT_24_8:34042,DEPTH24_STENCIL8:35056,UNSIGNED_NORMALIZED:35863,DRAW_FRAMEBUFFER_BINDING:36006,READ_FRAMEBUFFER:36008,DRAW_FRAMEBUFFER:36009,READ_FRAMEBUFFER_BINDING:36010,RENDERBUFFER_SAMPLES:36011,FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER:36052,MAX_COLOR_ATTACHMENTS:36063,COLOR_ATTACHMENT1:36065,COLOR_ATTACHMENT2:36066,COLOR_ATTACHMENT3:36067,COLOR_ATTACHMENT4:36068,COLOR_ATTACHMENT5:36069,COLOR_ATTACHMENT6:36070,COLOR_ATTACHMENT7:36071,COLOR_ATTACHMENT8:36072,COLOR_ATTACHMENT9:36073,COLOR_ATTACHMENT10:36074,COLOR_ATTACHMENT11:36075,COLOR_ATTACHMENT12:36076,COLOR_ATTACHMENT13:36077,COLOR_ATTACHMENT14:36078,COLOR_ATTACHMENT15:36079,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:36182,MAX_SAMPLES:36183,HALF_FLOAT:5131,RG:33319,RG_INTEGER:33320,R8:33321,RG8:33323,R16F:33325,R32F:33326,RG16F:33327,RG32F:33328,R8I:33329,R8UI:33330,R16I:33331,R16UI:33332,R32I:33333,R32UI:33334,RG8I:33335,RG8UI:33336,RG16I:33337,RG16UI:33338,RG32I:33339,RG32UI:33340,VERTEX_ARRAY_BINDING:34229,R8_SNORM:36756,RG8_SNORM:36757,RGB8_SNORM:36758,RGBA8_SNORM:36759,SIGNED_NORMALIZED:36764,COPY_READ_BUFFER:36662,COPY_WRITE_BUFFER:36663,COPY_READ_BUFFER_BINDING:36662,COPY_WRITE_BUFFER_BINDING:36663,UNIFORM_BUFFER:35345,UNIFORM_BUFFER_BINDING:35368,UNIFORM_BUFFER_START:35369,UNIFORM_BUFFER_SIZE:35370,MAX_VERTEX_UNIFORM_BLOCKS:35371,MAX_FRAGMENT_UNIFORM_BLOCKS:35373,MAX_COMBINED_UNIFORM_BLOCKS:35374,MAX_UNIFORM_BUFFER_BINDINGS:35375,MAX_UNIFORM_BLOCK_SIZE:35376,MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS:35377,MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS:35379,UNIFORM_BUFFER_OFFSET_ALIGNMENT:35380,ACTIVE_UNIFORM_BLOCKS:35382,UNIFORM_TYPE:35383,UNIFORM_SIZE:35384,UNIFORM_BLOCK_INDEX:35386,UNIFORM_OFFSET:35387,UNIFORM_ARRAY_STRIDE:35388,UNIFORM_MATRIX_STRIDE:35389,UNIFORM_IS_ROW_MAJOR:35390,UNIFORM_BLOCK_BINDING:35391,UNIFORM_BLOCK_DATA_SIZE:35392,UNIFORM_BLOCK_ACTIVE_UNIFORMS:35394,UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES:35395,UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER:35396,UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER:35398,INVALID_INDEX:4294967295,MAX_VERTEX_OUTPUT_COMPONENTS:37154,MAX_FRAGMENT_INPUT_COMPONENTS:37157,MAX_SERVER_WAIT_TIMEOUT:37137,OBJECT_TYPE:37138,SYNC_CONDITION:37139,SYNC_STATUS:37140,SYNC_FLAGS:37141,SYNC_FENCE:37142,SYNC_GPU_COMMANDS_COMPLETE:37143,UNSIGNALED:37144,SIGNALED:37145,ALREADY_SIGNALED:37146,TIMEOUT_EXPIRED:37147,CONDITION_SATISFIED:37148,WAIT_FAILED:37149,SYNC_FLUSH_COMMANDS_BIT:1,VERTEX_ATTRIB_ARRAY_DIVISOR:35070,ANY_SAMPLES_PASSED:35887,ANY_SAMPLES_PASSED_CONSERVATIVE:36202,SAMPLER_BINDING:35097,RGB10_A2UI:36975,INT_2_10_10_10_REV:36255,TRANSFORM_FEEDBACK:36386,TRANSFORM_FEEDBACK_PAUSED:36387,TRANSFORM_FEEDBACK_ACTIVE:36388,TRANSFORM_FEEDBACK_BINDING:36389,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_SRGB8_ETC2:37493,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37494,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37495,COMPRESSED_RGBA8_ETC2_EAC:37496,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37497,TEXTURE_IMMUTABLE_FORMAT:37167,MAX_ELEMENT_INDEX:36203,TEXTURE_IMMUTABLE_LEVELS:33503,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047};return e(t)});define("Core/ComponentDatatype",["./defaultValue","./defined","./DeveloperError","./FeatureDetection","./freezeObject","./WebGLConstants"],function(e,t,r,i,n,a){"use strict";if(!i.supportsTypedArrays()){return{}}var o={BYTE:a.BYTE,UNSIGNED_BYTE:a.UNSIGNED_BYTE,SHORT:a.SHORT,UNSIGNED_SHORT:a.UNSIGNED_SHORT,INT:a.INT,UNSIGNED_INT:a.UNSIGNED_INT,FLOAT:a.FLOAT,DOUBLE:a.DOUBLE};o.getSizeInBytes=function(e){if(!t(e)){throw new r("value is required.")}switch(e){case o.BYTE:return Int8Array.BYTES_PER_ELEMENT;case o.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case o.SHORT:return Int16Array.BYTES_PER_ELEMENT;case o.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case o.INT:return Int32Array.BYTES_PER_ELEMENT;case o.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case o.FLOAT:return Float32Array.BYTES_PER_ELEMENT;case o.DOUBLE:return Float64Array.BYTES_PER_ELEMENT;default:throw new r("componentDatatype is not a valid value.")}};o.fromTypedArray=function(e){if(e instanceof Int8Array){return o.BYTE}if(e instanceof Uint8Array){return o.UNSIGNED_BYTE}if(e instanceof Int16Array){return o.SHORT}if(e instanceof Uint16Array){return o.UNSIGNED_SHORT}if(e instanceof Int32Array){return o.INT}if(e instanceof Uint32Array){return o.UNSIGNED_INT}if(e instanceof Float32Array){return o.FLOAT}if(e instanceof Float64Array){return o.DOUBLE}};o.validate=function(e){return t(e)&&(e===o.BYTE||e===o.UNSIGNED_BYTE||e===o.SHORT||e===o.UNSIGNED_SHORT||e===o.INT||e===o.UNSIGNED_INT||e===o.FLOAT||e===o.DOUBLE)};o.createTypedArray=function(e,i){
if(!t(e)){throw new r("componentDatatype is required.")}if(!t(i)){throw new r("valuesOrLength is required.")}switch(e){case o.BYTE:return new Int8Array(i);case o.UNSIGNED_BYTE:return new Uint8Array(i);case o.SHORT:return new Int16Array(i);case o.UNSIGNED_SHORT:return new Uint16Array(i);case o.INT:return new Int32Array(i);case o.UNSIGNED_INT:return new Uint32Array(i);case o.FLOAT:return new Float32Array(i);case o.DOUBLE:return new Float64Array(i);default:throw new r("componentDatatype is not a valid value.")}};o.createArrayBufferView=function(i,n,a,s){if(!t(i)){throw new r("componentDatatype is required.")}if(!t(n)){throw new r("buffer is required.")}a=e(a,0);s=e(s,(n.byteLength-a)/o.getSizeInBytes(i));switch(i){case o.BYTE:return new Int8Array(n,a,s);case o.UNSIGNED_BYTE:return new Uint8Array(n,a,s);case o.SHORT:return new Int16Array(n,a,s);case o.UNSIGNED_SHORT:return new Uint16Array(n,a,s);case o.INT:return new Int32Array(n,a,s);case o.UNSIGNED_INT:return new Uint32Array(n,a,s);case o.FLOAT:return new Float32Array(n,a,s);case o.DOUBLE:return new Float64Array(n,a,s);default:throw new r("componentDatatype is not a valid value.")}};o.fromName=function(e){switch(e){case"BYTE":return o.BYTE;case"UNSIGNED_BYTE":return o.UNSIGNED_BYTE;case"SHORT":return o.SHORT;case"UNSIGNED_SHORT":return o.UNSIGNED_SHORT;case"INT":return o.INT;case"UNSIGNED_INT":return o.UNSIGNED_INT;case"FLOAT":return o.FLOAT;case"DOUBLE":return o.DOUBLE;default:throw new r("name is not a valid value.")}};return n(o)});define("Core/GeometryType",["./freezeObject"],function(e){"use strict";var t={NONE:0,TRIANGLES:1,LINES:2,POLYLINES:3};return e(t)});define("Core/PrimitiveType",["./freezeObject","./WebGLConstants"],function(e,t){"use strict";var r={POINTS:t.POINTS,LINES:t.LINES,LINE_LOOP:t.LINE_LOOP,LINE_STRIP:t.LINE_STRIP,TRIANGLES:t.TRIANGLES,TRIANGLE_STRIP:t.TRIANGLE_STRIP,TRIANGLE_FAN:t.TRIANGLE_FAN,validate:function(e){return e===r.POINTS||e===r.LINES||e===r.LINE_LOOP||e===r.LINE_STRIP||e===r.TRIANGLES||e===r.TRIANGLE_STRIP||e===r.TRIANGLE_FAN}};return e(r)});define("Core/Geometry",["./defaultValue","./defined","./DeveloperError","./GeometryType","./PrimitiveType"],function(e,t,r,i,n){"use strict";function a(a){a=e(a,e.EMPTY_OBJECT);if(!t(a.attributes)){throw new r("options.attributes is required.")}this.attributes=a.attributes;this.indices=a.indices;this.primitiveType=e(a.primitiveType,n.TRIANGLES);this.boundingSphere=a.boundingSphere;this.geometryType=e(a.geometryType,i.NONE);this.boundingSphereCV=a.boundingSphereCV}a.computeNumberOfVertices=function(e){if(!t(e)){throw new r("geometry is required.")}var i=-1;for(var n in e.attributes){if(e.attributes.hasOwnProperty(n)&&t(e.attributes[n])&&t(e.attributes[n].values)){var a=e.attributes[n];var o=a.values.length/a.componentsPerAttribute;if(i!==o&&i!==-1){throw new r("All attribute lists must have the same number of attributes.")}i=o}}return i};return a});define("Core/GeometryAttribute",["./defaultValue","./defined","./DeveloperError"],function(e,t,r){"use strict";function i(i){i=e(i,e.EMPTY_OBJECT);if(!t(i.componentDatatype)){throw new r("options.componentDatatype is required.")}if(!t(i.componentsPerAttribute)){throw new r("options.componentsPerAttribute is required.")}if(i.componentsPerAttribute<1||i.componentsPerAttribute>4){throw new r("options.componentsPerAttribute must be between 1 and 4.")}if(!t(i.values)){throw new r("options.values is required.")}this.componentDatatype=i.componentDatatype;this.componentsPerAttribute=i.componentsPerAttribute;this.normalize=e(i.normalize,false);this.values=i.values}return i});define("Core/GeometryAttributes",["./defaultValue"],function(e){"use strict";function t(t){t=e(t,e.EMPTY_OBJECT);this.position=t.position;this.normal=t.normal;this.st=t.st;this.bitangent=t.bitangent;this.tangent=t.tangent;this.color=t.color}return t});define("Core/VertexFormat",["./defaultValue","./defined","./DeveloperError","./freezeObject"],function(e,t,r,i){"use strict";function n(t){t=e(t,e.EMPTY_OBJECT);this.position=e(t.position,false);this.normal=e(t.normal,false);this.st=e(t.st,false);this.bitangent=e(t.bitangent,false);this.tangent=e(t.tangent,false);this.color=e(t.color,false)}n.POSITION_ONLY=i(new n({position:true}));n.POSITION_AND_NORMAL=i(new n({position:true,normal:true}));n.POSITION_NORMAL_AND_ST=i(new n({position:true,normal:true,st:true}));n.POSITION_AND_ST=i(new n({position:true,st:true}));n.POSITION_AND_COLOR=i(new n({position:true,color:true}));n.ALL=i(new n({position:true,normal:true,st:true,tangent:true,bitangent:true}));n.DEFAULT=n.POSITION_NORMAL_AND_ST;n.packedLength=6;n.pack=function(i,n,a){if(!t(i)){throw new r("value is required")}if(!t(n)){throw new r("array is required")}a=e(a,0);n[a++]=i.position?1:0;n[a++]=i.normal?1:0;n[a++]=i.st?1:0;n[a++]=i.tangent?1:0;n[a++]=i.bitangent?1:0;n[a++]=i.color?1:0;return n};n.unpack=function(i,a,o){if(!t(i)){throw new r("array is required")}a=e(a,0);if(!t(o)){o=new n}o.position=i[a++]===1;o.normal=i[a++]===1;o.st=i[a++]===1;o.tangent=i[a++]===1;o.bitangent=i[a++]===1;o.color=i[a++]===1;return o};n.clone=function(e,r){if(!t(e)){return undefined}if(!t(r)){r=new n}r.position=e.position;r.normal=e.normal;r.st=e.st;r.tangent=e.tangent;r.bitangent=e.bitangent;r.color=e.color;return r};return n});define("Core/BoxGeometry",["./BoundingSphere","./Cartesian3","./ComponentDatatype","./defaultValue","./defined","./DeveloperError","./Geometry","./GeometryAttribute","./GeometryAttributes","./PrimitiveType","./VertexFormat"],function(e,t,r,i,n,a,o,s,u,l,c){"use strict";var d=new t;function f(e){e=i(e,i.EMPTY_OBJECT);var r=e.minimum;var o=e.maximum;if(!n(r)){throw new a("options.minimum is required.")}if(!n(o)){throw new a("options.maximum is required")}var s=i(e.vertexFormat,c.DEFAULT);this._minimum=t.clone(r);this._maximum=t.clone(o);this._vertexFormat=s;this._workerName="createBoxGeometry"}f.fromDimensions=function(e){e=i(e,i.EMPTY_OBJECT);var r=e.dimensions;if(!n(r)){throw new a("options.dimensions is required.")}if(r.x<0||r.y<0||r.z<0){throw new a("All dimensions components must be greater than or equal to zero.")}var o=t.multiplyByScalar(r,.5,new t);return new f({minimum:t.negate(o,new t),maximum:o,vertexFormat:e.vertexFormat})};f.fromAxisAlignedBoundingBox=function(e){if(!n(e)){throw new a("boundingBox is required.")}return new f({minimum:e.minimum,maximum:e.maximum})};f.packedLength=2*t.packedLength+c.packedLength;f.pack=function(e,r,o){if(!n(e)){throw new a("value is required")}if(!n(r)){throw new a("array is required")}o=i(o,0);t.pack(e._minimum,r,o);t.pack(e._maximum,r,o+t.packedLength);c.pack(e._vertexFormat,r,o+2*t.packedLength);return r};var h=new t;var p=new t;var m=new c;var v={minimum:h,maximum:p,vertexFormat:m};f.unpack=function(e,r,o){if(!n(e)){throw new a("array is required")}r=i(r,0);var s=t.unpack(e,r,h);var u=t.unpack(e,r+t.packedLength,p);var l=c.unpack(e,r+2*t.packedLength,m);if(!n(o)){return new f(v)}o._minimum=t.clone(s,o._minimum);o._maximum=t.clone(u,o._maximum);o._vertexFormat=c.clone(l,o._vertexFormat);return o};f.createGeometry=function(i){var n=i._minimum;var a=i._maximum;var c=i._vertexFormat;if(t.equals(n,a)){return}var f=new u;var h;var p;if(c.position&&(c.st||c.normal||c.tangent||c.bitangent)){if(c.position){p=new Float64Array(6*4*3);p[0]=n.x;p[1]=n.y;p[2]=a.z;p[3]=a.x;p[4]=n.y;p[5]=a.z;p[6]=a.x;p[7]=a.y;p[8]=a.z;p[9]=n.x;p[10]=a.y;p[11]=a.z;p[12]=n.x;p[13]=n.y;p[14]=n.z;p[15]=a.x;p[16]=n.y;p[17]=n.z;p[18]=a.x;p[19]=a.y;p[20]=n.z;p[21]=n.x;p[22]=a.y;p[23]=n.z;p[24]=a.x;p[25]=n.y;p[26]=n.z;p[27]=a.x;p[28]=a.y;p[29]=n.z;p[30]=a.x;p[31]=a.y;p[32]=a.z;p[33]=a.x;p[34]=n.y;p[35]=a.z;p[36]=n.x;p[37]=n.y;p[38]=n.z;p[39]=n.x;p[40]=a.y;p[41]=n.z;p[42]=n.x;p[43]=a.y;p[44]=a.z;p[45]=n.x;p[46]=n.y;p[47]=a.z;p[48]=n.x;p[49]=a.y;p[50]=n.z;p[51]=a.x;p[52]=a.y;p[53]=n.z;p[54]=a.x;p[55]=a.y;p[56]=a.z;p[57]=n.x;p[58]=a.y;p[59]=a.z;p[60]=n.x;p[61]=n.y;p[62]=n.z;p[63]=a.x;p[64]=n.y;p[65]=n.z;p[66]=a.x;p[67]=n.y;p[68]=a.z;p[69]=n.x;p[70]=n.y;p[71]=a.z;f.position=new s({componentDatatype:r.DOUBLE,componentsPerAttribute:3,values:p})}if(c.normal){var m=new Float32Array(6*4*3);m[0]=0;m[1]=0;m[2]=1;m[3]=0;m[4]=0;m[5]=1;m[6]=0;m[7]=0;m[8]=1;m[9]=0;m[10]=0;m[11]=1;m[12]=0;m[13]=0;m[14]=-1;m[15]=0;m[16]=0;m[17]=-1;m[18]=0;m[19]=0;m[20]=-1;m[21]=0;m[22]=0;m[23]=-1;m[24]=1;m[25]=0;m[26]=0;m[27]=1;m[28]=0;m[29]=0;m[30]=1;m[31]=0;m[32]=0;m[33]=1;m[34]=0;m[35]=0;m[36]=-1;m[37]=0;m[38]=0;m[39]=-1;m[40]=0;m[41]=0;m[42]=-1;m[43]=0;m[44]=0;m[45]=-1;m[46]=0;m[47]=0;m[48]=0;m[49]=1;m[50]=0;m[51]=0;m[52]=1;m[53]=0;m[54]=0;m[55]=1;m[56]=0;m[57]=0;m[58]=1;m[59]=0;m[60]=0;m[61]=-1;m[62]=0;m[63]=0;m[64]=-1;m[65]=0;m[66]=0;m[67]=-1;m[68]=0;m[69]=0;m[70]=-1;m[71]=0;f.normal=new s({componentDatatype:r.FLOAT,componentsPerAttribute:3,values:m})}if(c.st){var v=new Float32Array(6*4*2);v[0]=0;v[1]=0;v[2]=1;v[3]=0;v[4]=1;v[5]=1;v[6]=0;v[7]=1;v[8]=1;v[9]=0;v[10]=0;v[11]=0;v[12]=0;v[13]=1;v[14]=1;v[15]=1;v[16]=0;v[17]=0;v[18]=1;v[19]=0;v[20]=1;v[21]=1;v[22]=0;v[23]=1;v[24]=1;v[25]=0;v[26]=0;v[27]=0;v[28]=0;v[29]=1;v[30]=1;v[31]=1;v[32]=1;v[33]=0;v[34]=0;v[35]=0;v[36]=0;v[37]=1;v[38]=1;v[39]=1;v[40]=0;v[41]=0;v[42]=1;v[43]=0;v[44]=1;v[45]=1;v[46]=0;v[47]=1;f.st=new s({componentDatatype:r.FLOAT,componentsPerAttribute:2,values:v})}if(c.tangent){var _=new Float32Array(6*4*3);_[0]=1;_[1]=0;_[2]=0;_[3]=1;_[4]=0;_[5]=0;_[6]=1;_[7]=0;_[8]=0;_[9]=1;_[10]=0;_[11]=0;_[12]=-1;_[13]=0;_[14]=0;_[15]=-1;_[16]=0;_[17]=0;_[18]=-1;_[19]=0;_[20]=0;_[21]=-1;_[22]=0;_[23]=0;_[24]=0;_[25]=1;_[26]=0;_[27]=0;_[28]=1;_[29]=0;_[30]=0;_[31]=1;_[32]=0;_[33]=0;_[34]=1;_[35]=0;_[36]=0;_[37]=-1;_[38]=0;_[39]=0;_[40]=-1;_[41]=0;_[42]=0;_[43]=-1;_[44]=0;_[45]=0;_[46]=-1;_[47]=0;_[48]=-1;_[49]=0;_[50]=0;_[51]=-1;_[52]=0;_[53]=0;_[54]=-1;_[55]=0;_[56]=0;_[57]=-1;_[58]=0;_[59]=0;_[60]=1;_[61]=0;_[62]=0;_[63]=1;_[64]=0;_[65]=0;_[66]=1;_[67]=0;_[68]=0;_[69]=1;_[70]=0;_[71]=0;f.tangent=new s({componentDatatype:r.FLOAT,componentsPerAttribute:3,values:_})}if(c.bitangent){var g=new Float32Array(6*4*3);g[0]=0;g[1]=1;g[2]=0;g[3]=0;g[4]=1;g[5]=0;g[6]=0;g[7]=1;g[8]=0;g[9]=0;g[10]=1;g[11]=0;g[12]=0;g[13]=1;g[14]=0;g[15]=0;g[16]=1;g[17]=0;g[18]=0;g[19]=1;g[20]=0;g[21]=0;g[22]=1;g[23]=0;g[24]=0;g[25]=0;g[26]=1;g[27]=0;g[28]=0;g[29]=1;g[30]=0;g[31]=0;g[32]=1;g[33]=0;g[34]=0;g[35]=1;g[36]=0;g[37]=0;g[38]=1;g[39]=0;g[40]=0;g[41]=1;g[42]=0;g[43]=0;g[44]=1;g[45]=0;g[46]=0;g[47]=1;g[48]=0;g[49]=0;g[50]=1;g[51]=0;g[52]=0;g[53]=1;g[54]=0;g[55]=0;g[56]=1;g[57]=0;g[58]=0;g[59]=1;g[60]=0;g[61]=0;g[62]=1;g[63]=0;g[64]=0;g[65]=1;g[66]=0;g[67]=0;g[68]=1;g[69]=0;g[70]=0;g[71]=1;f.bitangent=new s({componentDatatype:r.FLOAT,componentsPerAttribute:3,values:g})}h=new Uint16Array(6*2*3);h[0]=0;h[1]=1;h[2]=2;h[3]=0;h[4]=2;h[5]=3;h[6]=4+2;h[7]=4+1;h[8]=4+0;h[9]=4+3;h[10]=4+2;h[11]=4+0;h[12]=8+0;h[13]=8+1;h[14]=8+2;h[15]=8+0;h[16]=8+2;h[17]=8+3;h[18]=12+2;h[19]=12+1;h[20]=12+0;h[21]=12+3;h[22]=12+2;h[23]=12+0;h[24]=16+2;h[25]=16+1;h[26]=16+0;h[27]=16+3;h[28]=16+2;h[29]=16+0;h[30]=20+0;h[31]=20+1;h[32]=20+2;h[33]=20+0;h[34]=20+2;h[35]=20+3}else{p=new Float64Array(8*3);p[0]=n.x;p[1]=n.y;p[2]=n.z;p[3]=a.x;p[4]=n.y;p[5]=n.z;p[6]=a.x;p[7]=a.y;p[8]=n.z;p[9]=n.x;p[10]=a.y;p[11]=n.z;p[12]=n.x;p[13]=n.y;p[14]=a.z;p[15]=a.x;p[16]=n.y;p[17]=a.z;p[18]=a.x;p[19]=a.y;p[20]=a.z;p[21]=n.x;p[22]=a.y;p[23]=a.z;f.position=new s({componentDatatype:r.DOUBLE,componentsPerAttribute:3,values:p});h=new Uint16Array(6*2*3);h[0]=4;h[1]=5;h[2]=6;h[3]=4;h[4]=6;h[5]=7;h[6]=1;h[7]=0;h[8]=3;h[9]=1;h[10]=3;h[11]=2;h[12]=1;h[13]=6;h[14]=5;h[15]=1;h[16]=2;h[17]=6;h[18]=2;h[19]=3;h[20]=7;h[21]=2;h[22]=7;h[23]=6;h[24]=3;h[25]=0;h[26]=4;h[27]=3;h[28]=4;h[29]=7;h[30]=0;h[31]=1;h[32]=5;h[33]=0;h[34]=5;h[35]=4}var y=t.subtract(a,n,d);var w=t.magnitude(y)*.5;return new o({attributes:f,indices:h,primitiveType:l.TRIANGLES,boundingSphere:new e(t.ZERO,w)})};return f});define("Core/BoxOutlineGeometry",["./BoundingSphere","./Cartesian3","./ComponentDatatype","./defaultValue","./defined","./DeveloperError","./Geometry","./GeometryAttribute","./GeometryAttributes","./PrimitiveType"],function(e,t,r,i,n,a,o,s,u,l){"use strict";var c=new t;function d(e){e=i(e,i.EMPTY_OBJECT);var r=e.minimum;var o=e.maximum;if(!n(r)){throw new a("options.minimum is required.")}if(!n(o)){throw new a("options.maximum is required")}this._min=t.clone(r);this._max=t.clone(o);this._workerName="createBoxOutlineGeometry"}d.fromDimensions=function(e){e=i(e,i.EMPTY_OBJECT);var r=e.dimensions;if(!n(r)){throw new a("options.dimensions is required.")}if(r.x<0||r.y<0||r.z<0){throw new a("All dimensions components must be greater than or equal to zero.")}var o=t.multiplyByScalar(r,.5,new t);return new d({minimum:t.negate(o,new t),maximum:o})};d.fromAxisAlignedBoundingBox=function(e){if(!n(e)){throw new a("boundingBox is required.")}return new d({minimum:e.minimum,maximum:e.maximum})};d.packedLength=2*t.packedLength;d.pack=function(e,r,o){if(!n(e)){throw new a("value is required")}if(!n(r)){throw new a("array is required")}o=i(o,0);t.pack(e._min,r,o);t.pack(e._max,r,o+t.packedLength);return r};var f=new t;var h=new t;var p={minimum:f,maximum:h};d.unpack=function(e,r,o){if(!n(e)){throw new a("array is required")}r=i(r,0);var s=t.unpack(e,r,f);var u=t.unpack(e,r+t.packedLength,h);if(!n(o)){return new d(p)}o._min=t.clone(s,o._min);o._max=t.clone(u,o._max);return o};d.createGeometry=function(i){var n=i._min;var a=i._max;if(t.equals(n,a)){return}var d=new u;var f=new Uint16Array(12*2);var h=new Float64Array(8*3);h[0]=n.x;h[1]=n.y;h[2]=n.z;h[3]=a.x;h[4]=n.y;h[5]=n.z;h[6]=a.x;h[7]=a.y;h[8]=n.z;h[9]=n.x;h[10]=a.y;h[11]=n.z;h[12]=n.x;h[13]=n.y;h[14]=a.z;h[15]=a.x;h[16]=n.y;h[17]=a.z;h[18]=a.x;h[19]=a.y;h[20]=a.z;h[21]=n.x;h[22]=a.y;h[23]=a.z;d.position=new s({componentDatatype:r.DOUBLE,componentsPerAttribute:3,values:h});f[0]=4;f[1]=5;f[2]=5;f[3]=6;f[4]=6;f[5]=7;f[6]=7;f[7]=4;f[8]=0;f[9]=1;f[10]=1;f[11]=2;f[12]=2;f[13]=3;f[14]=3;f[15]=0;f[16]=0;f[17]=4;f[18]=1;f[19]=5;f[20]=2;f[21]=6;f[22]=3;f[23]=7;var p=t.subtract(a,n,c);var m=t.magnitude(p)*.5;return new o({attributes:d,indices:f,primitiveType:l.LINES,boundingSphere:new e(t.ZERO,m)})};return d});define("Core/getAbsoluteUri",["../ThirdParty/Uri","./defaultValue","./defined","./DeveloperError"],function(e,t,r,i){"use strict";function n(n,a){if(!r(n)){throw new i("relative uri is required.")}a=t(a,document.location.href);var o=new e(a);var s=new e(n);return s.resolve(o).toString()}return n});define("Core/joinUrls",["../ThirdParty/Uri","./defaultValue","./defined","./DeveloperError"],function(e,t,r,i){"use strict";function n(n,a,o){if(!r(n)){throw new i("first is required")}if(!r(a)){throw new i("second is required")}o=t(o,true);if(!(n instanceof e)){n=new e(n)}if(!(a instanceof e)){a=new e(a)}if(r(a.authority)&&!r(a.scheme)){if(typeof document!=="undefined"&&r(document.location)&&r(document.location.href)){a.scheme=new e(document.location.href).scheme}else{a.scheme=n.scheme}}var s=n;if(a.isAbsolute()){s=a;if(a.scheme==="data"){return a.toString()}}var u="";if(r(s.scheme)){u+=s.scheme+":"}if(r(s.authority)){u+="//"+s.authority;if(s.path!==""&&s.path!=="/"){u=u.replace(/\/?$/,"/");s.path=s.path.replace(/^\/?/g,"")}}if(s===n){if(o){u+=n.path.replace(/\/?$/,"/")+a.path.replace(/^\/?/g,"")}else{u+=n.path+a.path}}else{u+=a.path}var l=r(n.query);var c=r(a.query);if(l&&c){u+="?"+n.query+"&"+a.query}else if(l&&!c){u+="?"+n.query}else if(!l&&c){u+="?"+a.query}var d=r(a.fragment);if(r(n.fragment)&&!d){u+="#"+n.fragment}else if(d){u+="#"+a.fragment}return u}return n});define("Core/buildModuleUrl",["../ThirdParty/Uri","./defined","./DeveloperError","./getAbsoluteUri","./joinUrls","require"],function(e,t,r,i,n,a){"use strict";var o=/((?:.*\/)|^)cesium[\w-]*\.js(?:\W|$)/i;function s(){var e=document.getElementsByTagName("script");for(var t=0,r=e.length;t<r;++t){var i=e[t].getAttribute("src");var n=o.exec(i);if(n!==null){return n[1]}}return undefined}var u;function l(){if(t(u)){return u}var n;if(typeof CESIUM_BASE_URL!=="undefined"){n=CESIUM_BASE_URL}else{n=s()}if(!t(n)){throw new r("Unable to determine Cesium base URL automatically, try defining a global variable called CESIUM_BASE_URL.")}u=new e(i(n));return u}function c(e){return a.toUrl("../"+e)}function d(e){return n(l(),e)}var f;var h;function p(e){if(!t(f)){if(t(a.toUrl)){f=c}else{f=d}}if(!t(h)){h=document.createElement("a")}var r=f(e);h.href=r;h.href=h.href;return h.href}p._cesiumScriptRegex=o;p.setBaseUrl=function(t){u=new e(t).resolve(new e(document.location.href))};return p});define("Core/cancelAnimationFrame",["./defined"],function(e){"use strict";if(typeof window==="undefined"){return}var t=window.cancelAnimationFrame;(function(){if(!e(t)){var r=["webkit","moz","ms","o"];var i=0;var n=r.length;while(i<n&&!e(t)){t=window[r[i]+"CancelAnimationFrame"];if(!e(t)){t=window[r[i]+"CancelRequestAnimationFrame"]}++i}}if(!e(t)){t=clearTimeout}})();function r(e){t(e)}return r});define("Core/CartographicGeocoderService",["./Cartesian3","./defaultValue","./defineProperties","./defined","./DeveloperError","../ThirdParty/when"],function(e,t,r,i,n,a){"use strict";function o(){}o.prototype.geocode=function(t){if(!i(t)){throw new n("query must be defined")}var r=t.match(/[^\s,\n]+/g);if(r.length===2||r.length===3){var o=+r[0];var s=+r[1];var u=r.length===3?+r[2]:300;if(!isNaN(o)&&!isNaN(s)&&!isNaN(u)){var l={displayName:t,destination:e.fromDegrees(o,s,u)};return a.resolve([l])}}return a.resolve([])};return o});define("Core/Spline",["./defaultValue","./defined","./DeveloperError"],function(e,t,r){"use strict";function i(){this.times=undefined;this.points=undefined;r.throwInstantiationError()}i.prototype.evaluate=r.throwInstantiationError;i.prototype.findTimeInterval=function(i,n){var a=this.times;var o=a.length;if(!t(i)){throw new r("time is required.")}if(i<a[0]||i>a[o-1]){throw new r("time is out of range.")}n=e(n,0);if(i>=a[n]){if(n+1<o&&i<a[n+1]){return n}else if(n+2<o&&i<a[n+2]){return n+1}}else if(n-1>=0&&i>=a[n-1]){return n-1}var s;if(i>a[n]){for(s=n;s<o-1;++s){if(i>=a[s]&&i<a[s+1]){break}}}else{for(s=n-1;s>=0;--s){if(i>=a[s]&&i<a[s+1]){break}}}if(s===o-1){s=o-2}return s};return i});define("Core/LinearSpline",["./Cartesian3","./defaultValue","./defined","./defineProperties","./DeveloperError","./Spline"],function(e,t,r,i,n,a){"use strict";function o(e){e=t(e,t.EMPTY_OBJECT);var i=e.points;var a=e.times;if(!r(i)||!r(a)){throw new n("points and times are required.")}if(i.length<2){throw new n("points.length must be greater than or equal to 2.")}if(a.length!==i.length){throw new n("times.length must be equal to points.length.")}this._times=a;this._points=i;this._lastTimeIndex=0}i(o.prototype,{times:{get:function(){return this._times}},points:{get:function(){return this._points}}});o.prototype.findTimeInterval=a.prototype.findTimeInterval;o.prototype.evaluate=function(t,i){var n=this.points;var a=this.times;var o=this._lastTimeIndex=this.findTimeInterval(t,this._lastTimeIndex);var s=(t-a[o])/(a[o+1]-a[o]);if(!r(i)){i=new e}return e.lerp(n[o],n[o+1],s,i)};return o});define("Core/TridiagonalSystemSolver",["./Cartesian3","./defined","./DeveloperError"],function(e,t,r){"use strict";var i={};i.solve=function(i,n,a,o){if(!t(i)||!(i instanceof Array)){throw new r("The array lower is required.")}if(!t(n)||!(n instanceof Array)){throw new r("The array diagonal is required.")}if(!t(a)||!(a instanceof Array)){throw new r("The array upper is required.")}if(!t(o)||!(o instanceof Array)){throw new r("The array right is required.")}if(n.length!==o.length){throw new r("diagonal and right must have the same lengths.")}if(i.length!==a.length){throw new r("lower and upper must have the same lengths.")}else if(i.length!==n.length-1){throw new r("lower and upper must be one less than the length of diagonal.")}var s=new Array(a.length);var u=new Array(o.length);var l=new Array(o.length);var c;for(c=0;c<u.length;c++){u[c]=new e;l[c]=new e}s[0]=a[0]/n[0];u[0]=e.multiplyByScalar(o[0],1/n[0],u[0]);var d;for(c=1;c<s.length;++c){d=1/(n[c]-s[c-1]*i[c-1]);s[c]=a[c]*d;u[c]=e.subtract(o[c],e.multiplyByScalar(u[c-1],i[c-1],u[c]),u[c]);u[c]=e.multiplyByScalar(u[c],d,u[c])}d=1/(n[c]-s[c-1]*i[c-1]);u[c]=e.subtract(o[c],e.multiplyByScalar(u[c-1],i[c-1],u[c]),u[c]);u[c]=e.multiplyByScalar(u[c],d,u[c]);l[l.length-1]=u[u.length-1];for(c=l.length-2;c>=0;--c){l[c]=e.subtract(u[c],e.multiplyByScalar(l[c+1],s[c],l[c]),l[c])}return l};return i});define("Core/HermiteSpline",["./Cartesian3","./Cartesian4","./defaultValue","./defined","./defineProperties","./DeveloperError","./LinearSpline","./Matrix4","./Spline","./TridiagonalSystemSolver"],function(e,t,r,i,n,a,o,s,u,l){"use strict";var c=[];var d=[];var f=[];var h=[];function p(t,r,n){var a=c;var o=f;var s=d;var u=h;a.length=o.length=t.length-1;s.length=u.length=t.length;var p;a[0]=s[0]=1;o[0]=0;var m=u[0];if(!i(m)){m=u[0]=new e}e.clone(r,m);for(p=1;p<a.length-1;++p){a[p]=o[p]=1;s[p]=4;m=u[p];if(!i(m)){m=u[p]=new e}e.subtract(t[p+1],t[p-1],m);e.multiplyByScalar(m,3,m)}a[p]=0;o[p]=1;s[p]=4;m=u[p];if(!i(m)){m=u[p]=new e}e.subtract(t[p+1],t[p-1],m);e.multiplyByScalar(m,3,m);s[p+1]=1;m=u[p+1];if(!i(m)){m=u[p+1]=new e}e.clone(n,m);return l.solve(a,s,o,u)}function m(t){var r=c;var n=f;var a=d;var o=h;r.length=n.length=t.length-1;a.length=o.length=t.length;var s;r[0]=n[0]=1;a[0]=2;var u=o[0];if(!i(u)){u=o[0]=new e}e.subtract(t[1],t[0],u);e.multiplyByScalar(u,3,u);for(s=1;s<r.length;++s){r[s]=n[s]=1;a[s]=4;u=o[s];if(!i(u)){u=o[s]=new e}e.subtract(t[s+1],t[s-1],u);e.multiplyByScalar(u,3,u)}a[s]=2;u=o[s];if(!i(u)){u=o[s]=new e}e.subtract(t[s],t[s-1],u);e.multiplyByScalar(u,3,u);return l.solve(r,a,n,o)}function v(e){e=r(e,r.EMPTY_OBJECT);var t=e.points;var n=e.times;var o=e.inTangents;var s=e.outTangents;if(!i(t)||!i(n)||!i(o)||!i(s)){throw new a("times, points, inTangents, and outTangents are required.")}if(t.length<2){throw new a("points.length must be greater than or equal to 2.")}if(n.length!==t.length){throw new a("times.length must be equal to points.length.")}if(o.length!==s.length||o.length!==t.length-1){throw new a("inTangents and outTangents must have a length equal to points.length - 1.")}this._times=n;this._points=t;this._inTangents=o;this._outTangents=s;this._lastTimeIndex=0}n(v.prototype,{times:{get:function(){return this._times}},points:{get:function(){return this._points}},inTangents:{get:function(){return this._inTangents}},outTangents:{get:function(){return this._outTangents}}});v.createC1=function(e){e=r(e,r.EMPTY_OBJECT);var t=e.times;var n=e.points;var o=e.tangents;if(!i(n)||!i(t)||!i(o)){throw new a("points, times and tangents are required.")}if(n.length<2){throw new a("points.length must be greater than or equal to 2.")}if(t.length!==n.length||t.length!==o.length){throw new a("times, points and tangents must have the same length.")}var s=o.slice(0,o.length-1);var u=o.slice(1,o.length);return new v({times:t,points:n,inTangents:u,outTangents:s})};v.createNaturalCubic=function(e){e=r(e,r.EMPTY_OBJECT);var t=e.times;var n=e.points;if(!i(n)||!i(t)){throw new a("points and times are required.")}if(n.length<2){throw new a("points.length must be greater than or equal to 2.")}if(t.length!==n.length){throw new a("times.length must be equal to points.length.")}if(n.length<3){return new o({points:n,times:t})}var s=m(n);var u=s.slice(0,s.length-1);var l=s.slice(1,s.length);return new v({times:t,points:n,inTangents:l,outTangents:u})};v.createClampedCubic=function(e){e=r(e,r.EMPTY_OBJECT);var t=e.times;var n=e.points;var s=e.firstTangent;var u=e.lastTangent;if(!i(n)||!i(t)||!i(s)||!i(u)){throw new a("points, times, firstTangent and lastTangent are required.")}if(n.length<2){throw new a("points.length must be greater than or equal to 2.")}if(t.length!==n.length){throw new a("times.length must be equal to points.length.")}if(n.length<3){return new o({points:n,times:t})}var l=p(n,s,u);var c=l.slice(0,l.length-1);var d=l.slice(1,l.length);return new v({times:t,points:n,inTangents:d,outTangents:c})};v.hermiteCoefficientMatrix=new s(2,-3,0,1,-2,3,0,0,1,-2,1,0,1,-1,0,0);v.prototype.findTimeInterval=u.prototype.findTimeInterval;var _=new t;var g=new e;v.prototype.evaluate=function(t,r){if(!i(r)){r=new e}var n=this.points;var a=this.times;var o=this.inTangents;var u=this.outTangents;var l=this._lastTimeIndex=this.findTimeInterval(t,this._lastTimeIndex);var c=(t-a[l])/(a[l+1]-a[l]);var d=_;d.z=c;d.y=c*c;d.x=d.y*c;d.w=1;var f=s.multiplyByVector(v.hermiteCoefficientMatrix,d,d);r=e.multiplyByScalar(n[l],f.x,r);e.multiplyByScalar(n[l+1],f.y,g);e.add(r,g,r);e.multiplyByScalar(u[l],f.z,g);e.add(r,g,r);e.multiplyByScalar(o[l],f.w,g);return e.add(r,g,r)};return v});define("Core/CatmullRomSpline",["./Cartesian3","./Cartesian4","./defaultValue","./defined","./defineProperties","./DeveloperError","./HermiteSpline","./Matrix4","./Spline"],function(e,t,r,i,n,a,o,s,u){"use strict";var l=new t;var c=new e;var d=new e;function f(t){var r=t.points;var n=t.times;if(r.length<3){var a=n[0];var u=1/(n[1]-a);var f=r[0];var h=r[1];return function(t,r){if(!i(r)){r=new e}var n=(t-a)*u;return e.lerp(f,h,n,r)}}return function(a,u){if(!i(u)){u=new e}var f=t._lastTimeIndex=t.findTimeInterval(a,t._lastTimeIndex);var h=(a-n[f])/(n[f+1]-n[f]);var p=l;p.z=h;p.y=h*h;p.x=p.y*h;p.w=1;var v;var _;var g;var y;var w;if(f===0){v=r[0];_=r[1];g=t.firstTangent;y=e.subtract(r[2],v,c);e.multiplyByScalar(y,.5,y);w=s.multiplyByVector(o.hermiteCoefficientMatrix,p,p)}else if(f===r.length-2){v=r[f];_=r[f+1];y=t.lastTangent;g=e.subtract(_,r[f-1],c);e.multiplyByScalar(g,.5,g);w=s.multiplyByVector(o.hermiteCoefficientMatrix,p,p)}else{v=r[f-1];_=r[f];g=r[f+1];y=r[f+2];w=s.multiplyByVector(m.catmullRomCoefficientMatrix,p,p)}u=e.multiplyByScalar(v,w.x,u);e.multiplyByScalar(_,w.y,d);e.add(u,d,u);e.multiplyByScalar(g,w.z,d);e.add(u,d,u);e.multiplyByScalar(y,w.w,d);return e.add(u,d,u)}}var h=new e;var p=new e;function m(t){t=r(t,r.EMPTY_OBJECT);var n=t.points;var o=t.times;var s=t.firstTangent;var u=t.lastTangent;if(!i(n)||!i(o)){throw new a("points and times are required.")}if(n.length<2){throw new a("points.length must be greater than or equal to 2.")}if(o.length!==n.length){throw new a("times.length must be equal to points.length.")}if(n.length>2){if(!i(s)){s=h;e.multiplyByScalar(n[1],2,s);e.subtract(s,n[2],s);e.subtract(s,n[0],s);e.multiplyByScalar(s,.5,s)}if(!i(u)){var l=n.length-1;u=p;e.multiplyByScalar(n[l-1],2,u);e.subtract(n[l],u,u);e.add(u,n[l-2],u);e.multiplyByScalar(u,.5,u)}}this._times=o;this._points=n;this._firstTangent=e.clone(s);this._lastTangent=e.clone(u);this._evaluateFunction=f(this);this._lastTimeIndex=0}n(m.prototype,{times:{get:function(){return this._times}},points:{get:function(){return this._points}},firstTangent:{get:function(){return this._firstTangent}},lastTangent:{get:function(){return this._lastTangent}}});m.catmullRomCoefficientMatrix=new s(-.5,1,-.5,0,1.5,-2.5,0,1,-1.5,2,.5,0,.5,-.5,0,0);m.prototype.findTimeInterval=u.prototype.findTimeInterval;m.prototype.evaluate=function(e,t){return this._evaluateFunction(e,t)};return m});define("Core/Event",["./defined","./defineProperties","./DeveloperError"],function(e,t,r){"use strict";function i(){this._listeners=[];this._scopes=[];this._toRemove=[];this._insideRaiseEvent=false}t(i.prototype,{numberOfListeners:{get:function(){return this._listeners.length-this._toRemove.length}}});i.prototype.addEventListener=function(e,t){if(typeof e!=="function"){throw new r("listener is required and must be a function.")}this._listeners.push(e);this._scopes.push(t);var i=this;return function(){i.removeEventListener(e,t)}};i.prototype.removeEventListener=function(e,t){if(typeof e!=="function"){throw new r("listener is required and must be a function.")}var i=this._listeners;var n=this._scopes;var a=-1;for(var o=0;o<i.length;o++){if(i[o]===e&&n[o]===t){a=o;break}}if(a!==-1){if(this._insideRaiseEvent){this._toRemove.push(a);i[a]=undefined;n[a]=undefined}else{i.splice(a,1);n.splice(a,1)}return true}return false};i.prototype.raiseEvent=function(){this._insideRaiseEvent=true;var t;var r=this._listeners;var i=this._scopes;var n=r.length;for(t=0;t<n;t++){var a=r[t];if(e(a)){r[t].apply(i[t],arguments)}}var o=this._toRemove;n=o.length;for(t=0;t<n;t++){var s=o[t];r.splice(s,1);i.splice(s,1)}o.length=0;this._insideRaiseEvent=false};return i});define("Core/GeographicTilingScheme",["./Cartesian2","./defaultValue","./defined","./defineProperties","./DeveloperError","./Ellipsoid","./GeographicProjection","./Math","./Rectangle"],function(e,t,r,i,n,a,o,s,u){"use strict";function l(e){e=t(e,{});this._ellipsoid=t(e.ellipsoid,a.WGS84);this._rectangle=t(e.rectangle,u.MAX_VALUE);this._projection=new o(this._ellipsoid);this._numberOfLevelZeroTilesX=t(e.numberOfLevelZeroTilesX,2);this._numberOfLevelZeroTilesY=t(e.numberOfLevelZeroTilesY,1)}i(l.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},rectangle:{get:function(){return this._rectangle}},projection:{get:function(){return this._projection}}});l.prototype.getNumberOfXTilesAtLevel=function(e){return this._numberOfLevelZeroTilesX<<e};l.prototype.getNumberOfYTilesAtLevel=function(e){return this._numberOfLevelZeroTilesY<<e};l.prototype.rectangleToNativeRectangle=function(e,t){if(!r(e)){throw new n("rectangle is required.")}var i=s.toDegrees(e.west);var a=s.toDegrees(e.south);var o=s.toDegrees(e.east);var l=s.toDegrees(e.north);if(!r(t)){return new u(i,a,o,l)}t.west=i;t.south=a;t.east=o;t.north=l;return t};l.prototype.tileXYToNativeRectangle=function(e,t,r,i){var n=this.tileXYToRectangle(e,t,r,i);n.west=s.toDegrees(n.west);n.south=s.toDegrees(n.south);n.east=s.toDegrees(n.east);n.north=s.toDegrees(n.north);return n};l.prototype.tileXYToRectangle=function(e,t,i,n){var a=this._rectangle;var o=this.getNumberOfXTilesAtLevel(i);var s=this.getNumberOfYTilesAtLevel(i);var l=a.width/o;var c=e*l+a.west;var d=(e+1)*l+a.west;var f=a.height/s;var h=a.north-t*f;var p=a.north-(t+1)*f;if(!r(n)){n=new u(c,p,d,h)}n.west=c;n.south=p;n.east=d;n.north=h;return n};l.prototype.positionToTileXY=function(t,i,n){var a=this._rectangle;if(!u.contains(a,t)){return undefined}var o=this.getNumberOfXTilesAtLevel(i);var l=this.getNumberOfYTilesAtLevel(i);var c=a.width/o;var d=a.height/l;var f=t.longitude;if(a.east<a.west){f+=s.TWO_PI}var h=(f-a.west)/c|0;if(h>=o){h=o-1}var p=(a.north-t.latitude)/d|0;if(p>=l){p=l-1}if(!r(n)){return new e(h,p)}n.x=h;n.y=p;return n};return l});define("Core/EllipsoidalOccluder",["./BoundingSphere","./Cartesian3","./defaultValue","./defined","./defineProperties","./DeveloperError","./Rectangle"],function(e,t,r,i,n,a,o){"use strict";function s(e,r){if(!i(e)){throw new a("ellipsoid is required.")}this._ellipsoid=e;this._cameraPosition=new t;this._cameraPositionInScaledSpace=new t;this._distanceToLimbInScaledSpaceSquared=0;if(i(r)){this.cameraPosition=r}}n(s.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},cameraPosition:{get:function(){return this._cameraPosition},set:function(e){var r=this._ellipsoid;var i=r.transformPositionToScaledSpace(e,this._cameraPositionInScaledSpace);var n=t.magnitudeSquared(i)-1;t.clone(e,this._cameraPosition);this._cameraPositionInScaledSpace=i;this._distanceToLimbInScaledSpaceSquared=n}}});var u=new t;s.prototype.isPointVisible=function(e){var t=this._ellipsoid;var r=t.transformPositionToScaledSpace(e,u);return this.isScaledSpacePointVisible(r)};s.prototype.isScaledSpacePointVisible=function(e){var r=this._cameraPositionInScaledSpace;var i=this._distanceToLimbInScaledSpaceSquared;var n=t.subtract(e,r,u);var a=-t.dot(n,r);var o=i<0?a>0:a>i&&a*a/t.magnitudeSquared(n)>i;return!o};s.prototype.computeHorizonCullingPoint=function(e,r,n){if(!i(e)){throw new a("directionToPoint is required")}if(!i(r)){throw new a("positions is required")}if(!i(n)){n=new t}var o=this._ellipsoid;var s=v(o,e);var u=0;for(var l=0,c=r.length;l<c;++l){var d=r[l];var f=h(o,d,s);u=Math.max(u,f)}return p(s,u,n)};var l=new t;s.prototype.computeHorizonCullingPointFromVertices=function(e,n,o,s,u){if(!i(e)){throw new a("directionToPoint is required")}if(!i(n)){
throw new a("vertices is required")}if(!i(o)){throw new a("stride is required")}if(!i(u)){u=new t}s=r(s,t.ZERO);var c=this._ellipsoid;var d=v(c,e);var f=0;for(var m=0,_=n.length;m<_;m+=o){l.x=n[m]+s.x;l.y=n[m+1]+s.y;l.z=n[m+2]+s.z;var g=h(c,l,d);f=Math.max(f,g)}return p(d,f,u)};var c=[];s.prototype.computeHorizonCullingPointFromRectangle=function(r,n,s){if(!i(r)){throw new a("rectangle is required.")}var u=o.subsample(r,n,0,c);var l=e.fromPoints(u);if(t.magnitude(l.center)<.1*n.minimumRadius){return undefined}return this.computeHorizonCullingPoint(l.center,u,s)};var d=new t;var f=new t;function h(e,r,i){var n=e.transformPositionToScaledSpace(r,d);var a=t.magnitudeSquared(n);var o=Math.sqrt(a);var s=t.divideByScalar(n,o,f);a=Math.max(1,a);o=Math.max(1,o);var u=t.dot(s,i);var l=t.magnitude(t.cross(s,i,s));var c=1/o;var h=Math.sqrt(a-1)*c;return 1/(u*c-l*h)}function p(e,r,i){if(r<=0||r===1/0||r!==r){return undefined}return t.multiplyByScalar(e,r,i)}var m=new t;function v(e,r){if(t.equals(r,t.ZERO)){return r}e.transformPositionToScaledSpace(r,m);return t.normalize(m,m)}return s});define("Core/QuadraticRealPolynomial",["./DeveloperError","./Math"],function(e,t){"use strict";var r={};r.computeDiscriminant=function(t,r,i){if(typeof t!=="number"){throw new e("a is a required number.")}if(typeof r!=="number"){throw new e("b is a required number.")}if(typeof i!=="number"){throw new e("c is a required number.")}var n=r*r-4*t*i;return n};function i(e,r,i){var n=e+r;if(t.sign(e)!==t.sign(r)&&Math.abs(n/Math.max(Math.abs(e),Math.abs(r)))<i){return 0}return n}r.computeRealRoots=function(r,n,a){if(typeof r!=="number"){throw new e("a is a required number.")}if(typeof n!=="number"){throw new e("b is a required number.")}if(typeof a!=="number"){throw new e("c is a required number.")}var o;if(r===0){if(n===0){return[]}return[-a/n]}else if(n===0){if(a===0){return[0,0]}var s=Math.abs(a);var u=Math.abs(r);if(s<u&&s/u<t.EPSILON14){return[0,0]}else if(s>u&&u/s<t.EPSILON14){return[]}o=-a/r;if(o<0){return[]}var l=Math.sqrt(o);return[-l,l]}else if(a===0){o=-n/r;if(o<0){return[o,0]}return[0,o]}var c=n*n;var d=4*r*a;var f=i(c,-d,t.EPSILON14);if(f<0){return[]}var h=-.5*i(n,t.sign(n)*Math.sqrt(f),t.EPSILON14);if(n>0){return[h/r,a/h]}return[a/h,h/r]};return r});define("Core/CubicRealPolynomial",["./DeveloperError","./QuadraticRealPolynomial"],function(e,t){"use strict";var r={};r.computeDiscriminant=function(t,r,i,n){if(typeof t!=="number"){throw new e("a is a required number.")}if(typeof r!=="number"){throw new e("b is a required number.")}if(typeof i!=="number"){throw new e("c is a required number.")}if(typeof n!=="number"){throw new e("d is a required number.")}var a=t*t;var o=r*r;var s=i*i;var u=n*n;var l=18*t*r*i*n+o*s-27*a*u-4*(t*s*i+o*r*n);return l};function i(e,t,r,i){var n=e;var a=t/3;var o=r/3;var s=i;var u=n*o;var l=a*s;var c=a*a;var d=o*o;var f=n*o-c;var h=n*s-a*o;var p=a*s-d;var m=4*f*p-h*h;var v;var _;if(m<0){var g;var y;var w;if(c*l>=u*d){g=n;y=f;w=-2*a*f+n*h}else{g=s;y=p;w=-s*h+2*o*p}var C=w<0?-1:1;var b=-C*Math.abs(g)*Math.sqrt(-m);_=-w+b;var S=_/2;var E=S<0?-Math.pow(-S,1/3):Math.pow(S,1/3);var T=_===b?-E:-y/E;v=y<=0?E+T:-w/(E*E+T*T+y);if(c*l>=u*d){return[(v-a)/n]}return[-s/(v+o)]}var x=f;var A=-2*a*f+n*h;var P=p;var D=-s*h+2*o*p;var M=Math.sqrt(m);var I=Math.sqrt(3)/2;var O=Math.abs(Math.atan2(n*M,-A)/3);v=2*Math.sqrt(-x);var R=Math.cos(O);_=v*R;var N=v*(-R/2-I*Math.sin(O));var L=_+N>2*a?_-a:N-a;var B=n;var F=L/B;O=Math.abs(Math.atan2(s*M,-D)/3);v=2*Math.sqrt(-P);R=Math.cos(O);_=v*R;N=v*(-R/2-I*Math.sin(O));var k=-s;var V=_+N<2*o?_+o:N+o;var z=k/V;var U=B*V;var q=-L*V-B*k;var G=L*k;var H=(o*q-a*G)/(-a*q+o*U);if(F<=H){if(F<=z){if(H<=z){return[F,H,z]}return[F,z,H]}return[z,F,H]}if(F<=z){return[H,F,z]}if(H<=z){return[H,z,F]}return[z,H,F]}r.computeRealRoots=function(r,n,a,o){if(typeof r!=="number"){throw new e("a is a required number.")}if(typeof n!=="number"){throw new e("b is a required number.")}if(typeof a!=="number"){throw new e("c is a required number.")}if(typeof o!=="number"){throw new e("d is a required number.")}var s;var u;if(r===0){return t.computeRealRoots(n,a,o)}else if(n===0){if(a===0){if(o===0){return[0,0,0]}u=-o/r;var l=u<0?-Math.pow(-u,1/3):Math.pow(u,1/3);return[l,l,l]}else if(o===0){s=t.computeRealRoots(r,0,a);if(s.Length===0){return[0]}return[s[0],0,s[1]]}return i(r,0,a,o)}else if(a===0){if(o===0){u=-n/r;if(u<0){return[u,0,0]}return[0,0,u]}return i(r,n,0,o)}else if(o===0){s=t.computeRealRoots(r,n,a);if(s.length===0){return[0]}else if(s[1]<=0){return[s[0],s[1],0]}else if(s[0]>=0){return[0,s[0],s[1]]}return[s[0],0,s[1]]}return i(r,n,a,o)};return r});define("Core/QuarticRealPolynomial",["./CubicRealPolynomial","./DeveloperError","./Math","./QuadraticRealPolynomial"],function(e,t,r,i){"use strict";var n={};n.computeDiscriminant=function(e,r,i,n,a){if(typeof e!=="number"){throw new t("a is a required number.")}if(typeof r!=="number"){throw new t("b is a required number.")}if(typeof i!=="number"){throw new t("c is a required number.")}if(typeof n!=="number"){throw new t("d is a required number.")}if(typeof a!=="number"){throw new t("e is a required number.")}var o=e*e;var s=o*e;var u=r*r;var l=u*r;var c=i*i;var d=c*i;var f=n*n;var h=f*n;var p=a*a;var m=p*a;var v=u*c*f-4*l*h-4*e*d*f+18*e*r*i*h-27*o*f*f+256*s*m+a*(18*l*i*n-4*u*d+16*e*c*c-80*e*r*c*n-6*e*u*f+144*o*i*f)+p*(144*e*u*i-27*u*u-128*o*c-192*o*r*n);return v};function a(t,n,a,o){var s=t*t;var u=n-3*s/8;var l=a-n*t/2+s*t/8;var c=o-a*t/4+n*s/16-3*s*s/256;var d=e.computeRealRoots(1,2*u,u*u-4*c,-l*l);if(d.length>0){var f=-t/4;var h=d[d.length-1];if(Math.abs(h)<r.EPSILON14){var p=i.computeRealRoots(1,u,c);if(p.length===2){var m=p[0];var v=p[1];var _;if(m>=0&&v>=0){var g=Math.sqrt(m);var y=Math.sqrt(v);return[f-y,f-g,f+g,f+y]}else if(m>=0&&v<0){_=Math.sqrt(m);return[f-_,f+_]}else if(m<0&&v>=0){_=Math.sqrt(v);return[f-_,f+_]}}return[]}else if(h>0){var w=Math.sqrt(h);var C=(u+h-l/w)/2;var b=(u+h+l/w)/2;var S=i.computeRealRoots(1,w,C);var E=i.computeRealRoots(1,-w,b);if(S.length!==0){S[0]+=f;S[1]+=f;if(E.length!==0){E[0]+=f;E[1]+=f;if(S[1]<=E[0]){return[S[0],S[1],E[0],E[1]]}else if(E[1]<=S[0]){return[E[0],E[1],S[0],S[1]]}else if(S[0]>=E[0]&&S[1]<=E[1]){return[E[0],S[0],S[1],E[1]]}else if(E[0]>=S[0]&&E[1]<=S[1]){return[S[0],E[0],E[1],S[1]]}else if(S[0]>E[0]&&S[0]<E[1]){return[E[0],S[0],E[1],S[1]]}return[S[0],E[0],S[1],E[1]]}return S}if(E.length!==0){E[0]+=f;E[1]+=f;return E}return[]}}return[]}function o(t,n,a,o){var s=a*a;var u=n*n;var l=t*t;var c=-2*n;var d=a*t+u-4*o;var f=l*o-a*n*t+s;var h=e.computeRealRoots(1,c,d,f);if(h.length>0){var p=h[0];var m=n-p;var v=m*m;var _=t/2;var g=m/2;var y=v-4*o;var w=v+4*Math.abs(o);var C=l-4*p;var b=l+4*Math.abs(p);var S;var E;if(p<0||y*b<C*w){var T=Math.sqrt(C);S=T/2;E=T===0?0:(t*g-a)/T}else{var x=Math.sqrt(y);S=x===0?0:(t*g-a)/x;E=x/2}var A;var P;if(_===0&&S===0){A=0;P=0}else if(r.sign(_)===r.sign(S)){A=_+S;P=p/A}else{P=_-S;A=p/P}var D;var M;if(g===0&&E===0){D=0;M=0}else if(r.sign(g)===r.sign(E)){D=g+E;M=o/D}else{M=g-E;D=o/M}var I=i.computeRealRoots(1,A,D);var O=i.computeRealRoots(1,P,M);if(I.length!==0){if(O.length!==0){if(I[1]<=O[0]){return[I[0],I[1],O[0],O[1]]}else if(O[1]<=I[0]){return[O[0],O[1],I[0],I[1]]}else if(I[0]>=O[0]&&I[1]<=O[1]){return[O[0],I[0],I[1],O[1]]}else if(O[0]>=I[0]&&O[1]<=I[1]){return[I[0],O[0],O[1],I[1]]}else if(I[0]>O[0]&&I[0]<O[1]){return[O[0],I[0],O[1],I[1]]}else{return[I[0],O[0],I[1],O[1]]}}return I}if(O.length!==0){return O}}return[]}n.computeRealRoots=function(i,n,s,u,l){if(typeof i!=="number"){throw new t("a is a required number.")}if(typeof n!=="number"){throw new t("b is a required number.")}if(typeof s!=="number"){throw new t("c is a required number.")}if(typeof u!=="number"){throw new t("d is a required number.")}if(typeof l!=="number"){throw new t("e is a required number.")}if(Math.abs(i)<r.EPSILON15){return e.computeRealRoots(n,s,u,l)}var c=n/i;var d=s/i;var f=u/i;var h=l/i;var p=c<0?1:0;p+=d<0?p+1:p;p+=f<0?p+1:p;p+=h<0?p+1:p;switch(p){case 0:return a(c,d,f,h);case 1:return o(c,d,f,h);case 2:return o(c,d,f,h);case 3:return a(c,d,f,h);case 4:return a(c,d,f,h);case 5:return o(c,d,f,h);case 6:return a(c,d,f,h);case 7:return a(c,d,f,h);case 8:return o(c,d,f,h);case 9:return a(c,d,f,h);case 10:return a(c,d,f,h);case 11:return o(c,d,f,h);case 12:return a(c,d,f,h);case 13:return a(c,d,f,h);case 14:return a(c,d,f,h);case 15:return a(c,d,f,h);default:return undefined}};return n});define("Core/Ray",["./Cartesian3","./defaultValue","./defined","./DeveloperError"],function(e,t,r,i){"use strict";function n(r,i){i=e.clone(t(i,e.ZERO));if(!e.equals(i,e.ZERO)){e.normalize(i,i)}this.origin=e.clone(t(r,e.ZERO));this.direction=i}n.getPoint=function(t,n,a){if(!r(t)){throw new i("ray is requred")}if(typeof n!=="number"){throw new i("t is a required number")}if(!r(a)){a=new e}a=e.multiplyByScalar(t.direction,n,a);return e.add(t.origin,a,a)};return n});define("Core/IntersectionTests",["./Cartesian3","./Cartographic","./defaultValue","./defined","./DeveloperError","./Interval","./Math","./Matrix3","./QuadraticRealPolynomial","./QuarticRealPolynomial","./Ray"],function(e,t,r,i,n,a,o,s,u,l,c){"use strict";var d={};d.rayPlane=function(t,r,a){if(!i(t)){throw new n("ray is required.")}if(!i(r)){throw new n("plane is required.")}if(!i(a)){a=new e}var s=t.origin;var u=t.direction;var l=r.normal;var c=e.dot(l,u);if(Math.abs(c)<o.EPSILON15){return undefined}var d=(-r.distance-e.dot(l,s))/c;if(d<0){return undefined}a=e.multiplyByScalar(u,d,a);return e.add(s,a,a)};var f=new e;var h=new e;var p=new e;var m=new e;var v=new e;d.rayTriangleParametric=function(t,a,s,u,l){if(!i(t)){throw new n("ray is required.")}if(!i(a)){throw new n("p0 is required.")}if(!i(s)){throw new n("p1 is required.")}if(!i(u)){throw new n("p2 is required.")}l=r(l,false);var c=t.origin;var d=t.direction;var _=e.subtract(s,a,f);var g=e.subtract(u,a,h);var y=e.cross(d,g,p);var w=e.dot(_,y);var C;var b;var S;var E;var T;if(l){if(w<o.EPSILON6){return undefined}C=e.subtract(c,a,m);S=e.dot(C,y);if(S<0||S>w){return undefined}b=e.cross(C,_,v);E=e.dot(d,b);if(E<0||S+E>w){return undefined}T=e.dot(g,b)/w}else{if(Math.abs(w)<o.EPSILON6){return undefined}var x=1/w;C=e.subtract(c,a,m);S=e.dot(C,y)*x;if(S<0||S>1){return undefined}b=e.cross(C,_,v);E=e.dot(d,b)*x;if(E<0||S+E>1){return undefined}T=e.dot(g,b)*x}return T};d.rayTriangle=function(t,r,n,a,o,s){var u=d.rayTriangleParametric(t,r,n,a,o);if(!i(u)||u<0){return undefined}if(!i(s)){s=new e}e.multiplyByScalar(t.direction,u,s);return e.add(t.origin,s,s)};var _=new c;d.lineSegmentTriangle=function(t,r,a,o,s,u,l){if(!i(t)){throw new n("v0 is required.")}if(!i(r)){throw new n("v1 is required.")}if(!i(a)){throw new n("p0 is required.")}if(!i(o)){throw new n("p1 is required.")}if(!i(s)){throw new n("p2 is required.")}var c=_;e.clone(t,c.origin);e.subtract(r,t,c.direction);e.normalize(c.direction,c.direction);var f=d.rayTriangleParametric(c,a,o,s,u);if(!i(f)||f<0||f>e.distance(t,r)){return undefined}if(!i(l)){l=new e}e.multiplyByScalar(c.direction,f,l);return e.add(c.origin,l,l)};function g(e,t,r,i){var n=t*t-4*e*r;if(n<0){return undefined}else if(n>0){var a=1/(2*e);var o=Math.sqrt(n);var s=(-t+o)*a;var u=(-t-o)*a;if(s<u){i.root0=s;i.root1=u}else{i.root0=u;i.root1=s}return i}var l=-t/(2*e);if(l===0){return undefined}i.root0=i.root1=l;return i}var y={root0:0,root1:0};function w(t,r,n){if(!i(n)){n=new a}var o=t.origin;var s=t.direction;var u=r.center;var l=r.radius*r.radius;var c=e.subtract(o,u,p);var d=e.dot(s,s);var f=2*e.dot(s,c);var h=e.magnitudeSquared(c)-l;var m=g(d,f,h,y);if(!i(m)){return undefined}n.start=m.root0;n.stop=m.root1;return n}d.raySphere=function(e,t,r){if(!i(e)){throw new n("ray is required.")}if(!i(t)){throw new n("sphere is required.")}r=w(e,t,r);if(!i(r)||r.stop<0){return undefined}r.start=Math.max(r.start,0);return r};var C=new c;d.lineSegmentSphere=function(t,r,a,o){if(!i(t)){throw new n("p0 is required.")}if(!i(r)){throw new n("p1 is required.")}if(!i(a)){throw new n("sphere is required.")}var s=C;e.clone(t,s.origin);var u=e.subtract(r,t,s.direction);var l=e.magnitude(u);e.normalize(u,u);o=w(s,a,o);if(!i(o)||o.stop<0||o.start>l){return undefined}o.start=Math.max(o.start,0);o.stop=Math.min(o.stop,l);return o};var b=new e;var S=new e;d.rayEllipsoid=function(t,r){if(!i(t)){throw new n("ray is required.")}if(!i(r)){throw new n("ellipsoid is required.")}var o=r.oneOverRadii;var s=e.multiplyComponents(o,t.origin,b);var u=e.multiplyComponents(o,t.direction,S);var l=e.magnitudeSquared(s);var c=e.dot(s,u);var d,f,h,p,m;if(l>1){if(c>=0){return undefined}var v=c*c;d=l-1;f=e.magnitudeSquared(u);h=f*d;if(v<h){return undefined}else if(v>h){p=c*c-h;m=-c+Math.sqrt(p);var _=m/f;var g=d/m;if(_<g){return new a(_,g)}return{start:g,stop:_}}else{var y=Math.sqrt(d/f);return new a(y,y)}}else if(l<1){d=l-1;f=e.magnitudeSquared(u);h=f*d;p=c*c-h;m=-c+Math.sqrt(p);return new a(0,m/f)}else{if(c<0){f=e.magnitudeSquared(u);return new a(0,-c/f)}return undefined}};function E(e,t,r){var i=e+t;if(o.sign(e)!==o.sign(t)&&Math.abs(i/Math.max(Math.abs(e),Math.abs(t)))<r){return 0}return i}function T(t,r,i,n,a){var c=n*n;var d=a*a;var f=(t[s.COLUMN1ROW1]-t[s.COLUMN2ROW2])*d;var h=a*(n*E(t[s.COLUMN1ROW0],t[s.COLUMN0ROW1],o.EPSILON15)+r.y);var p=t[s.COLUMN0ROW0]*c+t[s.COLUMN2ROW2]*d+n*r.x+i;var m=d*E(t[s.COLUMN2ROW1],t[s.COLUMN1ROW2],o.EPSILON15);var v=a*(n*E(t[s.COLUMN2ROW0],t[s.COLUMN0ROW2])+r.z);var _;var g=[];if(v===0&&m===0){_=u.computeRealRoots(f,h,p);if(_.length===0){return g}var y=_[0];var w=Math.sqrt(Math.max(1-y*y,0));g.push(new e(n,a*y,a*-w));g.push(new e(n,a*y,a*w));if(_.length===2){var C=_[1];var b=Math.sqrt(Math.max(1-C*C,0));g.push(new e(n,a*C,a*-b));g.push(new e(n,a*C,a*b))}return g}var S=v*v;var T=m*m;var x=f*f;var A=v*m;var P=x+T;var D=2*(h*f+A);var M=2*p*f+h*h-T+S;var I=2*(p*h-A);var O=p*p-S;if(P===0&&D===0&&M===0&&I===0){return g}_=l.computeRealRoots(P,D,M,I,O);var R=_.length;if(R===0){return g}for(var N=0;N<R;++N){var L=_[N];var B=L*L;var F=Math.max(1-B,0);var k=Math.sqrt(F);var V;if(o.sign(f)===o.sign(p)){V=E(f*B+p,h*L,o.EPSILON12)}else if(o.sign(p)===o.sign(h*L)){V=E(f*B,h*L+p,o.EPSILON12)}else{V=E(f*B+h*L,p,o.EPSILON12)}var z=E(m*L,v,o.EPSILON15);var U=V*z;if(U<0){g.push(new e(n,a*L,a*k))}else if(U>0){g.push(new e(n,a*L,a*-k))}else if(k!==0){g.push(new e(n,a*L,a*-k));g.push(new e(n,a*L,a*k));++N}else{g.push(new e(n,a*L,a*k))}}return g}var x=new e;var A=new e;var P=new e;var D=new e;var M=new e;var I=new s;var O=new s;var R=new s;var N=new s;var L=new s;var B=new s;var F=new s;var k=new e;var V=new e;var z=new t;d.grazingAltitudeLocation=function(t,r){if(!i(t)){throw new n("ray is required.")}if(!i(r)){throw new n("ellipsoid is required.")}var a=t.origin;var u=t.direction;if(!e.equals(a,e.ZERO)){var l=r.geodeticSurfaceNormal(a,x);if(e.dot(u,l)>=0){return a}}var c=i(this.rayEllipsoid(t,r));var d=r.transformPositionToScaledSpace(u,x);var f=e.normalize(d,d);var h=e.mostOrthogonalAxis(d,D);var p=e.normalize(e.cross(h,f,A),A);var m=e.normalize(e.cross(f,p,P),P);var v=I;v[0]=f.x;v[1]=f.y;v[2]=f.z;v[3]=p.x;v[4]=p.y;v[5]=p.z;v[6]=m.x;v[7]=m.y;v[8]=m.z;var _=s.transpose(v,O);var g=s.fromScale(r.radii,R);var y=s.fromScale(r.oneOverRadii,N);var w=L;w[0]=0;w[1]=-u.z;w[2]=u.y;w[3]=u.z;w[4]=0;w[5]=-u.x;w[6]=-u.y;w[7]=u.x;w[8]=0;var C=s.multiply(s.multiply(_,y,B),w,B);var b=s.multiply(s.multiply(C,g,F),v,F);var S=s.multiplyByVector(C,a,M);var E=T(b,e.negate(S,x),0,0,1);var U;var q;var G=E.length;if(G>0){var H=e.clone(e.ZERO,V);var W=Number.NEGATIVE_INFINITY;for(var j=0;j<G;++j){U=s.multiplyByVector(g,s.multiplyByVector(v,E[j],k),k);var Y=e.normalize(e.subtract(U,a,D),D);var X=e.dot(Y,u);if(X>W){W=X;H=e.clone(U,H)}}var Z=r.cartesianToCartographic(H,z);W=o.clamp(W,0,1);q=e.magnitude(e.subtract(H,a,D))*Math.sqrt(1-W*W);q=c?-q:q;Z.height=q;return r.cartographicToCartesian(Z,new e)}return undefined};var U=new e;d.lineSegmentPlane=function(t,r,a,s){if(!i(t)){throw new n("endPoint0 is required.")}if(!i(r)){throw new n("endPoint1 is required.")}if(!i(a)){throw new n("plane is required.")}if(!i(s)){s=new e}var u=e.subtract(r,t,U);var l=a.normal;var c=e.dot(l,u);if(Math.abs(c)<o.EPSILON6){return undefined}var d=e.dot(l,t);var f=-(a.distance+d)/c;if(f<0||f>1){return undefined}e.multiplyByScalar(u,f,s);e.add(t,s,s);return s};d.trianglePlaneIntersection=function(t,r,a,o){if(!i(t)||!i(r)||!i(a)||!i(o)){throw new n("p0, p1, p2, and plane are required.")}var s=o.normal;var u=o.distance;var l=e.dot(s,t)+u<0;var c=e.dot(s,r)+u<0;var f=e.dot(s,a)+u<0;var h=0;h+=l?1:0;h+=c?1:0;h+=f?1:0;var p,m;if(h===1||h===2){p=new e;m=new e}if(h===1){if(l){d.lineSegmentPlane(t,r,o,p);d.lineSegmentPlane(t,a,o,m);return{positions:[t,r,a,p,m],indices:[0,3,4,1,2,4,1,4,3]}}else if(c){d.lineSegmentPlane(r,a,o,p);d.lineSegmentPlane(r,t,o,m);return{positions:[t,r,a,p,m],indices:[1,3,4,2,0,4,2,4,3]}}else if(f){d.lineSegmentPlane(a,t,o,p);d.lineSegmentPlane(a,r,o,m);return{positions:[t,r,a,p,m],indices:[2,3,4,0,1,4,0,4,3]}}}else if(h===2){if(!l){d.lineSegmentPlane(r,t,o,p);d.lineSegmentPlane(a,t,o,m);return{positions:[t,r,a,p,m],indices:[1,2,4,1,4,3,0,3,4]}}else if(!c){d.lineSegmentPlane(a,r,o,p);d.lineSegmentPlane(t,r,o,m);return{positions:[t,r,a,p,m],indices:[2,0,4,2,4,3,1,3,4]}}else if(!f){d.lineSegmentPlane(t,a,o,p);d.lineSegmentPlane(r,a,o,m);return{positions:[t,r,a,p,m],indices:[0,1,4,0,4,3,2,3,4]}}}return undefined};return d});define("Core/Plane",["./Cartesian3","./defined","./DeveloperError","./freezeObject"],function(e,t,r,i){"use strict";function n(i,n){if(!t(i)){throw new r("normal is required.")}if(!t(n)){throw new r("distance is required.")}this.normal=e.clone(i);this.distance=n}n.fromPointNormal=function(i,a,o){if(!t(i)){throw new r("point is required.")}if(!t(a)){throw new r("normal is required.")}var s=-e.dot(a,i);if(!t(o)){return new n(a,s)}e.clone(a,o.normal);o.distance=s;return o};var a=new e;n.fromCartesian4=function(i,o){if(!t(i)){throw new r("coefficients is required.")}var s=e.fromCartesian4(i,a);var u=i.w;if(!t(o)){return new n(s,u)}else{e.clone(s,o.normal);o.distance=u;return o}};n.getPointDistance=function(i,n){if(!t(i)){throw new r("plane is required.")}if(!t(n)){throw new r("point is required.")}return e.dot(i.normal,n)+i.distance};n.ORIGIN_XY_PLANE=i(new n(e.UNIT_Z,0));n.ORIGIN_YZ_PLANE=i(new n(e.UNIT_X,0));n.ORIGIN_ZX_PLANE=i(new n(e.UNIT_Y,0));return n});define("Core/oneTimeWarning",["./defaultValue","./defined","./DeveloperError"],function(e,t,r){"use strict";var i={};function n(n,a){if(!t(n)){throw new r("identifier is required.")}if(!t(i[n])){i[n]=true;console.warn(e(a,n))}}n.geometryOutlines="Entity geometry outlines are unsupported on terrain. Outlines will be disabled. To enable outlines, disable geometry terrain clamping by explicitly setting height to 0.";return n});define("Core/deprecationWarning",["./defined","./DeveloperError","./oneTimeWarning"],function(e,t,r){"use strict";function i(i,n){if(!e(i)||!e(n)){throw new t("identifier and message are required.")}r(i,n)}return i});define("Core/EarthOrientationParametersSample",[],function(){"use strict";function e(e,t,r,i,n){this.xPoleWander=e;this.yPoleWander=t;this.xPoleOffset=r;this.yPoleOffset=i;this.ut1MinusUtc=n}return e});define("ThirdParty/sprintf",[],function(){function e(){var e=/%%|%(\d+\$)?([-+\'#0 ]*)(\*\d+\$|\*|\d+)?(\.(\*\d+\$|\*|\d+))?([scboxXuideEfFgG])/g;var t=arguments,r=0,i=t[r++];var n=function(e,t,r,i){if(!r){r=" "}var n=e.length>=t?"":Array(1+t-e.length>>>0).join(r);return i?e+n:n+e};var a=function(e,t,r,i,a,o){var s=i-e.length;if(s>0){if(r||!a){e=n(e,i,o,r)}else{e=e.slice(0,t.length)+n("",s,"0",true)+e.slice(t.length)}}return e};var o=function(e,t,r,i,o,s,u){var l=e>>>0;r=r&&l&&{2:"0b",8:"0",16:"0x"}[t]||"";e=r+n(l.toString(t),s||0,"0",false);return a(e,r,i,o,u)};var s=function(e,t,r,i,n,o){if(i!=null){e=e.slice(0,i)}return a(e,"",t,r,n,o)};var u=function(e,i,u,l,c,d,f){var h;var p;var m;var v;var _;if(e=="%%"){return"%"}var g=false,y="",w=false,C=false,b=" ";var S=u.length;for(var E=0;u&&E<S;E++){switch(u.charAt(E)){case" ":y=" ";break;case"+":y="+";break;case"-":g=true;break;case"'":b=u.charAt(E+1);break;case"0":w=true;break;case"#":C=true;break}}if(!l){l=0}else if(l=="*"){l=+t[r++]}else if(l.charAt(0)=="*"){l=+t[l.slice(1,-1)]}else{l=+l}if(l<0){l=-l;g=true}if(!isFinite(l)){throw new Error("sprintf: (minimum-)width must be finite")}if(!d){d="fFeE".indexOf(f)>-1?6:f=="d"?0:undefined}else if(d=="*"){d=+t[r++]}else if(d.charAt(0)=="*"){d=+t[d.slice(1,-1)]}else{d=+d}_=i?t[i.slice(0,-1)]:t[r++];switch(f){case"s":return s(String(_),g,l,d,w,b);case"c":return s(String.fromCharCode(+_),g,l,d,w);case"b":return o(_,2,C,g,l,d,w);case"o":return o(_,8,C,g,l,d,w);case"x":return o(_,16,C,g,l,d,w);case"X":return o(_,16,C,g,l,d,w).toUpperCase();case"u":return o(_,10,C,g,l,d,w);case"i":case"d":h=+_||0;h=Math.round(h-h%1);p=h<0?"-":y;_=p+n(String(Math.abs(h)),d,"0",false);return a(_,p,g,l,w);case"e":case"E":case"f":case"F":case"g":case"G":h=+_;p=h<0?"-":y;m=["toExponential","toFixed","toPrecision"]["efg".indexOf(f.toLowerCase())];v=["toString","toUpperCase"]["eEfFgG".indexOf(f)%2];_=p+Math.abs(h)[m](d);return a(_,p,g,l,w)[v]();default:return e}};return i.replace(e,u)}return e});define("Core/GregorianDate",[],function(){"use strict";function e(e,t,r,i,n,a,o,s){this.year=e;this.month=t;this.day=r;this.hour=i;this.minute=n;this.second=a;this.millisecond=o;this.isLeapSecond=s}return e});define("Core/isLeapYear",["./DeveloperError"],function(e){"use strict";function t(t){if(t===null||isNaN(t)){throw new e("year is required and must be a number.")}return t%4===0&&t%100!==0||t%400===0}return t});define("Core/LeapSecond",[],function(){"use strict";function e(e,t){this.julianDate=e;this.offset=t}return e});define("Core/TimeConstants",["./freezeObject"],function(e){"use strict";var t={SECONDS_PER_MILLISECOND:.001,SECONDS_PER_MINUTE:60,MINUTES_PER_HOUR:60,HOURS_PER_DAY:24,SECONDS_PER_HOUR:3600,MINUTES_PER_DAY:1440,SECONDS_PER_DAY:86400,DAYS_PER_JULIAN_CENTURY:36525,PICOSECOND:1e-9,MODIFIED_JULIAN_DATE_DIFFERENCE:2400000.5};return e(t)});define("Core/TimeStandard",["./freezeObject"],function(e){"use strict";var t={UTC:0,TAI:1};return e(t)});define("Core/JulianDate",["../ThirdParty/sprintf","./binarySearch","./defaultValue","./defined","./DeveloperError","./GregorianDate","./isLeapYear","./LeapSecond","./TimeConstants","./TimeStandard"],function(e,t,r,i,n,a,o,s,u,l){"use strict";var c=new a;var d=[31,28,31,30,31,30,31,31,30,31,30,31];var f=29;function h(e,t){return D.compare(e.julianDate,t.julianDate)}var p=new s;function m(e){p.julianDate=e;var r=D.leapSeconds;var i=t(r,p,h);if(i<0){i=~i}if(i>=r.length){i=r.length-1}var n=r[i].offset;if(i>0){var a=D.secondsDifference(r[i].julianDate,e);if(a>n){i--;n=r[i].offset}}D.addSeconds(e,n,e)}function v(e,r){p.julianDate=e;var i=D.leapSeconds;var n=t(i,p,h);if(n<0){n=~n}if(n===0){return D.addSeconds(e,-i[0].offset,r)}if(n>=i.length){return D.addSeconds(e,-i[n-1].offset,r)}var a=D.secondsDifference(i[n].julianDate,e);if(a===0){return D.addSeconds(e,-i[n].offset,r)}if(a<=1){return undefined}return D.addSeconds(e,-i[--n].offset,r)}function _(e,t,r){var i=t/u.SECONDS_PER_DAY|0;e+=i;t-=u.SECONDS_PER_DAY*i;if(t<0){e--;t+=u.SECONDS_PER_DAY}r.dayNumber=e;r.secondsOfDay=t;return r}function g(e,t,r,i,n,a,o){var s=(t-14)/12|0;var l=e+4800+s;var c=(1461*l/4|0)+(367*(t-2-12*s)/12|0)-(3*((l+100)/100|0)/4|0)+r-32075;i=i-12;if(i<0){i+=24}var d=a+(i*u.SECONDS_PER_HOUR+n*u.SECONDS_PER_MINUTE+o*u.SECONDS_PER_MILLISECOND);if(d>=43200){c-=1}return[c,d]}var y=/^(\d{4})$/;var w=/^(\d{4})-(\d{2})$/;var C=/^(\d{4})-?(\d{3})$/;var b=/^(\d{4})-?W(\d{2})-?(\d{1})?$/;var S=/^(\d{4})-?(\d{2})-?(\d{2})$/;var E=/([Z+\-])?(\d{2})?:?(\d{2})?$/;var T=/^(\d{2})(\.\d+)?/.source+E.source;var x=/^(\d{2}):?(\d{2})(\.\d+)?/.source+E.source;var A=/^(\d{2}):?(\d{2}):?(\d{2})(\.\d+)?/.source+E.source;var P="Invalid ISO 8601 date.";function D(e,t,i){this.dayNumber=undefined;this.secondsOfDay=undefined;e=r(e,0);t=r(t,0);i=r(i,l.UTC);var n=e|0;t=t+(e-n)*u.SECONDS_PER_DAY;_(n,t,this);if(i===l.UTC){m(this)}}D.fromDate=function(e,t){if(!(e instanceof Date)||isNaN(e.getTime())){throw new n("date must be a valid JavaScript Date.")}var r=g(e.getUTCFullYear(),e.getUTCMonth()+1,e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds());if(!i(t)){return new D(r[0],r[1],l.UTC)}_(r[0],r[1],t);m(t);return t};D.fromIso8601=function(e,t){if(typeof e!=="string"){throw new n(P)}e=e.replace(",",".");var r=e.split("T");var a;var s=1;var u=1;var c=0;var h=0;var p=0;var v=0;var E=r[0];var M=r[1];var I;var O;if(!i(E)){throw new n(P)}var R;r=E.match(S);if(r!==null){R=E.split("-").length-1;if(R>0&&R!==2){throw new n(P)}a=+r[1];s=+r[2];u=+r[3]}else{r=E.match(w);if(r!==null){a=+r[1];s=+r[2]}else{r=E.match(y);if(r!==null){a=+r[1]}else{var N;r=E.match(C);if(r!==null){a=+r[1];N=+r[2];O=o(a);if(N<1||O&&N>366||!O&&N>365){throw new n(P)}}else{r=E.match(b);if(r!==null){a=+r[1];var L=+r[2];var B=+r[3]||0;R=E.split("-").length-1;if(R>0&&(!i(r[3])&&R!==1||i(r[3])&&R!==2)){throw new n(P)}var F=new Date(Date.UTC(a,0,4));N=L*7+B-F.getUTCDay()-3}else{throw new n(P)}}I=new Date(Date.UTC(a,0,1));I.setUTCDate(N);s=I.getUTCMonth()+1;u=I.getUTCDate()}}}O=o(a);if(s<1||s>12||u<1||(s!==2||!O)&&u>d[s-1]||O&&s===2&&u>f){throw new n(P)}var k;if(i(M)){r=M.match(A);if(r!==null){R=M.split(":").length-1;if(R>0&&R!==2&&R!==3){throw new n(P)}c=+r[1];h=+r[2];p=+r[3];v=+(r[4]||0)*1e3;k=5}else{r=M.match(x);if(r!==null){R=M.split(":").length-1;if(R>2){throw new n(P)}c=+r[1];h=+r[2];p=+(r[3]||0)*60;k=4}else{r=M.match(T);if(r!==null){c=+r[1];h=+(r[2]||0)*60;k=3}else{throw new n(P)}}}if(h>=60||p>=61||c>24||c===24&&(h>0||p>0||v>0)){throw new n(P)}var V=r[k];var z=+r[k+1];var U=+(r[k+2]||0);switch(V){case"+":c=c-z;h=h-U;break;case"-":c=c+z;h=h+U;break;case"Z":break;default:h=h+new Date(Date.UTC(a,s-1,u,c,h)).getTimezoneOffset();break}}else{h=h+new Date(a,s-1,u).getTimezoneOffset()}var q=p===60;if(q){p--}while(h>=60){h-=60;c++}while(c>=24){c-=24;u++}I=O&&s===2?f:d[s-1];while(u>I){u-=I;s++;if(s>12){s-=12;a++}I=O&&s===2?f:d[s-1]}while(h<0){h+=60;c--}while(c<0){c+=24;u--}while(u<1){s--;if(s<1){s+=12;a--}I=O&&s===2?f:d[s-1];u+=I}var G=g(a,s,u,c,h,p,v);if(!i(t)){t=new D(G[0],G[1],l.UTC)}else{_(G[0],G[1],t);m(t)}if(q){D.addSeconds(t,1,t)}return t};D.now=function(e){return D.fromDate(new Date,e)};var M=new D(0,0,l.TAI);D.toGregorianDate=function(e,t){if(!i(e)){throw new n("julianDate is required.")}var r=false;var o=v(e,M);if(!i(o)){D.addSeconds(e,-1,M);o=v(M,M);r=true}var s=o.dayNumber;var l=o.secondsOfDay;if(l>=43200){s+=1}var c=s+68569|0;var d=4*c/146097|0;c=c-((146097*d+3)/4|0)|0;var f=4e3*(c+1)/1461001|0;c=c-(1461*f/4|0)+31|0;var h=80*c/2447|0;var p=c-(2447*h/80|0)|0;c=h/11|0;var m=h+2-12*c|0;var _=100*(d-49)+f+c|0;var g=l/u.SECONDS_PER_HOUR|0;var y=l-g*u.SECONDS_PER_HOUR;var w=y/u.SECONDS_PER_MINUTE|0;y=y-w*u.SECONDS_PER_MINUTE;var C=y|0;var b=(y-C)/u.SECONDS_PER_MILLISECOND;g+=12;if(g>23){g-=24}if(r){C+=1}if(!i(t)){return new a(_,m,p,g,w,C,b,r)}t.year=_;t.month=m;t.day=p;t.hour=g;t.minute=w;t.second=C;t.millisecond=b;t.isLeapSecond=r;return t};D.toDate=function(e){if(!i(e)){throw new n("julianDate is required.")}var t=D.toGregorianDate(e,c);var r=t.second;if(t.isLeapSecond){r-=1}return new Date(Date.UTC(t.year,t.month-1,t.day,t.hour,t.minute,r,t.millisecond))};D.toIso8601=function(t,r){if(!i(t)){throw new n("julianDate is required.")}var a=D.toGregorianDate(t,a);var o;if(!i(r)&&a.millisecond!==0){o=(a.millisecond*.01).toString().replace(".","");return e("%04d-%02d-%02dT%02d:%02d:%02d.%sZ",a.year,a.month,a.day,a.hour,a.minute,a.second,o)}if(!i(r)||r===0){return e("%04d-%02d-%02dT%02d:%02d:%02dZ",a.year,a.month,a.day,a.hour,a.minute,a.second)}o=(a.millisecond*.01).toFixed(r).replace(".","").slice(0,r);return e("%04d-%02d-%02dT%02d:%02d:%02d.%sZ",a.year,a.month,a.day,a.hour,a.minute,a.second,o)};D.clone=function(e,t){if(!i(e)){return undefined}if(!i(t)){return new D(e.dayNumber,e.secondsOfDay,l.TAI)}t.dayNumber=e.dayNumber;t.secondsOfDay=e.secondsOfDay;return t};D.compare=function(e,t){if(!i(e)){throw new n("left is required.")}if(!i(t)){throw new n("right is required.")}var r=e.dayNumber-t.dayNumber;if(r!==0){return r}return e.secondsOfDay-t.secondsOfDay};D.equals=function(e,t){return e===t||i(e)&&i(t)&&e.dayNumber===t.dayNumber&&e.secondsOfDay===t.secondsOfDay};D.equalsEpsilon=function(e,t,r){if(!i(r)){throw new n("epsilon is required.")}return e===t||i(e)&&i(t)&&Math.abs(D.secondsDifference(e,t))<=r};D.totalDays=function(e){if(!i(e)){throw new n("julianDate is required.")}return e.dayNumber+e.secondsOfDay/u.SECONDS_PER_DAY};D.secondsDifference=function(e,t){if(!i(e)){throw new n("left is required.")}if(!i(t)){throw new n("right is required.")}var r=(e.dayNumber-t.dayNumber)*u.SECONDS_PER_DAY;return r+(e.secondsOfDay-t.secondsOfDay)};D.daysDifference=function(e,t){if(!i(e)){throw new n("left is required.")}if(!i(t)){throw new n("right is required.")}var r=e.dayNumber-t.dayNumber;var a=(e.secondsOfDay-t.secondsOfDay)/u.SECONDS_PER_DAY;return r+a};D.computeTaiMinusUtc=function(e){p.julianDate=e;var r=D.leapSeconds;var i=t(r,p,h);if(i<0){i=~i;--i;if(i<0){i=0}}return r[i].offset};D.addSeconds=function(e,t,r){if(!i(e)){throw new n("julianDate is required.")}if(!i(t)){throw new n("seconds is required.")}if(!i(r)){throw new n("result is required.")}return _(e.dayNumber,e.secondsOfDay+t,r)};D.addMinutes=function(e,t,r){if(!i(e)){throw new n("julianDate is required.")}if(!i(t)){throw new n("minutes is required.")}if(!i(r)){throw new n("result is required.")}var a=e.secondsOfDay+t*u.SECONDS_PER_MINUTE;return _(e.dayNumber,a,r)};D.addHours=function(e,t,r){if(!i(e)){throw new n("julianDate is required.")}if(!i(t)){throw new n("hours is required.")}if(!i(r)){throw new n("result is required.")}var a=e.secondsOfDay+t*u.SECONDS_PER_HOUR;return _(e.dayNumber,a,r)};D.addDays=function(e,t,r){if(!i(e)){throw new n("julianDate is required.")}if(!i(t)){throw new n("days is required.")}if(!i(r)){throw new n("result is required.")}var a=e.dayNumber+t;return _(a,e.secondsOfDay,r)};D.lessThan=function(e,t){return D.compare(e,t)<0};D.lessThanOrEquals=function(e,t){return D.compare(e,t)<=0};D.greaterThan=function(e,t){return D.compare(e,t)>0};D.greaterThanOrEquals=function(e,t){return D.compare(e,t)>=0};D.prototype.clone=function(e){return D.clone(this,e)};D.prototype.equals=function(e){return D.equals(this,e)};D.prototype.equalsEpsilon=function(e,t){return D.equalsEpsilon(this,e,t)};D.prototype.toString=function(){return D.toIso8601(this)};D.leapSeconds=[new s(new D(2441317,43210,l.TAI),10),new s(new D(2441499,43211,l.TAI),11),new s(new D(2441683,43212,l.TAI),12),new s(new D(2442048,43213,l.TAI),13),new s(new D(2442413,43214,l.TAI),14),new s(new D(2442778,43215,l.TAI),15),new s(new D(2443144,43216,l.TAI),16),new s(new D(2443509,43217,l.TAI),17),new s(new D(2443874,43218,l.TAI),18),new s(new D(2444239,43219,l.TAI),19),new s(new D(2444786,43220,l.TAI),20),new s(new D(2445151,43221,l.TAI),21),new s(new D(2445516,43222,l.TAI),22),new s(new D(2446247,43223,l.TAI),23),new s(new D(2447161,43224,l.TAI),24),new s(new D(2447892,43225,l.TAI),25),new s(new D(2448257,43226,l.TAI),26),new s(new D(2448804,43227,l.TAI),27),new s(new D(2449169,43228,l.TAI),28),new s(new D(2449534,43229,l.TAI),29),new s(new D(2450083,43230,l.TAI),30),new s(new D(2450630,43231,l.TAI),31),new s(new D(2451179,43232,l.TAI),32),new s(new D(2453736,43233,l.TAI),33),new s(new D(2454832,43234,l.TAI),34),new s(new D(2456109,43235,l.TAI),35),new s(new D(2457204,43236,l.TAI),36),new s(new D(2457754,43237,l.TAI),37)];return D});define("Core/clone",["./defaultValue"],function(e){"use strict";function t(r,i){if(r===null||typeof r!=="object"){return r}i=e(i,false);var n=new r.constructor;for(var a in r){if(r.hasOwnProperty(a)){var o=r[a];if(i){o=t(o,i)}n[a]=o}}return n}return t});define("Core/parseResponseHeaders",[],function(){"use strict";function e(e){var t={};if(!e){return t}
var r=e.split("\r\n");for(var i=0;i<r.length;++i){var n=r[i];var a=n.indexOf(": ");if(a>0){var o=n.substring(0,a);var s=n.substring(a+2);t[o]=s}}return t}return e});define("Core/RequestErrorEvent",["./defined","./parseResponseHeaders"],function(e,t){"use strict";function r(e,r,i){this.statusCode=e;this.response=r;this.responseHeaders=i;if(typeof this.responseHeaders==="string"){this.responseHeaders=t(this.responseHeaders)}}r.prototype.toString=function(){var t="Request has failed.";if(e(this.statusCode)){t+=" Status Code: "+this.statusCode}return t};return r});define("Core/TrustedServers",["../ThirdParty/Uri","./defined","./DeveloperError"],function(e,t,r){"use strict";var i={};var n={};i.add=function(e,i){if(!t(e)){throw new r("host is required.")}if(!t(i)||i<=0){throw new r("port is required to be greater than 0.")}var a=e.toLowerCase()+":"+i;if(!t(n[a])){n[a]=true}};i.remove=function(e,i){if(!t(e)){throw new r("host is required.")}if(!t(i)||i<=0){throw new r("port is required to be greater than 0.")}var a=e.toLowerCase()+":"+i;if(t(n[a])){delete n[a]}};function a(r){var i=new e(r);i.normalize();var n=i.getAuthority();if(!t(n)){return undefined}if(n.indexOf("@")!==-1){var a=n.split("@");n=a[1]}if(n.indexOf(":")===-1){var o=i.getScheme();if(!t(o)){o=window.location.protocol;o=o.substring(0,o.length-1)}if(o==="http"){n+=":80"}else if(o==="https"){n+=":443"}else{return undefined}}return n}i.contains=function(e){if(!t(e)){throw new r("url is required.")}var i=a(e);if(t(i)&&t(n[i])){return true}return false};i.clear=function(){n={}};return i});define("Core/loadWithXhr",["../ThirdParty/when","./defaultValue","./defined","./DeveloperError","./RequestErrorEvent","./RuntimeError","./TrustedServers"],function(e,t,r,i,n,a,o){"use strict";function s(n){n=t(n,t.EMPTY_OBJECT);if(!r(n.url)){throw new i("options.url is required.")}var a=n.responseType;var o=t(n.method,"GET");var u=n.data;var l=n.headers;var c=n.overrideMimeType;return e(n.url,function(t){var r=e.defer();s.load(t,a,o,u,l,r,c);return r.promise})}var u=/^data:(.*?)(;base64)?,(.*)$/;function l(e,t){var r=decodeURIComponent(t);if(e){return atob(r)}return r}function c(e,t){var r=l(e,t);var i=new ArrayBuffer(r.length);var n=new Uint8Array(i);for(var a=0;a<r.length;a++){n[a]=r.charCodeAt(a)}return i}function d(e,r){r=t(r,"");var n=e[1];var a=!!e[2];var o=e[3];switch(r){case"":case"text":return l(a,o);case"arraybuffer":return c(a,o);case"blob":var s=c(a,o);return new Blob([s],{type:n});case"document":var u=new DOMParser;return u.parseFromString(l(a,o),n);case"json":return JSON.parse(l(a,o));default:throw new i("Unhandled responseType: "+r)}}s.load=function(e,t,i,s,l,c,f){if(!/file:\/\/\//.test(e)&&/file:\/\//.test(e)){e=e.replace("file://","file:///")}var h=u.exec(e);if(h!==null){c.resolve(d(h,t));return}var p=new XMLHttpRequest;if(o.contains(e)){p.withCredentials=true}if(r(f)&&r(p.overrideMimeType)){p.overrideMimeType(f)}p.open(i,e,true);if(r(l)){for(var m in l){if(l.hasOwnProperty(m)){p.setRequestHeader(m,l[m])}}}if(r(t)){p.responseType=t}p.onload=function(){if(p.status!==0&&(p.status<200||p.status>=300)){c.reject(new n(p.status,p.response,p.getAllResponseHeaders()));return}var e=p.response;var i=p.responseType;if(r(e)&&(!r(t)||i===t)){c.resolve(e)}else if(t==="json"&&typeof e==="string"){try{c.resolve(JSON.parse(e))}catch(e){c.reject(e)}}else if((i===""||i==="document")&&r(p.responseXML)&&p.responseXML.hasChildNodes()){c.resolve(p.responseXML)}else if((i===""||i==="text")&&r(p.responseText)){c.resolve(p.responseText)}else{c.reject(new a("Invalid XMLHttpRequest response type."))}};p.onerror=function(e){c.reject(new n)};p.send(s)};s.defaultLoad=s.load;return s});define("Core/loadText",["./loadWithXhr"],function(e){"use strict";function t(t,r){return e({url:t,headers:r})}return t});define("Core/loadJson",["./clone","./defined","./DeveloperError","./loadText"],function(e,t,r,i){"use strict";var n={Accept:"application/json,*/*;q=0.01"};function a(a,o){if(!t(a)){throw new r("url is required.")}if(!t(o)){o=n}else if(!t(o.Accept)){o=e(o);o.Accept=n.Accept}return i(a,o).then(function(e){return JSON.parse(e)})}return a});define("Core/Queue",["./defineProperties"],function(e){"use strict";function t(){this._array=[];this._offset=0;this._length=0}e(t.prototype,{length:{get:function(){return this._length}}});t.prototype.enqueue=function(e){this._array.push(e);this._length++};t.prototype.dequeue=function(){if(this._length===0){return undefined}var e=this._array;var t=this._offset;var r=e[t];e[t]=undefined;t++;if(t>10&&t*2>e.length){this._array=e.slice(t);t=0}this._offset=t;this._length--;return r};t.prototype.peek=function(){if(this._length===0){return undefined}return this._array[this._offset]};t.prototype.contains=function(e){return this._array.indexOf(e)!==-1};t.prototype.clear=function(){this._array.length=this._offset=this._length=0};t.prototype.sort=function(e){if(this._offset>0){this._array=this._array.slice(this._offset);this._offset=0}this._array.sort(e)};return t});define("Core/Request",["./defaultValue"],function(e){"use strict";function t(t){t=e(t,e.EMPTY_OBJECT);this.url=t.url;this.parameters=t.parameters;this.requestFunction=t.requestFunction;this.type=t.type;this.defer=e(t.defer,false);this.distance=e(t.distance,0);this.startPromise=undefined;this.server=t.server}return t});define("Core/RequestType",["../Core/freezeObject"],function(e){"use strict";var t={TERRAIN:0,IMAGERY:1,TILES3D:2,OTHER:3};return e(t)});define("Core/RequestScheduler",["../ThirdParty/Uri","../ThirdParty/when","./defaultValue","./defined","./defineProperties","./DeveloperError","./Queue","./Request","./RequestType"],function(e,t,r,i,n,a,o,s,u){"use strict";function l(e){this.total=0;this.used=0;this.server=e.server;this.type=e.type}function c(e){this.activeRequests=0;this.serverName=e}c.prototype.hasAvailableRequests=function(){return _.hasAvailableRequests()&&this.activeRequests<_.maximumRequestsPerServer};c.prototype.getNumberOfAvailableRequests=function(){return _.maximumRequestsPerServer-this.activeRequests};var d={};var f=0;var h=[];var p=[];var m=new o;var v={numberOfRequestsThisFrame:0};function _(){}function g(e,t){return e.distance-t.distance}function y(e){var t;var r=h.length;for(var i=0;i<r;++i){t=h[i];if(t.server===e.server&&t.type===e.type){return t}}t=new l(e);h.push(t);return t}_.resetBudgets=function(){x();T();if(!_.prioritize||!_.throttle){return}var e=h.length;for(var t=0;t<e;++t){h[t].total=0;h[t].used=0}var r=p;r.sort(g);var i=_.getNumberOfAvailableRequests();var n=r.length;for(var a=0;a<n&&i>0;++a){var o=r[a];var s=y(o);var u=s.server.getNumberOfAvailableRequests();if(s.total<u){++s.total;--i}}r.length=0};var w=typeof document!=="undefined"?new e(document.location.href):new e;_.getServerName=function(t){if(!i(t)){throw new a("url is required.")}var r=new e(t).resolve(w);r.normalize();var n=r.authority;if(!/:/.test(n)){n=n+":"+(r.scheme==="https"?"443":"80")}return n};_.getRequestServer=function(e){var t=_.getServerName(e);var r=d[t];if(!i(r)){r=new c(t);d[t]=r}return r};_.getNumberOfAvailableRequestsByServer=function(e){return _.getRequestServer(e).getNumberOfAvailableRequests()};_.getNumberOfAvailableRequests=function(){return _.maximumRequests-f};_.hasAvailableRequestsByServer=function(e){return _.getRequestServer(e).hasAvailableRequests()};_.hasAvailableRequests=function(){return f<_.maximumRequests};function C(e){--f;--e.server.activeRequests;var t=m.dequeue();if(i(t)){t.startPromise.resolve(t)}}function b(e){++f;++e.server.activeRequests;return t(e.requestFunction(e.url,e.parameters),function(t){C(e);return t}).otherwise(function(r){C(e);return t.reject(r)})}function S(e){m.enqueue(e);var r=t.defer();e.startPromise=r;return r.promise.then(b)}function E(e){if(_.prioritize){p.push(e)}}_.schedule=function(e){if(!i(e)){throw new a("request is required.")}if(!i(e.url)){throw new a("request.url is required.")}if(!i(e.requestFunction)){throw new a("request.requestFunction is required.")}++v.numberOfRequestsThisFrame;if(!_.throttle){return e.requestFunction(e.url,e.parameters)}if(!i(e.server)){e.server=_.getRequestServer(e.url)}if(!e.server.hasAvailableRequests()){if(!e.defer){E(e);return undefined}else{return S(e)}}if(_.prioritize&&i(e.type)&&!e.defer){var t=y(e);if(t.used>=t.total){E(e);return undefined}++t.used}return b(e)};_.request=function(e,t,i,n){return _.schedule(new s({url:e,parameters:i,requestFunction:t,defer:true,type:r(n,u.OTHER)}))};function T(){v.numberOfRequestsThisFrame=0}function x(){if(!_.debugShowStatistics){return}if(v.numberOfRequestsThisFrame>0){console.log("Number of requests attempted: "+v.numberOfRequestsThisFrame)}var e=_.maximumRequests-_.getNumberOfAvailableRequests();if(e>0){console.log("Number of active requests: "+e)}}_.clearForSpecs=function(){d={};f=0;h=[];p=[];m=new o;v={numberOfRequestsThisFrame:0}};_.maximumRequestsPerServer=6;_.maximumRequests=10;_.prioritize=true;_.throttle=true;_.debugShowStatistics=false;return _});define("Core/EarthOrientationParameters",["../ThirdParty/when","./binarySearch","./defaultValue","./defined","./EarthOrientationParametersSample","./freezeObject","./JulianDate","./LeapSecond","./loadJson","./RequestScheduler","./RuntimeError","./TimeConstants","./TimeStandard"],function(e,t,r,i,n,a,o,s,u,l,c,d,f){"use strict";function h(t){t=r(t,r.EMPTY_OBJECT);this._dates=undefined;this._samples=undefined;this._dateColumn=-1;this._xPoleWanderRadiansColumn=-1;this._yPoleWanderRadiansColumn=-1;this._ut1MinusUtcSecondsColumn=-1;this._xCelestialPoleOffsetRadiansColumn=-1;this._yCelestialPoleOffsetRadiansColumn=-1;this._taiMinusUtcSecondsColumn=-1;this._columnCount=0;this._lastIndex=-1;this._downloadPromise=undefined;this._dataError=undefined;this._addNewLeapSeconds=r(t.addNewLeapSeconds,true);if(i(t.data)){m(this,t.data)}else if(i(t.url)){var n=this;this._downloadPromise=e(l.request(t.url,u),function(e){m(n,e)},function(){n._dataError="An error occurred while retrieving the EOP data from the URL "+t.url+"."})}else{m(this,{columnNames:["dateIso8601","modifiedJulianDateUtc","xPoleWanderRadians","yPoleWanderRadians","ut1MinusUtcSeconds","lengthOfDayCorrectionSeconds","xCelestialPoleOffsetRadians","yCelestialPoleOffsetRadians","taiMinusUtcSeconds"],samples:[]})}}h.NONE=a({getPromiseToLoad:function(){return e()},compute:function(e,t){if(!i(t)){t=new n(0,0,0,0,0)}else{t.xPoleWander=0;t.yPoleWander=0;t.xPoleOffset=0;t.yPoleOffset=0;t.ut1MinusUtc=0}return t}});h.prototype.getPromiseToLoad=function(){return e(this._downloadPromise)};h.prototype.compute=function(e,r){if(!i(this._samples)){if(i(this._dataError)){throw new c(this._dataError)}return undefined}if(!i(r)){r=new n(0,0,0,0,0)}if(this._samples.length===0){r.xPoleWander=0;r.yPoleWander=0;r.xPoleOffset=0;r.yPoleOffset=0;r.ut1MinusUtc=0;return r}var a=this._dates;var s=this._lastIndex;var u=0;var l=0;if(i(s)){var d=a[s];var f=a[s+1];var h=o.lessThanOrEquals(d,e);var p=!i(f);var m=p||o.greaterThanOrEquals(f,e);if(h&&m){u=s;if(!p&&f.equals(e)){++u}l=u+1;g(this,a,this._samples,e,u,l,r);return r}}var v=t(a,e,o.compare,this._dateColumn);if(v>=0){if(v<a.length-1&&a[v+1].equals(e)){++v}u=v;l=v}else{l=~v;u=l-1;if(u<0){u=0}}this._lastIndex=u;g(this,a,this._samples,e,u,l,r);return r};function p(e,t){return o.compare(e.julianDate,t)}function m(e,r){if(!i(r.columnNames)){e._dataError="Error in loaded EOP data: The columnNames property is required.";return}if(!i(r.samples)){e._dataError="Error in loaded EOP data: The samples property is required.";return}var n=r.columnNames.indexOf("modifiedJulianDateUtc");var a=r.columnNames.indexOf("xPoleWanderRadians");var u=r.columnNames.indexOf("yPoleWanderRadians");var l=r.columnNames.indexOf("ut1MinusUtcSeconds");var c=r.columnNames.indexOf("xCelestialPoleOffsetRadians");var h=r.columnNames.indexOf("yCelestialPoleOffsetRadians");var m=r.columnNames.indexOf("taiMinusUtcSeconds");if(n<0||a<0||u<0||l<0||c<0||h<0||m<0){e._dataError="Error in loaded EOP data: The columnNames property must include modifiedJulianDateUtc, xPoleWanderRadians, yPoleWanderRadians, ut1MinusUtcSeconds, xCelestialPoleOffsetRadians, yCelestialPoleOffsetRadians, and taiMinusUtcSeconds columns";return}var v=e._samples=r.samples;var _=e._dates=[];e._dateColumn=n;e._xPoleWanderRadiansColumn=a;e._yPoleWanderRadiansColumn=u;e._ut1MinusUtcSecondsColumn=l;e._xCelestialPoleOffsetRadiansColumn=c;e._yCelestialPoleOffsetRadiansColumn=h;e._taiMinusUtcSecondsColumn=m;e._columnCount=r.columnNames.length;e._lastIndex=undefined;var g;var y=e._addNewLeapSeconds;for(var w=0,C=v.length;w<C;w+=e._columnCount){var b=v[w+n];var S=v[w+m];var E=b+d.MODIFIED_JULIAN_DATE_DIFFERENCE;var T=new o(E,S,f.TAI);_.push(T);if(y){if(S!==g&&i(g)){var x=o.leapSeconds;var A=t(x,T,p);if(A<0){var P=new s(T,S);x.splice(~A,0,P)}}g=S}}}function v(e,t,r,i,n){var a=r*i;n.xPoleWander=t[a+e._xPoleWanderRadiansColumn];n.yPoleWander=t[a+e._yPoleWanderRadiansColumn];n.xPoleOffset=t[a+e._xCelestialPoleOffsetRadiansColumn];n.yPoleOffset=t[a+e._yCelestialPoleOffsetRadiansColumn];n.ut1MinusUtc=t[a+e._ut1MinusUtcSecondsColumn]}function _(e,t,r){return t+e*(r-t)}function g(e,t,r,i,n,a,s){var u=e._columnCount;if(a>t.length-1){s.xPoleWander=0;s.yPoleWander=0;s.xPoleOffset=0;s.yPoleOffset=0;s.ut1MinusUtc=0;return s}var l=t[n];var c=t[a];if(l.equals(c)||i.equals(l)){v(e,r,n,u,s);return s}else if(i.equals(c)){v(e,r,a,u,s);return s}var d=o.secondsDifference(i,l)/o.secondsDifference(c,l);var f=n*u;var h=a*u;var p=r[f+e._ut1MinusUtcSecondsColumn];var m=r[h+e._ut1MinusUtcSecondsColumn];var g=m-p;if(g>.5||g<-.5){var y=r[f+e._taiMinusUtcSecondsColumn];var w=r[h+e._taiMinusUtcSecondsColumn];if(y!==w){if(c.equals(i)){p=m}else{m-=w-y}}}s.xPoleWander=_(d,r[f+e._xPoleWanderRadiansColumn],r[h+e._xPoleWanderRadiansColumn]);s.yPoleWander=_(d,r[f+e._yPoleWanderRadiansColumn],r[h+e._yPoleWanderRadiansColumn]);s.xPoleOffset=_(d,r[f+e._xCelestialPoleOffsetRadiansColumn],r[h+e._xCelestialPoleOffsetRadiansColumn]);s.yPoleOffset=_(d,r[f+e._yCelestialPoleOffsetRadiansColumn],r[h+e._yCelestialPoleOffsetRadiansColumn]);s.ut1MinusUtc=_(d,p,m);return s}return h});define("Core/Iau2006XysSample",[],function(){"use strict";function e(e,t,r){this.x=e;this.y=t;this.s=r}return e});define("Core/Iau2006XysData",["../ThirdParty/when","./buildModuleUrl","./defaultValue","./defined","./Iau2006XysSample","./JulianDate","./loadJson","./RequestScheduler","./TimeStandard"],function(e,t,r,i,n,a,o,s,u){"use strict";function l(e){e=r(e,r.EMPTY_OBJECT);this._xysFileUrlTemplate=e.xysFileUrlTemplate;this._interpolationOrder=r(e.interpolationOrder,9);this._sampleZeroJulianEphemerisDate=r(e.sampleZeroJulianEphemerisDate,2442396.5);this._sampleZeroDateTT=new a(this._sampleZeroJulianEphemerisDate,0,u.TAI);this._stepSizeDays=r(e.stepSizeDays,1);this._samplesPerXysFile=r(e.samplesPerXysFile,1e3);this._totalSamples=r(e.totalSamples,27426);this._samples=new Array(this._totalSamples*3);this._chunkDownloadsInProgress=[];var t=this._interpolationOrder;var i=this._denominators=new Array(t+1);var n=this._xTable=new Array(t+1);var o=Math.pow(this._stepSizeDays,t);for(var s=0;s<=t;++s){i[s]=o;n[s]=s*this._stepSizeDays;for(var l=0;l<=t;++l){if(l!==s){i[s]*=s-l}}i[s]=1/i[s]}this._work=new Array(t+1);this._coef=new Array(t+1)}var c=new a(0,0,u.TAI);function d(e,t,r){var i=c;i.dayNumber=t;i.secondsOfDay=r;return a.daysDifference(i,e._sampleZeroDateTT)}l.prototype.preload=function(t,r,i,n){var a=d(this,t,r);var o=d(this,i,n);var s=a/this._stepSizeDays-this._interpolationOrder/2|0;if(s<0){s=0}var u=o/this._stepSizeDays-this._interpolationOrder/2|0+this._interpolationOrder;if(u>=this._totalSamples){u=this._totalSamples-1}var l=s/this._samplesPerXysFile|0;var c=u/this._samplesPerXysFile|0;var h=[];for(var p=l;p<=c;++p){h.push(f(this,p))}return e.all(h)};l.prototype.computeXysRadians=function(e,t,r){var a=d(this,e,t);if(a<0){return undefined}var o=a/this._stepSizeDays|0;if(o>=this._totalSamples){return undefined}var s=this._interpolationOrder;var u=o-(s/2|0);if(u<0){u=0}var l=u+s;if(l>=this._totalSamples){l=this._totalSamples-1;u=l-s;if(u<0){u=0}}var c=false;var h=this._samples;if(!i(h[u*3])){f(this,u/this._samplesPerXysFile|0);c=true}if(!i(h[l*3])){f(this,l/this._samplesPerXysFile|0);c=true}if(c){return undefined}if(!i(r)){r=new n(0,0,0)}else{r.x=0;r.y=0;r.s=0}var p=a-u*this._stepSizeDays;var m=this._work;var v=this._denominators;var _=this._coef;var g=this._xTable;var y,w;for(y=0;y<=s;++y){m[y]=p-g[y]}for(y=0;y<=s;++y){_[y]=1;for(w=0;w<=s;++w){if(w!==y){_[y]*=m[w]}}_[y]*=v[y];var C=(u+y)*3;r.x+=_[y]*h[C++];r.y+=_[y]*h[C++];r.s+=_[y]*h[C]}return r};function f(r,n){if(r._chunkDownloadsInProgress[n]){return r._chunkDownloadsInProgress[n]}var a=e.defer();r._chunkDownloadsInProgress[n]=a;var u;var l=r._xysFileUrlTemplate;if(i(l)){u=l.replace("{0}",n)}else{u=t("Assets/IAU2006_XYS/IAU2006_XYS_"+n+".json")}e(s.request(u,o),function(e){r._chunkDownloadsInProgress[n]=false;var t=r._samples;var i=e.samples;var o=n*r._samplesPerXysFile*3;for(var s=0,u=i.length;s<u;++s){t[o+s]=i[s]}a.resolve()});return a.promise}return l});define("Core/HeadingPitchRoll",["./defaultValue","./defined","./DeveloperError","./Math"],function(e,t,r,i){"use strict";function n(t,r,i){this.heading=e(t,0);this.pitch=e(r,0);this.roll=e(i,0)}n.fromQuaternion=function(e,i){if(!t(e)){throw new r("quaternion is required")}if(!t(i)){i=new n}var a=2*(e.w*e.y-e.z*e.x);var o=1-2*(e.x*e.x+e.y*e.y);var s=2*(e.w*e.x+e.y*e.z);var u=1-2*(e.y*e.y+e.z*e.z);var l=2*(e.w*e.z+e.x*e.y);i.heading=-Math.atan2(l,u);i.roll=Math.atan2(s,o);i.pitch=-Math.asin(a);return i};n.fromDegrees=function(e,a,o,s){if(!t(e)){throw new r("heading is required")}if(!t(a)){throw new r("pitch is required")}if(!t(o)){throw new r("roll is required")}if(!t(s)){s=new n}s.heading=e*i.RADIANS_PER_DEGREE;s.pitch=a*i.RADIANS_PER_DEGREE;s.roll=o*i.RADIANS_PER_DEGREE;return s};n.clone=function(e,r){if(!t(e)){return undefined}if(!t(r)){return new n(e.heading,e.pitch,e.roll)}r.heading=e.heading;r.pitch=e.pitch;r.roll=e.roll;return r};n.equals=function(e,r){return e===r||t(e)&&t(r)&&e.heading===r.heading&&e.pitch===r.pitch&&e.roll===r.roll};n.equalsEpsilon=function(e,r,n,a){return e===r||t(e)&&t(r)&&i.equalsEpsilon(e.heading,r.heading,n,a)&&i.equalsEpsilon(e.pitch,r.pitch,n,a)&&i.equalsEpsilon(e.roll,r.roll,n,a)};n.prototype.clone=function(e){return n.clone(this,e)};n.prototype.equals=function(e){return n.equals(this,e)};n.prototype.equalsEpsilon=function(e,t,r){return n.equalsEpsilon(this,e,t,r)};n.prototype.toString=function(){return"("+this.heading+", "+this.pitch+", "+this.roll+")"};return n});define("Core/Quaternion",["./Cartesian3","./Check","./defaultValue","./defined","./deprecationWarning","./FeatureDetection","./freezeObject","./HeadingPitchRoll","./Math","./Matrix3"],function(e,t,r,i,n,a,o,s,u,l){"use strict";function c(e,t,i,n){this.x=r(e,0);this.y=r(t,0);this.z=r(i,0);this.w=r(n,0)}var d=new e;c.fromAxisAngle=function(r,n,a){t.typeOf.object("axis",r);t.typeOf.number("angle",n);var o=n/2;var s=Math.sin(o);d=e.normalize(r,d);var u=d.x*s;var l=d.y*s;var f=d.z*s;var h=Math.cos(o);if(!i(a)){return new c(u,l,f,h)}a.x=u;a.y=l;a.z=f;a.w=h;return a};var f=[1,2,0];var h=new Array(3);c.fromRotationMatrix=function(e,r){t.typeOf.object("matrix",e);var n;var a;var o;var s;var u;var d=e[l.COLUMN0ROW0];var p=e[l.COLUMN1ROW1];var m=e[l.COLUMN2ROW2];var v=d+p+m;if(v>0){n=Math.sqrt(v+1);u=.5*n;n=.5/n;a=(e[l.COLUMN1ROW2]-e[l.COLUMN2ROW1])*n;o=(e[l.COLUMN2ROW0]-e[l.COLUMN0ROW2])*n;s=(e[l.COLUMN0ROW1]-e[l.COLUMN1ROW0])*n}else{var _=f;var g=0;if(p>d){g=1}if(m>d&&m>p){g=2}var y=_[g];var w=_[y];n=Math.sqrt(e[l.getElementIndex(g,g)]-e[l.getElementIndex(y,y)]-e[l.getElementIndex(w,w)]+1);var C=h;C[g]=.5*n;n=.5/n;u=(e[l.getElementIndex(w,y)]-e[l.getElementIndex(y,w)])*n;C[y]=(e[l.getElementIndex(y,g)]+e[l.getElementIndex(g,y)])*n;C[w]=(e[l.getElementIndex(w,g)]+e[l.getElementIndex(g,w)])*n;a=-C[0];o=-C[1];s=-C[2]}if(!i(r)){return new c(a,o,s,u)}r.x=a;r.y=o;r.z=s;r.w=u;return r};var p=new c;var m=new c;var v=new c;var _=new c;c.fromHeadingPitchRoll=function(r,i,a,o){if(r instanceof s){t.typeOf.object("headingPitchRoll",r)}else{t.typeOf.number("heading",r);t.typeOf.number("pitch",i);t.typeOf.number("roll",a)}var u;if(r instanceof s){u=r;o=i}else{n("Quaternion.fromHeadingPitchRoll(heading, pitch, roll,result)","The method was deprecated in Cesium 1.32 and will be removed in version 1.33. "+"Use Quaternion.fromHeadingPitchRoll(hpr,result) where hpr is a HeadingPitchRoll");u=new s(r,i,a)}_=c.fromAxisAngle(e.UNIT_X,u.roll,p);v=c.fromAxisAngle(e.UNIT_Y,-u.pitch,o);o=c.multiply(v,_,v);m=c.fromAxisAngle(e.UNIT_Z,-u.heading,p);return c.multiply(m,o,o)};var g=new e;var y=new e;var w=new c;var C=new c;var b=new c;c.packedLength=4;c.pack=function(e,i,n){t.typeOf.object("value",e);t.defined("array",i);n=r(n,0);i[n++]=e.x;i[n++]=e.y;i[n++]=e.z;i[n]=e.w;return i};c.unpack=function(e,n,a){t.defined("array",e);n=r(n,0);if(!i(a)){a=new c}a.x=e[n];a.y=e[n+1];a.z=e[n+2];a.w=e[n+3];return a};c.packedInterpolationLength=3;c.convertPackedArrayForInterpolation=function(e,t,r,i){c.unpack(e,r*4,b);c.conjugate(b,b);for(var n=0,a=r-t+1;n<a;n++){var o=n*3;c.unpack(e,(t+n)*4,w);c.multiply(w,b,w);if(w.w<0){c.negate(w,w)}c.computeAxis(w,g);var s=c.computeAngle(w);i[o]=g.x*s;i[o+1]=g.y*s;i[o+2]=g.z*s}};c.unpackInterpolationResult=function(t,r,n,a,o){if(!i(o)){o=new c}e.fromArray(t,0,y);var s=e.magnitude(y);c.unpack(r,a*4,C);if(s===0){c.clone(c.IDENTITY,w)}else{c.fromAxisAngle(y,s,w)}return c.multiply(w,C,o)};c.clone=function(e,t){if(!i(e)){return undefined}if(!i(t)){return new c(e.x,e.y,e.z,e.w)}t.x=e.x;t.y=e.y;t.z=e.z;t.w=e.w;return t};c.conjugate=function(e,r){t.typeOf.object("quaternion",e);t.typeOf.object("result",r);r.x=-e.x;r.y=-e.y;r.z=-e.z;r.w=e.w;return r};c.magnitudeSquared=function(e){t.typeOf.object("quaternion",e);return e.x*e.x+e.y*e.y+e.z*e.z+e.w*e.w};c.magnitude=function(e){return Math.sqrt(c.magnitudeSquared(e))};c.normalize=function(e,r){t.typeOf.object("result",r);var i=1/c.magnitude(e);var n=e.x*i;var a=e.y*i;var o=e.z*i;var s=e.w*i;r.x=n;r.y=a;r.z=o;r.w=s;return r};c.inverse=function(e,r){t.typeOf.object("result",r);var i=c.magnitudeSquared(e);r=c.conjugate(e,r);return c.multiplyByScalar(r,1/i,r)};c.add=function(e,r,i){t.typeOf.object("left",e);t.typeOf.object("right",r);t.typeOf.object("result",i);i.x=e.x+r.x;i.y=e.y+r.y;i.z=e.z+r.z;i.w=e.w+r.w;return i};c.subtract=function(e,r,i){t.typeOf.object("left",e);t.typeOf.object("right",r);t.typeOf.object("result",i);i.x=e.x-r.x;i.y=e.y-r.y;i.z=e.z-r.z;i.w=e.w-r.w;return i};c.negate=function(e,r){t.typeOf.object("quaternion",e);t.typeOf.object("result",r);r.x=-e.x;r.y=-e.y;r.z=-e.z;r.w=-e.w;return r};c.dot=function(e,r){t.typeOf.object("left",e);t.typeOf.object("right",r);return e.x*r.x+e.y*r.y+e.z*r.z+e.w*r.w};c.multiply=function(e,r,i){t.typeOf.object("left",e);t.typeOf.object("right",r);t.typeOf.object("result",i);var n=e.x;var a=e.y;var o=e.z;var s=e.w;var u=r.x;var l=r.y;var c=r.z;var d=r.w;var f=s*u+n*d+a*c-o*l;var h=s*l-n*c+a*d+o*u;var p=s*c+n*l-a*u+o*d;var m=s*d-n*u-a*l-o*c;i.x=f;i.y=h;i.z=p;i.w=m;return i};c.multiplyByScalar=function(e,r,i){t.typeOf.object("quaternion",e);t.typeOf.number("scalar",r);t.typeOf.object("result",i);i.x=e.x*r;i.y=e.y*r;i.z=e.z*r;i.w=e.w*r;return i};c.divideByScalar=function(e,r,i){t.typeOf.object("quaternion",e);t.typeOf.number("scalar",r);t.typeOf.object("result",i);i.x=e.x/r;i.y=e.y/r;i.z=e.z/r;i.w=e.w/r;return i};c.computeAxis=function(e,r){t.typeOf.object("quaternion",e);t.typeOf.object("result",r);var i=e.w;if(Math.abs(i-1)<u.EPSILON6){r.x=r.y=r.z=0;return r}var n=1/Math.sqrt(1-i*i);r.x=e.x*n;r.y=e.y*n;r.z=e.z*n;return r};c.computeAngle=function(e){t.typeOf.object("quaternion",e);if(Math.abs(e.w-1)<u.EPSILON6){return 0}return 2*Math.acos(e.w)};var S=new c;c.lerp=function(e,r,i,n){t.typeOf.object("start",e);t.typeOf.object("end",r);t.typeOf.number("t",i);t.typeOf.object("result",n);S=c.multiplyByScalar(r,i,S);n=c.multiplyByScalar(e,1-i,n);return c.add(S,n,n)};var E=new c;var T=new c;var x=new c;c.slerp=function(e,r,i,n){t.typeOf.object("start",e);t.typeOf.object("end",r);t.typeOf.number("t",i);t.typeOf.object("result",n);var a=c.dot(e,r);var o=r;if(a<0){a=-a;o=E=c.negate(r,E)}if(1-a<u.EPSILON6){return c.lerp(e,o,i,n)}var s=Math.acos(a);T=c.multiplyByScalar(e,Math.sin((1-i)*s),T);x=c.multiplyByScalar(o,Math.sin(i*s),x);n=c.add(T,x,n);return c.multiplyByScalar(n,1/Math.sin(s),n)};c.log=function(r,i){t.typeOf.object("quaternion",r);t.typeOf.object("result",i);var n=u.acosClamped(r.w);var a=0;if(n!==0){a=n/Math.sin(n)}return e.multiplyByScalar(r,a,i)};c.exp=function(r,i){t.typeOf.object("cartesian",r);t.typeOf.object("result",i);var n=e.magnitude(r);var a=0;if(n!==0){a=Math.sin(n)/n}i.x=r.x*a;i.y=r.y*a;i.z=r.z*a;i.w=Math.cos(n);return i};var A=new e;var P=new e;var D=new c;var M=new c;c.computeInnerQuadrangle=function(r,i,n,a){t.typeOf.object("q0",r);t.typeOf.object("q1",i);t.typeOf.object("q2",n);t.typeOf.object("result",a);var o=c.conjugate(i,D);c.multiply(o,n,M);var s=c.log(M,A);c.multiply(o,r,M);var u=c.log(M,P);e.add(s,u,s);e.multiplyByScalar(s,.25,s);e.negate(s,s);c.exp(s,D);return c.multiply(i,D,a)};c.squad=function(e,r,i,n,a,o){t.typeOf.object("q0",e);t.typeOf.object("q1",r);t.typeOf.object("s0",i);t.typeOf.object("s1",n);t.typeOf.number("t",a);t.typeOf.object("result",o);var s=c.slerp(e,r,a,D);var u=c.slerp(i,n,a,M);return c.slerp(s,u,2*a*(1-a),o)};var I=new c;var O=1.9011074535173003;var R=a.supportsTypedArrays()?new Float32Array(8):[];var N=a.supportsTypedArrays()?new Float32Array(8):[];var L=a.supportsTypedArrays()?new Float32Array(8):[];var B=a.supportsTypedArrays()?new Float32Array(8):[];for(var F=0;F<7;++F){var k=F+1;var V=2*k+1;R[F]=1/(k*V);N[F]=k/V}R[7]=O/(8*17);N[7]=O*8/17;c.fastSlerp=function(e,r,i,n){t.typeOf.object("start",e);t.typeOf.object("end",r);t.typeOf.number("t",i);t.typeOf.object("result",n);var a=c.dot(e,r);var o;if(a>=0){o=1}else{o=-1;a=-a}var s=a-1;var u=1-i;var l=i*i;var d=u*u;for(var f=7;f>=0;--f){L[f]=(R[f]*l-N[f])*s;B[f]=(R[f]*d-N[f])*s}var h=o*i*(1+L[0]*(1+L[1]*(1+L[2]*(1+L[3]*(1+L[4]*(1+L[5]*(1+L[6]*(1+L[7]))))))));var p=u*(1+B[0]*(1+B[1]*(1+B[2]*(1+B[3]*(1+B[4]*(1+B[5]*(1+B[6]*(1+B[7]))))))));var m=c.multiplyByScalar(e,p,I);c.multiplyByScalar(r,h,n);return c.add(m,n,n)};c.fastSquad=function(e,r,i,n,a,o){t.typeOf.object("q0",e);t.typeOf.object("q1",r);t.typeOf.object("s0",i);t.typeOf.object("s1",n);t.typeOf.number("t",a);t.typeOf.object("result",o);var s=c.fastSlerp(e,r,a,D);var u=c.fastSlerp(i,n,a,M);return c.fastSlerp(s,u,2*a*(1-a),o)};c.equals=function(e,t){return e===t||i(e)&&i(t)&&e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w};c.equalsEpsilon=function(e,r,n){t.typeOf.number("epsilon",n);return e===r||i(e)&&i(r)&&Math.abs(e.x-r.x)<=n&&Math.abs(e.y-r.y)<=n&&Math.abs(e.z-r.z)<=n&&Math.abs(e.w-r.w)<=n};c.ZERO=o(new c(0,0,0,0));c.IDENTITY=o(new c(0,0,0,1));c.prototype.clone=function(e){return c.clone(this,e)};c.prototype.equals=function(e){return c.equals(this,e)};c.prototype.equalsEpsilon=function(e,t){return c.equalsEpsilon(this,e,t)};c.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+", "+this.w+")"};return c});define("Core/Transforms",["../ThirdParty/when","./Cartesian2","./Cartesian3","./Cartesian4","./Cartographic","./Check","./defaultValue","./defined","./deprecationWarning","./DeveloperError","./EarthOrientationParameters","./EarthOrientationParametersSample","./Ellipsoid","./Iau2006XysData","./Iau2006XysSample","./JulianDate","./Math","./Matrix3","./Matrix4","./Quaternion","./TimeConstants"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w){"use strict";var C={};var b={up:{south:"east",north:"west",west:"south",east:"north"},down:{south:"west",north:"east",west:"north",east:"south"},south:{up:"west",down:"east",west:"down",east:"up"},north:{up:"east",down:"west",west:"up",east:"down"},west:{up:"north",down:"south",north:"down",south:"up"},east:{up:"south",down:"north",north:"up",south:"down"}};var S={north:[-1,0,0],east:[0,1,0],up:[0,0,1],south:[1,0,0],west:[0,-1,0],down:[0,0,-1]};var E={};var T={east:new r,north:new r,up:new r,west:new r,south:new r,down:new r};var x=new r;var A=new r;var P=new r;C.localFrameToFixedFrameGenerator=function(e,t){if(!b.hasOwnProperty(e)||!b[e].hasOwnProperty(t)){throw new l("firstAxis and secondAxis must be east, north, up, west, south or down.")}var i=b[e][t];var n;var a=e+t;if(s(E[a])){n=E[a]}else{n=function(n,a,u){if(!s(n)){throw new l("origin is required.")}if(!s(u)){u=new g}if(v.equalsEpsilon(n.x,0,v.EPSILON14)&&v.equalsEpsilon(n.y,0,v.EPSILON14)){var c=v.sign(n.z);r.unpack(S[e],0,x);if(e!=="east"&&e!=="west"){r.multiplyByScalar(x,c,x)}r.unpack(S[t],0,A);if(t!=="east"&&t!=="west"){r.multiplyByScalar(A,c,A)}r.unpack(S[i],0,P);if(i!=="east"&&i!=="west"){r.multiplyByScalar(P,c,P)}}else{a=o(a,f.WGS84);a.geodeticSurfaceNormal(n,T.up);var d=T.up;var h=T.east;h.x=-n.y;h.y=n.x;h.z=0;r.normalize(h,T.east);r.cross(d,h,T.north);r.multiplyByScalar(T.up,-1,T.down);r.multiplyByScalar(T.east,-1,T.west);r.multiplyByScalar(T.north,-1,T.south);x=T[e];A=T[t];P=T[i]}u[0]=x.x;u[1]=x.y;u[2]=x.z;u[3]=0;u[4]=A.x;u[5]=A.y;u[6]=A.z;u[7]=0;u[8]=P.x;u[9]=P.y;u[10]=P.z;u[11]=0;u[12]=n.x;u[13]=n.y;u[14]=n.z;u[15]=1;return u};E[a]=n}return n};C.eastNorthUpToFixedFrame=C.localFrameToFixedFrameGenerator("east","north");C.northEastDownToFixedFrame=C.localFrameToFixedFrameGenerator("north","east");C.northUpEastToFixedFrame=C.localFrameToFixedFrameGenerator("north","up");C.northWestUpToFixedFrame=C.localFrameToFixedFrameGenerator("north","west");var D=new y;var M=new r(1,1,1);var I=new g;C.headingPitchRollToFixedFrame=function(e,t,i,n,s){a.typeOf.object("HeadingPitchRoll",t);if(n instanceof g){s=n;n=undefined;u("Transforms.headingPitchRollToFixedFrame(origin, headingPitchRoll, ellipsoid, result)","The method was deprecated in Cesium 1.31 and will be removed in version 1.33. Transforms.headingPitchRollToFixedFrame(origin, headingPitchRoll, ellipsoid, fixedFrameTransform, result) where fixedFrameTransform is a a 4x4 transformation matrix (see Transforms.localFrameToFixedFrameGenerator)")}n=o(n,C.eastNorthUpToFixedFrame);var l=y.fromHeadingPitchRoll(t,D);var c=g.fromTranslationQuaternionRotationScale(r.ZERO,l,M,I);s=n(e,i,s);return g.multiply(s,c,s)};var O=new g;var R=new _;C.headingPitchRollQuaternion=function(e,t,r,i,n){a.typeOf.object("HeadingPitchRoll",t);if(i instanceof y){n=i;i=undefined;u("Transforms.headingPitchRollQuaternion(origin, headingPitchRoll, ellipsoid, result)","The method was deprecated in Cesium 1.31 and will be removed in version 1.33. Transforms.headingPitchRollQuaternion(origin, headingPitchRoll, ellipsoid, fixedFrameTransform, result) where fixedFrameTransform is a a 4x4 transformation matrix (see Transforms.localFrameToFixedFrameGenerator)")}var o=C.headingPitchRollToFixedFrame(e,t,r,i,O);var s=g.getRotation(o,R);return y.fromRotationMatrix(s,n)};var N=6*3600+41*60+50.54841;var L=8640184.812866;var B=.093104;var F=-62e-7;var k=1.1772758384668e-19;var V=72921158553e-15;var z=v.TWO_PI/86400;var U=new m;C.computeTemeToPseudoFixedMatrix=function(e,t){if(!s(e)){throw new l("date is required.")}U=m.addSeconds(e,-m.computeTaiMinusUtc(e),U);var r=U.dayNumber;var i=U.secondsOfDay;var n;var a=r-2451545;if(i>=43200){n=(a+.5)/w.DAYS_PER_JULIAN_CENTURY}else{n=(a-.5)/w.DAYS_PER_JULIAN_CENTURY}var o=N+n*(L+n*(B+n*F));var u=o*z%v.TWO_PI;var c=V+k*(r-2451545.5);var d=(i+w.SECONDS_PER_DAY*.5)%w.SECONDS_PER_DAY;var f=u+c*d;var h=Math.cos(f);var p=Math.sin(f);if(!s(t)){return new _(h,p,0,-p,h,0,0,0,1)}t[0]=h;t[1]=-p;t[2]=0;t[3]=p;t[4]=h;t[5]=0;t[6]=0;t[7]=0;t[8]=1;return t};C.iau2006XysData=new h;C.earthOrientationParameters=c.NONE;var q=32.184;var G=2451545;C.preloadIcrfFixed=function(t){var r=t.start.dayNumber;var i=t.start.secondsOfDay+q;var n=t.stop.dayNumber;var a=t.stop.secondsOfDay+q;var o=C.iau2006XysData.preload(r,i,n,a);var s=C.earthOrientationParameters.getPromiseToLoad();return e.all([o,s])};C.computeIcrfToFixedMatrix=function(e,t){
if(!s(e)){throw new l("date is required.")}if(!s(t)){t=new _}var r=C.computeFixedToIcrfMatrix(e,t);if(!s(r)){return undefined}return _.transpose(r,t)};var H=new p(0,0,0);var W=new d(0,0,0,0,0,0);var j=new _;var Y=new _;C.computeFixedToIcrfMatrix=function(e,t){if(!s(e)){throw new l("date is required.")}if(!s(t)){t=new _}var r=C.earthOrientationParameters.compute(e,W);if(!s(r)){return undefined}var i=e.dayNumber;var n=e.secondsOfDay+q;var a=C.iau2006XysData.computeXysRadians(i,n,H);if(!s(a)){return undefined}var o=a.x+r.xPoleOffset;var u=a.y+r.yPoleOffset;var c=1/(1+Math.sqrt(1-o*o-u*u));var d=j;d[0]=1-c*o*o;d[3]=-c*o*u;d[6]=o;d[1]=-c*o*u;d[4]=1-c*u*u;d[7]=u;d[2]=-o;d[5]=-u;d[8]=1-c*(o*o+u*u);var f=_.fromRotationZ(-a.s,Y);var h=_.multiply(d,f,j);var p=e.dayNumber;var g=e.secondsOfDay-m.computeTaiMinusUtc(e)+r.ut1MinusUtc;var y=p-2451545;var b=g/w.SECONDS_PER_DAY;var S=.779057273264+b+.00273781191135448*(y+b);S=S%1*v.TWO_PI;var E=_.fromRotationZ(S,Y);var T=_.multiply(h,E,j);var x=Math.cos(r.xPoleWander);var A=Math.cos(r.yPoleWander);var P=Math.sin(r.xPoleWander);var D=Math.sin(r.yPoleWander);var M=i-G+n/w.SECONDS_PER_DAY;M/=36525;var I=-47e-6*M*v.RADIANS_PER_DEGREE/3600;var O=Math.cos(I);var R=Math.sin(I);var N=Y;N[0]=x*O;N[1]=x*R;N[2]=P;N[3]=-A*R+D*P*O;N[4]=A*O+D*P*R;N[5]=-D*x;N[6]=-D*R-A*P*O;N[7]=D*O-A*P*R;N[8]=A*x;return _.multiply(T,N,t)};var X=new i;C.pointToWindowCoordinates=function(e,t,r,i){i=C.pointToGLWindowCoordinates(e,t,r,i);i.y=2*t[5]-i.y;return i};C.pointToGLWindowCoordinates=function(e,r,n,a){if(!s(e)){throw new l("modelViewProjectionMatrix is required.")}if(!s(r)){throw new l("viewportTransformation is required.")}if(!s(n)){throw new l("point is required.")}if(!s(a)){a=new t}var o=X;g.multiplyByVector(e,i.fromElements(n.x,n.y,n.z,1,o),o);i.multiplyByScalar(o,1/o.w,o);g.multiplyByVector(r,o,o);return t.fromCartesian4(o,a)};var Z=new r;var K=new r;var Q=new r;C.rotationMatrixFromPositionVelocity=function(e,t,i,n){if(!s(e)){throw new l("position is required.")}if(!s(t)){throw new l("velocity is required.")}var a=o(i,f.WGS84).geodeticSurfaceNormal(e,Z);var u=r.cross(t,a,K);if(r.equalsEpsilon(u,r.ZERO,v.EPSILON6)){u=r.clone(r.UNIT_X,u)}var c=r.cross(u,t,Q);r.cross(t,c,u);r.negate(u,u);if(!s(n)){n=new _}n[0]=t.x;n[1]=t.y;n[2]=t.z;n[3]=u.x;n[4]=u.y;n[5]=u.z;n[6]=c.x;n[7]=c.y;n[8]=c.z;return n};var J=new g(0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,1);var $=new n;var ee=new r;var te=new r;var re=new _;var ie=new g;var ne=new g;C.basisTo2D=function(e,t,i){if(!s(e)){throw new l("projection is required.")}if(!s(t)){throw new l("matrix is required.")}if(!s(i)){throw new l("result is required.")}var n=g.getTranslation(t,te);var a=e.ellipsoid;var o=a.cartesianToCartographic(n,$);var u=e.project(o,ee);r.fromElements(u.z,u.x,u.y,u);var c=C.eastNorthUpToFixedFrame(n,a,ie);var d=g.inverseTransformation(c,ne);var f=g.getRotation(t,re);var h=g.multiplyByMatrix3(d,f,i);g.multiply(J,h,i);g.setTranslation(i,u,i);return i};C.wgs84To2DModelMatrix=function(e,t,i){if(!s(e)){throw new l("projection is required.")}if(!s(t)){throw new l("center is required.")}if(!s(i)){throw new l("result is required.")}var n=e.ellipsoid;var a=C.eastNorthUpToFixedFrame(t,n,ie);var o=g.inverseTransformation(a,ne);var u=n.cartesianToCartographic(t,$);var c=e.project(u,ee);r.fromElements(c.z,c.x,c.y,c);var d=g.fromTranslation(c,ie);g.multiply(J,o,i);g.multiply(d,i,i);return i};return C});define("Core/EllipsoidTangentPlane",["./AxisAlignedBoundingBox","./Cartesian2","./Cartesian3","./Cartesian4","./defaultValue","./defined","./defineProperties","./DeveloperError","./Ellipsoid","./IntersectionTests","./Matrix4","./Plane","./Ray","./Transforms"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h){"use strict";var p=new i;function m(e,t){if(!a(e)){throw new s("origin is required.")}t=n(t,u.WGS84);e=t.scaleToGeodeticSurface(e);if(!a(e)){throw new s("origin must not be at the center of the ellipsoid.")}var i=h.eastNorthUpToFixedFrame(e,t);this._ellipsoid=t;this._origin=e;this._xAxis=r.fromCartesian4(c.getColumn(i,0,p));this._yAxis=r.fromCartesian4(c.getColumn(i,1,p));var o=r.fromCartesian4(c.getColumn(i,2,p));this._plane=d.fromPointNormal(e,o)}o(m.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},origin:{get:function(){return this._origin}},plane:{get:function(){return this._plane}},xAxis:{get:function(){return this._xAxis}},yAxis:{get:function(){return this._yAxis}},zAxis:{get:function(){return this._plane.normal}}});var v=new e;m.fromPoints=function(t,r){if(!a(t)){throw new s("cartesians is required.")}var i=e.fromPoints(t,v);return new m(i.center,r)};var _=new f;var g=new r;m.prototype.projectPointOntoPlane=function(e,i){if(!a(e)){throw new s("cartesian is required.")}var n=_;n.origin=e;r.normalize(e,n.direction);var o=l.rayPlane(n,this._plane,g);if(!a(o)){r.negate(n.direction,n.direction);o=l.rayPlane(n,this._plane,g)}if(a(o)){var u=r.subtract(o,this._origin,o);var c=r.dot(this._xAxis,u);var d=r.dot(this._yAxis,u);if(!a(i)){return new t(c,d)}i.x=c;i.y=d;return i}return undefined};m.prototype.projectPointsOntoPlane=function(e,t){if(!a(e)){throw new s("cartesians is required.")}if(!a(t)){t=[]}var r=0;var i=e.length;for(var n=0;n<i;n++){var o=this.projectPointOntoPlane(e[n],t[r]);if(a(o)){t[r]=o;r++}}t.length=r;return t};m.prototype.projectPointToNearestOnPlane=function(e,i){if(!a(e)){throw new s("cartesian is required.")}if(!a(i)){i=new t}var n=_;n.origin=e;r.clone(this._plane.normal,n.direction);var o=l.rayPlane(n,this._plane,g);if(!a(o)){r.negate(n.direction,n.direction);o=l.rayPlane(n,this._plane,g)}var u=r.subtract(o,this._origin,o);var c=r.dot(this._xAxis,u);var d=r.dot(this._yAxis,u);i.x=c;i.y=d;return i};m.prototype.projectPointsToNearestOnPlane=function(e,t){if(!a(e)){throw new s("cartesians is required.")}if(!a(t)){t=[]}var r=e.length;t.length=r;for(var i=0;i<r;i++){t[i]=this.projectPointToNearestOnPlane(e[i],t[i])}return t};var y=new r;m.prototype.projectPointsOntoEllipsoid=function(e,t){if(!a(e)){throw new s("cartesians is required.")}var i=e.length;if(!a(t)){t=new Array(i)}else{t.length=i}var n=this._ellipsoid;var o=this._origin;var u=this._xAxis;var l=this._yAxis;var c=y;for(var d=0;d<i;++d){var f=e[d];r.multiplyByScalar(u,f.x,c);if(!a(t[d])){t[d]=new r}var h=r.add(o,c,t[d]);r.multiplyByScalar(l,f.y,c);r.add(h,c,h);n.scaleToGeocentricSurface(h,h)}return t};return m});define("Core/OrientedBoundingBox",["./BoundingSphere","./Cartesian2","./Cartesian3","./Cartographic","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./EllipsoidTangentPlane","./Intersect","./Interval","./Math","./Matrix3","./Plane","./Rectangle"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p){"use strict";function m(e,t){this.center=r.clone(n(e,r.ZERO));this.halfAxes=f.clone(n(t,f.ZERO))}var v=new r;var _=new r;var g=new r;var y=new r;var w=new r;var C=new r;var b=new f;var S={unitary:new f,diagonal:new f};m.fromPoints=function(e,t){if(!a(t)){t=new m}if(!a(e)||e.length===0){t.halfAxes=f.ZERO;t.center=r.ZERO;return t}var i;var n=e.length;var o=r.clone(e[0],v);for(i=1;i<n;i++){r.add(o,e[i],o)}var s=1/n;r.multiplyByScalar(o,s,o);var u=0;var l=0;var c=0;var d=0;var h=0;var p=0;var E;for(i=0;i<n;i++){E=r.subtract(e[i],o,_);u+=E.x*E.x;l+=E.x*E.y;c+=E.x*E.z;d+=E.y*E.y;h+=E.y*E.z;p+=E.z*E.z}u*=s;l*=s;c*=s;d*=s;h*=s;p*=s;var T=b;T[0]=u;T[1]=l;T[2]=c;T[3]=l;T[4]=d;T[5]=h;T[6]=c;T[7]=h;T[8]=p;var x=f.computeEigenDecomposition(T,S);var A=f.clone(x.unitary,t.halfAxes);var P=f.getColumn(A,0,y);var D=f.getColumn(A,1,w);var M=f.getColumn(A,2,C);var I=-Number.MAX_VALUE;var O=-Number.MAX_VALUE;var R=-Number.MAX_VALUE;var N=Number.MAX_VALUE;var L=Number.MAX_VALUE;var B=Number.MAX_VALUE;for(i=0;i<n;i++){E=e[i];I=Math.max(r.dot(P,E),I);O=Math.max(r.dot(D,E),O);R=Math.max(r.dot(M,E),R);N=Math.min(r.dot(P,E),N);L=Math.min(r.dot(D,E),L);B=Math.min(r.dot(M,E),B)}P=r.multiplyByScalar(P,.5*(N+I),P);D=r.multiplyByScalar(D,.5*(L+O),D);M=r.multiplyByScalar(M,.5*(B+R),M);var F=r.add(P,D,t.center);F=r.add(F,M,F);var k=g;k.x=I-N;k.y=O-L;k.z=R-B;r.multiplyByScalar(k,.5,k);f.multiplyByScale(t.halfAxes,k,t.halfAxes);return t};var E=new r;var T=new r;function x(e,t,i,n,s,u,l,c){if(!a(t)||!a(i)||!a(n)||!a(s)||!a(u)||!a(l)){throw new o("all extents (minimum/maximum X/Y/Z) are required.")}if(!a(c)){c=new m}var d=c.halfAxes;f.setColumn(d,0,e.xAxis,d);f.setColumn(d,1,e.yAxis,d);f.setColumn(d,2,e.zAxis,d);var h=E;h.x=(t+i)/2;h.y=(n+s)/2;h.z=(u+l)/2;var p=T;p.x=(i-t)/2;p.y=(s-n)/2;p.z=(l-u)/2;var v=c.center;h=f.multiplyByVector(d,h,h);r.add(e.origin,h,v);f.multiplyByScale(d,p,d);return c}var A=new i;var P=new r;var D=[new i,new i,new i,new i,new i,new i,new i,new i];var M=[new r,new r,new r,new r,new r,new r,new r,new r];var I=[new t,new t,new t,new t,new t,new t,new t,new t];m.fromRectangle=function(e,t,r,i,l){if(!a(e)){throw new o("rectangle is required")}if(e.width<0||e.width>d.PI){throw new o("Rectangle width must be between 0 and pi")}if(e.height<0||e.height>d.PI){throw new o("Rectangle height must be between 0 and pi")}if(a(i)&&!d.equalsEpsilon(i.radii.x,i.radii.y,d.EPSILON15)){throw new o("Ellipsoid must be an ellipsoid of revolution (radii.x == radii.y)")}t=n(t,0);r=n(r,0);i=n(i,s.WGS84);var c=p.center(e,A);var f=i.cartographicToCartesian(c,P);var m=new u(f,i);var v=m.plane;var _=D[0];var g=D[1];var y=D[2];var w=D[3];var C=D[4];var b=D[5];var S=D[6];var E=D[7];var T=c.longitude;var O=e.south<0&&e.north>0?0:c.latitude;S.latitude=b.latitude=C.latitude=e.south;E.latitude=w.latitude=O;_.latitude=g.latitude=y.latitude=e.north;S.longitude=E.longitude=_.longitude=e.west;b.longitude=g.longitude=T;C.longitude=w.longitude=y.longitude=e.east;y.height=g.height=_.height=E.height=S.height=b.height=C.height=w.height=r;i.cartographicArrayToCartesianArray(D,M);m.projectPointsToNearestOnPlane(M,I);var R=Math.min(I[6].x,I[7].x,I[0].x);var N=Math.max(I[2].x,I[3].x,I[4].x);var L=Math.min(I[4].y,I[5].y,I[6].y);var B=Math.max(I[0].y,I[1].y,I[2].y);y.height=_.height=C.height=S.height=t;i.cartographicArrayToCartesianArray(D,M);var F=Math.min(h.getPointDistance(v,M[0]),h.getPointDistance(v,M[2]),h.getPointDistance(v,M[4]),h.getPointDistance(v,M[6]));var k=r;return x(m,R,N,L,B,F,k,l)};m.clone=function(e,t){if(!a(e)){return undefined}if(!a(t)){return new m(e.center,e.halfAxes)}r.clone(e.center,t.center);f.clone(e.halfAxes,t.halfAxes);return t};m.intersectPlane=function(e,t){if(!a(e)){throw new o("box is required.")}if(!a(t)){throw new o("plane is required.")}var i=e.center;var n=t.normal;var s=e.halfAxes;var u=n.x,c=n.y,d=n.z;var h=Math.abs(u*s[f.COLUMN0ROW0]+c*s[f.COLUMN0ROW1]+d*s[f.COLUMN0ROW2])+Math.abs(u*s[f.COLUMN1ROW0]+c*s[f.COLUMN1ROW1]+d*s[f.COLUMN1ROW2])+Math.abs(u*s[f.COLUMN2ROW0]+c*s[f.COLUMN2ROW1]+d*s[f.COLUMN2ROW2]);var p=r.dot(n,i)+t.distance;if(p<=-h){return l.OUTSIDE}else if(p>=h){return l.INSIDE}return l.INTERSECTING};var O=new r;var R=new r;var N=new r;var L=new r;m.distanceSquaredTo=function(e,t){if(!a(e)){throw new o("box is required.")}if(!a(t)){throw new o("cartesian is required.")}var i=r.subtract(t,e.center,E);var n=e.halfAxes;var s=f.getColumn(n,0,O);var u=f.getColumn(n,1,R);var l=f.getColumn(n,2,N);var c=r.magnitude(s);var d=r.magnitude(u);var h=r.magnitude(l);r.normalize(s,s);r.normalize(u,u);r.normalize(l,l);var p=L;p.x=r.dot(i,s);p.y=r.dot(i,u);p.z=r.dot(i,l);var m=0;var v;if(p.x<-c){v=p.x+c;m+=v*v}else if(p.x>c){v=p.x-c;m+=v*v}if(p.y<-d){v=p.y+d;m+=v*v}else if(p.y>d){v=p.y-d;m+=v*v}if(p.z<-h){v=p.z+h;m+=v*v}else if(p.z>h){v=p.z-h;m+=v*v}return m};var B=new r;var F=new r;m.computePlaneDistances=function(e,t,i,n){if(!a(e)){throw new o("box is required.")}if(!a(t)){throw new o("position is required.")}if(!a(i)){throw new o("direction is required.")}if(!a(n)){n=new c}var s=Number.POSITIVE_INFINITY;var u=Number.NEGATIVE_INFINITY;var l=e.center;var d=e.halfAxes;var h=f.getColumn(d,0,O);var p=f.getColumn(d,1,R);var m=f.getColumn(d,2,N);var v=r.add(h,p,B);r.add(v,m,v);r.add(v,l,v);var _=r.subtract(v,t,F);var g=r.dot(i,_);s=Math.min(g,s);u=Math.max(g,u);r.add(l,h,v);r.add(v,p,v);r.subtract(v,m,v);r.subtract(v,t,_);g=r.dot(i,_);s=Math.min(g,s);u=Math.max(g,u);r.add(l,h,v);r.subtract(v,p,v);r.add(v,m,v);r.subtract(v,t,_);g=r.dot(i,_);s=Math.min(g,s);u=Math.max(g,u);r.add(l,h,v);r.subtract(v,p,v);r.subtract(v,m,v);r.subtract(v,t,_);g=r.dot(i,_);s=Math.min(g,s);u=Math.max(g,u);r.subtract(l,h,v);r.add(v,p,v);r.add(v,m,v);r.subtract(v,t,_);g=r.dot(i,_);s=Math.min(g,s);u=Math.max(g,u);r.subtract(l,h,v);r.add(v,p,v);r.subtract(v,m,v);r.subtract(v,t,_);g=r.dot(i,_);s=Math.min(g,s);u=Math.max(g,u);r.subtract(l,h,v);r.subtract(v,p,v);r.add(v,m,v);r.subtract(v,t,_);g=r.dot(i,_);s=Math.min(g,s);u=Math.max(g,u);r.subtract(l,h,v);r.subtract(v,p,v);r.subtract(v,m,v);r.subtract(v,t,_);g=r.dot(i,_);s=Math.min(g,s);u=Math.max(g,u);n.start=s;n.stop=u;return n};var k=new e;m.isOccluded=function(t,r){if(!a(t)){throw new o("box is required.")}if(!a(r)){throw new o("occluder is required.")}var i=e.fromOrientedBoundingBox(t,k);return!r.isBoundingSphereVisible(i)};m.prototype.intersectPlane=function(e){return m.intersectPlane(this,e)};m.prototype.distanceSquaredTo=function(e){return m.distanceSquaredTo(this,e)};m.prototype.computePlaneDistances=function(e,t,r){return m.computePlaneDistances(this,e,t,r)};m.prototype.isOccluded=function(e){return m.isOccluded(this,e)};m.equals=function(e,t){return e===t||a(e)&&a(t)&&r.equals(e.center,t.center)&&f.equals(e.halfAxes,t.halfAxes)};m.prototype.clone=function(e){return m.clone(this,e)};m.prototype.equals=function(e){return m.equals(this,e)};return m});define("Core/TerrainQuantization",["./freezeObject"],function(e){"use strict";var t={NONE:0,BITS12:1};return e(t)});define("Core/TerrainEncoding",["./AttributeCompression","./Cartesian2","./Cartesian3","./ComponentDatatype","./defaultValue","./defined","./Math","./Matrix4","./TerrainQuantization"],function(e,t,r,i,n,a,o,s,u){"use strict";var l=new r;var c=new r;var d=new t;var f=new s;var h=new s;var p=Math.pow(2,12);function m(e,t,i,o,d,m){var v;var _;var g;var y;if(a(e)&&a(t)&&a(i)&&a(o)){var w=e.minimum;var C=e.maximum;var b=r.subtract(C,w,c);var S=i-t;var E=Math.max(r.maximumComponent(b),S);if(E<p-1){v=u.BITS12}else{v=u.NONE}_=e.center;g=s.inverseTransformation(o,new s);var T=r.negate(w,l);s.multiply(s.fromTranslation(T,f),g,g);var x=l;x.x=1/b.x;x.y=1/b.y;x.z=1/b.z;s.multiply(s.fromScale(x,f),g,g);y=s.clone(o);s.setTranslation(y,r.ZERO,y);o=s.clone(o,new s);var A=s.fromTranslation(w,f);var P=s.fromScale(b,h);var D=s.multiply(A,P,f);s.multiply(o,D,o);s.multiply(y,D,y)}this.quantization=v;this.minimumHeight=t;this.maximumHeight=i;this.center=_;this.toScaledENU=g;this.fromScaledENU=o;this.matrix=y;this.hasVertexNormals=d;this.hasWebMercatorT=n(m,false)}m.prototype.encode=function(i,n,a,c,f,h,p){var m=c.x;var v=c.y;if(this.quantization===u.BITS12){a=s.multiplyByPoint(this.toScaledENU,a,l);a.x=o.clamp(a.x,0,1);a.y=o.clamp(a.y,0,1);a.z=o.clamp(a.z,0,1);var _=this.maximumHeight-this.minimumHeight;var g=o.clamp((f-this.minimumHeight)/_,0,1);t.fromElements(a.x,a.y,d);var y=e.compressTextureCoordinates(d);t.fromElements(a.z,g,d);var w=e.compressTextureCoordinates(d);t.fromElements(m,v,d);var C=e.compressTextureCoordinates(d);i[n++]=y;i[n++]=w;i[n++]=C;if(this.hasWebMercatorT){t.fromElements(p,0,d);var b=e.compressTextureCoordinates(d);i[n++]=b}}else{r.subtract(a,this.center,l);i[n++]=l.x;i[n++]=l.y;i[n++]=l.z;i[n++]=f;i[n++]=m;i[n++]=v;if(this.hasWebMercatorT){i[n++]=p}}if(this.hasVertexNormals){i[n++]=e.octPackFloat(h)}return n};m.prototype.decodePosition=function(t,i,n){if(!a(n)){n=new r}i*=this.getStride();if(this.quantization===u.BITS12){var o=e.decompressTextureCoordinates(t[i],d);n.x=o.x;n.y=o.y;var l=e.decompressTextureCoordinates(t[i+1],d);n.z=l.x;return s.multiplyByPoint(this.fromScaledENU,n,n)}n.x=t[i];n.y=t[i+1];n.z=t[i+2];return r.add(n,this.center,n)};m.prototype.decodeTextureCoordinates=function(r,i,n){if(!a(n)){n=new t}i*=this.getStride();if(this.quantization===u.BITS12){return e.decompressTextureCoordinates(r[i+2],n)}return t.fromElements(r[i+4],r[i+5],n)};m.prototype.decodeHeight=function(t,r){r*=this.getStride();if(this.quantization===u.BITS12){var i=e.decompressTextureCoordinates(t[r+1],d);return i.y*(this.maximumHeight-this.minimumHeight)+this.minimumHeight}return t[r+3]};m.prototype.getOctEncodedNormal=function(e,r,i){var n=this.getStride();r=(r+1)*n-1;var a=e[r]/256;var o=Math.floor(a);var s=(a-o)*256;return t.fromElements(o,s,i)};m.prototype.getStride=function(){var e;switch(this.quantization){case u.BITS12:e=3;break;default:e=6}if(this.hasWebMercatorT){++e}if(this.hasVertexNormals){++e}return e};var v={position3DAndHeight:0,textureCoordAndEncodedNormals:1};var _={compressed0:0,compressed1:1};m.prototype.getAttributes=function(e){var t=i.FLOAT;var r=i.getSizeInBytes(t);var n;if(this.quantization===u.NONE){var a=4;var o=2;if(this.hasWebMercatorT){++o}if(this.hasVertexNormals){++o}n=(a+o)*r;return[{index:v.position3DAndHeight,vertexBuffer:e,componentDatatype:t,componentsPerAttribute:a,offsetInBytes:0,strideInBytes:n},{index:v.textureCoordAndEncodedNormals,vertexBuffer:e,componentDatatype:t,componentsPerAttribute:o,offsetInBytes:a*r,strideInBytes:n}]}var s=3;var l=0;if(this.hasWebMercatorT||this.hasVertexNormals){++s}if(this.hasWebMercatorT&&this.hasVertexNormals){++l;n=(s+l)*r;return[{index:_.compressed0,vertexBuffer:e,componentDatatype:t,componentsPerAttribute:s,offsetInBytes:0,strideInBytes:n},{index:_.compressed1,vertexBuffer:e,componentDatatype:t,componentsPerAttribute:l,offsetInBytes:s*r,strideInBytes:n}]}else{return[{index:_.compressed0,vertexBuffer:e,componentDatatype:t,componentsPerAttribute:s}]}};m.prototype.getAttributeLocations=function(){if(this.quantization===u.NONE){return v}else{return _}};m.clone=function(e,t){if(!a(t)){t=new m}t.quantization=e.quantization;t.minimumHeight=e.minimumHeight;t.maximumHeight=e.maximumHeight;t.center=r.clone(e.center);t.toScaledENU=s.clone(e.toScaledENU);t.fromScaledENU=s.clone(e.fromScaledENU);t.matrix=s.clone(e.matrix);t.hasVertexNormals=e.hasVertexNormals;t.hasWebMercatorT=e.hasWebMercatorT;return t};return m});define("Core/WebMercatorProjection",["./Cartesian3","./Cartographic","./defaultValue","./defined","./defineProperties","./DeveloperError","./Ellipsoid","./Math"],function(e,t,r,i,n,a,o,s){"use strict";function u(e){this._ellipsoid=r(e,o.WGS84);this._semimajorAxis=this._ellipsoid.maximumRadius;this._oneOverSemimajorAxis=1/this._semimajorAxis}n(u.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}});u.mercatorAngleToGeodeticLatitude=function(e){return s.PI_OVER_TWO-2*Math.atan(Math.exp(-e))};u.geodeticLatitudeToMercatorAngle=function(e){if(e>u.MaximumLatitude){e=u.MaximumLatitude}else if(e<-u.MaximumLatitude){e=-u.MaximumLatitude}var t=Math.sin(e);return.5*Math.log((1+t)/(1-t))};u.MaximumLatitude=u.mercatorAngleToGeodeticLatitude(Math.PI);u.prototype.project=function(t,r){var n=this._semimajorAxis;var a=t.longitude*n;var o=u.geodeticLatitudeToMercatorAngle(t.latitude)*n;var s=t.height;if(!i(r)){return new e(a,o,s)}r.x=a;r.y=o;r.z=s;return r};u.prototype.unproject=function(e,r){if(!i(e)){throw new a("cartesian is required")}var n=this._oneOverSemimajorAxis;var o=e.x*n;var s=u.mercatorAngleToGeodeticLatitude(e.y*n);var l=e.z;if(!i(r)){return new t(o,s,l)}r.longitude=o;r.latitude=s;r.height=l;return r};return u});define("Core/HeightmapTessellator",["./AxisAlignedBoundingBox","./BoundingSphere","./Cartesian2","./Cartesian3","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./EllipsoidalOccluder","./freezeObject","./Math","./Matrix4","./OrientedBoundingBox","./Rectangle","./TerrainEncoding","./Transforms","./WebMercatorProjection"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v){"use strict";var _={};_.DEFAULT_STRUCTURE=l({heightScale:1,heightOffset:0,elementsPerHeight:1,stride:1,elementMultiplier:256,isBigEndian:false});var g=new i;var y=new d;var w=new i;var C=new i;_.computeVertices=function(l){if(!a(l)||!a(l.heightmap)){throw new o("options.heightmap is required.")}if(!a(l.width)||!a(l.height)){throw new o("options.width and options.height are required.")}if(!a(l.nativeRectangle)){throw new o("options.nativeRectangle is required.")}if(!a(l.skirtHeight)){throw new o("options.skirtHeight is required.")}var b=Math.cos;var S=Math.sin;var E=Math.sqrt;var T=Math.atan;var x=Math.exp;var A=c.PI_OVER_TWO;var P=c.toRadians;var D=l.heightmap;var M=l.width;var I=l.height;var O=l.skirtHeight;var R=n(l.isGeographic,true);var N=n(l.ellipsoid,s.WGS84);var L=1/N.maximumRadius;var B=l.nativeRectangle;var F;var k;var V;var z;var U=l.rectangle;if(!a(U)){if(R){F=P(B.west);k=P(B.south);V=P(B.east);z=P(B.north)}else{F=B.west*L;k=A-2*T(x(-B.south*L));V=B.east*L;z=A-2*T(x(-B.north*L))}}else{F=U.west;k=U.south;V=U.east;z=U.north}var q=l.relativeToCenter;var G=a(q);q=G?q:i.ZERO;var H=n(l.exaggeration,1);var W=n(l.includeWebMercatorT,false);var j=n(l.structure,_.DEFAULT_STRUCTURE);var Y=n(j.heightScale,_.DEFAULT_STRUCTURE.heightScale);var X=n(j.heightOffset,_.DEFAULT_STRUCTURE.heightOffset);var Z=n(j.elementsPerHeight,_.DEFAULT_STRUCTURE.elementsPerHeight);var K=n(j.stride,_.DEFAULT_STRUCTURE.stride);var Q=n(j.elementMultiplier,_.DEFAULT_STRUCTURE.elementMultiplier);var J=n(j.isBigEndian,_.DEFAULT_STRUCTURE.isBigEndian);var $=h.computeWidth(B);var ee=h.computeHeight(B);var te=$/(M-1);var re=ee/(I-1);var ie=N.radiiSquared;var ne=ie.x;var ae=ie.y;var oe=ie.z;var se=65536;var ue=-65536;var le=m.eastNorthUpToFixedFrame(q,N);var ce=d.inverseTransformation(le,y);var de;var fe;if(W){de=v.geodeticLatitudeToMercatorAngle(k);fe=1/(v.geodeticLatitudeToMercatorAngle(z)-de)}var he=w;he.x=Number.POSITIVE_INFINITY;he.y=Number.POSITIVE_INFINITY;he.z=Number.POSITIVE_INFINITY;var pe=C;pe.x=Number.NEGATIVE_INFINITY;pe.y=Number.NEGATIVE_INFINITY;pe.z=Number.NEGATIVE_INFINITY;var me=Number.POSITIVE_INFINITY;var ve=M+(O>0?2:0);var _e=I+(O>0?2:0);var ge=ve*_e;var ye=new Array(ge);var we=new Array(ge);var Ce=new Array(ge);var be=W?new Array(ge):[];var Se=0;var Ee=I;var Te=0;var xe=M;if(O>0){--Se;++Ee;--Te;++xe}var Ae=0;for(var Pe=Se;Pe<Ee;++Pe){var De=Pe;if(De<0){De=0}if(De>=I){De=I-1}var Me=B.north-re*De;if(!R){Me=A-2*T(x(-Me*L))}else{Me=P(Me)}var Ie=b(Me);var Oe=S(Me);var Re=oe*Oe;var Ne=(Me-k)/(z-k);Ne=c.clamp(Ne,0,1);var Le;if(W){Le=(v.geodeticLatitudeToMercatorAngle(Me)-de)*fe}for(var Be=Te;Be<xe;++Be){var Fe=Be;if(Fe<0){Fe=0}if(Fe>=M){Fe=M-1}var ke=B.west+te*Fe;if(!R){ke=ke*L}else{ke=P(ke)}var Ve=De*(M*K)+Fe*K;var ze;if(Z===1){ze=D[Ve]}else{ze=0;var Ue;if(J){for(Ue=0;Ue<Z;++Ue){ze=ze*Q+D[Ve+Ue]}}else{for(Ue=Z-1;Ue>=0;--Ue){ze=ze*Q+D[Ve+Ue]}}}ze=(ze*Y+X)*H;var qe=(ke-F)/(V-F);qe=c.clamp(qe,0,1);Ce[Ae]=new r(qe,Ne);ue=Math.max(ue,ze);se=Math.min(se,ze);if(Be!==Fe||Pe!==De){var Ge=1e-5;if(Be<0){ke-=Ge*$}else{ke+=Ge*$}if(Pe<0){Me+=Ge*ee}else{Me-=Ge*ee}Ie=b(Me);Oe=S(Me);Re=oe*Oe;ze-=O}var He=Ie*b(ke);var We=Ie*S(ke);var je=ne*He;var Ye=ae*We;var Xe=E(je*He+Ye*We+Re*Oe);var Ze=1/Xe;var Ke=je*Ze;var Qe=Ye*Ze;var Je=Re*Ze;var $e=new i;$e.x=Ke+He*ze;$e.y=Qe+We*ze;$e.z=Je+Oe*ze;ye[Ae]=$e;we[Ae]=ze;if(W){be[Ae]=Le}Ae++;d.multiplyByPoint(ce,$e,g);i.minimumByComponent(g,he,he);i.maximumByComponent(g,pe,pe);me=Math.min(me,ze)}}var et=t.fromPoints(ye);var tt;if(a(U)&&U.width<c.PI_OVER_TWO+c.EPSILON5){tt=f.fromRectangle(U,se,ue,N)}var rt;if(G){var it=new u(N);rt=it.computeHorizonCullingPoint(q,ye)}var nt=new e(he,pe,q);var at=new p(nt,me,ue,le,false,W);var ot=new Float32Array(ge*at.getStride());var st=0;for(var ut=0;ut<ge;++ut){st=at.encode(ot,st,ye[ut],Ce[ut],we[ut],undefined,be[ut])}return{vertices:ot,maximumHeight:ue,minimumHeight:se,encoding:at,boundingSphere3D:et,orientedBoundingBox:tt,occludeePointInScaledSpace:rt}};return _});define("Core/destroyObject",["./defaultValue","./DeveloperError"],function(e,t){"use strict";function r(){return true}function i(i,n){n=e(n,"This object was destroyed, i.e., destroy() was called.");function a(){throw new t(n)}for(var o in i){if(typeof i[o]==="function"){i[o]=a}}i.isDestroyed=r;return undefined}return i});define("Core/isCrossOriginUrl",["./defined"],function(e){"use strict";var t;function r(r){if(!e(t)){t=document.createElement("a")}t.href=window.location.href;var i=t.host;var n=t.protocol;t.href=r;t.href=t.href;return n!==t.protocol||i!==t.host}return r});define("Core/TaskProcessor",["../ThirdParty/when","./buildModuleUrl","./defaultValue","./defined","./destroyObject","./DeveloperError","./getAbsoluteUri","./isCrossOriginUrl","./RuntimeError","require"],function(e,t,r,i,n,a,o,s,u,l){"use strict";function c(){if(!i(v._canTransferArrayBuffer)){var t=new Worker(f("Workers/transferTypedArrayTest.js"));t.postMessage=r(t.webkitPostMessage,t.postMessage);var n=99;var a=new Int8Array([n]);try{t.postMessage({array:a},[a.buffer])}catch(e){v._canTransferArrayBuffer=false;return v._canTransferArrayBuffer}var o=e.defer();t.onmessage=function(e){var r=e.data.array;var a=i(r)&&r[0]===n;o.resolve(a);t.terminate();v._canTransferArrayBuffer=a};v._canTransferArrayBuffer=o.promise}return v._canTransferArrayBuffer}function d(e,t){--e._activeTasks;var r=t.id;if(!i(r)){return}var n=e._deferreds;var o=n[r];if(i(t.error)){var s=t.error;if(s.name==="RuntimeError"){s=new u(t.error.message);s.stack=t.error.stack}else if(s.name==="DeveloperError"){s=new a(t.error.message);s.stack=t.error.stack}o.reject(s)}else{o.resolve(t.result)}delete n[r]}function f(e){var r=t(e);if(s(r)){var i='importScripts("'+r+'");';var n;try{n=new Blob([i],{type:"application/javascript"})}catch(e){var a=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;var o=new a;o.append(i);n=o.getBlob("application/javascript")}var u=window.URL||window.webkitURL;r=u.createObjectURL(n)}return r}var h;function p(){if(!i(h)){h=f("Workers/cesiumWorkerBootstrapper.js")}return h}function m(e){var n=new Worker(p());n.postMessage=r(n.webkitPostMessage,n.postMessage);var a={loaderConfig:{},workerModule:v._workerModulePrefix+e._workerName};if(i(v._loaderConfig)){a.loaderConfig=v._loaderConfig}else if(i(l.toUrl)){a.loaderConfig.baseUrl=o("..",t("Workers/cesiumWorkerBootstrapper.js"))}else{a.loaderConfig.paths={Workers:t("Workers")}}n.postMessage(a);n.onmessage=function(t){d(e,t.data)};return n}function v(e,t){this._workerName=e;this._maximumActiveTasks=r(t,5);this._activeTasks=0;this._deferreds={};this._nextID=0}var _=[];v.prototype.scheduleTask=function(t,r){if(!i(this._worker)){this._worker=m(this)}if(this._activeTasks>=this._maximumActiveTasks){return undefined}++this._activeTasks;var n=this;return e(c(),function(a){if(!i(r)){r=_}else if(!a){r.length=0}var o=n._nextID++;var s=e.defer();n._deferreds[o]=s;n._worker.postMessage({id:o,parameters:t,canTransferArrayBuffer:a},r);return s.promise})};v.prototype.isDestroyed=function(){return false};v.prototype.destroy=function(){if(i(this._worker)){this._worker.terminate()}return n(this)};v._defaultWorkerModulePrefix="Workers/";v._workerModulePrefix=v._defaultWorkerModulePrefix;v._loaderConfig=undefined;v._canTransferArrayBuffer=undefined;return v});define("Core/TerrainMesh",["./defaultValue"],function(e){"use strict";function t(t,r,i,n,a,o,s,u,l,c,d){this.center=t;this.vertices=r;this.stride=e(u,6);this.indices=i;this.minimumHeight=n;this.maximumHeight=a;this.boundingSphere3D=o;this.occludeePointInScaledSpace=s;this.orientedBoundingBox=l;this.encoding=c;this.exaggeration=d}return t});define("Core/TerrainProvider",["./defined","./defineProperties","./DeveloperError","./Math"],function(e,t,r,i){"use strict";function n(){r.throwInstantiationError()}t(n.prototype,{errorEvent:{get:r.throwInstantiationError},credit:{get:r.throwInstantiationError},tilingScheme:{get:r.throwInstantiationError},ready:{get:r.throwInstantiationError},readyPromise:{get:r.throwInstantiationError},hasWaterMask:{get:r.throwInstantiationError},hasVertexNormals:{get:r.throwInstantiationError},availability:{get:r.throwInstantiationError}});var a=[];n.getRegularGridIndices=function(t,n){if(t*n>=i.SIXTY_FOUR_KILOBYTES){throw new r("The total number of vertices (width * height) must be less than 65536.")}var o=a[t];if(!e(o)){a[t]=o=[]}var s=o[n];if(!e(s)){s=o[n]=new Uint16Array((t-1)*(n-1)*6);var u=0;var l=0;for(var c=0;c<n-1;++c){for(var d=0;d<t-1;++d){var f=u;var h=f+t;var p=h+1;var m=f+1;s[l++]=f;s[l++]=h;s[l++]=m;s[l++]=m;s[l++]=h;s[l++]=p;++u}++u}}return s};n.heightmapTerrainQuality=.25;n.getEstimatedLevelZeroGeometricErrorForAHeightmap=function(e,t,r){return e.maximumRadius*2*Math.PI*n.heightmapTerrainQuality/(t*r)};n.prototype.requestTileGeometry=r.throwInstantiationError;n.prototype.getLevelMaximumGeometricError=r.throwInstantiationError;n.prototype.getTileDataAvailable=r.throwInstantiationError;return n});define("Core/HeightmapTerrainData",["../ThirdParty/when","./defaultValue","./defined","./defineProperties","./DeveloperError","./GeographicTilingScheme","./HeightmapTessellator","./Math","./Rectangle","./TaskProcessor","./TerrainEncoding","./TerrainMesh","./TerrainProvider"],function(e,t,r,i,n,a,o,s,u,l,c,d,f){"use strict";function h(e){if(!r(e)||!r(e.buffer)){throw new n("options.buffer is required.")}if(!r(e.width)){throw new n("options.width is required.")}if(!r(e.height)){throw new n("options.height is required.")}this._buffer=e.buffer;this._width=e.width;this._height=e.height;this._childTileMask=t(e.childTileMask,15);var i=o.DEFAULT_STRUCTURE;var a=e.structure;if(!r(a)){a=i}else if(a!==i){a.heightScale=t(a.heightScale,i.heightScale);a.heightOffset=t(a.heightOffset,i.heightOffset);a.elementsPerHeight=t(a.elementsPerHeight,i.elementsPerHeight);a.stride=t(a.stride,i.stride);a.elementMultiplier=t(a.elementMultiplier,i.elementMultiplier);a.isBigEndian=t(a.isBigEndian,i.isBigEndian)}this._structure=a;this._createdByUpsampling=t(e.createdByUpsampling,false);this._waterMask=e.waterMask;this._skirtHeight=undefined;this._bufferType=this._buffer.constructor;this._mesh=undefined}i(h.prototype,{waterMask:{get:function(){return this._waterMask}}});var p=new l("createVerticesFromHeightmap");h.prototype.createMesh=function(i,o,s,l,h){if(!r(i)){throw new n("tilingScheme is required.")}if(!r(o)){throw new n("x is required.")}if(!r(s)){throw new n("y is required.")}if(!r(l)){throw new n("level is required.")}var m=i.ellipsoid;var v=i.tileXYToNativeRectangle(o,s,l);var _=i.tileXYToRectangle(o,s,l);h=t(h,1);var g=m.cartographicToCartesian(u.center(_));var y=this._structure;var w=f.getEstimatedLevelZeroGeometricErrorForAHeightmap(m,this._width,i.getNumberOfXTilesAtLevel(0));var C=w/(1<<l);this._skirtHeight=Math.min(C*4,1e3);var b=p.scheduleTask({heightmap:this._buffer,structure:y,includeWebMercatorT:true,width:this._width,height:this._height,nativeRectangle:v,rectangle:_,relativeToCenter:g,ellipsoid:m,skirtHeight:this._skirtHeight,isGeographic:i instanceof a,exaggeration:h});if(!r(b)){return undefined}var S=this;return e(b,function(e){S._mesh=new d(g,new Float32Array(e.vertices),f.getRegularGridIndices(e.gridWidth,e.gridHeight),e.minimumHeight,e.maximumHeight,e.boundingSphere3D,e.occludeePointInScaledSpace,e.numberOfAttributes,e.orientedBoundingBox,c.clone(e.encoding),h);S._buffer=undefined;return S._mesh})};h.prototype.interpolateHeight=function(e,t,i){var n=this._width;var a=this._height;var o=this._structure;var s=o.stride;var u=o.elementsPerHeight;var l=o.elementMultiplier;var c=o.isBigEndian;var d=o.heightOffset;var f=o.heightScale;var h;if(r(this._mesh)){var p=this._mesh.vertices;var _=this._mesh.encoding;var g=this._skirtHeight;var y=this._mesh.exaggeration;h=v(p,_,d,f,g,e,n,a,t,i,y)}else{h=m(this._buffer,u,l,s,c,e,n,a,t,i);h=h*f+d}return h};h.prototype.upsample=function(e,t,i,a,o,u,l){if(!r(e)){throw new n("tilingScheme is required.")}if(!r(t)){throw new n("thisX is required.")}if(!r(i)){throw new n("thisY is required.")}if(!r(a)){throw new n("thisLevel is required.")}if(!r(o)){throw new n("descendantX is required.")}if(!r(u)){throw new n("descendantY is required.")}if(!r(l)){throw new n("descendantLevel is required.")}var c=l-a;if(c>1){
throw new n("Upsampling through more than one level at a time is not currently supported.")}var d=this._width;var f=this._height;var p=this._structure;var m=this._skirtHeight;var _=p.stride;var g=new this._bufferType(d*f*_);var w=this._mesh;if(!r(w)){return undefined}var C=w.vertices;var b=w.encoding;var S=e.tileXYToRectangle(t,i,a);var E=e.tileXYToRectangle(o,u,l);var T=p.heightOffset;var x=p.heightScale;var A=w.exaggeration;var P=p.elementsPerHeight;var D=p.elementMultiplier;var M=p.isBigEndian;var I=Math.pow(D,P-1);for(var O=0;O<f;++O){var R=s.lerp(E.north,E.south,O/(f-1));for(var N=0;N<d;++N){var L=s.lerp(E.west,E.east,N/(d-1));var B=v(C,b,T,x,m,S,d,f,L,R,A);B=B<p.lowestEncodedHeight?p.lowestEncodedHeight:B;B=B>p.highestEncodedHeight?p.highestEncodedHeight:B;y(g,P,D,I,_,M,O*d+N,B)}}return new h({buffer:g,width:d,height:f,childTileMask:0,structure:this._structure,createdByUpsampling:true})};h.prototype.isChildAvailable=function(e,t,i,a){if(!r(e)){throw new n("thisX is required.")}if(!r(t)){throw new n("thisY is required.")}if(!r(i)){throw new n("childX is required.")}if(!r(a)){throw new n("childY is required.")}var o=2;if(i!==e*2){++o}if(a!==t*2){o-=2}return(this._childTileMask&1<<o)!==0};h.prototype.wasCreatedByUpsampling=function(){return this._createdByUpsampling};function m(e,t,r,i,n,a,o,s,u,l){var c=(u-a.west)*(o-1)/(a.east-a.west);var d=(l-a.south)*(s-1)/(a.north-a.south);var f=c|0;var h=f+1;if(h>=o){h=o-1;f=o-2}var p=d|0;var m=p+1;if(m>=s){m=s-1;p=s-2}var v=c-f;var y=d-p;p=s-1-p;m=s-1-m;var w=g(e,t,r,i,n,p*o+f);var C=g(e,t,r,i,n,p*o+h);var b=g(e,t,r,i,n,m*o+f);var S=g(e,t,r,i,n,m*o+h);return _(v,y,w,C,b,S)}function v(e,t,r,i,n,a,o,s,u,l,c){var d=(u-a.west)*(o-1)/(a.east-a.west);var f=(l-a.south)*(s-1)/(a.north-a.south);if(n>0){d+=1;f+=1;o+=2;s+=2}var h=n>0?o-1:o;var p=d|0;var m=p+1;if(m>=h){m=o-1;p=o-2}var v=n>0?s-1:s;var g=f|0;var y=g+1;if(y>=v){y=s-1;g=s-2}var w=d-p;var C=f-g;g=s-1-g;y=s-1-y;var b=(t.decodeHeight(e,g*o+p)/c-r)/i;var S=(t.decodeHeight(e,g*o+m)/c-r)/i;var E=(t.decodeHeight(e,y*o+p)/c-r)/i;var T=(t.decodeHeight(e,y*o+m)/c-r)/i;return _(w,C,b,S,E,T)}function _(e,t,r,i,n,a){if(t<e){return r+e*(i-r)+t*(a-i)}return r+e*(a-n)+t*(n-r)}function g(e,t,r,i,n,a){a*=i;var o=0;var s;if(n){for(s=0;s<t;++s){o=o*r+e[a+s]}}else{for(s=t-1;s>=0;--s){o=o*r+e[a+s]}}return o}function y(e,t,r,i,n,a,o,s){o*=n;var u;if(a){for(u=0;u<t-1;++u){e[o+u]=s/i|0;s-=e[o+u]*i;i/=r}}else{for(u=t-1;u>0;--u){e[o+u]=s/i|0;s-=e[o+u]*i;i/=r}}e[o+u]=s}return h});define("Core/IndexDatatype",["./defined","./DeveloperError","./freezeObject","./Math","./WebGLConstants"],function(e,t,r,i,n){"use strict";var a={UNSIGNED_BYTE:n.UNSIGNED_BYTE,UNSIGNED_SHORT:n.UNSIGNED_SHORT,UNSIGNED_INT:n.UNSIGNED_INT};a.getSizeInBytes=function(e){switch(e){case a.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case a.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case a.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT}throw new t("indexDatatype is required and must be a valid IndexDatatype constant.")};a.validate=function(t){return e(t)&&(t===a.UNSIGNED_BYTE||t===a.UNSIGNED_SHORT||t===a.UNSIGNED_INT)};a.createTypedArray=function(r,n){if(!e(r)){throw new t("numberOfVertices is required.")}if(r>=i.SIXTY_FOUR_KILOBYTES){return new Uint32Array(n)}return new Uint16Array(n)};a.createTypedArrayFromArrayBuffer=function(r,n,a,o){if(!e(r)){throw new t("numberOfVertices is required.")}if(!e(n)){throw new t("sourceArray is required.")}if(!e(a)){throw new t("byteOffset is required.")}if(r>=i.SIXTY_FOUR_KILOBYTES){return new Uint32Array(n,a,o)}return new Uint16Array(n,a,o)};return r(a)});define("Core/loadArrayBuffer",["./loadWithXhr"],function(e){"use strict";function t(t,r){return e({url:t,responseType:"arraybuffer",headers:r})}return t});define("Core/Intersections2D",["./Cartesian3","./defined","./DeveloperError"],function(e,t,r){"use strict";var i={};i.clipTriangleAtAxisAlignedThreshold=function(e,i,n,a,o,s){if(!t(e)){throw new r("threshold is required.")}if(!t(i)){throw new r("keepAbove is required.")}if(!t(n)){throw new r("u0 is required.")}if(!t(a)){throw new r("u1 is required.")}if(!t(o)){throw new r("u2 is required.")}if(!t(s)){s=[]}else{s.length=0}var u;var l;var c;if(i){u=n<e;l=a<e;c=o<e}else{u=n>e;l=a>e;c=o>e}var d=u+l+c;var f;var h;var p;var m;var v;var _;if(d===1){if(u){f=(e-n)/(a-n);h=(e-n)/(o-n);s.push(1);s.push(2);if(h!==1){s.push(-1);s.push(0);s.push(2);s.push(h)}if(f!==1){s.push(-1);s.push(0);s.push(1);s.push(f)}}else if(l){p=(e-a)/(o-a);m=(e-a)/(n-a);s.push(2);s.push(0);if(m!==1){s.push(-1);s.push(1);s.push(0);s.push(m)}if(p!==1){s.push(-1);s.push(1);s.push(2);s.push(p)}}else if(c){v=(e-o)/(n-o);_=(e-o)/(a-o);s.push(0);s.push(1);if(_!==1){s.push(-1);s.push(2);s.push(1);s.push(_)}if(v!==1){s.push(-1);s.push(2);s.push(0);s.push(v)}}}else if(d===2){if(!u&&n!==e){m=(e-a)/(n-a);v=(e-o)/(n-o);s.push(0);s.push(-1);s.push(1);s.push(0);s.push(m);s.push(-1);s.push(2);s.push(0);s.push(v)}else if(!l&&a!==e){_=(e-o)/(a-o);f=(e-n)/(a-n);s.push(1);s.push(-1);s.push(2);s.push(1);s.push(_);s.push(-1);s.push(0);s.push(1);s.push(f)}else if(!c&&o!==e){h=(e-n)/(o-n);p=(e-a)/(o-a);s.push(2);s.push(-1);s.push(0);s.push(2);s.push(h);s.push(-1);s.push(1);s.push(2);s.push(p)}}else if(d!==3){s.push(0);s.push(1);s.push(2)}return s};i.computeBarycentricCoordinates=function(i,n,a,o,s,u,l,c,d){if(!t(i)){throw new r("x is required.")}if(!t(n)){throw new r("y is required.")}if(!t(a)){throw new r("x1 is required.")}if(!t(o)){throw new r("y1 is required.")}if(!t(s)){throw new r("x2 is required.")}if(!t(u)){throw new r("y2 is required.")}if(!t(l)){throw new r("x3 is required.")}if(!t(c)){throw new r("y3 is required.")}var f=a-l;var h=l-s;var p=u-c;var m=o-c;var v=1/(p*f+h*m);var _=n-c;var g=i-l;var y=(p*g+h*_)*v;var w=(-m*g+f*_)*v;var C=1-y-w;if(t(d)){d.x=y;d.y=w;d.z=C;return d}else{return new e(y,w,C)}};return i});define("Core/QuantizedMeshTerrainData",["../ThirdParty/when","./BoundingSphere","./Cartesian2","./Cartesian3","./defaultValue","./defined","./defineProperties","./DeveloperError","./IndexDatatype","./Intersections2D","./Math","./OrientedBoundingBox","./TaskProcessor","./TerrainEncoding","./TerrainMesh"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p){"use strict";function m(e){if(!a(e)||!a(e.quantizedVertices)){throw new s("options.quantizedVertices is required.")}if(!a(e.indices)){throw new s("options.indices is required.")}if(!a(e.minimumHeight)){throw new s("options.minimumHeight is required.")}if(!a(e.maximumHeight)){throw new s("options.maximumHeight is required.")}if(!a(e.maximumHeight)){throw new s("options.maximumHeight is required.")}if(!a(e.boundingSphere)){throw new s("options.boundingSphere is required.")}if(!a(e.horizonOcclusionPoint)){throw new s("options.horizonOcclusionPoint is required.")}if(!a(e.westIndices)){throw new s("options.westIndices is required.")}if(!a(e.southIndices)){throw new s("options.southIndices is required.")}if(!a(e.eastIndices)){throw new s("options.eastIndices is required.")}if(!a(e.northIndices)){throw new s("options.northIndices is required.")}if(!a(e.westSkirtHeight)){throw new s("options.westSkirtHeight is required.")}if(!a(e.southSkirtHeight)){throw new s("options.southSkirtHeight is required.")}if(!a(e.eastSkirtHeight)){throw new s("options.eastSkirtHeight is required.")}if(!a(e.northSkirtHeight)){throw new s("options.northSkirtHeight is required.")}this._quantizedVertices=e.quantizedVertices;this._encodedNormals=e.encodedNormals;this._indices=e.indices;this._minimumHeight=e.minimumHeight;this._maximumHeight=e.maximumHeight;this._boundingSphere=e.boundingSphere;this._orientedBoundingBox=e.orientedBoundingBox;this._horizonOcclusionPoint=e.horizonOcclusionPoint;var t=this._quantizedVertices.length/3;var r=this._uValues=this._quantizedVertices.subarray(0,t);var i=this._vValues=this._quantizedVertices.subarray(t,2*t);this._heightValues=this._quantizedVertices.subarray(2*t,3*t);function o(e,t){return i[e]-i[t]}function u(e,t){return r[e]-r[t]}this._westIndices=_(e.westIndices,o,t);this._southIndices=_(e.southIndices,u,t);this._eastIndices=_(e.eastIndices,o,t);this._northIndices=_(e.northIndices,u,t);this._westSkirtHeight=e.westSkirtHeight;this._southSkirtHeight=e.southSkirtHeight;this._eastSkirtHeight=e.eastSkirtHeight;this._northSkirtHeight=e.northSkirtHeight;this._childTileMask=n(e.childTileMask,15);this._createdByUpsampling=n(e.createdByUpsampling,false);this._waterMask=e.waterMask;this._mesh=undefined}o(m.prototype,{waterMask:{get:function(){return this._waterMask}}});var v=[];function _(e,t,r){v.length=e.length;var i=false;for(var n=0,a=e.length;n<a;++n){v[n]=e[n];i=i||n>0&&t(e[n-1],e[n])>0}if(i){v.sort(t);return u.createTypedArray(r,v)}else{return e}}var g=new f("createVerticesFromQuantizedTerrainMesh");m.prototype.createMesh=function(t,r,i,o,l){if(!a(t)){throw new s("tilingScheme is required.")}if(!a(r)){throw new s("x is required.")}if(!a(i)){throw new s("y is required.")}if(!a(o)){throw new s("level is required.")}var c=t.ellipsoid;var d=t.tileXYToRectangle(r,i,o);l=n(l,1);var f=g.scheduleTask({minimumHeight:this._minimumHeight,maximumHeight:this._maximumHeight,quantizedVertices:this._quantizedVertices,octEncodedNormals:this._encodedNormals,includeWebMercatorT:true,indices:this._indices,westIndices:this._westIndices,southIndices:this._southIndices,eastIndices:this._eastIndices,northIndices:this._northIndices,westSkirtHeight:this._westSkirtHeight,southSkirtHeight:this._southSkirtHeight,eastSkirtHeight:this._eastSkirtHeight,northSkirtHeight:this._northSkirtHeight,rectangle:d,relativeToCenter:this._boundingSphere.center,ellipsoid:c,exaggeration:l});if(!a(f)){return undefined}var m=this;return e(f,function(e){var t=m._quantizedVertices.length/3;t+=m._westIndices.length+m._southIndices.length+m._eastIndices.length+m._northIndices.length;var r=u.createTypedArray(t,e.indices);var i=new Float32Array(e.vertices);var a=e.center;var o=e.minimumHeight;var s=e.maximumHeight;var c=n(e.boundingSphere,m._boundingSphere);var d=n(e.orientedBoundingBox,m._orientedBoundingBox);var f=m._horizonOcclusionPoint;var v=e.vertexStride;var _=h.clone(e.encoding);m._skirtIndex=e.skirtIndex;m._vertexCountWithoutSkirts=m._quantizedVertices.length/3;m._mesh=new p(a,i,r,o,s,c,f,v,d,_,l);m._quantizedVertices=undefined;m._encodedNormals=undefined;m._indices=undefined;m._uValues=undefined;m._vValues=undefined;m._heightValues=undefined;m._westIndices=undefined;m._southIndices=undefined;m._eastIndices=undefined;m._northIndices=undefined;return m._mesh})};var y=new f("upsampleQuantizedTerrainMesh");m.prototype.upsample=function(r,n,o,l,c,f,h){if(!a(r)){throw new s("tilingScheme is required.")}if(!a(n)){throw new s("thisX is required.")}if(!a(o)){throw new s("thisY is required.")}if(!a(l)){throw new s("thisLevel is required.")}if(!a(c)){throw new s("descendantX is required.")}if(!a(f)){throw new s("descendantY is required.")}if(!a(h)){throw new s("descendantLevel is required.")}var p=h-l;if(p>1){throw new s("Upsampling through more than one level at a time is not currently supported.")}var v=this._mesh;if(!a(this._mesh)){return undefined}var _=n*2!==c;var g=o*2===f;var w=r.ellipsoid;var C=r.tileXYToRectangle(c,f,h);var b=y.scheduleTask({vertices:v.vertices,vertexCountWithoutSkirts:this._vertexCountWithoutSkirts,indices:v.indices,skirtIndex:this._skirtIndex,encoding:v.encoding,minimumHeight:this._minimumHeight,maximumHeight:this._maximumHeight,isEastChild:_,isNorthChild:g,childRectangle:C,ellipsoid:w,exaggeration:v.exaggeration});if(!a(b)){return undefined}var S=Math.min(this._westSkirtHeight,this._eastSkirtHeight);S=Math.min(S,this._southSkirtHeight);S=Math.min(S,this._northSkirtHeight);var E=_?S*.5:this._westSkirtHeight;var T=g?S*.5:this._southSkirtHeight;var x=_?this._eastSkirtHeight:S*.5;var A=g?this._northSkirtHeight:S*.5;return e(b,function(e){var r=new Uint16Array(e.vertices);var n=u.createTypedArray(r.length/3,e.indices);var o;if(a(e.encodedNormals)){o=new Uint8Array(e.encodedNormals)}return new m({quantizedVertices:r,indices:n,encodedNormals:o,minimumHeight:e.minimumHeight,maximumHeight:e.maximumHeight,boundingSphere:t.clone(e.boundingSphere),orientedBoundingBox:d.clone(e.orientedBoundingBox),horizonOcclusionPoint:i.clone(e.horizonOcclusionPoint),westIndices:e.westIndices,southIndices:e.southIndices,eastIndices:e.eastIndices,northIndices:e.northIndices,westSkirtHeight:E,southSkirtHeight:T,eastSkirtHeight:x,northSkirtHeight:A,childTileMask:0,createdByUpsampling:true})})};var w=32767;var C=new i;m.prototype.interpolateHeight=function(e,t,r){var i=c.clamp((t-e.west)/e.width,0,1);i*=w;var n=c.clamp((r-e.south)/e.height,0,1);n*=w;if(!a(this._mesh)){return x(this,i,n)}T(this,i,n)};var b=new r;var S=new r;var E=new r;function T(e,t,r){var i=e._mesh;var n=i.vertices;var a=i.encoding;var o=i.indices;for(var s=0,u=o.length;s<u;s+=3){var c=o[s];var d=o[s+1];var f=o[s+2];var h=a.decodeTextureCoordinates(n,c,b);var p=a.decodeTextureCoordinates(n,d,S);var m=a.decodeTextureCoordinates(n,f,E);var v=l.computeBarycentricCoordinates(t,r,h.x,h.y,p.x,p.y,m.x,m.y,C);if(v.x>=-1e-15&&v.y>=-1e-15&&v.z>=-1e-15){var _=a.decodeHeight(n,c);var g=a.decodeHeight(n,d);var y=a.decodeHeight(n,f);return v.x*_+v.y*g+v.z*y}}return undefined}function x(e,t,r){var i=e._uValues;var n=e._vValues;var a=e._heightValues;var o=e._indices;for(var s=0,u=o.length;s<u;s+=3){var d=o[s];var f=o[s+1];var h=o[s+2];var p=i[d];var m=i[f];var v=i[h];var _=n[d];var g=n[f];var y=n[h];var b=l.computeBarycentricCoordinates(t,r,p,_,m,g,v,y,C);if(b.x>=-1e-15&&b.y>=-1e-15&&b.z>=-1e-15){var S=b.x*a[d]+b.y*a[f]+b.z*a[h];return c.lerp(e._minimumHeight,e._maximumHeight,S/w)}}return undefined}m.prototype.isChildAvailable=function(e,t,r,i){if(!a(e)){throw new s("thisX is required.")}if(!a(t)){throw new s("thisY is required.")}if(!a(r)){throw new s("childX is required.")}if(!a(i)){throw new s("childY is required.")}var n=2;if(r!==e*2){++n}if(i!==t*2){n-=2}return(this._childTileMask&1<<n)!==0};m.prototype.wasCreatedByUpsampling=function(){return this._createdByUpsampling};return m});define("Core/TileAvailability",["./binarySearch","./Cartographic","./defined","./defineProperties","./DeveloperError","./Rectangle"],function(e,t,r,i,n,a){"use strict";function o(e,t){this._tilingScheme=e;this._maximumLevel=t;this._rootNodes=[];for(var r=0;r<e.getNumberOfYTilesAtLevel();++r){for(var i=0;i<e.getNumberOfXTilesAtLevel();++i){this._rootNodes.push(new h(e,undefined,0,i,r))}}}var s=new a;o.prototype.addAvailableTileRange=function(e,t,r,i,n){var a=this._tilingScheme;a.tileXYToRectangle(t,r,e,s);var o=s.west;var u=s.north;a.tileXYToRectangle(i,n,e,s);var l=s.east;var c=s.south;var d=new p(e,o,c,l,u);for(var f=0;f<this._rootNodes.length;++f){var h=this._rootNodes[f];if(m(h.extent,d)){v(this._maximumLevel,h,d)}}};o.prototype.computeMaximumLevelAtPosition=function(e){var t;for(var i=0;i<this._rootNodes.length;++i){var a=this._rootNodes[i];if(y(a.extent,e)){t=a;break}}if(!r(t)){throw new n("The specified position does not exist in any root node of the tiling scheme.")}return w(undefined,t,e)};var u=[];var l=[];var c=new a;var d=new a;o.prototype.computeBestAvailableLevelOverRectangle=function(e){var t=u;t.length=0;if(e.east<e.west){t.push(a.fromRadians(-Math.PI,e.south,e.east,e.north,c));t.push(a.fromRadians(e.west,e.south,Math.PI,e.north,d))}else{t.push(e)}var i=l;i.length=0;var n;for(n=0;n<this._rootNodes.length;++n){C(i,this._rootNodes[n],t)}for(n=i.length-1;n>=0;--n){if(r(i[n])&&i[n].length===0){return n}}return 0};var f=new t;o.prototype.isTileAvailable=function(e,t,r){var i=this._tilingScheme.tileXYToRectangle(t,r,e,s);a.center(i,f);return this.computeMaximumLevelAtPosition(f)>=e};o.prototype.computeChildMaskForTile=function(e,t,r){var i=e+1;if(i>=this._maximumLevel){return 0}var n=0;n|=this.isTileAvailable(i,2*t,2*r+1)?1:0;n|=this.isTileAvailable(i,2*t+1,2*r+1)?2:0;n|=this.isTileAvailable(i,2*t,2*r)?4:0;n|=this.isTileAvailable(i,2*t+1,2*r)?8:0;return n};function h(e,t,r,i,n){this.tilingScheme=e;this.parent=t;this.level=r;this.x=i;this.y=n;this.extent=e.tileXYToRectangle(i,n,r);this.rectangles=[];this._sw=undefined;this._se=undefined;this._nw=undefined;this._ne=undefined}i(h.prototype,{nw:{get:function(){if(!this._nw){this._nw=new h(this.tilingScheme,this,this.level+1,this.x*2,this.y*2)}return this._nw}},ne:{get:function(){if(!this._ne){this._ne=new h(this.tilingScheme,this,this.level+1,this.x*2+1,this.y*2)}return this._ne}},sw:{get:function(){if(!this._sw){this._sw=new h(this.tilingScheme,this,this.level+1,this.x*2,this.y*2+1)}return this._sw}},se:{get:function(){if(!this._se){this._se=new h(this.tilingScheme,this,this.level+1,this.x*2+1,this.y*2+1)}return this._se}}});function p(e,t,r,i,n){this.level=e;this.west=t;this.south=r;this.east=i;this.north=n}function m(e,t){var r=Math.max(e.west,t.west);var i=Math.max(e.south,t.south);var n=Math.min(e.east,t.east);var a=Math.min(e.north,t.north);return i<a&&r<n}function v(t,r,i){while(r.level<t){if(g(r.nw.extent,i)){r=r.nw}else if(g(r.ne.extent,i)){r=r.ne}else if(g(r.sw.extent,i)){r=r.sw}else if(g(r.se.extent,i)){r=r.se}else{break}}if(r.rectangles.length===0||r.rectangles[r.rectangles.length-1].level<=i.level){r.rectangles.push(i)}else{var n=e(r.rectangles,i.level,_);if(n<=0){n=~n}r.rectangles.splice(n,0,i)}}function _(e,t){return e.level-t}function g(e,t){return t.west>=e.west&&t.east<=e.east&&t.south>=e.south&&t.north<=e.north}function y(e,t){return t.longitude>=e.west&&t.longitude<=e.east&&t.latitude>=e.south&&t.latitude<=e.north}function w(e,t,r){var i=0;while(true){var n=t._nw&&y(t._nw.extent,r);var a=t._ne&&y(t._ne.extent,r);var o=t._sw&&y(t._sw.extent,r);var s=t._se&&y(t._se.extent,r);if(n+a+o+s>1){if(n){i=Math.max(i,w(t,t._nw,r))}if(a){i=Math.max(i,w(t,t._ne,r))}if(o){i=Math.max(i,w(t,t._sw,r))}if(s){i=Math.max(i,w(t,t._se,r))}break}else if(n){t=t._nw}else if(a){t=t._ne}else if(o){t=t._sw}else if(s){t=t._se}else{break}}while(t!==e){var u=t.rectangles;for(var l=u.length-1;l>=0&&u[l].level>i;--l){var c=u[l];if(y(c,r)){i=c.level}}t=t.parent}return i}function C(e,t,r){if(!t){return}var i;var n=false;for(i=0;i<r.length;++i){n=n||m(t.extent,r[i])}if(!n){return}var a=t.rectangles;for(i=0;i<a.length;++i){var o=a[i];if(!e[o.level]){e[o.level]=r}e[o.level]=b(e[o.level],o)}C(e,t._nw,r);C(e,t._ne,r);C(e,t._sw,r);C(e,t._se,r)}function b(e,t){var r=[];for(var i=0;i<e.length;++i){var n=e[i];if(!m(n,t)){r.push(n)}else{if(n.west<t.west){r.push(new a(n.west,n.south,t.west,n.north))}if(n.east>t.east){r.push(new a(t.east,n.south,n.east,n.north))}if(n.south<t.south){r.push(new a(Math.max(t.west,n.west),n.south,Math.min(t.east,n.east),t.south))}if(n.north>t.north){r.push(new a(Math.max(t.west,n.west),t.north,Math.min(t.east,n.east),n.north))}}}return r}return o});define("Core/formatError",["./defined"],function(e){"use strict";function t(t){var r;var i=t.name;var n=t.message;if(e(i)&&e(n)){r=i+": "+n}else{r=t.toString()}var a=t.stack;if(e(a)){r+="\n"+a}return r}return t});define("Core/TileProviderError",["./defaultValue","./defined","./formatError"],function(e,t,r){"use strict";function i(t,r,i,n,a,o,s){this.provider=t;this.message=r;this.x=i;this.y=n;this.level=a;this.timesRetried=e(o,0);this.retry=false;this.error=s}i.handleError=function(e,n,a,o,s,u,l,c,d){var f=e;if(!t(e)){f=new i(n,o,s,u,l,0,d)}else{f.provider=n;f.message=o;f.x=s;f.y=u;f.level=l;f.retry=false;f.error=d;++f.timesRetried}if(a.numberOfListeners>0){a.raiseEvent(f)}else{console.log('An error occurred in "'+n.constructor.name+'": '+r(o))}if(f.retry&&t(c)){c()}return f};i.handleSuccess=function(e){if(t(e)){e.timesRetried=-1}};return i});define("Core/CesiumTerrainProvider",["../ThirdParty/Uri","../ThirdParty/when","./BoundingSphere","./Cartesian3","./Credit","./defaultValue","./defined","./defineProperties","./DeveloperError","./Event","./GeographicTilingScheme","./HeightmapTerrainData","./IndexDatatype","./joinUrls","./loadArrayBuffer","./loadJson","./Math","./OrientedBoundingBox","./QuantizedMeshTerrainData","./Request","./RequestScheduler","./RequestType","./TerrainProvider","./TileAvailability","./TileProviderError"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w,C,b,S,E){"use strict";function T(r){if(!o(r)||!o(r.url)){throw new u("options.url is required.")}this._url=r.url;this._proxy=r.proxy;this._tilingScheme=new c({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:1,ellipsoid:r.ellipsoid});this._heightmapWidth=65;this._levelZeroMaximumGeometricError=b.getEstimatedLevelZeroGeometricErrorForAHeightmap(this._tilingScheme.ellipsoid,this._heightmapWidth,this._tilingScheme.getNumberOfXTilesAtLevel(0));this._heightmapStructure=undefined;this._hasWaterMask=false;this._hasVertexNormals=false;this._requestVertexNormals=a(r.requestVertexNormals,false);this._littleEndianExtensionSize=true;this._requestWaterMask=a(r.requestWaterMask,false);this._errorEvent=new l;this._availability=undefined;var i=r.credit;if(typeof i==="string"){i=new n(i)}this._credit=i;this._ready=false;this._readyPromise=t.defer();var s=h(this._url,"layer.json");if(o(this._proxy)){s=this._proxy.getURL(s)}var d=this;var f;function p(t){var r;if(!t.format){r="The tile format is not specified in the layer.json file.";f=E.handleError(f,d,d._errorEvent,r,undefined,undefined,undefined,_);return}if(!t.tiles||t.tiles.length===0){r="The layer.json file does not specify any tile URL templates.";f=E.handleError(f,d,d._errorEvent,r,undefined,undefined,undefined,_);return}if(t.format==="heightmap-1.0"){d._heightmapStructure={heightScale:1/5,heightOffset:-1e3,elementsPerHeight:1,stride:1,elementMultiplier:256,isBigEndian:false,lowestEncodedHeight:0,highestEncodedHeight:256*256-1};d._hasWaterMask=true;d._requestWaterMask=true}else if(t.format.indexOf("quantized-mesh-1.")!==0){r='The tile format "'+t.format+'" is invalid or not supported.';f=E.handleError(f,d,d._errorEvent,r,undefined,undefined,undefined,_);return}d._tileUrlTemplates=t.tiles;for(var i=0;i<d._tileUrlTemplates.length;++i){var a=new e(d._tileUrlTemplates[i]);var s=new e(d._url);if(a.authority&&!s.authority){s.authority=a.authority;s.scheme=a.scheme}d._tileUrlTemplates[i]=h(s,a).toString().replace("{version}",t.version)}var u=t.available;if(o(u)){d._availability=new S(d._tilingScheme,u.length);for(var l=0;l<u.length;++l){var c=u[l];var p=d._tilingScheme.getNumberOfYTilesAtLevel(l);for(var m=0;m<c.length;++m){var v=c[m];d._availability.addAvailableTileRange(l,v.startX,p-v.endY-1,v.endX,p-v.startY-1)}}}if(!o(d._credit)&&o(t.attribution)&&t.attribution!==null){d._credit=new n(t.attribution)}if(o(t.extensions)&&t.extensions.indexOf("octvertexnormals")!==-1){d._hasVertexNormals=true}else if(o(t.extensions)&&t.extensions.indexOf("vertexnormals")!==-1){d._hasVertexNormals=true;d._littleEndianExtensionSize=false}if(o(t.extensions)&&t.extensions.indexOf("watermask")!==-1){d._hasWaterMask=true}d._ready=true;d._readyPromise.resolve(true)}function v(e){if(o(e)&&e.statusCode===404){p({tilejson:"2.1.0",format:"heightmap-1.0",version:"1.0.0",scheme:"tms",tiles:["{z}/{x}/{y}.terrain?v={version}"]});return}var t="An error occurred while accessing "+s+".";f=E.handleError(f,d,d._errorEvent,t,undefined,undefined,undefined,_)}function _(){var e=w.request(s,m);t(e,p,v)}_()}var x={OCT_VERTEX_NORMALS:1,WATER_MASK:2};function A(e){if(!o(e)||e.length===0){return{Accept:"application/vnd.quantized-mesh,application/octet-stream;q=0.9,*/*;q=0.01"}}else{var t=e.join("-");return{Accept:"application/vnd.quantized-mesh;extensions="+t+",application/octet-stream;q=0.9,*/*;q=0.01"}}}function P(e,t,r,i,n,a){var o=new Uint16Array(t,0,e._heightmapWidth*e._heightmapWidth);return new d({buffer:o,childTileMask:new Uint8Array(t,o.byteLength,1)[0],waterMask:new Uint8Array(t,o.byteLength+1,t.byteLength-o.byteLength-1),width:e._heightmapWidth,height:e._heightmapWidth,structure:e._heightmapStructure})}function D(e,t,n,a,o,s){var u=0;var l=3;var c=l+1;var d=Float64Array.BYTES_PER_ELEMENT*l;var h=Float64Array.BYTES_PER_ELEMENT*c;var p=3;var m=Uint16Array.BYTES_PER_ELEMENT*p;var y=3;var w=Uint16Array.BYTES_PER_ELEMENT;var C=w*y;var b=new DataView(t);var S=new i(b.getFloat64(u,true),b.getFloat64(u+8,true),b.getFloat64(u+16,true));u+=d;var E=b.getFloat32(u,true);u+=Float32Array.BYTES_PER_ELEMENT;var T=b.getFloat32(u,true);u+=Float32Array.BYTES_PER_ELEMENT;var A=new r(new i(b.getFloat64(u,true),b.getFloat64(u+8,true),b.getFloat64(u+16,true)),b.getFloat64(u+d,true));u+=h;var P=new i(b.getFloat64(u,true),b.getFloat64(u+8,true),b.getFloat64(u+16,true));u+=d;var D=b.getUint32(u,true);u+=Uint32Array.BYTES_PER_ELEMENT;var M=new Uint16Array(t,u,D*3);u+=D*m;if(D>64*1024){w=Uint32Array.BYTES_PER_ELEMENT;C=w*y}var I=M.subarray(0,D);var O=M.subarray(D,2*D);var R=M.subarray(D*2,3*D);var N;var L=0;var B=0;var F=0;function k(e){return e>>1^-(e&1)}for(N=0;N<D;++N){L+=k(I[N]);B+=k(O[N]);F+=k(R[N]);I[N]=L;O[N]=B;R[N]=F}if(u%w!==0){u+=w-u%w}var V=b.getUint32(u,true);u+=Uint32Array.BYTES_PER_ELEMENT;var z=f.createTypedArrayFromArrayBuffer(D,t,u,V*y);u+=V*C;var U=0;for(N=0;N<z.length;++N){var q=z[N];z[N]=U-q;if(q===0){++U}}var G=b.getUint32(u,true);u+=Uint32Array.BYTES_PER_ELEMENT;var H=f.createTypedArrayFromArrayBuffer(D,t,u,G);u+=G*w;var W=b.getUint32(u,true);u+=Uint32Array.BYTES_PER_ELEMENT;var j=f.createTypedArrayFromArrayBuffer(D,t,u,W);u+=W*w;var Y=b.getUint32(u,true);u+=Uint32Array.BYTES_PER_ELEMENT;var X=f.createTypedArrayFromArrayBuffer(D,t,u,Y);u+=Y*w;var Z=b.getUint32(u,true);u+=Uint32Array.BYTES_PER_ELEMENT;var K=f.createTypedArrayFromArrayBuffer(D,t,u,Z);u+=Z*w;var Q;var J;while(u<b.byteLength){var $=b.getUint8(u,true);u+=Uint8Array.BYTES_PER_ELEMENT;var ee=b.getUint32(u,e._littleEndianExtensionSize);u+=Uint32Array.BYTES_PER_ELEMENT;if($===x.OCT_VERTEX_NORMALS&&e._requestVertexNormals){Q=new Uint8Array(t,u,D*2)}else if($===x.WATER_MASK&&e._requestWaterMask){J=new Uint8Array(t,u,ee)}u+=ee}var te=e.getLevelMaximumGeometricError(n)*5;var re=e._tilingScheme.tileXYToRectangle(a,o,n);var ie;if(re.width<v.PI_OVER_TWO+v.EPSILON5){ie=_.fromRectangle(re,E,T,e._tilingScheme.ellipsoid)}return new g({center:S,minimumHeight:E,maximumHeight:T,boundingSphere:A,orientedBoundingBox:ie,horizonOcclusionPoint:P,quantizedVertices:M,encodedNormals:Q,indices:z,westIndices:H,southIndices:j,eastIndices:X,northIndices:K,westSkirtHeight:te,southSkirtHeight:te,eastSkirtHeight:te,northSkirtHeight:te,childTileMask:e.availability.computeChildMaskForTile(n,a,o),waterMask:J})}T.prototype.requestTileGeometry=function(e,r,i,n){if(!this._ready){throw new u("requestTileGeometry must not be called before the terrain provider is ready.")}var a=this._tileUrlTemplates;if(a.length===0){return undefined}var s=this._tilingScheme.getNumberOfYTilesAtLevel(i);var l=s-r-1;var c=a[(e+l+i)%a.length].replace("{z}",i).replace("{x}",e).replace("{y}",l);if(!/file:\/\/\//.test(c)&&/file:\/\//.test(c)){c=c.replace("file://","file:///")}var d=this._proxy;if(o(d)){c=d.getURL(c)}var f=[];if(this._requestVertexNormals&&this._hasVertexNormals){f.push(this._littleEndianExtensionSize?"octvertexnormals":"vertexnormals")}if(this._requestWaterMask&&this._hasWaterMask){f.push("watermask")}function h(e){return p(e,A(f))}if(!o(n)||n===false){n=new y({defer:true})}n.url=c;n.requestFunction=h;n.type=C.TERRAIN;var m=w.schedule(n);if(!o(m)){return undefined}var v=this;return t(m,function(t){if(o(v._heightmapStructure)){return P(v,t,i,e,r,l)}else{return D(v,t,i,e,r,l)}})};s(T.prototype,{errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){if(!this._ready){throw new u("credit must not be called before the terrain provider is ready.")}return this._credit}},tilingScheme:{get:function(){if(!this._ready){throw new u("tilingScheme must not be called before the terrain provider is ready.")}return this._tilingScheme}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},hasWaterMask:{get:function(){if(!this._ready){throw new u("hasWaterMask must not be called before the terrain provider is ready.")}return this._hasWaterMask&&this._requestWaterMask}},hasVertexNormals:{get:function(){if(!this._ready){throw new u("hasVertexNormals must not be called before the terrain provider is ready.")}return this._hasVertexNormals&&this._requestVertexNormals}},requestVertexNormals:{get:function(){return this._requestVertexNormals}},requestWaterMask:{get:function(){return this._requestWaterMask}},availability:{get:function(){if(!this._ready){throw new u("availability must not be called before the terrain provider is ready.")}return this._availability}}});T.prototype.getLevelMaximumGeometricError=function(e){return this._levelZeroMaximumGeometricError/(1<<e)};T.prototype.getTileDataAvailable=function(e,t,r){if(!o(this.availability)){return undefined}return this.availability.isTileAvailable(r,e,t)};return T});define("Core/EllipseGeometryLibrary",["./Cartesian3","./Math","./Matrix3","./Quaternion"],function(e,t,r,i){"use strict";var n={};var a=new e;var o=new e;var s=new i;var u=new r;function l(t,n,l,c,d,f,h,p,m,v){var _=t+n;e.multiplyByScalar(c,Math.cos(_),a);e.multiplyByScalar(l,Math.sin(_),o);e.add(a,o,a);var g=Math.cos(t);g=g*g;var y=Math.sin(t);y=y*y;var w=f/Math.sqrt(h*g+d*y);var C=w/p;i.fromAxisAngle(a,C,s);r.fromQuaternion(s,u);r.multiplyByVector(u,m,v);e.normalize(v,v);e.multiplyByScalar(v,p,v);return v}var c=new e;var d=new e;var f=new e;var h=new e;n.raisePositionsToHeight=function(t,r,i){var n=r.ellipsoid;var a=r.height;var o=r.extrudedHeight;var s=i?t.length/3*2:t.length/3;var u=new Float64Array(s*3);var l=t.length;var p=i?l:0;for(var m=0;m<l;m+=3){var v=m+1;var _=m+2;var g=e.fromArray(t,m,c);n.scaleToGeodeticSurface(g,g);var y=e.clone(g,d);var w=n.geodeticSurfaceNormal(g,h);var C=e.multiplyByScalar(w,a,f);e.add(g,C,g);if(i){e.multiplyByScalar(w,o,C);e.add(y,C,y);u[m+p]=y.x;u[v+p]=y.y;u[_+p]=y.z}u[m]=g.x;u[v]=g.y;u[_]=g.z}return u};var p=new e;var m=new e;var v=new e;n.computeEllipsePositions=function(r,i,n){var a=r.semiMinorAxis;var o=r.semiMajorAxis;var s=r.rotation;var u=r.center;var h=r.granularity*8;var _=a*a;var g=o*o;var y=o*a;var w=e.magnitude(u);var C=e.normalize(u,p);var b=e.cross(e.UNIT_Z,u,m);b=e.normalize(b,b);var S=e.cross(C,b,v);var E=1+Math.ceil(t.PI_OVER_TWO/h);var T=t.PI_OVER_TWO/(E-1);var x=t.PI_OVER_TWO-E*T;if(x<0){E-=Math.ceil(Math.abs(x)/T)}var A=2*(E*(E+2));var P=i?new Array(A*3):undefined;var D=0;var M=c;var I=d;var O=E*4*3;var R=O-1;var N=0;var L=n?new Array(O):undefined;var B;var F;var k;var V;var z;x=t.PI_OVER_TWO;M=l(x,s,S,b,_,y,g,w,C,M);if(i){P[D++]=M.x;P[D++]=M.y;P[D++]=M.z}if(n){L[R--]=M.z;L[R--]=M.y;L[R--]=M.x}x=t.PI_OVER_TWO-T;for(B=1;B<E+1;++B){M=l(x,s,S,b,_,y,g,w,C,M);I=l(Math.PI-x,s,S,b,_,y,g,w,C,I);if(i){P[D++]=M.x;P[D++]=M.y;P[D++]=M.z;k=2*B+2;for(F=1;F<k-1;++F){V=F/(k-1);z=e.lerp(M,I,V,f);P[D++]=z.x;P[D++]=z.y;P[D++]=z.z}P[D++]=I.x;P[D++]=I.y;P[D++]=I.z}if(n){L[R--]=M.z;L[R--]=M.y;L[R--]=M.x;L[N++]=I.x;L[N++]=I.y;L[N++]=I.z}x=t.PI_OVER_TWO-(B+1)*T}for(B=E;B>1;--B){x=t.PI_OVER_TWO-(B-1)*T;M=l(-x,s,S,b,_,y,g,w,C,M);I=l(x+Math.PI,s,S,b,_,y,g,w,C,I);if(i){P[D++]=M.x;P[D++]=M.y;P[D++]=M.z;k=2*(B-1)+2;for(F=1;F<k-1;++F){V=F/(k-1);z=e.lerp(M,I,V,f);P[D++]=z.x;P[D++]=z.y;P[D++]=z.z}P[D++]=I.x;P[D++]=I.y;P[D++]=I.z}if(n){L[R--]=M.z;L[R--]=M.y;L[R--]=M.x;L[N++]=I.x;L[N++]=I.y;L[N++]=I.z}}x=t.PI_OVER_TWO;M=l(-x,s,S,b,_,y,g,w,C,M);var U={};if(i){P[D++]=M.x;P[D++]=M.y;P[D++]=M.z;U.positions=P;U.numPts=E}if(n){L[R--]=M.z;L[R--]=M.y;L[R--]=M.x;U.outerPositions=L}return U};return n});define("Core/GeometryInstance",["./defaultValue","./defined","./DeveloperError","./Matrix4"],function(e,t,r,i){"use strict";function n(n){n=e(n,e.EMPTY_OBJECT);if(!t(n.geometry)){throw new r("options.geometry is required.")}this.geometry=n.geometry;this.modelMatrix=i.clone(e(n.modelMatrix,i.IDENTITY));this.id=n.id;this.pickPrimitive=n.pickPrimitive;this.attributes=e(n.attributes,{});this.westHemisphereGeometry=undefined;this.eastHemisphereGeometry=undefined}return n})
;define("Core/EncodedCartesian3",["./Cartesian3","./defined","./DeveloperError"],function(e,t,r){"use strict";function i(){this.high=e.clone(e.ZERO);this.low=e.clone(e.ZERO)}i.encode=function(e,i){if(!t(e)){throw new r("value is required")}if(!t(i)){i={high:0,low:0}}var n;if(e>=0){n=Math.floor(e/65536)*65536;i.high=n;i.low=e-n}else{n=Math.floor(-e/65536)*65536;i.high=-n;i.low=e+n}return i};var n={high:0,low:0};i.fromCartesian=function(e,a){if(!t(e)){throw new r("cartesian is required")}if(!t(a)){a=new i}var o=a.high;var s=a.low;i.encode(e.x,n);o.x=n.high;s.x=n.low;i.encode(e.y,n);o.y=n.high;s.y=n.low;i.encode(e.z,n);o.z=n.high;s.z=n.low;return a};var a=new i;i.writeElements=function(e,n,o){if(!t(e)){throw new r("cartesian is required")}if(!t(n)){throw new r("cartesianArray is required")}if(typeof o!=="number"||o<0){throw new r("index must be a number greater than or equal to 0.")}i.fromCartesian(e,a);var s=a.high;var u=a.low;n[o]=s.x;n[o+1]=s.y;n[o+2]=s.z;n[o+3]=u.x;n[o+4]=u.y;n[o+5]=u.z};return i});define("Core/Tipsify",["./defaultValue","./defined","./DeveloperError"],function(e,t,r){"use strict";var i={};i.calculateACMR=function(i){i=e(i,e.EMPTY_OBJECT);var n=i.indices;var a=i.maximumIndex;var o=e(i.cacheSize,24);if(!t(n)){throw new r("indices is required.")}var s=n.length;if(s<3||s%3!==0){throw new r("indices length must be a multiple of three.")}if(a<=0){throw new r("maximumIndex must be greater than zero.")}if(o<3){throw new r("cacheSize must be greater than two.")}if(!t(a)){a=0;var u=0;var l=n[u];while(u<s){if(l>a){a=l}++u;l=n[u]}}var c=[];for(var d=0;d<a+1;d++){c[d]=0}var f=o+1;for(var h=0;h<s;++h){if(f-c[n[h]]>o){c[n[h]]=f;++f}}return(f-o+1)/(s/3)};i.tipsify=function(i){i=e(i,e.EMPTY_OBJECT);var n=i.indices;var a=i.maximumIndex;var o=e(i.cacheSize,24);var s;function u(e,t,r,i){while(t.length>=1){var n=t[t.length-1];t.splice(t.length-1,1);if(e[n].numLiveTriangles>0){return n}}while(s<i){if(e[s].numLiveTriangles>0){++s;return s-1}++s}return-1}function l(e,t,r,i,n,a,o){var s=-1;var l;var c=-1;var d=0;while(d<r.length){var f=r[d];if(i[f].numLiveTriangles){l=0;if(n-i[f].timeStamp+2*i[f].numLiveTriangles<=t){l=n-i[f].timeStamp}if(l>c||c===-1){c=l;s=f}}++d}if(s===-1){return u(i,a,e,o)}return s}if(!t(n)){throw new r("indices is required.")}var c=n.length;if(c<3||c%3!==0){throw new r("indices length must be a multiple of three.")}if(a<=0){throw new r("maximumIndex must be greater than zero.")}if(o<3){throw new r("cacheSize must be greater than two.")}var d=0;var f=0;var h=n[f];var p=c;if(t(a)){d=a+1}else{while(f<p){if(h>d){d=h}++f;h=n[f]}if(d===-1){return 0}++d}var m=[];for(var v=0;v<d;v++){m[v]={numLiveTriangles:0,timeStamp:0,vertexTriangles:[]}}f=0;var _=0;while(f<p){m[n[f]].vertexTriangles.push(_);++m[n[f]].numLiveTriangles;m[n[f+1]].vertexTriangles.push(_);++m[n[f+1]].numLiveTriangles;m[n[f+2]].vertexTriangles.push(_);++m[n[f+2]].numLiveTriangles;++_;f+=3}var g=0;var y=o+1;s=1;var w=[];var C=[];var b;var S;var E=0;var T=[];var x=c/3;var A=[];for(v=0;v<x;v++){A[v]=false}var P;var D;while(g!==-1){w=[];S=m[g];D=S.vertexTriangles.length;for(var M=0;M<D;++M){_=S.vertexTriangles[M];if(!A[_]){A[_]=true;f=_+_+_;for(var I=0;I<3;++I){P=n[f];w.push(P);C.push(P);T[E]=P;++E;b=m[P];--b.numLiveTriangles;if(y-b.timeStamp>o){b.timeStamp=y;++y}++f}}}g=l(n,o,w,m,y,C,d)}return T};return i});define("Core/GeometryPipeline",["./AttributeCompression","./barycentricCoordinates","./BoundingSphere","./Cartesian2","./Cartesian3","./Cartesian4","./Cartographic","./ComponentDatatype","./defaultValue","./defined","./deprecationWarning","./DeveloperError","./EncodedCartesian3","./GeographicProjection","./Geometry","./GeometryAttribute","./GeometryType","./IndexDatatype","./Intersect","./IntersectionTests","./Math","./Matrix3","./Matrix4","./Plane","./PrimitiveType","./Tipsify"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w,C,b,S,E,T){"use strict";var x={};function A(e,t,r,i,n){e[t++]=r;e[t++]=i;e[t++]=i;e[t++]=n;e[t++]=n;e[t]=r}function P(e){var t=e.length;var r=t/3*6;var i=_.createTypedArray(t,r);var n=0;for(var a=0;a<t;a+=3,n+=6){A(i,n,e[a],e[a+1],e[a+2])}return i}function D(e){var t=e.length;if(t>=3){var r=(t-2)*6;var i=_.createTypedArray(t,r);A(i,0,e[0],e[1],e[2]);var n=6;for(var a=3;a<t;++a,n+=6){A(i,n,e[a-1],e[a],e[a-2])}return i}return new Uint16Array}function M(e){if(e.length>0){var t=e.length-1;var r=(t-1)*6;var i=_.createTypedArray(t,r);var n=e[0];var a=0;for(var o=1;o<t;++o,a+=6){A(i,a,n,e[o],e[o+1])}return i}return new Uint16Array}x.toWireframe=function(e){if(!l(e)){throw new d("geometry is required.")}var t=e.indices;if(l(t)){switch(e.primitiveType){case E.TRIANGLES:e.indices=P(t);break;case E.TRIANGLE_STRIP:e.indices=D(t);break;case E.TRIANGLE_FAN:e.indices=M(t);break;default:throw new d("geometry.primitiveType must be TRIANGLES, TRIANGLE_STRIP, or TRIANGLE_FAN.")}e.primitiveType=E.LINES}return e};x.createLineSegmentsForVectors=function(e,t,i){t=u(t,"normal");if(!l(e)){throw new d("geometry is required.")}if(!l(e.attributes.position)){throw new d("geometry.attributes.position is required.")}if(!l(e.attributes[t])){throw new d("geometry.attributes must have an attribute with the same name as the attributeName parameter, "+t+".")}i=u(i,1e4);var n=e.attributes.position.values;var a=e.attributes[t].values;var o=n.length;var c=new Float64Array(2*o);var f=0;for(var h=0;h<o;h+=3){c[f++]=n[h];c[f++]=n[h+1];c[f++]=n[h+2];c[f++]=n[h]+a[h]*i;c[f++]=n[h+1]+a[h+1]*i;c[f++]=n[h+2]+a[h+2]*i}var v;var _=e.boundingSphere;if(l(_)){v=new r(_.center,_.radius+i)}return new p({attributes:{position:new m({componentDatatype:s.DOUBLE,componentsPerAttribute:3,values:c})},primitiveType:E.LINES,boundingSphere:v})};x.createAttributeLocations=function(e){if(!l(e)){throw new d("geometry is required.")}var t=["position","positionHigh","positionLow","position3DHigh","position3DLow","position2DHigh","position2DLow","pickColor","normal","st","tangent","bitangent","extrudeDirection","compressedAttributes"];var r=e.attributes;var i={};var n=0;var a;var o=t.length;for(a=0;a<o;++a){var s=t[a];if(l(r[s])){i[s]=n++}}for(var u in r){if(r.hasOwnProperty(u)&&!l(i[u])){i[u]=n++}}return i};x.reorderForPreVertexCache=function(e){if(!l(e)){throw new d("geometry is required.")}var t=p.computeNumberOfVertices(e);var r=e.indices;if(l(r)){var i=new Int32Array(t);for(var n=0;n<t;n++){i[n]=-1}var a=r;var o=a.length;var u=_.createTypedArray(t,o);var c=0;var f=0;var h=0;var m;while(c<o){m=i[a[c]];if(m!==-1){u[f]=m}else{m=a[c];i[m]=h;u[f]=h;++h}++c;++f}e.indices=u;var v=e.attributes;for(var g in v){if(v.hasOwnProperty(g)&&l(v[g])&&l(v[g].values)){var y=v[g];var w=y.values;var C=0;var b=y.componentsPerAttribute;var S=s.createTypedArray(y.componentDatatype,h*b);while(C<t){var E=i[C];if(E!==-1){for(n=0;n<b;n++){S[b*E+n]=w[b*C+n]}}++C}y.values=S}}}return e};x.reorderForPostVertexCache=function(e,t){if(!l(e)){throw new d("geometry is required.")}var r=e.indices;if(e.primitiveType===E.TRIANGLES&&l(r)){var i=r.length;var n=0;for(var a=0;a<i;a++){if(r[a]>n){n=r[a]}}e.indices=T.tipsify({indices:r,maximumIndex:n,cacheSize:t})}return e};function I(e){var t={};for(var r in e){if(e.hasOwnProperty(r)&&l(e[r])&&l(e[r].values)){var i=e[r];t[r]=new m({componentDatatype:i.componentDatatype,componentsPerAttribute:i.componentsPerAttribute,normalize:i.normalize,values:[]})}}return t}function O(e,t,r){for(var i in t){if(t.hasOwnProperty(i)&&l(t[i])&&l(t[i].values)){var n=t[i];for(var a=0;a<n.componentsPerAttribute;++a){e[i].values.push(n.values[r*n.componentsPerAttribute+a])}}}}x.fitToUnsignedShortIndices=function(e){if(!l(e)){throw new d("geometry is required.")}if(l(e.indices)&&(e.primitiveType!==E.TRIANGLES&&e.primitiveType!==E.LINES&&e.primitiveType!==E.POINTS)){throw new d("geometry.primitiveType must equal to PrimitiveType.TRIANGLES, PrimitiveType.LINES, or PrimitiveType.POINTS.")}var t=[];var r=p.computeNumberOfVertices(e);if(l(e.indices)&&r>=w.SIXTY_FOUR_KILOBYTES){var i=[];var n=[];var a=0;var o=I(e.attributes);var s=e.indices;var u=s.length;var c;if(e.primitiveType===E.TRIANGLES){c=3}else if(e.primitiveType===E.LINES){c=2}else if(e.primitiveType===E.POINTS){c=1}for(var f=0;f<u;f+=c){for(var h=0;h<c;++h){var m=s[f+h];var v=i[m];if(!l(v)){v=a++;i[m]=v;O(o,e.attributes,m)}n.push(v)}if(a+c>=w.SIXTY_FOUR_KILOBYTES){t.push(new p({attributes:o,indices:n,primitiveType:e.primitiveType,boundingSphere:e.boundingSphere,boundingSphereCV:e.boundingSphereCV}));i=[];n=[];a=0;o=I(e.attributes)}}if(n.length!==0){t.push(new p({attributes:o,indices:n,primitiveType:e.primitiveType,boundingSphere:e.boundingSphere,boundingSphereCV:e.boundingSphereCV}))}}else{t.push(e)}return t};var R=new n;var N=new o;x.projectTo2D=function(e,t,r,i,a){if(!l(e)){throw new d("geometry is required.")}if(!l(t)){throw new d("attributeName is required.")}if(!l(r)){throw new d("attributeName3D is required.")}if(!l(i)){throw new d("attributeName2D is required.")}if(!l(e.attributes[t])){throw new d("geometry must have attribute matching the attributeName argument: "+t+".")}if(e.attributes[t].componentDatatype!==s.DOUBLE){throw new d("The attribute componentDatatype must be ComponentDatatype.DOUBLE.")}var o=e.attributes[t];a=l(a)?a:new h;var u=a.ellipsoid;var c=o.values;var f=new Float64Array(c.length);var p=0;for(var v=0;v<c.length;v+=3){var _=n.fromArray(c,v,R);var g=u.cartesianToCartographic(_,N);if(!l(g)){throw new d("Could not project point ("+_.x+", "+_.y+", "+_.z+") to 2D.")}var y=a.project(g,R);f[p++]=y.x;f[p++]=y.y;f[p++]=y.z}e.attributes[r]=o;e.attributes[i]=new m({componentDatatype:s.DOUBLE,componentsPerAttribute:3,values:f});delete e.attributes[t];return e};var L={high:0,low:0};x.encodeAttribute=function(e,t,r,i){if(!l(e)){throw new d("geometry is required.")}if(!l(t)){throw new d("attributeName is required.")}if(!l(r)){throw new d("attributeHighName is required.")}if(!l(i)){throw new d("attributeLowName is required.")}if(!l(e.attributes[t])){throw new d("geometry must have attribute matching the attributeName argument: "+t+".")}if(e.attributes[t].componentDatatype!==s.DOUBLE){throw new d("The attribute componentDatatype must be ComponentDatatype.DOUBLE.")}var n=e.attributes[t];var a=n.values;var o=a.length;var u=new Float32Array(o);var c=new Float32Array(o);for(var h=0;h<o;++h){f.encode(a[h],L);u[h]=L.high;c[h]=L.low}var p=n.componentsPerAttribute;e.attributes[r]=new m({componentDatatype:s.FLOAT,componentsPerAttribute:p,values:u});e.attributes[i]=new m({componentDatatype:s.FLOAT,componentsPerAttribute:p,values:c});delete e.attributes[t];return e};var B=new n;function F(e,t){if(l(t)){var r=t.values;var i=r.length;for(var a=0;a<i;a+=3){n.unpack(r,a,B);b.multiplyByPoint(e,B,B);n.pack(B,r,a)}}}function k(e,t){if(l(t)){var r=t.values;var i=r.length;for(var a=0;a<i;a+=3){n.unpack(r,a,B);C.multiplyByVector(e,B,B);B=n.normalize(B,B);n.pack(B,r,a)}}}var V=new b;var z=new C;x.transformToWorldCoordinates=function(e){if(!l(e)){throw new d("instance is required.")}var t=e.modelMatrix;if(b.equals(t,b.IDENTITY)){return e}var i=e.geometry.attributes;F(t,i.position);F(t,i.prevPosition);F(t,i.nextPosition);if(l(i.normal)||l(i.tangent)||l(i.bitangent)){b.inverse(t,V);b.transpose(V,V);b.getRotation(V,z);k(z,i.normal);k(z,i.tangent);k(z,i.bitangent)}var n=e.geometry.boundingSphere;if(l(n)){e.geometry.boundingSphere=r.transform(n,t,n)}e.modelMatrix=b.clone(b.IDENTITY);return e};function U(e,t){var r=e.length;var i={};var n=e[0][t].attributes;var a;for(a in n){if(n.hasOwnProperty(a)&&l(n[a])&&l(n[a].values)){var o=n[a];var u=o.values.length;var c=true;for(var d=1;d<r;++d){var f=e[d][t].attributes[a];if(!l(f)||o.componentDatatype!==f.componentDatatype||o.componentsPerAttribute!==f.componentsPerAttribute||o.normalize!==f.normalize){c=false;break}u+=f.values.length}if(c){i[a]=new m({componentDatatype:o.componentDatatype,componentsPerAttribute:o.componentsPerAttribute,normalize:o.normalize,values:s.createTypedArray(o.componentDatatype,u)})}}}return i}var q=new n;function G(e,t){var i=e.length;var a;var o;var s;var u;var c=e[0].modelMatrix;var f=l(e[0][t].indices);var h=e[0][t].primitiveType;for(o=1;o<i;++o){if(!b.equals(e[o].modelMatrix,c)){throw new d("All instances must have the same modelMatrix.")}if(l(e[o][t].indices)!==f){throw new d("All instance geometries must have an indices or not have one.")}if(e[o][t].primitiveType!==h){throw new d("All instance geometries must have the same primitiveType.")}}var m=U(e,t);var v;var g;var y;for(a in m){if(m.hasOwnProperty(a)){v=m[a].values;u=0;for(o=0;o<i;++o){g=e[o][t].attributes[a].values;y=g.length;for(s=0;s<y;++s){v[u++]=g[s]}}}}var w;if(f){var C=0;for(o=0;o<i;++o){C+=e[o][t].indices.length}var S=p.computeNumberOfVertices(new p({attributes:m,primitiveType:E.POINTS}));var T=_.createTypedArray(S,C);var x=0;var A=0;for(o=0;o<i;++o){var P=e[o][t].indices;var D=P.length;for(u=0;u<D;++u){T[x++]=A+P[u]}A+=p.computeNumberOfVertices(e[o][t])}w=T}var M=new n;var I=0;var O;for(o=0;o<i;++o){O=e[o][t].boundingSphere;if(!l(O)){M=undefined;break}n.add(O.center,M,M)}if(l(M)){n.divideByScalar(M,i,M);for(o=0;o<i;++o){O=e[o][t].boundingSphere;var R=n.magnitude(n.subtract(O.center,M,q))+O.radius;if(R>I){I=R}}}return new p({attributes:m,indices:w,primitiveType:h,boundingSphere:l(M)?new r(M,I):undefined})}x.combineInstances=function(e){if(!l(e)||e.length<1){throw new d("instances is required and must have length greater than zero.")}var t=[];var r=[];var i=e.length;for(var n=0;n<i;++n){var a=e[n];if(l(a.geometry)){t.push(a)}else if(l(a.westHemisphereGeometry)&&l(a.eastHemisphereGeometry)){r.push(a)}}var o=[];if(t.length>0){o.push(G(t,"geometry"))}if(r.length>0){o.push(G(r,"westHemisphereGeometry"));o.push(G(r,"eastHemisphereGeometry"))}return o};var H=new n;var W=new n;var j=new n;var Y=new n;x.computeNormal=function(e){if(!l(e)){throw new d("geometry is required.")}if(!l(e.attributes.position)||!l(e.attributes.position.values)){throw new d("geometry.attributes.position.values is required.")}if(!l(e.indices)){throw new d("geometry.indices is required.")}if(e.indices.length<2||e.indices.length%3!==0){throw new d("geometry.indices length must be greater than 0 and be a multiple of 3.")}if(e.primitiveType!==E.TRIANGLES){throw new d("geometry.primitiveType must be PrimitiveType.TRIANGLES.")}var t=e.indices;var r=e.attributes;var i=r.position.values;var a=r.position.values.length/3;var o=t.length;var u=new Array(a);var c=new Array(o/3);var f=new Array(o);for(var h=0;h<a;h++){u[h]={indexOffset:0,count:0,currentCount:0}}var p=0;for(h=0;h<o;h+=3){var v=t[h];var _=t[h+1];var g=t[h+2];var y=v*3;var w=_*3;var C=g*3;W.x=i[y];W.y=i[y+1];W.z=i[y+2];j.x=i[w];j.y=i[w+1];j.z=i[w+2];Y.x=i[C];Y.y=i[C+1];Y.z=i[C+2];u[v].count++;u[_].count++;u[g].count++;n.subtract(j,W,j);n.subtract(Y,W,Y);c[p]=n.cross(j,Y,new n);p++}var b=0;for(h=0;h<a;h++){u[h].indexOffset+=b;b+=u[h].count}p=0;var S;for(h=0;h<o;h+=3){S=u[t[h]];var T=S.indexOffset+S.currentCount;f[T]=p;S.currentCount++;S=u[t[h+1]];T=S.indexOffset+S.currentCount;f[T]=p;S.currentCount++;S=u[t[h+2]];T=S.indexOffset+S.currentCount;f[T]=p;S.currentCount++;p++}var x=new Float32Array(a*3);for(h=0;h<a;h++){var A=h*3;S=u[h];if(S.count>0){n.clone(n.ZERO,H);for(p=0;p<S.count;p++){n.add(H,c[f[S.indexOffset+p]],H)}n.normalize(H,H);x[A]=H.x;x[A+1]=H.y;x[A+2]=H.z}else{x[A]=0;x[A+1]=0;x[A+2]=1}}e.attributes.normal=new m({componentDatatype:s.FLOAT,componentsPerAttribute:3,values:x});return e};var X=new n;var Z=new n;var K=new n;x.computeTangentAndBitangent=function(e){if(!l(e)){throw new d("geometry is required.")}var t=e.attributes;var r=e.indices;if(!l(t.position)||!l(t.position.values)){throw new d("geometry.attributes.position.values is required.")}if(!l(t.normal)||!l(t.normal.values)){throw new d("geometry.attributes.normal.values is required.")}if(!l(t.st)||!l(t.st.values)){throw new d("geometry.attributes.st.values is required.")}if(!l(r)){throw new d("geometry.indices is required.")}if(r.length<2||r.length%3!==0){throw new d("geometry.indices length must be greater than 0 and be a multiple of 3.")}if(e.primitiveType!==E.TRIANGLES){throw new d("geometry.primitiveType must be PrimitiveType.TRIANGLES.")}var i=e.attributes.position.values;var a=e.attributes.normal.values;var o=e.attributes.st.values;var u=e.attributes.position.values.length/3;var c=r.length;var f=new Array(u*3);for(var h=0;h<f.length;h++){f[h]=0}var p;var v;var _;for(h=0;h<c;h+=3){var g=r[h];var y=r[h+1];var w=r[h+2];p=g*3;v=y*3;_=w*3;var C=g*2;var b=y*2;var S=w*2;var T=i[p];var x=i[p+1];var A=i[p+2];var P=o[C];var D=o[C+1];var M=o[b+1]-D;var I=o[S+1]-D;var O=1/((o[b]-P)*I-(o[S]-P)*M);var R=(I*(i[v]-T)-M*(i[_]-T))*O;var N=(I*(i[v+1]-x)-M*(i[_+1]-x))*O;var L=(I*(i[v+2]-A)-M*(i[_+2]-A))*O;f[p]+=R;f[p+1]+=N;f[p+2]+=L;f[v]+=R;f[v+1]+=N;f[v+2]+=L;f[_]+=R;f[_+1]+=N;f[_+2]+=L}var B=new Float32Array(u*3);var F=new Float32Array(u*3);for(h=0;h<u;h++){p=h*3;v=p+1;_=p+2;var k=n.fromArray(a,p,X);var V=n.fromArray(f,p,K);var z=n.dot(k,V);n.multiplyByScalar(k,z,Z);n.normalize(n.subtract(V,Z,V),V);B[p]=V.x;B[v]=V.y;B[_]=V.z;n.normalize(n.cross(k,V,V),V);F[p]=V.x;F[v]=V.y;F[_]=V.z}e.attributes.tangent=new m({componentDatatype:s.FLOAT,componentsPerAttribute:3,values:B});e.attributes.bitangent=new m({componentDatatype:s.FLOAT,componentsPerAttribute:3,values:F});return e};x.computeBinormalAndTangent=function(e){c("computeBinormalAndTangent","computeBinormalAndTangent was deprecated in 1.30.  It will be removed in 1.31.  Use a computeTangentAndBitangent.");x.computeTangentAndBitangent(e);e.attributes.binormal=e.attributes.bitangent;return e};var Q=new i;var J=new n;var $=new n;var ee=new n;var te=new i;x.compressVertices=function(t){if(!l(t)){throw new d("geometry is required.")}var r=t.attributes.extrudeDirection;var a;var o;if(l(r)){var u=r.values;o=u.length/3;var c=new Float32Array(o*2);var f=0;for(a=0;a<o;++a){n.fromArray(u,a*3,J);if(n.equals(J,n.ZERO)){f+=2;continue}te=e.octEncodeInRange(J,65535,te);c[f++]=te.x;c[f++]=te.y}t.attributes.compressedAttributes=new m({componentDatatype:s.FLOAT,componentsPerAttribute:2,values:c});delete t.attributes.extrudeDirection;return t}var h=t.attributes.normal;var p=t.attributes.st;var v=l(h);var _=l(p);if(!v&&!_){return t}var g=t.attributes.tangent;var y=t.attributes.bitangent;var w=l(g);var C=l(y);var b;var S;var E;var T;if(v){b=h.values}if(_){S=p.values}if(w){E=g.values}if(C){T=y.values}var x=v?b.length:S.length;var A=v?3:2;o=x/A;var P=o;var D=_&&v?2:1;D+=w||C?1:0;P*=D;var M=new Float32Array(P);var I=0;for(a=0;a<o;++a){if(_){i.fromArray(S,a*2,Q);M[I++]=e.compressTextureCoordinates(Q)}var O=a*3;if(v&&l(E)&&l(T)){n.fromArray(b,O,J);n.fromArray(E,O,$);n.fromArray(T,O,ee);e.octPack(J,$,ee,Q);M[I++]=Q.x;M[I++]=Q.y}else{if(v){n.fromArray(b,O,J);M[I++]=e.octEncodeFloat(J)}if(w){n.fromArray(E,O,J);M[I++]=e.octEncodeFloat(J)}if(C){n.fromArray(T,O,J);M[I++]=e.octEncodeFloat(J)}}}t.attributes.compressedAttributes=new m({componentDatatype:s.FLOAT,componentsPerAttribute:D,values:M});if(v){delete t.attributes.normal}if(_){delete t.attributes.st}if(C){delete t.attributes.bitangent}if(w){delete t.attributes.tangent}return t};function re(e){if(l(e.indices)){return e}var t=p.computeNumberOfVertices(e);if(t<3){throw new d("The number of vertices must be at least three.")}if(t%3!==0){throw new d("The number of vertices must be a multiple of three.")}var r=_.createTypedArray(t,t);for(var i=0;i<t;++i){r[i]=i}e.indices=r;return e}function ie(e){var t=p.computeNumberOfVertices(e);if(t<3){throw new d("The number of vertices must be at least three.")}var r=_.createTypedArray(t,(t-2)*3);r[0]=1;r[1]=0;r[2]=2;var i=3;for(var n=3;n<t;++n){r[i++]=n-1;r[i++]=0;r[i++]=n}e.indices=r;e.primitiveType=E.TRIANGLES;return e}function ne(e){var t=p.computeNumberOfVertices(e);if(t<3){throw new d("The number of vertices must be at least 3.")}var r=_.createTypedArray(t,(t-2)*3);r[0]=0;r[1]=1;r[2]=2;if(t>3){r[3]=0;r[4]=2;r[5]=3}var i=6;for(var n=3;n<t-1;n+=2){r[i++]=n;r[i++]=n-1;r[i++]=n+1;if(n+2<t){r[i++]=n;r[i++]=n+1;r[i++]=n+2}}e.indices=r;e.primitiveType=E.TRIANGLES;return e}function ae(e){if(l(e.indices)){return e}var t=p.computeNumberOfVertices(e);if(t<2){throw new d("The number of vertices must be at least two.")}if(t%2!==0){throw new d("The number of vertices must be a multiple of 2.")}var r=_.createTypedArray(t,t);for(var i=0;i<t;++i){r[i]=i}e.indices=r;return e}function oe(e){var t=p.computeNumberOfVertices(e);if(t<2){throw new d("The number of vertices must be at least two.")}var r=_.createTypedArray(t,(t-1)*2);r[0]=0;r[1]=1;var i=2;for(var n=2;n<t;++n){r[i++]=n-1;r[i++]=n}e.indices=r;e.primitiveType=E.LINES;return e}function se(e){var t=p.computeNumberOfVertices(e);if(t<2){throw new d("The number of vertices must be at least two.")}var r=_.createTypedArray(t,t*2);r[0]=0;r[1]=1;var i=2;for(var n=2;n<t;++n){r[i++]=n-1;r[i++]=n}r[i++]=t-1;r[i]=0;e.indices=r;e.primitiveType=E.LINES;return e}function ue(e){switch(e.primitiveType){case E.TRIANGLE_FAN:return ie(e);case E.TRIANGLE_STRIP:return ne(e);case E.TRIANGLES:return re(e);case E.LINE_STRIP:return oe(e);case E.LINE_LOOP:return se(e);case E.LINES:return ae(e)}return e}function le(e,t){if(Math.abs(e.y)<w.EPSILON6){if(t){e.y=-w.EPSILON6}else{e.y=w.EPSILON6}}}function ce(e,t,r){if(e.y!==0&&t.y!==0&&r.y!==0){le(e,e.y<0);le(t,t.y<0);le(r,r.y<0);return}var i=Math.abs(e.y);var n=Math.abs(t.y);var a=Math.abs(r.y);var o;if(i>n){if(i>a){o=w.sign(e.y)}else{o=w.sign(r.y)}}else if(n>a){o=w.sign(t.y)}else{o=w.sign(r.y)}var s=o<0;le(e,s);le(t,s);le(r,s)}var de=new n;function fe(e,t,r,i){n.add(e,n.multiplyByScalar(n.subtract(t,e,de),e.y/(e.y-t.y),de),r);n.clone(r,i);le(r,true);le(i,false)}var he=new n;var pe=new n;var me=new n;var ve=new n;var _e={positions:new Array(7),indices:new Array(3*3)};function ge(e,t,r){if(e.x>=0||t.x>=0||r.x>=0){return undefined}ce(e,t,r);var i=e.y<0;var n=t.y<0;var a=r.y<0;var o=0;o+=i?1:0;o+=n?1:0;o+=a?1:0;var s=_e.indices;if(o===1){s[1]=3;s[2]=4;s[5]=6;s[7]=6;s[8]=5;if(i){fe(e,t,he,me);fe(e,r,pe,ve);s[0]=0;s[3]=1;s[4]=2;s[6]=1}else if(n){fe(t,r,he,me);fe(t,e,pe,ve);s[0]=1;s[3]=2;s[4]=0;s[6]=2}else if(a){fe(r,e,he,me);fe(r,t,pe,ve);s[0]=2;s[3]=0;s[4]=1;s[6]=0}}else if(o===2){s[2]=4;s[4]=4;s[5]=3;s[7]=5;s[8]=6;if(!i){fe(e,t,he,me);fe(e,r,pe,ve);s[0]=1;s[1]=2;s[3]=1;s[6]=0}else if(!n){fe(t,r,he,me);fe(t,e,pe,ve);s[0]=2;s[1]=0;s[3]=2;s[6]=1}else if(!a){fe(r,e,he,me);fe(r,t,pe,ve);s[0]=0;s[1]=1;s[3]=0;s[6]=2}}var u=_e.positions;u[0]=e;u[1]=t;u[2]=r;u.length=3;if(o===1||o===2){u[3]=he;u[4]=pe;u[5]=me;u[6]=ve;u.length=7}return _e}function ye(e,t){var i=e.attributes;if(i.position.values.length===0){return undefined}for(var n in i){if(i.hasOwnProperty(n)&&l(i[n])&&l(i[n].values)){var a=i[n];a.values=s.createTypedArray(a.componentDatatype,a.values)}}var o=p.computeNumberOfVertices(e);e.indices=_.createTypedArray(o,e.indices);if(t){e.boundingSphere=r.fromVertices(i.position.values)}return e}function we(e){var t=e.attributes;var r={};for(var i in t){if(t.hasOwnProperty(i)&&l(t[i])&&l(t[i].values)){var n=t[i];r[i]=new m({componentDatatype:n.componentDatatype,componentsPerAttribute:n.componentsPerAttribute,normalize:n.normalize,values:[]})}}return new p({attributes:r,indices:[],primitiveType:e.primitiveType})}function Ce(e,t,r){var i=l(e.geometry.boundingSphere);t=ye(t,i);r=ye(r,i);if(l(r)&&!l(t)){e.geometry=r}else if(!l(r)&&l(t)){e.geometry=t}else{e.westHemisphereGeometry=t;e.eastHemisphereGeometry=r;e.geometry=undefined}}var be=new n;var Se=new n;var Ee=new n;var Te=new n;var xe=new i;var Ae=new i;var Pe=new i;function De(e,t){var r=e.componentsPerAttribute;var i=new Array(r);var n=t*r;for(var a=0;a<i.length;a++){i[a]=e.values[n+a]}return i}function Me(e,t,r){var i=e.componentsPerAttribute;var n=r*i;for(var a=0;a<t.length;a++){e.values[n+a]=t[a]}}function Ie(e,r,a,o,s,u,c,d,f,h,p,m){var v=n.fromArray(s,e*3,be);var _=n.fromArray(s,r*3,Se);var g=n.fromArray(s,a*3,Ee);var y=t(o,v,_,g,Te);if(l(u)){var w=n.fromArray(u,e*3,be);var C=n.fromArray(u,r*3,Se);var b=n.fromArray(u,a*3,Ee);n.multiplyByScalar(w,y.x,w);n.multiplyByScalar(C,y.y,C);n.multiplyByScalar(b,y.z,b);var S=n.add(w,C,w);n.add(S,b,S);n.normalize(S,S);n.pack(S,h.normal.values,p*3)}if(l(c)){var E=n.fromArray(c,e*3,be);var T=n.fromArray(c,r*3,Se);var x=n.fromArray(c,a*3,Ee);n.multiplyByScalar(E,y.x,E);n.multiplyByScalar(T,y.y,T);n.multiplyByScalar(x,y.z,x);var A=n.add(E,T,E);n.add(A,x,A);n.normalize(A,A);n.pack(A,h.binormal.values,p*3)}if(l(d)){var P=n.fromArray(d,e*3,be);var D=n.fromArray(d,r*3,Se);var M=n.fromArray(d,a*3,Ee);n.multiplyByScalar(P,y.x,P);n.multiplyByScalar(D,y.y,D);n.multiplyByScalar(M,y.z,M);var I=n.add(P,D,P);n.add(I,M,I);n.normalize(I,I);n.pack(I,h.tangent.values,p*3)}if(l(f)){var O=i.fromArray(f,e*2,xe);var R=i.fromArray(f,r*2,Ae);var N=i.fromArray(f,a*2,Pe);i.multiplyByScalar(O,y.x,O);i.multiplyByScalar(R,y.y,R);i.multiplyByScalar(N,y.z,N);var L=i.add(O,R,O);i.add(L,N,L);i.pack(L,h.st.values,p*2)}var B=[,"normal","binormal","tangent","st"];for(var F in m){if(m.hasOwnProperty(F)&&l(m[F])&&l(m[F].values)){var k=false;for(var V=0;V<B.length;V++){if(B[V]==F){k=true;break}}if(!k){var z=m[F];var U=h[F];var q=z.componentsPerAttribute;var G=p*q;var O=De(z,e);Me(U,O,p)}}}}function Oe(e,t,r,i){var n=["normal","binormal","tangent st"];for(var a in i){if(i.hasOwnProperty(a)&&l(i[a])&&l(i[a].values)){var o=false;for(var s=0;s<n.length;s++){if(n[s]==a){o=true;break}}if(!o){var u=i[a];var c=t[a];var d=u.componentsPerAttribute;var f=r*d;var h=De(u,e);Me(c,h,r)}}}}function Re(e,t,r,i,n,a){var o=e.position.values.length/3;if(n!==-1){var s=i[n];var u=r[s];if(u===-1){r[s]=o;e.position.values.push(a.x,a.y,a.z);t.push(o);return o}t.push(u);return u}e.position.values.push(a.x,a.y,a.z);t.push(o);return o}function Ne(e){var t=e.geometry;var r=t.attributes;var i=r.position.values;var a=l(r.normal)?r.normal.values:undefined;var o=l(r.binormal)?r.binormal.values:undefined;var s=l(r.tangent)?r.tangent.values:undefined;var u=l(r.st)?r.st.values:undefined;var c=t.indices;var d=we(t);var f=we(t);var h;var p;var m;var v;var _;var g=[];g.length=i.length/3;var y=[];y.length=i.length/3;for(_=0;_<g.length;++_){g[_]=-1;y[_]=-1}var w=c.length;for(_=0;_<w;_+=3){var C=c[_];var b=c[_+1];var S=c[_+2];var E=n.fromArray(i,C*3);var T=n.fromArray(i,b*3);var x=n.fromArray(i,S*3);var A=ge(E,T,x);if(l(A)&&A.positions.length>3){var P=A.positions;var D=A.indices;var M=D.length;for(var I=0;I<M;++I){var O=D[I];var R=P[O];if(R.y<0){h=f.attributes;p=f.indices;m=g}else{h=d.attributes;p=d.indices;m=y}v=Re(h,p,m,c,O<3?_+O:-1,R);Ie(C,b,S,R,i,a,o,s,u,h,v,r)}}else{if(l(A)){E=A.positions[0];T=A.positions[1];x=A.positions[2]}if(E.y<0){h=f.attributes;p=f.indices;m=g}else{h=d.attributes;p=d.indices;m=y}v=Re(h,p,m,c,_,E);Ie(C,b,S,E,i,a,o,s,u,h,v,r);v=Re(h,p,m,c,_+1,T);Ie(C,b,S,T,i,a,o,s,u,h,v,r);v=Re(h,p,m,c,_+2,x);Ie(C,b,S,x,i,a,o,s,u,h,v,r)}}Ce(e,f,d)}var Le=S.fromPointNormal(n.ZERO,n.UNIT_Y);var Be=new n;var Fe=new n;function ke(e){var t=e.geometry;var r=t.attributes;var i=r.position.values;var a=t.indices;var o=l(r.color)?r.color.values:undefined;var s=we(t);var u=we(t);var c;var d;var f=a.length;var h=[];h.length=i.length/3;var p=[];p.length=i.length/3;for(c=0;c<h.length;++c){h[c]=-1;p[c]=-1}for(c=0;c<f;c+=2){var m=a[c];var v=a[c+1];var _=n.fromArray(i,m*3,be);var g=n.fromArray(i,v*3,Se);if(Math.abs(_.y)<w.EPSILON6){if(_.y<0){_.y=-w.EPSILON6}else{_.y=w.EPSILON6}}if(Math.abs(g.y)<w.EPSILON6){if(g.y<0){g.y=-w.EPSILON6}else{g.y=w.EPSILON6}}var C=s.attributes;var b=s.indices;var S=p;var E=u.attributes;var T=u.indices;var x=h;var A=y.lineSegmentPlane(_,g,Le,Ee);if(l(A)){var P=n.multiplyByScalar(n.UNIT_Y,5*w.EPSILON9,Be);if(_.y<0){n.negate(P,P);C=u.attributes;b=u.indices;S=h;E=s.attributes;T=s.indices;x=p}var D=n.add(A,P,Fe);d=Re(C,b,S,a,c,_);Oe(m,C,d,r);d=Re(C,b,S,a,-1,D);Oe(m,C,d,r);n.negate(P,P);n.add(A,P,D);d=Re(E,T,x,a,-1,D);Oe(v,E,d,r);d=Re(E,T,x,a,c+1,g);Oe(v,E,d,r)}else{var M;var I;var O;if(_.y<0){M=u.attributes;I=u.indices;O=h}else{M=s.attributes;I=s.indices;O=p}d=Re(M,I,O,a,c,_);Oe(m,M,d,r);d=Re(M,I,O,a,c+1,g);Oe(m,M,d,r)}}Ce(e,u,s)}var Ve=new i;var ze=new i;var Ue=new n;var qe=new n;var Ge=new n;var He=new n;var We=new n;var je=new n;var Ye=new a;function Xe(e){var t=e.attributes;var r=t.position.values;var i=t.prevPosition.values;var a=t.nextPosition.values;var o=r.length;for(var s=0;s<o;s+=3){var u=n.unpack(r,s,Ue);if(u.x>0){continue}var l=n.unpack(i,s,qe);if(u.y<0&&l.y>0||u.y>0&&l.y<0){if(s-3>0){i[s]=r[s-3];i[s+1]=r[s-2];i[s+2]=r[s-1]}else{n.pack(u,i,s)}}var c=n.unpack(a,s,Ge);if(u.y<0&&c.y>0||u.y>0&&c.y<0){if(s+3<o){a[s]=r[s+3];a[s+1]=r[s+4];a[s+2]=r[s+5]}else{n.pack(u,a,s)}}}}var Ze=5*w.EPSILON9;var Ke=w.EPSILON6;function Qe(e){var t=e.geometry;var r=t.attributes;var o=r.position.values;var s=r.prevPosition.values;var u=r.nextPosition.values;var c=r.expandAndWidth.values;var d=l(r.st)?r.st.values:undefined;var f=l(r.color)?r.color.values:undefined;var h=we(t);var p=we(t);var m;var v;var _;var g=false;var C=o.length/3;for(m=0;m<C;m+=4){var b=m;var S=m+2;var E=n.fromArray(o,b*3,Ue);var T=n.fromArray(o,S*3,qe);if(Math.abs(E.y)<Ke){E.y=Ke*(T.y<0?-1:1);o[m*3+1]=E.y;o[(m+1)*3+1]=E.y;for(v=b*3;v<b*3+4*3;v+=3){s[v]=o[m*3];s[v+1]=o[m*3+1];s[v+2]=o[m*3+2]}}if(Math.abs(T.y)<Ke){T.y=Ke*(E.y<0?-1:1);o[(m+2)*3+1]=T.y;o[(m+3)*3+1]=T.y;for(v=b*3;v<b*3+4*3;v+=3){u[v]=o[(m+2)*3];u[v+1]=o[(m+2)*3+1];u[v+2]=o[(m+2)*3+2]}}var x=h.attributes;var A=h.indices;var P=p.attributes;var D=p.indices;var M=y.lineSegmentPlane(E,T,Le,He);if(l(M)){g=true;var I=n.multiplyByScalar(n.UNIT_Y,Ze,We);if(E.y<0){n.negate(I,I);x=p.attributes;A=p.indices;P=h.attributes;D=h.indices}var O=n.add(M,I,je);x.position.values.push(E.x,E.y,E.z,E.x,E.y,E.z);x.position.values.push(O.x,O.y,O.z);x.position.values.push(O.x,O.y,O.z);x.prevPosition.values.push(s[b*3],s[b*3+1],s[b*3+2]);x.prevPosition.values.push(s[b*3+3],s[b*3+4],s[b*3+5]);x.prevPosition.values.push(E.x,E.y,E.z,E.x,E.y,E.z);x.nextPosition.values.push(O.x,O.y,O.z);x.nextPosition.values.push(O.x,O.y,O.z);x.nextPosition.values.push(O.x,O.y,O.z);x.nextPosition.values.push(O.x,O.y,O.z);n.negate(I,I);n.add(M,I,O);P.position.values.push(O.x,O.y,O.z);P.position.values.push(O.x,O.y,O.z);P.position.values.push(T.x,T.y,T.z,T.x,T.y,T.z);P.prevPosition.values.push(O.x,O.y,O.z);P.prevPosition.values.push(O.x,O.y,O.z);P.prevPosition.values.push(O.x,O.y,O.z);P.prevPosition.values.push(O.x,O.y,O.z);P.nextPosition.values.push(T.x,T.y,T.z,T.x,T.y,T.z);P.nextPosition.values.push(u[S*3],u[S*3+1],u[S*3+2]);P.nextPosition.values.push(u[S*3+3],u[S*3+4],u[S*3+5]);var R=i.fromArray(c,b*2,Ve);var N=Math.abs(R.y);x.expandAndWidth.values.push(-1,N,1,N);x.expandAndWidth.values.push(-1,-N,1,-N);P.expandAndWidth.values.push(-1,N,1,N);P.expandAndWidth.values.push(-1,-N,1,-N);var L=n.magnitudeSquared(n.subtract(M,E,Ge));L/=n.magnitudeSquared(n.subtract(T,E,Ge));if(l(f)){var B=a.fromArray(f,b*4,Ye);var F=a.fromArray(f,S*4,Ye);var k=w.lerp(B.x,F.x,L);var V=w.lerp(B.y,F.y,L);var z=w.lerp(B.z,F.z,L);var U=w.lerp(B.w,F.w,L);for(v=b*4;v<b*4+2*4;++v){x.color.values.push(f[v])}x.color.values.push(k,V,z,U);x.color.values.push(k,V,z,U);P.color.values.push(k,V,z,U);P.color.values.push(k,V,z,U);for(v=S*4;v<S*4+2*4;++v){P.color.values.push(f[v])}}if(l(d)){var q=i.fromArray(d,b*2,Ve);var G=i.fromArray(d,(m+3)*2,ze);var H=w.lerp(q.x,G.x,L);for(v=b*2;v<b*2+2*2;++v){x.st.values.push(d[v])}x.st.values.push(H,q.y);x.st.values.push(H,G.y);P.st.values.push(H,q.y);P.st.values.push(H,G.y);for(v=S*2;v<S*2+2*2;++v){P.st.values.push(d[v])}}_=x.position.values.length/3-4;A.push(_,_+2,_+1);A.push(_+1,_+2,_+3);_=P.position.values.length/3-4;D.push(_,_+2,_+1);D.push(_+1,_+2,_+3)}else{var W;var j;if(E.y<0){W=p.attributes;j=p.indices}else{W=h.attributes;j=h.indices}W.position.values.push(E.x,E.y,E.z);W.position.values.push(E.x,E.y,E.z);W.position.values.push(T.x,T.y,T.z);W.position.values.push(T.x,T.y,T.z);for(v=m*3;v<m*3+4*3;++v){W.prevPosition.values.push(s[v]);W.nextPosition.values.push(u[v])}for(v=m*2;v<m*2+4*2;++v){W.expandAndWidth.values.push(c[v]);if(l(d)){W.st.values.push(d[v])}}if(l(f)){
for(v=m*4;v<m*4+4*4;++v){W.color.values.push(f[v])}}_=W.position.values.length/3-4;j.push(_,_+2,_+1);j.push(_+1,_+2,_+3)}}if(g){Xe(p);Xe(h)}Ce(e,p,h)}x.splitLongitude=function(e){if(!l(e)){throw new d("instance is required.")}var t=e.geometry;var i=t.boundingSphere;if(l(i)){var n=i.center.x-i.radius;if(n>0||r.intersectPlane(i,S.ORIGIN_ZX_PLANE)!==g.INTERSECTING){return e}}if(t.geometryType!==v.NONE){switch(t.geometryType){case v.POLYLINES:Qe(e);break;case v.TRIANGLES:Ne(e);break;case v.LINES:ke(e);break}}else{ue(t);if(t.primitiveType===E.TRIANGLES){Ne(e)}else if(t.primitiveType===E.LINES){ke(e)}}return e};return x});define("Core/EllipseGeometry",["./BoundingSphere","./Cartesian2","./Cartesian3","./Cartographic","./ComponentDatatype","./defaultValue","./defined","./defineProperties","./DeveloperError","./EllipseGeometryLibrary","./Ellipsoid","./GeographicProjection","./Geometry","./GeometryAttribute","./GeometryAttributes","./GeometryInstance","./GeometryPipeline","./IndexDatatype","./Math","./Matrix3","./Matrix4","./PrimitiveType","./Quaternion","./Rectangle","./Transforms","./VertexFormat"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w,C,b,S,E,T){"use strict";var x=new r;var A=new r;var P=new r;var D=new r;var M=new t;var I=new y;var O=new b;var R=new r;var N=new r;var L=new r;var B=new i;var F=new r;var k=new t;var V=new t;function z(e,i,a){var o=i.vertexFormat;var s=i.center;var u=i.semiMajorAxis;var c=i.semiMinorAxis;var f=i.ellipsoid;var m=i.stRotation;var v=a?e.length/3*2:e.length/3;var _=i.shadowVolume;var g=o.st?new Float32Array(v*2):undefined;var w=o.normal?new Float32Array(v*3):undefined;var C=o.tangent?new Float32Array(v*3):undefined;var S=o.bitangent?new Float32Array(v*3):undefined;var E=_?new Float32Array(v*3):undefined;var T=0;var D=R;var z=N;var U=L;var q=new d(f);var G=q.project(f.cartesianToCartographic(s,B),F);var H=f.scaleToGeodeticSurface(s,x);f.geodeticSurfaceNormal(H,H);var W=b.fromAxisAngle(H,m,O);var j=y.fromQuaternion(W,I);var Y=t.fromElements(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,k);var X=t.fromElements(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,V);var Z=e.length;var K=a?Z:0;var Q=K/3*2;for(var J=0;J<Z;J+=3){var $=J+1;var ee=J+2;var te=r.fromArray(e,J,x);if(o.st){var re=y.multiplyByVector(j,te,A);var ie=q.project(f.cartesianToCartographic(re,B),P);r.subtract(ie,G,ie);M.x=(ie.x+u)/(2*u);M.y=(ie.y+c)/(2*c);Y.x=Math.min(M.x,Y.x);Y.y=Math.min(M.y,Y.y);X.x=Math.max(M.x,X.x);X.y=Math.max(M.y,X.y);if(a){g[T+Q]=M.x;g[T+1+Q]=M.y}g[T++]=M.x;g[T++]=M.y}if(o.normal||o.tangent||o.bitangent||_){D=f.geodeticSurfaceNormal(te,D);if(_){E[J+K]=-D.x;E[$+K]=-D.y;E[ee+K]=-D.z}if(o.normal||o.tangent||o.bitangent){if(o.tangent||o.bitangent){z=r.normalize(r.cross(r.UNIT_Z,D,z),z);y.multiplyByVector(j,z,z)}if(o.normal){w[J]=D.x;w[$]=D.y;w[ee]=D.z;if(a){w[J+K]=-D.x;w[$+K]=-D.y;w[ee+K]=-D.z}}if(o.tangent){C[J]=z.x;C[$]=z.y;C[ee]=z.z;if(a){C[J+K]=-z.x;C[$+K]=-z.y;C[ee+K]=-z.z}}if(o.bitangent){U=r.normalize(r.cross(D,z,U),U);S[J]=U.x;S[$]=U.y;S[ee]=U.z;if(a){S[J+K]=U.x;S[$+K]=U.y;S[ee+K]=U.z}}}}}if(o.st){Z=g.length;for(var ne=0;ne<Z;ne+=2){g[ne]=(g[ne]-Y.x)/(X.x-Y.x);g[ne+1]=(g[ne+1]-Y.y)/(X.y-Y.y)}}var ae=new p;if(o.position){var oe=l.raisePositionsToHeight(e,i,a);ae.position=new h({componentDatatype:n.DOUBLE,componentsPerAttribute:3,values:oe})}if(o.st){ae.st=new h({componentDatatype:n.FLOAT,componentsPerAttribute:2,values:g})}if(o.normal){ae.normal=new h({componentDatatype:n.FLOAT,componentsPerAttribute:3,values:w})}if(o.tangent){ae.tangent=new h({componentDatatype:n.FLOAT,componentsPerAttribute:3,values:C})}if(o.bitangent){ae.bitangent=new h({componentDatatype:n.FLOAT,componentsPerAttribute:3,values:S})}if(_){ae.extrudeDirection=new h({componentDatatype:n.FLOAT,componentsPerAttribute:3,values:E})}return ae}function U(e){var t=new Array(12*(e*(e+1))-6);var r=0;var i;var n;var a;var o;var s;i=0;a=1;for(o=0;o<3;o++){t[r++]=a++;t[r++]=i;t[r++]=a}for(o=2;o<e+1;++o){a=o*(o+1)-1;i=(o-1)*o-1;t[r++]=a++;t[r++]=i;t[r++]=a;n=2*o;for(s=0;s<n-1;++s){t[r++]=a;t[r++]=i++;t[r++]=i;t[r++]=a++;t[r++]=i;t[r++]=a}t[r++]=a++;t[r++]=i;t[r++]=a}n=e*2;++a;++i;for(o=0;o<n-1;++o){t[r++]=a;t[r++]=i++;t[r++]=i;t[r++]=a++;t[r++]=i;t[r++]=a}t[r++]=a;t[r++]=i++;t[r++]=i;t[r++]=a++;t[r++]=i++;t[r++]=i;++i;for(o=e-1;o>1;--o){t[r++]=i++;t[r++]=i;t[r++]=a;n=2*o;for(s=0;s<n-1;++s){t[r++]=a;t[r++]=i++;t[r++]=i;t[r++]=a++;t[r++]=i;t[r++]=a}t[r++]=i++;t[r++]=i++;t[r++]=a++}for(o=0;o<3;o++){t[r++]=i++;t[r++]=i;t[r++]=a}return t}var q=new r;function G(t){var i=t.center;q=r.multiplyByScalar(t.ellipsoid.geodeticSurfaceNormal(i,q),t.height,q);q=r.add(i,q,q);var n=new e(q,t.semiMajorAxis);var a=l.computeEllipsePositions(t,true,false);var o=a.positions;var s=a.numPts;var u=z(o,t,false);var c=U(s);c=_.createTypedArray(o.length/3,c);return{boundingSphere:n,attributes:u,indices:c}}function H(e,i){var a=i.vertexFormat;var o=i.center;var s=i.semiMajorAxis;var u=i.semiMinorAxis;var l=i.ellipsoid;var c=i.height;var f=i.extrudedHeight;var m=i.stRotation;var v=e.length/3*2;var _=new Float64Array(v*3);var g=a.st?new Float32Array(v*2):undefined;var w=a.normal?new Float32Array(v*3):undefined;var C=a.tangent?new Float32Array(v*3):undefined;var S=a.bitangent?new Float32Array(v*3):undefined;var E=i.shadowVolume;var T=E?new Float32Array(v*3):undefined;var z=0;var U=R;var q=N;var G=L;var H=new d(l);var W=H.project(l.cartesianToCartographic(o,B),F);var j=l.scaleToGeodeticSurface(o,x);l.geodeticSurfaceNormal(j,j);var Y=b.fromAxisAngle(j,m,O);var X=y.fromQuaternion(Y,I);var Z=t.fromElements(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,k);var K=t.fromElements(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,V);var Q=e.length;var J=Q/3*2;for(var $=0;$<Q;$+=3){var ee=$+1;var te=$+2;var re=r.fromArray(e,$,x);var ie;if(a.st){var ne=y.multiplyByVector(X,re,A);var ae=H.project(l.cartesianToCartographic(ne,B),P);r.subtract(ae,W,ae);M.x=(ae.x+s)/(2*s);M.y=(ae.y+u)/(2*u);Z.x=Math.min(M.x,Z.x);Z.y=Math.min(M.y,Z.y);K.x=Math.max(M.x,K.x);K.y=Math.max(M.y,K.y);g[z+J]=M.x;g[z+1+J]=M.y;g[z++]=M.x;g[z++]=M.y}re=l.scaleToGeodeticSurface(re,re);ie=r.clone(re,A);U=l.geodeticSurfaceNormal(re,U);if(E){T[$+Q]=-U.x;T[ee+Q]=-U.y;T[te+Q]=-U.z}var oe=r.multiplyByScalar(U,c,D);re=r.add(re,oe,re);oe=r.multiplyByScalar(U,f,oe);ie=r.add(ie,oe,ie);if(a.position){_[$+Q]=ie.x;_[ee+Q]=ie.y;_[te+Q]=ie.z;_[$]=re.x;_[ee]=re.y;_[te]=re.z}if(a.normal||a.tangent||a.bitangent){G=r.clone(U,G);var se=r.fromArray(e,($+3)%Q,D);r.subtract(se,re,se);var ue=r.subtract(ie,re,P);U=r.normalize(r.cross(ue,se,U),U);if(a.normal){w[$]=U.x;w[ee]=U.y;w[te]=U.z;w[$+Q]=U.x;w[ee+Q]=U.y;w[te+Q]=U.z}if(a.tangent){q=r.normalize(r.cross(G,U,q),q);C[$]=q.x;C[ee]=q.y;C[te]=q.z;C[$+Q]=q.x;C[$+1+Q]=q.y;C[$+2+Q]=q.z}if(a.bitangent){S[$]=G.x;S[ee]=G.y;S[te]=G.z;S[$+Q]=G.x;S[ee+Q]=G.y;S[te+Q]=G.z}}}if(a.st){Q=g.length;for(var le=0;le<Q;le+=2){g[le]=(g[le]-Z.x)/(K.x-Z.x);g[le+1]=(g[le+1]-Z.y)/(K.y-Z.y)}}var ce=new p;if(a.position){ce.position=new h({componentDatatype:n.DOUBLE,componentsPerAttribute:3,values:_})}if(a.st){ce.st=new h({componentDatatype:n.FLOAT,componentsPerAttribute:2,values:g})}if(a.normal){ce.normal=new h({componentDatatype:n.FLOAT,componentsPerAttribute:3,values:w})}if(a.tangent){ce.tangent=new h({componentDatatype:n.FLOAT,componentsPerAttribute:3,values:C})}if(a.bitangent){ce.bitangent=new h({componentDatatype:n.FLOAT,componentsPerAttribute:3,values:S})}if(E){ce.extrudeDirection=new h({componentDatatype:n.FLOAT,componentsPerAttribute:3,values:T})}return ce}function W(e){var t=e.length/3;var r=_.createTypedArray(t,t*6);var i=0;for(var n=0;n<t;n++){var a=n;var o=n+t;var s=(a+1)%t;var u=s+t;r[i++]=a;r[i++]=o;r[i++]=s;r[i++]=s;r[i++]=o;r[i++]=u}return r}var j=new e;var Y=new e;function X(t){var i=t.center;var n=t.ellipsoid;var a=t.semiMajorAxis;var o=r.multiplyByScalar(n.geodeticSurfaceNormal(i,x),t.height,x);j.center=r.add(i,o,j.center);j.radius=a;o=r.multiplyByScalar(n.geodeticSurfaceNormal(i,o),t.extrudedHeight,o);Y.center=r.add(i,o,Y.center);Y.radius=a;var s=l.computeEllipsePositions(t,true,true);var u=s.positions;var c=s.numPts;var d=s.outerPositions;var h=e.union(j,Y);var p=z(u,t,true);var g=U(c);var y=g.length;g.length=y*2;var w=u.length/3;for(var b=0;b<y;b+=3){g[b+y]=g[b+2]+w;g[b+1+y]=g[b+1]+w;g[b+2+y]=g[b]+w}var S=_.createTypedArray(w*2/3,g);var E=new f({attributes:p,indices:S,primitiveType:C.TRIANGLES});var T=H(d,t);g=W(d);var A=_.createTypedArray(d.length*2/3,g);var P=new f({attributes:T,indices:A,primitiveType:C.TRIANGLES});var D=v.combineInstances([new m({geometry:E}),new m({geometry:P})]);return{boundingSphere:h,attributes:D[0].attributes,indices:D[0].indices}}var Z=new w;var K=new w;var Q=new y;var J=[new r,new r,new r,new r];var $=[new i,new i,new i,new i];function ee(e,t,i,n,a){E.eastNorthUpToFixedFrame(e,t,Z);w.inverseTransformation(Z,K);for(var o=0;o<4;++o){r.clone(r.ZERO,J[o])}J[0].x+=i;J[1].x-=i;J[2].y+=n;J[3].y-=n;y.fromRotationZ(a,Q);for(o=0;o<4;++o){y.multiplyByVector(Q,J[o],J[o]);w.multiplyByPoint(Z,J[o],J[o]);t.cartesianToCartographic(J[o],$[o])}return S.fromCartographicArray($)}function te(e){e=a(e,a.EMPTY_OBJECT);var t=e.center;var i=a(e.ellipsoid,c.WGS84);var n=e.semiMajorAxis;var s=e.semiMinorAxis;var l=a(e.granularity,g.RADIANS_PER_DEGREE);var d=a(e.height,0);var f=e.extrudedHeight;var h=o(f)&&Math.abs(d-f)>1;var p=a(e.vertexFormat,T.DEFAULT);if(!o(t)){throw new u("center is required.")}if(!o(n)){throw new u("semiMajorAxis is required.")}if(!o(s)){throw new u("semiMinorAxis is required.")}if(n<s){throw new u("semiMajorAxis must be greater than or equal to the semiMinorAxis.")}if(l<=0){throw new u("granularity must be greater than zero.")}this._center=r.clone(t);this._semiMajorAxis=n;this._semiMinorAxis=s;this._ellipsoid=c.clone(i);this._rotation=a(e.rotation,0);this._stRotation=a(e.stRotation,0);this._height=d;this._granularity=l;this._vertexFormat=T.clone(p);this._extrudedHeight=a(f,d);this._extrude=h;this._shadowVolume=a(e.shadowVolume,false);this._workerName="createEllipseGeometry";this._rectangle=ee(this._center,this._ellipsoid,n,s,this._rotation)}te.packedLength=r.packedLength+c.packedLength+T.packedLength+S.packedLength+9;te.pack=function(e,t,i){if(!o(e)){throw new u("value is required")}if(!o(t)){throw new u("array is required")}i=a(i,0);r.pack(e._center,t,i);i+=r.packedLength;c.pack(e._ellipsoid,t,i);i+=c.packedLength;T.pack(e._vertexFormat,t,i);i+=T.packedLength;S.pack(e._rectangle,t,i);i+=S.packedLength;t[i++]=e._semiMajorAxis;t[i++]=e._semiMinorAxis;t[i++]=e._rotation;t[i++]=e._stRotation;t[i++]=e._height;t[i++]=e._granularity;t[i++]=e._extrudedHeight;t[i++]=e._extrude?1:0;t[i]=e._shadowVolume?1:0;return t};var re=new r;var ie=new c;var ne=new T;var ae=new S;var oe={center:re,ellipsoid:ie,vertexFormat:ne,semiMajorAxis:undefined,semiMinorAxis:undefined,rotation:undefined,stRotation:undefined,height:undefined,granularity:undefined,extrudedHeight:undefined,shadowVolume:undefined};te.unpack=function(e,t,i){if(!o(e)){throw new u("array is required")}t=a(t,0);var n=r.unpack(e,t,re);t+=r.packedLength;var s=c.unpack(e,t,ie);t+=c.packedLength;var l=T.unpack(e,t,ne);t+=T.packedLength;var d=S.unpack(e,t,ae);t+=S.packedLength;var f=e[t++];var h=e[t++];var p=e[t++];var m=e[t++];var v=e[t++];var _=e[t++];var g=e[t++];var y=e[t++]===1;var w=e[t]===1;if(!o(i)){oe.height=v;oe.extrudedHeight=g;oe.granularity=_;oe.stRotation=m;oe.rotation=p;oe.semiMajorAxis=f;oe.semiMinorAxis=h;oe.shadowVolume=w;return new te(oe)}i._center=r.clone(n,i._center);i._ellipsoid=c.clone(s,i._ellipsoid);i._vertexFormat=T.clone(l,i._vertexFormat);i._semiMajorAxis=f;i._semiMinorAxis=h;i._rotation=p;i._stRotation=m;i._height=v;i._granularity=_;i._extrudedHeight=g;i._extrude=y;i._shadowVolume=w;i._rectangle=S.clone(d);return i};te.createGeometry=function(e){if(e._semiMajorAxis<=0||e._semiMinorAxis<=0){return}e._center=e._ellipsoid.scaleToGeodeticSurface(e._center,e._center);var t={center:e._center,semiMajorAxis:e._semiMajorAxis,semiMinorAxis:e._semiMinorAxis,ellipsoid:e._ellipsoid,rotation:e._rotation,height:e._height,extrudedHeight:e._extrudedHeight,granularity:e._granularity,vertexFormat:e._vertexFormat,stRotation:e._stRotation};var r;if(e._extrude){t.extrudedHeight=Math.min(e._extrudedHeight,e._height);t.height=Math.max(e._extrudedHeight,e._height);t.shadowVolume=e._shadowVolume;r=X(t)}else{r=G(t)}return new f({attributes:r.attributes,indices:r.indices,primitiveType:C.TRIANGLES,boundingSphere:r.boundingSphere})};te.createShadowVolume=function(e,t,r){var i=e._granularity;var n=e._ellipsoid;var a=t(i,n);var o=r(i,n);return new te({center:e._center,semiMajorAxis:e._semiMajorAxis,semiMinorAxis:e._semiMinorAxis,ellipsoid:n,rotation:e._rotation,stRotation:e._stRotation,granularity:i,extrudedHeight:a,height:o,vertexFormat:T.POSITION_ONLY,shadowVolume:true})};s(te.prototype,{rectangle:{get:function(){return this._rectangle}}});return te});define("Core/CircleGeometry",["./Cartesian3","./Check","./defaultValue","./defined","./defineProperties","./EllipseGeometry","./Ellipsoid","./VertexFormat"],function(e,t,r,i,n,a,o,s){"use strict";function u(e){e=r(e,r.EMPTY_OBJECT);var i=e.radius;t.typeOf.number("radius",i);var n={center:e.center,semiMajorAxis:i,semiMinorAxis:i,ellipsoid:e.ellipsoid,height:e.height,extrudedHeight:e.extrudedHeight,granularity:e.granularity,vertexFormat:e.vertexFormat,stRotation:e.stRotation,shadowVolume:e.shadowVolume};this._ellipseGeometry=new a(n);this._workerName="createCircleGeometry"}u.packedLength=a.packedLength;u.pack=function(e,r,i){t.typeOf.object("value",e);return a.pack(e._ellipseGeometry,r,i)};var l=new a({center:new e,semiMajorAxis:1,semiMinorAxis:1});var c={center:new e,radius:undefined,ellipsoid:o.clone(o.UNIT_SPHERE),height:undefined,extrudedHeight:undefined,granularity:undefined,vertexFormat:new s,stRotation:undefined,semiMajorAxis:undefined,semiMinorAxis:undefined,shadowVolume:undefined};u.unpack=function(t,r,n){var d=a.unpack(t,r,l);c.center=e.clone(d._center,c.center);c.ellipsoid=o.clone(d._ellipsoid,c.ellipsoid);c.height=d._height;c.extrudedHeight=d._extrudedHeight;c.granularity=d._granularity;c.vertexFormat=s.clone(d._vertexFormat,c.vertexFormat);c.stRotation=d._stRotation;c.shadowVolume=d._shadowVolume;if(!i(n)){c.radius=d._semiMajorAxis;return new u(c)}c.semiMajorAxis=d._semiMajorAxis;c.semiMinorAxis=d._semiMinorAxis;n._ellipseGeometry=new a(c);return n};u.createGeometry=function(e){return a.createGeometry(e._ellipseGeometry)};u.createShadowVolume=function(e,t,r){var i=e._ellipseGeometry._granularity;var n=e._ellipseGeometry._ellipsoid;var a=t(i,n);var o=r(i,n);return new u({center:e._ellipseGeometry._center,radius:e._ellipseGeometry._semiMajorAxis,ellipsoid:n,stRotation:e._ellipseGeometry._stRotation,granularity:i,extrudedHeight:a,height:o,vertexFormat:s.POSITION_ONLY,shadowVolume:true})};n(u.prototype,{rectangle:{get:function(){return this._ellipseGeometry.rectangle}}});return u});define("Core/EllipseOutlineGeometry",["./BoundingSphere","./Cartesian3","./ComponentDatatype","./defaultValue","./defined","./DeveloperError","./EllipseGeometryLibrary","./Ellipsoid","./Geometry","./GeometryAttribute","./GeometryAttributes","./IndexDatatype","./Math","./PrimitiveType"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h){"use strict";var p=new t;var m=new t;function v(i){var n=i.center;m=t.multiplyByScalar(i.ellipsoid.geodeticSurfaceNormal(n,m),i.height,m);m=t.add(n,m,m);var a=new e(m,i.semiMajorAxis);var s=o.computeEllipsePositions(i,false,true).outerPositions;var u=new c({position:new l({componentDatatype:r.DOUBLE,componentsPerAttribute:3,values:o.raisePositionsToHeight(s,i,false)})});var f=s.length/3;var h=d.createTypedArray(f,f*2);var p=0;for(var v=0;v<f;++v){h[p++]=v;h[p++]=(v+1)%f}return{boundingSphere:a,attributes:u,indices:h}}var _=new e;var g=new e;function y(n){var a=n.center;var s=n.ellipsoid;var u=n.semiMajorAxis;var h=t.multiplyByScalar(s.geodeticSurfaceNormal(a,p),n.height,p);_.center=t.add(a,h,_.center);_.radius=u;h=t.multiplyByScalar(s.geodeticSurfaceNormal(a,h),n.extrudedHeight,h);g.center=t.add(a,h,g.center);g.radius=u;var m=o.computeEllipsePositions(n,false,true).outerPositions;var v=new c({position:new l({componentDatatype:r.DOUBLE,componentsPerAttribute:3,values:o.raisePositionsToHeight(m,n,true)})});m=v.position.values;var y=e.union(_,g);var w=m.length/3;var C=i(n.numberOfVerticalLines,16);C=f.clamp(C,0,w/2);var b=d.createTypedArray(w,w*2+C*2);w/=2;var S=0;var E;for(E=0;E<w;++E){b[S++]=E;b[S++]=(E+1)%w;b[S++]=E+w;b[S++]=(E+1)%w+w}var T;if(C>0){var x=Math.min(C,w);T=Math.round(w/x);var A=Math.min(T*C,w);for(E=0;E<A;E+=T){b[S++]=E;b[S++]=E+w}}return{boundingSphere:y,attributes:v,indices:b}}function w(e){e=i(e,i.EMPTY_OBJECT);var r=e.center;var o=i(e.ellipsoid,s.WGS84);var u=e.semiMajorAxis;var l=e.semiMinorAxis;var c=i(e.granularity,f.RADIANS_PER_DEGREE);var d=i(e.height,0);var h=e.extrudedHeight;var p=n(h)&&Math.abs(d-h)>1;if(!n(r)){throw new a("center is required.")}if(!n(u)){throw new a("semiMajorAxis is required.")}if(!n(l)){throw new a("semiMinorAxis is required.")}if(u<l){throw new a("semiMajorAxis must be greater than or equal to the semiMinorAxis.")}if(c<=0){throw new a("granularity must be greater than zero.")}this._center=t.clone(r);this._semiMajorAxis=u;this._semiMinorAxis=l;this._ellipsoid=s.clone(o);this._rotation=i(e.rotation,0);this._height=d;this._granularity=c;this._extrudedHeight=h;this._extrude=p;this._numberOfVerticalLines=Math.max(i(e.numberOfVerticalLines,16),0);this._workerName="createEllipseOutlineGeometry"}w.packedLength=t.packedLength+s.packedLength+9;w.pack=function(e,r,o){if(!n(e)){throw new a("value is required")}if(!n(r)){throw new a("array is required")}o=i(o,0);t.pack(e._center,r,o);o+=t.packedLength;s.pack(e._ellipsoid,r,o);o+=s.packedLength;r[o++]=e._semiMajorAxis;r[o++]=e._semiMinorAxis;r[o++]=e._rotation;r[o++]=e._height;r[o++]=e._granularity;r[o++]=n(e._extrudedHeight)?1:0;r[o++]=i(e._extrudedHeight,0);r[o++]=e._extrude?1:0;r[o]=e._numberOfVerticalLines;return r};var C=new t;var b=new s;var S={center:C,ellipsoid:b,semiMajorAxis:undefined,semiMinorAxis:undefined,rotation:undefined,height:undefined,granularity:undefined,extrudedHeight:undefined,numberOfVerticalLines:undefined};w.unpack=function(e,r,o){if(!n(e)){throw new a("array is required")}r=i(r,0);var u=t.unpack(e,r,C);r+=t.packedLength;var l=s.unpack(e,r,b);r+=s.packedLength;var c=e[r++];var d=e[r++];var f=e[r++];var h=e[r++];var p=e[r++];var m=e[r++];var v=e[r++];var _=e[r++]===1;var g=e[r];if(!n(o)){S.height=h;S.extrudedHeight=m?v:undefined;S.granularity=p;S.rotation=f;S.semiMajorAxis=c;S.semiMinorAxis=d;S.numberOfVerticalLines=g;return new w(S)}o._center=t.clone(u,o._center);o._ellipsoid=s.clone(l,o._ellipsoid);o._semiMajorAxis=c;o._semiMinorAxis=d;o._rotation=f;o._height=h;o._granularity=p;o._extrudedHeight=m?v:undefined;o._extrude=_;o._numberOfVerticalLines=g;return o};w.createGeometry=function(e){if(e._semiMajorAxis<=0||e._semiMinorAxis<=0){return}e._center=e._ellipsoid.scaleToGeodeticSurface(e._center,e._center);var t={center:e._center,semiMajorAxis:e._semiMajorAxis,semiMinorAxis:e._semiMinorAxis,ellipsoid:e._ellipsoid,rotation:e._rotation,height:e._height,extrudedHeight:e._extrudedHeight,granularity:e._granularity,numberOfVerticalLines:e._numberOfVerticalLines};var r;if(e._extrude){t.extrudedHeight=Math.min(e._extrudedHeight,e._height);t.height=Math.max(e._extrudedHeight,e._height);r=y(t)}else{r=v(t)}return new u({attributes:r.attributes,indices:r.indices,primitiveType:h.LINES,boundingSphere:r.boundingSphere})};return w});define("Core/CircleOutlineGeometry",["./Cartesian3","./Check","./defaultValue","./defined","./EllipseOutlineGeometry","./Ellipsoid"],function(e,t,r,i,n,a){"use strict";function o(e){e=r(e,r.EMPTY_OBJECT);var i=e.radius;t.typeOf.number("radius",i);var a={center:e.center,semiMajorAxis:i,semiMinorAxis:i,ellipsoid:e.ellipsoid,height:e.height,extrudedHeight:e.extrudedHeight,granularity:e.granularity,numberOfVerticalLines:e.numberOfVerticalLines};this._ellipseGeometry=new n(a);this._workerName="createCircleOutlineGeometry"}o.packedLength=n.packedLength;o.pack=function(e,r,i){t.typeOf.object("value",e);return n.pack(e._ellipseGeometry,r,i)};var s=new n({center:new e,semiMajorAxis:1,semiMinorAxis:1});var u={center:new e,radius:undefined,ellipsoid:a.clone(a.UNIT_SPHERE),height:undefined,extrudedHeight:undefined,granularity:undefined,numberOfVerticalLines:undefined,semiMajorAxis:undefined,semiMinorAxis:undefined};o.unpack=function(t,r,l){var c=n.unpack(t,r,s);u.center=e.clone(c._center,u.center);u.ellipsoid=a.clone(c._ellipsoid,u.ellipsoid);u.height=c._height;u.extrudedHeight=c._extrudedHeight;u.granularity=c._granularity;u.numberOfVerticalLines=c._numberOfVerticalLines;if(!i(l)){u.radius=c._semiMajorAxis;return new o(u)}u.semiMajorAxis=c._semiMajorAxis;u.semiMinorAxis=c._semiMinorAxis;l._ellipseGeometry=new n(u);return l};o.createGeometry=function(e){return n.createGeometry(e._ellipseGeometry)};return o});define("Core/ClockRange",["./freezeObject"],function(e){"use strict";var t={UNBOUNDED:0,CLAMPED:1,LOOP_STOP:2};return e(t)});define("Core/ClockStep",["./freezeObject"],function(e){"use strict";var t={TICK_DEPENDENT:0,SYSTEM_CLOCK_MULTIPLIER:1,SYSTEM_CLOCK:2};return e(t)});define("Core/getTimestamp",["./defined"],function(e){"use strict";var t;if(typeof performance!=="undefined"&&e(performance.now)){t=function(){return performance.now()}}else{t=function(){return Date.now()}}return t});define("Core/Clock",["./ClockRange","./ClockStep","./defaultValue","./defined","./defineProperties","./DeveloperError","./Event","./getTimestamp","./JulianDate"],function(e,t,r,i,n,a,o,s,u){"use strict";function l(n){n=r(n,r.EMPTY_OBJECT);var l=n.currentTime;var c=n.startTime;var d=n.stopTime;if(!i(l)){if(i(c)){l=u.clone(c)}else if(i(d)){l=u.addDays(d,-1,new u)}else{l=u.now()}}else{l=u.clone(l)}if(!i(c)){c=u.clone(l)}else{c=u.clone(c)}if(!i(d)){d=u.addDays(c,1,new u)}else{d=u.clone(d)}if(u.greaterThan(c,d)){throw new a("startTime must come before stopTime.")}this.startTime=c;this.stopTime=d;this.clockRange=r(n.clockRange,e.UNBOUNDED);this.canAnimate=r(n.canAnimate,true);this.onTick=new o;this._currentTime=undefined;this._multiplier=undefined;this._clockStep=undefined;this._shouldAnimate=undefined;this._lastSystemTime=s();this.currentTime=l;this.multiplier=r(n.multiplier,1);this.clockStep=r(n.clockStep,t.SYSTEM_CLOCK_MULTIPLIER);this.shouldAnimate=r(n.shouldAnimate,true)}n(l.prototype,{currentTime:{get:function(){return this._currentTime},set:function(e){if(u.equals(this._currentTime,e)){return}if(this._clockStep===t.SYSTEM_CLOCK){this._clockStep=t.SYSTEM_CLOCK_MULTIPLIER}this._currentTime=e}},multiplier:{get:function(){return this._multiplier},set:function(e){if(this._multiplier===e){return}if(this._clockStep===t.SYSTEM_CLOCK){this._clockStep=t.SYSTEM_CLOCK_MULTIPLIER}this._multiplier=e}},clockStep:{get:function(){return this._clockStep},set:function(e){if(e===t.SYSTEM_CLOCK){this._multiplier=1;this._shouldAnimate=true;this._currentTime=u.now()}this._clockStep=e}},shouldAnimate:{get:function(){return this._shouldAnimate},set:function(e){if(this._shouldAnimate===e){return}if(this._clockStep===t.SYSTEM_CLOCK){this._clockStep=t.SYSTEM_CLOCK_MULTIPLIER}this._shouldAnimate=e}}});l.prototype.tick=function(){var r=s();var i=u.clone(this._currentTime);if(this.canAnimate&&this._shouldAnimate){var n=this._clockStep;if(n===t.SYSTEM_CLOCK){i=u.now(i)}else{var a=this._multiplier;if(n===t.TICK_DEPENDENT){i=u.addSeconds(i,a,i)}else{var o=r-this._lastSystemTime;i=u.addSeconds(i,a*(o/1e3),i)}var l=this.clockRange;var c=this.startTime;var d=this.stopTime;if(l===e.CLAMPED){if(u.lessThan(i,c)){i=u.clone(c,i)}else if(u.greaterThan(i,d)){i=u.clone(d,i)}}else if(l===e.LOOP_STOP){if(u.lessThan(i,c)){i=u.clone(c,i)}while(u.greaterThan(i,d)){i=u.addSeconds(c,u.secondsDifference(i,d),i)}}}}this._currentTime=i;this._lastSystemTime=r;this.onTick.raiseEvent(this);return i};return l});define("Core/Color",["./defaultValue","./defined","./DeveloperError","./FeatureDetection","./freezeObject","./Math"],function(e,t,r,i,n,a){"use strict";function o(e,t,r){if(r<0){r+=1}if(r>1){r-=1}if(r*6<1){return e+(t-e)*6*r}if(r*2<1){return t}if(r*3<2){return e+(t-e)*(2/3-r)*6}return e}function s(t,r,i,n){this.red=e(t,1);this.green=e(r,1);this.blue=e(i,1);this.alpha=e(n,1)}s.fromCartesian4=function(e,i){if(!t(e)){throw new r("cartesian is required")}if(!t(i)){return new s(e.x,e.y,e.z,e.w)}i.red=e.x;i.green=e.y;i.blue=e.z;i.alpha=e.w;return i};s.fromBytes=function(r,i,n,a,o){r=s.byteToFloat(e(r,255));i=s.byteToFloat(e(i,255));n=s.byteToFloat(e(n,255));a=s.byteToFloat(e(a,255));if(!t(o)){return new s(r,i,n,a)}o.red=r;o.green=i;o.blue=n;o.alpha=a;return o};s.fromAlpha=function(e,i,n){if(!t(e)){throw new r("color is required")}if(!t(i)){throw new r("alpha is required")}if(!t(n)){return new s(e.red,e.green,e.blue,i)}n.red=e.red;n.green=e.green;n.blue=e.blue;n.alpha=i;return n};var u;var l;var c;if(i.supportsTypedArrays()){u=new ArrayBuffer(4);l=new Uint32Array(u);c=new Uint8Array(u)}s.fromRgba=function(e,t){l[0]=e;return s.fromBytes(c[0],c[1],c[2],c[3],t)};s.fromHsl=function(r,i,n,a,u){r=e(r,0)%1;i=e(i,0);n=e(n,0);a=e(a,1);var l=n;var c=n;var d=n;if(i!==0){var f;if(n<.5){f=n*(1+i)}else{f=n+i-n*i}var h=2*n-f;l=o(h,f,r+1/3);c=o(h,f,r);d=o(h,f,r-1/3)}if(!t(u)){return new s(l,c,d,a)}u.red=l;u.green=c;u.blue=d;u.alpha=a;return u};s.fromRandom=function(i,n){i=e(i,e.EMPTY_OBJECT);var o=i.red;if(!t(o)){var u=e(i.minimumRed,0);var l=e(i.maximumRed,1);if(u>l){throw new r("minimumRed must be less than or equal to maximumRed")}o=u+a.nextRandomNumber()*(l-u)}var c=i.green;if(!t(c)){var d=e(i.minimumGreen,0);var f=e(i.maximumGreen,1);if(d>f){throw new r("minimumGreen must be less than or equal to maximumGreen")}c=d+a.nextRandomNumber()*(f-d)}var h=i.blue;if(!t(h)){var p=e(i.minimumBlue,0);var m=e(i.maximumBlue,1);if(p>m){throw new r("minimumBlue must be less than or equal to maximumBlue")}h=p+a.nextRandomNumber()*(m-p)}var v=i.alpha;if(!t(v)){var _=e(i.minimumAlpha,0);var g=e(i.maximumAlpha,1);if(_>g){throw new r("minimumAlpha must be less than or equal to maximumAlpha")}v=_+a.nextRandomNumber()*(g-_)}if(!t(n)){return new s(o,c,h,v)}n.red=o;n.green=c;n.blue=h;n.alpha=v;return n};var d=/^#([0-9a-f])([0-9a-f])([0-9a-f])$/i;var f=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i;var h=/^rgba?\(\s*([0-9.]+%?)\s*,\s*([0-9.]+%?)\s*,\s*([0-9.]+%?)(?:\s*,\s*([0-9.]+))?\s*\)$/i;var p=/^hsla?\(\s*([0-9.]+)\s*,\s*([0-9.]+%)\s*,\s*([0-9.]+%)(?:\s*,\s*([0-9.]+))?\s*\)$/i;s.fromCssColorString=function(i,n){if(!t(i)){throw new r("color is required")}if(!t(n)){n=new s}var a=s[i.toUpperCase()];if(t(a)){s.clone(a,n);return n}var o=d.exec(i);if(o!==null){n.red=parseInt(o[1],16)/15;n.green=parseInt(o[2],16)/15;n.blue=parseInt(o[3],16)/15;n.alpha=1;return n}o=f.exec(i);if(o!==null){n.red=parseInt(o[1],16)/255;n.green=parseInt(o[2],16)/255;n.blue=parseInt(o[3],16)/255;n.alpha=1;return n}o=h.exec(i);if(o!==null){n.red=parseFloat(o[1])/("%"===o[1].substr(-1)?100:255);n.green=parseFloat(o[2])/("%"===o[2].substr(-1)?100:255);n.blue=parseFloat(o[3])/("%"===o[3].substr(-1)?100:255);n.alpha=parseFloat(e(o[4],"1.0"));return n}o=p.exec(i);if(o!==null){return s.fromHsl(parseFloat(o[1])/360,parseFloat(o[2])/100,parseFloat(o[3])/100,parseFloat(e(o[4],"1.0")),n)}n=undefined;return n};s.packedLength=4;s.pack=function(i,n,a){if(!t(i)){throw new r("value is required")}if(!t(n)){throw new r("array is required")}a=e(a,0);n[a++]=i.red;n[a++]=i.green;n[a++]=i.blue;n[a]=i.alpha;return n};s.unpack=function(i,n,a){if(!t(i)){throw new r("array is required")}n=e(n,0);if(!t(a)){a=new s}a.red=i[n++];a.green=i[n++];a.blue=i[n++];a.alpha=i[n];return a};s.byteToFloat=function(e){return e/255};s.floatToByte=function(e){return e===1?255:e*256|0};s.clone=function(e,r){if(!t(e)){return undefined}if(!t(r)){return new s(e.red,e.green,e.blue,e.alpha)}r.red=e.red;r.green=e.green;r.blue=e.blue;r.alpha=e.alpha;return r};s.equals=function(e,r){return e===r||t(e)&&t(r)&&e.red===r.red&&e.green===r.green&&e.blue===r.blue&&e.alpha===r.alpha};s.equalsArray=function(e,t,r){return e.red===t[r]&&e.green===t[r+1]&&e.blue===t[r+2]&&e.alpha===t[r+3]};s.prototype.clone=function(e){return s.clone(this,e)};s.prototype.equals=function(e){return s.equals(this,e)};s.prototype.equalsEpsilon=function(e,r){return this===e||t(e)&&Math.abs(this.red-e.red)<=r&&Math.abs(this.green-e.green)<=r&&Math.abs(this.blue-e.blue)<=r&&Math.abs(this.alpha-e.alpha)<=r};s.prototype.toString=function(){return"("+this.red+", "+this.green+", "+this.blue+", "+this.alpha+")"};s.prototype.toCssColorString=function(){var e=s.floatToByte(this.red);var t=s.floatToByte(this.green);var r=s.floatToByte(this.blue);if(this.alpha===1){return"rgb("+e+","+t+","+r+")"}return"rgba("+e+","+t+","+r+","+this.alpha+")"};s.prototype.toBytes=function(e){var r=s.floatToByte(this.red);var i=s.floatToByte(this.green);var n=s.floatToByte(this.blue);var a=s.floatToByte(this.alpha);if(!t(e)){return[r,i,n,a]}e[0]=r;e[1]=i;e[2]=n;e[3]=a;return e};s.prototype.toRgba=function(){c[0]=s.floatToByte(this.red);c[1]=s.floatToByte(this.green);c[2]=s.floatToByte(this.blue);c[3]=s.floatToByte(this.alpha);return l[0]};s.prototype.brighten=function(e,i){if(!t(e)){throw new r("magnitude is required.")}if(e<0){throw new r("magnitude must be positive.")}if(!t(i)){throw new r("result is required.")}e=1-e;i.red=1-(1-this.red)*e;i.green=1-(1-this.green)*e;i.blue=1-(1-this.blue)*e;i.alpha=this.alpha;return i};s.prototype.darken=function(e,i){if(!t(e)){throw new r("magnitude is required.")}if(e<0){throw new r("magnitude must be positive.")}if(!t(i)){throw new r("result is required.")}e=1-e;i.red=this.red*e;i.green=this.green*e;i.blue=this.blue*e;i.alpha=this.alpha;return i};s.prototype.withAlpha=function(e,t){return s.fromAlpha(this,e,t)};s.add=function(e,i,n){if(!t(e)){throw new r("left is required")}if(!t(i)){throw new r("right is required")}if(!t(n)){throw new r("result is required")}n.red=e.red+i.red;n.green=e.green+i.green;n.blue=e.blue+i.blue;n.alpha=e.alpha+i.alpha;return n};s.subtract=function(e,i,n){if(!t(e)){throw new r("left is required")}if(!t(i)){throw new r("right is required")}if(!t(n)){throw new r("result is required")}n.red=e.red-i.red;n.green=e.green-i.green;n.blue=e.blue-i.blue;n.alpha=e.alpha-i.alpha;return n};s.multiply=function(e,i,n){if(!t(e)){throw new r("left is required")}if(!t(i)){throw new r("right is required")}if(!t(n)){throw new r("result is required")}n.red=e.red*i.red;n.green=e.green*i.green;n.blue=e.blue*i.blue;n.alpha=e.alpha*i.alpha;return n};s.divide=function(e,i,n){if(!t(e)){throw new r("left is required")}if(!t(i)){throw new r("right is required")}if(!t(n)){throw new r("result is required")}n.red=e.red/i.red;n.green=e.green/i.green;n.blue=e.blue/i.blue;n.alpha=e.alpha/i.alpha;return n};s.mod=function(e,i,n){if(!t(e)){throw new r("left is required")}if(!t(i)){throw new r("right is required")}if(!t(n)){throw new r("result is required")}n.red=e.red%i.red;n.green=e.green%i.green;n.blue=e.blue%i.blue;n.alpha=e.alpha%i.alpha;return n};s.multiplyByScalar=function(e,i,n){if(!t(e)){throw new r("cartesian is required")}if(typeof i!=="number"){throw new r("scalar is required and must be a number.")}if(!t(n)){throw new r("result is required")}n.red=e.red*i;n.green=e.green*i;n.blue=e.blue*i;n.alpha=e.alpha*i;return n};s.divideByScalar=function(e,i,n){if(!t(e)){throw new r("cartesian is required")}if(typeof i!=="number"){throw new r("scalar is required and must be a number.")}if(!t(n)){throw new r("result is required")}n.red=e.red/i;n.green=e.green/i;n.blue=e.blue/i;n.alpha=e.alpha/i;return n};s.ALICEBLUE=n(s.fromCssColorString("#F0F8FF"));s.ANTIQUEWHITE=n(s.fromCssColorString("#FAEBD7"));s.AQUA=n(s.fromCssColorString("#00FFFF"));s.AQUAMARINE=n(s.fromCssColorString("#7FFFD4"));s.AZURE=n(s.fromCssColorString("#F0FFFF"));s.BEIGE=n(s.fromCssColorString("#F5F5DC"));s.BISQUE=n(s.fromCssColorString("#FFE4C4"));s.BLACK=n(s.fromCssColorString("#000000"))
;s.BLANCHEDALMOND=n(s.fromCssColorString("#FFEBCD"));s.BLUE=n(s.fromCssColorString("#0000FF"));s.BLUEVIOLET=n(s.fromCssColorString("#8A2BE2"));s.BROWN=n(s.fromCssColorString("#A52A2A"));s.BURLYWOOD=n(s.fromCssColorString("#DEB887"));s.CADETBLUE=n(s.fromCssColorString("#5F9EA0"));s.CHARTREUSE=n(s.fromCssColorString("#7FFF00"));s.CHOCOLATE=n(s.fromCssColorString("#D2691E"));s.CORAL=n(s.fromCssColorString("#FF7F50"));s.CORNFLOWERBLUE=n(s.fromCssColorString("#6495ED"));s.CORNSILK=n(s.fromCssColorString("#FFF8DC"));s.CRIMSON=n(s.fromCssColorString("#DC143C"));s.CYAN=n(s.fromCssColorString("#00FFFF"));s.DARKBLUE=n(s.fromCssColorString("#00008B"));s.DARKCYAN=n(s.fromCssColorString("#008B8B"));s.DARKGOLDENROD=n(s.fromCssColorString("#B8860B"));s.DARKGRAY=n(s.fromCssColorString("#A9A9A9"));s.DARKGREEN=n(s.fromCssColorString("#006400"));s.DARKGREY=s.DARKGRAY;s.DARKKHAKI=n(s.fromCssColorString("#BDB76B"));s.DARKMAGENTA=n(s.fromCssColorString("#8B008B"));s.DARKOLIVEGREEN=n(s.fromCssColorString("#556B2F"));s.DARKORANGE=n(s.fromCssColorString("#FF8C00"));s.DARKORCHID=n(s.fromCssColorString("#9932CC"));s.DARKRED=n(s.fromCssColorString("#8B0000"));s.DARKSALMON=n(s.fromCssColorString("#E9967A"));s.DARKSEAGREEN=n(s.fromCssColorString("#8FBC8F"));s.DARKSLATEBLUE=n(s.fromCssColorString("#483D8B"));s.DARKSLATEGRAY=n(s.fromCssColorString("#2F4F4F"));s.DARKSLATEGREY=s.DARKSLATEGRAY;s.DARKTURQUOISE=n(s.fromCssColorString("#00CED1"));s.DARKVIOLET=n(s.fromCssColorString("#9400D3"));s.DEEPPINK=n(s.fromCssColorString("#FF1493"));s.DEEPSKYBLUE=n(s.fromCssColorString("#00BFFF"));s.DIMGRAY=n(s.fromCssColorString("#696969"));s.DIMGREY=s.DIMGRAY;s.DODGERBLUE=n(s.fromCssColorString("#1E90FF"));s.FIREBRICK=n(s.fromCssColorString("#B22222"));s.FLORALWHITE=n(s.fromCssColorString("#FFFAF0"));s.FORESTGREEN=n(s.fromCssColorString("#228B22"));s.FUCHSIA=n(s.fromCssColorString("#FF00FF"));s.GAINSBORO=n(s.fromCssColorString("#DCDCDC"));s.GHOSTWHITE=n(s.fromCssColorString("#F8F8FF"));s.GOLD=n(s.fromCssColorString("#FFD700"));s.GOLDENROD=n(s.fromCssColorString("#DAA520"));s.GRAY=n(s.fromCssColorString("#808080"));s.GREEN=n(s.fromCssColorString("#008000"));s.GREENYELLOW=n(s.fromCssColorString("#ADFF2F"));s.GREY=s.GRAY;s.HONEYDEW=n(s.fromCssColorString("#F0FFF0"));s.HOTPINK=n(s.fromCssColorString("#FF69B4"));s.INDIANRED=n(s.fromCssColorString("#CD5C5C"));s.INDIGO=n(s.fromCssColorString("#4B0082"));s.IVORY=n(s.fromCssColorString("#FFFFF0"));s.KHAKI=n(s.fromCssColorString("#F0E68C"));s.LAVENDER=n(s.fromCssColorString("#E6E6FA"));s.LAVENDAR_BLUSH=n(s.fromCssColorString("#FFF0F5"));s.LAWNGREEN=n(s.fromCssColorString("#7CFC00"));s.LEMONCHIFFON=n(s.fromCssColorString("#FFFACD"));s.LIGHTBLUE=n(s.fromCssColorString("#ADD8E6"));s.LIGHTCORAL=n(s.fromCssColorString("#F08080"));s.LIGHTCYAN=n(s.fromCssColorString("#E0FFFF"));s.LIGHTGOLDENRODYELLOW=n(s.fromCssColorString("#FAFAD2"));s.LIGHTGRAY=n(s.fromCssColorString("#D3D3D3"));s.LIGHTGREEN=n(s.fromCssColorString("#90EE90"));s.LIGHTGREY=s.LIGHTGRAY;s.LIGHTPINK=n(s.fromCssColorString("#FFB6C1"));s.LIGHTSEAGREEN=n(s.fromCssColorString("#20B2AA"));s.LIGHTSKYBLUE=n(s.fromCssColorString("#87CEFA"));s.LIGHTSLATEGRAY=n(s.fromCssColorString("#778899"));s.LIGHTSLATEGREY=s.LIGHTSLATEGRAY;s.LIGHTSTEELBLUE=n(s.fromCssColorString("#B0C4DE"));s.LIGHTYELLOW=n(s.fromCssColorString("#FFFFE0"));s.LIME=n(s.fromCssColorString("#00FF00"));s.LIMEGREEN=n(s.fromCssColorString("#32CD32"));s.LINEN=n(s.fromCssColorString("#FAF0E6"));s.MAGENTA=n(s.fromCssColorString("#FF00FF"));s.MAROON=n(s.fromCssColorString("#800000"));s.MEDIUMAQUAMARINE=n(s.fromCssColorString("#66CDAA"));s.MEDIUMBLUE=n(s.fromCssColorString("#0000CD"));s.MEDIUMORCHID=n(s.fromCssColorString("#BA55D3"));s.MEDIUMPURPLE=n(s.fromCssColorString("#9370DB"));s.MEDIUMSEAGREEN=n(s.fromCssColorString("#3CB371"));s.MEDIUMSLATEBLUE=n(s.fromCssColorString("#7B68EE"));s.MEDIUMSPRINGGREEN=n(s.fromCssColorString("#00FA9A"));s.MEDIUMTURQUOISE=n(s.fromCssColorString("#48D1CC"));s.MEDIUMVIOLETRED=n(s.fromCssColorString("#C71585"));s.MIDNIGHTBLUE=n(s.fromCssColorString("#191970"));s.MINTCREAM=n(s.fromCssColorString("#F5FFFA"));s.MISTYROSE=n(s.fromCssColorString("#FFE4E1"));s.MOCCASIN=n(s.fromCssColorString("#FFE4B5"));s.NAVAJOWHITE=n(s.fromCssColorString("#FFDEAD"));s.NAVY=n(s.fromCssColorString("#000080"));s.OLDLACE=n(s.fromCssColorString("#FDF5E6"));s.OLIVE=n(s.fromCssColorString("#808000"));s.OLIVEDRAB=n(s.fromCssColorString("#6B8E23"));s.ORANGE=n(s.fromCssColorString("#FFA500"));s.ORANGERED=n(s.fromCssColorString("#FF4500"));s.ORCHID=n(s.fromCssColorString("#DA70D6"));s.PALEGOLDENROD=n(s.fromCssColorString("#EEE8AA"));s.PALEGREEN=n(s.fromCssColorString("#98FB98"));s.PALETURQUOISE=n(s.fromCssColorString("#AFEEEE"));s.PALEVIOLETRED=n(s.fromCssColorString("#DB7093"));s.PAPAYAWHIP=n(s.fromCssColorString("#FFEFD5"));s.PEACHPUFF=n(s.fromCssColorString("#FFDAB9"));s.PERU=n(s.fromCssColorString("#CD853F"));s.PINK=n(s.fromCssColorString("#FFC0CB"));s.PLUM=n(s.fromCssColorString("#DDA0DD"));s.POWDERBLUE=n(s.fromCssColorString("#B0E0E6"));s.PURPLE=n(s.fromCssColorString("#800080"));s.RED=n(s.fromCssColorString("#FF0000"));s.ROSYBROWN=n(s.fromCssColorString("#BC8F8F"));s.ROYALBLUE=n(s.fromCssColorString("#4169E1"));s.SADDLEBROWN=n(s.fromCssColorString("#8B4513"));s.SALMON=n(s.fromCssColorString("#FA8072"));s.SANDYBROWN=n(s.fromCssColorString("#F4A460"));s.SEAGREEN=n(s.fromCssColorString("#2E8B57"));s.SEASHELL=n(s.fromCssColorString("#FFF5EE"));s.SIENNA=n(s.fromCssColorString("#A0522D"));s.SILVER=n(s.fromCssColorString("#C0C0C0"));s.SKYBLUE=n(s.fromCssColorString("#87CEEB"));s.SLATEBLUE=n(s.fromCssColorString("#6A5ACD"));s.SLATEGRAY=n(s.fromCssColorString("#708090"));s.SLATEGREY=s.SLATEGRAY;s.SNOW=n(s.fromCssColorString("#FFFAFA"));s.SPRINGGREEN=n(s.fromCssColorString("#00FF7F"));s.STEELBLUE=n(s.fromCssColorString("#4682B4"));s.TAN=n(s.fromCssColorString("#D2B48C"));s.TEAL=n(s.fromCssColorString("#008080"));s.THISTLE=n(s.fromCssColorString("#D8BFD8"));s.TOMATO=n(s.fromCssColorString("#FF6347"));s.TURQUOISE=n(s.fromCssColorString("#40E0D0"));s.VIOLET=n(s.fromCssColorString("#EE82EE"));s.WHEAT=n(s.fromCssColorString("#F5DEB3"));s.WHITE=n(s.fromCssColorString("#FFFFFF"));s.WHITESMOKE=n(s.fromCssColorString("#F5F5F5"));s.YELLOW=n(s.fromCssColorString("#FFFF00"));s.YELLOWGREEN=n(s.fromCssColorString("#9ACD32"));s.TRANSPARENT=n(new s(0,0,0,0));return s});define("Core/ColorGeometryInstanceAttribute",["./Color","./ComponentDatatype","./defaultValue","./defined","./defineProperties","./DeveloperError"],function(e,t,r,i,n,a){"use strict";function o(t,i,n,a){t=r(t,1);i=r(i,1);n=r(n,1);a=r(a,1);this.value=new Uint8Array([e.floatToByte(t),e.floatToByte(i),e.floatToByte(n),e.floatToByte(a)])}n(o.prototype,{componentDatatype:{get:function(){return t.UNSIGNED_BYTE}},componentsPerAttribute:{get:function(){return 4}},normalize:{get:function(){return true}}});o.fromColor=function(e){if(!i(e)){throw new a("color is required.")}return new o(e.red,e.green,e.blue,e.alpha)};o.toValue=function(e,t){if(!i(e)){throw new a("color is required.")}if(!i(t)){return new Uint8Array(e.toBytes())}return e.toBytes(t)};o.equals=function(e,t){return e===t||i(e)&&i(t)&&e.value[0]===t.value[0]&&e.value[1]===t.value[1]&&e.value[2]===t.value[2]&&e.value[3]===t.value[3]};return o});define("Core/CompressedTextureBuffer",["./defined","./defineProperties"],function(e,t){"use strict";function r(e,t,r,i){this._format=e;this._width=t;this._height=r;this._buffer=i}t(r.prototype,{internalFormat:{get:function(){return this._format}},width:{get:function(){return this._width}},height:{get:function(){return this._height}},bufferView:{get:function(){return this._buffer}}});r.clone=function(t){if(!e(t)){return undefined}return new r(t._format,t._width,t._height,t._buffer)};r.prototype.clone=function(){return r.clone(this)};return r});define("Core/CornerType",["./freezeObject"],function(e){"use strict";var t={ROUNDED:0,MITERED:1,BEVELED:2};return e(t)});define("Core/EllipsoidGeodesic",["./Cartesian3","./Cartographic","./defaultValue","./defined","./defineProperties","./DeveloperError","./Ellipsoid","./Math"],function(e,t,r,i,n,a,o,s){"use strict";function u(e){var t=e._uSquared;var r=e._ellipsoid.maximumRadius;var i=e._ellipsoid.minimumRadius;var n=(r-i)/r;var a=Math.cos(e._startHeading);var o=Math.sin(e._startHeading);var s=(1-n)*Math.tan(e._start.latitude);var u=1/Math.sqrt(1+s*s);var l=u*s;var c=Math.atan2(s,a);var d=u*o;var f=d*d;var h=1-f;var p=Math.sqrt(h);var m=t/4;var v=m*m;var _=v*m;var g=v*v;var y=1+m-3*v/4+5*_/4-175*g/64;var w=1-m+15*v/8-35*_/8;var C=1-3*m+35*v/4;var b=1-5*m;var S=y*c-w*Math.sin(2*c)*m/2-C*Math.sin(4*c)*v/16-b*Math.sin(6*c)*_/48-Math.sin(8*c)*5*g/512;var E=e._constants;E.a=r;E.b=i;E.f=n;E.cosineHeading=a;E.sineHeading=o;E.tanU=s;E.cosineU=u;E.sineU=l;E.sigma=c;E.sineAlpha=d;E.sineSquaredAlpha=f;E.cosineSquaredAlpha=h;E.cosineAlpha=p;E.u2Over4=m;E.u4Over16=v;E.u6Over64=_;E.u8Over256=g;E.a0=y;E.a1=w;E.a2=C;E.a3=b;E.distanceRatio=S}function l(e,t){return e*t*(4+e*(4-3*t))/16}function c(e,t,r,i,n,a,o){var s=l(e,r);return(1-s)*e*t*(i+s*n*(o+s*a*(2*o*o-1)))}function d(e,t,r,i,n,a,o){var u=(t-r)/t;var l=a-i;var d=Math.atan((1-u)*Math.tan(n));var f=Math.atan((1-u)*Math.tan(o));var h=Math.cos(d);var p=Math.sin(d);var m=Math.cos(f);var v=Math.sin(f);var _=h*m;var g=h*v;var y=p*v;var w=p*m;var C=l;var b=s.TWO_PI;var S=Math.cos(C);var E=Math.sin(C);var T;var x;var A;var P;var D;do{S=Math.cos(C);E=Math.sin(C);var M=g-w*S;A=Math.sqrt(m*m*E*E+M*M);x=y+_*S;T=Math.atan2(A,x);var I;if(A===0){I=0;P=1}else{I=_*E/A;P=1-I*I}b=C;D=x-2*y/P;if(isNaN(D)){D=0}C=l+c(u,I,P,T,A,x,D)}while(Math.abs(C-b)>s.EPSILON12);var O=P*(t*t-r*r)/(r*r);var R=1+O*(4096+O*(O*(320-175*O)-768))/16384;var N=O*(256+O*(O*(74-47*O)-128))/1024;var L=D*D;var B=N*A*(D+N*(x*(2*L-1)-N*D*(4*A*A-3)*(4*L-3)/6)/4);var F=r*R*(T-B);var k=Math.atan2(m*E,g-w*S);var V=Math.atan2(h*E,g*S-w);e._distance=F;e._startHeading=k;e._endHeading=V;e._uSquared=O}function f(r,i,n,o){var s=e.normalize(o.cartographicToCartesian(i,p),h);var l=e.normalize(o.cartographicToCartesian(n,p),p);if(Math.abs(Math.abs(e.angleBetween(s,l))-Math.PI)<.0125){throw new a("geodesic position is not unique")}d(r,o.maximumRadius,o.minimumRadius,i.longitude,i.latitude,n.longitude,n.latitude);r._start=t.clone(i,r._start);r._end=t.clone(n,r._end);r._start.height=0;r._end.height=0;u(r)}var h=new e;var p=new e;function m(e,n,a){var s=r(a,o.WGS84);this._ellipsoid=s;this._start=new t;this._end=new t;this._constants={};this._startHeading=undefined;this._endHeading=undefined;this._distance=undefined;this._uSquared=undefined;if(i(e)&&i(n)){f(this,e,n,s)}}n(m.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},surfaceDistance:{get:function(){if(!i(this._distance)){throw new a("set end positions before getting surfaceDistance")}return this._distance}},start:{get:function(){return this._start}},end:{get:function(){return this._end}},startHeading:{get:function(){if(!i(this._distance)){throw new a("set end positions before getting startHeading")}return this._startHeading}},endHeading:{get:function(){if(!i(this._distance)){throw new a("set end positions before getting endHeading")}return this._endHeading}}});m.prototype.setEndPoints=function(e,t){if(!i(e)){throw new a("start cartographic position is required")}if(!i(t)){throw new a("end cartgraphic position is required")}f(this,e,t,this._ellipsoid)};m.prototype.interpolateUsingFraction=function(e,t){return this.interpolateUsingSurfaceDistance(this._distance*e,t)};m.prototype.interpolateUsingSurfaceDistance=function(e,r){if(!i(this._distance)){throw new a("start and end must be set before calling function interpolateUsingSurfaceDistance")}var n=this._constants;var o=n.distanceRatio+e/n.b;var s=Math.cos(2*o);var u=Math.cos(4*o);var l=Math.cos(6*o);var d=Math.sin(2*o);var f=Math.sin(4*o);var h=Math.sin(6*o);var p=Math.sin(8*o);var m=o*o;var v=o*m;var _=n.u8Over256;var g=n.u2Over4;var y=n.u6Over64;var w=n.u4Over16;var C=2*v*_*s/3+o*(1-g+7*w/4-15*y/4+579*_/64-(w-15*y/4+187*_/16)*s-(5*y/4-115*_/16)*u-29*_*l/16)+(g/2-w+71*y/32-85*_/16)*d+(5*w/16-5*y/4+383*_/96)*f-m*((y-11*_/2)*d+5*_*f/2)+(29*y/96-29*_/16)*h+539*_*p/1536;var b=Math.asin(Math.sin(C)*n.cosineAlpha);var S=Math.atan(n.a/n.b*Math.tan(b));C=C-n.sigma;var E=Math.cos(2*n.sigma+C);var T=Math.sin(C);var x=Math.cos(C);var A=n.cosineU*x;var P=n.sineU*T;var D=Math.atan2(T*n.sineHeading,A-P*n.cosineHeading);var M=D-c(n.f,n.sineAlpha,n.cosineSquaredAlpha,C,T,x,E);if(i(r)){r.longitude=this._start.longitude+M;r.latitude=S;r.height=0;return r}return new t(this._start.longitude+M,S,0)};return m});define("Core/PolylinePipeline",["./Cartesian3","./Cartographic","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./EllipsoidGeodesic","./IntersectionTests","./isArray","./Math","./Matrix4","./Plane"],function(e,t,r,i,n,a,o,s,u,l,c,d){"use strict";var f={};f.numberOfPoints=function(t,r,i){var n=e.distance(t,r);return Math.ceil(n/i)};var h=new t;f.extractHeights=function(e,t){var r=e.length;var i=new Array(r);for(var n=0;n<r;n++){var a=e[n];i[n]=t.cartesianToCartographic(a,h).height}return i};var p=new c;var m=new e;var v=new e;var _=new d(e.ZERO,0);var g=new e;var y=new d(e.ZERO,0);var w=new e;var C=new e;var b=[];function S(e,t,r){var i=b;i.length=e;var n;if(t===r){for(n=0;n<e;n++){i[n]=t}return i}var a=r-t;var o=a/e;for(n=0;n<e;n++){var s=t+n*o;i[n]=s}return i}var E=new t;var T=new t;var x=new e;var A=new e;var P=new e;var D=new o;function M(t,r,i,n,a,o,s,u){var l=n.scaleToGeodeticSurface(t,A);var c=n.scaleToGeodeticSurface(r,P);var d=f.numberOfPoints(t,r,i);var h=n.cartesianToCartographic(l,E);var p=n.cartesianToCartographic(c,T);var m=S(d,a,o);D.setEndPoints(h,p);var v=D.surfaceDistance/d;var _=u;h.height=a;var g=n.cartographicToCartesian(h,x);e.pack(g,s,_);_+=3;for(var y=1;y<d;y++){var w=D.interpolateUsingSurfaceDistance(y*v,T);w.height=m[y];g=n.cartographicToCartesian(w,x);e.pack(g,s,_);_+=3}return _}f.wrapLongitude=function(t,n){var a=[];var o=[];if(i(t)&&t.length>0){n=r(n,c.IDENTITY);var u=c.inverseTransformation(n,p);var l=c.multiplyByPoint(u,e.ZERO,m);var f=c.multiplyByPointAsVector(u,e.UNIT_Y,v);var h=d.fromPointNormal(l,f,_);var b=c.multiplyByPointAsVector(u,e.UNIT_X,g);var S=d.fromPointNormal(l,b,y);var E=1;a.push(e.clone(t[0]));var T=a[0];var x=t.length;for(var A=1;A<x;++A){var P=t[A];if(d.getPointDistance(S,T)<0||d.getPointDistance(S,P)<0){var D=s.lineSegmentPlane(T,P,h,w);if(i(D)){var M=e.multiplyByScalar(f,5e-9,C);if(d.getPointDistance(h,T)<0){e.negate(M,M)}a.push(e.add(D,M,new e));o.push(E+1);e.negate(M,M);a.push(e.add(D,M,new e));E=1}}a.push(e.clone(t[A]));E++;T=P}o.push(E)}return{positions:a,lengths:o}};f.generateArc=function(t){if(!i(t)){t={}}var o=t.positions;if(!i(o)){throw new n("options.positions is required.")}var s=o.length;var c=r(t.ellipsoid,a.WGS84);var d=r(t.height,0);var h=u(d);if(s<1){return[]}else if(s===1){var p=c.scaleToGeodeticSurface(o[0],A);d=h?d[0]:d;if(d!==0){var m=c.geodeticSurfaceNormal(p,x);e.multiplyByScalar(m,d,m);e.add(p,m,p)}return[p.x,p.y,p.z]}var v=t.minDistance;if(!i(v)){var _=r(t.granularity,l.RADIANS_PER_DEGREE);v=l.chordLength(_,c.maximumRadius)}var g=0;var y;for(y=0;y<s-1;y++){g+=f.numberOfPoints(o[y],o[y+1],v)}var w=(g+1)*3;var C=new Array(w);var S=0;for(y=0;y<s-1;y++){var T=o[y];var P=o[y+1];var D=h?d[y]:d;var I=h?d[y+1]:d;S=M(T,P,v,c,D,I,C,S)}b.length=0;var O=o[s-1];var R=c.cartesianToCartographic(O,E);R.height=h?d[s-1]:d;var N=c.cartographicToCartesian(R,x);e.pack(N,C,w-3);return C};f.generateCartesianArc=function(t){var r=f.generateArc(t);var i=r.length/3;var n=new Array(i);for(var a=0;a<i;a++){n[a]=e.unpack(r,a*3)}return n};return f});define("Core/PolylineVolumeGeometryLibrary",["./Cartesian2","./Cartesian3","./Cartesian4","./Cartographic","./CornerType","./EllipsoidTangentPlane","./Math","./Matrix3","./Matrix4","./PolylinePipeline","./Quaternion","./Transforms"],function(e,t,r,i,n,a,o,s,u,l,c,d){"use strict";var f=[new t,new t];var h=new t;var p=new t;var m=new t;var v=new t;var _=new t;var g=new t;var y=new t;var w=new t;var C=new t;var b=new t;var S=new t;var E={};var T=new i;function x(e,t){var r=new Array(e.length);for(var i=0;i<e.length;i++){var n=e[i];T=t.cartesianToCartographic(n,T);r[i]=T.height;e[i]=t.scaleToGeodeticSurface(n,n)}return r}function A(e,r,i,n){var a=e[0];var o=e[1];var s=t.angleBetween(a,o);var u=Math.ceil(s/n);var l=new Array(u);var c;if(r===i){for(c=0;c<u;c++){l[c]=r}l.push(i);return l}var d=i-r;var f=d/u;for(c=1;c<u;c++){var h=r+c*f;l[c]=h}l[0]=r;l.push(i);return l}function P(r,i,n,o){var s=new a(n,o);var u=s.projectPointOntoPlane(t.add(n,r,j),j);var l=s.projectPointOntoPlane(t.add(n,i,Y),Y);var c=e.angleBetween(u,l);return l.x*u.y-l.y*u.x>=0?-c:c}var D=new t(-1,0,0);var M=new u;var I=new u;var O=new s;var R=s.IDENTITY.clone();var N=new t;var L=new r;var B=new t;function F(e,r,i,n,a,o,l,c){var f=N;var h=L;M=d.eastNorthUpToFixedFrame(e,a,M);f=u.multiplyByPointAsVector(M,D,f);f=t.normalize(f,f);var p=P(f,r,e,a);O=s.fromRotationZ(p,O);B.z=o;M=u.multiplyTransformation(M,u.fromRotationTranslation(O,B,I),M);var m=R;m[0]=l;for(var v=0;v<c;v++){for(var _=0;_<i.length;_+=3){h=t.fromArray(i,_,h);h=s.multiplyByVector(m,h,h);h=u.multiplyByPoint(M,h,h);n.push(h.x,h.y,h.z)}}return n}var k=new t;function V(e,r,i,n,a,o,s){for(var u=0;u<e.length;u+=3){var l=t.fromArray(e,u,k);n=F(l,r,i,n,a,o[u/3],s,1)}return n}function z(e,t){var r=e.length;var i=new Array(r*6);var n=0;var a=t.x+t.width/2;var o=t.y+t.height/2;var s=e[0];i[n++]=s.x-a;i[n++]=0;i[n++]=s.y-o;for(var u=1;u<r;u++){s=e[u];var l=s.x-a;var c=s.y-o;i[n++]=l;i[n++]=0;i[n++]=c;i[n++]=l;i[n++]=0;i[n++]=c}s=e[0];i[n++]=s.x-a;i[n++]=0;i[n++]=s.y-o;return i}function U(e,t){var r=e.length;var i=new Array(r*3);var n=0;var a=t.x+t.width/2;var o=t.y+t.height/2;for(var s=0;s<r;s++){i[n++]=e[s].x-a;i[n++]=0;i[n++]=e[s].y-o}return i}var q=new c;var G=new t;var H=new s;function W(e,r,i,a,u,l,d,f,h,p){var m=t.angleBetween(t.subtract(r,e,b),t.subtract(i,e,S));var v=a===n.BEVELED?0:Math.ceil(m/o.toRadians(5));var _;if(u){_=s.fromQuaternion(c.fromAxisAngle(t.negate(e,b),m/(v+1),q),H)}else{_=s.fromQuaternion(c.fromAxisAngle(e,m/(v+1),q),H)}var g;var y;r=t.clone(r,G);if(v>0){var w=p?2:1;for(var C=0;C<v;C++){r=s.multiplyByVector(_,r,r);g=t.subtract(r,e,b);g=t.normalize(g,g);if(!u){g=t.negate(g,g)}y=l.scaleToGeodeticSurface(r,S);d=F(y,g,f,d,l,h,1,w)}}else{g=t.subtract(r,e,b);g=t.normalize(g,g);if(!u){g=t.negate(g,g)}y=l.scaleToGeodeticSurface(r,S);d=F(y,g,f,d,l,h,1,1);i=t.clone(i,G);g=t.subtract(i,e,b);g=t.normalize(g,g);if(!u){g=t.negate(g,g)}y=l.scaleToGeodeticSurface(i,S);d=F(y,g,f,d,l,h,1,1)}return d}E.removeDuplicatesFromShape=function(t){var r=t.length;var i=[];for(var n=r-1,a=0;a<r;n=a++){var o=t[n];var s=t[a];if(!e.equals(o,s)){i.push(s)}}return i};var j=new t;var Y=new t;E.angleIsGreaterThanPi=function(e,r,i,n){var o=new a(i,n);var s=o.projectPointOntoPlane(t.add(i,e,j),j);var u=o.projectPointOntoPlane(t.add(i,r,Y),Y);return u.x*s.y-u.y*s.x>=0};var X=new t;var Z=new t;E.computePositions=function(e,r,i,a,s){var u=a._ellipsoid;var c=x(e,u);var d=a._granularity;var S=a._cornerType;var T=s?z(r,i):U(r,i);var P=s?U(r,i):undefined;var D=i.height/2;var M=i.width/2;var I=e.length;var O=[];var R=s?[]:undefined;var N=h;var L=p;var B=m;var k=v;var q=_;var G=g;var H=y;var j=w;var Y=C;var K=e[0];var Q=e[1];k=u.geodeticSurfaceNormal(K,k);N=t.subtract(Q,K,N);N=t.normalize(N,N);j=t.cross(k,N,j);j=t.normalize(j,j);var J=c[0];var $=c[1];if(s){R=F(K,j,P,R,u,J+D,1,1)}Y=t.clone(K,Y);K=Q;L=t.negate(N,L);var ee;var te;for(var re=1;re<I-1;re++){var ie=s?2:1;Q=e[re+1];N=t.subtract(Q,K,N);N=t.normalize(N,N);B=t.add(N,L,B);B=t.normalize(B,B);k=u.geodeticSurfaceNormal(K,k);var ne=t.multiplyByScalar(k,t.dot(N,k),X);t.subtract(N,ne,ne);t.normalize(ne,ne);var ae=t.multiplyByScalar(k,t.dot(L,k),Z);t.subtract(L,ae,ae);t.normalize(ae,ae);var oe=!o.equalsEpsilon(Math.abs(t.dot(ne,ae)),1,o.EPSILON7);if(oe){B=t.cross(B,k,B);B=t.cross(k,B,B);B=t.normalize(B,B);var se=1/Math.max(.25,t.magnitude(t.cross(B,L,b)));var ue=E.angleIsGreaterThanPi(N,L,K,u);if(ue){q=t.add(K,t.multiplyByScalar(B,se*M,B),q);G=t.add(q,t.multiplyByScalar(j,M,G),G);f[0]=t.clone(Y,f[0]);f[1]=t.clone(G,f[1]);ee=A(f,J+D,$+D,d);te=l.generateArc({positions:f,granularity:d,ellipsoid:u});O=V(te,j,T,O,u,ee,1);j=t.cross(k,N,j);j=t.normalize(j,j);H=t.add(q,t.multiplyByScalar(j,M,H),H);if(S===n.ROUNDED||S===n.BEVELED){W(q,G,H,S,ue,u,O,T,$+D,s)}else{B=t.negate(B,B);O=F(K,B,T,O,u,$+D,se,ie)}Y=t.clone(H,Y)}else{q=t.add(K,t.multiplyByScalar(B,se*M,B),q);G=t.add(q,t.multiplyByScalar(j,-M,G),G);f[0]=t.clone(Y,f[0]);f[1]=t.clone(G,f[1]);ee=A(f,J+D,$+D,d);te=l.generateArc({positions:f,granularity:d,ellipsoid:u});O=V(te,j,T,O,u,ee,1);j=t.cross(k,N,j);j=t.normalize(j,j);H=t.add(q,t.multiplyByScalar(j,-M,H),H);if(S===n.ROUNDED||S===n.BEVELED){W(q,G,H,S,ue,u,O,T,$+D,s)}else{O=F(K,B,T,O,u,$+D,se,ie)}Y=t.clone(H,Y)}L=t.negate(N,L)}else{O=F(Y,j,T,O,u,J+D,1,1);Y=K}J=$;$=c[re+1];K=Q}f[0]=t.clone(Y,f[0]);f[1]=t.clone(K,f[1]);ee=A(f,J+D,$+D,d);te=l.generateArc({positions:f,granularity:d,ellipsoid:u});O=V(te,j,T,O,u,ee,1);if(s){R=F(K,j,P,R,u,$+D,1,1)}I=O.length;var le=s?I+R.length:I;var ce=new Float64Array(le);ce.set(O);if(s){ce.set(R,I)}return ce};return E});define("Core/CorridorGeometryLibrary",["./Cartesian3","./CornerType","./defined","./Math","./Matrix3","./PolylinePipeline","./PolylineVolumeGeometryLibrary","./Quaternion"],function(e,t,r,i,n,a,o,s){"use strict";var u={};var l=new e;var c=new e;var d=new e;var f=new e;var h=[new e,new e];var p=new e;var m=new e;var v=new e;var _=new e;var g=new e;var y=new e;var w=new e;var C=new e;var b=new e;var S=new e;var E=new s;var T=new n;function x(r,a,o,u,d){var f=e.angleBetween(e.subtract(a,r,l),e.subtract(o,r,c));var h=u===t.BEVELED?1:Math.ceil(f/i.toRadians(5))+1;var p=h*3;var m=new Array(p);m[p-3]=o.x;m[p-2]=o.y;m[p-1]=o.z;var v;if(d){v=n.fromQuaternion(s.fromAxisAngle(e.negate(r,l),f/h,E),T)}else{v=n.fromQuaternion(s.fromAxisAngle(r,f/h,E),T)}var _=0;a=e.clone(a,l);for(var g=0;g<h;g++){a=n.multiplyByVector(v,a,a);m[_++]=a.x;m[_++]=a.y;m[_++]=a.z}return m}function A(r){var i=p;var n=m;var a=v;var o=r[1];n=e.fromArray(r[1],o.length-3,n);a=e.fromArray(r[0],0,a);i=e.multiplyByScalar(e.add(n,a,i),.5,i);var s=x(i,n,a,t.ROUNDED,false);var u=r.length-1;var l=r[u-1];o=r[u];n=e.fromArray(l,l.length-3,n);a=e.fromArray(o,0,a);i=e.multiplyByScalar(e.add(n,a,i),.5,i);var c=x(i,n,a,t.ROUNDED,false);return[s,c]}function P(t,r,i,n){var a=l;if(n){a=e.add(t,r,a)}else{r=e.negate(r,r);a=e.add(t,r,a)}return[a.x,a.y,a.z,i.x,i.y,i.z]}function D(t,r,i,n){var a=new Array(t.length);var o=new Array(t.length);var s=e.multiplyByScalar(r,i,l);var u=e.negate(s,c);var h=0;var p=t.length-1;for(var m=0;m<t.length;m+=3){var v=e.fromArray(t,m,d);var _=e.add(v,u,f);a[h++]=_.x;a[h++]=_.y;a[h++]=_.z;var g=e.add(v,s,f);o[p--]=g.z;o[p--]=g.y;o[p--]=g.x}n.push(a,o);return n}u.addAttribute=function(e,t,i,n){var a=t.x;var o=t.y;var s=t.z;if(r(i)){e[i]=a;e[i+1]=o;e[i+2]=s}if(r(n)){e[n]=s;e[n-1]=o;e[n-2]=a}};function M(e,t){for(var r=0;r<e.length;r++){e[r]=t.scaleToGeodeticSurface(e[r],e[r])}return e}var I=new e;var O=new e;u.computePositions=function(r){var n=r.granularity;var s=r.positions;var u=r.ellipsoid;s=M(s,u);var c=r.width/2;var d=r.cornerType;var f=r.saveAttributes;var E=p;var T=m;var R=v;var N=_;var L=g;var B=y;var F=w;var k=C;var V=b;var z=S;var U=[];var q=f?[]:undefined;var G=f?[]:undefined;var H=s[0];var W=s[1];T=e.normalize(e.subtract(W,H,T),T);E=u.geodeticSurfaceNormal(H,E);N=e.normalize(e.cross(E,T,N),N);if(f){q.push(N.x,N.y,N.z);G.push(E.x,E.y,E.z)}F=e.clone(H,F);H=W;R=e.negate(T,R);var j;var Y=[];var X;var Z=s.length;for(X=1;X<Z-1;X++){E=u.geodeticSurfaceNormal(H,E);W=s[X+1];T=e.normalize(e.subtract(W,H,T),T);L=e.normalize(e.add(T,R,L),L);var K=e.multiplyByScalar(E,e.dot(T,E),I);e.subtract(T,K,K);e.normalize(K,K);var Q=e.multiplyByScalar(E,e.dot(R,E),O);e.subtract(R,Q,Q);e.normalize(Q,Q);var J=!i.equalsEpsilon(Math.abs(e.dot(K,Q)),1,i.EPSILON7);if(J){L=e.cross(L,E,L);L=e.cross(E,L,L);L=e.normalize(L,L);var $=c/Math.max(.25,e.magnitude(e.cross(L,R,l)));var ee=o.angleIsGreaterThanPi(T,R,H,u);L=e.multiplyByScalar(L,$,L);if(ee){k=e.add(H,L,k);z=e.add(k,e.multiplyByScalar(N,c,z),z);V=e.add(k,e.multiplyByScalar(N,c*2,V),V);h[0]=e.clone(F,h[0]);h[1]=e.clone(z,h[1]);j=a.generateArc({positions:h,granularity:n,ellipsoid:u});U=D(j,N,c,U);if(f){q.push(N.x,N.y,N.z);G.push(E.x,E.y,E.z)}B=e.clone(V,B);N=e.normalize(e.cross(E,T,N),N);V=e.add(k,e.multiplyByScalar(N,c*2,V),V);F=e.add(k,e.multiplyByScalar(N,c,F),F);if(d===t.ROUNDED||d===t.BEVELED){Y.push({leftPositions:x(k,B,V,d,ee)})}else{Y.push({leftPositions:P(H,e.negate(L,L),V,ee)})}}else{V=e.add(H,L,V);z=e.add(V,e.negate(e.multiplyByScalar(N,c,z),z),z);k=e.add(V,e.negate(e.multiplyByScalar(N,c*2,k),k),k);h[0]=e.clone(F,h[0]);h[1]=e.clone(z,h[1]);j=a.generateArc({positions:h,granularity:n,ellipsoid:u});U=D(j,N,c,U);if(f){q.push(N.x,N.y,N.z);G.push(E.x,E.y,E.z)}B=e.clone(k,B);N=e.normalize(e.cross(E,T,N),N);k=e.add(V,e.negate(e.multiplyByScalar(N,c*2,k),k),k);F=e.add(V,e.negate(e.multiplyByScalar(N,c,F),F),F);if(d===t.ROUNDED||d===t.BEVELED){Y.push({rightPositions:x(V,B,k,d,ee)})}else{Y.push({rightPositions:P(H,L,k,ee)})}}R=e.negate(T,R)}H=W}E=u.geodeticSurfaceNormal(H,E);h[0]=e.clone(F,h[0]);h[1]=e.clone(H,h[1]);j=a.generateArc({positions:h,granularity:n,ellipsoid:u});U=D(j,N,c,U);if(f){q.push(N.x,N.y,N.z);G.push(E.x,E.y,E.z)}var te;if(d===t.ROUNDED){te=A(U)}return{positions:U,corners:Y,lefts:q,normals:G,endPositions:te}};return u});define("ThirdParty/earcut-2.1.1",[],function(){"use strict";function e(e,r,n){n=n||2;var a=r&&r.length,o=a?r[0]*n:e.length,s=t(e,0,o,n,true),l=[];if(!s)return l;var c,d,f,h,p,m,v;if(a)s=u(e,r,s,n);if(e.length>80*n){c=f=e[0];d=h=e[1];for(var _=n;_<o;_+=n){p=e[_];m=e[_+1];if(p<c)c=p;if(m<d)d=m;if(p>f)f=p;if(m>h)h=m}v=Math.max(f-c,h-d)}i(s,l,n,c,d,v);return l}function t(e,t,r,i,n){var a,o;if(n===P(e,t,r,i)>0){for(a=t;a<r;a+=i)o=T(a,e[a],e[a+1],o)}else{for(a=r-i;a>=t;a-=i)o=T(a,e[a],e[a+1],o)}if(o&&y(o,o.next)){x(o);o=o.next}return o}function r(e,t){if(!e)return e;if(!t)t=e;var r=e,i;do{i=false;if(!r.steiner&&(y(r,r.next)||g(r.prev,r,r.next)===0)){x(r);r=t=r.prev;if(r===r.next)return null;i=true}else{r=r.next}}while(i||r!==t);return t}function i(e,t,u,l,c,d,h){if(!e)return;if(!h&&d)f(e,l,c,d);var p=e,m,v;while(e.prev!==e.next){m=e.prev;v=e.next;if(d?a(e,l,c,d):n(e)){t.push(m.i/u);t.push(e.i/u);t.push(v.i/u);x(e);e=v.next;p=v.next;continue}e=v;if(e===p){if(!h){i(r(e),t,u,l,c,d,1)}else if(h===1){e=o(e,t,u);i(e,t,u,l,c,d,2)}else if(h===2){s(e,t,u,l,c,d)}break}}}function n(e){var t=e.prev,r=e,i=e.next;if(g(t,r,i)>=0)return false;var n=e.next.next;while(n!==e.prev){if(v(t.x,t.y,r.x,r.y,i.x,i.y,n.x,n.y)&&g(n.prev,n,n.next)>=0)return false;n=n.next}return true}function a(e,t,r,i){var n=e.prev,a=e,o=e.next;if(g(n,a,o)>=0)return false;var s=n.x<a.x?n.x<o.x?n.x:o.x:a.x<o.x?a.x:o.x,u=n.y<a.y?n.y<o.y?n.y:o.y:a.y<o.y?a.y:o.y,l=n.x>a.x?n.x>o.x?n.x:o.x:a.x>o.x?a.x:o.x,c=n.y>a.y?n.y>o.y?n.y:o.y:a.y>o.y?a.y:o.y;var d=p(s,u,t,r,i),f=p(l,c,t,r,i);var h=e.nextZ;while(h&&h.z<=f){if(h!==e.prev&&h!==e.next&&v(n.x,n.y,a.x,a.y,o.x,o.y,h.x,h.y)&&g(h.prev,h,h.next)>=0)return false;h=h.nextZ}h=e.prevZ;while(h&&h.z>=d){if(h!==e.prev&&h!==e.next&&v(n.x,n.y,a.x,a.y,o.x,o.y,h.x,h.y)&&g(h.prev,h,h.next)>=0)return false;h=h.prevZ}return true}function o(e,t,r){var i=e;do{var n=i.prev,a=i.next.next;if(!y(n,a)&&w(n,i,i.next,a)&&b(n,a)&&b(a,n)){t.push(n.i/r);t.push(i.i/r);t.push(a.i/r);x(i);x(i.next);i=e=a}i=i.next}while(i!==e);return i}function s(e,t,n,a,o,s){var u=e;do{var l=u.next.next;while(l!==u.prev){if(u.i!==l.i&&_(u,l)){var c=E(u,l);u=r(u,u.next);c=r(c,c.next);i(u,t,n,a,o,s);i(c,t,n,a,o,s);return}l=l.next}u=u.next}while(u!==e)}function u(e,i,n,a){var o=[],s,u,d,f,h;for(s=0,u=i.length;s<u;s++){d=i[s]*a;f=s<u-1?i[s+1]*a:e.length;h=t(e,d,f,a,false);if(h===h.next)h.steiner=true;o.push(m(h))}o.sort(l);for(s=0;s<o.length;s++){c(o[s],n);n=r(n,n.next)}return n}function l(e,t){return e.x-t.x}function c(e,t){t=d(e,t);if(t){var i=E(t,e);r(i,i.next)}}function d(e,t){var r=t,i=e.x,n=e.y,a=-Infinity,o;do{if(n<=r.y&&n>=r.next.y){var s=r.x+(n-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>a){a=s;if(s===i){if(n===r.y)return r;if(n===r.next.y)return r.next}o=r.x<r.next.x?r:r.next}}r=r.next}while(r!==t);if(!o)return null;if(i===a)return o.prev;var u=o,l=o.x,c=o.y,d=Infinity,f;r=o.next;while(r!==u){if(i>=r.x&&r.x>=l&&v(n<c?i:a,n,l,c,n<c?a:i,n,r.x,r.y)){f=Math.abs(n-r.y)/(i-r.x);if((f<d||f===d&&r.x>o.x)&&b(r,e)){o=r;d=f}}r=r.next}return o}function f(e,t,r,i){var n=e;do{if(n.z===null)n.z=p(n.x,n.y,t,r,i);n.prevZ=n.prev;n.nextZ=n.next;n=n.next}while(n!==e);n.prevZ.nextZ=null;n.prevZ=null;h(n)}function h(e){var t,r,i,n,a,o,s,u,l=1;do{r=e;e=null;a=null;o=0;while(r){o++;i=r;s=0;for(t=0;t<l;t++){s++;i=i.nextZ;if(!i)break}u=l;while(s>0||u>0&&i){if(s===0){n=i;i=i.nextZ;u--}else if(u===0||!i){n=r;r=r.nextZ;s--}else if(r.z<=i.z){n=r;r=r.nextZ;s--}else{n=i;i=i.nextZ;u--}if(a)a.nextZ=n;else e=n;n.prevZ=a;a=n}r=i}a.nextZ=null;l*=2}while(o>1);return e}function p(e,t,r,i,n){e=32767*(e-r)/n;t=32767*(t-i)/n;e=(e|e<<8)&16711935;e=(e|e<<4)&252645135;e=(e|e<<2)&858993459;e=(e|e<<1)&1431655765;t=(t|t<<8)&16711935;t=(t|t<<4)&252645135;t=(t|t<<2)&858993459;t=(t|t<<1)&1431655765;return e|t<<1}function m(e){var t=e,r=e;do{if(t.x<r.x)r=t;t=t.next}while(t!==e);return r}function v(e,t,r,i,n,a,o,s){return(n-o)*(t-s)-(e-o)*(a-s)>=0&&(e-o)*(i-s)-(r-o)*(t-s)>=0&&(r-o)*(a-s)-(n-o)*(i-s)>=0}function _(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!C(e,t)&&b(e,t)&&b(t,e)&&S(e,t)}function g(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function y(e,t){return e.x===t.x&&e.y===t.y}function w(e,t,r,i){if(y(e,t)&&y(r,i)||y(e,i)&&y(r,t))return true;return g(e,t,r)>0!==g(e,t,i)>0&&g(r,i,e)>0!==g(r,i,t)>0}function C(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&w(r,r.next,e,t))return true;r=r.next}while(r!==e);return false}function b(e,t){return g(e.prev,e,e.next)<0?g(e,t,e.next)>=0&&g(e,e.prev,t)>=0:g(e,t,e.prev)<0||g(e,e.next,t)<0}function S(e,t){var r=e,i=false,n=(e.x+t.x)/2,a=(e.y+t.y)/2;do{if(r.y>a!==r.next.y>a&&n<(r.next.x-r.x)*(a-r.y)/(r.next.y-r.y)+r.x)i=!i;r=r.next}while(r!==e);return i}function E(e,t){var r=new A(e.i,e.x,e.y),i=new A(t.i,t.x,t.y),n=e.next,a=t.prev;e.next=t;t.prev=e;r.next=n;n.prev=r;i.next=r;r.prev=i;a.next=i;i.prev=a;return i}function T(e,t,r,i){var n=new A(e,t,r);if(!i){n.prev=n;n.next=n}else{n.next=i.next;n.prev=i;i.next.prev=n;i.next=n}return n}function x(e){e.next.prev=e.prev;e.prev.next=e.next;if(e.prevZ)e.prevZ.nextZ=e.nextZ;if(e.nextZ)e.nextZ.prevZ=e.prevZ}function A(e,t,r){this.i=e;this.x=t;this.y=r;this.prev=null;this.next=null;this.z=null;this.prevZ=null;this.nextZ=null;this.steiner=false}e.deviation=function(e,t,r,i){var n=t&&t.length;var a=n?t[0]*r:e.length;var o=Math.abs(P(e,0,a,r));if(n){for(var s=0,u=t.length;s<u;s++){var l=t[s]*r;var c=s<u-1?t[s+1]*r:e.length;o-=Math.abs(P(e,l,c,r))}}var d=0;for(s=0;s<i.length;s+=3){var f=i[s]*r;var h=i[s+1]*r;var p=i[s+2]*r;d+=Math.abs((e[f]-e[p])*(e[h+1]-e[f+1])-(e[f]-e[h])*(e[p+1]-e[f+1]))}return o===0&&d===0?0:Math.abs((d-o)/o)};function P(e,t,r,i){var n=0;for(var a=t,o=r-i;a<r;a+=i){n+=(e[o]-e[a])*(e[a+1]+e[o+1]);o=a}return n}e.flatten=function(e){var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},i=0;for(var n=0;n<e.length;n++){for(var a=0;a<e[n].length;a++){for(var o=0;o<t;o++)r.vertices.push(e[n][a][o])}if(n>0){i+=e[n-1].length;r.holes.push(i)}}return r};return e});define("Core/WindingOrder",["./freezeObject","./WebGLConstants"],function(e,t){"use strict";var r={CLOCKWISE:t.CW,COUNTER_CLOCKWISE:t.CCW,validate:function(e){return e===r.CLOCKWISE||e===r.COUNTER_CLOCKWISE}};return e(r)})
;define("Core/PolygonPipeline",["../ThirdParty/earcut-2.1.1","./Cartesian2","./Cartesian3","./ComponentDatatype","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./Geometry","./GeometryAttribute","./Math","./PrimitiveType","./WindingOrder"],function(e,t,r,i,n,a,o,s,u,l,c,d,f){"use strict";var h=new r;var p=new r;var m={};m.computeArea2D=function(e){if(!a(e)){throw new o("positions is required.")}if(e.length<3){throw new o("At least three positions are required.")}var t=e.length;var r=0;for(var i=t-1,n=0;n<t;i=n++){var s=e[i];var u=e[n];r+=s.x*u.y-u.x*s.y}return r*.5};m.computeWindingOrder2D=function(e){var t=m.computeArea2D(e);return t>0?f.COUNTER_CLOCKWISE:f.CLOCKWISE};m.triangulate=function(r,i){if(!a(r)){throw new o("positions is required.")}var n=t.packArray(r);return e(n,i,2)};var v=new r;var _=new r;var g=new r;var y=new r;var w=new r;var C=new r;var b=new r;m.computeSubdivision=function(e,t,s,f){f=n(f,c.RADIANS_PER_DEGREE);if(!a(e)){throw new o("ellipsoid is required.")}if(!a(t)){throw new o("positions is required.")}if(!a(s)){throw new o("indices is required.")}if(s.length<3){throw new o("At least three indices are required.")}if(s.length%3!==0){throw new o("The number of indices must be divisable by three.")}if(f<=0){throw new o("granularity must be greater than zero.")}var h=s.slice(0);var p;var m=t.length;var S=new Array(m*3);var E=0;for(p=0;p<m;p++){var T=t[p];S[E++]=T.x;S[E++]=T.y;S[E++]=T.z}var x=[];var A={};var P=e.maximumRadius;var D=c.chordLength(f,P);var M=D*D;while(h.length>0){var I=h.pop();var O=h.pop();var R=h.pop();var N=r.fromArray(S,R*3,v);var L=r.fromArray(S,O*3,_);var B=r.fromArray(S,I*3,g);var F=r.multiplyByScalar(r.normalize(N,y),P,y);var k=r.multiplyByScalar(r.normalize(L,w),P,w);var V=r.multiplyByScalar(r.normalize(B,C),P,C);var z=r.magnitudeSquared(r.subtract(F,k,b));var U=r.magnitudeSquared(r.subtract(k,V,b));var q=r.magnitudeSquared(r.subtract(V,F,b));var G=Math.max(z,U,q);var H;var W;if(G>M){if(z===G){H=Math.min(R,O)+" "+Math.max(R,O);p=A[H];if(!a(p)){W=r.add(N,L,b);r.multiplyByScalar(W,.5,W);S.push(W.x,W.y,W.z);p=S.length/3-1;A[H]=p}h.push(R,p,I);h.push(p,O,I)}else if(U===G){H=Math.min(O,I)+" "+Math.max(O,I);p=A[H];if(!a(p)){W=r.add(L,B,b);r.multiplyByScalar(W,.5,W);S.push(W.x,W.y,W.z);p=S.length/3-1;A[H]=p}h.push(O,p,R);h.push(p,I,R)}else if(q===G){H=Math.min(I,R)+" "+Math.max(I,R);p=A[H];if(!a(p)){W=r.add(B,N,b);r.multiplyByScalar(W,.5,W);S.push(W.x,W.y,W.z);p=S.length/3-1;A[H]=p}h.push(I,p,O);h.push(p,R,O)}}else{x.push(R);x.push(O);x.push(I)}}return new u({attributes:{position:new l({componentDatatype:i.DOUBLE,componentsPerAttribute:3,values:S})},indices:x,primitiveType:d.TRIANGLES})};m.scaleToGeodeticHeight=function(e,t,i,o){i=n(i,s.WGS84);var u=h;var l=p;t=n(t,0);o=n(o,true);if(a(e)){var c=e.length;for(var d=0;d<c;d+=3){r.fromArray(e,d,l);if(o){l=i.scaleToGeodeticSurface(l,l)}if(t!==0){u=i.geodeticSurfaceNormal(l,u);r.multiplyByScalar(u,t,u);r.add(l,u,l)}e[d]=l.x;e[d+1]=l.y;e[d+2]=l.z}}return e};return m});define("Core/CorridorGeometry",["./arrayRemoveDuplicates","./BoundingSphere","./Cartesian3","./Cartographic","./ComponentDatatype","./CornerType","./CorridorGeometryLibrary","./defaultValue","./defined","./defineProperties","./DeveloperError","./Ellipsoid","./Geometry","./GeometryAttribute","./GeometryAttributes","./IndexDatatype","./Math","./PolygonPipeline","./PrimitiveType","./Rectangle","./VertexFormat"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w){"use strict";var C=new r;var b=new r;var S=new r;var E=new r;var T=new r;var x=new r;var A=new r;var P=new r;function D(e,t,i,n,a,s){var u=e.normals;var l=e.tangents;var c=e.bitangents;var d=r.normalize(r.cross(i,t,A),A);if(s.normal){o.addAttribute(u,t,n,a)}if(s.tangent){o.addAttribute(l,d,n,a)}if(s.bitangent){o.addAttribute(c,i,n,a)}}function M(e,t,i){var a=e.positions;var s=e.corners;var l=e.endPositions;var c=e.lefts;var d=e.normals;var f=new p;var _;var g=0;var y=0;var w;var T=0;var M;for(w=0;w<a.length;w+=2){M=a[w].length-3;g+=M;T+=M*2;y+=a[w+1].length-3}g+=3;y+=3;for(w=0;w<s.length;w++){_=s[w];var I=s[w].leftPositions;if(u(I)){M=I.length;g+=M;T+=M}else{M=s[w].rightPositions.length;y+=M;T+=M}}var O=u(l);var R;if(O){R=l[0].length-3;g+=R;y+=R;R/=3;T+=R*6}var N=g+y;var L=new Float64Array(N);var B=t.normal?new Float32Array(N):undefined;var F=t.tangent?new Float32Array(N):undefined;var k=t.bitangent?new Float32Array(N):undefined;var V={normals:B,tangents:F,bitangents:k};var z=0;var U=N-1;var q,G,H,W;var j=C;var Y=b;var X,Z;var K=R/2;var Q=m.createTypedArray(N/3,T);var J=0;if(O){Z=S;X=E;var $=l[0];j=r.fromArray(d,0,j);Y=r.fromArray(c,0,Y);for(w=0;w<K;w++){Z=r.fromArray($,(K-1-w)*3,Z);X=r.fromArray($,(K+w)*3,X);o.addAttribute(L,X,z);o.addAttribute(L,Z,undefined,U);D(V,j,Y,z,U,t);G=z/3;W=G+1;q=(U-2)/3;H=q-1;Q[J++]=q;Q[J++]=G;Q[J++]=H;Q[J++]=H;Q[J++]=G;Q[J++]=W;z+=3;U-=3}}var ee=0;var te=0;var re=a[ee++];var ie=a[ee++];L.set(re,z);L.set(ie,U-ie.length+1);Y=r.fromArray(c,te,Y);var ne;var ae;M=ie.length-3;for(w=0;w<M;w+=3){ne=i.geodeticSurfaceNormal(r.fromArray(re,w,A),A);ae=i.geodeticSurfaceNormal(r.fromArray(ie,M-w,P),P);j=r.normalize(r.add(ne,ae,j),j);D(V,j,Y,z,U,t);G=z/3;W=G+1;q=(U-2)/3;H=q-1;Q[J++]=q;Q[J++]=G;Q[J++]=H;Q[J++]=H;Q[J++]=G;Q[J++]=W;z+=3;U-=3}ne=i.geodeticSurfaceNormal(r.fromArray(re,M,A),A);ae=i.geodeticSurfaceNormal(r.fromArray(ie,M,P),P);j=r.normalize(r.add(ne,ae,j),j);te+=3;for(w=0;w<s.length;w++){var oe;_=s[w];var se=_.leftPositions;var ue=_.rightPositions;var le;var ce;var de=x;var fe=S;var he=E;j=r.fromArray(d,te,j);if(u(se)){D(V,j,Y,undefined,U,t);U-=3;le=W;ce=H;for(oe=0;oe<se.length/3;oe++){de=r.fromArray(se,oe*3,de);Q[J++]=le;Q[J++]=ce-oe-1;Q[J++]=ce-oe;o.addAttribute(L,de,undefined,U);fe=r.fromArray(L,(ce-oe-1)*3,fe);he=r.fromArray(L,le*3,he);Y=r.normalize(r.subtract(fe,he,Y),Y);D(V,j,Y,undefined,U,t);U-=3}de=r.fromArray(L,le*3,de);fe=r.subtract(r.fromArray(L,ce*3,fe),de,fe);he=r.subtract(r.fromArray(L,(ce-oe)*3,he),de,he);Y=r.normalize(r.add(fe,he,Y),Y);D(V,j,Y,z,undefined,t);z+=3}else{D(V,j,Y,z,undefined,t);z+=3;le=H;ce=W;for(oe=0;oe<ue.length/3;oe++){de=r.fromArray(ue,oe*3,de);Q[J++]=le;Q[J++]=ce+oe;Q[J++]=ce+oe+1;o.addAttribute(L,de,z);fe=r.fromArray(L,le*3,fe);he=r.fromArray(L,(ce+oe)*3,he);Y=r.normalize(r.subtract(fe,he,Y),Y);D(V,j,Y,z,undefined,t);z+=3}de=r.fromArray(L,le*3,de);fe=r.subtract(r.fromArray(L,(ce+oe)*3,fe),de,fe);he=r.subtract(r.fromArray(L,ce*3,he),de,he);Y=r.normalize(r.negate(r.add(he,fe,Y),Y),Y);D(V,j,Y,undefined,U,t);U-=3}re=a[ee++];ie=a[ee++];re.splice(0,3);ie.splice(ie.length-3,3);L.set(re,z);L.set(ie,U-ie.length+1);M=ie.length-3;te+=3;Y=r.fromArray(c,te,Y);for(oe=0;oe<ie.length;oe+=3){ne=i.geodeticSurfaceNormal(r.fromArray(re,oe,A),A);ae=i.geodeticSurfaceNormal(r.fromArray(ie,M-oe,P),P);j=r.normalize(r.add(ne,ae,j),j);D(V,j,Y,z,U,t);W=z/3;G=W-1;H=(U-2)/3;q=H+1;Q[J++]=q;Q[J++]=G;Q[J++]=H;Q[J++]=H;Q[J++]=G;Q[J++]=W;z+=3;U-=3}z-=3;U+=3}j=r.fromArray(d,d.length-3,j);D(V,j,Y,z,U,t);if(O){z+=3;U-=3;Z=S;X=E;var pe=l[1];for(w=0;w<K;w++){Z=r.fromArray(pe,(R-w-1)*3,Z);X=r.fromArray(pe,w*3,X);o.addAttribute(L,Z,undefined,U);o.addAttribute(L,X,z);D(V,j,Y,z,U,t);W=z/3;G=W-1;H=(U-2)/3;q=H+1;Q[J++]=q;Q[J++]=G;Q[J++]=H;Q[J++]=H;Q[J++]=G;Q[J++]=W;z+=3;U-=3}}f.position=new h({componentDatatype:n.DOUBLE,componentsPerAttribute:3,values:L});if(t.st){var me=new Float32Array(N/3*2);var ve;var _e;var ge=0;if(O){g/=3;y/=3;var ye=Math.PI/(R+1);_e=1/(g-R+1);ve=1/(y-R+1);var we;var Ce=R/2;for(w=Ce+1;w<R+1;w++){we=v.PI_OVER_TWO+ye*w;me[ge++]=ve*(1+Math.cos(we));me[ge++]=.5*(1+Math.sin(we))}for(w=1;w<y-R+1;w++){me[ge++]=w*ve;me[ge++]=0}for(w=R;w>Ce;w--){we=v.PI_OVER_TWO-w*ye;me[ge++]=1-ve*(1+Math.cos(we));me[ge++]=.5*(1+Math.sin(we))}for(w=Ce;w>0;w--){we=v.PI_OVER_TWO-ye*w;me[ge++]=1-_e*(1+Math.cos(we));me[ge++]=.5*(1+Math.sin(we))}for(w=g-R;w>0;w--){me[ge++]=w*_e;me[ge++]=1}for(w=1;w<Ce+1;w++){we=v.PI_OVER_TWO+ye*w;me[ge++]=_e*(1+Math.cos(we));me[ge++]=.5*(1+Math.sin(we))}}else{g/=3;y/=3;_e=1/(g-1);ve=1/(y-1);for(w=0;w<y;w++){me[ge++]=w*ve;me[ge++]=0}for(w=g;w>0;w--){me[ge++]=(w-1)*_e;me[ge++]=1}}f.st=new h({componentDatatype:n.FLOAT,componentsPerAttribute:2,values:me})}if(t.normal){f.normal=new h({componentDatatype:n.FLOAT,componentsPerAttribute:3,values:V.normals})}if(t.tangent){f.tangent=new h({componentDatatype:n.FLOAT,componentsPerAttribute:3,values:V.tangents})}if(t.bitangent){f.bitangent=new h({componentDatatype:n.FLOAT,componentsPerAttribute:3,values:V.bitangents})}return{attributes:f,indices:Q}}function I(e,t){if(!t.normal&&!t.tangent&&!t.bitangent&&!t.st){return e}var i=e.position.values;var n;var a;if(t.normal||t.bitangent){n=e.normal.values;a=e.bitangent.values}var s=e.position.values.length/18;var u=s*3;var l=s*2;var c=u*2;var d;if(t.normal||t.bitangent||t.tangent){var f=t.normal?new Float32Array(u*6):undefined;var h=t.tangent?new Float32Array(u*6):undefined;var p=t.bitangent?new Float32Array(u*6):undefined;var m=C;var v=b;var _=S;var g=E;var y=T;var w=x;var A=c;for(d=0;d<u;d+=3){var P=A+c;m=r.fromArray(i,d,m);v=r.fromArray(i,d+u,v);_=r.fromArray(i,(d+3)%u,_);v=r.subtract(v,m,v);_=r.subtract(_,m,_);g=r.normalize(r.cross(v,_,g),g);if(t.normal){o.addAttribute(f,g,P);o.addAttribute(f,g,P+3);o.addAttribute(f,g,A);o.addAttribute(f,g,A+3)}if(t.tangent||t.bitangent){w=r.fromArray(n,d,w);if(t.bitangent){o.addAttribute(p,w,P);o.addAttribute(p,w,P+3);o.addAttribute(p,w,A);o.addAttribute(p,w,A+3)}if(t.tangent){y=r.normalize(r.cross(w,g,y),y);o.addAttribute(h,y,P);o.addAttribute(h,y,P+3);o.addAttribute(h,y,A);o.addAttribute(h,y,A+3)}}A+=6}if(t.normal){f.set(n);for(d=0;d<u;d+=3){f[d+u]=-n[d];f[d+u+1]=-n[d+1];f[d+u+2]=-n[d+2]}e.normal.values=f}else{e.normal=undefined}if(t.bitangent){p.set(a);p.set(a,u);e.bitangent.values=p}else{e.bitangent=undefined}if(t.tangent){var D=e.tangent.values;h.set(D);h.set(D,u);e.tangent.values=h}}if(t.st){var M=e.st.values;var I=new Float32Array(l*6);I.set(M);I.set(M,l);var O=l*2;for(var R=0;R<2;R++){I[O++]=M[0];I[O++]=M[1];for(d=2;d<l;d+=2){var N=M[d];var L=M[d+1];I[O++]=N;I[O++]=L;I[O++]=N;I[O++]=L}I[O++]=M[0];I[O++]=M[1]}e.st.values=I}return e}function O(e,t,r){r[t++]=e[0];r[t++]=e[1];r[t++]=e[2];for(var i=3;i<e.length;i+=3){var n=e[i];var a=e[i+1];var o=e[i+2];r[t++]=n;r[t++]=a;r[t++]=o;r[t++]=n;r[t++]=a;r[t++]=o}r[t++]=e[0];r[t++]=e[1];r[t++]=e[2];return r}function R(e,t){var r=new w({position:t.position,normal:t.normal||t.bitangent||e.shadowVolume,tangent:t.tangent,bitangent:t.normal||t.bitangent,st:t.st});var i=e.ellipsoid;var a=o.computePositions(e);var s=M(a,r,i);var u=e.height;var l=e.extrudedHeight;var c=s.attributes;var d=s.indices;var f=c.position.values;var p=f.length;var v=new Float64Array(p*6);var g=new Float64Array(p);g.set(f);var y=new Float64Array(p*4);f=_.scaleToGeodeticHeight(f,u,i);y=O(f,0,y);g=_.scaleToGeodeticHeight(g,l,i);y=O(g,p*2,y);v.set(f);v.set(g,p);v.set(y,p*2);c.position.values=v;c=I(c,t);var C=p/3;if(e.shadowVolume){var b=c.normal.values;p=b.length;var S=new Float32Array(p*6);for(E=0;E<p;E++){b[E]=-b[E]}S.set(b,p);S=O(b,p*4,S);c.extrudeDirection=new h({componentDatatype:n.FLOAT,componentsPerAttribute:3,values:S});if(!t.normal){c.normal=undefined}}var E;var T=d.length;var x=C+C;var A=m.createTypedArray(v.length/3,T*2+x*3);A.set(d);var P=T;for(E=0;E<T;E+=3){var D=d[E];var R=d[E+1];var N=d[E+2];A[P++]=N+C;A[P++]=R+C;A[P++]=D+C}var L,B,F,k;for(E=0;E<x;E+=2){L=E+x;B=L+x;F=L+1;k=B+1;A[P++]=L;A[P++]=B;A[P++]=F;A[P++]=F;A[P++]=B;A[P++]=k}return{attributes:c,indices:A}}var N=new r;var L=new r;var B=new i;function F(e,t,i,n,a,o){var s=r.subtract(t,e,N);r.normalize(s,s);var u=i.geodeticSurfaceNormal(e,L);var l=r.cross(s,u,N);r.multiplyByScalar(l,n,l);var c=a.latitude;var d=a.longitude;var f=o.latitude;var h=o.longitude;r.add(e,l,L);i.cartesianToCartographic(L,B);var p=B.latitude;var m=B.longitude;c=Math.min(c,p);d=Math.min(d,m);f=Math.max(f,p);h=Math.max(h,m);r.subtract(e,l,L);i.cartesianToCartographic(L,B);p=B.latitude;m=B.longitude;c=Math.min(c,p);d=Math.min(d,m);f=Math.max(f,p);h=Math.max(h,m);a.latitude=c;a.longitude=d;o.latitude=f;o.longitude=h}var k=new r;var V=new r;var z=new i;var U=new i;function q(t,i,n,o){var s=e(t,r.equalsEpsilon);var u=s.length;if(u<2||n<=0){return new y}var l=n*.5;z.latitude=Number.POSITIVE_INFINITY;z.longitude=Number.POSITIVE_INFINITY;U.latitude=Number.NEGATIVE_INFINITY;U.longitude=Number.NEGATIVE_INFINITY;var c,d;if(o===a.ROUNDED){var f=s[0];r.subtract(f,s[1],k);r.normalize(k,k);r.multiplyByScalar(k,l,k);r.add(f,k,V);i.cartesianToCartographic(V,B);c=B.latitude;d=B.longitude;z.latitude=Math.min(z.latitude,c);z.longitude=Math.min(z.longitude,d);U.latitude=Math.max(U.latitude,c);U.longitude=Math.max(U.longitude,d)}for(var h=0;h<u-1;++h){F(s[h],s[h+1],i,l,z,U)}var p=s[u-1];r.subtract(p,s[u-2],k);r.normalize(k,k);r.multiplyByScalar(k,l,k);r.add(p,k,V);F(p,V,i,l,z,U);if(o===a.ROUNDED){i.cartesianToCartographic(V,B);c=B.latitude;d=B.longitude;z.latitude=Math.min(z.latitude,c);z.longitude=Math.min(z.longitude,d);U.latitude=Math.max(U.latitude,c);U.longitude=Math.max(U.longitude,d)}var m=new y;m.north=U.latitude;m.south=z.latitude;m.east=U.longitude;m.west=z.longitude;return m}function G(e){e=s(e,s.EMPTY_OBJECT);var t=e.positions;var i=e.width;if(!u(t)){throw new c("options.positions is required.")}if(!u(i)){throw new c("options.width is required.")}this._positions=t;this._ellipsoid=d.clone(s(e.ellipsoid,d.WGS84));this._vertexFormat=w.clone(s(e.vertexFormat,w.DEFAULT));this._width=i;this._height=s(e.height,0);this._extrudedHeight=s(e.extrudedHeight,this._height);this._cornerType=s(e.cornerType,a.ROUNDED);this._granularity=s(e.granularity,v.RADIANS_PER_DEGREE);this._shadowVolume=s(e.shadowVolume,false);this._workerName="createCorridorGeometry";this._rectangle=q(t,this._ellipsoid,i,this._cornerType);this.packedLength=1+t.length*r.packedLength+d.packedLength+w.packedLength+y.packedLength+6}G.pack=function(e,t,i){if(!u(e)){throw new c("value is required")}if(!u(t)){throw new c("array is required")}i=s(i,0);var n=e._positions;var a=n.length;t[i++]=a;for(var o=0;o<a;++o,i+=r.packedLength){r.pack(n[o],t,i)}d.pack(e._ellipsoid,t,i);i+=d.packedLength;w.pack(e._vertexFormat,t,i);i+=w.packedLength;y.pack(e._rectangle,t,i);i+=y.packedLength;t[i++]=e._width;t[i++]=e._height;t[i++]=e._extrudedHeight;t[i++]=e._cornerType;t[i++]=e._granularity;t[i]=e._shadowVolume?1:0;return t};var H=d.clone(d.UNIT_SPHERE);var W=new w;var j=new y;var Y={positions:undefined,ellipsoid:H,vertexFormat:W,width:undefined,height:undefined,extrudedHeight:undefined,cornerType:undefined,granularity:undefined,shadowVolume:undefined};G.unpack=function(e,t,i){if(!u(e)){throw new c("array is required")}t=s(t,0);var n=e[t++];var a=new Array(n);for(var o=0;o<n;++o,t+=r.packedLength){a[o]=r.unpack(e,t)}var l=d.unpack(e,t,H);t+=d.packedLength;var f=w.unpack(e,t,W);t+=w.packedLength;var h=y.unpack(e,t,j);t+=y.packedLength;var p=e[t++];var m=e[t++];var v=e[t++];var _=e[t++];var g=e[t++];var C=e[t]===1;if(!u(i)){Y.positions=a;Y.width=p;Y.height=m;Y.extrudedHeight=v;Y.cornerType=_;Y.granularity=g;Y.shadowVolume=C;return new G(Y)}i._positions=a;i._ellipsoid=d.clone(l,i._ellipsoid);i._vertexFormat=w.clone(f,i._vertexFormat);i._width=p;i._height=m;i._extrudedHeight=v;i._cornerType=_;i._granularity=g;i._rectangle=y.clone(h);i._shadowVolume=C;return i};G.createGeometry=function(i){var n=i._positions;var a=i._height;var s=i._width;var u=i._extrudedHeight;var l=a!==u;var c=e(n,r.equalsEpsilon);if(c.length<2||s<=0){return}var d=i._ellipsoid;var h=i._vertexFormat;var p={ellipsoid:d,positions:c,width:s,cornerType:i._cornerType,granularity:i._granularity,saveAttributes:true};var m;if(l){var v=Math.max(a,u);u=Math.min(a,u);a=v;p.height=a;p.extrudedHeight=u;p.shadowVolume=i._shadowVolume;m=R(p,h)}else{var y=o.computePositions(p);m=M(y,h,d);m.attributes.position.values=_.scaleToGeodeticHeight(m.attributes.position.values,a,d)}var w=m.attributes;var C=t.fromVertices(w.position.values,undefined,3);if(!h.position){m.attributes.position.values=undefined}return new f({attributes:w,indices:m.indices,primitiveType:g.TRIANGLES,boundingSphere:C})};G.createShadowVolume=function(e,t,r){var i=e._granularity;var n=e._ellipsoid;var a=t(i,n);var o=r(i,n);return new G({positions:e._positions,width:e._width,cornerType:e._cornerType,ellipsoid:n,granularity:i,extrudedHeight:a,height:o,vertexFormat:w.POSITION_ONLY,shadowVolume:true})};l(G.prototype,{rectangle:{get:function(){return this._rectangle}}});return G});define("Core/CorridorOutlineGeometry",["./arrayRemoveDuplicates","./BoundingSphere","./Cartesian3","./ComponentDatatype","./CornerType","./CorridorGeometryLibrary","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./Geometry","./GeometryAttribute","./GeometryAttributes","./IndexDatatype","./Math","./PolygonPipeline","./PrimitiveType"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v){"use strict";var _=new r;var g=new r;var y=new r;function w(e,t){var o=[];var u=e.positions;var l=e.corners;var c=e.endPositions;var p=new f;var m;var v=0;var w=0;var C;var b=0;var S;for(C=0;C<u.length;C+=2){S=u[C].length-3;v+=S;b+=S/3*4;w+=u[C+1].length-3}v+=3;w+=3;for(C=0;C<l.length;C++){m=l[C];var E=l[C].leftPositions;if(s(E)){S=E.length;v+=S;b+=S/3*2}else{S=l[C].rightPositions.length;w+=S;b+=S/3*2}}var T=s(c);var x;if(T){x=c[0].length-3;v+=x;w+=x;x/=3;b+=x*4}var A=v+w;var P=new Float64Array(A);var D=0;var M=A-1;var I,O,R,N;var L,B;var F=x/2;var k=h.createTypedArray(A/3,b+4);var V=0;k[V++]=D/3;k[V++]=(M-2)/3;if(T){o.push(D/3);B=_;L=g;var z=c[0];for(C=0;C<F;C++){B=r.fromArray(z,(F-1-C)*3,B);L=r.fromArray(z,(F+C)*3,L);a.addAttribute(P,L,D);a.addAttribute(P,B,undefined,M);O=D/3;N=O+1;I=(M-2)/3;R=I-1;k[V++]=I;k[V++]=R;k[V++]=O;k[V++]=N;D+=3;M-=3}}var U=0;var q=u[U++];var G=u[U++];P.set(q,D);P.set(G,M-G.length+1);S=G.length-3;o.push(D/3,(M-2)/3);for(C=0;C<S;C+=3){O=D/3;N=O+1;I=(M-2)/3;R=I-1;k[V++]=I;k[V++]=R;k[V++]=O;k[V++]=N;D+=3;M-=3}for(C=0;C<l.length;C++){var H;m=l[C];var W=m.leftPositions;var j=m.rightPositions;var Y;var X=y;if(s(W)){M-=3;Y=R;o.push(N);for(H=0;H<W.length/3;H++){X=r.fromArray(W,H*3,X);k[V++]=Y-H-1;k[V++]=Y-H;a.addAttribute(P,X,undefined,M);M-=3}o.push(Y-Math.floor(W.length/6));if(t===n.BEVELED){o.push((M-2)/3+1)}D+=3}else{D+=3;Y=N;o.push(R);for(H=0;H<j.length/3;H++){X=r.fromArray(j,H*3,X);k[V++]=Y+H;k[V++]=Y+H+1;a.addAttribute(P,X,D);D+=3}o.push(Y+Math.floor(j.length/6));if(t===n.BEVELED){o.push(D/3-1)}M-=3}q=u[U++];G=u[U++];q.splice(0,3);G.splice(G.length-3,3);P.set(q,D);P.set(G,M-G.length+1);S=G.length-3;for(H=0;H<G.length;H+=3){N=D/3;O=N-1;R=(M-2)/3;I=R+1;k[V++]=I;k[V++]=R;k[V++]=O;k[V++]=N;D+=3;M-=3}D-=3;M+=3;o.push(D/3,(M-2)/3)}if(T){D+=3;M-=3;B=_;L=g;var Z=c[1];for(C=0;C<F;C++){B=r.fromArray(Z,(x-C-1)*3,B);L=r.fromArray(Z,C*3,L);a.addAttribute(P,B,undefined,M);a.addAttribute(P,L,D);N=D/3;O=N-1;R=(M-2)/3;I=R+1;k[V++]=I;k[V++]=R;k[V++]=O;k[V++]=N;D+=3;M-=3}o.push(D/3)}else{o.push(D/3,(M-2)/3)}k[V++]=D/3;k[V++]=(M-2)/3;p.position=new d({componentDatatype:i.DOUBLE,componentsPerAttribute:3,values:P});return{attributes:p,indices:k,wallIndices:o}}function C(e){var t=e.ellipsoid;var r=a.computePositions(e);var i=w(r,e.cornerType);var n=i.wallIndices;var o=e.height;var s=e.extrudedHeight;var u=i.attributes;var l=i.indices;var c=u.position.values;var d=c.length;var f=new Float64Array(d);f.set(c);var p=new Float64Array(d*2);c=m.scaleToGeodeticHeight(c,o,t);f=m.scaleToGeodeticHeight(f,s,t);p.set(c);p.set(f,d);u.position.values=p;d/=3;var v;var _=l.length;var g=h.createTypedArray(p.length/3,(_+n.length)*2);g.set(l);var y=_;for(v=0;v<_;v+=2){var C=l[v];var b=l[v+1];g[y++]=C+d;g[y++]=b+d}var S,E;for(v=0;v<n.length;v++){S=n[v];E=S+d;g[y++]=S;g[y++]=E}return{attributes:u,indices:g}}function b(e){e=o(e,o.EMPTY_OBJECT);var t=e.positions;var i=e.width;if(!s(t)){throw new u("options.positions is required.")}if(!s(i)){throw new u("options.width is required.")}this._positions=t;this._ellipsoid=l.clone(o(e.ellipsoid,l.WGS84));this._width=i;this._height=o(e.height,0);this._extrudedHeight=o(e.extrudedHeight,this._height);this._cornerType=o(e.cornerType,n.ROUNDED);this._granularity=o(e.granularity,p.RADIANS_PER_DEGREE);this._workerName="createCorridorOutlineGeometry";this.packedLength=1+t.length*r.packedLength+l.packedLength+5}b.pack=function(e,t,i){if(!s(e)){throw new u("value is required")}if(!s(t)){throw new u("array is required")}i=o(i,0);var n=e._positions;var a=n.length;t[i++]=a;for(var c=0;c<a;++c,i+=r.packedLength){r.pack(n[c],t,i)}l.pack(e._ellipsoid,t,i);i+=l.packedLength;t[i++]=e._width;t[i++]=e._height;t[i++]=e._extrudedHeight;t[i++]=e._cornerType;t[i]=e._granularity;return t};var S=l.clone(l.UNIT_SPHERE);var E={positions:undefined,ellipsoid:S,width:undefined,height:undefined,extrudedHeight:undefined,cornerType:undefined,granularity:undefined};b.unpack=function(e,t,i){if(!s(e)){throw new u("array is required")}t=o(t,0);var n=e[t++];var a=new Array(n);for(var c=0;c<n;++c,t+=r.packedLength){a[c]=r.unpack(e,t)}var d=l.unpack(e,t,S);t+=l.packedLength;var f=e[t++];var h=e[t++];var p=e[t++];var m=e[t++];var v=e[t];if(!s(i)){E.positions=a;E.width=f;E.height=h;E.extrudedHeight=p;E.cornerType=m;E.granularity=v;return new b(E)}i._positions=a;i._ellipsoid=l.clone(d,i._ellipsoid);i._width=f;i._height=h;i._extrudedHeight=p;i._cornerType=m;i._granularity=v;return i};b.createGeometry=function(i){var n=i._positions;var o=i._height;var s=i._width;var u=i._extrudedHeight;var l=o!==u;var d=e(n,r.equalsEpsilon);if(d.length<2||s<=0){return}var f=i._ellipsoid;var h={ellipsoid:f,positions:d,width:s,cornerType:i._cornerType,granularity:i._granularity,saveAttributes:false};var p;if(l){var _=Math.max(o,u);u=Math.min(o,u);o=_;h.height=o;h.extrudedHeight=u;p=C(h)}else{var g=a.computePositions(h);p=w(g,h.cornerType);p.attributes.position.values=m.scaleToGeodeticHeight(p.attributes.position.values,o,f)}var y=p.attributes;var b=t.fromVertices(y.position.values,undefined,3);return new c({attributes:y,indices:p.indices,primitiveType:v.LINES,boundingSphere:b})};return b});define("Core/createGuid",[],function(){"use strict";function e(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=Math.random()*16|0;var r=e==="x"?t:t&3|8;return r.toString(16)})}return e});define("Core/CylinderGeometryLibrary",["./Math"],function(e){"use strict";var t={};t.computePositions=function(t,r,i,n,a){var o=t*.5;var s=-o;var u=n+n;var l=a?2*u:u;var c=new Float64Array(l*3);var d;var f=0;var h=0;var p=a?u*3:0;var m=a?(u+n)*3:n*3;for(d=0;d<n;d++){var v=d/n*e.TWO_PI;var _=Math.cos(v);var g=Math.sin(v);var y=_*i;var w=g*i;var C=_*r;var b=g*r;c[h+p]=y;c[h+p+1]=w;c[h+p+2]=s;c[h+m]=C;c[h+m+1]=b;c[h+m+2]=o;h+=3;if(a){c[f++]=y;c[f++]=w;c[f++]=s;c[f++]=C;c[f++]=b;c[f++]=o}}return c};return t});define("Core/CylinderGeometry",["./BoundingSphere","./Cartesian2","./Cartesian3","./ComponentDatatype","./CylinderGeometryLibrary","./defaultValue","./defined","./DeveloperError","./Geometry","./GeometryAttribute","./GeometryAttributes","./IndexDatatype","./Math","./PrimitiveType","./VertexFormat"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p){"use strict";var m=new t;var v=new r;var _=new r;var g=new r;var y=new r;function w(e){e=a(e,a.EMPTY_OBJECT);var t=e.length;var r=e.topRadius;var i=e.bottomRadius;var n=a(e.vertexFormat,p.DEFAULT);var u=a(e.slices,128);if(!o(t)){throw new s("options.length must be defined.")}if(!o(r)){throw new s("options.topRadius must be defined.")}if(!o(i)){throw new s("options.bottomRadius must be defined.")}if(u<3){throw new s("options.slices must be greater than or equal to 3.")}this._length=t;this._topRadius=r;this._bottomRadius=i;this._vertexFormat=p.clone(n);this._slices=u;this._workerName="createCylinderGeometry"}w.packedLength=p.packedLength+4;w.pack=function(e,t,r){if(!o(e)){throw new s("value is required")}if(!o(t)){throw new s("array is required")}r=a(r,0);p.pack(e._vertexFormat,t,r);r+=p.packedLength;t[r++]=e._length;t[r++]=e._topRadius;t[r++]=e._bottomRadius;t[r]=e._slices;return t};var C=new p;var b={vertexFormat:C,length:undefined,topRadius:undefined,bottomRadius:undefined,slices:undefined};w.unpack=function(e,t,r){if(!o(e)){throw new s("array is required")}t=a(t,0);var i=p.unpack(e,t,C);t+=p.packedLength;var n=e[t++];var u=e[t++];var l=e[t++];var c=e[t];if(!o(r)){b.length=n;b.topRadius=u;b.bottomRadius=l;b.slices=c;return new w(b)}r._vertexFormat=p.clone(i,r._vertexFormat);r._length=n;r._topRadius=u;r._bottomRadius=l;r._slices=c;return r};w.createGeometry=function(a){var o=a._length;var s=a._topRadius;var p=a._bottomRadius;var w=a._vertexFormat;var C=a._slices;if(o<=0||s<0||p<0||s===0&&p===0){return}var b=C+C;var S=C+b;var E=b+b;var T=n.computePositions(o,s,p,C,true);var x=w.st?new Float32Array(E*2):undefined;var A=w.normal?new Float32Array(E*3):undefined;var P=w.tangent?new Float32Array(E*3):undefined;var D=w.bitangent?new Float32Array(E*3):undefined;var M;var I=w.normal||w.tangent||w.bitangent;if(I){var O=w.tangent||w.bitangent;var R=0;var N=0;var L=0;var B=v;B.z=0;var F=g;var k=_;for(M=0;M<C;M++){var V=M/C*f.TWO_PI;var z=Math.cos(V);var U=Math.sin(V);if(I){B.x=z;B.y=U;if(O){F=r.normalize(r.cross(r.UNIT_Z,B,F),F)}if(w.normal){A[R++]=z;A[R++]=U;A[R++]=0;A[R++]=z;A[R++]=U;A[R++]=0}if(w.tangent){P[N++]=F.x;P[N++]=F.y;P[N++]=F.z;P[N++]=F.x;P[N++]=F.y;P[N++]=F.z}if(w.bitangent){k=r.normalize(r.cross(B,F,k),k);D[L++]=k.x;D[L++]=k.y;D[L++]=k.z;D[L++]=k.x;D[L++]=k.y;D[L++]=k.z}}}for(M=0;M<C;M++){if(w.normal){A[R++]=0;A[R++]=0;A[R++]=-1}if(w.tangent){P[N++]=1;P[N++]=0;P[N++]=0}if(w.bitangent){D[L++]=0;D[L++]=-1;D[L++]=0}}for(M=0;M<C;M++){if(w.normal){A[R++]=0;A[R++]=0;A[R++]=1}if(w.tangent){P[N++]=1;P[N++]=0;P[N++]=0}if(w.bitangent){D[L++]=0;D[L++]=1;D[L++]=0}}}var q=12*C-12;var G=d.createTypedArray(E,q);var H=0;var W=0;for(M=0;M<C-1;M++){G[H++]=W;G[H++]=W+2;G[H++]=W+3;G[H++]=W;G[H++]=W+3;G[H++]=W+1;W+=2}G[H++]=b-2;G[H++]=0;G[H++]=1;G[H++]=b-2;G[H++]=1;G[H++]=b-1;for(M=1;M<C-1;M++){G[H++]=b+M+1;G[H++]=b+M;G[H++]=b}for(M=1;M<C-1;M++){G[H++]=S;G[H++]=S+M;G[H++]=S+M+1}var j=0;if(w.st){var Y=Math.max(s,p);for(M=0;M<E;M++){var X=r.fromArray(T,M*3,y);x[j++]=(X.x+Y)/(2*Y);x[j++]=(X.y+Y)/(2*Y)}}var Z=new c;if(w.position){Z.position=new l({componentDatatype:i.DOUBLE,componentsPerAttribute:3,values:T})}if(w.normal){Z.normal=new l({componentDatatype:i.FLOAT,componentsPerAttribute:3,values:A})}if(w.tangent){Z.tangent=new l({componentDatatype:i.FLOAT,componentsPerAttribute:3,values:P})}if(w.bitangent){Z.bitangent=new l({componentDatatype:i.FLOAT,componentsPerAttribute:3,values:D})}if(w.st){Z.st=new l({componentDatatype:i.FLOAT,componentsPerAttribute:2,values:x})}m.x=o*.5;m.y=Math.max(p,s);var K=new e(r.ZERO,t.magnitude(m));return new u({attributes:Z,indices:G,primitiveType:h.TRIANGLES,boundingSphere:K})};return w});define("Core/CylinderOutlineGeometry",["./BoundingSphere","./Cartesian2","./Cartesian3","./ComponentDatatype","./CylinderGeometryLibrary","./defaultValue","./defined","./DeveloperError","./Geometry","./GeometryAttribute","./GeometryAttributes","./IndexDatatype","./PrimitiveType"],function(e,t,r,i,n,a,o,s,u,l,c,d,f){"use strict";var h=new t;function p(e){e=a(e,a.EMPTY_OBJECT);var t=e.length;var r=e.topRadius;var i=e.bottomRadius;var n=a(e.slices,128);var u=Math.max(a(e.numberOfVerticalLines,16),0);if(!o(t)){throw new s("options.length must be defined.")}if(!o(r)){throw new s("options.topRadius must be defined.")}if(!o(i)){throw new s("options.bottomRadius must be defined.")}if(n<3){throw new s("options.slices must be greater than or equal to 3.")}this._length=t;this._topRadius=r;this._bottomRadius=i;this._slices=n;this._numberOfVerticalLines=u;this._workerName="createCylinderOutlineGeometry"}p.packedLength=5;p.pack=function(e,t,r){if(!o(e)){throw new s("value is required")}if(!o(t)){throw new s("array is required")}r=a(r,0);t[r++]=e._length;t[r++]=e._topRadius;t[r++]=e._bottomRadius;t[r++]=e._slices;t[r]=e._numberOfVerticalLines;return t};var m={length:undefined,topRadius:undefined,bottomRadius:undefined,slices:undefined,numberOfVerticalLines:undefined};p.unpack=function(e,t,r){if(!o(e)){throw new s("array is required")}t=a(t,0);var i=e[t++];var n=e[t++];var u=e[t++];var l=e[t++];var c=e[t];if(!o(r)){m.length=i;m.topRadius=n;m.bottomRadius=u;m.slices=l;m.numberOfVerticalLines=c;return new p(m)}r._length=i;r._topRadius=n;r._bottomRadius=u;r._slices=l;r._numberOfVerticalLines=c;return r};p.createGeometry=function(a){var o=a._length;var s=a._topRadius;var p=a._bottomRadius;var m=a._slices;var v=a._numberOfVerticalLines;if(o<=0||s<0||p<0||s===0&&p===0){return}var _=m*2;var g=n.computePositions(o,s,p,m,false);var y=m*2;var w;if(v>0){var C=Math.min(v,m);w=Math.round(m/C);y+=C}var b=d.createTypedArray(_,y*2);var S=0;for(var E=0;E<m-1;E++){b[S++]=E;b[S++]=E+1;b[S++]=E+m;b[S++]=E+1+m}b[S++]=m-1;b[S++]=0;b[S++]=m+m-1;b[S++]=m;if(v>0){for(E=0;E<m;E+=w){b[S++]=E;b[S++]=E+m}}var T=new c;T.position=new l({componentDatatype:i.DOUBLE,componentsPerAttribute:3,values:g});h.x=o*.5;h.y=Math.max(p,s);var x=new e(r.ZERO,t.magnitude(h));return new u({attributes:T,indices:b,primitiveType:f.LINES,boundingSphere:x})};return p});define("Core/DefaultProxy",[],function(){"use strict";function e(e){this.proxy=e}e.prototype.getURL=function(e){var t=this.proxy.indexOf("?")===-1?"?":"";return this.proxy+t+encodeURIComponent(e)};return e});define("Core/DistanceDisplayCondition",["./defaultValue","./defined","./defineProperties"],function(e,t,r){"use strict";function i(t,r){t=e(t,0);this._near=t;r=e(r,Number.MAX_VALUE);this._far=r}r(i.prototype,{near:{get:function(){return this._near},set:function(e){this._near=e}},far:{get:function(){return this._far},set:function(e){this._far=e}}});i.equals=function(e,r){return e===r||t(e)&&t(r)&&e.near===r.near&&e.far===r.far};i.clone=function(e,r){if(!t(e)){return undefined}if(!t(r)){r=new i}r.near=e.near;r.far=e.far;return r};i.prototype.clone=function(e){return i.clone(this,e)};i.prototype.equals=function(e){return i.equals(this,e)};return i});define("Core/DistanceDisplayConditionGeometryInstanceAttribute",["./ComponentDatatype","./defaultValue","./defined","./defineProperties","./DeveloperError"],function(e,t,r,i,n){"use strict";function a(e,r){e=t(e,0);r=t(r,Number.MAX_VALUE);if(r<=e){throw new n("far distance must be greater than near distance.")}this.value=new Float32Array([e,r])}i(a.prototype,{componentDatatype:{get:function(){return e.FLOAT}},componentsPerAttribute:{get:function(){return 2}},normalize:{get:function(){return false}}});a.fromDistanceDisplayCondition=function(e){if(!r(e)){throw new n("distanceDisplayCondition is required.")}if(e.far<=e.near){throw new n("distanceDisplayCondition.far distance must be greater than distanceDisplayCondition.near distance.")}return new a(e.near,e.far)};a.toValue=function(e,t){if(!r(e)){throw new n("distanceDisplayCondition is required.")}if(!r(t)){return new Float32Array([e.near,e.far])}t[0]=e.near;t[1]=e.far;return t};return a});define("Core/DoublyLinkedList",["../Core/defined","../Core/defineProperties","../Core/DeveloperError"],function(e,t,r){"use strict";function i(){this.head=undefined;this.tail=undefined;this._length=0}t(i.prototype,{length:{get:function(){return this._length}}});function n(e,t,r){this.item=e;this.previous=t;this.next=r}i.prototype.add=function(t){var r=new n(t,this.tail,undefined);if(e(this.tail)){this.tail.next=r;this.tail=r}else{this.head=r;this.tail=r}++this._length;return r};function a(t,r){if(e(r.previous)&&e(r.next)){r.previous.next=r.next;r.next.previous=r.previous}else if(e(r.previous)){r.previous.next=undefined;t.tail=r.previous}else if(e(r.next)){r.next.previous=undefined;t.head=r.next}else{t.head=undefined;t.tail=undefined}r.next=undefined;r.previous=undefined}i.prototype.remove=function(t){if(!e(t)){return}a(this,t);--this._length};i.prototype.splice=function(t,i){if(!e(t)||!e(i)){throw new r("node and nextNode are required.")}if(t===i){return}a(this,i);var n=t.next;t.next=i;if(this.tail===t){this.tail=i}else{n.previous=i}i.next=n;i.previous=t};return i})
;define("ThirdParty/Tween",[],function(){if(Date.now===undefined){Date.now=function(){return(new Date).valueOf()}}var e=e||function(){var e=[];return{REVISION:"13",getAll:function(){return e},removeAll:function(){e=[]},add:function(t){e.push(t)},remove:function(t){var r=e.indexOf(t);if(r!==-1){e.splice(r,1)}},update:function(t){if(e.length===0)return false;var r=0;t=t!==undefined?t:typeof window!=="undefined"&&window.performance!==undefined&&window.performance.now!==undefined?window.performance.now():Date.now();while(r<e.length){if(e[r].update(t)){r++}else{e.splice(r,1)}}return true}}}();e.Tween=function(t){var r=t;var i={};var n={};var a={};var o=1e3;var s=0;var u=false;var l=false;var c=false;var d=0;var f=null;var h=e.Easing.Linear.None;var p=e.Interpolation.Linear;var m=[];var v=null;var _=false;var g=null;var y=null;var w=null;for(var C in t){i[C]=parseFloat(t[C],10)}this.to=function(e,t){if(t!==undefined){o=t}n=e;return this};this.start=function(t){e.add(this);l=true;_=false;f=t!==undefined?t:typeof window!=="undefined"&&window.performance!==undefined&&window.performance.now!==undefined?window.performance.now():Date.now();f+=d;for(var o in n){if(n[o]instanceof Array){if(n[o].length===0){continue}n[o]=[r[o]].concat(n[o])}i[o]=r[o];if(i[o]instanceof Array===false){i[o]*=1}a[o]=i[o]||0}return this};this.stop=function(){if(!l){return this}e.remove(this);l=false;if(w!==null){w.call(r)}this.stopChainedTweens();return this};this.stopChainedTweens=function(){for(var e=0,t=m.length;e<t;e++){m[e].stop()}};this.delay=function(e){d=e;return this};this.repeat=function(e){s=e;return this};this.yoyo=function(e){u=e;return this};this.easing=function(e){h=e;return this};this.interpolation=function(e){p=e;return this};this.chain=function(){m=arguments;return this};this.onStart=function(e){v=e;return this};this.onUpdate=function(e){g=e;return this};this.onComplete=function(e){y=e;return this};this.onStop=function(e){w=e;return this};this.update=function(e){var t;if(e<f){return true}if(_===false){if(v!==null){v.call(r)}_=true}var l=(e-f)/o;l=l>1?1:l;var w=h(l);for(t in n){var C=i[t]||0;var b=n[t];if(b instanceof Array){r[t]=p(b,w)}else{if(typeof b==="string"){b=C+parseFloat(b,10)}if(typeof b==="number"){r[t]=C+(b-C)*w}}}if(g!==null){g.call(r,w)}if(l==1){if(s>0){if(isFinite(s)){s--}for(t in a){if(typeof n[t]==="string"){a[t]=a[t]+parseFloat(n[t],10)}if(u){var S=a[t];a[t]=n[t];n[t]=S}i[t]=a[t]}if(u){c=!c}f=e+d;return true}else{if(y!==null){y.call(r)}for(var E=0,T=m.length;E<T;E++){m[E].start(e)}return false}}return true}};e.Easing={Linear:{None:function(e){return e}},Quadratic:{In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){if((e*=2)<1)return.5*e*e;return-.5*(--e*(e-2)-1)}},Cubic:{In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){if((e*=2)<1)return.5*e*e*e;return.5*((e-=2)*e*e+2)}},Quartic:{In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){if((e*=2)<1)return.5*e*e*e*e;return-.5*((e-=2)*e*e*e-2)}},Quintic:{In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){if((e*=2)<1)return.5*e*e*e*e*e;return.5*((e-=2)*e*e*e*e+2)}},Sinusoidal:{In:function(e){return 1-Math.cos(e*Math.PI/2)},Out:function(e){return Math.sin(e*Math.PI/2)},InOut:function(e){return.5*(1-Math.cos(Math.PI*e))}},Exponential:{In:function(e){return e===0?0:Math.pow(1024,e-1)},Out:function(e){return e===1?1:1-Math.pow(2,-10*e)},InOut:function(e){if(e===0)return 0;if(e===1)return 1;if((e*=2)<1)return.5*Math.pow(1024,e-1);return.5*(-Math.pow(2,-10*(e-1))+2)}},Circular:{In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){if((e*=2)<1)return-.5*(Math.sqrt(1-e*e)-1);return.5*(Math.sqrt(1-(e-=2)*e)+1)}},Elastic:{In:function(e){var t,r=.1,i=.4;if(e===0)return 0;if(e===1)return 1;if(!r||r<1){r=1;t=i/4}else t=i*Math.asin(1/r)/(2*Math.PI);return-(r*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/i))},Out:function(e){var t,r=.1,i=.4;if(e===0)return 0;if(e===1)return 1;if(!r||r<1){r=1;t=i/4}else t=i*Math.asin(1/r)/(2*Math.PI);return r*Math.pow(2,-10*e)*Math.sin((e-t)*(2*Math.PI)/i)+1},InOut:function(e){var t,r=.1,i=.4;if(e===0)return 0;if(e===1)return 1;if(!r||r<1){r=1;t=i/4}else t=i*Math.asin(1/r)/(2*Math.PI);if((e*=2)<1)return-.5*(r*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/i));return r*Math.pow(2,-10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/i)*.5+1}},Back:{In:function(e){var t=1.70158;return e*e*((t+1)*e-t)},Out:function(e){var t=1.70158;return--e*e*((t+1)*e+t)+1},InOut:function(e){var t=1.70158*1.525;if((e*=2)<1)return.5*(e*e*((t+1)*e-t));return.5*((e-=2)*e*((t+1)*e+t)+2)}},Bounce:{In:function(t){return 1-e.Easing.Bounce.Out(1-t)},Out:function(e){if(e<1/2.75){return 7.5625*e*e}else if(e<2/2.75){return 7.5625*(e-=1.5/2.75)*e+.75}else if(e<2.5/2.75){return 7.5625*(e-=2.25/2.75)*e+.9375}else{return 7.5625*(e-=2.625/2.75)*e+.984375}},InOut:function(t){if(t<.5)return e.Easing.Bounce.In(t*2)*.5;return e.Easing.Bounce.Out(t*2-1)*.5+.5}}};e.Interpolation={Linear:function(t,r){var i=t.length-1,n=i*r,a=Math.floor(n),o=e.Interpolation.Utils.Linear;if(r<0)return o(t[0],t[1],n);if(r>1)return o(t[i],t[i-1],i-n);return o(t[a],t[a+1>i?i:a+1],n-a)},Bezier:function(t,r){var i=0,n=t.length-1,a=Math.pow,o=e.Interpolation.Utils.Bernstein,s;for(s=0;s<=n;s++){i+=a(1-r,n-s)*a(r,s)*t[s]*o(n,s)}return i},CatmullRom:function(t,r){var i=t.length-1,n=i*r,a=Math.floor(n),o=e.Interpolation.Utils.CatmullRom;if(t[0]===t[i]){if(r<0)a=Math.floor(n=i*(1+r));return o(t[(a-1+i)%i],t[a],t[(a+1)%i],t[(a+2)%i],n-a)}else{if(r<0)return t[0]-(o(t[0],t[0],t[1],t[1],-n)-t[0]);if(r>1)return t[i]-(o(t[i],t[i],t[i-1],t[i-1],n-i)-t[i]);return o(t[a?a-1:0],t[a],t[i<a+1?i:a+1],t[i<a+2?i:a+2],n-a)}},Utils:{Linear:function(e,t,r){return(t-e)*r+e},Bernstein:function(t,r){var i=e.Interpolation.Utils.Factorial;return i(t)/i(r)/i(t-r)},Factorial:function(){var e=[1];return function(t){var r=1,i;if(e[t])return e[t];for(i=t;i>1;i--)r*=i;return e[t]=r}}(),CatmullRom:function(e,t,r,i,n){var a=(r-e)*.5,o=(i-t)*.5,s=n*n,u=n*s;return(2*t-2*r+a+o)*u+(-3*t+3*r-2*a-o)*s+a*n+t}}};return e});define("Core/EasingFunction",["../ThirdParty/Tween","./freezeObject"],function(e,t){"use strict";var r={LINEAR_NONE:e.Easing.Linear.None,QUADRACTIC_IN:e.Easing.Quadratic.In,QUADRACTIC_OUT:e.Easing.Quadratic.Out,QUADRACTIC_IN_OUT:e.Easing.Quadratic.InOut,CUBIC_IN:e.Easing.Cubic.In,CUBIC_OUT:e.Easing.Cubic.Out,CUBIC_IN_OUT:e.Easing.Cubic.InOut,QUARTIC_IN:e.Easing.Quartic.In,QUARTIC_OUT:e.Easing.Quartic.Out,QUARTIC_IN_OUT:e.Easing.Quartic.InOut,QUINTIC_IN:e.Easing.Quintic.In,QUINTIC_OUT:e.Easing.Quintic.Out,QUINTIC_IN_OUT:e.Easing.Quintic.InOut,SINUSOIDAL_IN:e.Easing.Sinusoidal.In,SINUSOIDAL_OUT:e.Easing.Sinusoidal.Out,SINUSOIDAL_IN_OUT:e.Easing.Sinusoidal.InOut,EXPONENTIAL_IN:e.Easing.Exponential.In,EXPONENTIAL_OUT:e.Easing.Exponential.Out,EXPONENTIAL_IN_OUT:e.Easing.Exponential.InOut,CIRCULAR_IN:e.Easing.Circular.In,CIRCULAR_OUT:e.Easing.Circular.Out,CIRCULAR_IN_OUT:e.Easing.Circular.InOut,ELASTIC_IN:e.Easing.Elastic.In,ELASTIC_OUT:e.Easing.Elastic.Out,ELASTIC_IN_OUT:e.Easing.Elastic.InOut,BACK_IN:e.Easing.Back.In,BACK_OUT:e.Easing.Back.Out,BACK_IN_OUT:e.Easing.Back.InOut,BOUNCE_IN:e.Easing.Bounce.In,BOUNCE_OUT:e.Easing.Bounce.Out,BOUNCE_IN_OUT:e.Easing.Bounce.InOut};return t(r)});define("Core/EllipsoidGeometry",["./BoundingSphere","./Cartesian2","./Cartesian3","./ComponentDatatype","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./Geometry","./GeometryAttribute","./GeometryAttributes","./IndexDatatype","./Math","./PrimitiveType","./VertexFormat"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p){"use strict";var m=new r;var v=new r;var _=new r;var g=new r;var y=new r;var w=new r(1,1,1);var C=Math.cos;var b=Math.sin;function S(e){e=n(e,n.EMPTY_OBJECT);var t=n(e.radii,w);var i=n(e.stackPartitions,64);var a=n(e.slicePartitions,64);var s=n(e.vertexFormat,p.DEFAULT);if(a<3){throw new o("options.slicePartitions cannot be less than three.")}if(i<3){throw new o("options.stackPartitions cannot be less than three.")}this._radii=r.clone(t);this._stackPartitions=i;this._slicePartitions=a;this._vertexFormat=p.clone(s);this._workerName="createEllipsoidGeometry"}S.packedLength=r.packedLength+p.packedLength+2;S.pack=function(e,t,i){if(!a(e)){throw new o("value is required")}if(!a(t)){throw new o("array is required")}i=n(i,0);r.pack(e._radii,t,i);i+=r.packedLength;p.pack(e._vertexFormat,t,i);i+=p.packedLength;t[i++]=e._stackPartitions;t[i]=e._slicePartitions;return t};var E=new r;var T=new p;var x={radii:E,vertexFormat:T,stackPartitions:undefined,slicePartitions:undefined};S.unpack=function(e,t,i){if(!a(e)){throw new o("array is required")}t=n(t,0);var s=r.unpack(e,t,E);t+=r.packedLength;var u=p.unpack(e,t,T);t+=p.packedLength;var l=e[t++];var c=e[t];if(!a(i)){x.stackPartitions=l;x.slicePartitions=c;return new S(x)}i._radii=r.clone(s,i._radii);i._vertexFormat=p.clone(u,i._vertexFormat);i._stackPartitions=l;i._slicePartitions=c;return i};S.createGeometry=function(n){var a=n._radii;if(a.x<=0||a.y<=0||a.z<=0){return}var o=s.fromCartesian3(a);var p=n._vertexFormat;var w=n._slicePartitions+1;var S=n._stackPartitions+1;var E=S*w;var T=new Float64Array(E*3);var x=6*(w-1)*(S-2);var A=d.createTypedArray(E,x);var P=p.normal?new Float32Array(E*3):undefined;var D=p.tangent?new Float32Array(E*3):undefined;var M=p.bitangent?new Float32Array(E*3):undefined;var I=p.st?new Float32Array(E*2):undefined;var O=new Array(w);var R=new Array(w);var N;var L;var B=0;for(N=0;N<w;N++){var F=f.TWO_PI*N/(w-1);O[N]=C(F);R[N]=b(F);T[B++]=0;T[B++]=0;T[B++]=a.z}for(N=1;N<S-1;N++){var k=Math.PI*N/(S-1);var V=b(k);var z=a.x*V;var U=a.y*V;var q=a.z*C(k);for(L=0;L<w;L++){T[B++]=O[L]*z;T[B++]=R[L]*U;T[B++]=q}}for(N=0;N<w;N++){T[B++]=0;T[B++]=0;T[B++]=-a.z}var G=new c;if(p.position){G.position=new l({componentDatatype:i.DOUBLE,componentsPerAttribute:3,values:T})}var H=0;var W=0;var j=0;var Y=0;if(p.st||p.normal||p.tangent||p.bitangent){for(N=0;N<E;N++){var X=r.fromArray(T,N*3,m);var Z=o.geodeticSurfaceNormal(X,v);if(p.st){var K=t.negate(Z,y);if(t.magnitude(K)<f.EPSILON6){B=(N+w*Math.floor(S*.5))*3;if(B>T.length){B=(N-w*Math.floor(S*.5))*3}r.fromArray(T,B,K);o.geodeticSurfaceNormal(K,K);t.negate(K,K)}I[H++]=Math.atan2(K.y,K.x)/f.TWO_PI+.5;I[H++]=Math.asin(Z.z)/Math.PI+.5}if(p.normal){P[W++]=Z.x;P[W++]=Z.y;P[W++]=Z.z}if(p.tangent||p.bitangent){var Q=_;if(N<w||N>E-w-1){r.cross(r.UNIT_X,Z,Q);r.normalize(Q,Q)}else{r.cross(r.UNIT_Z,Z,Q);r.normalize(Q,Q)}if(p.tangent){D[j++]=Q.x;D[j++]=Q.y;D[j++]=Q.z}if(p.bitangent){var J=r.cross(Z,Q,g);r.normalize(J,J);M[Y++]=J.x;M[Y++]=J.y;M[Y++]=J.z}}}if(p.st){G.st=new l({componentDatatype:i.FLOAT,componentsPerAttribute:2,values:I})}if(p.normal){G.normal=new l({componentDatatype:i.FLOAT,componentsPerAttribute:3,values:P})}if(p.tangent){G.tangent=new l({componentDatatype:i.FLOAT,componentsPerAttribute:3,values:D})}if(p.bitangent){G.bitangent=new l({componentDatatype:i.FLOAT,componentsPerAttribute:3,values:M})}}B=0;for(L=0;L<w-1;L++){A[B++]=w+L;A[B++]=w+L+1;A[B++]=L+1}var $;var ee;for(N=1;N<S-2;N++){$=N*w;ee=(N+1)*w;for(L=0;L<w-1;L++){A[B++]=ee+L;A[B++]=ee+L+1;A[B++]=$+L+1;A[B++]=ee+L;A[B++]=$+L+1;A[B++]=$+L}}N=S-2;$=N*w;ee=(N+1)*w;for(L=0;L<w-1;L++){A[B++]=ee+L;A[B++]=$+L+1;A[B++]=$+L}return new u({attributes:G,indices:A,primitiveType:h.TRIANGLES,boundingSphere:e.fromEllipsoid(o)})};return S});define("Core/EllipsoidOutlineGeometry",["./BoundingSphere","./Cartesian3","./ComponentDatatype","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./Geometry","./GeometryAttribute","./GeometryAttributes","./IndexDatatype","./Math","./PrimitiveType"],function(e,t,r,i,n,a,o,s,u,l,c,d,f){"use strict";var h=new t(1,1,1);var p=Math.cos;var m=Math.sin;function v(e){e=i(e,i.EMPTY_OBJECT);var r=i(e.radii,h);var n=i(e.stackPartitions,10);var o=i(e.slicePartitions,8);var s=i(e.subdivisions,128);if(n<1){throw new a("options.stackPartitions cannot be less than 1")}if(o<0){throw new a("options.slicePartitions cannot be less than 0")}if(s<0){throw new a("options.subdivisions must be greater than or equal to zero.")}this._radii=t.clone(r);this._stackPartitions=n;this._slicePartitions=o;this._subdivisions=s;this._workerName="createEllipsoidOutlineGeometry"}v.packedLength=t.packedLength+3;v.pack=function(e,r,o){if(!n(e)){throw new a("value is required")}if(!n(r)){throw new a("array is required")}o=i(o,0);t.pack(e._radii,r,o);o+=t.packedLength;r[o++]=e._stackPartitions;r[o++]=e._slicePartitions;r[o]=e._subdivisions;return r};var _=new t;var g={radii:_,stackPartitions:undefined,slicePartitions:undefined,subdivisions:undefined};v.unpack=function(e,r,o){if(!n(e)){throw new a("array is required")}r=i(r,0);var s=t.unpack(e,r,_);r+=t.packedLength;var u=e[r++];var l=e[r++];var c=e[r++];if(!n(o)){g.stackPartitions=u;g.slicePartitions=l;g.subdivisions=c;return new v(g)}o._radii=t.clone(s,o._radii);o._stackPartitions=u;o._slicePartitions=l;o._subdivisions=c;return o};v.createGeometry=function(t){var i=t._radii;if(i.x<=0||i.y<=0||i.z<=0){return}var n=o.fromCartesian3(i);var a=t._stackPartitions;var h=t._slicePartitions;var v=t._subdivisions;var _=v*(a+h-1);var g=_-h+2;var y=new Float64Array(g*3);var w=c.createTypedArray(g,_*2);var C;var b;var S;var E;var T;var x;var A=0;var P=new Array(v);var D=new Array(v);for(C=0;C<v;C++){S=d.TWO_PI*C/v;P[C]=p(S);D[C]=m(S)}for(C=1;C<a;C++){E=Math.PI*C/a;T=p(E);x=m(E);for(b=0;b<v;b++){y[A++]=i.x*P[b]*x;y[A++]=i.y*D[b]*x;y[A++]=i.z*T}}P.length=h;D.length=h;for(C=0;C<h;C++){S=d.TWO_PI*C/h;P[C]=p(S);D[C]=m(S)}y[A++]=0;y[A++]=0;y[A++]=i.z;for(C=1;C<v;C++){E=Math.PI*C/v;T=p(E);x=m(E);for(b=0;b<h;b++){y[A++]=i.x*P[b]*x;y[A++]=i.y*D[b]*x;y[A++]=i.z*T}}y[A++]=0;y[A++]=0;y[A++]=-i.z;A=0;for(C=0;C<a-1;++C){var M=C*v;for(b=0;b<v-1;++b){w[A++]=M+b;w[A++]=M+b+1}w[A++]=M+v-1;w[A++]=M}var I=v*(a-1);for(b=1;b<h+1;++b){w[A++]=I;w[A++]=I+b}for(C=0;C<v-2;++C){var O=C*h+1+I;var R=(C+1)*h+1+I;for(b=0;b<h-1;++b){w[A++]=R+b;w[A++]=O+b}w[A++]=R+h-1;w[A++]=O+h-1}var N=y.length/3-1;for(b=N-1;b>N-h-1;--b){w[A++]=N;w[A++]=b}var L=new l({position:new u({componentDatatype:r.DOUBLE,componentsPerAttribute:3,values:y})});return new s({attributes:L,indices:w,primitiveType:f.LINES,boundingSphere:e.fromEllipsoid(n)})};return v});define("Core/EllipsoidTerrainProvider",["../ThirdParty/when","./defaultValue","./defined","./defineProperties","./Ellipsoid","./Event","./GeographicTilingScheme","./HeightmapTerrainData","./TerrainProvider"],function(e,t,r,i,n,a,o,s,u){"use strict";function l(i){i=t(i,{});this._tilingScheme=i.tilingScheme;if(!r(this._tilingScheme)){this._tilingScheme=new o({ellipsoid:t(i.ellipsoid,n.WGS84)})}this._levelZeroMaximumGeometricError=u.getEstimatedLevelZeroGeometricErrorForAHeightmap(this._tilingScheme.ellipsoid,64,this._tilingScheme.getNumberOfXTilesAtLevel(0));this._errorEvent=new a;this._readyPromise=e.resolve(true)}i(l.prototype,{errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){return undefined}},tilingScheme:{get:function(){return this._tilingScheme}},ready:{get:function(){return true}},readyPromise:{get:function(){return this._readyPromise}},hasWaterMask:{get:function(){return false}},hasVertexNormals:{get:function(){return false}}});l.prototype.requestTileGeometry=function(e,t,r,i){var n=16;var a=16;return new s({buffer:new Uint8Array(n*a),width:n,height:a})};l.prototype.getLevelMaximumGeometricError=function(e){return this._levelZeroMaximumGeometricError/(1<<e)};l.prototype.getTileDataAvailable=function(e,t,r){return undefined};return l});define("Core/EventHelper",["./defined","./DeveloperError"],function(e,t){"use strict";function r(){this._removalFunctions=[]}r.prototype.add=function(r,i,n){if(!e(r)){throw new t("event is required")}var a=r.addEventListener(i,n);this._removalFunctions.push(a);var o=this;return function(){a();var e=o._removalFunctions;e.splice(e.indexOf(a),1)}};r.prototype.removeAll=function(){var e=this._removalFunctions;for(var t=0,r=e.length;t<r;++t){e[t]()}e.length=0};return r});define("Core/ExtrapolationType",["./freezeObject"],function(e){"use strict";var t={NONE:0,HOLD:1,EXTRAPOLATE:2};return e(t)});define("Core/GeocoderService",["./DeveloperError"],function(e){"use strict";function t(){}t.prototype.geocode=e.throwInstantiationError;return t});define("Core/GeometryInstanceAttribute",["./defaultValue","./defined","./DeveloperError"],function(e,t,r){"use strict";function i(i){i=e(i,e.EMPTY_OBJECT);if(!t(i.componentDatatype)){throw new r("options.componentDatatype is required.")}if(!t(i.componentsPerAttribute)){throw new r("options.componentsPerAttribute is required.")}if(i.componentsPerAttribute<1||i.componentsPerAttribute>4){throw new r("options.componentsPerAttribute must be between 1 and 4.")}if(!t(i.value)){throw new r("options.value is required.")}this.componentDatatype=i.componentDatatype;this.componentsPerAttribute=i.componentsPerAttribute;this.normalize=e(i.normalize,false);this.value=i.value}return i});define("Core/GeometryPipeline.bak",["./AttributeCompression","./barycentricCoordinates","./BoundingSphere","./Cartesian2","./Cartesian3","./Cartesian4","./Cartographic","./ComponentDatatype","./defaultValue","./defined","./DeveloperError","./EncodedCartesian3","./GeographicProjection","./Geometry","./GeometryAttribute","./GeometryType","./IndexDatatype","./Intersect","./IntersectionTests","./Math","./Matrix3","./Matrix4","./Plane","./PrimitiveType","./Tipsify"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w,C,b,S,E){"use strict";var T={};function x(e,t,r,i,n){e[t++]=r;e[t++]=i;e[t++]=i;e[t++]=n;e[t++]=n;e[t]=r}function A(e){var t=e.length;var r=t/3*6;var i=v.createTypedArray(t,r);var n=0;for(var a=0;a<t;a+=3,n+=6){x(i,n,e[a],e[a+1],e[a+2])}return i}function P(e){var t=e.length;if(t>=3){var r=(t-2)*6;var i=v.createTypedArray(t,r);x(i,0,e[0],e[1],e[2]);var n=6;for(var a=3;a<t;++a,n+=6){x(i,n,e[a-1],e[a],e[a-2])}return i}return new Uint16Array}function D(e){if(e.length>0){var t=e.length-1;var r=(t-1)*6;var i=v.createTypedArray(t,r);var n=e[0];var a=0;for(var o=1;o<t;++o,a+=6){x(i,a,n,e[o],e[o+1])}return i}return new Uint16Array}T.toWireframe=function(e){if(!l(e)){throw new c("geometry is required.")}var t=e.indices;if(l(t)){switch(e.primitiveType){case S.TRIANGLES:e.indices=A(t);break;case S.TRIANGLE_STRIP:e.indices=P(t);break;case S.TRIANGLE_FAN:e.indices=D(t);break;default:throw new c("geometry.primitiveType must be TRIANGLES, TRIANGLE_STRIP, or TRIANGLE_FAN.")}e.primitiveType=S.LINES}return e};T.createLineSegmentsForVectors=function(e,t,i){t=u(t,"normal");if(!l(e)){throw new c("geometry is required.")}if(!l(e.attributes.position)){throw new c("geometry.attributes.position is required.")}if(!l(e.attributes[t])){throw new c("geometry.attributes must have an attribute with the same name as the attributeName parameter, "+t+".")}i=u(i,1e4);var n=e.attributes.position.values;var a=e.attributes[t].values;var o=n.length;var d=new Float64Array(2*o);var f=0;for(var m=0;m<o;m+=3){d[f++]=n[m];d[f++]=n[m+1];d[f++]=n[m+2];d[f++]=n[m]+a[m]*i;d[f++]=n[m+1]+a[m+1]*i;d[f++]=n[m+2]+a[m+2]*i}var v;var _=e.boundingSphere;if(l(_)){v=new r(_.center,_.radius+i)}return new h({attributes:{position:new p({componentDatatype:s.DOUBLE,componentsPerAttribute:3,values:d})},primitiveType:S.LINES,boundingSphere:v})};T.createAttributeLocations=function(e){if(!l(e)){throw new c("geometry is required.")}var t=["position","positionHigh","positionLow","position3DHigh","position3DLow","position2DHigh","position2DLow","pickColor","normal","st","tangent","bitangent","extrudeDirection","compressedAttributes"];var r=e.attributes;var i={};var n=0;var a;var o=t.length;for(a=0;a<o;++a){var s=t[a];if(l(r[s])){i[s]=n++}}for(var u in r){if(r.hasOwnProperty(u)&&!l(i[u])){i[u]=n++}}return i};T.reorderForPreVertexCache=function(e){if(!l(e)){throw new c("geometry is required.")}var t=h.computeNumberOfVertices(e);var r=e.indices;if(l(r)){var i=new Int32Array(t);for(var n=0;n<t;n++){i[n]=-1}var a=r;var o=a.length;var u=v.createTypedArray(t,o);var d=0;var f=0;var p=0;var m;while(d<o){m=i[a[d]];if(m!==-1){u[f]=m}else{m=a[d];i[m]=p;u[f]=p;++p}++d;++f}e.indices=u;var _=e.attributes;for(var g in _){if(_.hasOwnProperty(g)&&l(_[g])&&l(_[g].values)){var y=_[g];var w=y.values;var C=0;var b=y.componentsPerAttribute;var S=s.createTypedArray(y.componentDatatype,p*b);while(C<t){var E=i[C];if(E!==-1){for(n=0;n<b;n++){S[b*E+n]=w[b*C+n]}}++C}y.values=S}}}return e};T.reorderForPostVertexCache=function(e,t){if(!l(e)){throw new c("geometry is required.")}var r=e.indices;if(e.primitiveType===S.TRIANGLES&&l(r)){var i=r.length;var n=0;for(var a=0;a<i;a++){if(r[a]>n){n=r[a]}}e.indices=E.tipsify({indices:r,maximumIndex:n,cacheSize:t})}return e};function M(e){var t={};for(var r in e){if(e.hasOwnProperty(r)&&l(e[r])&&l(e[r].values)){var i=e[r];t[r]=new p({componentDatatype:i.componentDatatype,componentsPerAttribute:i.componentsPerAttribute,normalize:i.normalize,values:[]})}}return t}function I(e,t,r){for(var i in t){if(t.hasOwnProperty(i)&&l(t[i])&&l(t[i].values)){var n=t[i];for(var a=0;a<n.componentsPerAttribute;++a){e[i].values.push(n.values[r*n.componentsPerAttribute+a])}}}}T.fitToUnsignedShortIndices=function(e){if(!l(e)){throw new c("geometry is required.")}if(l(e.indices)&&(e.primitiveType!==S.TRIANGLES&&e.primitiveType!==S.LINES&&e.primitiveType!==S.POINTS)){throw new c("geometry.primitiveType must equal to PrimitiveType.TRIANGLES, PrimitiveType.LINES, or PrimitiveType.POINTS.")}var t=[];var r=h.computeNumberOfVertices(e);if(l(e.indices)&&r>=y.SIXTY_FOUR_KILOBYTES){var i=[];var n=[];var a=0;var o=M(e.attributes);var s=e.indices;var u=s.length;var d;if(e.primitiveType===S.TRIANGLES){d=3}else if(e.primitiveType===S.LINES){d=2}else if(e.primitiveType===S.POINTS){d=1}for(var f=0;f<u;f+=d){for(var p=0;p<d;++p){var m=s[f+p];var v=i[m];if(!l(v)){v=a++;i[m]=v;I(o,e.attributes,m)}n.push(v)}if(a+d>=y.SIXTY_FOUR_KILOBYTES){t.push(new h({attributes:o,indices:n,primitiveType:e.primitiveType,boundingSphere:e.boundingSphere,boundingSphereCV:e.boundingSphereCV}));i=[];n=[];a=0;o=M(e.attributes)}}if(n.length!==0){t.push(new h({attributes:o,indices:n,primitiveType:e.primitiveType,boundingSphere:e.boundingSphere,boundingSphereCV:e.boundingSphereCV}))}}else{t.push(e)}return t};var O=new n;var R=new o;T.projectTo2D=function(e,t,r,i,a){if(!l(e)){throw new c("geometry is required.")}if(!l(t)){throw new c("attributeName is required.")}if(!l(r)){throw new c("attributeName3D is required.")}if(!l(i)){throw new c("attributeName2D is required.")}if(!l(e.attributes[t])){throw new c("geometry must have attribute matching the attributeName argument: "+t+".")}if(e.attributes[t].componentDatatype!==s.DOUBLE){throw new c("The attribute componentDatatype must be ComponentDatatype.DOUBLE.")}var o=e.attributes[t];a=l(a)?a:new f;var u=a.ellipsoid;var d=o.values;var h=new Float64Array(d.length);var m=0;for(var v=0;v<d.length;v+=3){var _=n.fromArray(d,v,O);var g=u.cartesianToCartographic(_,R);if(!l(g)){throw new c("Could not project point ("+_.x+", "+_.y+", "+_.z+") to 2D.")}var y=a.project(g,O);h[m++]=y.x;h[m++]=y.y;h[m++]=y.z}e.attributes[r]=o;e.attributes[i]=new p({componentDatatype:s.DOUBLE,componentsPerAttribute:3,values:h});delete e.attributes[t];return e};var N={high:0,low:0};T.encodeAttribute=function(e,t,r,i){if(!l(e)){throw new c("geometry is required.")}if(!l(t)){throw new c("attributeName is required.")}if(!l(r)){throw new c("attributeHighName is required.")}if(!l(i)){throw new c("attributeLowName is required.")}if(!l(e.attributes[t])){throw new c("geometry must have attribute matching the attributeName argument: "+t+".")}if(e.attributes[t].componentDatatype!==s.DOUBLE){throw new c("The attribute componentDatatype must be ComponentDatatype.DOUBLE.")}var n=e.attributes[t];var a=n.values;var o=a.length;var u=new Float32Array(o);var f=new Float32Array(o);for(var h=0;h<o;++h){d.encode(a[h],N);u[h]=N.high;f[h]=N.low}var m=n.componentsPerAttribute;e.attributes[r]=new p({componentDatatype:s.FLOAT,componentsPerAttribute:m,values:u});e.attributes[i]=new p({componentDatatype:s.FLOAT,componentsPerAttribute:m,values:f});delete e.attributes[t];return e};var L=new n;function B(e,t){if(l(t)){var r=t.values;var i=r.length;for(var a=0;a<i;a+=3){n.unpack(r,a,L);C.multiplyByPoint(e,L,L);n.pack(L,r,a)}}}function F(e,t){if(l(t)){var r=t.values;var i=r.length;for(var a=0;a<i;a+=3){n.unpack(r,a,L);w.multiplyByVector(e,L,L);L=n.normalize(L,L);n.pack(L,r,a)}}}var k=new C;var V=new w;T.transformToWorldCoordinates=function(e){if(!l(e)){throw new c("instance is required.")}var t=e.modelMatrix;if(C.equals(t,C.IDENTITY)){return e}var i=e.geometry.attributes;B(t,i.position);B(t,i.prevPosition);B(t,i.nextPosition);if(l(i.normal)||l(i.tangent)||l(i.bitangent)){C.inverse(t,k);C.transpose(k,k);C.getRotation(k,V);F(V,i.normal);F(V,i.tangent);F(V,i.bitangent)}var n=e.geometry.boundingSphere;if(l(n)){e.geometry.boundingSphere=r.transform(n,t,n)}e.modelMatrix=C.clone(C.IDENTITY);return e};function z(e,t){var r=e.length;var i={};var n=e[0][t].attributes;var a;for(a in n){if(n.hasOwnProperty(a)&&l(n[a])&&l(n[a].values)){var o=n[a];var u=o.values.length;var c=true;for(var d=1;d<r;++d){var f=e[d][t].attributes[a];if(!l(f)||o.componentDatatype!==f.componentDatatype||o.componentsPerAttribute!==f.componentsPerAttribute||o.normalize!==f.normalize){c=false;break}u+=f.values.length}if(c){i[a]=new p({componentDatatype:o.componentDatatype,componentsPerAttribute:o.componentsPerAttribute,normalize:o.normalize,values:s.createTypedArray(o.componentDatatype,u)})}}}return i}var U=new n;function q(e,t){var i=e.length;var a;var o;var s;var u;var d=e[0].modelMatrix;var f=l(e[0][t].indices);var p=e[0][t].primitiveType;for(o=1;o<i;++o){if(!C.equals(e[o].modelMatrix,d)){throw new c("All instances must have the same modelMatrix.")}if(l(e[o][t].indices)!==f){throw new c("All instance geometries must have an indices or not have one.")}if(e[o][t].primitiveType!==p){throw new c("All instance geometries must have the same primitiveType.")}}var m=z(e,t);var _;var g;var y;for(a in m){if(m.hasOwnProperty(a)){_=m[a].values;u=0;for(o=0;o<i;++o){g=e[o][t].attributes[a].values;y=g.length;for(s=0;s<y;++s){_[u++]=g[s]}}}}var w;if(f){var b=0;for(o=0;o<i;++o){b+=e[o][t].indices.length}var E=h.computeNumberOfVertices(new h({attributes:m,primitiveType:S.POINTS}));var T=v.createTypedArray(E,b);var x=0;var A=0;for(o=0;o<i;++o){var P=e[o][t].indices;var D=P.length;for(u=0;u<D;++u){T[x++]=A+P[u]}A+=h.computeNumberOfVertices(e[o][t])}w=T}var M=new n;var I=0;var O;for(o=0;o<i;++o){O=e[o][t].boundingSphere;if(!l(O)){M=undefined;break}n.add(O.center,M,M)}if(l(M)){n.divideByScalar(M,i,M);for(o=0;o<i;++o){O=e[o][t].boundingSphere;var R=n.magnitude(n.subtract(O.center,M,U))+O.radius;if(R>I){I=R}}}return new h({attributes:m,indices:w,primitiveType:p,boundingSphere:l(M)?new r(M,I):undefined})}T.combineInstances=function(e){if(!l(e)||e.length<1){throw new c("instances is required and must have length greater than zero.")}var t=[];var r=[];var i=e.length;for(var n=0;n<i;++n){var a=e[n];if(l(a.geometry)){t.push(a)}else if(l(a.westHemisphereGeometry)&&l(a.eastHemisphereGeometry)){r.push(a)}}var o=[];if(t.length>0){o.push(q(t,"geometry"))}if(r.length>0){o.push(q(r,"westHemisphereGeometry"));o.push(q(r,"eastHemisphereGeometry"))}return o};var G=new n;var H=new n;var W=new n;var j=new n;T.computeNormal=function(e){if(!l(e)){throw new c("geometry is required.")}if(!l(e.attributes.position)||!l(e.attributes.position.values)){throw new c("geometry.attributes.position.values is required.")}if(!l(e.indices)){throw new c("geometry.indices is required.")}if(e.indices.length<2||e.indices.length%3!==0){throw new c("geometry.indices length must be greater than 0 and be a multiple of 3.")}if(e.primitiveType!==S.TRIANGLES){throw new c("geometry.primitiveType must be PrimitiveType.TRIANGLES.")}var t=e.indices;var r=e.attributes;var i=r.position.values;var a=r.position.values.length/3;var o=t.length;var u=new Array(a);var d=new Array(o/3);var f=new Array(o);for(var h=0;h<a;h++){u[h]={indexOffset:0,count:0,currentCount:0}}var m=0;for(h=0;h<o;h+=3){var v=t[h];var _=t[h+1];var g=t[h+2];var w=v*3;var C=_*3;var b=g*3;H.x=i[w];H.y=i[w+1];H.z=i[w+2];W.x=i[C];W.y=i[C+1];W.z=i[C+2];j.x=i[b];j.y=i[b+1];j.z=i[b+2];u[v].count++;u[_].count++;u[g].count++;n.subtract(W,H,W);n.subtract(j,H,j);d[m]=n.cross(W,j,new n);m++}var E=0;for(h=0;h<a;h++){u[h].indexOffset+=E;E+=u[h].count}m=0;var T;for(h=0;h<o;h+=3){T=u[t[h]];var x=T.indexOffset+T.currentCount;f[x]=m;T.currentCount++;T=u[t[h+1]];x=T.indexOffset+T.currentCount;f[x]=m;T.currentCount++;T=u[t[h+2]];x=T.indexOffset+T.currentCount;f[x]=m;T.currentCount++;m++}var A=new Float32Array(a*3);for(h=0;h<a;h++){var P=h*3;T=u[h];n.clone(n.ZERO,G);if(T.count>0){for(m=0;m<T.count;m++){n.add(G,d[f[T.indexOffset+m]],G)}if(n.equalsEpsilon(n.ZERO,G,y.EPSILON10)){n.clone(d[f[T.indexOffset]],G)}}if(n.equalsEpsilon(n.ZERO,G,y.EPSILON10)){G.z=1}n.normalize(G,G);A[P]=G.x;A[P+1]=G.y;A[P+2]=G.z}e.attributes.normal=new p({componentDatatype:s.FLOAT,componentsPerAttribute:3,values:A});return e};var Y=new n;var X=new n;var Z=new n;T.computeTangentAndBitangent=function(e){if(!l(e)){throw new c("geometry is required.")}var t=e.attributes;var r=e.indices;if(!l(t.position)||!l(t.position.values)){throw new c("geometry.attributes.position.values is required.")}if(!l(t.normal)||!l(t.normal.values)){throw new c("geometry.attributes.normal.values is required.")}if(!l(t.st)||!l(t.st.values)){throw new c("geometry.attributes.st.values is required.")}if(!l(r)){throw new c("geometry.indices is required.")}if(r.length<2||r.length%3!==0){throw new c("geometry.indices length must be greater than 0 and be a multiple of 3.")}if(e.primitiveType!==S.TRIANGLES){throw new c("geometry.primitiveType must be PrimitiveType.TRIANGLES.")}var i=e.attributes.position.values;var a=e.attributes.normal.values;var o=e.attributes.st.values;var u=e.attributes.position.values.length/3;var d=r.length;var f=new Array(u*3);for(var h=0;h<f.length;h++){f[h]=0}var m;var v;var _;for(h=0;h<d;h+=3){var g=r[h];var y=r[h+1];var w=r[h+2];m=g*3;v=y*3;_=w*3;var C=g*2;var b=y*2;var E=w*2;var T=i[m];var x=i[m+1];var A=i[m+2];var P=o[C];var D=o[C+1];var M=o[b+1]-D;var I=o[E+1]-D;var O=1/((o[b]-P)*I-(o[E]-P)*M);var R=(I*(i[v]-T)-M*(i[_]-T))*O;var N=(I*(i[v+1]-x)-M*(i[_+1]-x))*O;var L=(I*(i[v+2]-A)-M*(i[_+2]-A))*O;f[m]+=R;f[m+1]+=N;f[m+2]+=L;f[v]+=R;f[v+1]+=N;f[v+2]+=L;f[_]+=R;f[_+1]+=N;f[_+2]+=L}var B=new Float32Array(u*3);var F=new Float32Array(u*3);for(h=0;h<u;h++){m=h*3;v=m+1;_=m+2;var k=n.fromArray(a,m,Y);var V=n.fromArray(f,m,Z);var z=n.dot(k,V);n.multiplyByScalar(k,z,X);n.normalize(n.subtract(V,X,V),V);B[m]=V.x;B[v]=V.y;B[_]=V.z;n.normalize(n.cross(k,V,V),V);F[m]=V.x;F[v]=V.y;F[_]=V.z}e.attributes.tangent=new p({componentDatatype:s.FLOAT,componentsPerAttribute:3,values:B});e.attributes.bitangent=new p({componentDatatype:s.FLOAT,componentsPerAttribute:3,values:F});return e};var K=new i;var Q=new n;var J=new n;var $=new n;var ee=new i;T.compressVertices=function(t){if(!l(t)){throw new c("geometry is required.")}var r=t.attributes.extrudeDirection;var a;var o;if(l(r)){var u=r.values;o=u.length/3;var d=new Float32Array(o*2);var f=0;for(a=0;a<o;++a){n.fromArray(u,a*3,Q);if(n.equals(Q,n.ZERO)){f+=2;continue}ee=e.octEncodeInRange(Q,65535,ee);d[f++]=ee.x;d[f++]=ee.y}t.attributes.compressedAttributes=new p({componentDatatype:s.FLOAT,componentsPerAttribute:2,values:d});delete t.attributes.extrudeDirection;return t}var h=t.attributes.normal;var m=t.attributes.st;var v=l(h);var _=l(m);if(!v&&!_){return t}var g=t.attributes.tangent;var y=t.attributes.bitangent;var w=l(g);var C=l(y);var b;var S;var E;var T;if(v){b=h.values}if(_){S=m.values}if(w){E=g.values}if(C){T=y.values}var x=v?b.length:S.length;var A=v?3:2;o=x/A;var P=o;var D=_&&v?2:1;D+=w||C?1:0;P*=D;var M=new Float32Array(P);var I=0;for(a=0;a<o;++a){if(_){i.fromArray(S,a*2,K);M[I++]=e.compressTextureCoordinates(K)}
var O=a*3;if(v&&l(E)&&l(T)){n.fromArray(b,O,Q);n.fromArray(E,O,J);n.fromArray(T,O,$);e.octPack(Q,J,$,K);M[I++]=K.x;M[I++]=K.y}else{if(v){n.fromArray(b,O,Q);M[I++]=e.octEncodeFloat(Q)}if(w){n.fromArray(E,O,Q);M[I++]=e.octEncodeFloat(Q)}if(C){n.fromArray(T,O,Q);M[I++]=e.octEncodeFloat(Q)}}}t.attributes.compressedAttributes=new p({componentDatatype:s.FLOAT,componentsPerAttribute:D,values:M});if(v){delete t.attributes.normal}if(_){delete t.attributes.st}if(C){delete t.attributes.bitangent}if(w){delete t.attributes.tangent}return t};function te(e){if(l(e.indices)){return e}var t=h.computeNumberOfVertices(e);if(t<3){throw new c("The number of vertices must be at least three.")}if(t%3!==0){throw new c("The number of vertices must be a multiple of three.")}var r=v.createTypedArray(t,t);for(var i=0;i<t;++i){r[i]=i}e.indices=r;return e}function re(e){var t=h.computeNumberOfVertices(e);if(t<3){throw new c("The number of vertices must be at least three.")}var r=v.createTypedArray(t,(t-2)*3);r[0]=1;r[1]=0;r[2]=2;var i=3;for(var n=3;n<t;++n){r[i++]=n-1;r[i++]=0;r[i++]=n}e.indices=r;e.primitiveType=S.TRIANGLES;return e}function ie(e){var t=h.computeNumberOfVertices(e);if(t<3){throw new c("The number of vertices must be at least 3.")}var r=v.createTypedArray(t,(t-2)*3);r[0]=0;r[1]=1;r[2]=2;if(t>3){r[3]=0;r[4]=2;r[5]=3}var i=6;for(var n=3;n<t-1;n+=2){r[i++]=n;r[i++]=n-1;r[i++]=n+1;if(n+2<t){r[i++]=n;r[i++]=n+1;r[i++]=n+2}}e.indices=r;e.primitiveType=S.TRIANGLES;return e}function ne(e){if(l(e.indices)){return e}var t=h.computeNumberOfVertices(e);if(t<2){throw new c("The number of vertices must be at least two.")}if(t%2!==0){throw new c("The number of vertices must be a multiple of 2.")}var r=v.createTypedArray(t,t);for(var i=0;i<t;++i){r[i]=i}e.indices=r;return e}function ae(e){var t=h.computeNumberOfVertices(e);if(t<2){throw new c("The number of vertices must be at least two.")}var r=v.createTypedArray(t,(t-1)*2);r[0]=0;r[1]=1;var i=2;for(var n=2;n<t;++n){r[i++]=n-1;r[i++]=n}e.indices=r;e.primitiveType=S.LINES;return e}function oe(e){var t=h.computeNumberOfVertices(e);if(t<2){throw new c("The number of vertices must be at least two.")}var r=v.createTypedArray(t,t*2);r[0]=0;r[1]=1;var i=2;for(var n=2;n<t;++n){r[i++]=n-1;r[i++]=n}r[i++]=t-1;r[i]=0;e.indices=r;e.primitiveType=S.LINES;return e}function se(e){switch(e.primitiveType){case S.TRIANGLE_FAN:return re(e);case S.TRIANGLE_STRIP:return ie(e);case S.TRIANGLES:return te(e);case S.LINE_STRIP:return ae(e);case S.LINE_LOOP:return oe(e);case S.LINES:return ne(e)}return e}function ue(e,t){if(Math.abs(e.y)<y.EPSILON6){if(t){e.y=-y.EPSILON6}else{e.y=y.EPSILON6}}}function le(e,t,r){if(e.y!==0&&t.y!==0&&r.y!==0){ue(e,e.y<0);ue(t,t.y<0);ue(r,r.y<0);return}var i=Math.abs(e.y);var n=Math.abs(t.y);var a=Math.abs(r.y);var o;if(i>n){if(i>a){o=y.sign(e.y)}else{o=y.sign(r.y)}}else if(n>a){o=y.sign(t.y)}else{o=y.sign(r.y)}var s=o<0;ue(e,s);ue(t,s);ue(r,s)}var ce=new n;function de(e,t,r,i){n.add(e,n.multiplyByScalar(n.subtract(t,e,ce),e.y/(e.y-t.y),ce),r);n.clone(r,i);ue(r,true);ue(i,false)}var fe=new n;var he=new n;var pe=new n;var me=new n;var ve={positions:new Array(7),indices:new Array(3*3)};function _e(e,t,r){if(e.x>=0||t.x>=0||r.x>=0){return undefined}le(e,t,r);var i=e.y<0;var n=t.y<0;var a=r.y<0;var o=0;o+=i?1:0;o+=n?1:0;o+=a?1:0;var s=ve.indices;if(o===1){s[1]=3;s[2]=4;s[5]=6;s[7]=6;s[8]=5;if(i){de(e,t,fe,pe);de(e,r,he,me);s[0]=0;s[3]=1;s[4]=2;s[6]=1}else if(n){de(t,r,fe,pe);de(t,e,he,me);s[0]=1;s[3]=2;s[4]=0;s[6]=2}else if(a){de(r,e,fe,pe);de(r,t,he,me);s[0]=2;s[3]=0;s[4]=1;s[6]=0}}else if(o===2){s[2]=4;s[4]=4;s[5]=3;s[7]=5;s[8]=6;if(!i){de(e,t,fe,pe);de(e,r,he,me);s[0]=1;s[1]=2;s[3]=1;s[6]=0}else if(!n){de(t,r,fe,pe);de(t,e,he,me);s[0]=2;s[1]=0;s[3]=2;s[6]=1}else if(!a){de(r,e,fe,pe);de(r,t,he,me);s[0]=0;s[1]=1;s[3]=0;s[6]=2}}var u=ve.positions;u[0]=e;u[1]=t;u[2]=r;u.length=3;if(o===1||o===2){u[3]=fe;u[4]=he;u[5]=pe;u[6]=me;u.length=7}return ve}function ge(e,t){var i=e.attributes;if(i.position.values.length===0){return undefined}for(var n in i){if(i.hasOwnProperty(n)&&l(i[n])&&l(i[n].values)){var a=i[n];a.values=s.createTypedArray(a.componentDatatype,a.values)}}var o=h.computeNumberOfVertices(e);e.indices=v.createTypedArray(o,e.indices);if(t){e.boundingSphere=r.fromVertices(i.position.values)}return e}function ye(e){var t=e.attributes;var r={};for(var i in t){if(t.hasOwnProperty(i)&&l(t[i])&&l(t[i].values)){var n=t[i];r[i]=new p({componentDatatype:n.componentDatatype,componentsPerAttribute:n.componentsPerAttribute,normalize:n.normalize,values:[]})}}return new h({attributes:r,indices:[],primitiveType:e.primitiveType})}function we(e,t,r){var i=l(e.geometry.boundingSphere);t=ge(t,i);r=ge(r,i);if(l(r)&&!l(t)){e.geometry=r}else if(!l(r)&&l(t)){e.geometry=t}else{e.westHemisphereGeometry=t;e.eastHemisphereGeometry=r;e.geometry=undefined}}var Ce=new n;var be=new n;var Se=new n;var Ee=new n;var Te=new i;var xe=new i;var Ae=new i;function Pe(e,r,a,o,s,u,c,d,f,h,p,m){if(!l(u)&&!l(c)&&!l(d)&&!l(f)&&!l(h)){return}var v=n.fromArray(s,e*3,Ce);var _=n.fromArray(s,r*3,be);var g=n.fromArray(s,a*3,Se);var y=t(o,v,_,g,Ee);if(l(u)){var w=n.fromArray(u,e*3,Ce);var C=n.fromArray(u,r*3,be);var b=n.fromArray(u,a*3,Se);n.multiplyByScalar(w,y.x,w);n.multiplyByScalar(C,y.y,C);n.multiplyByScalar(b,y.z,b);var S=n.add(w,C,w);n.add(S,b,S);n.normalize(S,S);n.pack(S,p.normal.values,m*3)}if(l(h)){var E=n.fromArray(h,e*3,Ce);var T=n.fromArray(h,r*3,be);var x=n.fromArray(h,a*3,Se);n.multiplyByScalar(E,y.x,E);n.multiplyByScalar(T,y.y,T);n.multiplyByScalar(x,y.z,x);var A;if(!n.equals(E,n.ZERO)||!n.equals(T,n.ZERO)||!n.equals(x,n.ZERO)){A=n.add(E,T,E);n.add(A,x,A);n.normalize(A,A)}else{A=Ce;A.x=0;A.y=0;A.z=0}n.pack(A,p.extrudeDirection.values,m*3)}if(l(c)){var P=n.fromArray(c,e*3,Ce);var D=n.fromArray(c,r*3,be);var M=n.fromArray(c,a*3,Se);n.multiplyByScalar(P,y.x,P);n.multiplyByScalar(D,y.y,D);n.multiplyByScalar(M,y.z,M);var I=n.add(P,D,P);n.add(I,M,I);n.normalize(I,I);n.pack(I,p.tangent.values,m*3)}if(l(d)){var O=n.fromArray(d,e*3,Ce);var R=n.fromArray(d,r*3,be);var N=n.fromArray(d,a*3,Se);n.multiplyByScalar(O,y.x,O);n.multiplyByScalar(R,y.y,R);n.multiplyByScalar(N,y.z,N);var L=n.add(O,R,O);n.add(L,N,L);n.normalize(L,L);n.pack(L,p.bitangent.values,m*3)}if(l(f)){var B=i.fromArray(f,e*2,Te);var F=i.fromArray(f,r*2,xe);var k=i.fromArray(f,a*2,Ae);i.multiplyByScalar(B,y.x,B);i.multiplyByScalar(F,y.y,F);i.multiplyByScalar(k,y.z,k);var V=i.add(B,F,B);i.add(V,k,V);i.pack(V,p.st.values,m*2)}}function De(e,t,r,i,n,a){var o=e.position.values.length/3;if(n!==-1){var s=i[n];var u=r[s];if(u===-1){r[s]=o;e.position.values.push(a.x,a.y,a.z);t.push(o);return o}t.push(u);return u}e.position.values.push(a.x,a.y,a.z);t.push(o);return o}function Me(e){var t=e.geometry;var r=t.attributes;var i=r.position.values;var a=l(r.normal)?r.normal.values:undefined;var o=l(r.bitangent)?r.bitangent.values:undefined;var s=l(r.tangent)?r.tangent.values:undefined;var u=l(r.st)?r.st.values:undefined;var c=l(r.extrudeDirection)?r.extrudeDirection.values:undefined;var d=t.indices;var f=ye(t);var h=ye(t);var p;var m;var v;var _;var g;var y=[];y.length=i.length/3;var w=[];w.length=i.length/3;for(g=0;g<y.length;++g){y[g]=-1;w[g]=-1}var C=d.length;for(g=0;g<C;g+=3){var b=d[g];var S=d[g+1];var E=d[g+2];var T=n.fromArray(i,b*3);var x=n.fromArray(i,S*3);var A=n.fromArray(i,E*3);var P=_e(T,x,A);if(l(P)&&P.positions.length>3){var D=P.positions;var M=P.indices;var I=M.length;for(var O=0;O<I;++O){var R=M[O];var N=D[R];if(N.y<0){p=h.attributes;m=h.indices;v=y}else{p=f.attributes;m=f.indices;v=w}_=De(p,m,v,d,R<3?g+R:-1,N);Pe(b,S,E,N,i,a,s,o,u,c,p,_)}}else{if(l(P)){T=P.positions[0];x=P.positions[1];A=P.positions[2]}if(T.y<0){p=h.attributes;m=h.indices;v=y}else{p=f.attributes;m=f.indices;v=w}_=De(p,m,v,d,g,T);Pe(b,S,E,T,i,a,s,o,u,c,p,_);_=De(p,m,v,d,g+1,x);Pe(b,S,E,x,i,a,s,o,u,c,p,_);_=De(p,m,v,d,g+2,A);Pe(b,S,E,A,i,a,s,o,u,c,p,_)}}we(e,h,f)}var Ie=b.fromPointNormal(n.ZERO,n.UNIT_Y);var Oe=new n;var Re=new n;function Ne(e){var t=e.geometry;var r=t.attributes;var i=r.position.values;var a=t.indices;var o=ye(t);var s=ye(t);var u;var c=a.length;var d=[];d.length=i.length/3;var f=[];f.length=i.length/3;for(u=0;u<d.length;++u){d[u]=-1;f[u]=-1}for(u=0;u<c;u+=2){var h=a[u];var p=a[u+1];var m=n.fromArray(i,h*3,Ce);var v=n.fromArray(i,p*3,be);if(Math.abs(m.y)<y.EPSILON6){if(m.y<0){m.y=-y.EPSILON6}else{m.y=y.EPSILON6}}if(Math.abs(v.y)<y.EPSILON6){if(v.y<0){v.y=-y.EPSILON6}else{v.y=y.EPSILON6}}var _=o.attributes;var w=o.indices;var C=f;var b=s.attributes;var S=s.indices;var E=d;var T=g.lineSegmentPlane(m,v,Ie,Se);if(l(T)){var x=n.multiplyByScalar(n.UNIT_Y,5*y.EPSILON9,Oe);if(m.y<0){n.negate(x,x);_=s.attributes;w=s.indices;C=d;b=o.attributes;S=o.indices;E=f}var A=n.add(T,x,Re);De(_,w,C,a,u,m);De(_,w,C,a,-1,A);n.negate(x,x);n.add(T,x,A);De(b,S,E,a,-1,A);De(b,S,E,a,u+1,v)}else{var P;var D;var M;if(m.y<0){P=s.attributes;D=s.indices;M=d}else{P=o.attributes;D=o.indices;M=f}De(P,D,M,a,u,m);De(P,D,M,a,u+1,v)}}we(e,s,o)}var Le=new i;var Be=new i;var Fe=new n;var ke=new n;var Ve=new n;var ze=new n;var Ue=new n;var qe=new n;var Ge=new a;function He(e){var t=e.attributes;var r=t.position.values;var i=t.prevPosition.values;var a=t.nextPosition.values;var o=r.length;for(var s=0;s<o;s+=3){var u=n.unpack(r,s,Fe);if(u.x>0){continue}var l=n.unpack(i,s,ke);if(u.y<0&&l.y>0||u.y>0&&l.y<0){if(s-3>0){i[s]=r[s-3];i[s+1]=r[s-2];i[s+2]=r[s-1]}else{n.pack(u,i,s)}}var c=n.unpack(a,s,Ve);if(u.y<0&&c.y>0||u.y>0&&c.y<0){if(s+3<o){a[s]=r[s+3];a[s+1]=r[s+4];a[s+2]=r[s+5]}else{n.pack(u,a,s)}}}}var We=5*y.EPSILON9;var je=y.EPSILON6;function Ye(e){var t=e.geometry;var r=t.attributes;var o=r.position.values;var s=r.prevPosition.values;var u=r.nextPosition.values;var c=r.expandAndWidth.values;var d=l(r.st)?r.st.values:undefined;var f=l(r.color)?r.color.values:undefined;var h=ye(t);var p=ye(t);var m;var v;var _;var w=false;var C=o.length/3;for(m=0;m<C;m+=4){var b=m;var S=m+2;var E=n.fromArray(o,b*3,Fe);var T=n.fromArray(o,S*3,ke);if(Math.abs(E.y)<je){E.y=je*(T.y<0?-1:1);o[m*3+1]=E.y;o[(m+1)*3+1]=E.y;for(v=b*3;v<b*3+4*3;v+=3){s[v]=o[m*3];s[v+1]=o[m*3+1];s[v+2]=o[m*3+2]}}if(Math.abs(T.y)<je){T.y=je*(E.y<0?-1:1);o[(m+2)*3+1]=T.y;o[(m+3)*3+1]=T.y;for(v=b*3;v<b*3+4*3;v+=3){u[v]=o[(m+2)*3];u[v+1]=o[(m+2)*3+1];u[v+2]=o[(m+2)*3+2]}}var x=h.attributes;var A=h.indices;var P=p.attributes;var D=p.indices;var M=g.lineSegmentPlane(E,T,Ie,ze);if(l(M)){w=true;var I=n.multiplyByScalar(n.UNIT_Y,We,Ue);if(E.y<0){n.negate(I,I);x=p.attributes;A=p.indices;P=h.attributes;D=h.indices}var O=n.add(M,I,qe);x.position.values.push(E.x,E.y,E.z,E.x,E.y,E.z);x.position.values.push(O.x,O.y,O.z);x.position.values.push(O.x,O.y,O.z);x.prevPosition.values.push(s[b*3],s[b*3+1],s[b*3+2]);x.prevPosition.values.push(s[b*3+3],s[b*3+4],s[b*3+5]);x.prevPosition.values.push(E.x,E.y,E.z,E.x,E.y,E.z);x.nextPosition.values.push(O.x,O.y,O.z);x.nextPosition.values.push(O.x,O.y,O.z);x.nextPosition.values.push(O.x,O.y,O.z);x.nextPosition.values.push(O.x,O.y,O.z);n.negate(I,I);n.add(M,I,O);P.position.values.push(O.x,O.y,O.z);P.position.values.push(O.x,O.y,O.z);P.position.values.push(T.x,T.y,T.z,T.x,T.y,T.z);P.prevPosition.values.push(O.x,O.y,O.z);P.prevPosition.values.push(O.x,O.y,O.z);P.prevPosition.values.push(O.x,O.y,O.z);P.prevPosition.values.push(O.x,O.y,O.z);P.nextPosition.values.push(T.x,T.y,T.z,T.x,T.y,T.z);P.nextPosition.values.push(u[S*3],u[S*3+1],u[S*3+2]);P.nextPosition.values.push(u[S*3+3],u[S*3+4],u[S*3+5]);var R=i.fromArray(c,b*2,Le);var N=Math.abs(R.y);x.expandAndWidth.values.push(-1,N,1,N);x.expandAndWidth.values.push(-1,-N,1,-N);P.expandAndWidth.values.push(-1,N,1,N);P.expandAndWidth.values.push(-1,-N,1,-N);var L=n.magnitudeSquared(n.subtract(M,E,Ve));L/=n.magnitudeSquared(n.subtract(T,E,Ve));if(l(f)){var B=a.fromArray(f,b*4,Ge);var F=a.fromArray(f,S*4,Ge);var k=y.lerp(B.x,F.x,L);var V=y.lerp(B.y,F.y,L);var z=y.lerp(B.z,F.z,L);var U=y.lerp(B.w,F.w,L);for(v=b*4;v<b*4+2*4;++v){x.color.values.push(f[v])}x.color.values.push(k,V,z,U);x.color.values.push(k,V,z,U);P.color.values.push(k,V,z,U);P.color.values.push(k,V,z,U);for(v=S*4;v<S*4+2*4;++v){P.color.values.push(f[v])}}if(l(d)){var q=i.fromArray(d,b*2,Le);var G=i.fromArray(d,(m+3)*2,Be);var H=y.lerp(q.x,G.x,L);for(v=b*2;v<b*2+2*2;++v){x.st.values.push(d[v])}x.st.values.push(H,q.y);x.st.values.push(H,G.y);P.st.values.push(H,q.y);P.st.values.push(H,G.y);for(v=S*2;v<S*2+2*2;++v){P.st.values.push(d[v])}}_=x.position.values.length/3-4;A.push(_,_+2,_+1);A.push(_+1,_+2,_+3);_=P.position.values.length/3-4;D.push(_,_+2,_+1);D.push(_+1,_+2,_+3)}else{var W;var j;if(E.y<0){W=p.attributes;j=p.indices}else{W=h.attributes;j=h.indices}W.position.values.push(E.x,E.y,E.z);W.position.values.push(E.x,E.y,E.z);W.position.values.push(T.x,T.y,T.z);W.position.values.push(T.x,T.y,T.z);for(v=m*3;v<m*3+4*3;++v){W.prevPosition.values.push(s[v]);W.nextPosition.values.push(u[v])}for(v=m*2;v<m*2+4*2;++v){W.expandAndWidth.values.push(c[v]);if(l(d)){W.st.values.push(d[v])}}if(l(f)){for(v=m*4;v<m*4+4*4;++v){W.color.values.push(f[v])}}_=W.position.values.length/3-4;j.push(_,_+2,_+1);j.push(_+1,_+2,_+3)}}if(w){He(p);He(h)}we(e,p,h)}T.splitLongitude=function(e){if(!l(e)){throw new c("instance is required.")}var t=e.geometry;var i=t.boundingSphere;if(l(i)){var n=i.center.x-i.radius;if(n>0||r.intersectPlane(i,b.ORIGIN_ZX_PLANE)!==_.INTERSECTING){return e}}if(t.geometryType!==m.NONE){switch(t.geometryType){case m.POLYLINES:Ye(e);break;case m.TRIANGLES:Me(e);break;case m.LINES:Ne(e);break}}else{se(t);if(t.primitiveType===S.TRIANGLES){Me(e)}else if(t.primitiveType===S.LINES){Ne(e)}}return e};return T});define("Core/getBaseUri",["../ThirdParty/Uri","./defined","./DeveloperError"],function(e,t,r){"use strict";function i(i,n){if(!t(i)){throw new r("uri is required.")}var a="";var o=i.lastIndexOf("/");if(o!==-1){a=i.substring(0,o+1)}if(!n){return a}i=new e(i);if(t(i.query)){a+="?"+i.query}if(t(i.fragment)){a+="#"+i.fragment}return a}return i});define("Core/getExtensionFromUri",["../ThirdParty/Uri","./defined","./DeveloperError"],function(e,t,r){"use strict";function i(i){if(!t(i)){throw new r("uri is required.")}var n=new e(i);n.normalize();var a=n.path;var o=a.lastIndexOf("/");if(o!==-1){a=a.substr(o+1)}o=a.lastIndexOf(".");if(o===-1){a=""}else{a=a.substr(o+1)}return a}return i});define("Core/getFilenameFromUri",["../ThirdParty/Uri","./defined","./DeveloperError"],function(e,t,r){"use strict";function i(i){if(!t(i)){throw new r("uri is required.")}var n=new e(i);n.normalize();var a=n.path;var o=a.lastIndexOf("/");if(o!==-1){a=a.substr(o+1)}return a}return i});define("Core/getImagePixels",["./defined"],function(e){"use strict";var t={};function r(r,i,n){if(!e(i)){i=r.width}if(!e(n)){n=r.height}var a=t[i];if(!e(a)){a={};t[i]=a}var o=a[n];if(!e(o)){var s=document.createElement("canvas");s.width=i;s.height=n;o=s.getContext("2d");o.globalCompositeOperation="copy";a[n]=o}o.drawImage(r,0,0,i,n);return o.getImageData(0,0,i,n).data}return r});define("Core/getStringFromTypedArray",["./defaultValue","./defined","./DeveloperError"],function(e,t,r){"use strict";function i(n,a,o){if(!t(n)){throw new r("uint8Array is required.")}if(a<0){throw new r("byteOffset cannot be negative.")}if(o<0){throw new r("byteLength cannot be negative.")}if(a+o>n.byteLength){throw new r("sub-region exceeds array bounds.")}a=e(a,0);o=e(o,n.byteLength-a);n=n.subarray(a,a+o);return i.decode(n)}i.decodeWithTextDecoder=function(e){var t=new TextDecoder("utf-8");return t.decode(e)};i.decodeWithFromCharCode=function(e){var t="";var r=e.length;for(var i=0;i<r;++i){t+=String.fromCharCode(e[i])}return t};if(typeof TextDecoder!=="undefined"){i.decode=i.decodeWithTextDecoder}else{i.decode=i.decodeWithFromCharCode}return i});define("Core/getMagic",["./defaultValue","./getStringFromTypedArray"],function(e,t){"use strict";function r(r,i){i=e(i,0);return t(r,i,Math.min(4,r.length))}return r});define("Core/HeadingPitchRange",["./defaultValue","./defined"],function(e,t){"use strict";function r(t,r,i){this.heading=e(t,0);this.pitch=e(r,0);this.range=e(i,0)}r.clone=function(e,i){if(!t(e)){return undefined}if(!t(i)){i=new r}i.heading=e.heading;i.pitch=e.pitch;i.range=e.range;return i};return r});define("Core/HermitePolynomialApproximation",["./defaultValue","./defined","./DeveloperError","./Math"],function(e,t,r,i){"use strict";var n=i.factorial;function a(e,t,r,i,n,o){var s=0;var u;var l;var c;if(i>0){for(l=0;l<n;l++){u=false;for(c=0;c<o.length&&!u;c++){if(l===o[c]){u=true}}if(!u){o.push(l);s+=a(e,t,r,i-1,n,o);o.splice(o.length-1,1)}}return s}s=1;for(l=0;l<n;l++){u=false;for(c=0;c<o.length&&!u;c++){if(l===o[c]){u=true}}if(!u){s*=e-r[t[l]]}}return s}var o={type:"Hermite"};o.getRequiredDataPoints=function(i,n){n=e(n,0);if(!t(i)){throw new r("degree is required.")}if(i<0){throw new r("degree must be 0 or greater.")}if(n<0){throw new r("inputOrder must be 0 or greater.")}return Math.max(Math.floor((i+1)/(n+1)),2)};o.interpolateOrderZero=function(e,r,i,o,s){if(!t(s)){s=new Array(o)}var u;var l;var c;var d;var f;var h;var p=r.length;var m=new Array(o);for(u=0;u<o;u++){s[u]=0;var v=new Array(p);m[u]=v;for(l=0;l<p;l++){v[l]=[]}}var _=p,g=new Array(_);for(u=0;u<_;u++){g[u]=u}var y=p-1;for(d=0;d<o;d++){for(l=0;l<_;l++){h=g[l]*o+d;m[d][0].push(i[h])}for(u=1;u<_;u++){var w=false;for(l=0;l<_-u;l++){var C=r[g[l]];var b=r[g[l+u]];var S;if(b-C<=0){h=g[l]*o+o*u+d;S=i[h];m[d][u].push(S/n(u))}else{S=m[d][u-1][l+1]-m[d][u-1][l];m[d][u].push(S/(b-C))}w=w||S!==0}if(!w){y=u-1}}}for(c=0,f=0;c<=f;c++){for(u=c;u<=y;u++){var E=a(e,g,r,c,u,[]);for(d=0;d<o;d++){var T=m[d][u][0];s[d+c*o]+=T*E}}}return s};var s=[];o.interpolate=function(e,r,i,n,o,l,c){var d=n*(l+1);if(!t(c)){c=new Array(d)}for(var f=0;f<d;f++){c[f]=0}var h=r.length;var p=new Array(h*(o+1));for(var m=0;m<h;m++){for(var v=0;v<o+1;v++){p[m*(o+1)+v]=m}}var _=p.length;var g=s;var y=u(g,p,r,i,n,o);var w=[];var C=_*(_+1)/2;var b=Math.min(y,l);for(var S=0;S<=b;S++){for(m=S;m<=y;m++){w.length=0;var E=a(e,p,r,S,m,w);var T=Math.floor(m*(1-m)/2)+_*m;for(var x=0;x<n;x++){var A=Math.floor(x*C);var P=g[A+T];c[x+S*n]+=P*E}}}return c};function u(e,t,r,n,a,o){var s;var u;var l=-1;var c=t.length;var d=c*(c+1)/2;for(var f=0;f<a;f++){var h=Math.floor(f*d);for(s=0;s<c;s++){u=t[s]*a*(o+1)+f;e[h+s]=n[u]}for(var p=1;p<c;p++){var m=0;var v=Math.floor(p*(1-p)/2)+c*p;var _=false;for(s=0;s<c-p;s++){var g=r[t[s]];var y=r[t[s+p]];var w;var C;if(y-g<=0){u=t[s]*a*(o+1)+a*p+f;w=n[u];C=w/i.factorial(p);e[h+v+m]=C;m++}else{var b=Math.floor((p-1)*(2-p)/2)+c*(p-1);w=e[h+b+s+1]-e[h+b+s];C=w/(y-g);e[h+v+m]=C;m++}_=_||w!==0}if(_){l=Math.max(l,p)}}}return l}return o});define("Core/IauOrientationParameters",[],function(){"use strict";function e(e,t,r,i){this.rightAscension=e;this.declination=t;this.rotation=r;this.rotationRate=i}return e});define("Core/Iau2000Orientation",["./defined","./IauOrientationParameters","./JulianDate","./Math","./TimeConstants"],function(e,t,r,i,n){"use strict";var a={};var o=32.184;var s=2451545;var u=-.0529921;var l=-.1059842;var c=13.0120009;var d=13.3407154;var f=.9856003;var h=26.4057084;var p=13.064993;var m=.3287146;var v=1.7484877;var _=-.1589763;var g=.0036096;var y=.1643573;var w=12.9590088;var C=new r;a.ComputeMoon=function(a,b){if(!e(a)){a=r.now()}C=r.addSeconds(a,o,C);var S=r.totalDays(C)-s;var E=S/n.DAYS_PER_JULIAN_CENTURY;var T=(125.045+u*S)*i.RADIANS_PER_DEGREE;var x=(250.089+l*S)*i.RADIANS_PER_DEGREE;var A=(260.008+c*S)*i.RADIANS_PER_DEGREE;var P=(176.625+d*S)*i.RADIANS_PER_DEGREE;var D=(357.529+f*S)*i.RADIANS_PER_DEGREE;var M=(311.589+h*S)*i.RADIANS_PER_DEGREE;var I=(134.963+p*S)*i.RADIANS_PER_DEGREE;var O=(276.617+m*S)*i.RADIANS_PER_DEGREE;var R=(34.226+v*S)*i.RADIANS_PER_DEGREE;var N=(15.134+_*S)*i.RADIANS_PER_DEGREE;var L=(119.743+g*S)*i.RADIANS_PER_DEGREE;var B=(239.961+y*S)*i.RADIANS_PER_DEGREE;var F=(25.053+w*S)*i.RADIANS_PER_DEGREE;var k=Math.sin(T);var V=Math.sin(x);var z=Math.sin(A);var U=Math.sin(P);var q=Math.sin(D);var G=Math.sin(M);var H=Math.sin(I);var W=Math.sin(O);var j=Math.sin(R);var Y=Math.sin(N);var X=Math.sin(L);var Z=Math.sin(B);var K=Math.sin(F);var Q=Math.cos(T);var J=Math.cos(x);var $=Math.cos(A);var ee=Math.cos(P);var te=Math.cos(D);var re=Math.cos(M);var ie=Math.cos(I);var ne=Math.cos(O);var ae=Math.cos(R);var oe=Math.cos(N);var se=Math.cos(L);var ue=Math.cos(B);var le=Math.cos(F);var ce=(269.9949+.0031*E-3.8787*k-.1204*V+.07*z-.0172*U+.0072*G-.0052*Y+.0043*K)*i.RADIANS_PER_DEGREE;var de=(66.5392+.013*E+1.5419*Q+.0239*J-.0278*$+.0068*ee-.0029*re+9e-4*ie+8e-4*oe-9e-4*le)*i.RADIANS_PER_DEGREE;var fe=(38.3213+13.17635815*S-1.4e-12*S*S+3.561*k+.1208*V-.0642*z+.0158*U+.0252*q-.0066*G-.0047*H-.0046*W+.0028*j+.0052*Y+.004*X+.0019*Z-.0044*K)*i.RADIANS_PER_DEGREE;var he=(13.17635815-1.4e-12*(2*S)+3.561*Q*u+.1208*J*l-.0642*$*c+.0158*ee*d+.0252*te*f-.0066*re*h-.0047*ie*p-.0046*ne*m+.0028*ae*v+.0052*oe*_+.004*se*g+.0019*ue*y-.0044*le*w)/86400*i.RADIANS_PER_DEGREE;if(!e(b)){b=new t}b.rightAscension=ce;b.declination=de;b.rotation=fe;b.rotationRate=he;return b};return a});define("Core/IauOrientationAxes",["./Cartesian3","./defined","./Iau2000Orientation","./JulianDate","./Math","./Matrix3","./Quaternion"],function(e,t,r,i,n,a,o){"use strict";function s(e){if(!t(e)||typeof e!=="function"){e=r.ComputeMoon}this._computeFunction=e}var u=new e;var l=new e;var c=new e;function d(r,i,o){var s=u;s.x=Math.cos(r+n.PI_OVER_TWO);s.y=Math.sin(r+n.PI_OVER_TWO);s.z=0;var d=Math.cos(i);var f=c;f.x=d*Math.cos(r);f.y=d*Math.sin(r);f.z=Math.sin(i);var h=e.cross(f,s,l);if(!t(o)){o=new a}o[0]=s.x;o[1]=h.x;o[2]=f.x;o[3]=s.y;o[4]=h.y;o[5]=f.y;o[6]=s.z;o[7]=h.z;o[8]=f.z;return o}var f=new a;var h=new o;s.prototype.evaluate=function(r,s){if(!t(r)){r=i.now()}var u=this._computeFunction(r);var l=d(u.rightAscension,u.declination,s);var c=n.zeroToTwoPi(u.rotation);var p=o.fromAxisAngle(e.UNIT_Z,c,h);var m=a.fromQuaternion(o.conjugate(p,p),f);var v=a.multiply(m,l,l);return v};return s});define("Core/InterpolationAlgorithm",["./DeveloperError"],function(e){"use strict";var t={};t.type=undefined;t.getRequiredDataPoints=e.throwInstantiationError;t.interpolateOrderZero=e.throwInstantiationError;t.interpolate=e.throwInstantiationError;return t});define("Core/isDataUri",["./defined"],function(e){"use strict";var t=/^data:(.*?)(;base64)?,(.*)$/;function r(r){if(e(r)){return t.test(r)}return false}return r});define("Core/TimeInterval",["./defaultValue","./defined","./defineProperties","./DeveloperError","./freezeObject","./JulianDate"],function(e,t,r,i,n,a){"use strict";function o(r){r=e(r,e.EMPTY_OBJECT);this.start=t(r.start)?a.clone(r.start):new a;this.stop=t(r.stop)?a.clone(r.stop):new a;this.data=r.data;this.isStartIncluded=e(r.isStartIncluded,true);this.isStopIncluded=e(r.isStopIncluded,true)}r(o.prototype,{isEmpty:{get:function(){var e=a.compare(this.stop,this.start);return e<0||e===0&&(!this.isStartIncluded||!this.isStopIncluded)}}});var s={start:undefined,stop:undefined,isStartIncluded:undefined,isStopIncluded:undefined,data:undefined};o.fromIso8601=function(r,n){if(!t(r)){throw new i("options is required.")}if(!t(r.iso8601)){throw new i("options.iso8601 is required.")}var u=r.iso8601.split("/");var l=a.fromIso8601(u[0]);var c=a.fromIso8601(u[1]);var d=e(r.isStartIncluded,true);var f=e(r.isStopIncluded,true);var h=r.data;if(!t(n)){s.start=l;s.stop=c;s.isStartIncluded=d;s.isStopIncluded=f;s.data=h;return new o(s)}n.start=l;n.stop=c;n.isStartIncluded=d;n.isStopIncluded=f;n.data=h;return n};o.toIso8601=function(e,r){if(!t(e)){throw new i("timeInterval is required.")}return a.toIso8601(e.start,r)+"/"+a.toIso8601(e.stop,r)};o.clone=function(e,r){if(!t(e)){return undefined}if(!t(r)){return new o(e)}r.start=e.start;r.stop=e.stop;r.isStartIncluded=e.isStartIncluded;r.isStopIncluded=e.isStopIncluded;r.data=e.data;return r};o.equals=function(e,r,i){return e===r||t(e)&&t(r)&&(e.isEmpty&&r.isEmpty||e.isStartIncluded===r.isStartIncluded&&e.isStopIncluded===r.isStopIncluded&&a.equals(e.start,r.start)&&a.equals(e.stop,r.stop)&&(e.data===r.data||t(i)&&i(e.data,r.data)))};o.equalsEpsilon=function(e,r,n,o){if(typeof n!=="number"){throw new i("epsilon is required and must be a number.")}return e===r||t(e)&&t(r)&&(e.isEmpty&&r.isEmpty||e.isStartIncluded===r.isStartIncluded&&e.isStopIncluded===r.isStopIncluded&&a.equalsEpsilon(e.start,r.start,n)&&a.equalsEpsilon(e.stop,r.stop,n)&&(e.data===r.data||t(o)&&o(e.data,r.data)))};o.intersect=function(e,r,n,s){if(!t(e)){throw new i("left is required.")}if(!t(n)){throw new i("result is required.")}if(!t(r)){return o.clone(o.EMPTY,n)}var u=e.start;var l=e.stop;var c=r.start;var d=r.stop;var f=a.greaterThanOrEquals(c,u)&&a.greaterThanOrEquals(l,c);var h=!f&&a.lessThanOrEquals(c,u)&&a.lessThanOrEquals(u,d);if(!f&&!h){return o.clone(o.EMPTY,n)}var p=e.isStartIncluded;var m=e.isStopIncluded;var v=r.isStartIncluded;var _=r.isStopIncluded;var g=a.lessThan(l,d);n.start=f?c:u;n.isStartIncluded=p&&v||!a.equals(c,u)&&(f&&v||h&&p);n.stop=g?l:d;n.isStopIncluded=g?m:m&&_||!a.equals(d,l)&&_;n.data=t(s)?s(e.data,r.data):e.data;return n};o.contains=function(e,r){if(!t(e)){throw new i("timeInterval is required.")}if(!t(r)){throw new i("julianDate is required.")}if(e.isEmpty){return false}var n=a.compare(e.start,r);if(n===0){return e.isStartIncluded}var o=a.compare(r,e.stop);if(o===0){return e.isStopIncluded}return n<0&&o<0};o.prototype.clone=function(e){return o.clone(this,e)};o.prototype.equals=function(e,t){return o.equals(this,e,t)};o.prototype.equalsEpsilon=function(e,t,r){return o.equalsEpsilon(this,e,t,r)};o.prototype.toString=function(){return o.toIso8601(this)};o.EMPTY=n(new o({start:new a,stop:new a,isStartIncluded:false,isStopIncluded:false}));return o});define("Core/Iso8601",["./freezeObject","./JulianDate","./TimeInterval"],function(e,t,r){"use strict";var i=e(t.fromIso8601("0000-01-01T00:00:00Z"));var n=e(t.fromIso8601("9999-12-31T24:00:00Z"));var a=e(new r({start:i,stop:n}));var o={MINIMUM_VALUE:i,MAXIMUM_VALUE:n,MAXIMUM_INTERVAL:a};return o});define("Core/KeyboardEventModifier",["./freezeObject"],function(e){"use strict";var t={SHIFT:0,CTRL:1,ALT:2};return e(t)});define("Core/LagrangePolynomialApproximation",["./defined"],function(e){"use strict";var t={type:"Lagrange"};t.getRequiredDataPoints=function(e){return Math.max(e+1,2)};t.interpolateOrderZero=function(t,r,i,n,a){if(!e(a)){a=new Array(n)}var o;var s;var u=r.length;for(o=0;o<n;o++){a[o]=0}for(o=0;o<u;o++){var l=1;for(s=0;s<u;s++){if(s!==o){var c=r[o]-r[s];l*=(t-r[s])/c}}for(s=0;s<n;s++){a[s]+=l*i[o*n+s]}}return a};return t});define("Core/LinearApproximation",["./defined","./DeveloperError"],function(e,t){"use strict";var r={type:"Linear"};r.getRequiredDataPoints=function(e){return 2};r.interpolateOrderZero=function(r,i,n,a,o){if(i.length!==2){throw new t("The xTable provided to the linear interpolator must have exactly two elements.")}else if(a<=0){throw new t("There must be at least 1 dependent variable for each independent variable.")}if(!e(o)){o=new Array(a)}var s;var u;var l;var c=i[0];var d=i[1];if(c===d){throw new t("Divide by zero error: xTable[0] and xTable[1] are equal")}for(s=0;s<a;s++){u=n[s];l=n[s+a];o[s]=((l-u)*r+d*u-c*l)/(d-c)}return o};return r});define("Core/loadBlob",["./loadWithXhr"],function(e){"use strict";function t(t,r){return e({url:t,responseType:"blob",headers:r})}return t});define("Core/loadCRN",["./CompressedTextureBuffer","./defined","./DeveloperError","./loadArrayBuffer","./TaskProcessor","../ThirdParty/when"],function(e,t,r,i,n,a){"use strict";var o=new n("transcodeCRNToDXT",Number.POSITIVE_INFINITY);function s(n,s){if(!t(n)){throw new r("urlOrBuffer is required.")}var u;if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)){u=a.resolve(n)}else{u=i(n,s)}return u.then(function(e){var t=[];if(e instanceof ArrayBuffer){t.push(e)}else if(e.byteOffset===0&&e.byteLength===e.buffer.byteLength){t.push(e.buffer)}else{e=e.slice(0,e.length);t.push(e.buffer)}return o.scheduleTask(e,t)}).then(function(t){return e.clone(t)})}return s});define("Core/loadImage",["../ThirdParty/when","./defaultValue","./defined","./DeveloperError","./isCrossOriginUrl","./TrustedServers"],function(e,t,r,i,n,a){"use strict";var o=/^data:/;function s(a,u){if(!r(a)){throw new i("url is required.")}u=t(u,true);return e(a,function(t){var r;if(o.test(t)||!u){r=false}else{r=n(t)}var i=e.defer();s.createImage(t,r,i);return i.promise})}s.createImage=function(e,t,r){var i=new Image;i.onload=function(){r.resolve(i)};i.onerror=function(e){r.reject(e)};if(t){if(a.contains(e)){i.crossOrigin="use-credentials"}else{i.crossOrigin=""}}if(!/file:\/\/\//.test(e)&&/file:\/\//.test(e)){e=e.replace("file://","file:///")}i.src=e};s.defaultCreateImage=s.createImage;return s});define("Core/loadImageFromTypedArray",["../ThirdParty/when","./defined","./DeveloperError","./loadImage"],function(e,t,r,i){"use strict";function n(n,a){if(!t(n)){throw new r("uint8Array is required.")}if(!t(a)){throw new r("format is required.")}var o=new Blob([n],{type:a});var s=window.URL.createObjectURL(o);return i(s,false).then(function(e){window.URL.revokeObjectURL(s);return e},function(t){window.URL.revokeObjectURL(s);return e.reject(t)})}return n});define("Core/loadImageViaBlob",["../ThirdParty/when","./loadBlob","./loadImage"],function(e,t,r){"use strict";var i=/^data:/;function n(n){if(i.test(n)){return r(n)}return t(n).then(function(t){var i=window.URL.createObjectURL(t);return r(i,false).then(function(e){e.blob=t;window.URL.revokeObjectURL(i);return e},function(t){window.URL.revokeObjectURL(i);return e.reject(t)})})}var a=function(){try{var e=new XMLHttpRequest;e.open("GET","#",true);e.responseType="blob";return e.responseType==="blob"}catch(e){return false}}();return a?n:r});define("Renderer/PixelDatatype",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";var r={UNSIGNED_BYTE:t.UNSIGNED_BYTE,UNSIGNED_SHORT:t.UNSIGNED_SHORT,UNSIGNED_INT:t.UNSIGNED_INT,FLOAT:t.FLOAT,UNSIGNED_INT_24_8:t.UNSIGNED_INT_24_8,UNSIGNED_SHORT_4_4_4_4:t.UNSIGNED_SHORT_4_4_4_4,UNSIGNED_SHORT_5_5_5_1:t.UNSIGNED_SHORT_5_5_5_1,UNSIGNED_SHORT_5_6_5:t.UNSIGNED_SHORT_5_6_5,isPacked:function(e){return e===r.UNSIGNED_INT_24_8||e===r.UNSIGNED_SHORT_4_4_4_4||e===r.UNSIGNED_SHORT_5_5_5_1||e===r.UNSIGNED_SHORT_5_6_5},sizeInBytes:function(e){switch(e){case r.UNSIGNED_BYTE:return 1;case r.UNSIGNED_SHORT:case r.UNSIGNED_SHORT_4_4_4_4:case r.UNSIGNED_SHORT_5_5_5_1:case r.UNSIGNED_SHORT_5_6_5:return 2;case r.UNSIGNED_INT:case r.FLOAT:case r.UNSIGNED_INT_24_8:return 4}},validate:function(e){return e===r.UNSIGNED_BYTE||e===r.UNSIGNED_SHORT||e===r.UNSIGNED_INT||e===r.FLOAT||e===r.UNSIGNED_INT_24_8||e===r.UNSIGNED_SHORT_4_4_4_4||e===r.UNSIGNED_SHORT_5_5_5_1||e===r.UNSIGNED_SHORT_5_6_5}};return e(r)});define("Core/PixelFormat",["../Renderer/PixelDatatype","./freezeObject","./WebGLConstants"],function(e,t,r){"use strict";var i={DEPTH_COMPONENT:r.DEPTH_COMPONENT,DEPTH_STENCIL:r.DEPTH_STENCIL,ALPHA:r.ALPHA,RGB:r.RGB,RGBA:r.RGBA,LUMINANCE:r.LUMINANCE,LUMINANCE_ALPHA:r.LUMINANCE_ALPHA,RGB_DXT1:r.COMPRESSED_RGB_S3TC_DXT1_EXT,RGBA_DXT1:r.COMPRESSED_RGBA_S3TC_DXT1_EXT,RGBA_DXT3:r.COMPRESSED_RGBA_S3TC_DXT3_EXT,RGBA_DXT5:r.COMPRESSED_RGBA_S3TC_DXT5_EXT,RGB_PVRTC_4BPPV1:r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG,RGB_PVRTC_2BPPV1:r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG,RGBA_PVRTC_4BPPV1:r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG,RGBA_PVRTC_2BPPV1:r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG,RGB_ETC1:r.COMPRESSED_RGB_ETC1_WEBGL,componentsLength:function(e){switch(e){case i.RGB:case i.RGBA:return 4;case i.LUMINANCE_ALPHA:return 2;case i.ALPHA:case i.LUMINANCE:return 1;default:return 1}},validate:function(e){return e===i.DEPTH_COMPONENT||e===i.DEPTH_STENCIL||e===i.ALPHA||e===i.RGB||e===i.RGBA||e===i.LUMINANCE||e===i.LUMINANCE_ALPHA||e===i.RGB_DXT1||e===i.RGBA_DXT1||e===i.RGBA_DXT3||e===i.RGBA_DXT5||e===i.RGB_PVRTC_4BPPV1||e===i.RGB_PVRTC_2BPPV1||e===i.RGBA_PVRTC_4BPPV1||e===i.RGBA_PVRTC_2BPPV1||e===i.RGB_ETC1},isColorFormat:function(e){
return e===i.ALPHA||e===i.RGB||e===i.RGBA||e===i.LUMINANCE||e===i.LUMINANCE_ALPHA},isDepthFormat:function(e){return e===i.DEPTH_COMPONENT||e===i.DEPTH_STENCIL},isCompressedFormat:function(e){return e===i.RGB_DXT1||e===i.RGBA_DXT1||e===i.RGBA_DXT3||e===i.RGBA_DXT5||e===i.RGB_PVRTC_4BPPV1||e===i.RGB_PVRTC_2BPPV1||e===i.RGBA_PVRTC_4BPPV1||e===i.RGBA_PVRTC_2BPPV1||e===i.RGB_ETC1},isDXTFormat:function(e){return e===i.RGB_DXT1||e===i.RGBA_DXT1||e===i.RGBA_DXT3||e===i.RGBA_DXT5},isPVRTCFormat:function(e){return e===i.RGB_PVRTC_4BPPV1||e===i.RGB_PVRTC_2BPPV1||e===i.RGBA_PVRTC_4BPPV1||e===i.RGBA_PVRTC_2BPPV1},isETC1Format:function(e){return e===i.RGB_ETC1},compressedTextureSizeInBytes:function(e,t,r){switch(e){case i.RGB_DXT1:case i.RGBA_DXT1:case i.RGB_ETC1:return Math.floor((t+3)/4)*Math.floor((r+3)/4)*8;case i.RGBA_DXT3:case i.RGBA_DXT5:return Math.floor((t+3)/4)*Math.floor((r+3)/4)*16;case i.RGB_PVRTC_4BPPV1:case i.RGBA_PVRTC_4BPPV1:return Math.floor((Math.max(t,8)*Math.max(r,8)*4+7)/8);case i.RGB_PVRTC_2BPPV1:case i.RGBA_PVRTC_2BPPV1:return Math.floor((Math.max(t,16)*Math.max(r,8)*2+7)/8);default:return 0}},textureSizeInBytes:function(t,r,n,a){var o=i.componentsLength(t);if(e.isPacked(r)){o=1}return o*e.sizeInBytes(r)*n*a}};return t(i)});define("Core/loadKTX",["../ThirdParty/when","./CompressedTextureBuffer","./defined","./DeveloperError","./loadArrayBuffer","./PixelFormat","./RuntimeError"],function(e,t,r,i,n,a,o){"use strict";function s(t,a){if(!r(t)){throw new i("urlOrBuffer is required.")}var o;if(t instanceof ArrayBuffer||ArrayBuffer.isView(t)){o=e.resolve(t)}else{o=n(t,a)}return o.then(function(e){return d(e)})}var u=[171,75,84,88,32,49,49,187,13,10,26,10];var l=67305985;var c=4;function d(e){var i=new Uint8Array(e);var n=true;for(var s=0;s<u.length;++s){if(u[s]!==i[s]){n=false;break}}if(!n){throw new o("Invalid KTX file.")}var d;var f;if(r(e.buffer)){d=new DataView(e.buffer);f=e.byteOffset}else{d=new DataView(e);f=0}f+=12;var h=d.getUint32(f,true);f+=c;if(h!==l){throw new o("File is the wrong endianness.")}var p=d.getUint32(f,true);f+=c;var m=d.getUint32(f,true);f+=c;var v=d.getUint32(f,true);f+=c;var _=d.getUint32(f,true);f+=c;var g=d.getUint32(f,true);f+=c;var y=d.getUint32(f,true);f+=c;var w=d.getUint32(f,true);f+=c;var C=d.getUint32(f,true);f+=c;var b=d.getUint32(f,true);f+=c;var S=d.getUint32(f,true);f+=c;var E=d.getUint32(f,true);f+=c;var T=d.getUint32(f,true);f+=c;f+=T;var x=d.getUint32(f,true);f+=c;var A;if(r(e.buffer)){A=new Uint8Array(e.buffer,f,x)}else{A=new Uint8Array(e,f,x)}if(_===32849){_=a.RGB}else if(_===32856){_=a.RGBA}if(!a.validate(_)){throw new o("glInternalFormat is not a valid format.")}if(a.isCompressedFormat(_)){if(p!==0){throw new o("glType must be zero when the texture is compressed.")}if(m!==1){throw new o("The type size for compressed textures must be 1.")}if(v!==0){throw new o("glFormat must be zero when the texture is compressed.")}if(E===0){throw new o("Generating mipmaps for a compressed texture is unsupported.")}}else{if(g!==v){throw new o("The base internal format must be the same as the format for uncompressed textures.")}}if(C!==0){throw new o("3D textures are unsupported.")}if(b!==0){throw new o("Texture arrays are unsupported.")}if(S!==1){throw new o("Cubemaps are unsupported.")}if(a.isCompressedFormat(_)&&E>1){var P=a.compressedTextureSizeInBytes(_,y,w);A=A.slice(0,P)}return new t(_,y,w,A)}return s});define("Core/loadXML",["./loadWithXhr"],function(e){"use strict";function t(t,r){return e({url:t,responseType:"document",headers:r,overrideMimeType:"text/xml"})}return t});define("Core/MapboxApi",["./defined","./Credit"],function(e,t){"use strict";var r={};r.defaultAccessToken=undefined;var i=false;var n;var a="This application is using Cesium's default Mapbox access token.  Please create a new access token for the application as soon as possible and prior to deployment by visiting https://www.mapbox.com/account/apps/, and provide your token to Cesium by setting the Cesium.MapboxApi.defaultAccessToken property before constructing the CesiumWidget or any other object that uses the Mapbox API.";r.getAccessToken=function(t){if(e(t)){return t}if(!e(r.defaultAccessToken)){if(!i){console.log(a);i=true}return"pk.eyJ1IjoiYW5hbHl0aWNhbGdyYXBoaWNzIiwiYSI6ImNpd204Zm4wejAwNzYyeW5uNjYyZmFwdWEifQ.7i-VIZZWX8pd1bTfxIVj9g"}return r.defaultAccessToken};r.getErrorCredit=function(i){if(e(i)||e(r.defaultAccessToken)){return undefined}if(!e(n)){n=new t(a)}return n};return r});define("Core/MapProjection",["./defineProperties","./DeveloperError"],function(e,t){"use strict";function r(){t.throwInstantiationError()}e(r.prototype,{ellipsoid:{get:t.throwInstantiationError}});r.prototype.project=t.throwInstantiationError;r.prototype.unproject=t.throwInstantiationError;return r});define("Core/Matrix2",["./Cartesian2","./Check","./defaultValue","./defined","./defineProperties","./freezeObject"],function(e,t,r,i,n,a){"use strict";function o(e,t,i,n){this[0]=r(e,0);this[1]=r(i,0);this[2]=r(t,0);this[3]=r(n,0)}o.packedLength=4;o.pack=function(e,i,n){t.typeOf.object("value",e);t.defined("array",i);n=r(n,0);i[n++]=e[0];i[n++]=e[1];i[n++]=e[2];i[n++]=e[3];return i};o.unpack=function(e,n,a){t.defined("array",e);n=r(n,0);if(!i(a)){a=new o}a[0]=e[n++];a[1]=e[n++];a[2]=e[n++];a[3]=e[n++];return a};o.clone=function(e,t){if(!i(e)){return undefined}if(!i(t)){return new o(e[0],e[2],e[1],e[3])}t[0]=e[0];t[1]=e[1];t[2]=e[2];t[3]=e[3];return t};o.fromArray=function(e,n,a){t.defined("array",e);n=r(n,0);if(!i(a)){a=new o}a[0]=e[n];a[1]=e[n+1];a[2]=e[n+2];a[3]=e[n+3];return a};o.fromColumnMajorArray=function(e,r){t.defined("values",e);return o.clone(e,r)};o.fromRowMajorArray=function(e,r){t.defined("values",e);if(!i(r)){return new o(e[0],e[1],e[2],e[3])}r[0]=e[0];r[1]=e[2];r[2]=e[1];r[3]=e[3];return r};o.fromScale=function(e,r){t.typeOf.object("scale",e);if(!i(r)){return new o(e.x,0,0,e.y)}r[0]=e.x;r[1]=0;r[2]=0;r[3]=e.y;return r};o.fromUniformScale=function(e,r){t.typeOf.number("scale",e);if(!i(r)){return new o(e,0,0,e)}r[0]=e;r[1]=0;r[2]=0;r[3]=e;return r};o.fromRotation=function(e,r){t.typeOf.number("angle",e);var n=Math.cos(e);var a=Math.sin(e);if(!i(r)){return new o(n,-a,a,n)}r[0]=n;r[1]=a;r[2]=-a;r[3]=n;return r};o.toArray=function(e,r){t.typeOf.object("matrix",e);if(!i(r)){return[e[0],e[1],e[2],e[3]]}r[0]=e[0];r[1]=e[1];r[2]=e[2];r[3]=e[3];return r};o.getElementIndex=function(e,r){t.typeOf.number.greaterThanOrEquals("row",r,0);t.typeOf.number.lessThanOrEquals("row",r,1);t.typeOf.number.greaterThanOrEquals("column",e,0);t.typeOf.number.lessThanOrEquals("column",e,1);return e*2+r};o.getColumn=function(e,r,i){t.typeOf.object("matrix",e);t.typeOf.number.greaterThanOrEquals("index",r,0);t.typeOf.number.lessThanOrEquals("index",r,1);t.typeOf.object("result",i);var n=r*2;var a=e[n];var o=e[n+1];i.x=a;i.y=o;return i};o.setColumn=function(e,r,i,n){t.typeOf.object("matrix",e);t.typeOf.number.greaterThanOrEquals("index",r,0);t.typeOf.number.lessThanOrEquals("index",r,1);t.typeOf.object("cartesian",i);t.typeOf.object("result",n);n=o.clone(e,n);var a=r*2;n[a]=i.x;n[a+1]=i.y;return n};o.getRow=function(e,r,i){t.typeOf.object("matrix",e);t.typeOf.number.greaterThanOrEquals("index",r,0);t.typeOf.number.lessThanOrEquals("index",r,1);t.typeOf.object("result",i);var n=e[r];var a=e[r+2];i.x=n;i.y=a;return i};o.setRow=function(e,r,i,n){t.typeOf.object("matrix",e);t.typeOf.number.greaterThanOrEquals("index",r,0);t.typeOf.number.lessThanOrEquals("index",r,1);t.typeOf.object("cartesian",i);t.typeOf.object("result",n);n=o.clone(e,n);n[r]=i.x;n[r+2]=i.y;return n};var s=new e;o.getScale=function(r,i){t.typeOf.object("matrix",r);t.typeOf.object("result",i);i.x=e.magnitude(e.fromElements(r[0],r[1],s));i.y=e.magnitude(e.fromElements(r[2],r[3],s));return i};var u=new e;o.getMaximumScale=function(t){o.getScale(t,u);return e.maximumComponent(u)};o.multiply=function(e,r,i){t.typeOf.object("left",e);t.typeOf.object("right",r);t.typeOf.object("result",i);var n=e[0]*r[0]+e[2]*r[1];var a=e[0]*r[2]+e[2]*r[3];var o=e[1]*r[0]+e[3]*r[1];var s=e[1]*r[2]+e[3]*r[3];i[0]=n;i[1]=o;i[2]=a;i[3]=s;return i};o.add=function(e,r,i){t.typeOf.object("left",e);t.typeOf.object("right",r);t.typeOf.object("result",i);i[0]=e[0]+r[0];i[1]=e[1]+r[1];i[2]=e[2]+r[2];i[3]=e[3]+r[3];return i};o.subtract=function(e,r,i){t.typeOf.object("left",e);t.typeOf.object("right",r);t.typeOf.object("result",i);i[0]=e[0]-r[0];i[1]=e[1]-r[1];i[2]=e[2]-r[2];i[3]=e[3]-r[3];return i};o.multiplyByVector=function(e,r,i){t.typeOf.object("matrix",e);t.typeOf.object("cartesian",r);t.typeOf.object("result",i);var n=e[0]*r.x+e[2]*r.y;var a=e[1]*r.x+e[3]*r.y;i.x=n;i.y=a;return i};o.multiplyByScalar=function(e,r,i){t.typeOf.object("matrix",e);t.typeOf.number("scalar",r);t.typeOf.object("result",i);i[0]=e[0]*r;i[1]=e[1]*r;i[2]=e[2]*r;i[3]=e[3]*r;return i};o.multiplyByScale=function(e,r,i){t.typeOf.object("matrix",e);t.typeOf.object("scale",r);t.typeOf.object("result",i);i[0]=e[0]*r.x;i[1]=e[1]*r.x;i[2]=e[2]*r.y;i[3]=e[3]*r.y;return i};o.negate=function(e,r){t.typeOf.object("matrix",e);t.typeOf.object("result",r);r[0]=-e[0];r[1]=-e[1];r[2]=-e[2];r[3]=-e[3];return r};o.transpose=function(e,r){t.typeOf.object("matrix",e);t.typeOf.object("result",r);var i=e[0];var n=e[2];var a=e[1];var o=e[3];r[0]=i;r[1]=n;r[2]=a;r[3]=o;return r};o.abs=function(e,r){t.typeOf.object("matrix",e);t.typeOf.object("result",r);r[0]=Math.abs(e[0]);r[1]=Math.abs(e[1]);r[2]=Math.abs(e[2]);r[3]=Math.abs(e[3]);return r};o.equals=function(e,t){return e===t||i(e)&&i(t)&&e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]};o.equalsArray=function(e,t,r){return e[0]===t[r]&&e[1]===t[r+1]&&e[2]===t[r+2]&&e[3]===t[r+3]};o.equalsEpsilon=function(e,r,n){t.typeOf.number("epsilon",n);return e===r||i(e)&&i(r)&&Math.abs(e[0]-r[0])<=n&&Math.abs(e[1]-r[1])<=n&&Math.abs(e[2]-r[2])<=n&&Math.abs(e[3]-r[3])<=n};o.IDENTITY=a(new o(1,0,0,1));o.ZERO=a(new o(0,0,0,0));o.COLUMN0ROW0=0;o.COLUMN0ROW1=1;o.COLUMN1ROW0=2;o.COLUMN1ROW1=3;n(o.prototype,{length:{get:function(){return o.packedLength}}});o.prototype.clone=function(e){return o.clone(this,e)};o.prototype.equals=function(e){return o.equals(this,e)};o.prototype.equalsEpsilon=function(e,t){return o.equalsEpsilon(this,e,t)};o.prototype.toString=function(){return"("+this[0]+", "+this[2]+")\n"+"("+this[1]+", "+this[3]+")"};return o});define("Core/mergeSort",["./defined","./DeveloperError"],function(e,t){"use strict";var r=[];var i=[];function n(e,t,n,a,o,s){var u=o-a+1;var l=s-o;var c=r;var d=i;var f;var h;for(f=0;f<u;++f){c[f]=e[a+f]}for(h=0;h<l;++h){d[h]=e[o+h+1]}f=0;h=0;for(var p=a;p<=s;++p){var m=c[f];var v=d[h];if(f<u&&(h>=l||t(m,v,n)<=0)){e[p]=m;++f}else if(h<l){e[p]=v;++h}}}function a(e,t,r,i,o){if(i>=o){return}var s=Math.floor((i+o)*.5);a(e,t,r,i,s);a(e,t,r,s+1,o);n(e,t,r,i,s,o)}function o(n,o,s){if(!e(n)){throw new t("array is required.")}if(!e(o)){throw new t("comparator is required.")}var u=n.length;var l=Math.ceil(u*.5);r.length=l;i.length=l;a(n,o,s,0,u-1);r.length=0;i.length=0}return o});define("Core/NearFarScalar",["./defaultValue","./defined","./DeveloperError"],function(e,t,r){"use strict";function i(t,r,i,n){this.near=e(t,0);this.nearValue=e(r,0);this.far=e(i,1);this.farValue=e(n,0)}i.clone=function(e,r){if(!t(e)){return undefined}if(!t(r)){return new i(e.near,e.nearValue,e.far,e.farValue)}r.near=e.near;r.nearValue=e.nearValue;r.far=e.far;r.farValue=e.farValue;return r};i.packedLength=4;i.pack=function(i,n,a){if(!t(i)){throw new r("value is required")}if(!t(n)){throw new r("array is required")}a=e(a,0);n[a++]=i.near;n[a++]=i.nearValue;n[a++]=i.far;n[a]=i.farValue;return n};i.unpack=function(n,a,o){if(!t(n)){throw new r("array is required")}a=e(a,0);if(!t(o)){o=new i}o.near=n[a++];o.nearValue=n[a++];o.far=n[a++];o.farValue=n[a];return o};i.equals=function(e,r){return e===r||t(e)&&t(r)&&e.near===r.near&&e.nearValue===r.nearValue&&e.far===r.far&&e.farValue===r.farValue};i.prototype.clone=function(e){return i.clone(this,e)};i.prototype.equals=function(e){return i.equals(this,e)};return i});define("Core/Visibility",["./freezeObject"],function(e){"use strict";var t={NONE:-1,PARTIAL:0,FULL:1};return e(t)});define("Core/Occluder",["./BoundingSphere","./Cartesian3","./defaultValue","./defined","./defineProperties","./DeveloperError","./Ellipsoid","./Math","./Rectangle","./Visibility"],function(e,t,r,i,n,a,o,s,u,l){"use strict";function c(e,r){if(!i(e)){throw new a("occluderBoundingSphere is required.")}if(!i(r)){throw new a("camera position is required.")}this._occluderPosition=t.clone(e.center);this._occluderRadius=e.radius;this._horizonDistance=0;this._horizonPlaneNormal=undefined;this._horizonPlanePosition=undefined;this._cameraPosition=undefined;this.cameraPosition=r}var d=new t;n(c.prototype,{position:{get:function(){return this._occluderPosition}},radius:{get:function(){return this._occluderRadius}},cameraPosition:{set:function(e){if(!i(e)){throw new a("cameraPosition is required.")}e=t.clone(e,this._cameraPosition);var r=t.subtract(this._occluderPosition,e,d);var n=t.magnitudeSquared(r);var o=this._occluderRadius*this._occluderRadius;var s;var u;var l;if(n>o){s=Math.sqrt(n-o);n=1/Math.sqrt(n);u=t.multiplyByScalar(r,n,d);var c=s*s*n;l=t.add(e,t.multiplyByScalar(u,c,d),d)}else{s=Number.MAX_VALUE}this._horizonDistance=s;this._horizonPlaneNormal=u;this._horizonPlanePosition=l;this._cameraPosition=e}}});c.fromBoundingSphere=function(e,r,n){if(!i(e)){throw new a("occluderBoundingSphere is required.")}if(!i(r)){throw new a("camera position is required.")}if(!i(n)){return new c(e,r)}t.clone(e.center,n._occluderPosition);n._occluderRadius=e.radius;n.cameraPosition=r;return n};var f=new t;c.prototype.isPointVisible=function(e){if(this._horizonDistance!==Number.MAX_VALUE){var r=t.subtract(e,this._occluderPosition,f);var i=this._occluderRadius;i=t.magnitudeSquared(r)-i*i;if(i>0){i=Math.sqrt(i)+this._horizonDistance;r=t.subtract(e,this._cameraPosition,r);return i*i>t.magnitudeSquared(r)}}return false};var h=new t;c.prototype.isBoundingSphereVisible=function(e){var r=t.clone(e.center,h);var i=e.radius;if(this._horizonDistance!==Number.MAX_VALUE){var n=t.subtract(r,this._occluderPosition,f);var a=this._occluderRadius-i;a=t.magnitudeSquared(n)-a*a;if(i<this._occluderRadius){if(a>0){a=Math.sqrt(a)+this._horizonDistance;n=t.subtract(r,this._cameraPosition,n);return a*a+i*i>t.magnitudeSquared(n)}return false}if(a>0){n=t.subtract(r,this._cameraPosition,n);var o=t.magnitudeSquared(n);var s=this._occluderRadius*this._occluderRadius;var u=i*i;if((this._horizonDistance*this._horizonDistance+s)*u>o*s){return true}a=Math.sqrt(a)+this._horizonDistance;return a*a+u>o}return true}return false};var p=new t;c.prototype.computeVisibility=function(e){if(!i(e)){throw new a("occludeeBS is required.")}var r=t.clone(e.center);var n=e.radius;if(n>this._occluderRadius){return l.FULL}if(this._horizonDistance!==Number.MAX_VALUE){var o=t.subtract(r,this._occluderPosition,p);var s=this._occluderRadius-n;var u=t.magnitudeSquared(o);s=u-s*s;if(s>0){s=Math.sqrt(s)+this._horizonDistance;o=t.subtract(r,this._cameraPosition,o);var c=t.magnitudeSquared(o);if(s*s+n*n<c){return l.NONE}s=this._occluderRadius+n;s=u-s*s;if(s>0){s=Math.sqrt(s)+this._horizonDistance;return c<s*s+n*n?l.FULL:l.PARTIAL}o=t.subtract(r,this._horizonPlanePosition,o);return t.dot(o,this._horizonPlaneNormal)>-n?l.PARTIAL:l.FULL}}return l.NONE};var m=new t;c.computeOccludeePoint=function(e,r,n){if(!i(e)){throw new a("occluderBoundingSphere is required.")}if(!i(n)){throw new a("positions is required.")}if(n.length===0){throw new a("positions must contain at least one element")}var o=t.clone(r);var s=t.clone(e.center);var u=e.radius;var l=n.length;if(t.equals(s,r)){throw new a("occludeePosition must be different than occluderBoundingSphere.center")}var d=t.normalize(t.subtract(o,s,m),m);var f=-t.dot(d,s);var h=c._anyRotationVector(s,d,f);var p=c._horizonToPlaneNormalDotProduct(e,d,f,h,n[0]);if(!p){return undefined}var v;for(var _=1;_<l;++_){v=c._horizonToPlaneNormalDotProduct(e,d,f,h,n[_]);if(!v){return undefined}if(v<p){p=v}}if(p<.0017453283658983088){return undefined}var g=u/p;return t.add(s,t.multiplyByScalar(d,g,m),m)};var v=[];c.computeOccludeePointFromRectangle=function(n,s){if(!i(n)){throw new a("rectangle is required.")}s=r(s,o.WGS84);var l=u.subsample(n,s,0,v);var d=e.fromPoints(l);var f=t.ZERO;if(!t.equals(f,d.center)){return c.computeOccludeePoint(new e(f,s.minimumRadius),d.center,l)}return undefined};var _=new t;c._anyRotationVector=function(e,r,i){var n=t.abs(r,_);var a=n.x>n.y?0:1;if(a===0&&n.z>n.x||a===1&&n.z>n.y){a=2}var o=new t;var s;if(a===0){n.x=e.x;n.y=e.y+1;n.z=e.z+1;s=t.UNIT_X}else if(a===1){n.x=e.x+1;n.y=e.y;n.z=e.z+1;s=t.UNIT_Y}else{n.x=e.x+1;n.y=e.y+1;n.z=e.z;s=t.UNIT_Z}var u=(t.dot(r,n)+i)/-t.dot(r,s);return t.normalize(t.subtract(t.add(n,t.multiplyByScalar(s,u,o),n),e,n),n)};var g=new t;c._rotationVector=function(e,r,i,n,a){var o=t.subtract(n,e,g);o=t.normalize(o,o);if(t.dot(r,o)<.9999999847691291){var u=t.cross(r,o,o);var l=t.magnitude(u);if(l>s.EPSILON13){return t.normalize(u,new t)}}return a};var y=new t;var w=new t;var C=new t;var b=new t;c._horizonToPlaneNormalDotProduct=function(e,r,i,n,a){var o=t.clone(a,y);var s=t.clone(e.center,w);var u=e.radius;var l=t.subtract(s,o,C);var c=t.magnitudeSquared(l);var d=u*u;if(c<d){return false}var f=c-d;var h=Math.sqrt(f);var p=Math.sqrt(c);var m=1/p;var v=h*m;var _=v*h;l=t.normalize(l,l);var g=t.add(o,t.multiplyByScalar(l,_,b),b);var S=Math.sqrt(f-_*_);var E=this._rotationVector(s,r,i,o,n);var T=t.fromElements(E.x*E.x*l.x+(E.x*E.y-E.z)*l.y+(E.x*E.z+E.y)*l.z,(E.x*E.y+E.z)*l.x+E.y*E.y*l.y+(E.y*E.z-E.x)*l.z,(E.x*E.z-E.y)*l.x+(E.y*E.z+E.x)*l.y+E.z*E.z*l.z,y);T=t.normalize(T,T);var x=t.multiplyByScalar(T,S,y);E=t.normalize(t.subtract(t.add(g,x,C),s,C),C);var A=t.dot(r,E);E=t.normalize(t.subtract(t.subtract(g,x,E),s,E),E);var P=t.dot(r,E);return A<P?A:P};return c});define("Core/Packable",["./DeveloperError"],function(e){"use strict";var t={packedLength:undefined,pack:e.throwInstantiationError,unpack:e.throwInstantiationError};return t});define("Core/PackableForInterpolation",["./DeveloperError"],function(e){"use strict";var t={packedInterpolationLength:undefined,convertPackedArrayForInterpolation:e.throwInstantiationError,unpackInterpolationResult:e.throwInstantiationError};return t});define("ThirdParty/measureText",[],function(){var e=function(e,t){return document.defaultView.getComputedStyle(e,null).getPropertyValue(t)};var t=function(t,r,i,n){var a=t.measureText(r),o=e(t.canvas,"font-family"),s=e(t.canvas,"font-size").replace("px",""),u=e(t.canvas,"font-style"),l=e(t.canvas,"font-weight"),c=!/\S/.test(r);a.fontsize=s;var d=document.createElement("div");d.style.position="absolute";d.style.opacity=0;d.style.font=u+" "+l+" "+s+"px "+o;d.innerHTML=r+"<br/>"+r;document.body.appendChild(d);a.leading=1.2*s;var f=e(d,"height");f=f.replace("px","");if(f>=s*2){a.leading=f/2|0}document.body.removeChild(d);if(!c){var h=document.createElement("canvas");var p=100;h.width=a.width+p;h.height=3*s;h.style.opacity=1;h.style.fontFamily=o;h.style.fontSize=s;h.style.fontStyle=u;h.style.fontWeight=l;var m=h.getContext("2d");m.font=u+" "+l+" "+s+"px "+o;var v=h.width,_=h.height,g=_/2;m.fillStyle="white";m.fillRect(-1,-1,v+2,_+2);if(i){m.strokeStyle="black";m.lineWidth=t.lineWidth;m.strokeText(r,p/2,g)}if(n){m.fillStyle="black";m.fillText(r,p/2,g)}var y=m.getImageData(0,0,v,_).data;var w=0,C=v*4,b=y.length;while(++w<b&&y[w]===255){}var S=w/C|0;w=b-1;while(--w>0&&y[w]===255){}var E=w/C|0;for(w=0;w<b&&y[w]===255;){w+=C;if(w>=b){w=w-b+4}}var T=w%C/4|0;var x=1;for(w=b-3;w>=0&&y[w]===255;){w-=C;if(w<0){w=b-3-x++*4}}var A=w%C/4+1|0;a.ascent=g-S;a.descent=E-g;a.bounds={minx:T-p/2,maxx:A-p/2,miny:0,maxy:E-S};a.height=1+(E-S)}else{a.ascent=0;a.descent=0;a.bounds={minx:0,maxx:a.width,miny:0,maxy:0};a.height=0}return a};return t});define("Core/writeTextToCanvas",["../ThirdParty/measureText","./Color","./defaultValue","./defined","./DeveloperError"],function(e,t,r,i,n){"use strict";var a;function o(o,s){if(!i(o)){throw new n("text is required.")}if(o===""){return undefined}s=r(s,r.EMPTY_OBJECT);var u=r(s.font,"10px sans-serif");var l=r(s.stroke,false);var c=r(s.fill,true);var d=r(s.strokeWidth,1);var f=r(s.backgroundColor,t.TRANSPARENT);var h=r(s.padding,0);var p=h*2;var m=document.createElement("canvas");m.width=1;m.height=1;m.style.font=u;var v=m.getContext("2d");if(!i(a)){if(i(v.imageSmoothingEnabled)){a="imageSmoothingEnabled"}else if(i(v.mozImageSmoothingEnabled)){a="mozImageSmoothingEnabled"}else if(i(v.webkitImageSmoothingEnabled)){a="webkitImageSmoothingEnabled"}else if(i(v.msImageSmoothingEnabled)){a="msImageSmoothingEnabled"}}v.font=u;v.lineJoin="round";v.lineWidth=d;v[a]=false;v.textBaseline=r(s.textBaseline,"bottom");m.style.visibility="hidden";document.body.appendChild(m);var _=e(v,o,l,c);m.dimensions=_;document.body.removeChild(m);m.style.visibility="";var g=-_.bounds.minx;var y=Math.ceil(_.width)+g+p;var w=_.height+p;var C=w-_.ascent+p;var b=w-C+p;m.width=y;m.height=w;v.font=u;v.lineJoin="round";v.lineWidth=d;v[a]=false;if(f!==t.TRANSPARENT){v.fillStyle=f.toCssColorString();v.fillRect(0,0,m.width,m.height)}if(l){var S=r(s.strokeColor,t.BLACK);v.strokeStyle=S.toCssColorString();v.strokeText(o,g+h,b)}if(c){var E=r(s.fillColor,t.WHITE);v.fillStyle=E.toCssColorString();v.fillText(o,g+h,b)}return m}return o});define("Core/PinBuilder",["./buildModuleUrl","./Color","./defined","./DeveloperError","./loadImage","./writeTextToCanvas"],function(e,t,r,i,n,a){"use strict";function o(){this._cache={}}o.prototype.fromColor=function(e,t){if(!r(e)){throw new i("color is required")}if(!r(t)){throw new i("size is required")}return d(undefined,undefined,e,t,this._cache)};o.prototype.fromUrl=function(e,t,n){if(!r(e)){throw new i("url is required")}if(!r(t)){throw new i("color is required")}if(!r(n)){throw new i("size is required")}return d(e,undefined,t,n,this._cache)};o.prototype.fromMakiIconId=function(t,n,a){if(!r(t)){throw new i("id is required")}if(!r(n)){throw new i("color is required")}if(!r(a)){throw new i("size is required")}return d(e("Assets/Textures/maki/"+encodeURIComponent(t)+".png"),undefined,n,a,this._cache)};o.prototype.fromText=function(e,t,n){if(!r(e)){throw new i("text is required")}if(!r(t)){throw new i("color is required")}if(!r(n)){throw new i("size is required")}return d(undefined,e,t,n,this._cache)};var s=new t;function u(e,t,r){e.save();e.scale(r/24,r/24);e.fillStyle=t.toCssColorString();e.strokeStyle=t.brighten(.6,s).toCssColorString();e.lineWidth=.846;e.beginPath();e.moveTo(6.72,.422);e.lineTo(17.28,.422);e.bezierCurveTo(18.553,.422,19.577,1.758,19.577,3.415);e.lineTo(19.577,10.973);e.bezierCurveTo(19.577,12.63,18.553,13.966,17.282,13.966);e.lineTo(14.386,14.008);e.lineTo(11.826,23.578);e.lineTo(9.614,14.008);e.lineTo(6.719,13.965);e.bezierCurveTo(5.446,13.983,4.422,12.629,4.422,10.972);e.lineTo(4.422,3.416);e.bezierCurveTo(4.423,1.76,5.447,.423,6.718,.423);e.closePath();e.fill();e.stroke();e.restore()}function l(e,r,i){var n=i/2.5;var a=n;var o=n;if(r.width>r.height){o=n*(r.height/r.width)}else if(r.width<r.height){a=n*(r.width/r.height)}var s=Math.round((i-a)/2);var u=Math.round(7/24*i-o/2);e.globalCompositeOperation="destination-out";e.drawImage(r,s-1,u,a,o);e.drawImage(r,s,u-1,a,o);e.drawImage(r,s+1,u,a,o);e.drawImage(r,s,u+1,a,o);e.globalCompositeOperation="destination-over";e.fillStyle=t.BLACK.toCssColorString();e.fillRect(s-1,u-1,a+2,o+2);e.globalCompositeOperation="destination-out";e.drawImage(r,s,u,a,o);e.globalCompositeOperation="destination-over";e.fillStyle=t.WHITE.toCssColorString();e.fillRect(s-1,u-2,a+2,o+2)}var c=new Array(4);function d(e,t,i,o,s){c[0]=e;c[1]=t;c[2]=i;c[3]=o;var d=JSON.stringify(c);var f=s[d];if(r(f)){return f}var h=document.createElement("canvas");h.width=o;h.height=o;var p=h.getContext("2d");u(p,i,o);if(r(e)){var m=n(e).then(function(e){l(p,e,o);s[d]=h;return h});s[d]=m;return m}else if(r(t)){var v=a(t,{font:"bold "+o+"px sans-serif"});l(p,v,o)}s[d]=h;return h}return o});define("Core/PointGeometry",["./BoundingSphere","./ComponentDatatype","./defaultValue","./defined","./DeveloperError","./Geometry","./GeometryAttribute","./GeometryAttributes","./PrimitiveType"],function(e,t,r,i,n,a,o,s,u){"use strict";function l(t){t=r(t,r.EMPTY_OBJECT);if(!i(t.positionsTypedArray)){throw new n("options.positionsTypedArray is required.")}if(!i(t.colorsTypedArray)){throw new n("options.colorsTypedArray is required")}this._positionsTypedArray=t.positionsTypedArray;this._colorsTypedArray=t.colorsTypedArray;this._boundingSphere=e.clone(t.boundingSphere);this._workerName="createPointGeometry"}l.createGeometry=function(r){var n=r._positionsTypedArray;var l=n.byteLength/n.length;var c=l===4?t.FLOAT:t.DOUBLE;var d=new s;d.position=new o({componentDatatype:c,componentsPerAttribute:3,values:n});d.color=new o({componentDatatype:t.UNSIGNED_BYTE,componentsPerAttribute:3,values:r._colorsTypedArray,normalize:true});var f=r._boundingSphere;if(!i(f)){f=e.fromVertices(n)}return new a({attributes:d,primitiveType:u.POINTS,boundingSphere:f})};return l});define("Core/pointInsideTriangle",["./barycentricCoordinates","./Cartesian3"],function(e,t){"use strict";var r=new t;function i(t,i,n,a){e(t,i,n,a,r);return r.x>0&&r.y>0&&r.z>0}return i});define("Core/PolygonGeometryLibrary",["./arrayRemoveDuplicates","./Cartesian3","./ComponentDatatype","./defaultValue","./defined","./Ellipsoid","./Geometry","./GeometryAttribute","./GeometryAttributes","./GeometryPipeline","./IndexDatatype","./Math","./PolygonPipeline","./PrimitiveType","./Queue","./WindingOrder"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m){"use strict";var v={};v.computeHierarchyPackedLength=function(e){var r=0;var i=[e];while(i.length>0){var a=i.pop();if(!n(a)){continue}r+=2;var o=a.positions;var s=a.holes;if(n(o)){r+=o.length*t.packedLength}if(n(s)){var u=s.length;for(var l=0;l<u;++l){i.push(s[l])}}}return r};v.packPolygonHierarchy=function(e,r,i){var a=[e];while(a.length>0){var o=a.pop();if(!n(o)){continue}var s=o.positions;var u=o.holes;r[i++]=n(s)?s.length:0;r[i++]=n(u)?u.length:0;if(n(s)){var l=s.length;for(var c=0;c<l;++c,i+=3){t.pack(s[c],r,i)}}if(n(u)){var d=u.length;for(var f=0;f<d;++f){a.push(u[f])}}}return i};v.unpackPolygonHierarchy=function(e,r){var i=e[r++];var n=e[r++];var a=new Array(i);var o=n>0?new Array(n):undefined;for(var s=0;s<i;++s,r+=t.packedLength){a[s]=t.unpack(e,r)}for(var u=0;u<n;++u){o[u]=v.unpackPolygonHierarchy(e,r);r=o[u].startingIndex;delete o[u].startingIndex}return{positions:a,holes:o,startingIndex:r}};var _=new t;function g(e,r,i,n){t.subtract(r,e,_);t.multiplyByScalar(_,i/n,_);t.add(e,_,_);return[_.x,_.y,_.z]}v.subdivideLineCount=function(e,r,i){var n=t.distance(e,r);var a=n/i;var o=Math.max(0,Math.ceil(Math.log(a)/Math.log(2)));return Math.pow(2,o)};v.subdivideLine=function(e,r,i,a){var o=v.subdivideLineCount(e,r,i);var s=t.distance(e,r);var u=s/o;if(!n(a)){a=[]}var l=a;l.length=o*3;var c=0;for(var d=0;d<o;d++){var f=g(e,r,d*u,s);l[c++]=f[0];l[c++]=f[1];l[c++]=f[2]}return l};var y=new t;var w=new t;var C=new t;var b=new t;v.scaleToGeodeticHeightExtruded=function(e,r,o,s,u){s=i(s,a.WGS84);var l=y;var c=w;var d=C;var f=b;if(n(e)&&n(e.attributes)&&n(e.attributes.position)){var h=e.attributes.position.values;var p=h.length/2;for(var m=0;m<p;m+=3){t.fromArray(h,m,d);s.geodeticSurfaceNormal(d,l);f=s.scaleToGeodeticSurface(d,f);c=t.multiplyByScalar(l,o,c);c=t.add(f,c,c);h[m+p]=c.x;h[m+1+p]=c.y;h[m+2+p]=c.z;if(u){f=t.clone(d,f)}c=t.multiplyByScalar(l,r,c);c=t.add(f,c,c);h[m]=c.x;h[m+1]=c.y;h[m+2]=c.z}}return e};v.polygonsFromHierarchy=function(r,i,a,o){var s=[];var u=[];var l=new p;l.enqueue(r);while(l.length!==0){var c=l.dequeue();var d=c.positions;var h=c.holes;d=e(d,t.equalsEpsilon,true);if(d.length<3){continue}var v=a.projectPointsOntoPlane(d);var _=[];var g=f.computeWindingOrder2D(v);if(g===m.CLOCKWISE){v.reverse();d=d.slice().reverse()}var y=d.slice();var w=n(h)?h.length:0;var C=[];var b;var S;for(b=0;b<w;b++){var E=h[b];var T=e(E.positions,t.equalsEpsilon,true);if(T.length<3){continue}var x=a.projectPointsOntoPlane(T);g=f.computeWindingOrder2D(x);if(g===m.CLOCKWISE){x.reverse();T=T.slice().reverse()}C.push(T);_.push(y.length);y=y.concat(T);v=v.concat(x);var A=0;if(n(E.holes)){A=E.holes.length}for(S=0;S<A;S++){l.enqueue(E.holes[S])}}if(!i){for(b=0;b<d.length;b++){o.scaleToGeodeticSurface(d[b],d[b])}for(b=0;b<C.length;b++){var P=C[b];for(S=0;S<P.length;++S){o.scaleToGeodeticSurface(P[S],P[S])}}}s.push({outerRing:d,holes:C});u.push({positions:y,positions2D:v,holes:_})}return{hierarchy:s,polygons:u}};v.createGeometryFromPositions=function(e,t,i,n,a){var u=f.triangulate(t.positions2D,t.holes);if(u.length<3){u=[0,1,2]}var c=t.positions;if(n){var d=c.length;var p=new Array(d*3);var m=0;for(var v=0;v<d;v++){var _=c[v];p[m++]=_.x;p[m++]=_.y;p[m++]=_.z}var g=new o({attributes:{position:new s({componentDatatype:r.DOUBLE,componentsPerAttribute:3,values:p})},indices:u,primitiveType:h.TRIANGLES});if(a.normal){return l.computeNormal(g)}return g}return f.computeSubdivision(e,c,u,i)};var S=[];var E=new t;var T=new t;v.computeWallGeometry=function(e,i,n,a){var l;var f;var p;var m;var _;var g=e.length;var y=0;if(!a){var w=d.chordLength(n,i.maximumRadius);var C=0;for(p=0;p<g;p++){C+=v.subdivideLineCount(e[p],e[(p+1)%g],w)}f=(C+g)*3;l=new Array(f*2);for(p=0;p<g;p++){m=e[p];_=e[(p+1)%g];var b=v.subdivideLine(m,_,w,S);var x=b.length;for(var A=0;A<x;++A,++y){l[y]=b[A];l[y+f]=b[A]}l[y]=_.x;l[y+f]=_.x;++y;l[y]=_.y;l[y+f]=_.y;++y;l[y]=_.z;l[y+f]=_.z;++y}}else{f=g*3*2;l=new Array(f*2);for(p=0;p<g;p++){m=e[p];_=e[(p+1)%g];l[y]=l[y+f]=m.x;++y;l[y]=l[y+f]=m.y;++y;l[y]=l[y+f]=m.z;++y;l[y]=l[y+f]=_.x;++y;l[y]=l[y+f]=_.y;++y;l[y]=l[y+f]=_.z;++y}}g=l.length;var P=c.createTypedArray(g/3,g-e.length*6);var D=0;g/=6;for(p=0;p<g;p++){var M=p;var I=M+1;var O=M+g;var R=O+1;m=t.fromArray(l,M*3,E);_=t.fromArray(l,I*3,T);if(t.equalsEpsilon(m,_,d.EPSILON14)){continue}P[D++]=M;P[D++]=O;P[D++]=I;P[D++]=I;P[D++]=O;P[D++]=R}return new o({attributes:new u({position:new s({componentDatatype:r.DOUBLE,componentsPerAttribute:3,values:l})}),indices:P,primitiveType:h.TRIANGLES})};return v});define("Core/PolygonGeometry",["./BoundingRectangle","./BoundingSphere","./Cartesian2","./Cartesian3","./Cartographic","./Check","./ComponentDatatype","./defaultValue","./defined","./defineProperties","./DeveloperError","./Ellipsoid","./EllipsoidTangentPlane","./Geometry","./GeometryAttribute","./GeometryInstance","./GeometryPipeline","./IndexDatatype","./Math","./Matrix3","./PolygonGeometryLibrary","./PolygonPipeline","./Quaternion","./Rectangle","./VertexFormat","./WindingOrder"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w,C,b,S,E,T){"use strict";var x=new r;var A=new i;var P=new b;var D=new y;function M(e,t,r,n){var a=b.fromAxisAngle(e._plane.normal,r,P);var o=y.fromQuaternion(a,D);var s=Number.POSITIVE_INFINITY;var l=Number.NEGATIVE_INFINITY;var c=Number.POSITIVE_INFINITY;var d=Number.NEGATIVE_INFINITY;var f=t.length;for(var h=0;h<f;++h){var p=i.clone(t[h],A);y.multiplyByVector(o,p,p);var m=e.projectPointOntoPlane(p,x);if(u(m)){s=Math.min(s,m.x);l=Math.max(l,m.x);c=Math.min(c,m.y);d=Math.max(d,m.y)}}n.x=s;n.y=c;n.width=l-s;n.height=d-c;return n}var I=new n;var O=new n;function R(e,t,r,i){var n=i.cartesianToCartographic(e,I);var a=n.height;var o=i.cartesianToCartographic(t,O);o.height=a;i.cartographicToCartesian(o,t);var s=i.cartesianToCartographic(r,O);s.height=a-100;i.cartographicToCartesian(s,r)}var N=new e;var L=new i;var B=new i;var F=new i;var k=new i;var V=new i;var z=new i;var U=new i;var q=new i;var G=new i;var H=new r;var W=new r;var j=new i;var Y=new b;var X=new y;function Z(e){var t=e.vertexFormat;var n=e.geometry;var a=e.shadowVolume;if(t.st||t.normal||t.tangent||t.bitangent||a){var s=e.boundingRectangle;var u=e.tangentPlane;var l=e.ellipsoid;var c=e.stRotation;var d=e.wall;var f=e.top||d;var h=e.bottom||d;var m=e.perPositionHeight;var v=H;v.x=s.x;v.y=s.y
;var _=n.attributes.position.values;var w=_.length;var C=t.st?new Float32Array(2*(w/3)):undefined;var S;if(t.normal){if(m&&f&&!d){S=n.attributes.normal.values}else{S=new Float32Array(w)}}var E=t.tangent?new Float32Array(w):undefined;var T=t.bitangent?new Float32Array(w):undefined;var x=a?new Float32Array(w):undefined;var A=0;var P=0;var D=B;var M=F;var I=k;var O=true;var N=b.fromAxisAngle(u._plane.normal,c,Y);var Z=y.fromQuaternion(N,X);var K=0;var Q=0;if(f&&h){K=w/2;Q=w/3;w/=2}for(var J=0;J<w;J+=3){var $=i.fromArray(_,J,j);if(t.st){var ee=y.multiplyByVector(Z,$,L);ee=l.scaleToGeodeticSurface(ee,ee);var te=u.projectPointOntoPlane(ee,W);r.subtract(te,v,te);var re=g.clamp(te.x/s.width,0,1);var ie=g.clamp(te.y/s.height,0,1);if(h){C[A+Q]=re;C[A+1+Q]=ie}if(f){C[A]=re;C[A+1]=ie}A+=2}if(t.normal||t.tangent||t.bitangent||a){var ne=P+1;var ae=P+2;if(d){if(J+3<w){var oe=i.fromArray(_,J+3,V);if(O){var se=i.fromArray(_,J+w,z);if(m){R($,oe,se,l)}i.subtract(oe,$,oe);i.subtract(se,$,se);D=i.normalize(i.cross(se,oe,D),D);O=false}if(i.equalsEpsilon(oe,$,g.EPSILON10)){O=true}}if(t.tangent||t.bitangent){I=l.geodeticSurfaceNormal($,I);if(t.tangent){M=i.normalize(i.cross(I,D,M),M)}}}else{D=l.geodeticSurfaceNormal($,D);if(t.tangent||t.bitangent){if(m){U=i.fromArray(S,P,U);q=i.cross(i.UNIT_Z,U,q);q=i.normalize(y.multiplyByVector(Z,q,q),q);if(t.bitangent){G=i.normalize(i.cross(U,q,G),G)}}M=i.cross(i.UNIT_Z,D,M);M=i.normalize(y.multiplyByVector(Z,M,M),M);if(t.bitangent){I=i.normalize(i.cross(D,M,I),I)}}}if(t.normal){if(e.wall){S[P+K]=D.x;S[ne+K]=D.y;S[ae+K]=D.z}else if(h){S[P+K]=-D.x;S[ne+K]=-D.y;S[ae+K]=-D.z}if(f&&!m||d){S[P]=D.x;S[ne]=D.y;S[ae]=D.z}}if(a){if(d){D=l.geodeticSurfaceNormal($,D)}x[P+K]=-D.x;x[ne+K]=-D.y;x[ae+K]=-D.z}if(t.tangent){if(e.wall){E[P+K]=M.x;E[ne+K]=M.y;E[ae+K]=M.z}else if(h){E[P+K]=-M.x;E[ne+K]=-M.y;E[ae+K]=-M.z}if(f){if(m){E[P]=q.x;E[ne]=q.y;E[ae]=q.z}else{E[P]=M.x;E[ne]=M.y;E[ae]=M.z}}}if(t.bitangent){if(h){T[P+K]=I.x;T[ne+K]=I.y;T[ae+K]=I.z}if(f){if(m){T[P]=G.x;T[ne]=G.y;T[ae]=G.z}else{T[P]=I.x;T[ne]=I.y;T[ae]=I.z}}}P+=3}}if(t.st){n.attributes.st=new p({componentDatatype:o.FLOAT,componentsPerAttribute:2,values:C})}if(t.normal){n.attributes.normal=new p({componentDatatype:o.FLOAT,componentsPerAttribute:3,values:S})}if(t.tangent){n.attributes.tangent=new p({componentDatatype:o.FLOAT,componentsPerAttribute:3,values:E})}if(t.bitangent){n.attributes.bitangent=new p({componentDatatype:o.FLOAT,componentsPerAttribute:3,values:T})}if(a){n.attributes.extrudeDirection=new p({componentDatatype:o.FLOAT,componentsPerAttribute:3,values:x})}}return n}var K=[];function Q(e,t,r,i,n,a,o,s){var u={walls:[]};var l;if(a||o){var c=w.createGeometryFromPositions(e,t,r,n,s);var d=c.attributes.position.values;var h=c.indices;var p;var v;if(a&&o){var g=d.concat(d);p=g.length/3;v=_.createTypedArray(p,h.length*2);v.set(h);var y=h.length;var b=p/2;for(l=0;l<y;l+=3){var S=v[l]+b;var E=v[l+1]+b;var x=v[l+2]+b;v[l+y]=x;v[l+1+y]=E;v[l+2+y]=S}c.attributes.position.values=g;if(n){var A=c.attributes.normal.values;c.attributes.normal.values=new Float32Array(g.length);c.attributes.normal.values.set(A)}c.indices=v}else if(o){p=d.length/3;v=_.createTypedArray(p,h.length);for(l=0;l<h.length;l+=3){v[l]=h[l+2];v[l+1]=h[l+1];v[l+2]=h[l]}c.indices=v}u.topAndBottom=new m({geometry:c})}var P=i.outerRing;var D=f.fromPoints(P,e);var M=D.projectPointsOntoPlane(P,K);var I=C.computeWindingOrder2D(M);if(I===T.CLOCKWISE){P=P.slice().reverse()}var O=w.computeWallGeometry(P,e,r,n);u.walls.push(new m({geometry:O}));var R=i.holes;for(l=0;l<R.length;l++){var N=R[l];D=f.fromPoints(N,e);M=D.projectPointsOntoPlane(N,K);I=C.computeWindingOrder2D(M);if(I===T.COUNTER_CLOCKWISE){N=N.slice().reverse()}O=w.computeWallGeometry(N,e,r);u.walls.push(new m({geometry:O}))}return u}function J(e){a.typeOf.object("options",e);a.typeOf.object("options.polygonHierarchy",e.polygonHierarchy);if(u(e.perPositionHeight)&&e.perPositionHeight&&u(e.height)){throw new c("Cannot use both options.perPositionHeight and options.height")}var t=e.polygonHierarchy;var r=s(e.vertexFormat,E.DEFAULT);var i=s(e.ellipsoid,d.WGS84);var n=s(e.granularity,g.RADIANS_PER_DEGREE);var o=s(e.stRotation,0);var l=s(e.height,0);var f=s(e.perPositionHeight,false);var h=e.extrudedHeight;var p=u(h);if(!f&&p){if(g.equalsEpsilon(l,h,g.EPSILON10)){h=undefined;p=false}else{var m=h;h=Math.min(m,l);l=Math.max(m,l)}}this._vertexFormat=E.clone(r);this._ellipsoid=d.clone(i);this._granularity=n;this._stRotation=o;this._height=l;this._extrudedHeight=s(h,0);this._extrude=p;this._closeTop=s(e.closeTop,true);this._closeBottom=s(e.closeBottom,true);this._polygonHierarchy=t;this._perPositionHeight=f;this._shadowVolume=s(e.shadowVolume,false);this._workerName="createPolygonGeometry";var v=t.positions;if(!u(v)||v.length<3){this._rectangle=new S}else{this._rectangle=S.fromCartesianArray(v,i)}this.packedLength=w.computeHierarchyPackedLength(t)+d.packedLength+E.packedLength+S.packedLength+10}J.fromPositions=function(e){e=s(e,s.EMPTY_OBJECT);a.defined("options.positions",e.positions);var t={polygonHierarchy:{positions:e.positions},height:e.height,extrudedHeight:e.extrudedHeight,vertexFormat:e.vertexFormat,stRotation:e.stRotation,ellipsoid:e.ellipsoid,granularity:e.granularity,perPositionHeight:e.perPositionHeight,closeTop:e.closeTop,closeBottom:e.closeBottom};return new J(t)};J.pack=function(e,t,r){a.typeOf.object("value",e);a.defined("array",t);r=s(r,0);r=w.packPolygonHierarchy(e._polygonHierarchy,t,r);d.pack(e._ellipsoid,t,r);r+=d.packedLength;E.pack(e._vertexFormat,t,r);r+=E.packedLength;S.pack(e._rectangle,t,r);r+=S.packedLength;t[r++]=e._height;t[r++]=e._extrudedHeight;t[r++]=e._granularity;t[r++]=e._stRotation;t[r++]=e._extrude?1:0;t[r++]=e._perPositionHeight?1:0;t[r++]=e._closeTop?1:0;t[r++]=e._closeBottom?1:0;t[r++]=e._shadowVolume?1:0;t[r]=e.packedLength;return t};var $=d.clone(d.UNIT_SPHERE);var ee=new E;var te=new S;var re={polygonHierarchy:{}};J.unpack=function(e,t,r){a.defined("array",e);t=s(t,0);var i=w.unpackPolygonHierarchy(e,t);t=i.startingIndex;delete i.startingIndex;var n=d.unpack(e,t,$);t+=d.packedLength;var o=E.unpack(e,t,ee);t+=E.packedLength;var l=S.unpack(e,t,te);t+=S.packedLength;var c=e[t++];var f=e[t++];var h=e[t++];var p=e[t++];var m=e[t++]===1;var v=e[t++]===1;var _=e[t++]===1;var g=e[t++]===1;var y=e[t++]===1;var C=e[t];if(!u(r)){r=new J(re)}r._polygonHierarchy=i;r._ellipsoid=d.clone(n,r._ellipsoid);r._vertexFormat=E.clone(o,r._vertexFormat);r._height=c;r._extrudedHeight=f;r._granularity=h;r._stRotation=p;r._extrude=m;r._perPositionHeight=v;r._closeTop=_;r._closeBottom=g;r._rectangle=S.clone(l);r._shadowVolume=y;r.packedLength=C;return r};J.createGeometry=function(e){var r=e._vertexFormat;var i=e._ellipsoid;var n=e._granularity;var a=e._stRotation;var o=e._height;var s=e._extrudedHeight;var u=e._extrude;var l=e._polygonHierarchy;var c=e._perPositionHeight;var d=e._closeTop;var p=e._closeBottom;var g=l.positions;if(g.length<3){return}var y=f.fromPoints(g,i);var b=w.polygonsFromHierarchy(l,c,y,i);var S=b.hierarchy;var E=b.polygons;if(S.length===0){return}g=S[0].outerRing;var T=M(y,g,a,N);var x;var A=[];var P={perPositionHeight:c,vertexFormat:r,geometry:undefined,tangentPlane:y,boundingRectangle:T,ellipsoid:i,stRotation:a,bottom:false,top:true,wall:false};var D;if(u){P.top=d;P.bottom=p;P.shadowVolume=e._shadowVolume;for(D=0;D<E.length;D++){x=Q(i,E[D],n,S[D],c,d,p,r);var I;if(d&&p){I=x.topAndBottom;P.geometry=w.scaleToGeodeticHeightExtruded(I.geometry,o,s,i,c)}else if(d){I=x.topAndBottom;I.geometry.attributes.position.values=C.scaleToGeodeticHeight(I.geometry.attributes.position.values,o,i,!c);P.geometry=I.geometry}else if(p){I=x.topAndBottom;I.geometry.attributes.position.values=C.scaleToGeodeticHeight(I.geometry.attributes.position.values,s,i,true);P.geometry=I.geometry}if(d||p){P.wall=false;I.geometry=Z(P);A.push(I)}var O=x.walls;P.wall=true;for(var R=0;R<O.length;R++){var L=O[R];P.geometry=w.scaleToGeodeticHeightExtruded(L.geometry,o,s,i,c);L.geometry=Z(P);A.push(L)}}}else{for(D=0;D<E.length;D++){x=new m({geometry:w.createGeometryFromPositions(i,E[D],n,c,r)});x.geometry.attributes.position.values=C.scaleToGeodeticHeight(x.geometry.attributes.position.values,o,i,!c);P.geometry=x.geometry;x.geometry=Z(P);A.push(x)}}x=v.combineInstances(A)[0];x.attributes.position.values=new Float64Array(x.attributes.position.values);x.indices=_.createTypedArray(x.attributes.position.values.length/3,x.indices);var B=x.attributes;var F=t.fromVertices(B.position.values);if(!r.position){delete B.position}return new h({attributes:B,indices:x.indices,primitiveType:x.primitiveType,boundingSphere:F})};J.createShadowVolume=function(e,t,r){var i=e._granularity;var n=e._ellipsoid;var a=t(i,n);var o=r(i,n);return new J({polygonHierarchy:e._polygonHierarchy,ellipsoid:n,stRotation:e._stRotation,granularity:i,perPositionHeight:false,extrudedHeight:a,height:o,vertexFormat:E.POSITION_ONLY,shadowVolume:true})};l(J.prototype,{rectangle:{get:function(){return this._rectangle}}});return J});define("Core/PolygonHierarchy",["./defined"],function(e){"use strict";function t(t,r){this.positions=e(t)?t:[];this.holes=e(r)?r:[]}return t});define("Core/PolygonOutlineGeometry",["./arrayRemoveDuplicates","./BoundingSphere","./Cartesian3","./Check","./ComponentDatatype","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./EllipsoidTangentPlane","./Geometry","./GeometryAttribute","./GeometryAttributes","./GeometryInstance","./GeometryPipeline","./IndexDatatype","./Math","./PolygonGeometryLibrary","./PolygonPipeline","./PrimitiveType","./Queue","./WindingOrder"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w,C){"use strict";var b=[];var S=[];function E(e,t,r,i){var a=l.fromPoints(t,e);var o=a.projectPointsOntoPlane(t,b);var s=g.computeWindingOrder2D(o);if(s===C.CLOCKWISE){o.reverse();t=t.slice().reverse()}var u;var p;var v=t.length;var w=0;if(!i){var E=0;for(p=0;p<v;p++){E+=_.subdivideLineCount(t[p],t[(p+1)%v],r)}u=new Float64Array(E*3);for(p=0;p<v;p++){var T=_.subdivideLine(t[p],t[(p+1)%v],r,S);var x=T.length;for(var A=0;A<x;++A){u[w++]=T[A]}}}else{u=new Float64Array(v*2*3);for(p=0;p<v;p++){var P=t[p];var D=t[(p+1)%v];u[w++]=P.x;u[w++]=P.y;u[w++]=P.z;u[w++]=D.x;u[w++]=D.y;u[w++]=D.z}}v=u.length/3;var M=v*2;var I=m.createTypedArray(v,M);w=0;for(p=0;p<v-1;p++){I[w++]=p;I[w++]=p+1}I[w++]=v-1;I[w++]=0;return new h({geometry:new c({attributes:new f({position:new d({componentDatatype:n.DOUBLE,componentsPerAttribute:3,values:u})}),indices:I,primitiveType:y.LINES})})}function T(e,t,r,i){var a=l.fromPoints(t,e);var o=a.projectPointsOntoPlane(t,b);var s=g.computeWindingOrder2D(o);if(s===C.CLOCKWISE){o.reverse();t=t.slice().reverse()}var u;var p;var v=t.length;var w=new Array(v);var E=0;if(!i){var T=0;for(p=0;p<v;p++){T+=_.subdivideLineCount(t[p],t[(p+1)%v],r)}u=new Float64Array(T*3*2);for(p=0;p<v;++p){w[p]=E/3;var x=_.subdivideLine(t[p],t[(p+1)%v],r,S);var A=x.length;for(var P=0;P<A;++P){u[E++]=x[P]}}}else{u=new Float64Array(v*2*3*2);for(p=0;p<v;++p){w[p]=E/3;var D=t[p];var M=t[(p+1)%v];u[E++]=D.x;u[E++]=D.y;u[E++]=D.z;u[E++]=M.x;u[E++]=M.y;u[E++]=M.z}}v=u.length/(3*2);var I=w.length;var O=(v*2+I)*2;var R=m.createTypedArray(v,O);E=0;for(p=0;p<v;++p){R[E++]=p;R[E++]=(p+1)%v;R[E++]=p+v;R[E++]=(p+1)%v+v}for(p=0;p<I;p++){var N=w[p];R[E++]=N;R[E++]=N+v}return new h({geometry:new c({attributes:new f({position:new d({componentDatatype:n.DOUBLE,componentsPerAttribute:3,values:u})}),indices:R,primitiveType:y.LINES})})}function x(e){i.typeOf.object("options",e);i.typeOf.object("options.polygonHierarchy",e.polygonHierarchy);if(o(e.perPositionHeight)&&e.perPositionHeight&&o(e.height)){throw new s("Cannot use both options.perPositionHeight and options.height")}var t=e.polygonHierarchy;var r=a(e.ellipsoid,u.WGS84);var n=a(e.granularity,v.RADIANS_PER_DEGREE);var l=a(e.height,0);var c=a(e.perPositionHeight,false);var d=e.extrudedHeight;var f=o(d);if(f&&!c){var h=d;d=Math.min(h,l);l=Math.max(h,l)}this._ellipsoid=u.clone(r);this._granularity=n;this._height=l;this._extrudedHeight=a(d,0);this._extrude=f;this._polygonHierarchy=t;this._perPositionHeight=c;this._workerName="createPolygonOutlineGeometry";this.packedLength=_.computeHierarchyPackedLength(t)+u.packedLength+6}x.pack=function(e,t,r){i.typeOf.object("value",e);i.defined("array",t);r=a(r,0);r=_.packPolygonHierarchy(e._polygonHierarchy,t,r);u.pack(e._ellipsoid,t,r);r+=u.packedLength;t[r++]=e._height;t[r++]=e._extrudedHeight;t[r++]=e._granularity;t[r++]=e._extrude?1:0;t[r++]=e._perPositionHeight?1:0;t[r++]=e.packedLength;return t};var A=u.clone(u.UNIT_SPHERE);var P={polygonHierarchy:{}};x.unpack=function(e,t,r){i.defined("array",e);t=a(t,0);var n=_.unpackPolygonHierarchy(e,t);t=n.startingIndex;delete n.startingIndex;var s=u.unpack(e,t,A);t+=u.packedLength;var l=e[t++];var c=e[t++];var d=e[t++];var f=e[t++]===1;var h=e[t++]===1;var p=e[t++];if(!o(r)){r=new x(P)}r._polygonHierarchy=n;r._ellipsoid=u.clone(s,r._ellipsoid);r._height=l;r._extrudedHeight=c;r._granularity=d;r._extrude=f;r._perPositionHeight=h;r.packedLength=p;return r};x.fromPositions=function(e){e=a(e,a.EMPTY_OBJECT);i.defined("options.positions",e.positions);var t={polygonHierarchy:{positions:e.positions},height:e.height,extrudedHeight:e.extrudedHeight,ellipsoid:e.ellipsoid,granularity:e.granularity,perPositionHeight:e.perPositionHeight};return new x(t)};x.createGeometry=function(i){var n=i._ellipsoid;var a=i._granularity;var s=i._height;var u=i._extrudedHeight;var l=i._extrude;var d=i._polygonHierarchy;var f=i._perPositionHeight;var h=[];var m=new w;m.enqueue(d);var y;while(m.length!==0){var C=m.dequeue();var b=C.positions;b=e(b,r.equalsEpsilon,true);if(b.length<3){continue}var S=C.holes?C.holes.length:0;for(y=0;y<S;y++){var x=C.holes[y];x.positions=e(x.positions,r.equalsEpsilon,true);if(x.positions.length<3){continue}h.push(x.positions);var A=0;if(o(x.holes)){A=x.holes.length}for(var P=0;P<A;P++){m.enqueue(x.holes[P])}}h.push(b)}if(h.length===0){return undefined}var D;var M=[];var I=v.chordLength(a,n.maximumRadius);if(l){for(y=0;y<h.length;y++){D=T(n,h[y],I,f);D.geometry=_.scaleToGeodeticHeightExtruded(D.geometry,s,u,n,f);M.push(D)}}else{for(y=0;y<h.length;y++){D=E(n,h[y],I,f);D.geometry.attributes.position.values=g.scaleToGeodeticHeight(D.geometry.attributes.position.values,s,n,!f);M.push(D)}}D=p.combineInstances(M)[0];var O=t.fromVertices(D.attributes.position.values);return new c({attributes:D.attributes,indices:D.indices,primitiveType:D.primitiveType,boundingSphere:O})};return x});define("Core/PolylineGeometry",["./arrayRemoveDuplicates","./BoundingSphere","./Cartesian3","./Color","./ComponentDatatype","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./Geometry","./GeometryAttribute","./GeometryAttributes","./GeometryType","./IndexDatatype","./Math","./PolylinePipeline","./PrimitiveType","./VertexFormat"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_){"use strict";var g=[];function y(e,t,r,n,a){var o=g;o.length=a;var s;var u=r.red;var l=r.green;var c=r.blue;var d=r.alpha;var f=n.red;var h=n.green;var p=n.blue;var m=n.alpha;if(i.equals(r,n)){for(s=0;s<a;s++){o[s]=i.clone(r)}return o}var v=(f-u)/a;var _=(h-l)/a;var y=(p-c)/a;var w=(m-d)/a;for(s=0;s<a;s++){o[s]=new i(u+s*v,l+s*_,c+s*y,d+s*w)}return o}function w(e){e=a(e,a.EMPTY_OBJECT);var t=e.positions;var n=e.colors;var l=a(e.width,1);var c=a(e.colorsPerVertex,false);if(!o(t)||t.length<2){throw new s("At least two positions are required.")}if(typeof l!=="number"){throw new s("width must be a number")}if(o(n)&&(c&&n.length<t.length||!c&&n.length<t.length-1)){throw new s("colors has an invalid length.")}this._positions=t;this._colors=n;this._width=l;this._colorsPerVertex=c;this._vertexFormat=_.clone(a(e.vertexFormat,_.DEFAULT));this._followSurface=a(e.followSurface,true);this._granularity=a(e.granularity,p.RADIANS_PER_DEGREE);this._ellipsoid=u.clone(a(e.ellipsoid,u.WGS84));this._workerName="createPolylineGeometry";var d=1+t.length*r.packedLength;d+=o(n)?1+n.length*i.packedLength:1;this.packedLength=d+u.packedLength+_.packedLength+4}w.pack=function(e,t,n){if(!o(e)){throw new s("value is required")}if(!o(t)){throw new s("array is required")}n=a(n,0);var l;var c=e._positions;var d=c.length;t[n++]=d;for(l=0;l<d;++l,n+=r.packedLength){r.pack(c[l],t,n)}var f=e._colors;d=o(f)?f.length:0;t[n++]=d;for(l=0;l<d;++l,n+=i.packedLength){i.pack(f[l],t,n)}u.pack(e._ellipsoid,t,n);n+=u.packedLength;_.pack(e._vertexFormat,t,n);n+=_.packedLength;t[n++]=e._width;t[n++]=e._colorsPerVertex?1:0;t[n++]=e._followSurface?1:0;t[n]=e._granularity;return t};var C=u.clone(u.UNIT_SPHERE);var b=new _;var S={positions:undefined,colors:undefined,ellipsoid:C,vertexFormat:b,width:undefined,colorsPerVertex:undefined,followSurface:undefined,granularity:undefined};w.unpack=function(e,t,n){if(!o(e)){throw new s("array is required")}t=a(t,0);var l;var c=e[t++];var d=new Array(c);for(l=0;l<c;++l,t+=r.packedLength){d[l]=r.unpack(e,t)}c=e[t++];var f=c>0?new Array(c):undefined;for(l=0;l<c;++l,t+=i.packedLength){f[l]=i.unpack(e,t)}var h=u.unpack(e,t,C);t+=u.packedLength;var p=_.unpack(e,t,b);t+=_.packedLength;var m=e[t++];var v=e[t++]===1;var g=e[t++]===1;var y=e[t];if(!o(n)){S.positions=d;S.colors=f;S.width=m;S.colorsPerVertex=v;S.followSurface=g;S.granularity=y;return new w(S)}n._positions=d;n._colors=f;n._ellipsoid=u.clone(h,n._ellipsoid);n._vertexFormat=_.clone(p,n._vertexFormat);n._width=m;n._colorsPerVertex=v;n._followSurface=g;n._granularity=y;return n};var E=new r;var T=new r;var x=new r;var A=new r;w.createGeometry=function(a){var s=a._width;var u=a._vertexFormat;var _=a._colors;var w=a._colorsPerVertex;var C=a._followSurface;var b=a._granularity;var S=a._ellipsoid;var P;var D;var M;var I=e(a._positions,r.equalsEpsilon);var O=I.length;if(O<2||s<=0){return undefined}if(C){var R=m.extractHeights(I,S);var N=p.chordLength(b,S.maximumRadius);if(o(_)){var L=1;for(P=0;P<O-1;++P){L+=m.numberOfPoints(I[P],I[P+1],N)}var B=new Array(L);var F=0;for(P=0;P<O-1;++P){var k=I[P];var V=I[P+1];var z=_[P];var U=m.numberOfPoints(k,V,N);if(w&&P<L){var q=_[P+1];var G=y(k,V,z,q,U);var H=G.length;for(D=0;D<H;++D){B[F++]=G[D]}}else{for(D=0;D<U;++D){B[F++]=i.clone(z)}}}B[F]=i.clone(_[_.length-1]);_=B;g.length=0}I=m.generateCartesianArc({positions:I,minDistance:N,ellipsoid:S,height:R})}O=I.length;var W=O*4-4;var j=new Float64Array(W*3);var Y=new Float64Array(W*3);var X=new Float64Array(W*3);var Z=new Float32Array(W*2);var K=u.st?new Float32Array(W*2):undefined;var Q=o(_)?new Uint8Array(W*4):undefined;var J=0;var $=0;var ee=0;var te=0;var re;for(D=0;D<O;++D){if(D===0){re=E;r.subtract(I[0],I[1],re);r.add(I[0],re,re)}else{re=I[D-1]}r.clone(re,x);r.clone(I[D],T);if(D===O-1){re=E;r.subtract(I[O-1],I[O-2],re);r.add(I[O-1],re,re)}else{re=I[D+1]}r.clone(re,A);var ie,ne;if(o(Q)){if(D!==0&&!w){ie=_[D-1]}else{ie=_[D]}if(D!==O-1){ne=_[D]}}var ae=D===0?2:0;var oe=D===O-1?2:4;for(M=ae;M<oe;++M){r.pack(T,j,J);r.pack(x,Y,J);r.pack(A,X,J);J+=3;var se=M-2<0?-1:1;Z[$++]=2*(M%2)-1;Z[$++]=se*s;if(u.st){K[ee++]=D/(O-1);K[ee++]=Math.max(Z[$-2],0)}if(o(Q)){var ue=M<2?ie:ne;Q[te++]=i.floatToByte(ue.red);Q[te++]=i.floatToByte(ue.green);Q[te++]=i.floatToByte(ue.blue);Q[te++]=i.floatToByte(ue.alpha)}}}var le=new d;le.position=new c({componentDatatype:n.DOUBLE,componentsPerAttribute:3,values:j});le.prevPosition=new c({componentDatatype:n.DOUBLE,componentsPerAttribute:3,values:Y});le.nextPosition=new c({componentDatatype:n.DOUBLE,componentsPerAttribute:3,values:X});le.expandAndWidth=new c({componentDatatype:n.FLOAT,componentsPerAttribute:2,values:Z});if(u.st){le.st=new c({componentDatatype:n.FLOAT,componentsPerAttribute:2,values:K})}if(o(Q)){le.color=new c({componentDatatype:n.UNSIGNED_BYTE,componentsPerAttribute:4,values:Q,normalize:true})}var ce=h.createTypedArray(W,O*6-6);var de=0;var fe=0;var he=O-1;for(D=0;D<he;++D){ce[fe++]=de;ce[fe++]=de+2;ce[fe++]=de+1;ce[fe++]=de+1;ce[fe++]=de+2;ce[fe++]=de+3;de+=4}return new l({attributes:le,indices:ce,primitiveType:v.TRIANGLES,boundingSphere:t.fromPoints(I),geometryType:f.POLYLINES})};return w});define("Core/PolylineVolumeGeometry",["./arrayRemoveDuplicates","./BoundingRectangle","./BoundingSphere","./Cartesian2","./Cartesian3","./ComponentDatatype","./CornerType","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./Geometry","./GeometryAttribute","./GeometryAttributes","./GeometryPipeline","./IndexDatatype","./Math","./oneTimeWarning","./PolygonPipeline","./PolylineVolumeGeometryLibrary","./PrimitiveType","./VertexFormat","./WindingOrder"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w,C,b){"use strict";function S(e,t,i,n){var o=new h;if(n.position){o.position=new f({componentDatatype:a.DOUBLE,componentsPerAttribute:3,values:e})}var s=t.length;var u=e.length/3;var l=(u-s*2)/(s*2);var c=g.triangulate(t);var v=(l-1)*s*6+c.length*2;var y=m.createTypedArray(u,v);var C,b;var S,E,T,x;var A=s*2;var P=0;for(C=0;C<l-1;C++){for(b=0;b<s-1;b++){S=b*2+C*s*2;x=S+A;E=S+1;T=E+A;y[P++]=E;y[P++]=S;y[P++]=T;y[P++]=T;y[P++]=S;y[P++]=x}S=s*2-2+C*s*2;E=S+1;T=E+A;x=S+A;y[P++]=E;y[P++]=S;y[P++]=T;y[P++]=T;y[P++]=S;y[P++]=x}if(n.st||n.tangent||n.bitangent){var D=new Float32Array(u*2);var M=1/(l-1);var I=1/i.height;var O=i.height/2;var R,N;var L=0;for(C=0;C<l;C++){R=C*M;N=I*(t[0].y+O);D[L++]=R;D[L++]=N;for(b=1;b<s;b++){N=I*(t[b].y+O);D[L++]=R;D[L++]=N;D[L++]=R;D[L++]=N}N=I*(t[0].y+O);D[L++]=R;D[L++]=N}for(b=0;b<s;b++){R=0;N=I*(t[b].y+O);D[L++]=R;D[L++]=N}for(b=0;b<s;b++){R=(l-1)*M;N=I*(t[b].y+O);D[L++]=R;D[L++]=N}o.st=new f({componentDatatype:a.FLOAT,componentsPerAttribute:2,values:new Float32Array(D)})}var B=u-s*2;for(C=0;C<c.length;C+=3){var F=c[C]+B;var k=c[C+1]+B;var V=c[C+2]+B;y[P++]=F;y[P++]=k;y[P++]=V;y[P++]=V+s;y[P++]=k+s;y[P++]=F+s}var z=new d({attributes:o,indices:y,boundingSphere:r.fromVertices(e),primitiveType:w.TRIANGLES});if(n.normal){z=p.computeNormal(z)}if(n.tangent||n.bitangent){try{z=p.computeTangentAndBitangent(z)}catch(e){_("polyline-volume-tangent-bitangent","Unable to compute tangents and bitangents for polyline volume geometry")}if(!n.tangent){z.attributes.tangent=undefined}if(!n.bitangent){z.attributes.bitangent=undefined}if(!n.st){z.attributes.st=undefined}}return z}function E(e){e=s(e,s.EMPTY_OBJECT);var t=e.polylinePositions;var r=e.shapePositions;if(!u(t)){throw new l("options.polylinePositions is required.")}if(!u(r)){throw new l("options.shapePositions is required.")}this._positions=t;this._shape=r;this._ellipsoid=c.clone(s(e.ellipsoid,c.WGS84));this._cornerType=s(e.cornerType,o.ROUNDED);this._vertexFormat=C.clone(s(e.vertexFormat,C.DEFAULT));this._granularity=s(e.granularity,v.RADIANS_PER_DEGREE);this._workerName="createPolylineVolumeGeometry";var a=1+t.length*n.packedLength;a+=1+r.length*i.packedLength;this.packedLength=a+c.packedLength+C.packedLength+2}E.pack=function(e,t,r){if(!u(e)){throw new l("value is required")}if(!u(t)){throw new l("array is required")}r=s(r,0);var a;var o=e._positions;var d=o.length;t[r++]=d;for(a=0;a<d;++a,r+=n.packedLength){n.pack(o[a],t,r)}var f=e._shape;d=f.length;t[r++]=d;for(a=0;a<d;++a,r+=i.packedLength){i.pack(f[a],t,r)}c.pack(e._ellipsoid,t,r);r+=c.packedLength;C.pack(e._vertexFormat,t,r);r+=C.packedLength;t[r++]=e._cornerType;t[r]=e._granularity;return t};var T=c.clone(c.UNIT_SPHERE);var x=new C;var A={polylinePositions:undefined,shapePositions:undefined,ellipsoid:T,vertexFormat:x,cornerType:undefined,granularity:undefined};E.unpack=function(e,t,r){if(!u(e)){throw new l("array is required")}t=s(t,0);var a;var o=e[t++];var d=new Array(o);for(a=0;a<o;++a,t+=n.packedLength){d[a]=n.unpack(e,t)}o=e[t++];var f=new Array(o);for(a=0;a<o;++a,t+=i.packedLength){f[a]=i.unpack(e,t)}var h=c.unpack(e,t,T);t+=c.packedLength;var p=C.unpack(e,t,x);t+=C.packedLength;var m=e[t++];var v=e[t];if(!u(r)){A.polylinePositions=d;A.shapePositions=f;A.cornerType=m;A.granularity=v;return new E(A)}r._positions=d;r._shape=f;r._ellipsoid=c.clone(h,r._ellipsoid);r._vertexFormat=C.clone(p,r._vertexFormat);r._cornerType=m;r._granularity=v;return r};var P=new t;E.createGeometry=function(r){var i=r._positions;var a=e(i,n.equalsEpsilon);var o=r._shape;o=y.removeDuplicatesFromShape(o);if(a.length<2||o.length<3){return undefined}if(g.computeWindingOrder2D(o)===b.CLOCKWISE){o.reverse()}var s=t.fromPoints(o,P);var u=y.computePositions(a,o,s,r,true);return S(u,o,s,r._vertexFormat)};return E});define("Core/PolylineVolumeOutlineGeometry",["./arrayRemoveDuplicates","./BoundingRectangle","./BoundingSphere","./Cartesian2","./Cartesian3","./ComponentDatatype","./CornerType","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./Geometry","./GeometryAttribute","./GeometryAttributes","./IndexDatatype","./Math","./PolygonPipeline","./PolylineVolumeGeometryLibrary","./PrimitiveType","./WindingOrder"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y){"use strict";function w(e,t){var i=new h;i.position=new f({componentDatatype:a.DOUBLE,componentsPerAttribute:3,values:e});var n=t.length;var o=i.position.values.length/3;var s=e.length/3;var u=s/n;var l=p.createTypedArray(o,2*n*(u+1));var c,m;var v=0;c=0;var _=c*n;for(m=0;m<n-1;m++){l[v++]=m+_;l[v++]=m+_+1}l[v++]=n-1+_;l[v++]=_;c=u-1;_=c*n;for(m=0;m<n-1;m++){l[v++]=m+_;l[v++]=m+_+1}l[v++]=n-1+_;l[v++]=_;for(c=0;c<u-1;c++){var y=n*c;var w=y+n;for(m=0;m<n;m++){l[v++]=m+y;l[v++]=m+w}}var C=new d({attributes:i,indices:p.createTypedArray(o,l),boundingSphere:r.fromVertices(e),primitiveType:g.LINES});return C}function C(e){e=s(e,s.EMPTY_OBJECT);var t=e.polylinePositions;var r=e.shapePositions;if(!u(t)){throw new l("options.polylinePositions is required.")}if(!u(r)){throw new l("options.shapePositions is required.")}this._positions=t;this._shape=r;this._ellipsoid=c.clone(s(e.ellipsoid,c.WGS84));this._cornerType=s(e.cornerType,o.ROUNDED);this._granularity=s(e.granularity,m.RADIANS_PER_DEGREE);this._workerName="createPolylineVolumeOutlineGeometry";var a=1+t.length*n.packedLength;a+=1+r.length*i.packedLength;this.packedLength=a+c.packedLength+2}C.pack=function(e,t,r){if(!u(e)){throw new l("value is required")}if(!u(t)){throw new l("array is required")}r=s(r,0);var a;var o=e._positions;var d=o.length;t[r++]=d;for(a=0;a<d;++a,r+=n.packedLength){n.pack(o[a],t,r)}var f=e._shape;d=f.length;t[r++]=d;for(a=0;a<d;++a,r+=i.packedLength){i.pack(f[a],t,r)}c.pack(e._ellipsoid,t,r);r+=c.packedLength;t[r++]=e._cornerType;t[r]=e._granularity;return t};var b=c.clone(c.UNIT_SPHERE);var S={polylinePositions:undefined,shapePositions:undefined,ellipsoid:b,height:undefined,cornerType:undefined,granularity:undefined};C.unpack=function(e,t,r){if(!u(e)){throw new l("array is required")}t=s(t,0);var a;var o=e[t++];var d=new Array(o);for(a=0;a<o;++a,t+=n.packedLength){d[a]=n.unpack(e,t)}o=e[t++];var f=new Array(o);for(a=0;a<o;++a,t+=i.packedLength){f[a]=i.unpack(e,t)}var h=c.unpack(e,t,b);t+=c.packedLength;var p=e[t++];var m=e[t];if(!u(r)){S.polylinePositions=d;S.shapePositions=f;S.cornerType=p;S.granularity=m;return new C(S)}r._positions=d;r._shape=f;r._ellipsoid=c.clone(h,r._ellipsoid);r._cornerType=p;r._granularity=m;return r};var E=new t;C.createGeometry=function(r){var i=r._positions;var a=e(i,n.equalsEpsilon);var o=r._shape;o=_.removeDuplicatesFromShape(o);if(a.length<2||o.length<3){return undefined}if(v.computeWindingOrder2D(o)===y.CLOCKWISE){o.reverse()}var s=t.fromPoints(o,E);var u=_.computePositions(a,o,s,r,false);return w(u,o)};return C});define("Core/QuaternionSpline",["./defaultValue","./defined","./defineProperties","./DeveloperError","./Quaternion","./Spline"],function(e,t,r,i,n,a){"use strict";function o(e,r,i){var a=e.length;var o=new Array(a);o[0]=t(r)?r:e[0];o[a-1]=t(i)?i:e[a-1];for(var s=1;s<a-1;++s){o[s]=n.computeInnerQuadrangle(e[s-1],e[s],e[s+1],new n)}return o}function s(e){var r=e.points;var i=e.innerQuadrangles;var a=e.times;if(r.length<3){var o=a[0];var s=1/(a[1]-o);var u=r[0];var l=r[1];return function(e,r){if(!t(r)){r=new n}var i=(e-o)*s;return n.fastSlerp(u,l,i,r)}}return function(o,s){if(!t(s)){s=new n}var u=e._lastTimeIndex=e.findTimeInterval(o,e._lastTimeIndex);var l=(o-a[u])/(a[u+1]-a[u]);var c=r[u];var d=r[u+1];var f=i[u];var h=i[u+1];return n.fastSquad(c,d,f,h,l,s)}}function u(r){r=e(r,e.EMPTY_OBJECT);var n=r.points;var a=r.times;var u=r.firstInnerQuadrangle;var l=r.lastInnerQuadrangle;if(!t(n)||!t(a)){throw new i("points and times are required.")}if(n.length<2){throw new i("points.length must be greater than or equal to 2.")}if(a.length!==n.length){throw new i("times.length must be equal to points.length.")}var c=o(n,u,l);this._times=a;this._points=n;this._innerQuadrangles=c;this._evaluateFunction=s(this);this._lastTimeIndex=0}r(u.prototype,{times:{get:function(){return this._times}},points:{get:function(){return this._points}},innerQuadrangles:{get:function(){return this._innerQuadrangles}}});u.prototype.findTimeInterval=a.prototype.findTimeInterval;u.prototype.evaluate=function(e,t){return this._evaluateFunction(e,t)};return u});define("Core/RectangleGeometryLibrary",["./Cartesian3","./Cartographic","./defined","./DeveloperError","./GeographicProjection","./Math","./Matrix2","./Rectangle"],function(e,t,r,i,n,a,o,s){"use strict";var u=Math.cos;var l=Math.sin;var c=Math.sqrt;var d={};d.computePosition=function(e,t,i,n,a){var o=e.ellipsoid.radiiSquared;var s=e.nwCorner;var d=e.rectangle;var f=s.latitude-e.granYCos*t+i*e.granXSin;var h=u(f);var p=l(f);var m=o.z*p;var v=s.longitude+t*e.granYSin+i*e.granXCos;var _=h*u(v);var g=h*l(v);var y=o.x*_;var w=o.y*g;var C=c(y*_+w*g+m*p);n.x=y/C;n.y=w/C;n.z=m/C;if(r(e.vertexFormat)&&e.vertexFormat.st){var b=e.stNwCorner;if(r(b)){f=b.latitude-e.stGranYCos*t+i*e.stGranXSin;v=b.longitude+t*e.stGranYSin+i*e.stGranXCos;a.x=(v-e.stWest)*e.lonScalar;a.y=(f-e.stSouth)*e.latScalar}else{a.x=(v-d.west)*e.lonScalar;a.y=(f-d.south)*e.latScalar}}};var f=new o;var h=new e;var p=new t;var m=new e;var v=new n;function _(t,r,i,n,a,s,u){var l=Math.cos(r);var c=n*l;var d=i*l;var p=Math.sin(r);var _=n*p;var g=i*p;h=v.project(t,h);h=e.subtract(h,m,h);var y=o.fromRotation(r,f);h=o.multiplyByVector(y,h,h);h=e.add(h,m,h);t=v.unproject(h,t);s-=1;u-=1;var w=t.latitude;var C=w+s*g;var b=w-c*u;var S=w-c*u+s*g;var E=Math.max(w,C,b,S);var T=Math.min(w,C,b,S);var x=t.longitude;var A=x+s*d;var P=x+u*_;var D=x+u*_+s*d;var M=Math.max(x,A,P,D);var I=Math.min(x,A,P,D);return{north:E,south:T,east:M,west:I,granYCos:c,granYSin:_,granXCos:d,granXSin:g,nwCorner:t}}d.computeOptions=function(e,t,r,n){var o=e._granularity;var u=e._ellipsoid;var l=e._surfaceHeight;var c=e._rotation;var d=e._stRotation;var f=e._extrudedHeight;var h=t.east;var g=t.west;var y=t.north;var w=t.south;var C;var b;var S;var E;var T;var x=y-w;if(g>h){T=a.TWO_PI-g+h;C=Math.ceil(T/o)+1;b=Math.ceil(x/o)+1;S=T/(C-1);E=x/(b-1)}else{T=h-g;C=Math.ceil(T/o)+1;b=Math.ceil(x/o)+1;S=T/(C-1);E=x/(b-1)}r=s.northwest(t,r);var A=s.center(t,p);if(c!==0||d!==0){if(A.longitude<r.longitude){A.longitude+=a.TWO_PI}m=v.project(A,m)}var P=E;var D=S;var M=0;var I=0;var O={granYCos:P,granYSin:M,granXCos:D,granXSin:I,ellipsoid:u,surfaceHeight:l,extrudedHeight:f,nwCorner:r,rectangle:t,width:C,height:b};if(c!==0){var R=_(r,c,S,E,A,C,b);y=R.north;w=R.south;h=R.east;g=R.west;if(y<-a.PI_OVER_TWO||y>a.PI_OVER_TWO||w<-a.PI_OVER_TWO||w>a.PI_OVER_TWO){throw new i("Rotated rectangle is invalid.  It crosses over either the north or south pole.")}O.granYCos=R.granYCos;O.granYSin=R.granYSin;O.granXCos=R.granXCos;O.granXSin=R.granXSin;t.north=y;t.south=w;t.east=h;t.west=g}if(d!==0){c=c-d;n=s.northwest(t,n);var N=_(n,c,S,E,A,C,b);O.stGranYCos=N.granYCos;O.stGranXCos=N.granXCos;O.stGranYSin=N.granYSin;O.stGranXSin=N.granXSin;O.stNwCorner=n;O.stWest=N.west;O.stSouth=N.south}return O};return d})
;define("Core/RectangleGeometry",["./BoundingSphere","./Cartesian2","./Cartesian3","./Cartographic","./Check","./ComponentDatatype","./defaultValue","./defined","./defineProperties","./DeveloperError","./Ellipsoid","./Geometry","./GeometryAttribute","./GeometryAttributes","./GeometryInstance","./GeometryPipeline","./IndexDatatype","./Math","./Matrix3","./PolygonPipeline","./PrimitiveType","./Quaternion","./Rectangle","./RectangleGeometryLibrary","./VertexFormat"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w,C,b,S,E){"use strict";var T=new r;var x=new r;var A=new r;var P=new r;var D=new b;var M=new t;var I=new e;var O=new e;function R(e,t){var r=new d({attributes:new h,primitiveType:w.TRIANGLES});r.attributes.position=new f({componentDatatype:a.DOUBLE,componentsPerAttribute:3,values:t.positions});if(e.normal){r.attributes.normal=new f({componentDatatype:a.FLOAT,componentsPerAttribute:3,values:t.normals})}if(e.tangent){r.attributes.tangent=new f({componentDatatype:a.FLOAT,componentsPerAttribute:3,values:t.tangents})}if(e.bitangent){r.attributes.bitangent=new f({componentDatatype:a.FLOAT,componentsPerAttribute:3,values:t.bitangents})}return r}function N(e,t,i,n){var a=e.length;var o=t.normal?new Float32Array(a):undefined;var s=t.tangent?new Float32Array(a):undefined;var u=t.bitangent?new Float32Array(a):undefined;var l=0;var c=P;var d=A;var f=x;if(t.normal||t.tangent||t.bitangent){for(var h=0;h<a;h+=3){var p=r.fromArray(e,h,T);var m=l+1;var v=l+2;f=i.geodeticSurfaceNormal(p,f);if(t.tangent||t.bitangent){r.cross(r.UNIT_Z,f,d);g.multiplyByVector(n,d,d);r.normalize(d,d);if(t.bitangent){r.normalize(r.cross(f,d,c),c)}}if(t.normal){o[l]=f.x;o[m]=f.y;o[v]=f.z}if(t.tangent){s[l]=d.x;s[m]=d.y;s[v]=d.z}if(t.bitangent){u[l]=c.x;u[m]=c.y;u[v]=c.z}l+=3}}return R(t,{positions:e,normals:o,tangents:s,bitangents:u})}var L=new r;var B=new r;function F(e,t,i){var n=e.length;var a=t.normal?new Float32Array(n):undefined;var o=t.tangent?new Float32Array(n):undefined;var s=t.bitangent?new Float32Array(n):undefined;var u=0;var l=0;var c=0;var d=true;var f=P;var h=A;var p=x;if(t.normal||t.tangent||t.bitangent){for(var m=0;m<n;m+=6){var v=r.fromArray(e,m,T);var g=r.fromArray(e,(m+6)%n,L);if(d){var y=r.fromArray(e,(m+3)%n,B);r.subtract(g,v,g);r.subtract(y,v,y);p=r.normalize(r.cross(y,g,p),p);d=false}if(r.equalsEpsilon(g,v,_.EPSILON10)){d=true}if(t.tangent||t.bitangent){f=i.geodeticSurfaceNormal(v,f);if(t.tangent){h=r.normalize(r.cross(f,p,h),h)}}if(t.normal){a[u++]=p.x;a[u++]=p.y;a[u++]=p.z;a[u++]=p.x;a[u++]=p.y;a[u++]=p.z}if(t.tangent){o[l++]=h.x;o[l++]=h.y;o[l++]=h.z;o[l++]=h.x;o[l++]=h.y;o[l++]=h.z}if(t.bitangent){s[c++]=f.x;s[c++]=f.y;s[c++]=f.z;s[c++]=f.x;s[c++]=f.y;s[c++]=f.z}}}return R(t,{positions:e,normals:a,tangents:o,bitangents:s})}function k(e){var t=e.vertexFormat;var r=e.ellipsoid;var i=e.size;var n=e.height;var o=e.width;var s=t.position?new Float64Array(i*3):undefined;var u=t.st?new Float32Array(i*2):undefined;var l=0;var c=0;var d=T;var h=M;var p=Number.MAX_VALUE;var m=Number.MAX_VALUE;var _=-Number.MAX_VALUE;var g=-Number.MAX_VALUE;for(var y=0;y<n;++y){for(var w=0;w<o;++w){S.computePosition(e,y,w,d,h);s[l++]=d.x;s[l++]=d.y;s[l++]=d.z;if(t.st){u[c++]=h.x;u[c++]=h.y;p=Math.min(p,h.x);m=Math.min(m,h.y);_=Math.max(_,h.x);g=Math.max(g,h.y)}}}if(t.st&&(p<0||m<0||_>1||g>1)){for(var C=0;C<u.length;C+=2){u[C]=(u[C]-p)/(_-p);u[C+1]=(u[C+1]-m)/(g-m)}}var b=N(s,t,r,e.tangentRotationMatrix);var E=6*(o-1)*(n-1);var x=v.createTypedArray(i,E);var A=0;var P=0;for(var D=0;D<n-1;++D){for(var I=0;I<o-1;++I){var O=A;var R=O+o;var L=R+1;var B=O+1;x[P++]=O;x[P++]=R;x[P++]=B;x[P++]=B;x[P++]=R;x[P++]=L;++A}++A}b.indices=x;if(t.st){b.attributes.st=new f({componentDatatype:a.FLOAT,componentsPerAttribute:2,values:u})}return b}function V(e,t,r,i,n){e[t++]=i[r];e[t++]=i[r+1];e[t++]=i[r+2];e[t++]=n[r];e[t++]=n[r+1];e[t++]=n[r+2];return e}function z(e,t,r,i){e[t++]=i[r];e[t++]=i[r+1];e[t++]=i[r];e[t++]=i[r+1];return e}var U=new E;function q(e){var t=e.shadowVolume;var i=e.vertexFormat;var n=e.surfaceHeight;var o=e.extrudedHeight;var s=Math.min(o,n);var u=Math.max(o,n);var l=e.height;var c=e.width;var d=e.ellipsoid;var h;if(t){e.vertexFormat=E.clone(i,U);e.vertexFormat.normal=true}var g=k(e);if(_.equalsEpsilon(s,u,_.EPSILON10)){return g}var w=y.scaleToGeodeticHeight(g.attributes.position.values,u,d,false);w=new Float64Array(w);var C=w.length;var b=C*2;var S=new Float64Array(b);S.set(w);var T=y.scaleToGeodeticHeight(g.attributes.position.values,s,d);S.set(T,C);g.attributes.position.values=S;var x=i.normal?new Float32Array(b):undefined;var A=i.tangent?new Float32Array(b):undefined;var P=i.bitangent?new Float32Array(b):undefined;var D=i.st?new Float32Array(b/3*2):undefined;var M;var I;if(i.normal){I=g.attributes.normal.values;x.set(I);for(h=0;h<C;h++){I[h]=-I[h]}x.set(I,C);g.attributes.normal.values=x}if(t){I=g.attributes.normal.values;if(!i.normal){g.attributes.normal=undefined}var O=new Float32Array(b);for(h=0;h<C;h++){I[h]=-I[h]}O.set(I,C);g.attributes.extrudeDirection=new f({componentDatatype:a.FLOAT,componentsPerAttribute:3,values:O})}if(i.tangent){var R=g.attributes.tangent.values;A.set(R);for(h=0;h<C;h++){R[h]=-R[h]}A.set(R,C);g.attributes.tangent.values=A}if(i.bitangent){var N=g.attributes.bitangent.values;P.set(N);P.set(N,C);g.attributes.bitangent.values=P}if(i.st){M=g.attributes.st.values;D.set(M);D.set(M,C/3*2);g.attributes.st.values=D}var q=g.indices;var G=q.length;var H=C/3;var W=v.createTypedArray(b/3,G*2);W.set(q);for(h=0;h<G;h+=3){W[h+G]=q[h+2]+H;W[h+1+G]=q[h+1]+H;W[h+2+G]=q[h]+H}g.indices=W;var j=2*c+2*l-4;var Y=(j+4)*2;var X=new Float64Array(Y*3);var Z=t?new Float32Array(Y*3):undefined;var K=i.st?new Float32Array(Y*2):undefined;var Q=0;var J=0;var $=0;var ee=c*l;var te;for(h=0;h<ee;h+=c){te=h*3;X=V(X,Q,te,w,T);Q+=6;if(i.st){K=z(K,J,h*2,M);J+=4}if(t){$+=3;Z[$++]=I[te];Z[$++]=I[te+1];Z[$++]=I[te+2]}}for(h=ee-c;h<ee;h++){te=h*3;X=V(X,Q,te,w,T);Q+=6;if(i.st){K=z(K,J,h*2,M);J+=4}if(t){$+=3;Z[$++]=I[te];Z[$++]=I[te+1];Z[$++]=I[te+2]}}for(h=ee-1;h>0;h-=c){te=h*3;X=V(X,Q,te,w,T);Q+=6;if(i.st){K=z(K,J,h*2,M);J+=4}if(t){$+=3;Z[$++]=I[te];Z[$++]=I[te+1];Z[$++]=I[te+2]}}for(h=c-1;h>=0;h--){te=h*3;X=V(X,Q,te,w,T);Q+=6;if(i.st){K=z(K,J,h*2,M);J+=4}if(t){$+=3;Z[$++]=I[te];Z[$++]=I[te+1];Z[$++]=I[te+2]}}var re=F(X,i,d);if(i.st){re.attributes.st=new f({componentDatatype:a.FLOAT,componentsPerAttribute:2,values:K})}if(t){re.attributes.extrudeDirection=new f({componentDatatype:a.FLOAT,componentsPerAttribute:3,values:Z})}var ie=v.createTypedArray(Y,j*6);var ne;var ae;var oe;var se;C=X.length/3;var ue=0;for(h=0;h<C-1;h+=2){ne=h;se=(ne+2)%C;var le=r.fromArray(X,ne*3,L);var ce=r.fromArray(X,se*3,B);if(r.equalsEpsilon(le,ce,_.EPSILON10)){continue}ae=(ne+1)%C;oe=(ae+2)%C;ie[ue++]=ne;ie[ue++]=ae;ie[ue++]=se;ie[ue++]=se;ie[ue++]=ae;ie[ue++]=oe}re.indices=ie;re=m.combineInstances([new p({geometry:g}),new p({geometry:re})]);return re[0]}var G=new g;var H=new r;var W=new C;var j=[new r,new r,new r,new r];var Y=[new i,new i,new i,new i];function X(e,t,r){if(r===0){return b.clone(e)}b.northeast(e,Y[0]);b.northwest(e,Y[1]);b.southeast(e,Y[2]);b.southwest(e,Y[3]);t.cartographicArrayToCartesianArray(Y,j);var i=t.geodeticSurfaceNormalCartographic(b.center(e,H));C.fromAxisAngle(i,r,W);g.fromQuaternion(W,G);for(var n=0;n<4;++n){g.multiplyByVector(G,j[n],j[n])}t.cartesianArrayToCartographicArray(j,Y);return b.fromCartographicArray(Y)}function Z(e){e=o(e,o.EMPTY_OBJECT);var t=e.rectangle;n.typeOf.object("rectangle",t);b.validate(t);if(t.north<t.south){throw new l("options.rectangle.north must be greater than or equal to options.rectangle.south")}var r=o(e.rotation,0);this._rectangle=t;this._granularity=o(e.granularity,_.RADIANS_PER_DEGREE);this._ellipsoid=c.clone(o(e.ellipsoid,c.WGS84));this._surfaceHeight=o(e.height,0);this._rotation=r;this._stRotation=o(e.stRotation,0);this._vertexFormat=E.clone(o(e.vertexFormat,E.DEFAULT));this._extrudedHeight=o(e.extrudedHeight,0);this._extrude=s(e.extrudedHeight);this._closeTop=o(e.closeTop,true);this._closeBottom=o(e.closeBottom,true);this._shadowVolume=o(e.shadowVolume,false);this._workerName="createRectangleGeometry";this._rotatedRectangle=X(this._rectangle,this._ellipsoid,r)}Z.packedLength=b.packedLength+c.packedLength+E.packedLength+b.packedLength+9;Z.pack=function(e,t,r){n.typeOf.object("value",e);n.defined("array",t);r=o(r,0);b.pack(e._rectangle,t,r);r+=b.packedLength;c.pack(e._ellipsoid,t,r);r+=c.packedLength;E.pack(e._vertexFormat,t,r);r+=E.packedLength;b.pack(e._rotatedRectangle,t,r);r+=b.packedLength;t[r++]=e._granularity;t[r++]=e._surfaceHeight;t[r++]=e._rotation;t[r++]=e._stRotation;t[r++]=e._extrudedHeight;t[r++]=e._extrude?1:0;t[r++]=e._closeTop?1:0;t[r++]=e._closeBottom?1:0;t[r]=e._shadowVolume?1:0;return t};var K=new b;var Q=new b;var J=c.clone(c.UNIT_SPHERE);var $={rectangle:K,ellipsoid:J,vertexFormat:U,granularity:undefined,height:undefined,rotation:undefined,stRotation:undefined,extrudedHeight:undefined,closeTop:undefined,closeBottom:undefined,shadowVolume:undefined};Z.unpack=function(e,t,r){n.defined("array",e);t=o(t,0);var i=b.unpack(e,t,K);t+=b.packedLength;var a=c.unpack(e,t,J);t+=c.packedLength;var u=E.unpack(e,t,U);t+=E.packedLength;var l=b.unpack(e,t,Q);t+=b.packedLength;var d=e[t++];var f=e[t++];var h=e[t++];var p=e[t++];var m=e[t++];var v=e[t++]===1;var _=e[t++]===1;var g=e[t++]===1;var y=e[t]===1;if(!s(r)){$.granularity=d;$.height=f;$.rotation=h;$.stRotation=p;$.extrudedHeight=v?m:undefined;$.closeTop=_;$.closeBottom=g;$.shadowVolume=y;return new Z($)}r._rectangle=b.clone(i,r._rectangle);r._ellipsoid=c.clone(a,r._ellipsoid);r._vertexFormat=E.clone(u,r._vertexFormat);r._granularity=d;r._surfaceHeight=f;r._rotation=h;r._stRotation=p;r._extrudedHeight=v?m:undefined;r._extrude=v;r._closeTop=_;r._closeBottom=g;r._rotatedRectangle=l;r._shadowVolume=y;return r};var ee=new g;var te=new i;var re=new i;var ie=new C;var ne=new i;Z.createGeometry=function(t){if(_.equalsEpsilon(t._rectangle.north,t._rectangle.south,_.EPSILON10)||_.equalsEpsilon(t._rectangle.east,t._rectangle.west,_.EPSILON10)){return undefined}var r=b.clone(t._rectangle,D);var i=t._ellipsoid;var n=t._surfaceHeight;var a=t._extrude;var o=t._extrudedHeight;var s=t._rotation;var u=t._stRotation;var l=t._vertexFormat;var c=S.computeOptions(t,r,te,re);var f=ee;if(u!==0||s!==0){var h=b.center(r,ne);var p=i.geodeticSurfaceNormalCartographic(h,L);C.fromAxisAngle(p,-u,ie);g.fromQuaternion(ie,f)}else{g.clone(g.IDENTITY,f)}c.lonScalar=1/t._rectangle.width;c.latScalar=1/t._rectangle.height;c.vertexFormat=l;c.rotation=s;c.stRotation=u;c.tangentRotationMatrix=f;c.size=c.width*c.height;var m;var v;r=t._rectangle;if(a){c.shadowVolume=t._shadowVolume;m=q(c);var w=e.fromRectangle3D(r,i,n,O);var E=e.fromRectangle3D(r,i,o,I);v=e.union(w,E)}else{m=k(c);m.attributes.position.values=y.scaleToGeodeticHeight(m.attributes.position.values,n,i,false);v=e.fromRectangle3D(r,i,n)}if(!l.position){delete m.attributes.position}return new d({attributes:m.attributes,indices:m.indices,primitiveType:m.primitiveType,boundingSphere:v})};Z.createShadowVolume=function(e,t,r){var i=e._granularity;var n=e._ellipsoid;var a=t(i,n);var o=r(i,n);return new Z({rectangle:e._rectangle,rotation:e._rotation,ellipsoid:n,stRotation:e._stRotation,granularity:i,extrudedHeight:o,height:a,closeTop:true,closeBottom:true,vertexFormat:E.POSITION_ONLY,shadowVolume:true})};u(Z.prototype,{rectangle:{get:function(){return this._rotatedRectangle}}});return Z});define("Core/RectangleOutlineGeometry",["./BoundingSphere","./Cartesian3","./Cartographic","./ComponentDatatype","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./Geometry","./GeometryAttribute","./GeometryAttributes","./IndexDatatype","./Math","./PolygonPipeline","./PrimitiveType","./Rectangle","./RectangleGeometryLibrary"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v){"use strict";var _=new e;var g=new e;var y=new t;var w=new m;function C(e){var t=e.size;var r=e.height;var n=e.width;var a=new Float64Array(t*3);var o=0;var s=0;var f;var h=y;for(f=0;f<n;f++){v.computePosition(e,s,f,h);a[o++]=h.x;a[o++]=h.y;a[o++]=h.z}f=n-1;for(s=1;s<r;s++){v.computePosition(e,s,f,h);a[o++]=h.x;a[o++]=h.y;a[o++]=h.z}s=r-1;for(f=n-2;f>=0;f--){v.computePosition(e,s,f,h);a[o++]=h.x;a[o++]=h.y;a[o++]=h.z}f=0;for(s=r-2;s>0;s--){v.computePosition(e,s,f,h);a[o++]=h.x;a[o++]=h.y;a[o++]=h.z}var m=a.length/3*2;var _=d.createTypedArray(a.length/3,m);var g=0;for(var w=0;w<a.length/3-1;w++){_[g++]=w;_[g++]=w+1}_[g++]=a.length/3-1;_[g++]=0;var C=new u({attributes:new c,primitiveType:p.LINES});C.attributes.position=new l({componentDatatype:i.DOUBLE,componentsPerAttribute:3,values:a});C.indices=_;return C}function b(e){var t=e.surfaceHeight;var r=e.extrudedHeight;var i=e.ellipsoid;var n=Math.min(r,t);var a=Math.max(r,t);var o=C(e);if(f.equalsEpsilon(n,a,f.EPSILON10)){return o}var s=e.height;var u=e.width;var l=h.scaleToGeodeticHeight(o.attributes.position.values,a,i,false);var c=l.length;var p=new Float64Array(c*2);p.set(l);var m=h.scaleToGeodeticHeight(o.attributes.position.values,n,i);p.set(m,c);o.attributes.position.values=p;var v=p.length/3*2+8;var _=d.createTypedArray(p.length/3,v);c=p.length/6;var g=0;for(var y=0;y<c-1;y++){_[g++]=y;_[g++]=y+1;_[g++]=y+c;_[g++]=y+c+1}_[g++]=c-1;_[g++]=0;_[g++]=c+c-1;_[g++]=c;_[g++]=0;_[g++]=c;_[g++]=u-1;_[g++]=c+u-1;_[g++]=u+s-2;_[g++]=u+s-2+c;_[g++]=2*u+s-3;_[g++]=2*u+s-3+c;o.indices=_;return o}function S(e){e=n(e,n.EMPTY_OBJECT);var t=e.rectangle;var r=n(e.granularity,f.RADIANS_PER_DEGREE);var i=n(e.ellipsoid,s.WGS84);var u=n(e.height,0);var l=n(e.rotation,0);var c=e.extrudedHeight;if(!a(t)){throw new o("rectangle is required.")}m.validate(t);if(t.north<t.south){throw new o("options.rectangle.north must be greater than options.rectangle.south")}this._rectangle=t;this._granularity=r;this._ellipsoid=i;this._surfaceHeight=u;this._rotation=l;this._extrudedHeight=c;this._workerName="createRectangleOutlineGeometry"}S.packedLength=m.packedLength+s.packedLength+5;S.pack=function(e,t,r){if(!a(e)){throw new o("value is required")}if(!a(t)){throw new o("array is required")}r=n(r,0);m.pack(e._rectangle,t,r);r+=m.packedLength;s.pack(e._ellipsoid,t,r);r+=s.packedLength;t[r++]=e._granularity;t[r++]=e._surfaceHeight;t[r++]=e._rotation;t[r++]=a(e._extrudedHeight)?1:0;t[r]=n(e._extrudedHeight,0);return t};var E=new m;var T=s.clone(s.UNIT_SPHERE);var x={rectangle:E,ellipsoid:T,granularity:undefined,height:undefined,rotation:undefined,extrudedHeight:undefined};S.unpack=function(e,t,r){if(!a(e)){throw new o("array is required")}t=n(t,0);var i=m.unpack(e,t,E);t+=m.packedLength;var u=s.unpack(e,t,T);t+=s.packedLength;var l=e[t++];var c=e[t++];var d=e[t++];var f=e[t++];var h=e[t];if(!a(r)){x.granularity=l;x.height=c;x.rotation=d;x.extrudedHeight=f?h:undefined;return new S(x)}r._rectangle=m.clone(i,r._rectangle);r._ellipsoid=s.clone(u,r._ellipsoid);r._surfaceHeight=c;r._rotation=d;r._extrudedHeight=f?h:undefined;return r};var A=new r;S.createGeometry=function(t){var r=m.clone(t._rectangle,w);var i=t._ellipsoid;var n=t._surfaceHeight;var o=t._extrudedHeight;var s=v.computeOptions(t,r,A);s.size=2*s.width+2*s.height-4;var l;var c;r=t._rectangle;if(f.equalsEpsilon(r.north,r.south,f.EPSILON10)||f.equalsEpsilon(r.east,r.west,f.EPSILON10)){return undefined}if(a(o)){l=b(s);var d=e.fromRectangle3D(r,i,n,g);var y=e.fromRectangle3D(r,i,o,_);c=e.union(d,y)}else{l=C(s);l.attributes.position.values=h.scaleToGeodeticHeight(l.attributes.position.values,n,i,false);c=e.fromRectangle3D(r,i,n)}return new u({attributes:l.attributes,indices:l.indices,primitiveType:p.LINES,boundingSphere:c})};return S});define("Core/ReferenceFrame",["./freezeObject"],function(e){"use strict";var t={FIXED:0,INERTIAL:1};return e(t)});define("Core/requestAnimationFrame",["./defined","./getTimestamp"],function(e,t){"use strict";if(typeof window==="undefined"){return}var r=window.requestAnimationFrame;(function(){if(!e(r)){var i=["webkit","moz","ms","o"];var n=0;var a=i.length;while(n<a&&!e(r)){r=window[i[n]+"RequestAnimationFrame"];++n}}if(!e(r)){var o=1e3/60;var s=0;r=function(e){var r=t();var i=Math.max(o-(r-s),0);s=r+i;return setTimeout(function(){e(s)},i)}}})();function i(e){return r(e)}return i});define("Core/sampleTerrain",["../ThirdParty/when","./defined","./DeveloperError"],function(e,t,r){"use strict";function i(i,a,o){if(!t(i)){throw new r("terrainProvider is required.")}if(!t(a)){throw new r("level is required.")}if(!t(o)){throw new r("positions is required.")}var s=e.defer();function u(){if(i.ready){e(n(i,a,o),function(e){s.resolve(e)})}else{setTimeout(u,10)}}u();return s.promise}function n(t,r,i){var n=t.tilingScheme;var s;var u=[];var l={};for(s=0;s<i.length;++s){var c=n.positionToTileXY(i[s],r);var d=c.toString();if(!l.hasOwnProperty(d)){var f={x:c.x,y:c.y,level:r,tilingScheme:n,terrainProvider:t,positions:[]};l[d]=f;u.push(f)}l[d].positions.push(i[s])}var h=[];for(s=0;s<u.length;++s){var p=u[s];var m=p.terrainProvider.requestTileGeometry(p.x,p.y,p.level);var v=e(m,a(p),o(p));h.push(v)}return e.all(h,function(){return i})}function a(e){var t=e.positions;var r=e.tilingScheme.tileXYToRectangle(e.x,e.y,e.level);return function(e){for(var i=0;i<t.length;++i){var n=t[i];n.height=e.interpolateHeight(r,n.longitude,n.latitude)}}}function o(e){var t=e.positions;return function(){for(var e=0;e<t.length;++e){var r=t[e];r.height=undefined}}}return i});define("Core/sampleTerrainMostDetailed",["../ThirdParty/when","./defined","./sampleTerrain","./DeveloperError"],function(e,t,r,i){"use strict";function n(n,a){if(!t(n)){throw new i("terrainProvider is required.")}if(!t(a)){throw new i("positions is required.")}return n.readyPromise.then(function(){var o=[];var s=n.availability;if(!t(s)){throw new i("sampleTerrainMostDetailed requires a terrain provider that has tile availability.")}for(var u=0;u<a.length;++u){var l=a[u];var c=s.computeMaximumLevelAtPosition(l);var d=o[c];if(!t(d)){o[c]=d=[]}d.push(l)}return e.all(o.map(function(e,i){if(t(e)){return r(n,i,e)}})).then(function(){return a})})}return n});define("Core/ScreenSpaceEventType",["./freezeObject"],function(e){"use strict";var t={LEFT_DOWN:0,LEFT_UP:1,LEFT_CLICK:2,LEFT_DOUBLE_CLICK:3,RIGHT_DOWN:5,RIGHT_UP:6,RIGHT_CLICK:7,MIDDLE_DOWN:10,MIDDLE_UP:11,MIDDLE_CLICK:12,MOUSE_MOVE:15,WHEEL:16,PINCH_START:17,PINCH_END:18,PINCH_MOVE:19};return e(t)});define("Core/ScreenSpaceEventHandler",["./AssociativeArray","./Cartesian2","./defaultValue","./defined","./destroyObject","./DeveloperError","./FeatureDetection","./getTimestamp","./KeyboardEventModifier","./ScreenSpaceEventType"],function(e,t,r,i,n,a,o,s,u,l){"use strict";function c(e,t,r){var i=e._element;if(i===document){r.x=t.clientX;r.y=t.clientY;return r}var n=i.getBoundingClientRect();r.x=t.clientX-n.left;r.y=t.clientY-n.top;return r}function d(e,t){var r=e;if(i(t)){r+="+"+t}return r}function f(e){if(e.shiftKey){return u.SHIFT}else if(e.ctrlKey){return u.CTRL}else if(e.altKey){return u.ALT}return undefined}var h={LEFT:0,MIDDLE:1,RIGHT:2};function p(e,t,r,i){function n(t){i(e,t)}r.addEventListener(t,n,false);e._removalFunctions.push(function(){r.removeEventListener(t,n,false)})}function m(e){var t=e._element;var r=!i(t.disableRootEvents)?document:t;if(o.supportsPointerEvents()){p(e,"pointerdown",t,z);p(e,"pointerup",t,U);p(e,"pointermove",t,q);p(e,"pointercancel",t,U)}else{p(e,"mousedown",t,w);p(e,"mouseup",r,S);p(e,"mousemove",r,T);p(e,"touchstart",t,D);p(e,"touchend",r,M);p(e,"touchmove",r,B);p(e,"touchcancel",r,M)}p(e,"dblclick",t,A);var n;if("onwheel"in t){n="wheel"}else if(document.onmousewheel!==undefined){n="mousewheel"}else{n="DOMMouseScroll"}p(e,n,t,P)}function v(e){var t=e._removalFunctions;for(var r=0;r<t.length;++r){t[r]()}}var _={position:new t};function g(e){e._lastSeenTouchEvent=s()}function y(e){return s()-e._lastSeenTouchEvent>G.mouseEmulationIgnoreMilliseconds}function w(e,r){if(!y(e)){return}var n=r.button;e._buttonDown=n;var a;if(n===h.LEFT){a=l.LEFT_DOWN}else if(n===h.MIDDLE){a=l.MIDDLE_DOWN}else if(n===h.RIGHT){a=l.RIGHT_DOWN}else{return}var o=c(e,r,e._primaryPosition);t.clone(o,e._primaryStartPosition);t.clone(o,e._primaryPreviousPosition);var s=f(r);var u=e.getInputAction(a,s);if(i(u)){t.clone(o,_.position);u(_);r.preventDefault()}}var C={position:new t};var b={position:new t};function S(e,r){if(!y(e)){return}var n=r.button;e._buttonDown=undefined;var a;var o;if(n===h.LEFT){a=l.LEFT_UP;o=l.LEFT_CLICK}else if(n===h.MIDDLE){a=l.MIDDLE_UP;o=l.MIDDLE_CLICK}else if(n===h.RIGHT){a=l.RIGHT_UP;o=l.RIGHT_CLICK}else{return}var s=f(r);var u=e.getInputAction(a,s);var d=e.getInputAction(o,s);if(i(u)||i(d)){var p=c(e,r,e._primaryPosition);if(i(u)){t.clone(p,C.position);u(C)}if(i(d)){var m=e._primaryStartPosition;var v=m.x-p.x;var _=m.y-p.y;var g=Math.sqrt(v*v+_*_);if(g<e._clickPixelTolerance){t.clone(p,b.position);d(b)}}}}var E={startPosition:new t,endPosition:new t};function T(e,r){if(!y(e)){return}var n=f(r);var a=c(e,r,e._primaryPosition);var o=e._primaryPreviousPosition;var s=e.getInputAction(l.MOUSE_MOVE,n);if(i(s)){t.clone(o,E.startPosition);t.clone(a,E.endPosition);s(E)}t.clone(a,o);if(i(e._buttonDown)){r.preventDefault()}}var x={position:new t};function A(e,t){var r=t.button;var n;if(r===h.LEFT){n=l.LEFT_DOUBLE_CLICK}else{return}var a=f(t);var o=e.getInputAction(n,a);if(i(o)){c(e,t,x.position);o(x)}}function P(e,t){var r;if(i(t.deltaY)){var n=t.deltaMode;if(n===t.DOM_DELTA_PIXEL){r=-t.deltaY}else if(n===t.DOM_DELTA_LINE){r=-t.deltaY*40}else{r=-t.deltaY*120}}else if(t.detail>0){r=t.detail*-120}else{r=t.wheelDelta}if(!i(r)){return}var a=f(t);var o=e.getInputAction(l.WHEEL,a);if(i(o)){o(r);t.preventDefault()}}function D(e,r){g(e);var i=r.changedTouches;var n;var a=i.length;var o;var s;var u=e._positions;for(n=0;n<a;++n){o=i[n];s=o.identifier;u.set(s,c(e,o,new t))}L(e,r);var l=e._previousPositions;for(n=0;n<a;++n){o=i[n];s=o.identifier;l.set(s,t.clone(u.get(s)))}}function M(e,t){g(e);var r=t.changedTouches;var i;var n=r.length;var a;var o;var s=e._positions;for(i=0;i<n;++i){a=r[i];o=a.identifier;s.remove(o)}L(e,t);var u=e._previousPositions;for(i=0;i<n;++i){a=r[i];o=a.identifier;u.remove(o)}}var I={position:new t};var O={position1:new t,position2:new t};var R={position:new t};var N={position:new t};function L(e,r){var n=f(r);var a=e._positions;var o=e._previousPositions;var s=a.length;var u;var c;if(s!==1&&e._buttonDown===h.LEFT){e._buttonDown=undefined;u=e.getInputAction(l.LEFT_UP,n);if(i(u)){t.clone(e._primaryPosition,R.position);u(R)}if(s===0){c=e.getInputAction(l.LEFT_CLICK,n);if(i(c)){var d=e._primaryStartPosition;var p=o.values[0];var m=d.x-p.x;var v=d.y-p.y;var _=Math.sqrt(m*m+v*v);if(_<e._clickPixelTolerance){t.clone(e._primaryPosition,N.position);c(N)}}}}if(s!==2&&e._isPinching){e._isPinching=false;u=e.getInputAction(l.PINCH_END,n);if(i(u)){u()}}if(s===1){var g=a.values[0];t.clone(g,e._primaryPosition);t.clone(g,e._primaryStartPosition);t.clone(g,e._primaryPreviousPosition);e._buttonDown=h.LEFT;u=e.getInputAction(l.LEFT_DOWN,n);if(i(u)){t.clone(g,I.position);u(I)}r.preventDefault()}if(s===2){e._isPinching=true;u=e.getInputAction(l.PINCH_START,n);if(i(u)){t.clone(a.values[0],O.position1);t.clone(a.values[1],O.position2);u(O);r.preventDefault()}}}function B(e,r){g(e);var n=r.changedTouches;var a;var o=n.length;var s;var u;var l=e._positions;for(a=0;a<o;++a){s=n[a];u=s.identifier;var d=l.get(u);if(i(d)){c(e,s,d)}}V(e,r);var f=e._previousPositions;for(a=0;a<o;++a){s=n[a];u=s.identifier;t.clone(l.get(u),f.get(u))}}var F={startPosition:new t,endPosition:new t};var k={distance:{startPosition:new t,endPosition:new t},angleAndHeight:{startPosition:new t,endPosition:new t}};function V(e,r){var n=f(r);var a=e._positions;var o=e._previousPositions;var s=a.length;var u;if(s===1&&e._buttonDown===h.LEFT){var c=a.values[0];t.clone(c,e._primaryPosition);var d=e._primaryPreviousPosition;u=e.getInputAction(l.MOUSE_MOVE,n);if(i(u)){t.clone(d,F.startPosition);t.clone(c,F.endPosition);u(F)}t.clone(c,d);r.preventDefault()}else if(s===2&&e._isPinching){u=e.getInputAction(l.PINCH_MOVE,n);if(i(u)){var p=a.values[0];var m=a.values[1];var v=o.values[0];var _=o.values[1];var g=m.x-p.x;var y=m.y-p.y;var w=Math.sqrt(g*g+y*y)*.25;var C=_.x-v.x;var b=_.y-v.y;var S=Math.sqrt(C*C+b*b)*.25;var E=(m.y+p.y)*.125;var T=(_.y+v.y)*.125;var x=Math.atan2(y,g);var A=Math.atan2(b,C);t.fromElements(0,S,k.distance.startPosition);t.fromElements(0,w,k.distance.endPosition);t.fromElements(A,T,k.angleAndHeight.startPosition);t.fromElements(x,E,k.angleAndHeight.endPosition);u(k)}}}function z(e,r){r.target.setPointerCapture(r.pointerId);if(r.pointerType==="touch"){var i=e._positions;var n=r.pointerId;i.set(n,c(e,r,new t));L(e,r);var a=e._previousPositions;a.set(n,t.clone(i.get(n)))}else{w(e,r)}}function U(e,t){if(t.pointerType==="touch"){var r=e._positions;var i=t.pointerId;r.remove(i);L(e,t);var n=e._previousPositions;n.remove(i)}else{S(e,t)}}function q(e,r){if(r.pointerType==="touch"){var n=e._positions;var a=r.pointerId;var o=n.get(a);if(!i(o)){return}c(e,r,o);V(e,r);var s=e._previousPositions;t.clone(n.get(a),s.get(a))}else{T(e,r)}}function G(i){this._inputEvents={};this._buttonDown=undefined;this._isPinching=false;this._lastSeenTouchEvent=-G.mouseEmulationIgnoreMilliseconds;this._primaryStartPosition=new t;this._primaryPosition=new t;this._primaryPreviousPosition=new t;this._positions=new e;this._previousPositions=new e;this._removalFunctions=[];this._clickPixelTolerance=5;this._element=r(i,document);m(this)}G.prototype.setInputAction=function(e,t,r){if(!i(e)){throw new a("action is required.")}if(!i(t)){throw new a("type is required.")}var n=d(t,r);this._inputEvents[n]=e};G.prototype.getInputAction=function(e,t){if(!i(e)){throw new a("type is required.")}var r=d(e,t);return this._inputEvents[r]};G.prototype.removeInputAction=function(e,t){if(!i(e)){throw new a("type is required.")}var r=d(e,t);delete this._inputEvents[r]};G.prototype.isDestroyed=function(){return false};G.prototype.destroy=function(){v(this);return n(this)};G.mouseEmulationIgnoreMilliseconds=800;return G});define("Core/ShowGeometryInstanceAttribute",["./ComponentDatatype","./defaultValue","./defined","./defineProperties","./DeveloperError"],function(e,t,r,i,n){"use strict";function a(e){e=t(e,true);this.value=a.toValue(e)}i(a.prototype,{componentDatatype:{get:function(){return e.UNSIGNED_BYTE}},componentsPerAttribute:{get:function(){return 1}},normalize:{get:function(){return false}}});a.toValue=function(e,t){if(!r(e)){throw new n("show is required.")}if(!r(t)){return new Uint8Array([e])}t[0]=e;return t};return a});define("Core/Simon1994PlanetaryPositions",["./Cartesian3","./defined","./DeveloperError","./JulianDate","./Math","./Matrix3","./TimeConstants","./TimeStandard"],function(e,t,r,i,n,a,o,s){"use strict";var u={};function l(e){var t=6.239996+.0172019696544*e;return.001657*Math.sin(t+.01671*Math.sin(t))}var c=32.184;var d=2451545;function f(e,t){t=i.addSeconds(e,c,t);var r=i.totalDays(t)-d;t=i.addSeconds(t,l(r),t);return t}var h=new i(2451545,0,s.TAI);var p=1e3;var m=n.RADIANS_PER_DEGREE;var v=n.RADIANS_PER_ARCSECOND;var _=14959787e4;var g=new a;function y(i,o,s,u,l,c,d){if(s<0){s=-s;l+=n.PI}if(s<0||s>n.PI){throw new r("The inclination is out of range. Inclination must be greater than or equal to zero and less than or equal to Pi radians.")}var f=i*(1-o);var h=u-l;var p=l;var m=C(c-u,o);var v=w(o,0);if(v==="Hyperbolic"&&Math.abs(n.negativePiToPi(m))>=Math.acos(-1/o)){throw new r("The true anomaly of the hyperbolic orbit lies outside of the bounds of the hyperbola.")}x(h,s,p,g);var _=f*(1+o);var y=Math.cos(m);var b=Math.sin(m);var S=1+o*y;if(S<=n.Epsilon10){throw new r("elements cannot be converted to cartesian")}var E=_/S;if(!t(d)){d=new e(E*y,E*b,0)}else{d.x=E*y;d.y=E*b;d.z=0}return a.multiplyByVector(g,d,d)}function w(e,t){if(e<0){throw new r("eccentricity cannot be negative.")}if(e<=t){return"Circular"}else if(e<1-t){return"Elliptical"}else if(e<=1+t){return"Parabolic"}else{return"Hyperbolic"}}function C(e,t){if(t<0||t>=1){throw new r("eccentricity out of range.")}var i=E(e,t);return T(i,t)}var b=50;var S=n.EPSILON8;function E(e,t){if(t<0||t>=1){throw new r("eccentricity out of range.")}var i=Math.floor(e/n.TWO_PI);e-=i*n.TWO_PI;var a=e+t*Math.sin(e)/(1-Math.sin(e+t)+Math.sin(e));var o=Number.MAX_VALUE;var s;for(s=0;s<b&&Math.abs(o-a)>S;++s){o=a;var u=o-t*Math.sin(o)-e;var l=1-t*Math.cos(o);a=o-u/l}if(s>=b){throw new r("Kepler equation did not converge")}o=a+i*n.TWO_PI;return o}function T(e,t){if(t<0||t>=1){throw new r("eccentricity out of range.")}var i=Math.floor(e/n.TWO_PI);e-=i*n.TWO_PI;var a=Math.cos(e)-t;var o=Math.sin(e)*Math.sqrt(1-t*t);var s=Math.atan2(o,a);s=n.zeroToTwoPi(s);if(e<0){s-=n.TWO_PI}s+=i*n.TWO_PI;return s}function x(e,i,o,s){if(i<0||i>n.PI){throw new r("inclination out of range")}var u=Math.cos(e);var l=Math.sin(e);var c=Math.cos(i);var d=Math.sin(i);var f=Math.cos(o);var h=Math.sin(o);if(!t(s)){s=new a(f*u-h*l*c,-f*l-h*u*c,h*d,h*u+f*l*c,-h*l+f*u*c,-f*d,l*d,u*d,c)}else{s[0]=f*u-h*l*c;s[1]=h*u+f*l*c;s[2]=l*d;s[3]=-f*l-h*u*c;s[4]=-h*l+f*u*c;s[5]=u*d;s[6]=h*d;s[7]=-f*d;s[8]=c}return s}var A=1.0000010178*_;var P=100.46645683*m;var D=1295977422.83429*v;var M=16002;var I=21863;var O=32004;var R=10931;var N=14529;var L=16368;var B=15318;var F=32794;var k=64*1e-7*_;var V=-152*1e-7*_;var z=62*1e-7*_;var U=-8*1e-7*_;var q=32*1e-7*_;var G=-41*1e-7*_;var H=19*1e-7*_;var W=-11*1e-7*_;var j=-150*1e-7*_;var Y=-46*1e-7*_;var X=68*1e-7*_;var Z=54*1e-7*_;var K=14*1e-7*_;var Q=24*1e-7*_;var J=-28*1e-7*_;var $=22*1e-7*_;var ee=10;var te=16002;var re=21863;var ie=10931;var ne=1473;var ae=32004;var oe=4387;var se=73;var ue=-325*1e-7;var le=-322*1e-7;var ce=-79*1e-7;var de=232*1e-7;var fe=-52*1e-7;var he=97*1e-7;var pe=55*1e-7;var me=-41*1e-7;var ve=-105*1e-7;var _e=-137*1e-7;var ge=258*1e-7;var ye=35*1e-7;var we=-116*1e-7;var Ce=-88*1e-7;var be=-112*1e-7;var Se=-80*1e-7;var Ee=new i(0,0,s.TAI);function Te(e,t){f(e,Ee);var r=Ee.dayNumber-h.dayNumber+(Ee.secondsOfDay-h.secondsOfDay)/o.SECONDS_PER_DAY;var i=r/(o.DAYS_PER_JULIAN_CENTURY*10);var n=.3595362*i;var a=A+k*Math.cos(M*n)+j*Math.sin(M*n)+V*Math.cos(I*n)+Y*Math.sin(I*n)+z*Math.cos(O*n)+X*Math.sin(O*n)+U*Math.cos(R*n)+Z*Math.sin(R*n)+q*Math.cos(N*n)+K*Math.sin(N*n)+G*Math.cos(L*n)+Q*Math.sin(L*n)+H*Math.cos(B*n)+J*Math.sin(B*n)+W*Math.cos(F*n)+$*Math.sin(F*n);var s=P+D*i+ue*Math.cos(ee*n)+ve*Math.sin(ee*n)+le*Math.cos(te*n)+_e*Math.sin(te*n)+ce*Math.cos(re*n)+ge*Math.sin(re*n)+de*Math.cos(ie*n)+ye*Math.sin(ie*n)+fe*Math.cos(ne*n)+we*Math.sin(ne*n)+he*Math.cos(ae*n)+Ce*Math.sin(ae*n)+pe*Math.cos(oe*n)+be*Math.sin(oe*n)+me*Math.cos(se*n)+Se*Math.sin(se*n);var u=.0167086342-.0004203654*i;var l=102.93734808*m+11612.3529*v*i;var c=469.97289*v*i;var d=174.87317577*m-8679.27034*v*i;return y(a,u,c,l,d,s,t)}function xe(e,t){f(e,Ee);var r=Ee.dayNumber-h.dayNumber+(Ee.secondsOfDay-h.secondsOfDay)/o.SECONDS_PER_DAY;var i=r/o.DAYS_PER_JULIAN_CENTURY;var n=i*i;var a=n*i;var s=a*i;var u=383397.7725+.004*i;var l=.055545526-1.6e-8*i;var c=5.15668983*m;var d=-8e-5*i+.02966*n-42e-6*a-1.3e-7*s;var _=83.35324312*m;var g=14643420.2669*i-38.2702*n-.045047*a+21301e-8*s;var w=125.04455501*m;var C=-6967919.3631*i+6.3602*n+.007625*a-3586e-8*s;var b=218.31664563*m;var S=1732559343.4847*i-6.391*n+.006588*a-3169e-8*s;var E=297.85019547*m+v*(1602961601.209*i-6.3706*n+.006593*a-3169e-8*s);var T=93.27209062*m+v*(1739527262.8478*i-12.7512*n-.001037*a+417e-8*s);var x=134.96340251*m+v*(1717915923.2178*i+31.8792*n+.051635*a-2447e-7*s);var A=357.52910918*m+v*(129596581.0481*i-.5532*n+136e-6*a-1149e-8*s);var P=310.17137918*m-v*(6967051.436*i+6.2068*n+.007618*a-3219e-8*s);var D=2*E;var M=4*E;var I=6*E;var O=2*x;var R=3*x;var N=4*x;var L=2*T;u+=3400.4*Math.cos(D)-635.6*Math.cos(D-x)-235.6*Math.cos(x)+218.1*Math.cos(D-A)+181*Math.cos(D+x)
;l+=.014216*Math.cos(D-x)+.008551*Math.cos(D-O)-.001383*Math.cos(x)+.001356*Math.cos(D+x)-.001147*Math.cos(M-R)-914e-6*Math.cos(M-O)+869e-6*Math.cos(D-A-x)-627e-6*Math.cos(D)-394e-6*Math.cos(M-N)+282e-6*Math.cos(D-A-O)-279e-6*Math.cos(E-x)-236e-6*Math.cos(O)+231e-6*Math.cos(M)+229e-6*Math.cos(I-N)-201e-6*Math.cos(O-L);d+=486.26*Math.cos(D-L)-40.13*Math.cos(D)+37.51*Math.cos(L)+25.73*Math.cos(O-L)+19.97*Math.cos(D-A-L);g+=-55609*Math.sin(D-x)-34711*Math.sin(D-O)-9792*Math.sin(x)+9385*Math.sin(M-R)+7505*Math.sin(M-O)+5318*Math.sin(D+x)+3484*Math.sin(M-N)-3417*Math.sin(D-A-x)-2530*Math.sin(I-N)-2376*Math.sin(D)-2075*Math.sin(D-R)-1883*Math.sin(O)-1736*Math.sin(I-5*x)+1626*Math.sin(A)-1370*Math.sin(I-R);C+=-5392*Math.sin(D-L)-540*Math.sin(A)-441*Math.sin(D)+423*Math.sin(L)-288*Math.sin(O-L);S+=-3332.9*Math.sin(D)+1197.4*Math.sin(D-x)-662.5*Math.sin(A)+396.3*Math.sin(x)-218*Math.sin(D-A);var B=2*P;var F=3*P;d+=46.997*Math.cos(P)*i-.614*Math.cos(D-L+P)*i+.614*Math.cos(D-L-P)*i-.0297*Math.cos(B)*n-.0335*Math.cos(P)*n+.0012*Math.cos(D-L+B)*n-16e-5*Math.cos(P)*a+4e-5*Math.cos(F)*a+4e-5*Math.cos(B)*a;var k=2.116*Math.sin(P)*i-.111*Math.sin(D-L-P)*i-.0015*Math.sin(P)*n;g+=k;S+=k;C+=-520.77*Math.sin(P)*i+13.66*Math.sin(D-L+P)*i+1.12*Math.sin(D-P)*i-1.06*Math.sin(L-P)*i+.66*Math.sin(B)*n+.371*Math.sin(P)*n-.035*Math.sin(D-L+B)*n-.015*Math.sin(D-L+P)*n+.0014*Math.sin(P)*a-.0011*Math.sin(F)*a-9e-4*Math.sin(B)*a;u*=p;var V=c+d*v;var z=_+g*v;var U=b+S*v;var q=w+C*v;return y(u,l,V,z,q,U,t)}var Ae=.012300034;var Pe=Ae/(Ae+1)*-1;function De(t,r){r=xe(t,r);return e.multiplyByScalar(r,Pe,r)}var Me=new a(1.0000000000000002,5.619723173785822e-16,4.690511510146299e-19,-5.154129427414611e-16,.9174820620691819,-.39777715593191376,-2.23970096136568e-16,.39777715593191376,.9174820620691819);var Ie=new e;u.computeSunPositionInEarthInertialFrame=function(r,n){if(!t(r)){r=i.now()}if(!t(n)){n=new e}Ie=Te(r,Ie);n=e.negate(Ie,n);De(r,Ie);e.subtract(n,Ie,n);a.multiplyByVector(Me,n,n);return n};u.computeMoonPositionInEarthInertialFrame=function(e,r){if(!t(e)){e=i.now()}r=xe(e,r);a.multiplyByVector(Me,r,r);return r};return u});define("Core/SimplePolylineGeometry",["./BoundingSphere","./Cartesian3","./Color","./ComponentDatatype","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./Geometry","./GeometryAttribute","./GeometryAttributes","./IndexDatatype","./Math","./PolylinePipeline","./PrimitiveType"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p){"use strict";function m(e,t,i,n,a,o,s){var u=h.numberOfPoints(e,t,a);var l;var c=i.red;var d=i.green;var f=i.blue;var p=i.alpha;var m=n.red;var v=n.green;var _=n.blue;var g=n.alpha;if(r.equals(i,n)){for(l=0;l<u;l++){o[s++]=r.floatToByte(c);o[s++]=r.floatToByte(d);o[s++]=r.floatToByte(f);o[s++]=r.floatToByte(p)}return s}var y=(m-c)/u;var w=(v-d)/u;var C=(_-f)/u;var b=(g-p)/u;var S=s;for(l=0;l<u;l++){o[S++]=r.floatToByte(c+l*y);o[S++]=r.floatToByte(d+l*w);o[S++]=r.floatToByte(f+l*C);o[S++]=r.floatToByte(p+l*b)}return S}function v(e){e=n(e,n.EMPTY_OBJECT);var i=e.positions;var u=e.colors;var l=n(e.colorsPerVertex,false);if(!a(i)||i.length<2){throw new o("At least two positions are required.")}if(a(u)&&(l&&u.length<i.length||!l&&u.length<i.length-1)){throw new o("colors has an invalid length.")}this._positions=i;this._colors=u;this._colorsPerVertex=l;this._followSurface=n(e.followSurface,true);this._granularity=n(e.granularity,f.RADIANS_PER_DEGREE);this._ellipsoid=n(e.ellipsoid,s.WGS84);this._workerName="createSimplePolylineGeometry";var c=1+i.length*t.packedLength;c+=a(u)?1+u.length*r.packedLength:1;this.packedLength=c+s.packedLength+3}v.pack=function(e,i,u){if(!a(e)){throw new o("value is required")}if(!a(i)){throw new o("array is required")}u=n(u,0);var l;var c=e._positions;var d=c.length;i[u++]=d;for(l=0;l<d;++l,u+=t.packedLength){t.pack(c[l],i,u)}var f=e._colors;d=a(f)?f.length:0;i[u++]=d;for(l=0;l<d;++l,u+=r.packedLength){r.pack(f[l],i,u)}s.pack(e._ellipsoid,i,u);u+=s.packedLength;i[u++]=e._colorsPerVertex?1:0;i[u++]=e._followSurface?1:0;i[u]=e._granularity;return i};v.unpack=function(e,i,u){if(!a(e)){throw new o("array is required")}i=n(i,0);var l;var c=e[i++];var d=new Array(c);for(l=0;l<c;++l,i+=t.packedLength){d[l]=t.unpack(e,i)}c=e[i++];var f=c>0?new Array(c):undefined;for(l=0;l<c;++l,i+=r.packedLength){f[l]=r.unpack(e,i)}var h=s.unpack(e,i);i+=s.packedLength;var p=e[i++]===1;var m=e[i++]===1;var _=e[i];if(!a(u)){return new v({positions:d,colors:f,ellipsoid:h,colorsPerVertex:p,followSurface:m,granularity:_})}u._positions=d;u._colors=f;u._ellipsoid=h;u._colorsPerVertex=p;u._followSurface=m;u._granularity=_;return u};var _=new Array(2);var g=new Array(2);var y={positions:_,height:g,ellipsoid:undefined,minDistance:undefined};v.createGeometry=function(n){var o=n._positions;var s=n._colors;var v=n._colorsPerVertex;var w=n._followSurface;var C=n._granularity;var b=n._ellipsoid;var S=f.chordLength(C,b.maximumRadius);var E=a(s)&&!v;var T;var x=o.length;var A;var P;var D;var M;var I=0;if(w){var O=h.extractHeights(o,b);var R=y;R.minDistance=S;R.ellipsoid=b;if(E){var N=0;for(T=0;T<x-1;T++){N+=h.numberOfPoints(o[T],o[T+1],S)+1}A=new Float64Array(N*3);D=new Uint8Array(N*4);R.positions=_;R.height=g;var L=0;for(T=0;T<x-1;++T){_[0]=o[T];_[1]=o[T+1];g[0]=O[T];g[1]=O[T+1];var B=h.generateArc(R);if(a(s)){var F=B.length/3;M=s[T];for(var k=0;k<F;++k){D[L++]=r.floatToByte(M.red);D[L++]=r.floatToByte(M.green);D[L++]=r.floatToByte(M.blue);D[L++]=r.floatToByte(M.alpha)}}A.set(B,I);I+=B.length}}else{R.positions=o;R.height=O;A=new Float64Array(h.generateArc(R));if(a(s)){D=new Uint8Array(A.length/3*4);for(T=0;T<x-1;++T){var V=o[T];var z=o[T+1];var U=s[T];var q=s[T+1];I=m(V,z,U,q,S,D,I)}var G=s[x-1];D[I++]=r.floatToByte(G.red);D[I++]=r.floatToByte(G.green);D[I++]=r.floatToByte(G.blue);D[I++]=r.floatToByte(G.alpha)}}}else{P=E?x*2-2:x;A=new Float64Array(P*3);D=a(s)?new Uint8Array(P*4):undefined;var H=0;var W=0;for(T=0;T<x;++T){var j=o[T];if(E&&T>0){t.pack(j,A,H);H+=3;M=s[T-1];D[W++]=r.floatToByte(M.red);D[W++]=r.floatToByte(M.green);D[W++]=r.floatToByte(M.blue);D[W++]=r.floatToByte(M.alpha)}if(E&&T===x-1){break}t.pack(j,A,H);H+=3;if(a(s)){M=s[T];D[W++]=r.floatToByte(M.red);D[W++]=r.floatToByte(M.green);D[W++]=r.floatToByte(M.blue);D[W++]=r.floatToByte(M.alpha)}}}var Y=new c;Y.position=new l({componentDatatype:i.DOUBLE,componentsPerAttribute:3,values:A});if(a(s)){Y.color=new l({componentDatatype:i.UNSIGNED_BYTE,componentsPerAttribute:4,values:D,normalize:true})}P=A.length/3;var X=(P-1)*2;var Z=d.createTypedArray(P,X);var K=0;for(T=0;T<P-1;++T){Z[K++]=T;Z[K++]=T+1}return new u({attributes:Y,indices:Z,primitiveType:p.LINES,boundingSphere:e.fromPoints(o)})};return v});define("Core/SphereGeometry",["./Cartesian3","./Check","./defaultValue","./defined","./EllipsoidGeometry","./VertexFormat"],function(e,t,r,i,n,a){"use strict";function o(t){var i=r(t.radius,1);var a=new e(i,i,i);var o={radii:a,stackPartitions:t.stackPartitions,slicePartitions:t.slicePartitions,vertexFormat:t.vertexFormat};this._ellipsoidGeometry=new n(o);this._workerName="createSphereGeometry"}o.packedLength=n.packedLength;o.pack=function(e,r,i){t.typeOf.object("value",e);return n.pack(e._ellipsoidGeometry,r,i)};var s=new n;var u={radius:undefined,radii:new e,vertexFormat:new a,stackPartitions:undefined,slicePartitions:undefined};o.unpack=function(t,r,l){var c=n.unpack(t,r,s);u.vertexFormat=a.clone(c._vertexFormat,u.vertexFormat);u.stackPartitions=c._stackPartitions;u.slicePartitions=c._slicePartitions;if(!i(l)){u.radius=c._radii.x;return new o(u)}e.clone(c._radii,u.radii);l._ellipsoidGeometry=new n(u);return l};o.createGeometry=function(e){return n.createGeometry(e._ellipsoidGeometry)};return o});define("Core/SphereOutlineGeometry",["./Cartesian3","./Check","./defaultValue","./defined","./EllipsoidOutlineGeometry"],function(e,t,r,i,n){"use strict";function a(t){var i=r(t.radius,1);var a=new e(i,i,i);var o={radii:a,stackPartitions:t.stackPartitions,slicePartitions:t.slicePartitions,subdivisions:t.subdivisions};this._ellipsoidGeometry=new n(o);this._workerName="createSphereOutlineGeometry"}a.packedLength=n.packedLength;a.pack=function(e,r,i){t.typeOf.object("value",e);return n.pack(e._ellipsoidGeometry,r,i)};var o=new n;var s={radius:undefined,radii:new e,stackPartitions:undefined,slicePartitions:undefined,subdivisions:undefined};a.unpack=function(t,r,u){var l=n.unpack(t,r,o);s.stackPartitions=l._stackPartitions;s.slicePartitions=l._slicePartitions;s.subdivisions=l._subdivisions;if(!i(u)){s.radius=l._radii.x;return new a(s)}e.clone(l._radii,s.radii);u._ellipsoidGeometry=new n(s);return u};a.createGeometry=function(e){return n.createGeometry(e._ellipsoidGeometry)};return a});define("Core/Spherical",["./Check","./defaultValue","./defined"],function(e,t,r){"use strict";function i(e,r,i){this.clock=t(e,0);this.cone=t(r,0);this.magnitude=t(i,1)}i.fromCartesian3=function(t,n){e.typeOf.object("cartesian3",t);var a=t.x;var o=t.y;var s=t.z;var u=a*a+o*o;if(!r(n)){n=new i}n.clock=Math.atan2(o,a);n.cone=Math.atan2(Math.sqrt(u),s);n.magnitude=Math.sqrt(u+s*s);return n};i.clone=function(e,t){if(!r(e)){return undefined}if(!r(t)){return new i(e.clock,e.cone,e.magnitude)}t.clock=e.clock;t.cone=e.cone;t.magnitude=e.magnitude;return t};i.normalize=function(t,n){e.typeOf.object("spherical",t);if(!r(n)){return new i(t.clock,t.cone,1)}n.clock=t.clock;n.cone=t.cone;n.magnitude=1;return n};i.equals=function(e,t){return e===t||r(e)&&r(t)&&e.clock===t.clock&&e.cone===t.cone&&e.magnitude===t.magnitude};i.equalsEpsilon=function(e,i,n){n=t(n,0);return e===i||r(e)&&r(i)&&Math.abs(e.clock-i.clock)<=n&&Math.abs(e.cone-i.cone)<=n&&Math.abs(e.magnitude-i.magnitude)<=n};i.prototype.equals=function(e){return i.equals(this,e)};i.prototype.clone=function(e){return i.clone(this,e)};i.prototype.equalsEpsilon=function(e,t){return i.equalsEpsilon(this,e,t)};i.prototype.toString=function(){return"("+this.clock+", "+this.cone+", "+this.magnitude+")"};return i});define("Core/subdivideArray",["./defined","./DeveloperError"],function(e,t){"use strict";function r(r,i){if(!e(r)){throw new t("array is required.")}if(!e(i)||i<1){throw new t("numberOfArrays must be greater than 0.")}var n=[];var a=r.length;var o=0;while(o<a){var s=Math.ceil((a-o)/i--);n.push(r.slice(o,o+s));o+=s}return n}return r});define("Core/TerrainData",["./defineProperties","./DeveloperError"],function(e,t){"use strict";function r(){t.throwInstantiationError()}e(r.prototype,{waterMask:{get:t.throwInstantiationError}});r.prototype.interpolateHeight=t.throwInstantiationError;r.prototype.isChildAvailable=t.throwInstantiationError;r.prototype.createMesh=t.throwInstantiationError;r.prototype.upsample=t.throwInstantiationError;r.prototype.wasCreatedByUpsampling=t.throwInstantiationError;return r});define("Core/TilingScheme",["./defineProperties","./DeveloperError"],function(e,t){"use strict";function r(e){throw new t("This type should not be instantiated directly.  Instead, use WebMercatorTilingScheme or GeographicTilingScheme.")}e(r.prototype,{ellipsoid:{get:t.throwInstantiationError},rectangle:{get:t.throwInstantiationError},projection:{get:t.throwInstantiationError}});r.prototype.getNumberOfXTilesAtLevel=t.throwInstantiationError;r.prototype.getNumberOfYTilesAtLevel=t.throwInstantiationError;r.prototype.rectangleToNativeRectangle=t.throwInstantiationError;r.prototype.tileXYToNativeRectangle=t.throwInstantiationError;r.prototype.tileXYToRectangle=t.throwInstantiationError;r.prototype.positionToTileXY=t.throwInstantiationError;return r});define("Core/TimeIntervalCollection",["./binarySearch","./defaultValue","./defined","./defineProperties","./DeveloperError","./Event","./JulianDate","./TimeInterval"],function(e,t,r,i,n,a,o,s){"use strict";function u(e,t){return o.compare(e.start,t.start)}function l(e){this._intervals=[];this._changedEvent=new a;if(r(e)){var t=e.length;for(var i=0;i<t;i++){this.addInterval(e[i])}}}i(l.prototype,{changedEvent:{get:function(){return this._changedEvent}},start:{get:function(){var e=this._intervals;return e.length===0?undefined:e[0].start}},isStartIncluded:{get:function(){var e=this._intervals;return e.length===0?false:e[0].isStartIncluded}},stop:{get:function(){var e=this._intervals;var t=e.length;return t===0?undefined:e[t-1].stop}},isStopIncluded:{get:function(){var e=this._intervals;var t=e.length;return t===0?false:e[t-1].isStopIncluded}},length:{get:function(){return this._intervals.length}},isEmpty:{get:function(){return this._intervals.length===0}}});l.prototype.equals=function(e,t){if(this===e){return true}if(!(e instanceof l)){return false}var r=this._intervals;var i=e._intervals;var n=r.length;if(n!==i.length){return false}for(var a=0;a<n;a++){if(!s.equals(r[a],i[a],t)){return false}}return true};l.prototype.get=function(e){if(!r(e)){throw new n("index is required.")}return this._intervals[e]};l.prototype.removeAll=function(){if(this._intervals.length>0){this._intervals.length=0;this._changedEvent.raiseEvent(this)}};l.prototype.findIntervalContainingDate=function(e){var t=this.indexOf(e);return t>=0?this._intervals[t]:undefined};l.prototype.findDataForIntervalContainingDate=function(e){var t=this.indexOf(e);return t>=0?this._intervals[t].data:undefined};l.prototype.contains=function(e){return this.indexOf(e)>=0};var c=new s;l.prototype.indexOf=function(t){if(!r(t)){throw new n("date is required")}var i=this._intervals;c.start=t;c.stop=t;var a=e(i,c,u);if(a>=0){if(i[a].isStartIncluded){return a}if(a>0&&i[a-1].stop.equals(t)&&i[a-1].isStopIncluded){return a-1}return~a}a=~a;if(a>0&&a-1<i.length&&s.contains(i[a-1],t)){return a-1}return~a};l.prototype.findInterval=function(e){e=t(e,t.EMPTY_OBJECT);var i=e.start;var n=e.stop;var a=e.isStartIncluded;var o=e.isStopIncluded;var s=this._intervals;for(var u=0,l=s.length;u<l;u++){var c=s[u];if((!r(i)||c.start.equals(i))&&(!r(n)||c.stop.equals(n))&&(!r(a)||c.isStartIncluded===a)&&(!r(o)||c.isStopIncluded===o)){return s[u]}}return undefined};l.prototype.addInterval=function(t,i){if(!r(t)){throw new n("interval is required")}if(t.isEmpty){return}var a;var l;var c=this._intervals;if(c.length===0||o.greaterThan(t.start,c[c.length-1].stop)){c.push(t);this._changedEvent.raiseEvent(this);return}l=e(c,t,u);if(l<0){l=~l}else{if(l>0&&t.isStartIncluded&&c[l-1].isStartIncluded&&c[l-1].start.equals(t.start)){--l}else if(l<c.length&&!t.isStartIncluded&&c[l].isStartIncluded&&c[l].start.equals(t.start)){++l}}if(l>0){a=o.compare(c[l-1].stop,t.start);if(a>0||a===0&&(c[l-1].isStopIncluded||t.isStartIncluded)){if(r(i)?i(c[l-1].data,t.data):c[l-1].data===t.data){if(o.greaterThan(t.stop,c[l-1].stop)){t=new s({start:c[l-1].start,stop:t.stop,isStartIncluded:c[l-1].isStartIncluded,isStopIncluded:t.isStopIncluded,data:t.data})}else{t=new s({start:c[l-1].start,stop:c[l-1].stop,isStartIncluded:c[l-1].isStartIncluded,isStopIncluded:c[l-1].isStopIncluded||t.stop.equals(c[l-1].stop)&&t.isStopIncluded,data:t.data})}c.splice(l-1,1);--l}else{a=o.compare(c[l-1].stop,t.stop);if(a>0||a===0&&c[l-1].isStopIncluded&&!t.isStopIncluded){c.splice(l-1,1,new s({start:c[l-1].start,stop:t.start,isStartIncluded:c[l-1].isStartIncluded,isStopIncluded:!t.isStartIncluded,data:c[l-1].data}),new s({start:t.stop,stop:c[l-1].stop,isStartIncluded:!t.isStopIncluded,isStopIncluded:c[l-1].isStopIncluded,data:c[l-1].data}))}else{c[l-1]=new s({start:c[l-1].start,stop:t.start,isStartIncluded:c[l-1].isStartIncluded,isStopIncluded:!t.isStartIncluded,data:c[l-1].data})}}}}while(l<c.length){a=o.compare(t.stop,c[l].start);if(a>0||a===0&&(t.isStopIncluded||c[l].isStartIncluded)){if(r(i)?i(c[l].data,t.data):c[l].data===t.data){t=new s({start:t.start,stop:o.greaterThan(c[l].stop,t.stop)?c[l].stop:t.stop,isStartIncluded:t.isStartIncluded,isStopIncluded:o.greaterThan(c[l].stop,t.stop)?c[l].isStopIncluded:t.isStopIncluded,data:t.data});c.splice(l,1)}else{c[l]=new s({start:t.stop,stop:c[l].stop,isStartIncluded:!t.isStopIncluded,isStopIncluded:c[l].isStopIncluded,data:c[l].data});if(c[l].isEmpty){c.splice(l,1)}else{break}}}else{break}}c.splice(l,0,t);this._changedEvent.raiseEvent(this)};l.prototype.removeInterval=function(t){if(!r(t)){throw new n("interval is required")}if(t.isEmpty){return false}var i=false;var a=this._intervals;var l=e(a,t,u);if(l<0){l=~l}var c=t.start;var d=t.stop;var f=t.isStartIncluded;var h=t.isStopIncluded;if(l>0){var p=a[l-1];var m=p.stop;if(o.greaterThan(m,c)||s.equals(m,c)&&p.isStopIncluded&&f){i=true;if(o.greaterThan(m,d)||p.isStopIncluded&&!h&&s.equals(m,d)){a.splice(l,0,new s({start:d,stop:m,isStartIncluded:!h,isStopIncluded:p.isStopIncluded,data:p.data}))}a[l-1]=new s({start:p.start,stop:c,isStartIncluded:p.isStartIncluded,isStopIncluded:!f,data:p.data})}}var v=a[l];if(l<a.length&&!f&&v.isStartIncluded&&c.equals(v.start)){i=true;a.splice(l,0,new s({start:v.start,stop:v.start,isStartIncluded:true,isStopIncluded:true,data:v.data}));++l;v=a[l]}while(l<a.length&&o.greaterThan(d,v.stop)){i=true;a.splice(l,1);v=a[l]}if(l<a.length&&d.equals(v.stop)){i=true;if(!h&&v.isStopIncluded){if(l+1<a.length&&a[l+1].start.equals(d)&&v.data===a[l+1].data){a.splice(l,1);v=new s({start:v.start,stop:v.stop,isStartIncluded:true,isStopIncluded:v.isStopIncluded,data:v.data})}else{v=new s({start:d,stop:d,isStartIncluded:true,isStopIncluded:true,data:v.data})}a[l]=v}else{a.splice(l,1)}}if(l<a.length&&(o.greaterThan(d,v.start)||d.equals(v.start)&&h&&v.isStartIncluded)){i=true;a[l]=new s({start:d,stop:v.stop,isStartIncluded:!h,isStopIncluded:v.isStopIncluded,data:v.data})}if(i){this._changedEvent.raiseEvent(this)}return i};l.prototype.intersect=function(e,t,i){if(!r(e)){throw new n("other is required.")}var a=0;var u=0;var c=new l;var d=this._intervals;var f=e._intervals;while(a<d.length&&u<f.length){var h=d[a];var p=f[u];if(o.lessThan(h.stop,p.start)){++a}else if(o.lessThan(p.stop,h.start)){++u}else{if(r(i)||(r(t)&&t(h.data,p.data)||!r(t)&&p.data===h.data)){var m=s.intersect(h,p,new s,i);if(!m.isEmpty){c.addInterval(m,t)}}if(o.lessThan(h.stop,p.stop)||h.stop.equals(p.stop)&&!h.isStopIncluded&&p.isStopIncluded){++a}else{++u}}}return c};return l});define("Core/TranslationRotationScale",["./Cartesian3","./defaultValue","./defined","./Quaternion"],function(e,t,r,i){"use strict";var n=new e(1,1,1);var a=e.ZERO;var o=i.IDENTITY;var s=function(r,s,u){this.translation=e.clone(t(r,a));this.rotation=i.clone(t(s,o));this.scale=e.clone(t(u,n))};s.prototype.equals=function(t){return this===t||r(t)&&e.equals(this.translation,t.translation)&&i.equals(this.rotation,t.rotation)&&e.equals(this.scale,t.scale)};return s});define("Core/VideoSynchronizer",["./defaultValue","./defined","./defineProperties","./destroyObject","./Iso8601","./JulianDate"],function(e,t,r,i,n,a){"use strict";function o(t){t=e(t,e.EMPTY_OBJECT);this._clock=undefined;this._element=undefined;this._clockSubscription=undefined;this._seekFunction=undefined;this.clock=t.clock;this.element=t.element;this.epoch=e(t.epoch,n.MINIMUM_VALUE);this.tolerance=e(t.tolerance,1);this._seeking=false;this._seekFunction=undefined;this._firstTickAfterSeek=false}r(o.prototype,{clock:{get:function(){return this._clock},set:function(e){var r=this._clock;if(r===e){return}if(t(r)){this._clockSubscription();this._clockSubscription=undefined}if(t(e)){this._clockSubscription=e.onTick.addEventListener(o.prototype._onTick,this)}this._clock=e}},element:{get:function(){return this._element},set:function(e){var r=this._element;if(r===e){return}if(t(r)){r.removeEventListener("seeked",this._seekFunction,false)}if(t(e)){this._seeking=false;this._seekFunction=s(this);e.addEventListener("seeked",this._seekFunction,false)}this._element=e;this._seeking=false;this._firstTickAfterSeek=false}}});o.prototype.destroy=function(){this.element=undefined;this.clock=undefined;return i(this)};o.prototype.isDestroyed=function(){return false};o.prototype._onTick=function(r){var i=this._element;if(!t(i)||i.readyState<2){return}var o=i.paused;var s=r.shouldAnimate;if(s===o){if(s){i.play()}else{i.pause()}}if(this._seeking||this._firstTickAfterSeek){this._firstTickAfterSeek=false;return}i.playbackRate=r.multiplier;var u=r.currentTime;var l=e(this.epoch,n.MINIMUM_VALUE);var c=a.secondsDifference(u,l);var d=i.duration;var f;var h=i.currentTime;if(i.loop){c=c%d;if(c<0){c=d-c}f=c}else if(c>d){f=d}else if(c<0){f=0}else{f=c}var p=s?e(this.tolerance,1):.001;if(Math.abs(f-h)>p){this._seeking=true;i.currentTime=f}};function s(e){return function(){e._seeking=false;e._firstTickAfterSeek=true}}return o});define("Core/VRTheWorldTerrainProvider",["../ThirdParty/when","./Credit","./defaultValue","./defined","./defineProperties","./DeveloperError","./Ellipsoid","./Event","./GeographicTilingScheme","./getImagePixels","./HeightmapTerrainData","./loadImage","./loadXML","./Math","./Rectangle","./Request","./RequestScheduler","./RequestType","./TerrainProvider","./TileProviderError"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y){"use strict";function w(e,t){this.rectangle=e;this.maxLevel=t}function C(n){n=r(n,r.EMPTY_OBJECT);if(!i(n.url)){throw new a("options.url is required.")}this._url=n.url;if(this._url.length>0&&this._url[this._url.length-1]!=="/"){this._url+="/"}this._errorEvent=new s;this._ready=false;this._readyPromise=e.defer();this._proxy=n.proxy;this._terrainDataStructure={heightScale:1/1e3,heightOffset:-1e3,elementsPerHeight:3,stride:4,elementMultiplier:256,isBigEndian:true,lowestEncodedHeight:0,highestEncodedHeight:256*256*256-1};var l=n.credit;if(typeof l==="string"){l=new t(l)}this._credit=l;this._tilingScheme=undefined;this._rectangles=[];var c=this;var d;var m=r(n.ellipsoid,o.WGS84);function _(e){var t=e.getElementsByTagName("SRS")[0].textContent;if(t==="EPSG:4326"){c._tilingScheme=new u({ellipsoid:m})}else{C("SRS "+t+" is not supported.");return}var r=e.getElementsByTagName("TileFormat")[0];c._heightmapWidth=parseInt(r.getAttribute("width"),10);c._heightmapHeight=parseInt(r.getAttribute("height"),10);c._levelZeroMaximumGeometricError=g.getEstimatedLevelZeroGeometricErrorForAHeightmap(m,Math.min(c._heightmapWidth,c._heightmapHeight),c._tilingScheme.getNumberOfXTilesAtLevel(0));var i=e.getElementsByTagName("DataExtent");for(var n=0;n<i.length;++n){var a=i[n];var o=h.toRadians(parseFloat(a.getAttribute("minx")));var s=h.toRadians(parseFloat(a.getAttribute("miny")));var l=h.toRadians(parseFloat(a.getAttribute("maxx")));var d=h.toRadians(parseFloat(a.getAttribute("maxy")));var f=parseInt(a.getAttribute("maxlevel"),10);c._rectangles.push(new w(new p(o,s,l,d),f))}c._ready=true;c._readyPromise.resolve(true)}function C(e){var t=r(e,"An error occurred while accessing "+c._url+".");d=y.handleError(d,c,c._errorEvent,t,undefined,undefined,undefined,b)}function b(){e(v.request(c._url,f),_,C)}b()}n(C.prototype,{errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){return this._credit}},tilingScheme:{get:function(){if(!this.ready){throw new a("requestTileGeometry must not be called before ready returns true.")}return this._tilingScheme}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},hasWaterMask:{get:function(){return false}},hasVertexNormals:{get:function(){return false}}});C.prototype.requestTileGeometry=function(t,r,n,o){if(!this.ready){throw new a("requestTileGeometry must not be called before ready returns true.")}var s=this._tilingScheme.getNumberOfYTilesAtLevel(n);var u=this._url+n+"/"+t+"/"+(s-r-1)+".tif?cesium=true";var f=this._proxy;if(i(f)){u=f.getURL(u)}if(!i(o)||o===false){o=new m({defer:true})}o.url=u;o.requestFunction=d;o.type=_.TERRAIN;var h=v.schedule(o);if(!i(h)){return undefined}var p=this;return e(h,function(e){return new c({buffer:l(e),width:p._heightmapWidth,height:p._heightmapHeight,childTileMask:S(p,t,r,n),structure:p._terrainDataStructure})})};C.prototype.getLevelMaximumGeometricError=function(e){if(!this.ready){throw new a("requestTileGeometry must not be called before ready returns true.")}return this._levelZeroMaximumGeometricError/(1<<e)};var b=new p;function S(e,t,r,n){var a=e._tilingScheme;var o=e._rectangles;var s=a.tileXYToRectangle(t,r,n);var u=0;for(var l=0;l<o.length&&u!==15;++l){var c=o[l];if(c.maxLevel<=n){continue}var d=c.rectangle;var f=p.intersection(d,s,b);if(i(f)){if(E(a,d,t*2,r*2,n+1)){u|=4}if(E(a,d,t*2+1,r*2,n+1)){u|=8}if(E(a,d,t*2,r*2+1,n+1)){u|=1}if(E(a,d,t*2+1,r*2+1,n+1)){u|=2}}}return u}function E(e,t,r,n,a){var o=e.tileXYToRectangle(r,n,a);return i(p.intersection(o,t,b))}C.prototype.getTileDataAvailable=function(e,t,r){return undefined};return C});define("Core/WallGeometryLibrary",["./Cartographic","./defined","./EllipsoidTangentPlane","./Math","./PolygonPipeline","./PolylinePipeline","./WindingOrder"],function(e,t,r,i,n,a,o){"use strict";var s={};function u(e,t){return i.equalsEpsilon(e.latitude,t.latitude,i.EPSILON14)&&i.equalsEpsilon(e.longitude,t.longitude,i.EPSILON14)}var l=new e;var c=new e;function d(r,i,n,a){var o=i.length;if(o<2){return}var s=t(a);var d=t(n);var f=true;var h=new Array(o);var p=new Array(o);var m=new Array(o);var v=i[0];h[0]=v;var _=r.cartesianToCartographic(v,l);if(d){_.height=n[0]}f=f&&_.height<=0;p[0]=_.height;if(s){m[0]=a[0]}else{m[0]=0}var g=1;for(var y=1;y<o;++y){var w=i[y];var C=r.cartesianToCartographic(w,c);if(d){C.height=n[y]}f=f&&C.height<=0;if(!u(_,C)){h[g]=w;p[g]=C.height;if(s){m[g]=a[y]}else{m[g]=0}e.clone(C,_);++g}else if(_.height<C.height){p[g-1]=C.height}}if(f||g<2){return}h.length=g;p.length=g;m.length=g;return{positions:h,topHeights:p,bottomHeights:m}}var f=new Array(2);var h=new Array(2);var p={positions:undefined,height:undefined,granularity:undefined,ellipsoid:undefined};s.computePositions=function(e,s,u,l,c,m){var v=d(e,s,u,l);if(!t(v)){return}s=v.positions;u=v.topHeights;l=v.bottomHeights;if(s.length>=3){var _=r.fromPoints(s,e);var g=_.projectPointsOntoPlane(s);if(n.computeWindingOrder2D(g)===o.CLOCKWISE){s.reverse();u.reverse();l.reverse()}}var y=s.length;var w=y-2;var C;var b;var S=i.chordLength(c,e.maximumRadius);var E=p;E.minDistance=S;E.ellipsoid=e;if(m){var T=0;var x;for(x=0;x<y-1;x++){T+=a.numberOfPoints(s[x],s[x+1],S)+1}C=new Float64Array(T*3);b=new Float64Array(T*3);var A=f;var P=h;E.positions=A;E.height=P;var D=0;for(x=0;x<y-1;x++){A[0]=s[x];A[1]=s[x+1];P[0]=u[x];P[1]=u[x+1];var M=a.generateArc(E);C.set(M,D);P[0]=l[x];P[1]=l[x+1];b.set(a.generateArc(E),D);D+=M.length}}else{E.positions=s;E.height=u;C=new Float64Array(a.generateArc(E));E.height=l;b=new Float64Array(a.generateArc(E))}return{bottomPositions:b,topPositions:C,numCorners:w}};return s});define("Core/WallGeometry",["./BoundingSphere","./Cartesian3","./ComponentDatatype","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./Geometry","./GeometryAttribute","./GeometryAttributes","./IndexDatatype","./Math","./PrimitiveType","./VertexFormat","./WallGeometryLibrary"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p){"use strict";var m=new t;var v=new t;var _=new t;var g=new t;var y=new t;var w=new t;var C=new t;var b=new t;function S(e){e=i(e,i.EMPTY_OBJECT);var r=e.positions;var s=e.maximumHeights;var u=e.minimumHeights;if(!n(r)){throw new a("options.positions is required.")}if(n(s)&&s.length!==r.length){throw new a("options.positions and options.maximumHeights must have the same length.")}if(n(u)&&u.length!==r.length){throw new a("options.positions and options.minimumHeights must have the same length.")}var l=i(e.vertexFormat,h.DEFAULT);var c=i(e.granularity,d.RADIANS_PER_DEGREE);var f=i(e.ellipsoid,o.WGS84);this._positions=r;this._minimumHeights=u;this._maximumHeights=s;this._vertexFormat=h.clone(l);this._granularity=c;this._ellipsoid=o.clone(f);this._workerName="createWallGeometry";var p=1+r.length*t.packedLength+2;if(n(u)){p+=u.length}if(n(s)){p+=s.length}this.packedLength=p+o.packedLength+h.packedLength+1}S.pack=function(e,r,s){if(!n(e)){throw new a("value is required")}if(!n(r)){throw new a("array is required")}s=i(s,0);var u;var l=e._positions;var c=l.length;r[s++]=c;for(u=0;u<c;++u,s+=t.packedLength){t.pack(l[u],r,s)}var d=e._minimumHeights;c=n(d)?d.length:0;r[s++]=c;if(n(d)){for(u=0;u<c;++u){r[s++]=d[u]}}var f=e._maximumHeights;c=n(f)?f.length:0;r[s++]=c;if(n(f)){for(u=0;u<c;++u){r[s++]=f[u]}}o.pack(e._ellipsoid,r,s);s+=o.packedLength;h.pack(e._vertexFormat,r,s);s+=h.packedLength;r[s]=e._granularity;return r};var E=o.clone(o.UNIT_SPHERE);var T=new h;var x={positions:undefined,minimumHeights:undefined,maximumHeights:undefined,ellipsoid:E,vertexFormat:T,granularity:undefined};S.unpack=function(e,r,s){if(!n(e)){throw new a("array is required")}r=i(r,0);var u;var l=e[r++];var c=new Array(l);for(u=0;u<l;++u,r+=t.packedLength){c[u]=t.unpack(e,r)}l=e[r++];var d;if(l>0){d=new Array(l);for(u=0;u<l;++u){d[u]=e[r++]}}l=e[r++];var f;if(l>0){f=new Array(l);for(u=0;u<l;++u){f[u]=e[r++]}}var p=o.unpack(e,r,E);r+=o.packedLength;var m=h.unpack(e,r,T);r+=h.packedLength;var v=e[r];if(!n(s)){x.positions=c;x.minimumHeights=d;x.maximumHeights=f;x.granularity=v;return new S(x)}s._positions=c;s._minimumHeights=d;s._maximumHeights=f;s._ellipsoid=o.clone(p,s._ellipsoid);s._vertexFormat=h.clone(m,s._vertexFormat);s._granularity=v;return s};S.fromConstantHeights=function(e){e=i(e,i.EMPTY_OBJECT);var t=e.positions;if(!n(t)){throw new a("options.positions is required.")}var r;var o;var s=e.minimumHeight;var u=e.maximumHeight;var l=n(s);var c=n(u);if(l||c){var d=t.length;r=l?new Array(d):undefined;o=c?new Array(d):undefined;for(var f=0;f<d;++f){if(l){r[f]=s}if(c){o[f]=u}}}var h={positions:t,maximumHeights:o,minimumHeights:r,ellipsoid:e.ellipsoid,vertexFormat:e.vertexFormat};return new S(h)};S.createGeometry=function(i){var a=i._positions;var o=i._minimumHeights;var h=i._maximumHeights;var S=i._vertexFormat;var E=i._granularity;var T=i._ellipsoid;var x=p.computePositions(T,a,h,o,E,true);if(!n(x)){return}var A=x.bottomPositions;var P=x.topPositions;var D=x.numCorners;var M=P.length;var I=M*2;var O=S.position?new Float64Array(I):undefined;var R=S.normal?new Float32Array(I):undefined;var N=S.tangent?new Float32Array(I):undefined;var L=S.bitangent?new Float32Array(I):undefined;var B=S.st?new Float32Array(I/3*2):undefined;var F=0;var k=0;var V=0;var z=0;var U=0;var q=b;var G=C;var H=w;var W=true;M/=3;var j;var Y=0;var X=1/(M-a.length+1);for(j=0;j<M;++j){var Z=j*3;var K=t.fromArray(P,Z,m);var Q=t.fromArray(A,Z,v);if(S.position){O[F++]=Q.x;O[F++]=Q.y;O[F++]=Q.z;O[F++]=K.x;O[F++]=K.y;O[F++]=K.z}if(S.st){B[U++]=Y;B[U++]=0;B[U++]=Y;B[U++]=1}if(S.normal||S.tangent||S.bitangent){var J;var $=t.clone(t.ZERO,y);var ee=T.scaleToGeodeticSurface(t.fromArray(P,Z,v),v);if(j+1<M){J=T.scaleToGeodeticSurface(t.fromArray(P,Z+3,_),_);$=t.fromArray(P,Z+3,y)}if(W){var te=t.subtract($,K,g);var re=t.subtract(ee,K,m);q=t.normalize(t.cross(re,te,q),q);W=false}if(t.equalsEpsilon(J,ee,d.EPSILON10)){W=true}else{Y+=X;if(S.tangent){G=t.normalize(t.subtract(J,ee,G),G)}if(S.bitangent){H=t.normalize(t.cross(q,G,H),H)}}if(S.normal){R[k++]=q.x;R[k++]=q.y;R[k++]=q.z;R[k++]=q.x;R[k++]=q.y;R[k++]=q.z}if(S.tangent){N[z++]=G.x;N[z++]=G.y;N[z++]=G.z;N[z++]=G.x;N[z++]=G.y;N[z++]=G.z}if(S.bitangent){L[V++]=H.x;L[V++]=H.y;L[V++]=H.z;L[V++]=H.x;L[V++]=H.y;L[V++]=H.z}}}var ie=new l;if(S.position){ie.position=new u({componentDatatype:r.DOUBLE,componentsPerAttribute:3,values:O})}if(S.normal){ie.normal=new u({componentDatatype:r.FLOAT,componentsPerAttribute:3,values:R})}if(S.tangent){ie.tangent=new u({componentDatatype:r.FLOAT,componentsPerAttribute:3,values:N})}if(S.bitangent){ie.bitangent=new u({componentDatatype:r.FLOAT,componentsPerAttribute:3,values:L})}if(S.st){ie.st=new u({componentDatatype:r.FLOAT,componentsPerAttribute:2,values:B})}var ne=I/3;I-=6*(D+1);var ae=c.createTypedArray(ne,I);var oe=0;for(j=0;j<ne-2;j+=2){var se=j;var ue=j+2;var le=t.fromArray(O,se*3,m);var ce=t.fromArray(O,ue*3,v);if(t.equalsEpsilon(le,ce,d.EPSILON10)){continue}var de=j+1;var fe=j+3;ae[oe++]=de;ae[oe++]=se;ae[oe++]=fe;ae[oe++]=fe;ae[oe++]=se;ae[oe++]=ue}return new s({attributes:ie,indices:ae,primitiveType:f.TRIANGLES,boundingSphere:new e.fromVertices(O)})};return S})
;define("Core/WallOutlineGeometry",["./BoundingSphere","./Cartesian3","./ComponentDatatype","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./Geometry","./GeometryAttribute","./GeometryAttributes","./IndexDatatype","./Math","./PrimitiveType","./WallGeometryLibrary"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h){"use strict";var p=new t;var m=new t;function v(e){e=i(e,i.EMPTY_OBJECT);var r=e.positions;var s=e.maximumHeights;var u=e.minimumHeights;if(!n(r)){throw new a("options.positions is required.")}if(n(s)&&s.length!==r.length){throw new a("options.positions and options.maximumHeights must have the same length.")}if(n(u)&&u.length!==r.length){throw new a("options.positions and options.minimumHeights must have the same length.")}var l=i(e.granularity,d.RADIANS_PER_DEGREE);var c=i(e.ellipsoid,o.WGS84);this._positions=r;this._minimumHeights=u;this._maximumHeights=s;this._granularity=l;this._ellipsoid=o.clone(c);this._workerName="createWallOutlineGeometry";var f=1+r.length*t.packedLength+2;if(n(u)){f+=u.length}if(n(s)){f+=s.length}this.packedLength=f+o.packedLength+1}v.pack=function(e,r,s){if(!n(e)){throw new a("value is required")}if(!n(r)){throw new a("array is required")}s=i(s,0);var u;var l=e._positions;var c=l.length;r[s++]=c;for(u=0;u<c;++u,s+=t.packedLength){t.pack(l[u],r,s)}var d=e._minimumHeights;c=n(d)?d.length:0;r[s++]=c;if(n(d)){for(u=0;u<c;++u){r[s++]=d[u]}}var f=e._maximumHeights;c=n(f)?f.length:0;r[s++]=c;if(n(f)){for(u=0;u<c;++u){r[s++]=f[u]}}o.pack(e._ellipsoid,r,s);s+=o.packedLength;r[s]=e._granularity;return r};var _=o.clone(o.UNIT_SPHERE);var g={positions:undefined,minimumHeights:undefined,maximumHeights:undefined,ellipsoid:_,granularity:undefined};v.unpack=function(e,r,s){if(!n(e)){throw new a("array is required")}r=i(r,0);var u;var l=e[r++];var c=new Array(l);for(u=0;u<l;++u,r+=t.packedLength){c[u]=t.unpack(e,r)}l=e[r++];var d;if(l>0){d=new Array(l);for(u=0;u<l;++u){d[u]=e[r++]}}l=e[r++];var f;if(l>0){f=new Array(l);for(u=0;u<l;++u){f[u]=e[r++]}}var h=o.unpack(e,r,_);r+=o.packedLength;var p=e[r];if(!n(s)){g.positions=c;g.minimumHeights=d;g.maximumHeights=f;g.granularity=p;return new v(g)}s._positions=c;s._minimumHeights=d;s._maximumHeights=f;s._ellipsoid=o.clone(h,s._ellipsoid);s._granularity=p;return s};v.fromConstantHeights=function(e){e=i(e,i.EMPTY_OBJECT);var t=e.positions;if(!n(t)){throw new a("options.positions is required.")}var r;var o;var s=e.minimumHeight;var u=e.maximumHeight;var l=n(s);var c=n(u);if(l||c){var d=t.length;r=l?new Array(d):undefined;o=c?new Array(d):undefined;for(var f=0;f<d;++f){if(l){r[f]=s}if(c){o[f]=u}}}var h={positions:t,maximumHeights:o,minimumHeights:r,ellipsoid:e.ellipsoid};return new v(h)};v.createGeometry=function(i){var a=i._positions;var o=i._minimumHeights;var v=i._maximumHeights;var _=i._granularity;var g=i._ellipsoid;var y=h.computePositions(g,a,v,o,_,false);if(!n(y)){return}var w=y.bottomPositions;var C=y.topPositions;var b=C.length;var S=b*2;var E=new Float64Array(S);var T=0;b/=3;var x;for(x=0;x<b;++x){var A=x*3;var P=t.fromArray(C,A,p);var D=t.fromArray(w,A,m);E[T++]=D.x;E[T++]=D.y;E[T++]=D.z;E[T++]=P.x;E[T++]=P.y;E[T++]=P.z}var M=new l({position:new u({componentDatatype:r.DOUBLE,componentsPerAttribute:3,values:E})});var I=S/3;S=2*I-4+I;var O=c.createTypedArray(I,S);var R=0;for(x=0;x<I-2;x+=2){var N=x;var L=x+2;var B=t.fromArray(E,N*3,p);var F=t.fromArray(E,L*3,m);if(t.equalsEpsilon(B,F,d.EPSILON10)){continue}var k=x+1;var V=x+3;O[R++]=k;O[R++]=N;O[R++]=k;O[R++]=V;O[R++]=N;O[R++]=L}O[R++]=I-2;O[R++]=I-1;return new s({attributes:M,indices:O,primitiveType:f.LINES,boundingSphere:new e.fromVertices(E)})};return v});define("Core/WebMercatorTilingScheme",["./Cartesian2","./defaultValue","./defined","./defineProperties","./Ellipsoid","./Rectangle","./WebMercatorProjection"],function(e,t,r,i,n,a,o){"use strict";function s(i){i=t(i,{});this._ellipsoid=t(i.ellipsoid,n.WGS84);this._numberOfLevelZeroTilesX=t(i.numberOfLevelZeroTilesX,1);this._numberOfLevelZeroTilesY=t(i.numberOfLevelZeroTilesY,1);this._projection=new o(this._ellipsoid);if(r(i.rectangleSouthwestInMeters)&&r(i.rectangleNortheastInMeters)){this._rectangleSouthwestInMeters=i.rectangleSouthwestInMeters;this._rectangleNortheastInMeters=i.rectangleNortheastInMeters}else{var s=this._ellipsoid.maximumRadius*Math.PI;this._rectangleSouthwestInMeters=new e(-s,-s);this._rectangleNortheastInMeters=new e(s,s)}var u=this._projection.unproject(this._rectangleSouthwestInMeters);var l=this._projection.unproject(this._rectangleNortheastInMeters);this._rectangle=new a(u.longitude,u.latitude,l.longitude,l.latitude)}i(s.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},rectangle:{get:function(){return this._rectangle}},projection:{get:function(){return this._projection}}});s.prototype.getNumberOfXTilesAtLevel=function(e){return this._numberOfLevelZeroTilesX<<e};s.prototype.getNumberOfYTilesAtLevel=function(e){return this._numberOfLevelZeroTilesY<<e};s.prototype.rectangleToNativeRectangle=function(e,t){var i=this._projection;var n=i.project(a.southwest(e));var o=i.project(a.northeast(e));if(!r(t)){return new a(n.x,n.y,o.x,o.y)}t.west=n.x;t.south=n.y;t.east=o.x;t.north=o.y;return t};s.prototype.tileXYToNativeRectangle=function(e,t,i,n){var o=this.getNumberOfXTilesAtLevel(i);var s=this.getNumberOfYTilesAtLevel(i);var u=(this._rectangleNortheastInMeters.x-this._rectangleSouthwestInMeters.x)/o;var l=this._rectangleSouthwestInMeters.x+e*u;var c=this._rectangleSouthwestInMeters.x+(e+1)*u;var d=(this._rectangleNortheastInMeters.y-this._rectangleSouthwestInMeters.y)/s;var f=this._rectangleNortheastInMeters.y-t*d;var h=this._rectangleNortheastInMeters.y-(t+1)*d;if(!r(n)){return new a(l,h,c,f)}n.west=l;n.south=h;n.east=c;n.north=f;return n};s.prototype.tileXYToRectangle=function(t,r,i,n){var a=this.tileXYToNativeRectangle(t,r,i,n);var o=this._projection;var s=o.unproject(new e(a.west,a.south));var u=o.unproject(new e(a.east,a.north));a.west=s.longitude;a.south=s.latitude;a.east=u.longitude;a.north=u.latitude;return a};s.prototype.positionToTileXY=function(t,i,n){var o=this._rectangle;if(!a.contains(o,t)){return undefined}var s=this.getNumberOfXTilesAtLevel(i);var u=this.getNumberOfYTilesAtLevel(i);var l=this._rectangleNortheastInMeters.x-this._rectangleSouthwestInMeters.x;var c=l/s;var d=this._rectangleNortheastInMeters.y-this._rectangleSouthwestInMeters.y;var f=d/u;var h=this._projection;var p=h.project(t);var m=p.x-this._rectangleSouthwestInMeters.x;var v=this._rectangleNortheastInMeters.y-p.y;var _=m/c|0;if(_>=s){_=s-1}var g=v/f|0;if(g>=u){g=u-1}if(!r(n)){return new e(_,g)}n.x=_;n.y=g;return n};return s});define("Core/wrapFunction",["./DeveloperError"],function(e){"use strict";function t(t,r,i){if(typeof r!=="function"){throw new e("oldFunction is required to be a function.")}if(typeof i!=="function"){throw new e("oldFunction is required to be a function.")}return function(){i.apply(t,arguments);r.apply(t,arguments)}}return t});define("DataSources/ConstantProperty",["../Core/defined","../Core/defineProperties","../Core/Event"],function(e,t,r){"use strict";function i(e){this._value=undefined;this._hasClone=false;this._hasEquals=false;this._definitionChanged=new r;this.setValue(e)}t(i.prototype,{isConstant:{value:true},definitionChanged:{get:function(){return this._definitionChanged}}});i.prototype.getValue=function(e,t){return this._hasClone?this._value.clone(t):this._value};i.prototype.setValue=function(t){var r=this._value;if(r!==t){var i=e(t);var n=i&&typeof t.clone==="function";var a=i&&typeof t.equals==="function";this._hasClone=n;this._hasEquals=a;var o=!a||!t.equals(r);if(o){this._value=!n?t:t.clone();this._definitionChanged.raiseEvent(this)}}};i.prototype.equals=function(e){return this===e||e instanceof i&&(!this._hasEquals&&this._value===e._value||this._hasEquals&&this._value.equals(e._value))};return i});define("DataSources/createPropertyDescriptor",["../Core/defaultValue","../Core/defined","./ConstantProperty"],function(e,t,r){"use strict";function i(e,r,i,n,a){return{configurable:n,get:function(){return this[r]},set:function(n){var o=this[r];var s=this[i];if(t(s)){s();this[i]=undefined}var u=t(n);if(u&&!t(n.getValue)&&t(a)){n=a(n)}if(o!==n){this[r]=n;this._definitionChanged.raiseEvent(this,e,n,o)}if(t(n)&&t(n.definitionChanged)){this[i]=n.definitionChanged.addEventListener(function(){this._definitionChanged.raiseEvent(this,e,n,n)},this)}}}}function n(e){return new r(e)}function a(t,r,a){return i(t,"_"+t.toString(),"_"+t.toString()+"Subscription",e(r,false),e(a,n))}return a});define("DataSources/BillboardGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createPropertyDescriptor"],function(e,t,r,i,n,a){"use strict";function o(t){this._image=undefined;this._imageSubscription=undefined;this._imageSubRegion=undefined;this._imageSubRegionSubscription=undefined;this._width=undefined;this._widthSubscription=undefined;this._height=undefined;this._heightSubscription=undefined;this._scale=undefined;this._scaleSubscription=undefined;this._rotation=undefined;this._rotationSubscription=undefined;this._alignedAxis=undefined;this._alignedAxisSubscription=undefined;this._horizontalOrigin=undefined;this._horizontalOriginSubscription=undefined;this._verticalOrigin=undefined;this._verticalOriginSubscription=undefined;this._color=undefined;this._colorSubscription=undefined;this._eyeOffset=undefined;this._eyeOffsetSubscription=undefined;this._heightReference=undefined;this._heightReferenceSubscription=undefined;this._pixelOffset=undefined;this._pixelOffsetSubscription=undefined;this._show=undefined;this._showSubscription=undefined;this._scaleByDistance=undefined;this._scaleByDistanceSubscription=undefined;this._translucencyByDistance=undefined;this._translucencyByDistanceSubscription=undefined;this._pixelOffsetScaleByDistance=undefined;this._pixelOffsetScaleByDistanceSubscription=undefined;this._sizeInMeters=undefined;this._sizeInMetersSubscription=undefined;this._distanceDisplayCondition=undefined;this._distanceDisplayConditionSubscription=undefined;this._definitionChanged=new n;this.merge(e(t,e.EMPTY_OBJECT))}r(o.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},image:a("image"),imageSubRegion:a("imageSubRegion"),scale:a("scale"),rotation:a("rotation"),alignedAxis:a("alignedAxis"),horizontalOrigin:a("horizontalOrigin"),verticalOrigin:a("verticalOrigin"),color:a("color"),eyeOffset:a("eyeOffset"),heightReference:a("heightReference"),pixelOffset:a("pixelOffset"),show:a("show"),width:a("width"),height:a("height"),scaleByDistance:a("scaleByDistance"),translucencyByDistance:a("translucencyByDistance"),pixelOffsetScaleByDistance:a("pixelOffsetScaleByDistance"),sizeInMeters:a("sizeInMeters"),distanceDisplayCondition:a("distanceDisplayCondition")});o.prototype.clone=function(e){if(!t(e)){return new o(this)}e.color=this._color;e.eyeOffset=this._eyeOffset;e.heightReference=this._heightReference;e.horizontalOrigin=this._horizontalOrigin;e.image=this._image;e.imageSubRegion=this._imageSubRegion;e.pixelOffset=this._pixelOffset;e.scale=this._scale;e.rotation=this._rotation;e.alignedAxis=this._alignedAxis;e.show=this._show;e.verticalOrigin=this._verticalOrigin;e.width=this._width;e.height=this._height;e.scaleByDistance=this._scaleByDistance;e.translucencyByDistance=this._translucencyByDistance;e.pixelOffsetScaleByDistance=this._pixelOffsetScaleByDistance;e.sizeInMeters=this._sizeInMeters;e.distanceDisplayCondition=this._distanceDisplayCondition;return e};o.prototype.merge=function(r){if(!t(r)){throw new i("source is required.")}this.color=e(this._color,r.color);this.eyeOffset=e(this._eyeOffset,r.eyeOffset);this.heightReference=e(this._heightReference,r.heightReference);this.horizontalOrigin=e(this._horizontalOrigin,r.horizontalOrigin);this.image=e(this._image,r.image);this.imageSubRegion=e(this._imageSubRegion,r.imageSubRegion);this.pixelOffset=e(this._pixelOffset,r.pixelOffset);this.scale=e(this._scale,r.scale);this.rotation=e(this._rotation,r.rotation);this.alignedAxis=e(this._alignedAxis,r.alignedAxis);this.show=e(this._show,r.show);this.verticalOrigin=e(this._verticalOrigin,r.verticalOrigin);this.width=e(this._width,r.width);this.height=e(this._height,r.height);this.scaleByDistance=e(this._scaleByDistance,r.scaleByDistance);this.translucencyByDistance=e(this._translucencyByDistance,r.translucencyByDistance);this.pixelOffsetScaleByDistance=e(this._pixelOffsetScaleByDistance,r.pixelOffsetScaleByDistance);this.sizeInMeters=e(this._sizeInMeters,r.sizeInMeters);this.distanceDisplayCondition=e(this._distanceDisplayCondition,r.distanceDisplayCondition)};return o});define("Scene/HeightReference",["../Core/freezeObject"],function(e){"use strict";var t={NONE:0,CLAMP_TO_GROUND:1,RELATIVE_TO_GROUND:2};return e(t)});define("Scene/HorizontalOrigin",["../Core/freezeObject"],function(e){"use strict";var t={CENTER:0,LEFT:1,RIGHT:-1};return e(t)});define("Scene/VerticalOrigin",["../Core/freezeObject"],function(e){"use strict";var t={CENTER:0,BOTTOM:1,BASELINE:2,TOP:-1};return e(t)});define("DataSources/BoundingSphereState",["../Core/freezeObject"],function(e){"use strict";var t={DONE:0,PENDING:1,FAILED:2};return e(t)});define("DataSources/Property",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError"],function(e,t,r,i){"use strict";function n(){i.throwInstantiationError()}r(n.prototype,{isConstant:{get:i.throwInstantiationError},definitionChanged:{get:i.throwInstantiationError}});n.prototype.getValue=i.throwInstantiationError;n.prototype.equals=i.throwInstantiationError;n.equals=function(e,r){return e===r||t(e)&&e.equals(r)};n.arrayEquals=function(e,r){if(e===r){return true}if(!t(e)||!t(r)||e.length!==r.length){return false}var i=e.length;for(var a=0;a<i;a++){if(!n.equals(e[a],r[a])){return false}}return true};n.isConstant=function(e){return!t(e)||e.isConstant};n.getValueOrUndefined=function(e,r,i){return t(e)?e.getValue(r,i):undefined};n.getValueOrDefault=function(r,i,n,a){return t(r)?e(r.getValue(i,a),n):n};n.getValueOrClonedDefault=function(e,r,i,n){var a;if(t(e)){a=e.getValue(r,n)}if(!t(a)){a=i.clone(a)}return a};return n});define("DataSources/BillboardVisualizer",["../Core/AssociativeArray","../Core/BoundingRectangle","../Core/Cartesian2","../Core/Cartesian3","../Core/Color","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/NearFarScalar","../Scene/HeightReference","../Scene/HorizontalOrigin","../Scene/VerticalOrigin","./BoundingSphereState","./Property"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p){"use strict";var m=n.WHITE;var v=i.ZERO;var _=c.NONE;var g=r.ZERO;var y=1;var w=0;var C=i.ZERO;var b=d.CENTER;var S=f.CENTER;var E=false;var T=new i;var x=new n;var A=new i;var P=new r;var D=new l;var M=new l;var I=new l;var O=new t;var R=new u;function N(e){this.entity=e;this.billboard=undefined;this.textureValue=undefined}function L(t,r){if(!a(t)){throw new s("entityCluster is required.")}if(!a(r)){throw new s("entityCollection is required.")}r.collectionChanged.addEventListener(L.prototype._onCollectionChanged,this);this._cluster=t;this._entityCollection=r;this._items=new e;this._onCollectionChanged(r,r.values,[],[])}L.prototype.update=function(e){if(!a(e)){throw new s("time is required.")}var t=this._items.values;var r=this._cluster;for(var i=0,n=t.length;i<n;i++){var o=t[i];var u=o.entity;var l=u._billboard;var c;var d=o.billboard;var f=u.isShowing&&u.isAvailable(e)&&p.getValueOrDefault(l._show,e,true);if(f){T=p.getValueOrUndefined(u._position,e,T);c=p.getValueOrUndefined(l._image,e);f=a(T)&&a(c)}if(!f){B(o,u,r);continue}if(!p.isConstant(u._position)){r._clusterDirty=true}if(!a(d)){d=r.getBillboard(u);d.id=u;d.image=undefined;o.billboard=d}d.show=f;if(!a(d.image)||o.textureValue!==c){d.image=c;o.textureValue=c}d.position=T;d.color=p.getValueOrDefault(l._color,e,m,x);d.eyeOffset=p.getValueOrDefault(l._eyeOffset,e,v,A);d.heightReference=p.getValueOrDefault(l._heightReference,e,_);d.pixelOffset=p.getValueOrDefault(l._pixelOffset,e,g,P);d.scale=p.getValueOrDefault(l._scale,e,y);d.rotation=p.getValueOrDefault(l._rotation,e,w);d.alignedAxis=p.getValueOrDefault(l._alignedAxis,e,C);d.horizontalOrigin=p.getValueOrDefault(l._horizontalOrigin,e,b);d.verticalOrigin=p.getValueOrDefault(l._verticalOrigin,e,S);d.width=p.getValueOrUndefined(l._width,e);d.height=p.getValueOrUndefined(l._height,e);d.scaleByDistance=p.getValueOrUndefined(l._scaleByDistance,e,D);d.translucencyByDistance=p.getValueOrUndefined(l._translucencyByDistance,e,M);d.pixelOffsetScaleByDistance=p.getValueOrUndefined(l._pixelOffsetScaleByDistance,e,I);d.sizeInMeters=p.getValueOrDefault(l._sizeInMeters,E);d.distanceDisplayCondition=p.getValueOrUndefined(l._distanceDisplayCondition,e,R);var h=p.getValueOrUndefined(l._imageSubRegion,e,O);if(a(h)){d.setImageSubRegion(d._imageId,h)}}return true};L.prototype.getBoundingSphere=function(e,t){if(!a(e)){throw new s("entity is required.")}if(!a(t)){throw new s("result is required.")}var r=this._items.get(e.id);if(!a(r)||!a(r.billboard)){return h.FAILED}var n=r.billboard;if(n.heightReference===c.NONE){t.center=i.clone(n.position,t.center)}else{if(!a(n._clampedPosition)){return h.PENDING}t.center=i.clone(n._clampedPosition,t.center)}t.radius=0;return h.DONE};L.prototype.isDestroyed=function(){return false};L.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(L.prototype._onCollectionChanged,this);var e=this._entityCollection.values;for(var t=0;t<e.length;t++){this._cluster.removeBillboard(e[t])}return o(this)};L.prototype._onCollectionChanged=function(e,t,r,i){var n;var o;var s=this._items;var u=this._cluster;for(n=t.length-1;n>-1;n--){o=t[n];if(a(o._billboard)&&a(o._position)){s.set(o.id,new N(o))}}for(n=i.length-1;n>-1;n--){o=i[n];if(a(o._billboard)&&a(o._position)){if(!s.contains(o.id)){s.set(o.id,new N(o))}}else{B(s.get(o.id),o,u);s.remove(o.id)}}for(n=r.length-1;n>-1;n--){o=r[n];B(s.get(o.id),o,u);s.remove(o.id)}};function B(e,t,r){if(a(e)){e.billboard=undefined;r.removeBillboard(t)}}return L});define("Shaders/Appearances/AllMaterialAppearanceFS",[],function(){"use strict";return"varying vec3 v_positionEC;\nvarying vec3 v_normalEC;\nvarying vec3 v_tangentEC;\nvarying vec3 v_bitangentEC;\nvarying vec2 v_st;\nvoid main()\n{\nvec3 positionToEyeEC = -v_positionEC;\nmat3 tangentToEyeMatrix = czm_tangentToEyeSpaceMatrix(v_normalEC, v_tangentEC, v_bitangentEC);\nvec3 normalEC = normalize(v_normalEC);\n#ifdef FACE_FORWARD\nnormalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);\n#endif\nczm_materialInput materialInput;\nmaterialInput.normalEC = normalEC;\nmaterialInput.tangentToEyeMatrix = tangentToEyeMatrix;\nmaterialInput.positionToEyeEC = positionToEyeEC;\nmaterialInput.st = v_st;\nczm_material material = czm_getMaterial(materialInput);\n#ifdef FLAT\ngl_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n#else\ngl_FragColor = czm_phong(normalize(positionToEyeEC), material);\n#endif\n}\n"});define("Shaders/Appearances/AllMaterialAppearanceVS",[],function(){"use strict";return"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec3 normal;\nattribute vec3 tangent;\nattribute vec3 bitangent;\nattribute vec2 st;\nattribute float batchId;\nvarying vec3 v_positionEC;\nvarying vec3 v_normalEC;\nvarying vec3 v_tangentEC;\nvarying vec3 v_bitangentEC;\nvarying vec2 v_st;\nvoid main()\n{\nvec4 p = czm_computePosition();\nv_positionEC = (czm_modelViewRelativeToEye * p).xyz;\nv_normalEC = czm_normal * normal;\nv_tangentEC = czm_normal * tangent;\nv_bitangentEC = czm_normal * bitangent;\nv_st = st;\ngl_Position = czm_modelViewProjectionRelativeToEye * p;\n}\n"});define("Shaders/Appearances/BasicMaterialAppearanceFS",[],function(){"use strict";return"varying vec3 v_positionEC;\nvarying vec3 v_normalEC;\nvoid main()\n{\nvec3 positionToEyeEC = -v_positionEC;\nvec3 normalEC = normalize(v_normalEC);\n#ifdef FACE_FORWARD\nnormalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);\n#endif\nczm_materialInput materialInput;\nmaterialInput.normalEC = normalEC;\nmaterialInput.positionToEyeEC = positionToEyeEC;\nczm_material material = czm_getMaterial(materialInput);\n#ifdef FLAT\ngl_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n#else\ngl_FragColor = czm_phong(normalize(positionToEyeEC), material);\n#endif\n}\n"});define("Shaders/Appearances/BasicMaterialAppearanceVS",[],function(){"use strict";return"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec3 normal;\nattribute float batchId;\nvarying vec3 v_positionEC;\nvarying vec3 v_normalEC;\nvoid main()\n{\nvec4 p = czm_computePosition();\nv_positionEC = (czm_modelViewRelativeToEye * p).xyz;\nv_normalEC = czm_normal * normal;\ngl_Position = czm_modelViewProjectionRelativeToEye * p;\n}\n"});define("Shaders/Appearances/TexturedMaterialAppearanceFS",[],function(){"use strict";return"varying vec3 v_positionEC;\nvarying vec3 v_normalEC;\nvarying vec2 v_st;\nvoid main()\n{\nvec3 positionToEyeEC = -v_positionEC;\nvec3 normalEC = normalize(v_normalEC);;\n#ifdef FACE_FORWARD\nnormalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);\n#endif\nczm_materialInput materialInput;\nmaterialInput.normalEC = normalEC;\nmaterialInput.positionToEyeEC = positionToEyeEC;\nmaterialInput.st = v_st;\nczm_material material = czm_getMaterial(materialInput);\n#ifdef FLAT\ngl_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n#else\ngl_FragColor = czm_phong(normalize(positionToEyeEC), material);\n#endif\n}\n"});define("Shaders/Appearances/TexturedMaterialAppearanceVS",[],function(){"use strict";return"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec3 normal;\nattribute vec2 st;\nattribute float batchId;\nvarying vec3 v_positionEC;\nvarying vec3 v_normalEC;\nvarying vec2 v_st;\nvoid main()\n{\nvec4 p = czm_computePosition();\nv_positionEC = (czm_modelViewRelativeToEye * p).xyz;\nv_normalEC = czm_normal * normal;\nv_st = st;\ngl_Position = czm_modelViewProjectionRelativeToEye * p;\n}\n"});define("Scene/BlendEquation",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";var r={ADD:t.FUNC_ADD,SUBTRACT:t.FUNC_SUBTRACT,REVERSE_SUBTRACT:t.FUNC_REVERSE_SUBTRACT};return e(r)});define("Scene/BlendFunction",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";var r={ZERO:t.ZERO,ONE:t.ONE,SOURCE_COLOR:t.SRC_COLOR,ONE_MINUS_SOURCE_COLOR:t.ONE_MINUS_SRC_COLOR,DESTINATION_COLOR:t.DST_COLOR,ONE_MINUS_DESTINATION_COLOR:t.ONE_MINUS_DST_COLOR,SOURCE_ALPHA:t.SRC_ALPHA,ONE_MINUS_SOURCE_ALPHA:t.ONE_MINUS_SRC_ALPHA,DESTINATION_ALPHA:t.DST_ALPHA,ONE_MINUS_DESTINATION_ALPHA:t.ONE_MINUS_DST_ALPHA,CONSTANT_COLOR:t.CONSTANT_COLOR,ONE_MINUS_CONSTANT_COLOR:t.ONE_MINUS_CONSTANT_ALPHA,CONSTANT_ALPHA:t.CONSTANT_ALPHA,ONE_MINUS_CONSTANT_ALPHA:t.ONE_MINUS_CONSTANT_ALPHA,SOURCE_ALPHA_SATURATE:t.SRC_ALPHA_SATURATE};return e(r)});define("Scene/BlendingState",["../Core/freezeObject","./BlendEquation","./BlendFunction"],function(e,t,r){"use strict";var i={DISABLED:e({enabled:false}),ALPHA_BLEND:e({enabled:true,equationRgb:t.ADD,equationAlpha:t.ADD,functionSourceRgb:r.SOURCE_ALPHA,functionSourceAlpha:r.SOURCE_ALPHA,functionDestinationRgb:r.ONE_MINUS_SOURCE_ALPHA,functionDestinationAlpha:r.ONE_MINUS_SOURCE_ALPHA}),PRE_MULTIPLIED_ALPHA_BLEND:e({enabled:true,equationRgb:t.ADD,equationAlpha:t.ADD,functionSourceRgb:r.ONE,functionSourceAlpha:r.ONE,functionDestinationRgb:r.ONE_MINUS_SOURCE_ALPHA,functionDestinationAlpha:r.ONE_MINUS_SOURCE_ALPHA}),ADDITIVE_BLEND:e({enabled:true,equationRgb:t.ADD,equationAlpha:t.ADD,functionSourceRgb:r.SOURCE_ALPHA,functionSourceAlpha:r.SOURCE_ALPHA,functionDestinationRgb:r.ONE,functionDestinationAlpha:r.ONE})};return e(i)});define("Scene/CullFace",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";var r={FRONT:t.FRONT,BACK:t.BACK,FRONT_AND_BACK:t.FRONT_AND_BACK};return e(r)});define("Scene/Appearance",["../Core/clone","../Core/combine","../Core/defaultValue","../Core/defined","../Core/defineProperties","./BlendingState","./CullFace"],function(e,t,r,i,n,a,o){"use strict";function s(e){e=r(e,r.EMPTY_OBJECT);this.material=e.material;this.translucent=r(e.translucent,true);this._vertexShaderSource=e.vertexShaderSource;this._fragmentShaderSource=e.fragmentShaderSource;this._renderState=e.renderState;this._closed=r(e.closed,false)}n(s.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}}});s.prototype.getFragmentShaderSource=function(){var e=[];if(this.flat){e.push("#define FLAT")}if(this.faceForward){e.push("#define FACE_FORWARD")}if(i(this.material)){e.push(this.material.shaderSource)}e.push(this.fragmentShaderSource);return e.join("\n")};s.prototype.isTranslucent=function(){return i(this.material)&&this.material.isTranslucent()||!i(this.material)&&this.translucent};s.prototype.getRenderState=function(){var t=this.isTranslucent();var r=e(this.renderState,false);if(t){r.depthMask=false;r.blending=a.ALPHA_BLEND}else{r.depthMask=true}return r};s.getDefaultRenderState=function(e,r,n){var s={depthTest:{enabled:true}};if(e){s.depthMask=false;s.blending=a.ALPHA_BLEND}if(r){s.cull={enabled:true,face:o.BACK}}if(i(n)){s=t(n,s,true)}return s};return s});define("Renderer/ContextLimits",["../Core/defineProperties"],function(e){"use strict";var t={_maximumCombinedTextureImageUnits:0,_maximumCubeMapSize:0,_maximumFragmentUniformVectors:0,_maximumTextureImageUnits:0,_maximumRenderbufferSize:0,_maximumTextureSize:0,_maximumVaryingVectors:0,_maximumVertexAttributes:0,_maximumVertexTextureImageUnits:0,_maximumVertexUniformVectors:0,_minimumAliasedLineWidth:0,_maximumAliasedLineWidth:0,_minimumAliasedPointSize:0,_maximumAliasedPointSize:0,_maximumViewportWidth:0,_maximumViewportHeight:0,_maximumTextureFilterAnisotropy:0,_maximumDrawBuffers:0,_maximumColorAttachments:0,_highpFloatSupported:false,_highpIntSupported:false};e(t,{maximumCombinedTextureImageUnits:{get:function(){return t._maximumCombinedTextureImageUnits}},maximumCubeMapSize:{get:function(){return t._maximumCubeMapSize}},maximumFragmentUniformVectors:{get:function(){return t._maximumFragmentUniformVectors}},maximumTextureImageUnits:{get:function(){return t._maximumTextureImageUnits}},maximumRenderbufferSize:{get:function(){return t._maximumRenderbufferSize}},maximumTextureSize:{get:function(){return t._maximumTextureSize}},maximumVaryingVectors:{get:function(){return t._maximumVaryingVectors}},maximumVertexAttributes:{get:function(){return t._maximumVertexAttributes}},maximumVertexTextureImageUnits:{get:function(){return t._maximumVertexTextureImageUnits}},maximumVertexUniformVectors:{get:function(){return t._maximumVertexUniformVectors}},minimumAliasedLineWidth:{get:function(){return t._minimumAliasedLineWidth}},maximumAliasedLineWidth:{get:function(){return t._maximumAliasedLineWidth}},minimumAliasedPointSize:{get:function(){return t._minimumAliasedPointSize}},maximumAliasedPointSize:{get:function(){return t._maximumAliasedPointSize}},maximumViewportWidth:{get:function(){return t._maximumViewportWidth}},maximumViewportHeight:{get:function(){return t._maximumViewportHeight}},maximumTextureFilterAnisotropy:{get:function(){return t._maximumTextureFilterAnisotropy}},maximumDrawBuffers:{get:function(){return t._maximumDrawBuffers}},maximumColorAttachments:{get:function(){return t._maximumColorAttachments}},highpFloatSupported:{get:function(){return t._highpFloatSupported}},highpIntSupported:{get:function(){return t._highpIntSupported}}});return t});define("Renderer/CubeMapFace",["../Core/defaultValue","../Core/defineProperties","../Core/DeveloperError","./PixelDatatype"],function(e,t,r,i){"use strict";function n(e,t,r,i,n,a,o,s,u){this._gl=e;this._texture=t;this._textureTarget=r;this._targetFace=i;this._pixelFormat=n;this._pixelDatatype=a;this._size=o;this._preMultiplyAlpha=s;this._flipY=u}t(n.prototype,{pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},_target:{get:function(){return this._targetFace}}});n.prototype.copyFrom=function(t,i,n){i=e(i,0);n=e(n,0);if(!t){throw new r("source is required.")}if(i<0){throw new r("xOffset must be greater than or equal to zero.")}if(n<0){throw new r("yOffset must be greater than or equal to zero.")}if(i+t.width>this._size){throw new r("xOffset + source.width must be less than or equal to width.")}if(n+t.height>this._size){throw new r("yOffset + source.height must be less than or equal to height.")}var a=this._gl;var o=this._textureTarget;a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this._preMultiplyAlpha);a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,this._flipY);a.activeTexture(a.TEXTURE0);a.bindTexture(o,this._texture);if(t.arrayBufferView){a.texSubImage2D(this._targetFace,0,i,n,t.width,t.height,this._pixelFormat,this._pixelDatatype,t.arrayBufferView)}else{a.texSubImage2D(this._targetFace,0,i,n,this._pixelFormat,this._pixelDatatype,t)}a.bindTexture(o,null)};n.prototype.copyFromFramebuffer=function(t,n,a,o,s,u){t=e(t,0);n=e(n,0);a=e(a,0);o=e(o,0);s=e(s,this._size);u=e(u,this._size);if(t<0){throw new r("xOffset must be greater than or equal to zero.")}if(n<0){throw new r("yOffset must be greater than or equal to zero.")}if(a<0){throw new r("framebufferXOffset must be greater than or equal to zero.")}if(o<0){throw new r("framebufferYOffset must be greater than or equal to zero.")}if(t+s>this._size){throw new r("xOffset + source.width must be less than or equal to width.")}if(n+u>this._size){throw new r("yOffset + source.height must be less than or equal to height.")}if(this._pixelDatatype===i.FLOAT){throw new r("Cannot call copyFromFramebuffer when the texture pixel data type is FLOAT.")}var l=this._gl;var c=this._textureTarget;l.activeTexture(l.TEXTURE0);l.bindTexture(c,this._texture);l.copyTexSubImage2D(this._targetFace,0,t,n,a,o,s,u);l.bindTexture(c,null)};return n});define("Renderer/MipmapHint",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";var r={DONT_CARE:t.DONT_CARE,FASTEST:t.FASTEST,NICEST:t.NICEST,validate:function(e){return e===r.DONT_CARE||e===r.FASTEST||e===r.NICEST}};return e(r)});define("Renderer/TextureMagnificationFilter",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";var r={NEAREST:t.NEAREST,LINEAR:t.LINEAR,validate:function(e){return e===r.NEAREST||e===r.LINEAR}};return e(r)});define("Renderer/TextureMinificationFilter",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";var r={NEAREST:t.NEAREST,LINEAR:t.LINEAR,NEAREST_MIPMAP_NEAREST:t.NEAREST_MIPMAP_NEAREST,LINEAR_MIPMAP_NEAREST:t.LINEAR_MIPMAP_NEAREST,NEAREST_MIPMAP_LINEAR:t.NEAREST_MIPMAP_LINEAR,LINEAR_MIPMAP_LINEAR:t.LINEAR_MIPMAP_LINEAR,validate:function(e){return e===r.NEAREST||e===r.LINEAR||e===r.NEAREST_MIPMAP_NEAREST||e===r.LINEAR_MIPMAP_NEAREST||e===r.NEAREST_MIPMAP_LINEAR||e===r.LINEAR_MIPMAP_LINEAR}};return e(r)});define("Renderer/TextureWrap",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";var r={CLAMP_TO_EDGE:t.CLAMP_TO_EDGE,REPEAT:t.REPEAT,MIRRORED_REPEAT:t.MIRRORED_REPEAT,validate:function(e){return e===r.CLAMP_TO_EDGE||e===r.REPEAT||e===r.MIRRORED_REPEAT}};return e(r)});define("Renderer/Sampler",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","./TextureMagnificationFilter","./TextureMinificationFilter","./TextureWrap"],function(e,t,r,i,n,a,o){"use strict";function s(r){r=e(r,e.EMPTY_OBJECT);var s=e(r.wrapS,o.CLAMP_TO_EDGE);var u=e(r.wrapT,o.CLAMP_TO_EDGE);var l=e(r.minificationFilter,a.LINEAR);var c=e(r.magnificationFilter,n.LINEAR);var d=t(r.maximumAnisotropy)?r.maximumAnisotropy:1;if(!o.validate(s)){
throw new i("Invalid sampler.wrapS.")}if(!o.validate(u)){throw new i("Invalid sampler.wrapT.")}if(!a.validate(l)){throw new i("Invalid sampler.minificationFilter.")}if(!n.validate(c)){throw new i("Invalid sampler.magnificationFilter.")}if(d<1){throw new i("sampler.maximumAnisotropy must be greater than or equal to one.")}this._wrapS=s;this._wrapT=u;this._minificationFilter=l;this._magnificationFilter=c;this._maximumAnisotropy=d}r(s.prototype,{wrapS:{get:function(){return this._wrapS}},wrapT:{get:function(){return this._wrapT}},minificationFilter:{get:function(){return this._minificationFilter}},magnificationFilter:{get:function(){return this._magnificationFilter}},maximumAnisotropy:{get:function(){return this._maximumAnisotropy}}});return s});define("Renderer/CubeMap",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/Math","../Core/PixelFormat","./ContextLimits","./CubeMapFace","./MipmapHint","./PixelDatatype","./Sampler","./TextureMagnificationFilter","./TextureMinificationFilter"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h){"use strict";function p(r){r=e(r,e.EMPTY_OBJECT);if(!t(r.context)){throw new n("options.context is required.")}var i=r.context;var a=r.source;var l;var f;if(t(a)){var h=[a.positiveX,a.negativeX,a.positiveY,a.negativeY,a.positiveZ,a.negativeZ];if(!h[0]||!h[1]||!h[2]||!h[3]||!h[4]||!h[5]){throw new n("options.source requires positiveX, negativeX, positiveY, negativeY, positiveZ, and negativeZ faces.")}l=h[0].width;f=h[0].height;for(var p=1;p<6;++p){if(Number(h[p].width)!==l||Number(h[p].height)!==f){throw new n("Each face in options.source must have the same width and height.")}}}else{l=r.width;f=r.height}var m=l;var v=e(r.pixelFormat,o.RGBA);var _=e(r.pixelDatatype,c.UNSIGNED_BYTE);if(!t(l)||!t(f)){throw new n("options requires a source field to create an initialized cube map or width and height fields to create a blank cube map.")}if(l!==f){throw new n("Width must equal height.")}if(m<=0){throw new n("Width and height must be greater than zero.")}if(m>s.maximumCubeMapSize){throw new n("Width and height must be less than or equal to the maximum cube map size ("+s.maximumCubeMapSize+").  Check maximumCubeMapSize.")}if(!o.validate(v)){throw new n("Invalid options.pixelFormat.")}if(o.isDepthFormat(v)){throw new n("options.pixelFormat cannot be DEPTH_COMPONENT or DEPTH_STENCIL.")}if(!c.validate(_)){throw new n("Invalid options.pixelDatatype.")}if(_===c.FLOAT&&!i.floatingPointTexture){throw new n("When options.pixelDatatype is FLOAT, this WebGL implementation must support the OES_texture_float extension.")}var g=o.textureSizeInBytes(v,_,m,m)*6;var y=r.preMultiplyAlpha||(v===o.RGB||v===o.LUMINANCE);var w=e(r.flipY,true);var C=i._gl;var b=C.TEXTURE_CUBE_MAP;var S=C.createTexture();C.activeTexture(C.TEXTURE0);C.bindTexture(b,S);function E(e,t){if(t.arrayBufferView){C.texImage2D(e,0,v,m,m,0,v,_,t.arrayBufferView)}else{C.texImage2D(e,0,v,v,_,t)}}if(t(a)){C.pixelStorei(C.UNPACK_PREMULTIPLY_ALPHA_WEBGL,y);C.pixelStorei(C.UNPACK_FLIP_Y_WEBGL,w);E(C.TEXTURE_CUBE_MAP_POSITIVE_X,a.positiveX);E(C.TEXTURE_CUBE_MAP_NEGATIVE_X,a.negativeX);E(C.TEXTURE_CUBE_MAP_POSITIVE_Y,a.positiveY);E(C.TEXTURE_CUBE_MAP_NEGATIVE_Y,a.negativeY);E(C.TEXTURE_CUBE_MAP_POSITIVE_Z,a.positiveZ);E(C.TEXTURE_CUBE_MAP_NEGATIVE_Z,a.negativeZ)}else{C.texImage2D(C.TEXTURE_CUBE_MAP_POSITIVE_X,0,v,m,m,0,v,_,null);C.texImage2D(C.TEXTURE_CUBE_MAP_NEGATIVE_X,0,v,m,m,0,v,_,null);C.texImage2D(C.TEXTURE_CUBE_MAP_POSITIVE_Y,0,v,m,m,0,v,_,null);C.texImage2D(C.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,v,m,m,0,v,_,null);C.texImage2D(C.TEXTURE_CUBE_MAP_POSITIVE_Z,0,v,m,m,0,v,_,null);C.texImage2D(C.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,v,m,m,0,v,_,null)}C.bindTexture(b,null);this._gl=C;this._textureFilterAnisotropic=i._textureFilterAnisotropic;this._textureTarget=b;this._texture=S;this._pixelFormat=v;this._pixelDatatype=_;this._size=m;this._hasMipmap=false;this._sizeInBytes=g;this._preMultiplyAlpha=y;this._flipY=w;this._sampler=undefined;this._positiveX=new u(C,S,b,C.TEXTURE_CUBE_MAP_POSITIVE_X,v,_,m,y,w);this._negativeX=new u(C,S,b,C.TEXTURE_CUBE_MAP_NEGATIVE_X,v,_,m,y,w);this._positiveY=new u(C,S,b,C.TEXTURE_CUBE_MAP_POSITIVE_Y,v,_,m,y,w);this._negativeY=new u(C,S,b,C.TEXTURE_CUBE_MAP_NEGATIVE_Y,v,_,m,y,w);this._positiveZ=new u(C,S,b,C.TEXTURE_CUBE_MAP_POSITIVE_Z,v,_,m,y,w);this._negativeZ=new u(C,S,b,C.TEXTURE_CUBE_MAP_NEGATIVE_Z,v,_,m,y,w);this.sampler=t(r.sampler)?r.sampler:new d}r(p.prototype,{positiveX:{get:function(){return this._positiveX}},negativeX:{get:function(){return this._negativeX}},positiveY:{get:function(){return this._positiveY}},negativeY:{get:function(){return this._negativeY}},positiveZ:{get:function(){return this._positiveZ}},negativeZ:{get:function(){return this._negativeZ}},sampler:{get:function(){return this._sampler},set:function(e){var r=e.minificationFilter;var i=e.magnificationFilter;var n=r===h.NEAREST_MIPMAP_NEAREST||r===h.NEAREST_MIPMAP_LINEAR||r===h.LINEAR_MIPMAP_NEAREST||r===h.LINEAR_MIPMAP_LINEAR;if(this._pixelDatatype===c.FLOAT){r=n?h.NEAREST_MIPMAP_NEAREST:h.NEAREST;i=f.NEAREST}var a=this._gl;var o=this._textureTarget;a.activeTexture(a.TEXTURE0);a.bindTexture(o,this._texture);a.texParameteri(o,a.TEXTURE_MIN_FILTER,r);a.texParameteri(o,a.TEXTURE_MAG_FILTER,i);a.texParameteri(o,a.TEXTURE_WRAP_S,e.wrapS);a.texParameteri(o,a.TEXTURE_WRAP_T,e.wrapT);if(t(this._textureFilterAnisotropic)){a.texParameteri(o,this._textureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,e.maximumAnisotropy)}a.bindTexture(o,null);this._sampler=e}},pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},width:{get:function(){return this._size}},height:{get:function(){return this._size}},sizeInBytes:{get:function(){if(this._hasMipmap){return Math.floor(this._sizeInBytes*4/3)}return this._sizeInBytes}},preMultiplyAlpha:{get:function(){return this._preMultiplyAlpha}},flipY:{get:function(){return this._flipY}},_target:{get:function(){return this._textureTarget}}});p.prototype.generateMipmap=function(t){t=e(t,l.DONT_CARE);if(this._size>1&&!a.isPowerOfTwo(this._size)){throw new n("width and height must be a power of two to call generateMipmap().")}if(!l.validate(t)){throw new n("hint is invalid.")}this._hasMipmap=true;var r=this._gl;var i=this._textureTarget;r.hint(r.GENERATE_MIPMAP_HINT,t);r.activeTexture(r.TEXTURE0);r.bindTexture(i,this._texture);r.generateMipmap(i);r.bindTexture(i,null)};p.prototype.isDestroyed=function(){return false};p.prototype.destroy=function(){this._gl.deleteTexture(this._texture);this._positiveX=i(this._positiveX);this._negativeX=i(this._negativeX);this._positiveY=i(this._positiveY);this._negativeY=i(this._negativeY);this._positiveZ=i(this._positiveZ);this._negativeZ=i(this._negativeZ);return i(this)};return p});define("Renderer/Texture",["../Core/Cartesian2","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/Math","../Core/PixelFormat","../Core/WebGLConstants","./ContextLimits","./MipmapHint","./PixelDatatype","./Sampler","./TextureMagnificationFilter","./TextureMinificationFilter"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p){"use strict";function m(i){i=t(i,t.EMPTY_OBJECT);if(!r(i.context)){throw new a("options.context is required.")}var n=i.context;var o=i.width;var c=i.height;var h=i.source;if(r(h)){if(!r(o)){o=t(h.videoWidth,h.width)}if(!r(c)){c=t(h.videoHeight,h.height)}}var p=t(i.pixelFormat,s.RGBA);var m=t(i.pixelDatatype,d.UNSIGNED_BYTE);var v=p;var _=s.isCompressedFormat(v);if(n.webgl2){if(p===s.DEPTH_STENCIL){v=u.DEPTH24_STENCIL8}else if(p===s.DEPTH_COMPONENT){if(m===d.UNSIGNED_SHORT){v=u.DEPTH_COMPONENT16}else if(m===d.UNSIGNED_INT){v=u.DEPTH_COMPONENT24}}}if(!r(o)||!r(c)){throw new a("options requires a source field to create an initialized texture or width and height fields to create a blank texture.")}if(o<=0){throw new a("Width must be greater than zero.")}if(o>l.maximumTextureSize){throw new a("Width must be less than or equal to the maximum texture size ("+l.maximumTextureSize+").  Check maximumTextureSize.")}if(c<=0){throw new a("Height must be greater than zero.")}if(c>l.maximumTextureSize){throw new a("Height must be less than or equal to the maximum texture size ("+l.maximumTextureSize+").  Check maximumTextureSize.")}if(!s.validate(p)){throw new a("Invalid options.pixelFormat.")}if(!_&&!d.validate(m)){throw new a("Invalid options.pixelDatatype.")}if(p===s.DEPTH_COMPONENT&&(m!==d.UNSIGNED_SHORT&&m!==d.UNSIGNED_INT)){throw new a("When options.pixelFormat is DEPTH_COMPONENT, options.pixelDatatype must be UNSIGNED_SHORT or UNSIGNED_INT.")}if(p===s.DEPTH_STENCIL&&m!==d.UNSIGNED_INT_24_8){throw new a("When options.pixelFormat is DEPTH_STENCIL, options.pixelDatatype must be UNSIGNED_INT_24_8.")}if(m===d.FLOAT&&!n.floatingPointTexture){throw new a("When options.pixelDatatype is FLOAT, this WebGL implementation must support the OES_texture_float extension.  Check context.floatingPointTexture.")}if(s.isDepthFormat(p)){if(r(h)){throw new a("When options.pixelFormat is DEPTH_COMPONENT or DEPTH_STENCIL, source cannot be provided.")}if(!n.depthTexture){throw new a("When options.pixelFormat is DEPTH_COMPONENT or DEPTH_STENCIL, this WebGL implementation must support WEBGL_depth_texture.  Check context.depthTexture.")}}if(_){if(!r(h)||!r(h.arrayBufferView)){throw new a("When options.pixelFormat is compressed, options.source.arrayBufferView must be defined.")}if(s.isDXTFormat(v)&&!n.s3tc){throw new a("When options.pixelFormat is S3TC compressed, this WebGL implementation must support the WEBGL_texture_compression_s3tc extension. Check context.s3tc.")}else if(s.isPVRTCFormat(v)&&!n.pvrtc){throw new a("When options.pixelFormat is PVRTC compressed, this WebGL implementation must support the WEBGL_texture_compression_pvrtc extension. Check context.pvrtc.")}else if(s.isETC1Format(v)&&!n.etc1){throw new a("When options.pixelFormat is ETC1 compressed, this WebGL implementation must support the WEBGL_texture_compression_etc1 extension. Check context.etc1.")}if(s.compressedTextureSizeInBytes(v,o,c)!==h.arrayBufferView.byteLength){throw new a("The byte length of the array buffer is invalid for the compressed texture with the given width and height.")}}var g=i.preMultiplyAlpha||p===s.RGB||p===s.LUMINANCE;var y=t(i.flipY,true);var w=n._gl;var C=w.TEXTURE_2D;var b=w.createTexture();w.activeTexture(w.TEXTURE0);w.bindTexture(C,b);if(r(h)){w.pixelStorei(w.UNPACK_PREMULTIPLY_ALPHA_WEBGL,g);w.pixelStorei(w.UNPACK_FLIP_Y_WEBGL,y);if(r(h.arrayBufferView)){if(_){w.compressedTexImage2D(C,0,v,o,c,0,h.arrayBufferView)}else{w.texImage2D(C,0,v,o,c,0,p,m,h.arrayBufferView)}}else if(r(h.framebuffer)){if(h.framebuffer!==n.defaultFramebuffer){h.framebuffer._bind()}w.copyTexImage2D(C,0,v,h.xOffset,h.yOffset,o,c,0);if(h.framebuffer!==n.defaultFramebuffer){h.framebuffer._unBind()}}else{w.texImage2D(C,0,v,p,m,h)}}else{w.texImage2D(C,0,v,o,c,0,p,m,null)}w.bindTexture(C,null);var S;if(_){S=s.compressedTextureSizeInBytes(p,o,c)}else{S=s.textureSizeInBytes(p,m,o,c)}this._context=n;this._textureFilterAnisotropic=n._textureFilterAnisotropic;this._textureTarget=C;this._texture=b;this._pixelFormat=p;this._pixelDatatype=m;this._width=o;this._height=c;this._dimensions=new e(o,c);this._hasMipmap=false;this._sizeInBytes=S;this._preMultiplyAlpha=g;this._flipY=y;this._sampler=undefined;this.sampler=r(i.sampler)?i.sampler:new f}m.fromFramebuffer=function(e){e=t(e,t.EMPTY_OBJECT);if(!r(e.context)){throw new a("options.context is required.")}var i=e.context;var n=i._gl;var o=t(e.pixelFormat,s.RGB);var u=t(e.framebufferXOffset,0);var l=t(e.framebufferYOffset,0);var c=t(e.width,n.drawingBufferWidth);var d=t(e.height,n.drawingBufferHeight);var f=e.framebuffer;if(!r(e.context)){throw new a("context is required.")}if(!s.validate(o)){throw new a("Invalid pixelFormat.")}if(s.isDepthFormat(o)||s.isCompressedFormat(o)){throw new a("pixelFormat cannot be DEPTH_COMPONENT, DEPTH_STENCIL or a compressed format.")}if(u<0){throw new a("framebufferXOffset must be greater than or equal to zero.")}if(l<0){throw new a("framebufferYOffset must be greater than or equal to zero.")}if(u+c>n.drawingBufferWidth){throw new a("framebufferXOffset + width must be less than or equal to drawingBufferWidth")}if(l+d>n.drawingBufferHeight){throw new a("framebufferYOffset + height must be less than or equal to drawingBufferHeight.")}var h=new m({context:i,width:c,height:d,pixelFormat:o,source:{framebuffer:r(f)?f:i.defaultFramebuffer,xOffset:u,yOffset:l,width:c,height:d}});return h};i(m.prototype,{sampler:{get:function(){return this._sampler},set:function(e){var t=e.minificationFilter;var i=e.magnificationFilter;var n=t===p.NEAREST_MIPMAP_NEAREST||t===p.NEAREST_MIPMAP_LINEAR||t===p.LINEAR_MIPMAP_NEAREST||t===p.LINEAR_MIPMAP_LINEAR;if(this._pixelDatatype===d.FLOAT){t=n?p.NEAREST_MIPMAP_NEAREST:p.NEAREST;i=h.NEAREST}var a=this._context._gl;var o=this._textureTarget;a.activeTexture(a.TEXTURE0);a.bindTexture(o,this._texture);a.texParameteri(o,a.TEXTURE_MIN_FILTER,t);a.texParameteri(o,a.TEXTURE_MAG_FILTER,i);a.texParameteri(o,a.TEXTURE_WRAP_S,e.wrapS);a.texParameteri(o,a.TEXTURE_WRAP_T,e.wrapT);if(r(this._textureFilterAnisotropic)){a.texParameteri(o,this._textureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,e.maximumAnisotropy)}a.bindTexture(o,null);this._sampler=e}},pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},dimensions:{get:function(){return this._dimensions}},preMultiplyAlpha:{get:function(){return this._preMultiplyAlpha}},flipY:{get:function(){return this._flipY}},width:{get:function(){return this._width}},height:{get:function(){return this._height}},sizeInBytes:{get:function(){if(this._hasMipmap){return Math.floor(this._sizeInBytes*4/3)}return this._sizeInBytes}},_target:{get:function(){return this._textureTarget}}});m.prototype.copyFrom=function(e,i,n){i=t(i,0);n=t(n,0);if(!r(e)){throw new a("source is required.")}if(s.isDepthFormat(this._pixelFormat)){throw new a("Cannot call copyFrom when the texture pixel format is DEPTH_COMPONENT or DEPTH_STENCIL.")}if(s.isCompressedFormat(this._pixelFormat)){throw new a("Cannot call copyFrom with a compressed texture pixel format.")}if(i<0){throw new a("xOffset must be greater than or equal to zero.")}if(n<0){throw new a("yOffset must be greater than or equal to zero.")}if(i+e.width>this._width){throw new a("xOffset + source.width must be less than or equal to width.")}if(n+e.height>this._height){throw new a("yOffset + source.height must be less than or equal to height.")}var o=this._context._gl;var u=this._textureTarget;o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this._preMultiplyAlpha);o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,this._flipY);o.activeTexture(o.TEXTURE0);o.bindTexture(u,this._texture);if(e.arrayBufferView){o.texSubImage2D(u,0,i,n,e.width,e.height,this._pixelFormat,this._pixelDatatype,e.arrayBufferView)}else{o.texSubImage2D(u,0,i,n,this._pixelFormat,this._pixelDatatype,e)}o.bindTexture(u,null)};m.prototype.copyFromFramebuffer=function(e,r,i,n,o,u){e=t(e,0);r=t(r,0);i=t(i,0);n=t(n,0);o=t(o,this._width);u=t(u,this._height);if(s.isDepthFormat(this._pixelFormat)){throw new a("Cannot call copyFromFramebuffer when the texture pixel format is DEPTH_COMPONENT or DEPTH_STENCIL.")}if(this._pixelDatatype===d.FLOAT){throw new a("Cannot call copyFromFramebuffer when the texture pixel data type is FLOAT.")}if(s.isCompressedFormat(this._pixelFormat)){throw new a("Cannot call copyFrom with a compressed texture pixel format.")}if(e<0){throw new a("xOffset must be greater than or equal to zero.")}if(r<0){throw new a("yOffset must be greater than or equal to zero.")}if(i<0){throw new a("framebufferXOffset must be greater than or equal to zero.")}if(n<0){throw new a("framebufferYOffset must be greater than or equal to zero.")}if(e+o>this._width){throw new a("xOffset + width must be less than or equal to width.")}if(r+u>this._height){throw new a("yOffset + height must be less than or equal to height.")}var l=this._context._gl;var c=this._textureTarget;l.activeTexture(l.TEXTURE0);l.bindTexture(c,this._texture);l.copyTexSubImage2D(c,0,e,r,i,n,o,u);l.bindTexture(c,null)};m.prototype.generateMipmap=function(e){e=t(e,c.DONT_CARE);if(s.isDepthFormat(this._pixelFormat)){throw new a("Cannot call generateMipmap when the texture pixel format is DEPTH_COMPONENT or DEPTH_STENCIL.")}if(s.isCompressedFormat(this._pixelFormat)){throw new a("Cannot call generateMipmap with a compressed pixel format.")}if(this._width>1&&!o.isPowerOfTwo(this._width)){throw new a("width must be a power of two to call generateMipmap().")}if(this._height>1&&!o.isPowerOfTwo(this._height)){throw new a("height must be a power of two to call generateMipmap().")}if(!c.validate(e)){throw new a("hint is invalid.")}this._hasMipmap=true;var r=this._context._gl;var i=this._textureTarget;r.hint(r.GENERATE_MIPMAP_HINT,e);r.activeTexture(r.TEXTURE0);r.bindTexture(i,this._texture);r.generateMipmap(i);r.bindTexture(i,null)};m.prototype.isDestroyed=function(){return false};m.prototype.destroy=function(){this._context._gl.deleteTexture(this._texture);return n(this)};return m});define("Shaders/Materials/BumpMapMaterial",[],function(){"use strict";return"uniform sampler2D image;\nuniform float strength;\nuniform vec2 repeat;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec2 st = materialInput.st;\nvec2 centerPixel = fract(repeat * st);\nfloat centerBump = texture2D(image, centerPixel).channel;\nfloat imageWidth = float(imageDimensions.x);\nvec2 rightPixel = fract(repeat * (st + vec2(1.0 / imageWidth, 0.0)));\nfloat rightBump = texture2D(image, rightPixel).channel;\nfloat imageHeight = float(imageDimensions.y);\nvec2 leftPixel = fract(repeat * (st + vec2(0.0, 1.0 / imageHeight)));\nfloat topBump = texture2D(image, leftPixel).channel;\nvec3 normalTangentSpace = normalize(vec3(centerBump - rightBump, centerBump - topBump, clamp(1.0 - strength, 0.1, 1.0)));\nvec3 normalEC = materialInput.tangentToEyeMatrix * normalTangentSpace;\nmaterial.normal = normalEC;\nmaterial.diffuse = vec3(0.01);\nreturn material;\n}\n"});define("Shaders/Materials/CheckerboardMaterial",[],function(){"use strict";return"uniform vec4 lightColor;\nuniform vec4 darkColor;\nuniform vec2 repeat;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec2 st = materialInput.st;\nfloat b = mod(floor(repeat.s * st.s) + floor(repeat.t * st.t), 2.0);\nfloat scaledWidth = fract(repeat.s * st.s);\nscaledWidth = abs(scaledWidth - floor(scaledWidth + 0.5));\nfloat scaledHeight = fract(repeat.t * st.t);\nscaledHeight = abs(scaledHeight - floor(scaledHeight + 0.5));\nfloat value = min(scaledWidth, scaledHeight);\nvec4 currentColor = mix(lightColor, darkColor, b);\nvec4 color = czm_antialias(lightColor, darkColor, currentColor, value, 0.03);\nmaterial.diffuse = color.rgb;\nmaterial.alpha = color.a;\nreturn material;\n}\n"});define("Shaders/Materials/DotMaterial",[],function(){"use strict";return"uniform vec4 lightColor;\nuniform vec4 darkColor;\nuniform vec2 repeat;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nfloat b = smoothstep(0.3, 0.32, length(fract(repeat * materialInput.st) - 0.5));\nvec4 color = mix(lightColor, darkColor, b);\nmaterial.diffuse = color.rgb;\nmaterial.alpha = color.a;\nreturn material;\n}\n"});define("Shaders/Materials/FadeMaterial",[],function(){"use strict";return"uniform vec4 fadeInColor;\nuniform vec4 fadeOutColor;\nuniform float maximumDistance;\nuniform bool repeat;\nuniform vec2 fadeDirection;\nuniform vec2 time;\nfloat getTime(float t, float coord)\n{\nfloat scalar = 1.0 / maximumDistance;\nfloat q  = distance(t, coord) * scalar;\nif (repeat)\n{\nfloat r = distance(t, coord + 1.0) * scalar;\nfloat s = distance(t, coord - 1.0) * scalar;\nq = min(min(r, s), q);\n}\nreturn clamp(q, 0.0, 1.0);\n}\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec2 st = materialInput.st;\nfloat s = getTime(time.x, st.s) * fadeDirection.s;\nfloat t = getTime(time.y, st.t) * fadeDirection.t;\nfloat u = length(vec2(s, t));\nvec4 color = mix(fadeInColor, fadeOutColor, u);\nmaterial.emission = color.rgb;\nmaterial.alpha = color.a;\nreturn material;\n}\n"});define("Shaders/Materials/GridMaterial",[],function(){"use strict";return"#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n#endif\nuniform vec4 color;\nuniform float cellAlpha;\nuniform vec2 lineCount;\nuniform vec2 lineThickness;\nuniform vec2 lineOffset;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec2 st = materialInput.st;\nfloat scaledWidth = fract(lineCount.s * st.s - lineOffset.s);\nscaledWidth = abs(scaledWidth - floor(scaledWidth + 0.5));\nfloat scaledHeight = fract(lineCount.t * st.t - lineOffset.t);\nscaledHeight = abs(scaledHeight - floor(scaledHeight + 0.5));\nfloat value;\n#ifdef GL_OES_standard_derivatives\nconst float fuzz = 1.2;\nvec2 thickness = (lineThickness * czm_resolutionScale) - 1.0;\nvec2 dx = abs(dFdx(st));\nvec2 dy = abs(dFdy(st));\nvec2 dF = vec2(max(dx.s, dy.s), max(dx.t, dy.t)) * lineCount;\nvalue = min(\nsmoothstep(dF.s * thickness.s, dF.s * (fuzz + thickness.s), scaledWidth),\nsmoothstep(dF.t * thickness.t, dF.t * (fuzz + thickness.t), scaledHeight));\n#else\nconst float fuzz = 0.05;\nvec2 range = 0.5 - (lineThickness * 0.05);\nvalue = min(\n1.0 - smoothstep(range.s, range.s + fuzz, scaledWidth),\n1.0 - smoothstep(range.t, range.t + fuzz, scaledHeight));\n#endif\nfloat dRim = 1.0 - abs(dot(materialInput.normalEC, normalize(materialInput.positionToEyeEC)));\nfloat sRim = smoothstep(0.8, 1.0, dRim);\nvalue *= (1.0 - sRim);\nvec3 halfColor = color.rgb * 0.5;\nmaterial.diffuse = halfColor;\nmaterial.emission = halfColor;\nmaterial.alpha = color.a * (1.0 - ((1.0 - cellAlpha) * value));\nreturn material;\n}\n"});define("Shaders/Materials/NormalMapMaterial",[],function(){"use strict";return"uniform sampler2D image;\nuniform float strength;\nuniform vec2 repeat;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec4 textureValue = texture2D(image, fract(repeat * materialInput.st));\nvec3 normalTangentSpace = textureValue.channels;\nnormalTangentSpace.xy = normalTangentSpace.xy * 2.0 - 1.0;\nnormalTangentSpace.z = clamp(1.0 - strength, 0.1, 1.0);\nnormalTangentSpace = normalize(normalTangentSpace);\nvec3 normalEC = materialInput.tangentToEyeMatrix * normalTangentSpace;\nmaterial.normal = normalEC;\nreturn material;\n}\n"});define("Shaders/Materials/PolylineArrowMaterial",[],function(){"use strict";return"#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n#endif\nuniform vec4 color;\nvarying float v_width;\nfloat getPointOnLine(vec2 p0, vec2 p1, float x)\n{\nfloat slope = (p0.y - p1.y) / (p0.x - p1.x);\nreturn slope * (x - p0.x) + p0.y;\n}\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec2 st = materialInput.st;\n#ifdef GL_OES_standard_derivatives\nfloat base = 1.0 - abs(fwidth(st.s)) * 10.0;\n#else\nfloat base = 0.99;\n#endif\nvec2 center = vec2(1.0, 0.5);\nfloat ptOnUpperLine = getPointOnLine(vec2(base, 1.0), center, st.s);\nfloat ptOnLowerLine = getPointOnLine(vec2(base, 0.0), center, st.s);\nfloat halfWidth = 0.15;\nfloat s = step(0.5 - halfWidth, st.t);\ns *= 1.0 - step(0.5 + halfWidth, st.t);\ns *= 1.0 - step(base, st.s);\nfloat t = step(base, materialInput.st.s);\nt *= 1.0 - step(ptOnUpperLine, st.t);\nt *= step(ptOnLowerLine, st.t);\nfloat dist;\nif (st.s < base)\n{\nfloat d1 = abs(st.t - (0.5 - halfWidth));\nfloat d2 = abs(st.t - (0.5 + halfWidth));\ndist = min(d1, d2);\n}\nelse\n{\nfloat d1 = czm_infinity;\nif (st.t < 0.5 - halfWidth && st.t > 0.5 + halfWidth)\n{\nd1 = abs(st.s - base);\n}\nfloat d2 = abs(st.t - ptOnUpperLine);\nfloat d3 = abs(st.t - ptOnLowerLine);\ndist = min(min(d1, d2), d3);\n}\nvec4 outsideColor = vec4(0.0);\nvec4 currentColor = mix(outsideColor, color, clamp(s + t, 0.0, 1.0));\nvec4 outColor = czm_antialias(outsideColor, color, currentColor, dist);\nmaterial.diffuse = outColor.rgb;\nmaterial.alpha = outColor.a;\nreturn material;\n}\n"});define("Shaders/Materials/PolylineGlowMaterial",[],function(){"use strict";return"uniform vec4 color;\nuniform float glowPower;\nvarying float v_width;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec2 st = materialInput.st;\nfloat glow = glowPower / abs(st.t - 0.5) - (glowPower / 0.5);\nmaterial.emission = max(vec3(glow - 1.0 + color.rgb), color.rgb);\nmaterial.alpha = clamp(0.0, 1.0, glow) * color.a;\nreturn material;\n}\n"});define("Shaders/Materials/PolylineOutlineMaterial",[],function(){"use strict";return"uniform vec4 color;\nuniform vec4 outlineColor;\nuniform float outlineWidth;\nvarying float v_width;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec2 st = materialInput.st;\nfloat halfInteriorWidth =  0.5 * (v_width - outlineWidth) / v_width;\nfloat b = step(0.5 - halfInteriorWidth, st.t);\nb *= 1.0 - step(0.5 + halfInteriorWidth, st.t);\nfloat d1 = abs(st.t - (0.5 - halfInteriorWidth));\nfloat d2 = abs(st.t - (0.5 + halfInteriorWidth));\nfloat dist = min(d1, d2);\nvec4 currentColor = mix(outlineColor, color, b);\nvec4 outColor = czm_antialias(outlineColor, color, currentColor, dist);\nmaterial.diffuse = outColor.rgb;\nmaterial.alpha = outColor.a;\nreturn material;\n}\n"});define("Shaders/Materials/RimLightingMaterial",[],function(){"use strict";return"uniform vec4 color;\nuniform vec4 rimColor;\nuniform float width;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nfloat d = 1.0 - dot(materialInput.normalEC, normalize(materialInput.positionToEyeEC));\nfloat s = smoothstep(1.0 - width, 1.0, d);\nmaterial.diffuse = color.rgb;\nmaterial.emission = rimColor.rgb * s;\nmaterial.alpha = mix(color.a, rimColor.a, s);\nreturn material;\n}\n"});define("Shaders/Materials/StripeMaterial",[],function(){"use strict";return"uniform vec4 evenColor;\nuniform vec4 oddColor;\nuniform float offset;\nuniform float repeat;\nuniform bool horizontal;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nfloat coord = mix(materialInput.st.s, materialInput.st.t, float(horizontal));\nfloat value = fract((coord - offset) * (repeat * 0.5));\nfloat dist = min(value, min(abs(value - 0.5), 1.0 - value));\nvec4 currentColor = mix(evenColor, oddColor, step(0.5, value));\nvec4 color = czm_antialias(evenColor, oddColor, currentColor, dist);\nmaterial.diffuse = color.rgb;\nmaterial.alpha = color.a;\nreturn material;\n}\n"});define("Shaders/Materials/Water",[],function(){"use strict";return"uniform sampler2D specularMap;\nuniform sampler2D normalMap;\nuniform vec4 baseWaterColor;\nuniform vec4 blendColor;\nuniform float frequency;\nuniform float animationSpeed;\nuniform float amplitude;\nuniform float specularIntensity;\nuniform float fadeFactor;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nfloat time = czm_frameNumber * animationSpeed;\nfloat fade = max(1.0, (length(materialInput.positionToEyeEC) / 10000000000.0) * frequency * fadeFactor);\nfloat specularMapValue = texture2D(specularMap, materialInput.st).r;\nvec4 noise = czm_getWaterNoise(normalMap, materialInput.st * frequency, time, 0.0);\nvec3 normalTangentSpace = noise.xyz * vec3(1.0, 1.0, (1.0 / amplitude));\nnormalTangentSpace.xy /= fade;\nnormalTangentSpace = mix(vec3(0.0, 0.0, 50.0), normalTangentSpace, specularMapValue);\nnormalTangentSpace = normalize(normalTangentSpace);\nfloat tsPerturbationRatio = clamp(dot(normalTangentSpace, vec3(0.0, 0.0, 1.0)), 0.0, 1.0);\nmaterial.alpha = specularMapValue;\nmaterial.diffuse = mix(blendColor.rgb, baseWaterColor.rgb, specularMapValue);\nmaterial.diffuse += (0.1 * tsPerturbationRatio);\nmaterial.normal = normalize(materialInput.tangentToEyeMatrix * normalTangentSpace);\nmaterial.specular = specularIntensity;\nmaterial.shininess = 10.0;\nreturn material;\n}\n"});define("Scene/Material",["../Core/Cartesian2","../Core/clone","../Core/Color","../Core/combine","../Core/createGuid","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/isArray","../Core/loadCRN","../Core/loadImage","../Core/loadKTX","../Core/Matrix2","../Core/Matrix3","../Core/Matrix4","../Renderer/CubeMap","../Renderer/Texture","../Shaders/Materials/BumpMapMaterial","../Shaders/Materials/CheckerboardMaterial","../Shaders/Materials/DotMaterial","../Shaders/Materials/FadeMaterial","../Shaders/Materials/GridMaterial","../Shaders/Materials/NormalMapMaterial","../Shaders/Materials/PolylineArrowMaterial","../Shaders/Materials/PolylineGlowMaterial","../Shaders/Materials/PolylineOutlineMaterial","../Shaders/Materials/RimLightingMaterial","../Shaders/Materials/StripeMaterial","../Shaders/Materials/Water","../ThirdParty/when"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w,C,b,S,E,T,x,A,P,D,M,I){"use strict";function O(e){this.type=undefined;this.shaderSource=undefined;this.materials=undefined;this.uniforms=undefined;this._uniforms=undefined;this.translucent=undefined;this._strict=undefined;this._template=undefined;this._count=undefined;this._texturePaths={};this._loadedImages=[];this._loadedCubeMaps=[];this._textures={};this._updateFunctions=[];this._defaultTexture=undefined;R(e,this);s(this,{type:{value:this.type,writable:false}});if(!o(O._uniformList[this.type])){O._uniformList[this.type]=Object.keys(this._uniforms)}}O._uniformList={};O.fromType=function(e,t){if(!o(O._materialCache.getMaterial(e))){throw new l("material with type '"+e+"' does not exist.")}var r=new O({fabric:{type:e}});if(o(t)){for(var i in t){if(t.hasOwnProperty(i)){r.uniforms[i]=t[i]}}}return r};O.prototype.isTranslucent=function(){if(o(this.translucent)){if(typeof this.translucent==="function"){return this.translucent()}return this.translucent}var e=true;var t=this._translucentFunctions;var r=t.length;for(var i=0;i<r;++i){var n=t[i];if(typeof n==="function"){e=e&&n()}else{e=e&&n}if(!e){break}}return e};O.prototype.update=function(e){var t;var r;var i=this._loadedImages;var n=i.length;for(t=0;t<n;++t){var a=i[t];r=a.id;var s=a.image;var u;if(o(s.internalFormat)){u=new g({context:e,pixelFormat:s.internalFormat,width:s.width,height:s.height,source:{arrayBufferView:s.bufferView}})}else{u=new g({context:e,source:s})}this._textures[r]=u;var l=r+"Dimensions";if(this.uniforms.hasOwnProperty(l)){var c=this.uniforms[l];c.x=u._width;c.y=u._height}}i.length=0;var d=this._loadedCubeMaps;n=d.length;for(t=0;t<n;++t){var f=d[t];r=f.id;var h=f.images;var p=new _({context:e,source:{positiveX:h[0],negativeX:h[1],positiveY:h[2],negativeY:h[3],positiveZ:h[4],negativeZ:h[5]}});this._textures[r]=p}d.length=0;var m=this._updateFunctions;n=m.length;for(t=0;t<n;++t){m[t](this,e)}var v=this.materials;for(var y in v){if(v.hasOwnProperty(y)){v[y].update(e)}}};O.prototype.isDestroyed=function(){return false};O.prototype.destroy=function(){var e=this._textures;for(var t in e){if(e.hasOwnProperty(t)){var r=e[t];if(r!==this._defaultTexture){r.destroy()}}}var i=this.materials;for(var n in i){if(i.hasOwnProperty(n)){i[n].destroy()}}return u(this)};function R(e,r){
e=a(e,a.EMPTY_OBJECT);r._strict=a(e.strict,false);r._count=a(e.count,0);r._template=t(a(e.fabric,a.EMPTY_OBJECT));r._template.uniforms=t(a(r._template.uniforms,a.EMPTY_OBJECT));r._template.materials=t(a(r._template.materials,a.EMPTY_OBJECT));r.type=o(r._template.type)?r._template.type:n();r.shaderSource="";r.materials={};r.uniforms={};r._uniforms={};r._translucentFunctions=[];var s;var u=O._materialCache.getMaterial(r.type);if(o(u)){var l=t(u.fabric,true);r._template=i(r._template,l,true);s=u.translucent}V(r);if(!o(u)){O._materialCache.addMaterial(r.type,r)}z(r);j(r);Z(r);var c=r._translucentFunctions.length===0?true:undefined;s=a(s,c);s=a(e.translucent,s);if(o(s)){if(typeof s==="function"){var d=function(){return s(r)};r._translucentFunctions.push(d)}else{r._translucentFunctions.push(s)}}}function N(e,t,r,i){if(o(e)){for(var n in e){if(e.hasOwnProperty(n)){var a=t.indexOf(n)!==-1;if(i&&!a||!i&&a){r(n,t)}}}}}function L(e,t){var r="fabric: property name '"+e+"' is not valid. It should be ";for(var i=0;i<t.length;i++){var n="'"+t[i]+"'";r+=i===t.length-1?"or "+n+".":n+", "}throw new l(r)}function B(e,t){var r="fabric: uniforms and materials cannot share the same property '"+e+"'";throw new l(r)}var F=["type","materials","uniforms","components","source"];var k=["diffuse","specular","shininess","normal","emission","alpha"];function V(e){var t=e._template;var r=t.uniforms;var i=t.materials;var n=t.components;if(o(n)&&o(t.source)){throw new l("fabric: cannot have source and components in the same template.")}N(t,F,L,true);N(n,k,L,true);var a=[];for(var s in i){if(i.hasOwnProperty(s)){a.push(s)}}N(r,a,B,false)}function z(e){var t=e._template.components;var r=e._template.source;if(o(r)){e.shaderSource+=r+"\n"}else{e.shaderSource+="czm_material czm_getMaterial(czm_materialInput materialInput)\n{\n";e.shaderSource+="czm_material material = czm_getDefaultMaterial(materialInput);\n";if(o(t)){for(var i in t){if(t.hasOwnProperty(i)){e.shaderSource+="material."+i+" = "+t[i]+";\n"}}}e.shaderSource+="return material;\n}\n"}}var U={mat2:p,mat3:m,mat4:v};var q=/\.ktx$/i;var G=/\.crn$/i;function H(e){var t;return function(r,i){var n=r.uniforms;var a=n[e];var s=t!==a;t=a;var u=r._textures[e];var l;var c;if(a instanceof HTMLVideoElement){if(a.readyState>=2){if(s&&o(u)){if(u!==i.defaultTexture){u.destroy()}u=undefined}if(!o(u)||u===i.defaultTexture){u=new g({context:i,source:a});r._textures[e]=u;return}u.copyFrom(a)}else if(!o(u)){r._textures[e]=i.defaultTexture}return}if(a instanceof g&&a!==u){r._texturePaths[e]=undefined;var p=r._textures[e];if(p!==r._defaultTexture){p.destroy()}r._textures[e]=a;l=e+"Dimensions";if(n.hasOwnProperty(l)){c=n[l];c.x=a._width;c.y=a._height}return}if(!o(u)){r._texturePaths[e]=undefined;if(!o(r._defaultTexture)){r._defaultTexture=i.defaultTexture}u=r._textures[e]=r._defaultTexture;l=e+"Dimensions";if(n.hasOwnProperty(l)){c=n[l];c.x=u._width;c.y=u._height}}if(a===O.DefaultImageId){return}if(a!==r._texturePaths[e]){if(typeof a==="string"){var m;if(q.test(a)){m=h(a)}else if(G.test(a)){m=d(a)}else{m=f(a)}I(m,function(t){r._loadedImages.push({id:e,image:t})})}else if(a instanceof HTMLCanvasElement){r._loadedImages.push({id:e,image:a})}r._texturePaths[e]=a}}}function W(e){return function(t,r){var i=t.uniforms[e];if(i instanceof _){var n=t._textures[e];if(n!==t._defaultTexture){n.destroy()}t._texturePaths[e]=undefined;t._textures[e]=i;return}if(!o(t._textures[e])){t._texturePaths[e]=undefined;t._textures[e]=r.defaultCubeMap}if(i===O.DefaultCubeMapId){return}var a=i.positiveX+i.negativeX+i.positiveY+i.negativeY+i.positiveZ+i.negativeZ;if(a!==t._texturePaths[e]){var s=[f(i.positiveX),f(i.negativeX),f(i.positiveY),f(i.negativeY),f(i.positiveZ),f(i.negativeZ)];I.all(s).then(function(r){t._loadedCubeMaps.push({id:e,images:r})});t._texturePaths[e]=a}}}function j(e){var t=e._template.uniforms;for(var r in t){if(t.hasOwnProperty(r)){Y(e,r)}}}function Y(e,t){var r=e._strict;var i=e._template.uniforms;var n=i[t];var a=X(n);if(!o(a)){throw new l("fabric: uniform '"+t+"' has invalid type.")}var s;if(a==="channels"){s=K(e,t,n,false);if(s===0&&r){throw new l("strict: shader source does not use channels '"+t+"'.")}}else{if(a==="sampler2D"){var u=t+"Dimensions";if(Q(e,u)>0){i[u]={type:"ivec3",x:1,y:1};Y(e,u)}}var c=new RegExp("uniform\\s+"+a+"\\s+"+t+"\\s*;");if(!c.test(e.shaderSource)){var d="uniform "+a+" "+t+";";e.shaderSource=d+e.shaderSource}var f=t+"_"+e._count++;s=K(e,t,f);if(s===1&&r){throw new l("strict: shader source does not use uniform '"+t+"'.")}e.uniforms[t]=n;if(a==="sampler2D"){e._uniforms[f]=function(){return e._textures[t]};e._updateFunctions.push(H(t))}else if(a==="samplerCube"){e._uniforms[f]=function(){return e._textures[t]};e._updateFunctions.push(W(t))}else if(a.indexOf("mat")!==-1){var h=new U[a];e._uniforms[f]=function(){return U[a].fromColumnMajorArray(e.uniforms[t],h)}}else{e._uniforms[f]=function(){return e.uniforms[t]}}}}function X(e){var t=e.type;if(!o(t)){var r=typeof e;if(r==="number"){t="float"}else if(r==="boolean"){t="bool"}else if(r==="string"||e instanceof HTMLCanvasElement){if(/^([rgba]){1,4}$/i.test(e)){t="channels"}else if(e===O.DefaultCubeMapId){t="samplerCube"}else{t="sampler2D"}}else if(r==="object"){if(c(e)){if(e.length===4||e.length===9||e.length===16){t="mat"+Math.sqrt(e.length)}}else{var i=0;for(var n in e){if(e.hasOwnProperty(n)){i+=1}}if(i>=2&&i<=4){t="vec"+i}else if(i===6){t="samplerCube"}}}}return t}function Z(e){var t=e._strict;var r=e._template.materials;for(var n in r){if(r.hasOwnProperty(n)){var a=new O({strict:t,fabric:r[n],count:e._count});e._count=a._count;e._uniforms=i(e._uniforms,a._uniforms,true);e.materials[n]=a;e._translucentFunctions=e._translucentFunctions.concat(a._translucentFunctions);var o="czm_getMaterial";var s=o+"_"+e._count++;K(a,o,s);e.shaderSource=a.shaderSource+e.shaderSource;var u=s+"(materialInput)";var c=K(e,n,u);if(c===0&&t){throw new l("strict: shader source does not use material '"+n+"'.")}}}}function K(e,t,r,i){i=a(i,true);var n=0;var o="([\\w])?";var s="([\\w"+(i?".":"")+"])?";var u=new RegExp(s+t+o,"g");e.shaderSource=e.shaderSource.replace(u,function(e,t,i){if(t||i){return e}n+=1;return r});return n}function Q(e,t,r){return K(e,t,t,r)}O._materialCache={_materials:{},addMaterial:function(e,t){this._materials[e]=t},getMaterial:function(e){return this._materials[e]}};O.DefaultImageId="czm_defaultImage";O.DefaultCubeMapId="czm_defaultCubeMap";O.ColorType="Color";O._materialCache.addMaterial(O.ColorType,{fabric:{type:O.ColorType,uniforms:{color:new r(1,0,0,.5)},components:{diffuse:"color.rgb",alpha:"color.a"}},translucent:function(e){return e.uniforms.color.alpha<1}});O.ImageType="Image";O._materialCache.addMaterial(O.ImageType,{fabric:{type:O.ImageType,uniforms:{image:O.DefaultImageId,repeat:new e(1,1),color:new r(1,1,1,1)},components:{diffuse:"texture2D(image, fract(repeat * materialInput.st)).rgb * color.rgb",alpha:"texture2D(image, fract(repeat * materialInput.st)).a * color.a"}},translucent:function(e){return e.uniforms.color.alpha<1}});O.DiffuseMapType="DiffuseMap";O._materialCache.addMaterial(O.DiffuseMapType,{fabric:{type:O.DiffuseMapType,uniforms:{image:O.DefaultImageId,channels:"rgb",repeat:new e(1,1)},components:{diffuse:"texture2D(image, fract(repeat * materialInput.st)).channels"}},translucent:false});O.AlphaMapType="AlphaMap";O._materialCache.addMaterial(O.AlphaMapType,{fabric:{type:O.AlphaMapType,uniforms:{image:O.DefaultImageId,channel:"a",repeat:new e(1,1)},components:{alpha:"texture2D(image, fract(repeat * materialInput.st)).channel"}},translucent:true});O.SpecularMapType="SpecularMap";O._materialCache.addMaterial(O.SpecularMapType,{fabric:{type:O.SpecularMapType,uniforms:{image:O.DefaultImageId,channel:"r",repeat:new e(1,1)},components:{specular:"texture2D(image, fract(repeat * materialInput.st)).channel"}},translucent:false});O.EmissionMapType="EmissionMap";O._materialCache.addMaterial(O.EmissionMapType,{fabric:{type:O.EmissionMapType,uniforms:{image:O.DefaultImageId,channels:"rgb",repeat:new e(1,1)},components:{emission:"texture2D(image, fract(repeat * materialInput.st)).channels"}},translucent:false});O.BumpMapType="BumpMap";O._materialCache.addMaterial(O.BumpMapType,{fabric:{type:O.BumpMapType,uniforms:{image:O.DefaultImageId,channel:"r",strength:.8,repeat:new e(1,1)},source:y},translucent:false});O.NormalMapType="NormalMap";O._materialCache.addMaterial(O.NormalMapType,{fabric:{type:O.NormalMapType,uniforms:{image:O.DefaultImageId,channels:"rgb",strength:.8,repeat:new e(1,1)},source:E},translucent:false});O.GridType="Grid";O._materialCache.addMaterial(O.GridType,{fabric:{type:O.GridType,uniforms:{color:new r(0,1,0,1),cellAlpha:.1,lineCount:new e(8,8),lineThickness:new e(1,1),lineOffset:new e(0,0)},source:S},translucent:function(e){var t=e.uniforms;return t.color.alpha<1||t.cellAlpha<1}});O.StripeType="Stripe";O._materialCache.addMaterial(O.StripeType,{fabric:{type:O.StripeType,uniforms:{horizontal:true,evenColor:new r(1,1,1,.5),oddColor:new r(0,0,1,.5),offset:0,repeat:5},source:D},translucent:function(e){var t=e.uniforms;return t.evenColor.alpha<1||t.oddColor.alpha<0}});O.CheckerboardType="Checkerboard";O._materialCache.addMaterial(O.CheckerboardType,{fabric:{type:O.CheckerboardType,uniforms:{lightColor:new r(1,1,1,.5),darkColor:new r(0,0,0,.5),repeat:new e(5,5)},source:w},translucent:function(e){var t=e.uniforms;return t.lightColor.alpha<1||t.darkColor.alpha<0}});O.DotType="Dot";O._materialCache.addMaterial(O.DotType,{fabric:{type:O.DotType,uniforms:{lightColor:new r(1,1,0,.75),darkColor:new r(0,1,1,.75),repeat:new e(5,5)},source:C},translucent:function(e){var t=e.uniforms;return t.lightColor.alpha<1||t.darkColor.alpha<0}});O.WaterType="Water";O._materialCache.addMaterial(O.WaterType,{fabric:{type:O.WaterType,uniforms:{baseWaterColor:new r(.2,.3,.6,1),blendColor:new r(0,1,.699,1),specularMap:O.DefaultImageId,normalMap:O.DefaultImageId,frequency:10,animationSpeed:.01,amplitude:1,specularIntensity:.5,fadeFactor:1},source:M},translucent:function(e){var t=e.uniforms;return t.baseWaterColor.alpha<1||t.blendColor.alpha<0}});O.RimLightingType="RimLighting";O._materialCache.addMaterial(O.RimLightingType,{fabric:{type:O.RimLightingType,uniforms:{color:new r(1,0,0,.7),rimColor:new r(1,1,1,.4),width:.3},source:P},translucent:function(e){var t=e.uniforms;return t.color.alpha<1||t.rimColor.alpha<0}});O.FadeType="Fade";O._materialCache.addMaterial(O.FadeType,{fabric:{type:O.FadeType,uniforms:{fadeInColor:new r(1,0,0,1),fadeOutColor:new r(0,0,0,0),maximumDistance:.5,repeat:true,fadeDirection:{x:true,y:true},time:new e(.5,.5)},source:b},translucent:function(e){var t=e.uniforms;return t.fadeInColor.alpha<1||t.fadeOutColor.alpha<1}});O.PolylineArrowType="PolylineArrow";O._materialCache.addMaterial(O.PolylineArrowType,{fabric:{type:O.PolylineArrowType,uniforms:{color:new r(1,1,1,1)},source:T},translucent:true});O.PolylineGlowType="PolylineGlow";O._materialCache.addMaterial(O.PolylineGlowType,{fabric:{type:O.PolylineGlowType,uniforms:{color:new r(0,.5,1,1),glowPower:.25},source:x},translucent:true});O.PolylineOutlineType="PolylineOutline";O._materialCache.addMaterial(O.PolylineOutlineType,{fabric:{type:O.PolylineOutlineType,uniforms:{color:new r(1,1,1,1),outlineColor:new r(1,0,0,1),outlineWidth:1},source:A},translucent:function(e){var t=e.uniforms;return t.color.alpha<1||t.outlineColor.alpha<1}});return O});define("Scene/MaterialAppearance",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/freezeObject","../Core/VertexFormat","../Shaders/Appearances/AllMaterialAppearanceFS","../Shaders/Appearances/AllMaterialAppearanceVS","../Shaders/Appearances/BasicMaterialAppearanceFS","../Shaders/Appearances/BasicMaterialAppearanceVS","../Shaders/Appearances/TexturedMaterialAppearanceFS","../Shaders/Appearances/TexturedMaterialAppearanceVS","./Appearance","./Material"],function(e,t,r,i,n,a,o,s,u,l,c,d,f){"use strict";function h(r){r=e(r,e.EMPTY_OBJECT);var i=e(r.translucent,true);var n=e(r.closed,false);var a=e(r.materialSupport,h.MaterialSupport.TEXTURED);this.material=t(r.material)?r.material:f.fromType(f.ColorType);this.translucent=i;this._vertexShaderSource=e(r.vertexShaderSource,a.vertexShaderSource);this._fragmentShaderSource=e(r.fragmentShaderSource,a.fragmentShaderSource);this._renderState=d.getDefaultRenderState(i,n,r.renderState);this._closed=n;this._materialSupport=a;this._vertexFormat=a.vertexFormat;this._flat=e(r.flat,false);this._faceForward=e(r.faceForward,!n)}r(h.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},materialSupport:{get:function(){return this._materialSupport}},vertexFormat:{get:function(){return this._vertexFormat}},flat:{get:function(){return this._flat}},faceForward:{get:function(){return this._faceForward}}});h.prototype.getFragmentShaderSource=d.prototype.getFragmentShaderSource;h.prototype.isTranslucent=d.prototype.isTranslucent;h.prototype.getRenderState=d.prototype.getRenderState;h.MaterialSupport={BASIC:i({vertexFormat:n.POSITION_AND_NORMAL,vertexShaderSource:u,fragmentShaderSource:s}),TEXTURED:i({vertexFormat:n.POSITION_NORMAL_AND_ST,vertexShaderSource:c,fragmentShaderSource:l}),ALL:i({vertexFormat:n.ALL,vertexShaderSource:o,fragmentShaderSource:a})};return h});define("Shaders/Appearances/PerInstanceColorAppearanceFS",[],function(){"use strict";return"varying vec3 v_positionEC;\nvarying vec3 v_normalEC;\nvarying vec4 v_color;\nvoid main()\n{\nvec3 positionToEyeEC = -v_positionEC;\nvec3 normalEC = normalize(v_normalEC);\n#ifdef FACE_FORWARD\nnormalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);\n#endif\nczm_materialInput materialInput;\nmaterialInput.normalEC = normalEC;\nmaterialInput.positionToEyeEC = positionToEyeEC;\nczm_material material = czm_getDefaultMaterial(materialInput);\nmaterial.diffuse = v_color.rgb;\nmaterial.alpha = v_color.a;\ngl_FragColor = czm_phong(normalize(positionToEyeEC), material);\n}\n"});define("Shaders/Appearances/PerInstanceColorAppearanceVS",[],function(){"use strict";return"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec3 normal;\nattribute vec4 color;\nattribute float batchId;\nvarying vec3 v_positionEC;\nvarying vec3 v_normalEC;\nvarying vec4 v_color;\nvoid main()\n{\nvec4 p = czm_computePosition();\nv_positionEC = (czm_modelViewRelativeToEye * p).xyz;\nv_normalEC = czm_normal * normal;\nv_color = color;\ngl_Position = czm_modelViewProjectionRelativeToEye * p;\n}\n"});define("Shaders/Appearances/PerInstanceFlatColorAppearanceFS",[],function(){"use strict";return"varying vec4 v_color;\nvoid main()\n{\ngl_FragColor = v_color;\n}\n"});define("Shaders/Appearances/PerInstanceFlatColorAppearanceVS",[],function(){"use strict";return"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec4 color;\nattribute float batchId;\nvarying vec4 v_color;\nvoid main()\n{\nvec4 p = czm_computePosition();\nv_color = color;\ngl_Position = czm_modelViewProjectionRelativeToEye * p;\n}\n"});define("Scene/PerInstanceColorAppearance",["../Core/defaultValue","../Core/defineProperties","../Core/VertexFormat","../Shaders/Appearances/PerInstanceColorAppearanceFS","../Shaders/Appearances/PerInstanceColorAppearanceVS","../Shaders/Appearances/PerInstanceFlatColorAppearanceFS","../Shaders/Appearances/PerInstanceFlatColorAppearanceVS","./Appearance"],function(e,t,r,i,n,a,o,s){"use strict";function u(t){t=e(t,e.EMPTY_OBJECT);var r=e(t.translucent,true);var l=e(t.closed,false);var c=e(t.flat,false);var d=c?o:n;var f=c?a:i;var h=c?u.FLAT_VERTEX_FORMAT:u.VERTEX_FORMAT;this.material=undefined;this.translucent=r;this._vertexShaderSource=e(t.vertexShaderSource,d);this._fragmentShaderSource=e(t.fragmentShaderSource,f);this._renderState=s.getDefaultRenderState(r,l,t.renderState);this._closed=l;this._vertexFormat=h;this._flat=c;this._faceForward=e(t.faceForward,!l)}t(u.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},vertexFormat:{get:function(){return this._vertexFormat}},flat:{get:function(){return this._flat}},faceForward:{get:function(){return this._faceForward}}});u.VERTEX_FORMAT=r.POSITION_AND_NORMAL;u.FLAT_VERTEX_FORMAT=r.POSITION_ONLY;u.prototype.getFragmentShaderSource=s.prototype.getFragmentShaderSource;u.prototype.isTranslucent=s.prototype.isTranslucent;u.prototype.getRenderState=s.prototype.getRenderState;return u});define("Renderer/BufferUsage",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";var r={STREAM_DRAW:t.STREAM_DRAW,STATIC_DRAW:t.STATIC_DRAW,DYNAMIC_DRAW:t.DYNAMIC_DRAW,validate:function(e){return e===r.STREAM_DRAW||e===r.STATIC_DRAW||e===r.DYNAMIC_DRAW}};return e(r)});define("Renderer/DrawCommand",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/PrimitiveType"],function(e,t,r,i){"use strict";function n(t){t=e(t,e.EMPTY_OBJECT);this._boundingVolume=t.boundingVolume;this._orientedBoundingBox=t.orientedBoundingBox;this._cull=e(t.cull,true);this._modelMatrix=t.modelMatrix;this._primitiveType=e(t.primitiveType,i.TRIANGLES);this._vertexArray=t.vertexArray;this._count=t.count;this._offset=e(t.offset,0);this._instanceCount=e(t.instanceCount,0);this._shaderProgram=t.shaderProgram;this._uniformMap=t.uniformMap;this._renderState=t.renderState;this._framebuffer=t.framebuffer;this._pass=t.pass;this._executeInClosestFrustum=e(t.executeInClosestFrustum,false);this._owner=t.owner;this._debugShowBoundingVolume=e(t.debugShowBoundingVolume,false);this._debugOverlappingFrustums=0;this._castShadows=e(t.castShadows,false);this._receiveShadows=e(t.receiveShadows,false);this.dirty=true;this.lastDirtyTime=0;this.derivedCommands={}}r(n.prototype,{boundingVolume:{get:function(){return this._boundingVolume},set:function(e){if(this._boundingVolume!==e){this._boundingVolume=e;this.dirty=true}}},orientedBoundingBox:{get:function(){return this._orientedBoundingBox},set:function(e){if(this._orientedBoundingBox!==e){this._orientedBoundingBox=e;this.dirty=true}}},cull:{get:function(){return this._cull},set:function(e){if(this._cull!==e){this._cull=e;this.dirty=true}}},modelMatrix:{get:function(){return this._modelMatrix},set:function(e){if(this._modelMatrix!==e){this._modelMatrix=e;this.dirty=true}}},primitiveType:{get:function(){return this._primitiveType},set:function(e){if(this._primitiveType!==e){this._primitiveType=e;this.dirty=true}}},vertexArray:{get:function(){return this._vertexArray},set:function(e){if(this._vertexArray!==e){this._vertexArray=e;this.dirty=true}}},count:{get:function(){return this._count},set:function(e){if(this._count!==e){this._count=e;this.dirty=true}}},offset:{get:function(){return this._offset},set:function(e){if(this._offset!==e){this._offset=e;this.dirty=true}}},instanceCount:{get:function(){return this._instanceCount},set:function(e){if(this._instanceCount!==e){this._instanceCount=e;this.dirty=true}}},shaderProgram:{get:function(){return this._shaderProgram},set:function(e){if(this._shaderProgram!==e){this._shaderProgram=e;this.dirty=true}}},castShadows:{get:function(){return this._castShadows},set:function(e){if(this._castShadows!==e){this._castShadows=e;this.dirty=true}}},receiveShadows:{get:function(){return this._receiveShadows},set:function(e){if(this._receiveShadows!==e){this._receiveShadows=e;this.dirty=true}}},uniformMap:{get:function(){return this._uniformMap},set:function(e){if(this._uniformMap!==e){this._uniformMap=e;this.dirty=true}}},renderState:{get:function(){return this._renderState},set:function(e){if(this._renderState!==e){this._renderState=e;this.dirty=true}}},framebuffer:{get:function(){return this._framebuffer},set:function(e){if(this._framebuffer!==e){this._framebuffer=e;this.dirty=true}}},pass:{get:function(){return this._pass},set:function(e){if(this._pass!==e){this._pass=e;this.dirty=true}}},executeInClosestFrustum:{get:function(){return this._executeInClosestFrustum},set:function(e){if(this._executeInClosestFrustum!==e){this._executeInClosestFrustum=e;this.dirty=true}}},owner:{get:function(){return this._owner},set:function(e){if(this._owner!==e){this._owner=e;this.dirty=true}}},debugShowBoundingVolume:{get:function(){return this._debugShowBoundingVolume},set:function(e){if(this._debugShowBoundingVolume!==e){this._debugShowBoundingVolume=e;this.dirty=true}}},debugOverlappingFrustums:{get:function(){return this._debugOverlappingFrustums},set:function(e){if(this._debugOverlappingFrustums!==e){this._debugOverlappingFrustums=e;this.dirty=true}}}});n.shallowClone=function(e,r){if(!t(e)){return undefined}if(!t(r)){r=new n}r._boundingVolume=e._boundingVolume;r._orientedBoundingBox=e._orientedBoundingBox;r._cull=e._cull;r._modelMatrix=e._modelMatrix;r._primitiveType=e._primitiveType;r._vertexArray=e._vertexArray;r._count=e._count;r._offset=e._offset;r._instanceCount=e._instanceCount;r._shaderProgram=e._shaderProgram;r._uniformMap=e._uniformMap;r._renderState=e._renderState;r._framebuffer=e._framebuffer;r._pass=e._pass;r._executeInClosestFrustum=e._executeInClosestFrustum;r._owner=e._owner;r._debugShowBoundingVolume=e._debugShowBoundingVolume;r._debugOverlappingFrustums=e._debugOverlappingFrustums;r._castShadows=e._castShadows;r._receiveShadows=e._receiveShadows;r.dirty=true;r.lastDirtyTime=0;return r};n.prototype.execute=function(e,t){e.draw(this,t)};return n});define("Renderer/Pass",["../Core/freezeObject"],function(e){"use strict";var t={ENVIRONMENT:0,COMPUTE:1,GLOBE:2,GROUND:3,OPAQUE:4,TRANSLUCENT:5,OVERLAY:6,NUMBER_OF_PASSES:7};return e(t)});define("Renderer/RenderState",["../Core/BoundingRectangle","../Core/Color","../Core/defaultValue","../Core/defined","../Core/DeveloperError","../Core/WebGLConstants","../Core/WindingOrder","./ContextLimits"],function(e,t,r,i,n,a,o,s){"use strict";function u(e){return e===a.FUNC_ADD||e===a.FUNC_SUBTRACT||e===a.FUNC_REVERSE_SUBTRACT}function l(e){return e===a.ZERO||e===a.ONE||e===a.SRC_COLOR||e===a.ONE_MINUS_SRC_COLOR||e===a.DST_COLOR||e===a.ONE_MINUS_DST_COLOR||e===a.SRC_ALPHA||e===a.ONE_MINUS_SRC_ALPHA||e===a.DST_ALPHA||e===a.ONE_MINUS_DST_ALPHA||e===a.CONSTANT_COLOR||e===a.ONE_MINUS_CONSTANT_COLOR||e===a.CONSTANT_ALPHA||e===a.ONE_MINUS_CONSTANT_ALPHA||e===a.SRC_ALPHA_SATURATE}function c(e){return e===a.FRONT||e===a.BACK||e===a.FRONT_AND_BACK}function d(e){return e===a.NEVER||e===a.LESS||e===a.EQUAL||e===a.LEQUAL||e===a.GREATER||e===a.NOTEQUAL||e===a.GEQUAL||e===a.ALWAYS}function f(e){return e===a.NEVER||e===a.LESS||e===a.EQUAL||e===a.LEQUAL||e===a.GREATER||e===a.NOTEQUAL||e===a.GEQUAL||e===a.ALWAYS}function h(e){return e===a.ZERO||e===a.KEEP||e===a.REPLACE||e===a.INCR||e===a.DECR||e===a.INVERT||e===a.INCR_WRAP||e===a.DECR_WRAP}function p(p){var m=r(p,{});var v=r(m.cull,{});var _=r(m.polygonOffset,{});var g=r(m.scissorTest,{});var y=r(g.rectangle,{});var w=r(m.depthRange,{});var C=r(m.depthTest,{});var b=r(m.colorMask,{});var S=r(m.blending,{});var E=r(S.color,{});var T=r(m.stencilTest,{});var x=r(T.frontOperation,{});var A=r(T.backOperation,{});var P=r(m.sampleCoverage,{});var D=m.viewport;this.frontFace=r(m.frontFace,o.COUNTER_CLOCKWISE);this.cull={enabled:r(v.enabled,false),face:r(v.face,a.BACK)};this.lineWidth=r(m.lineWidth,1);this.polygonOffset={enabled:r(_.enabled,false),factor:r(_.factor,0),units:r(_.units,0)};this.scissorTest={enabled:r(g.enabled,false),rectangle:e.clone(y)};this.depthRange={near:r(w.near,0),far:r(w.far,1)};this.depthTest={enabled:r(C.enabled,false),func:r(C.func,a.LESS)};this.colorMask={red:r(b.red,true),green:r(b.green,true),blue:r(b.blue,true),alpha:r(b.alpha,true)};this.depthMask=r(m.depthMask,true);this.stencilMask=r(m.stencilMask,~0);this.blending={enabled:r(S.enabled,false),color:new t(r(E.red,0),r(E.green,0),r(E.blue,0),r(E.alpha,0)),equationRgb:r(S.equationRgb,a.FUNC_ADD),equationAlpha:r(S.equationAlpha,a.FUNC_ADD),functionSourceRgb:r(S.functionSourceRgb,a.ONE),functionSourceAlpha:r(S.functionSourceAlpha,a.ONE),functionDestinationRgb:r(S.functionDestinationRgb,a.ZERO),functionDestinationAlpha:r(S.functionDestinationAlpha,a.ZERO)};this.stencilTest={enabled:r(T.enabled,false),frontFunction:r(T.frontFunction,a.ALWAYS),backFunction:r(T.backFunction,a.ALWAYS),reference:r(T.reference,0),mask:r(T.mask,~0),frontOperation:{fail:r(x.fail,a.KEEP),zFail:r(x.zFail,a.KEEP),zPass:r(x.zPass,a.KEEP)},backOperation:{fail:r(A.fail,a.KEEP),zFail:r(A.zFail,a.KEEP),zPass:r(A.zPass,a.KEEP)}};this.sampleCoverage={enabled:r(P.enabled,false),value:r(P.value,1),invert:r(P.invert,false)};this.viewport=i(D)?new e(D.x,D.y,D.width,D.height):undefined;if(this.lineWidth<s.minimumAliasedLineWidth||this.lineWidth>s.maximumAliasedLineWidth){throw new n("renderState.lineWidth is out of range.  Check minimumAliasedLineWidth and maximumAliasedLineWidth.")}if(!o.validate(this.frontFace)){throw new n("Invalid renderState.frontFace.")}if(!c(this.cull.face)){throw new n("Invalid renderState.cull.face.")}if(this.scissorTest.rectangle.width<0||this.scissorTest.rectangle.height<0){throw new n("renderState.scissorTest.rectangle.width and renderState.scissorTest.rectangle.height must be greater than or equal to zero.")}if(this.depthRange.near>this.depthRange.far){throw new n("renderState.depthRange.near can not be greater than renderState.depthRange.far.")}if(this.depthRange.near<0){throw new n("renderState.depthRange.near must be greater than or equal to zero.")}if(this.depthRange.far>1){throw new n("renderState.depthRange.far must be less than or equal to one.")}if(!d(this.depthTest.func)){throw new n("Invalid renderState.depthTest.func.")}if(this.blending.color.red<0||this.blending.color.red>1||this.blending.color.green<0||this.blending.color.green>1||this.blending.color.blue<0||this.blending.color.blue>1||this.blending.color.alpha<0||this.blending.color.alpha>1){throw new n("renderState.blending.color components must be greater than or equal to zero and less than or equal to one.")}if(!u(this.blending.equationRgb)){throw new n("Invalid renderState.blending.equationRgb.")}if(!u(this.blending.equationAlpha)){throw new n("Invalid renderState.blending.equationAlpha.")}if(!l(this.blending.functionSourceRgb)){throw new n("Invalid renderState.blending.functionSourceRgb.")}if(!l(this.blending.functionSourceAlpha)){throw new n("Invalid renderState.blending.functionSourceAlpha.")}if(!l(this.blending.functionDestinationRgb)){throw new n("Invalid renderState.blending.functionDestinationRgb.")}if(!l(this.blending.functionDestinationAlpha)){throw new n("Invalid renderState.blending.functionDestinationAlpha.")}if(!f(this.stencilTest.frontFunction)){throw new n("Invalid renderState.stencilTest.frontFunction.")}if(!f(this.stencilTest.backFunction)){throw new n("Invalid renderState.stencilTest.backFunction.")}if(!h(this.stencilTest.frontOperation.fail)){throw new n("Invalid renderState.stencilTest.frontOperation.fail.")}if(!h(this.stencilTest.frontOperation.zFail)){throw new n("Invalid renderState.stencilTest.frontOperation.zFail.")}if(!h(this.stencilTest.frontOperation.zPass)){throw new n("Invalid renderState.stencilTest.frontOperation.zPass.")}if(!h(this.stencilTest.backOperation.fail)){throw new n("Invalid renderState.stencilTest.backOperation.fail.")}if(!h(this.stencilTest.backOperation.zFail)){throw new n("Invalid renderState.stencilTest.backOperation.zFail.")}if(!h(this.stencilTest.backOperation.zPass)){throw new n("Invalid renderState.stencilTest.backOperation.zPass.")}if(i(this.viewport)){if(this.viewport.width<0){throw new n("renderState.viewport.width must be greater than or equal to zero.")}if(this.viewport.height<0){throw new n("renderState.viewport.height must be greater than or equal to zero.")}if(this.viewport.width>s.maximumViewportWidth){throw new n("renderState.viewport.width must be less than or equal to the maximum viewport width ("+s.maximumViewportWidth.toString()+").  Check maximumViewportWidth.")}if(this.viewport.height>s.maximumViewportHeight){throw new n("renderState.viewport.height must be less than or equal to the maximum viewport height ("+s.maximumViewportHeight.toString()+").  Check maximumViewportHeight.")}}this.id=0;this._applyFunctions=[]}var m=0;var v={};p.fromCache=function(e){var t=JSON.stringify(e);var r=v[t];if(i(r)){++r.referenceCount;return r.state}var n=new p(e);var a=JSON.stringify(n);r=v[a];if(!i(r)){n.id=m++;r={referenceCount:0,state:n};v[a]=r}++r.referenceCount;v[t]={referenceCount:1,state:r.state};return r.state};p.removeFromCache=function(e){var t=new p(e);var r=JSON.stringify(t);var n=v[r];var a=JSON.stringify(e);var o=v[a];if(i(o)){--o.referenceCount;if(o.referenceCount===0){delete v[a];if(i(n)){--n.referenceCount}}}if(i(n)&&n.referenceCount===0){delete v[r]}};p.getCache=function(){return v};p.clearCache=function(){v={}};function _(e,t,r){if(r){e.enable(t)}else{e.disable(t)}}function g(e,t){e.frontFace(t.frontFace)}function y(e,t){var r=t.cull;var i=r.enabled;_(e,e.CULL_FACE,i);if(i){e.cullFace(r.face)}}function w(e,t){e.lineWidth(t.lineWidth)}function C(e,t){var r=t.polygonOffset;var i=r.enabled;_(e,e.POLYGON_OFFSET_FILL,i);if(i){e.polygonOffset(r.factor,r.units)}}function b(e,t,r){var n=t.scissorTest;var a=i(r.scissorTest)?r.scissorTest.enabled:n.enabled;_(e,e.SCISSOR_TEST,a);if(a){var o=i(r.scissorTest)?r.scissorTest.rectangle:n.rectangle;e.scissor(o.x,o.y,o.width,o.height)}}function S(e,t){var r=t.depthRange;e.depthRange(r.near,r.far)}function E(e,t){var r=t.depthTest;var i=r.enabled;_(e,e.DEPTH_TEST,i);if(i){e.depthFunc(r.func)}}function T(e,t){var r=t.colorMask;e.colorMask(r.red,r.green,r.blue,r.alpha)}function x(e,t){e.depthMask(t.depthMask)}function A(e,t){e.stencilMask(t.stencilMask)}function P(e,t){e.blendColor(t.red,t.green,t.blue,t.alpha)}function D(e,t,r){var n=t.blending;var a=i(r.blendingEnabled)?r.blendingEnabled:n.enabled;_(e,e.BLEND,a);if(a){P(e,n.color);e.blendEquationSeparate(n.equationRgb,n.equationAlpha);e.blendFuncSeparate(n.functionSourceRgb,n.functionDestinationRgb,n.functionSourceAlpha,n.functionDestinationAlpha)}}function M(e,t){var r=t.stencilTest;var i=r.enabled;_(e,e.STENCIL_TEST,i);if(i){var n=r.frontFunction;var a=r.backFunction;var o=r.reference;var s=r.mask;e.stencilFunc(n,o,s);e.stencilFuncSeparate(e.BACK,a,o,s);e.stencilFuncSeparate(e.FRONT,n,o,s);var u=r.frontOperation;var l=u.fail;var c=u.zFail;var d=u.zPass;e.stencilOpSeparate(e.FRONT,l,c,d);var f=r.backOperation;var h=f.fail;var p=f.zFail;var m=f.zPass;e.stencilOpSeparate(e.BACK,h,p,m)}}function I(e,t){var r=t.sampleCoverage;var i=r.enabled;_(e,e.SAMPLE_COVERAGE,i);if(i){e.sampleCoverage(r.value,r.invert)}}var O=new e;function R(e,t,n){var a=r(t.viewport,n.viewport);if(!i(a)){a=O;a.width=n.context.drawingBufferWidth;a.height=n.context.drawingBufferHeight}n.context.uniformState.viewport=a;e.viewport(a.x,a.y,a.width,a.height)}p.apply=function(e,t,r){g(e,t);y(e,t);w(e,t);C(e,t);S(e,t);E(e,t);T(e,t);x(e,t);A(e,t);M(e,t);I(e,t);b(e,t,r);D(e,t,r);R(e,t,r)};function N(e,t){var r=[];if(e.frontFace!==t.frontFace){r.push(g)}if(e.cull.enabled!==t.cull.enabled||e.cull.face!==t.cull.face){r.push(y)}if(e.lineWidth!==t.lineWidth){r.push(w)}if(e.polygonOffset.enabled!==t.polygonOffset.enabled||e.polygonOffset.factor!==t.polygonOffset.factor||e.polygonOffset.units!==t.polygonOffset.units){r.push(C)}if(e.depthRange.near!==t.depthRange.near||e.depthRange.far!==t.depthRange.far){r.push(S)}if(e.depthTest.enabled!==t.depthTest.enabled||e.depthTest.func!==t.depthTest.func){r.push(E)}if(e.colorMask.red!==t.colorMask.red||e.colorMask.green!==t.colorMask.green||e.colorMask.blue!==t.colorMask.blue||e.colorMask.alpha!==t.colorMask.alpha){r.push(T)}if(e.depthMask!==t.depthMask){r.push(x)}if(e.stencilMask!==t.stencilMask){r.push(A)}
if(e.stencilTest.enabled!==t.stencilTest.enabled||e.stencilTest.frontFunction!==t.stencilTest.frontFunction||e.stencilTest.backFunction!==t.stencilTest.backFunction||e.stencilTest.reference!==t.stencilTest.reference||e.stencilTest.mask!==t.stencilTest.mask||e.stencilTest.frontOperation.fail!==t.stencilTest.frontOperation.fail||e.stencilTest.frontOperation.zFail!==t.stencilTest.frontOperation.zFail||e.stencilTest.backOperation.fail!==t.stencilTest.backOperation.fail||e.stencilTest.backOperation.zFail!==t.stencilTest.backOperation.zFail||e.stencilTest.backOperation.zPass!==t.stencilTest.backOperation.zPass){r.push(M)}if(e.sampleCoverage.enabled!==t.sampleCoverage.enabled||e.sampleCoverage.value!==t.sampleCoverage.value||e.sampleCoverage.invert!==t.sampleCoverage.invert){r.push(I)}return r}p.partialApply=function(e,t,r,n,a,o){if(t!==r){var s=r._applyFunctions[t.id];if(!i(s)){s=N(t,r);r._applyFunctions[t.id]=s}var u=s.length;for(var l=0;l<u;++l){s[l](e,r)}}var c=i(n.scissorTest)?n.scissorTest:t.scissorTest;var d=i(a.scissorTest)?a.scissorTest:r.scissorTest;if(c!==d||o){b(e,r,a)}var f=i(n.blendingEnabled)?n.blendingEnabled:t.blending.enabled;var h=i(a.blendingEnabled)?a.blendingEnabled:r.blending.enabled;if(f!==h||h&&t.blending!==r.blending){D(e,r,a)}if(t!==r||n!==a||n.context!==a.context){R(e,r,a)}};p.getState=function(r){if(!i(r)){throw new n("renderState is required.")}return{frontFace:r.frontFace,cull:{enabled:r.cull.enabled,face:r.cull.face},lineWidth:r.lineWidth,polygonOffset:{enabled:r.polygonOffset.enabled,factor:r.polygonOffset.factor,units:r.polygonOffset.units},scissorTest:{enabled:r.scissorTest.enabled,rectangle:e.clone(r.scissorTest.rectangle)},depthRange:{near:r.depthRange.near,far:r.depthRange.far},depthTest:{enabled:r.depthTest.enabled,func:r.depthTest.func},colorMask:{red:r.colorMask.red,green:r.colorMask.green,blue:r.colorMask.blue,alpha:r.colorMask.alpha},depthMask:r.depthMask,stencilMask:r.stencilMask,blending:{enabled:r.blending.enabled,color:t.clone(r.blending.color),equationRgb:r.blending.equationRgb,equationAlpha:r.blending.equationAlpha,functionSourceRgb:r.blending.functionSourceRgb,functionSourceAlpha:r.blending.functionSourceAlpha,functionDestinationRgb:r.blending.functionDestinationRgb,functionDestinationAlpha:r.blending.functionDestinationAlpha},stencilTest:{enabled:r.stencilTest.enabled,frontFunction:r.stencilTest.frontFunction,backFunction:r.stencilTest.backFunction,reference:r.stencilTest.reference,mask:r.stencilTest.mask,frontOperation:{fail:r.stencilTest.frontOperation.fail,zFail:r.stencilTest.frontOperation.zFail,zPass:r.stencilTest.frontOperation.zPass},backOperation:{fail:r.stencilTest.backOperation.fail,zFail:r.stencilTest.backOperation.zFail,zPass:r.stencilTest.backOperation.zPass}},sampleCoverage:{enabled:r.sampleCoverage.enabled,value:r.sampleCoverage.value,invert:r.sampleCoverage.invert},viewport:i(r.viewport)?e.clone(r.viewport):undefined}};return p});define("Renderer/AutomaticUniforms",["../Core/Cartesian3","../Core/Matrix4","../Core/WebGLConstants"],function(e,t,r){"use strict";var i=new e;function n(e){this._size=e.size;this._datatype=e.datatype;this.getValue=e.getValue}if(typeof WebGLRenderingContext==="undefined"){return{}}var a={};a[r.FLOAT]="float";a[r.FLOAT_VEC2]="vec2";a[r.FLOAT_VEC3]="vec3";a[r.FLOAT_VEC4]="vec4";a[r.INT]="int";a[r.INT_VEC2]="ivec2";a[r.INT_VEC3]="ivec3";a[r.INT_VEC4]="ivec4";a[r.BOOL]="bool";a[r.BOOL_VEC2]="bvec2";a[r.BOOL_VEC3]="bvec3";a[r.BOOL_VEC4]="bvec4";a[r.FLOAT_MAT2]="mat2";a[r.FLOAT_MAT3]="mat3";a[r.FLOAT_MAT4]="mat4";a[r.SAMPLER_2D]="sampler2D";a[r.SAMPLER_CUBE]="samplerCube";n.prototype.getDeclaration=function(e){var t="uniform "+a[this._datatype]+" "+e;var r=this._size;if(r===1){t+=";"}else{t+="["+r.toString()+"];"}return t};var o={czm_viewport:new n({size:1,datatype:r.FLOAT_VEC4,getValue:function(e){return e.viewportCartesian4}}),czm_viewportOrthographic:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.viewportOrthographic}}),czm_viewportTransformation:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.viewportTransformation}}),czm_globeDepthTexture:new n({size:1,datatype:r.SAMPLER_2D,getValue:function(e){return e.globeDepthTexture}}),czm_model:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.model}}),czm_inverseModel:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.inverseModel}}),czm_view:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.view}}),czm_view3D:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.view3D}}),czm_viewRotation:new n({size:1,datatype:r.FLOAT_MAT3,getValue:function(e){return e.viewRotation}}),czm_viewRotation3D:new n({size:1,datatype:r.FLOAT_MAT3,getValue:function(e){return e.viewRotation3D}}),czm_inverseView:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.inverseView}}),czm_inverseView3D:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.inverseView3D}}),czm_inverseViewRotation:new n({size:1,datatype:r.FLOAT_MAT3,getValue:function(e){return e.inverseViewRotation}}),czm_inverseViewRotation3D:new n({size:1,datatype:r.FLOAT_MAT3,getValue:function(e){return e.inverseViewRotation3D}}),czm_projection:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.projection}}),czm_inverseProjection:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.inverseProjection}}),czm_infiniteProjection:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.infiniteProjection}}),czm_modelView:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.modelView}}),czm_modelView3D:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.modelView3D}}),czm_modelViewRelativeToEye:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.modelViewRelativeToEye}}),czm_inverseModelView:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.inverseModelView}}),czm_inverseModelView3D:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.inverseModelView3D}}),czm_viewProjection:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.viewProjection}}),czm_inverseViewProjection:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.inverseViewProjection}}),czm_modelViewProjection:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.modelViewProjection}}),czm_inverseModelViewProjection:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.inverseModelViewProjection}}),czm_modelViewProjectionRelativeToEye:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.modelViewProjectionRelativeToEye}}),czm_modelViewInfiniteProjection:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.modelViewInfiniteProjection}}),czm_normal:new n({size:1,datatype:r.FLOAT_MAT3,getValue:function(e){return e.normal}}),czm_normal3D:new n({size:1,datatype:r.FLOAT_MAT3,getValue:function(e){return e.normal3D}}),czm_inverseNormal:new n({size:1,datatype:r.FLOAT_MAT3,getValue:function(e){return e.inverseNormal}}),czm_inverseNormal3D:new n({size:1,datatype:r.FLOAT_MAT3,getValue:function(e){return e.inverseNormal3D}}),czm_eyeHeight2D:new n({size:1,datatype:r.FLOAT_VEC2,getValue:function(e){return e.eyeHeight2D}}),czm_entireFrustum:new n({size:1,datatype:r.FLOAT_VEC2,getValue:function(e){return e.entireFrustum}}),czm_currentFrustum:new n({size:1,datatype:r.FLOAT_VEC2,getValue:function(e){return e.currentFrustum}}),czm_frustumPlanes:new n({size:1,datatype:r.FLOAT_VEC4,getValue:function(e){return e.frustumPlanes}}),czm_sunPositionWC:new n({size:1,datatype:r.FLOAT_VEC3,getValue:function(e){return e.sunPositionWC}}),czm_sunPositionColumbusView:new n({size:1,datatype:r.FLOAT_VEC3,getValue:function(e){return e.sunPositionColumbusView}}),czm_sunDirectionEC:new n({size:1,datatype:r.FLOAT_VEC3,getValue:function(e){return e.sunDirectionEC}}),czm_sunDirectionWC:new n({size:1,datatype:r.FLOAT_VEC3,getValue:function(e){return e.sunDirectionWC}}),czm_moonDirectionEC:new n({size:1,datatype:r.FLOAT_VEC3,getValue:function(e){return e.moonDirectionEC}}),czm_encodedCameraPositionMCHigh:new n({size:1,datatype:r.FLOAT_VEC3,getValue:function(e){return e.encodedCameraPositionMCHigh}}),czm_encodedCameraPositionMCLow:new n({size:1,datatype:r.FLOAT_VEC3,getValue:function(e){return e.encodedCameraPositionMCLow}}),czm_viewerPositionWC:new n({size:1,datatype:r.FLOAT_VEC3,getValue:function(e){return t.getTranslation(e.inverseView,i)}}),czm_frameNumber:new n({size:1,datatype:r.FLOAT,getValue:function(e){return e.frameState.frameNumber}}),czm_morphTime:new n({size:1,datatype:r.FLOAT,getValue:function(e){return e.frameState.morphTime}}),czm_sceneMode:new n({size:1,datatype:r.FLOAT,getValue:function(e){return e.frameState.mode}}),czm_pass:new n({size:1,datatype:r.FLOAT,getValue:function(e){return e.pass}}),czm_temeToPseudoFixed:new n({size:1,datatype:r.FLOAT_MAT3,getValue:function(e){return e.temeToPseudoFixedMatrix}}),czm_resolutionScale:new n({size:1,datatype:r.FLOAT,getValue:function(e){return e.resolutionScale}}),czm_fogDensity:new n({size:1,datatype:r.FLOAT,getValue:function(e){return e.fogDensity}}),czm_imagerySplitPosition:new n({size:1,datatype:r.FLOAT,getValue:function(e){return e.imagerySplitPosition}}),czm_geometricToleranceOverMeter:new n({size:1,datatype:r.FLOAT,getValue:function(e){return e.geometricToleranceOverMeter}})};return o});define("Renderer/createUniform",["../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Color","../Core/defined","../Core/DeveloperError","../Core/Matrix2","../Core/Matrix3","../Core/Matrix4","../Core/RuntimeError"],function(e,t,r,i,n,a,o,s,u,l){"use strict";function c(e,t,r,i){switch(t.type){case e.FLOAT:return new d(e,t,r,i);case e.FLOAT_VEC2:return new f(e,t,r,i);case e.FLOAT_VEC3:return new h(e,t,r,i);case e.FLOAT_VEC4:return new p(e,t,r,i);case e.SAMPLER_2D:case e.SAMPLER_CUBE:return new m(e,t,r,i);case e.INT:case e.BOOL:return new v(e,t,r,i);case e.INT_VEC2:case e.BOOL_VEC2:return new _(e,t,r,i);case e.INT_VEC3:case e.BOOL_VEC3:return new g(e,t,r,i);case e.INT_VEC4:case e.BOOL_VEC4:return new y(e,t,r,i);case e.FLOAT_MAT2:return new w(e,t,r,i);case e.FLOAT_MAT3:return new C(e,t,r,i);case e.FLOAT_MAT4:return new b(e,t,r,i);default:throw new l("Unrecognized uniform type: "+t.type+' for uniform "'+r+'".')}}function d(e,t,r,i){this.name=r;this.value=undefined;this._value=0;this._gl=e;this._location=i}d.prototype.set=function(){if(this.value!==this._value){this._value=this.value;this._gl.uniform1f(this._location,this.value)}};function f(t,r,i,n){this.name=i;this.value=undefined;this._value=new e;this._gl=t;this._location=n}f.prototype.set=function(){var t=this.value;if(!e.equals(t,this._value)){e.clone(t,this._value);this._gl.uniform2f(this._location,t.x,t.y)}};function h(e,t,r,i){this.name=r;this.value=undefined;this._value=undefined;this._gl=e;this._location=i}h.prototype.set=function(){var e=this.value;if(n(e.red)){if(!i.equals(e,this._value)){this._value=i.clone(e,this._value);this._gl.uniform3f(this._location,e.red,e.green,e.blue)}}else if(n(e.x)){if(!t.equals(e,this._value)){this._value=t.clone(e,this._value);this._gl.uniform3f(this._location,e.x,e.y,e.z)}}else{throw new a('Invalid vec3 value for uniform "'+this._activethis.name+'".')}};function p(e,t,r,i){this.name=r;this.value=undefined;this._value=undefined;this._gl=e;this._location=i}p.prototype.set=function(){var e=this.value;if(n(e.red)){if(!i.equals(e,this._value)){this._value=i.clone(e,this._value);this._gl.uniform4f(this._location,e.red,e.green,e.blue,e.alpha)}}else if(n(e.x)){if(!r.equals(e,this._value)){this._value=r.clone(e,this._value);this._gl.uniform4f(this._location,e.x,e.y,e.z,e.w)}}else{throw new a('Invalid vec4 value for uniform "'+this._activethis.name+'".')}};function m(e,t,r,i){this.name=r;this.value=undefined;this._gl=e;this._location=i;this.textureUnitIndex=undefined}m.prototype.set=function(){var e=this._gl;e.activeTexture(e.TEXTURE0+this.textureUnitIndex);var t=this.value;e.bindTexture(t._target,t._texture)};m.prototype._setSampler=function(e){this.textureUnitIndex=e;this._gl.uniform1i(this._location,e);return e+1};function v(e,t,r,i){this.name=r;this.value=undefined;this._value=0;this._gl=e;this._location=i}v.prototype.set=function(){if(this.value!==this._value){this._value=this.value;this._gl.uniform1i(this._location,this.value)}};function _(t,r,i,n){this.name=i;this.value=undefined;this._value=new e;this._gl=t;this._location=n}_.prototype.set=function(){var t=this.value;if(!e.equals(t,this._value)){e.clone(t,this._value);this._gl.uniform2i(this._location,t.x,t.y)}};function g(e,r,i,n){this.name=i;this.value=undefined;this._value=new t;this._gl=e;this._location=n}g.prototype.set=function(){var e=this.value;if(!t.equals(e,this._value)){t.clone(e,this._value);this._gl.uniform3i(this._location,e.x,e.y,e.z)}};function y(e,t,i,n){this.name=i;this.value=undefined;this._value=new r;this._gl=e;this._location=n}y.prototype.set=function(){var e=this.value;if(!r.equals(e,this._value)){r.clone(e,this._value);this._gl.uniform4i(this._location,e.x,e.y,e.z,e.w)}};function w(e,t,r,i){this.name=r;this.value=undefined;this._value=new Float32Array(4);this._gl=e;this._location=i}w.prototype.set=function(){if(!o.equalsArray(this.value,this._value,0)){o.toArray(this.value,this._value);this._gl.uniformMatrix2fv(this._location,false,this._value)}};function C(e,t,r,i){this.name=r;this.value=undefined;this._value=new Float32Array(9);this._gl=e;this._location=i}C.prototype.set=function(){if(!s.equalsArray(this.value,this._value,0)){s.toArray(this.value,this._value);this._gl.uniformMatrix3fv(this._location,false,this._value)}};function b(e,t,r,i){this.name=r;this.value=undefined;this._value=new Float32Array(16);this._gl=e;this._location=i}b.prototype.set=function(){if(!u.equalsArray(this.value,this._value,0)){u.toArray(this.value,this._value);this._gl.uniformMatrix4fv(this._location,false,this._value)}};return c});define("Renderer/createUniformArray",["../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Color","../Core/defined","../Core/DeveloperError","../Core/Matrix2","../Core/Matrix3","../Core/Matrix4","../Core/RuntimeError"],function(e,t,r,i,n,a,o,s,u,l){"use strict";function c(e,t,r,i){switch(t.type){case e.FLOAT:return new d(e,t,r,i);case e.FLOAT_VEC2:return new f(e,t,r,i);case e.FLOAT_VEC3:return new h(e,t,r,i);case e.FLOAT_VEC4:return new p(e,t,r,i);case e.SAMPLER_2D:case e.SAMPLER_CUBE:return new m(e,t,r,i);case e.INT:case e.BOOL:return new v(e,t,r,i);case e.INT_VEC2:case e.BOOL_VEC2:return new _(e,t,r,i);case e.INT_VEC3:case e.BOOL_VEC3:return new g(e,t,r,i);case e.INT_VEC4:case e.BOOL_VEC4:return new y(e,t,r,i);case e.FLOAT_MAT2:return new w(e,t,r,i);case e.FLOAT_MAT3:return new C(e,t,r,i);case e.FLOAT_MAT4:return new b(e,t,r,i);default:throw new l("Unrecognized uniform type: "+t.type+' for uniform "'+r+'".')}}function d(e,t,r,i){var n=i.length;this.name=r;this.value=new Array(n);this._value=new Float32Array(n);this._gl=e;this._location=i[0]}d.prototype.set=function(){var e=this.value;var t=e.length;var r=this._value;var i=false;for(var n=0;n<t;++n){var a=e[n];if(a!==r[n]){r[n]=a;i=true}}if(i){this._gl.uniform1fv(this._location,r)}};function f(e,t,r,i){var n=i.length;this.name=r;this.value=new Array(n);this._value=new Float32Array(n*2);this._gl=e;this._location=i[0]}f.prototype.set=function(){var t=this.value;var r=t.length;var i=this._value;var n=false;var a=0;for(var o=0;o<r;++o){var s=t[o];if(!e.equalsArray(s,i,a)){e.pack(s,i,a);n=true}a+=2}if(n){this._gl.uniform2fv(this._location,i)}};function h(e,t,r,i){var n=i.length;this.name=r;this.value=new Array(n);this._value=new Float32Array(n*3);this._gl=e;this._location=i[0]}h.prototype.set=function(){var e=this.value;var r=e.length;var i=this._value;var o=false;var s=0;for(var u=0;u<r;++u){var l=e[u];if(n(l.red)){if(l.red!==i[s]||l.green!==i[s+1]||l.blue!==i[s+2]){i[s]=l.red;i[s+1]=l.green;i[s+2]=l.blue;o=true}}else if(n(l.x)){if(!t.equalsArray(l,i,s)){t.pack(l,i,s);o=true}}else{throw new a("Invalid vec3 value.")}s+=3}if(o){this._gl.uniform3fv(this._location,i)}};function p(e,t,r,i){var n=i.length;this.name=r;this.value=new Array(n);this._value=new Float32Array(n*4);this._gl=e;this._location=i[0]}p.prototype.set=function(){var e=this.value;var t=e.length;var o=this._value;var s=false;var u=0;for(var l=0;l<t;++l){var c=e[l];if(n(c.red)){if(!i.equalsArray(c,o,u)){i.pack(c,o,u);s=true}}else if(n(c.x)){if(!r.equalsArray(c,o,u)){r.pack(c,o,u);s=true}}else{throw new a("Invalid vec4 value.")}u+=4}if(s){this._gl.uniform4fv(this._location,o)}};function m(e,t,r,i){var n=i.length;this.name=r;this.value=new Array(n);this._value=new Float32Array(n);this._gl=e;this._locations=i;this.textureUnitIndex=undefined}m.prototype.set=function(){var e=this._gl;var t=e.TEXTURE0+this.textureUnitIndex;var r=this.value;var i=r.length;for(var n=0;n<i;++n){var a=r[n];e.activeTexture(t+n);e.bindTexture(a._target,a._texture)}};m.prototype._setSampler=function(e){this.textureUnitIndex=e;var t=this._locations;var r=t.length;for(var i=0;i<r;++i){var n=e+i;this._gl.uniform1i(t[i],n)}return e+r};function v(e,t,r,i){var n=i.length;this.name=r;this.value=new Array(n);this._value=new Int32Array(n);this._gl=e;this._location=i[0]}v.prototype.set=function(){var e=this.value;var t=e.length;var r=this._value;var i=false;for(var n=0;n<t;++n){var a=e[n];if(a!==r[n]){r[n]=a;i=true}}if(i){this._gl.uniform1iv(this._location,r)}};function _(e,t,r,i){var n=i.length;this.name=r;this.value=new Array(n);this._value=new Int32Array(n*2);this._gl=e;this._location=i[0]}_.prototype.set=function(){var t=this.value;var r=t.length;var i=this._value;var n=false;var a=0;for(var o=0;o<r;++o){var s=t[o];if(!e.equalsArray(s,i,a)){e.pack(s,i,a);n=true}a+=2}if(n){this._gl.uniform2iv(this._location,i)}};function g(e,t,r,i){var n=i.length;this.name=r;this.value=new Array(n);this._value=new Int32Array(n*3);this._gl=e;this._location=i[0]}g.prototype.set=function(){var e=this.value;var r=e.length;var i=this._value;var n=false;var a=0;for(var o=0;o<r;++o){var s=e[o];if(!t.equalsArray(s,i,a)){t.pack(s,i,a);n=true}a+=3}if(n){this._gl.uniform3iv(this._location,i)}};function y(e,t,r,i){var n=i.length;this.name=r;this.value=new Array(n);this._value=new Int32Array(n*4);this._gl=e;this._location=i[0]}y.prototype.set=function(){var e=this.value;var t=e.length;var i=this._value;var n=false;var a=0;for(var o=0;o<t;++o){var s=e[o];if(!r.equalsArray(s,i,a)){r.pack(s,i,a);n=true}a+=4}if(n){this._gl.uniform4iv(this._location,i)}};function w(e,t,r,i){var n=i.length;this.name=r;this.value=new Array(n);this._value=new Float32Array(n*4);this._gl=e;this._location=i[0]}w.prototype.set=function(){var e=this.value;var t=e.length;var r=this._value;var i=false;var n=0;for(var a=0;a<t;++a){var s=e[a];if(!o.equalsArray(s,r,n)){o.pack(s,r,n);i=true}n+=4}if(i){this._gl.uniformMatrix2fv(this._location,false,r)}};function C(e,t,r,i){var n=i.length;this.name=r;this.value=new Array(n);this._value=new Float32Array(n*9);this._gl=e;this._location=i[0]}C.prototype.set=function(){var e=this.value;var t=e.length;var r=this._value;var i=false;var n=0;for(var a=0;a<t;++a){var o=e[a];if(!s.equalsArray(o,r,n)){s.pack(o,r,n);i=true}n+=9}if(i){this._gl.uniformMatrix3fv(this._location,false,r)}};function b(e,t,r,i){var n=i.length;this.name=r;this.value=new Array(n);this._value=new Float32Array(n*16);this._gl=e;this._location=i[0]}b.prototype.set=function(){var e=this.value;var t=e.length;var r=this._value;var i=false;var n=0;for(var a=0;a<t;++a){var o=e[a];if(!u.equalsArray(o,r,n)){u.pack(o,r,n);i=true}n+=16}if(i){this._gl.uniformMatrix4fv(this._location,false,r)}};return c});define("Renderer/ShaderProgram",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/RuntimeError","./AutomaticUniforms","./ContextLimits","./createUniform","./createUniformArray"],function(e,t,r,i,n,a,o,s,u,l){"use strict";var c=0;function d(e){var t=h(e.vertexShaderText,e.fragmentShaderText);this._gl=e.gl;this._logShaderCompilation=e.logShaderCompilation;this._debugShaders=e.debugShaders;this._attributeLocations=e.attributeLocations;this._program=undefined;this._numberOfVertexAttributes=undefined;this._vertexAttributes=undefined;this._uniformsByName=undefined;this._uniforms=undefined;this._automaticUniforms=undefined;this._manualUniforms=undefined;this._duplicateUniformNames=t.duplicateUniformNames;this._cachedShader=undefined;this.maximumTextureUnitIndex=undefined;this._vertexShaderSource=e.vertexShaderSource;this._vertexShaderText=e.vertexShaderText;this._fragmentShaderSource=e.fragmentShaderSource;this._fragmentShaderText=t.fragmentShaderText;this.id=c++}d.fromCache=function(r){r=e(r,e.EMPTY_OBJECT);if(!t(r.context)){throw new n("options.context is required.")}return r.context.shaderCache.getShaderProgram(r)};d.replaceCache=function(r){r=e(r,e.EMPTY_OBJECT);if(!t(r.context)){throw new n("options.context is required.")}return r.context.shaderCache.replaceShaderProgram(r)};r(d.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},vertexAttributes:{get:function(){w(this);return this._vertexAttributes}},numberOfVertexAttributes:{get:function(){w(this);return this._numberOfVertexAttributes}},allUniforms:{get:function(){w(this);return this._uniformsByName}}});function f(e){var r=[];var i=e.match(/uniform.*?(?![^{]*})(?=[=\[;])/g);if(t(i)){var n=i.length;for(var a=0;a<n;a++){var o=i[a].trim();var s=o.slice(o.lastIndexOf(" ")+1);r.push(s)}}return r}function h(e,t){var r={};if(!s.highpFloatSupported||!s.highpIntSupported){var i,n;var a;var o;var u=f(e);var l=f(t);var c=u.length;var d=l.length;for(i=0;i<c;i++){for(n=0;n<d;n++){if(u[i]===l[n]){a=u[i];o="czm_mediump_"+a;var h=new RegExp(a+"\\b","g");t=t.replace(h,o);r[o]=a}}}}return{fragmentShaderText:t,duplicateUniformNames:r}}var p="[Cesium WebGL] ";function m(e,r){var i=r._vertexShaderText;var n=r._fragmentShaderText;var o=e.createShader(e.VERTEX_SHADER);e.shaderSource(o,i);e.compileShader(o);var s=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(s,n);e.compileShader(s);var u=e.createProgram();e.attachShader(u,o);e.attachShader(u,s);e.deleteShader(o);e.deleteShader(s);var l=r._attributeLocations;if(t(l)){for(var c in l){if(l.hasOwnProperty(c)){e.bindAttribLocation(u,l[c],c)}}}e.linkProgram(u);var d;if(!e.getProgramParameter(u,e.LINK_STATUS)){var f=r._debugShaders;if(!e.getShaderParameter(s,e.COMPILE_STATUS)){d=e.getShaderInfoLog(s);console.error(p+"Fragment shader compile log: "+d);if(t(f)){var h=f.getTranslatedShaderSource(s);if(h!==""){console.error(p+"Translated fragment shader source:\n"+h)}else{console.error(p+"Fragment shader translation failed.")}}e.deleteProgram(u);throw new a("Fragment shader failed to compile.  Compile log: "+d)}if(!e.getShaderParameter(o,e.COMPILE_STATUS)){d=e.getShaderInfoLog(o);console.error(p+"Vertex shader compile log: "+d);if(t(f)){var m=f.getTranslatedShaderSource(o);if(m!==""){console.error(p+"Translated vertex shader source:\n"+m)}else{console.error(p+"Vertex shader translation failed.")}}e.deleteProgram(u);throw new a("Vertex shader failed to compile.  Compile log: "+d)}d=e.getProgramInfoLog(u);console.error(p+"Shader program link log: "+d);if(t(f)){console.error(p+"Translated vertex shader source:\n"+f.getTranslatedShaderSource(o));console.error(p+"Translated fragment shader source:\n"+f.getTranslatedShaderSource(s))}e.deleteProgram(u);throw new a("Program failed to link.  Link log: "+d)}var v=r._logShaderCompilation;if(v){d=e.getShaderInfoLog(o);if(t(d)&&d.length>0){console.log(p+"Vertex shader compile log: "+d)}}if(v){d=e.getShaderInfoLog(s);if(t(d)&&d.length>0){console.log(p+"Fragment shader compile log: "+d)}}if(v){d=e.getProgramInfoLog(u);if(t(d)&&d.length>0){console.log(p+"Shader program link log: "+d)}}return u}function v(e,t,r){var i={};for(var n=0;n<r;++n){var a=e.getActiveAttrib(t,n);var o=e.getAttribLocation(t,a.name);i[a.name]={name:a.name,type:a.type,index:o}}return i}function _(e,r){var i={};var n=[];var a=[];var o=e.getProgramParameter(r,e.ACTIVE_UNIFORMS);for(var s=0;s<o;++s){var c=e.getActiveUniform(r,s);var d="[0]";var f=c.name.indexOf(d,c.name.length-d.length)!==-1?c.name.slice(0,c.name.length-3):c.name;if(f.indexOf("gl_")!==0){if(c.name.indexOf("[")<0){var h=e.getUniformLocation(r,f);if(h!==null){var p=u(e,c,f,h);i[f]=p;n.push(p);if(p._setSampler){a.push(p)}}}else{var m;var v;var _;var g;var y=f.indexOf("[");if(y>=0){m=i[f.slice(0,y)];if(!t(m)){continue}v=m._locations;if(v.length<=1){_=m.value;g=e.getUniformLocation(r,f);if(g!==null){v.push(g);_.push(e.getUniform(r,g))}}}else{v=[];for(var w=0;w<c.size;++w){g=e.getUniformLocation(r,f+"["+w+"]");if(g!==null){v.push(g)}}m=l(e,c,f,v);i[f]=m;n.push(m);if(m._setSampler){a.push(m)}}}}}return{uniformsByName:i,uniforms:n,samplerUniforms:a}}function g(e,r){var i=[];var n=[];for(var a in r){if(r.hasOwnProperty(a)){var s=r[a];var u=a;var l=e._duplicateUniformNames[u];if(t(l)){s.name=l;u=l}var c=o[u];if(t(c)){i.push({uniform:s,automaticUniform:c})}else{n.push(s)}}}return{automaticUniforms:i,manualUniforms:n}}function y(e,t,r){e.useProgram(t);var i=0;var n=r.length;for(var a=0;a<n;++a){i=r[a]._setSampler(i)}e.useProgram(null);return i}function w(e){if(t(e._program)){return}var r=e._gl;var i=m(r,e,e._debugShaders);var n=r.getProgramParameter(i,r.ACTIVE_ATTRIBUTES);var a=_(r,i);var o=g(e,a.uniformsByName);e._program=i;e._numberOfVertexAttributes=n;e._vertexAttributes=v(r,i,n);e._uniformsByName=a.uniformsByName;e._uniforms=a.uniforms;e._automaticUniforms=o.automaticUniforms;e._manualUniforms=o.manualUniforms;e.maximumTextureUnitIndex=y(r,i,a.samplerUniforms)}d.prototype._bind=function(){w(this);this._gl.useProgram(this._program)};d.prototype._setUniforms=function(e,r,i){var a;var o;if(t(e)){var s=this._manualUniforms;a=s.length;for(o=0;o<a;++o){var u=s[o];u.value=e[u.name]()}}var l=this._automaticUniforms;a=l.length;for(o=0;o<a;++o){var c=l[o];c.uniform.value=c.automaticUniform.getValue(r)}var d=this._uniforms;a=d.length;for(o=0;o<a;++o){d[o].set()}if(i){var f=this._gl;var h=this._program;f.validateProgram(h);if(!f.getProgramParameter(h,f.VALIDATE_STATUS)){throw new n("Program validation failed.  Program info log: "+f.getProgramInfoLog(h))}}};d.prototype.isDestroyed=function(){return false};d.prototype.destroy=function(){this._cachedShader.cache.releaseShaderProgram(this);return undefined};d.prototype.finalDestroy=function(){this._gl.deleteProgram(this._program);return i(this)};return d});define("Shaders/Builtin/Constants/degreesPerRadian",[],function(){"use strict";return"const float czm_degreesPerRadian = 57.29577951308232;\n"});define("Shaders/Builtin/Constants/depthRange",[],function(){"use strict";return"const czm_depthRangeStruct czm_depthRange = czm_depthRangeStruct(0.0, 1.0);\n"});define("Shaders/Builtin/Constants/epsilon1",[],function(){"use strict";return"const float czm_epsilon1 = 0.1;\n"});define("Shaders/Builtin/Constants/epsilon2",[],function(){"use strict";return"const float czm_epsilon2 = 0.01;\n"});define("Shaders/Builtin/Constants/epsilon3",[],function(){"use strict";return"const float czm_epsilon3 = 0.001;\n"});define("Shaders/Builtin/Constants/epsilon4",[],function(){"use strict";return"const float czm_epsilon4 = 0.0001;\n"});define("Shaders/Builtin/Constants/epsilon5",[],function(){"use strict";return"const float czm_epsilon5 = 0.00001;\n"});define("Shaders/Builtin/Constants/epsilon6",[],function(){"use strict";return"const float czm_epsilon6 = 0.000001;\n"});define("Shaders/Builtin/Constants/epsilon7",[],function(){"use strict";return"const float czm_epsilon7 = 0.0000001;\n"});define("Shaders/Builtin/Constants/infinity",[],function(){"use strict";return"const float czm_infinity = 5906376272000.0;\n"});define("Shaders/Builtin/Constants/oneOverPi",[],function(){"use strict";return"const float czm_oneOverPi = 0.3183098861837907;\n"});define("Shaders/Builtin/Constants/oneOverTwoPi",[],function(){"use strict";return"const float czm_oneOverTwoPi = 0.15915494309189535;\n"});define("Shaders/Builtin/Constants/passCompute",[],function(){"use strict";return"const float czm_passCompute = 1.0;\n"});define("Shaders/Builtin/Constants/passEnvironment",[],function(){"use strict";return"const float czm_passEnvironment = 0.0;\n"});define("Shaders/Builtin/Constants/passGlobe",[],function(){"use strict";return"const float czm_passGlobe = 2.0;\n"});define("Shaders/Builtin/Constants/passGround",[],function(){"use strict";return"const float czm_passGround = 3.0;\n"});define("Shaders/Builtin/Constants/passOpaque",[],function(){"use strict";return"const float czm_passOpaque = 4.0;\n"});define("Shaders/Builtin/Constants/passOverlay",[],function(){"use strict";return"const float czm_passOverlay = 6.0;\n"});define("Shaders/Builtin/Constants/passTranslucent",[],function(){"use strict";return"const float czm_passTranslucent = 5.0;\n"});define("Shaders/Builtin/Constants/pi",[],function(){"use strict";return"const float czm_pi = 3.141592653589793;\n"});define("Shaders/Builtin/Constants/piOverFour",[],function(){"use strict";return"const float czm_piOverFour = 0.7853981633974483;\n"});define("Shaders/Builtin/Constants/piOverSix",[],function(){"use strict";return"const float czm_piOverSix = 0.5235987755982988;\n"});define("Shaders/Builtin/Constants/piOverThree",[],function(){"use strict";return"const float czm_piOverThree = 1.0471975511965976;\n"});define("Shaders/Builtin/Constants/piOverTwo",[],function(){"use strict";return"const float czm_piOverTwo = 1.5707963267948966;\n"});define("Shaders/Builtin/Constants/radiansPerDegree",[],function(){"use strict";return"const float czm_radiansPerDegree = 0.017453292519943295;\n"});define("Shaders/Builtin/Constants/sceneMode2D",[],function(){"use strict";return"const float czm_sceneMode2D = 2.0;\n"});define("Shaders/Builtin/Constants/sceneMode3D",[],function(){"use strict";return"const float czm_sceneMode3D = 3.0;\n"});define("Shaders/Builtin/Constants/sceneModeColumbusView",[],function(){"use strict";return"const float czm_sceneModeColumbusView = 1.0;\n"});define("Shaders/Builtin/Constants/sceneModeMorphing",[],function(){"use strict";return"const float czm_sceneModeMorphing = 0.0;\n"});define("Shaders/Builtin/Constants/solarRadius",[],function(){"use strict";return"const float czm_solarRadius = 695500000.0;\n"});define("Shaders/Builtin/Constants/threePiOver2",[],function(){"use strict";return"const float czm_threePiOver2 = 4.71238898038469;\n"});define("Shaders/Builtin/Constants/twoPi",[],function(){"use strict";return"const float czm_twoPi = 6.283185307179586;\n"});define("Shaders/Builtin/Constants/webMercatorMaxLatitude",[],function(){"use strict";return"const float czm_webMercatorMaxLatitude = 1.4844222297453324;\n"});define("Shaders/Builtin/Structs/depthRangeStruct",[],function(){"use strict";return"struct czm_depthRangeStruct\n{\nfloat near;\nfloat far;\n};\n"});define("Shaders/Builtin/Structs/ellipsoid",[],function(){"use strict";return"struct czm_ellipsoid\n{\nvec3 center;\nvec3 radii;\nvec3 inverseRadii;\nvec3 inverseRadiiSquared;\n};\n"});define("Shaders/Builtin/Structs/material",[],function(){"use strict";return"struct czm_material\n{\nvec3 diffuse;\nfloat specular;\nfloat shininess;\nvec3 normal;\nvec3 emission;\nfloat alpha;\n};\n"});define("Shaders/Builtin/Structs/materialInput",[],function(){"use strict";return"struct czm_materialInput\n{\nfloat s;\nvec2 st;\nvec3 str;\nvec3 normalEC;\nmat3 tangentToEyeMatrix;\nvec3 positionToEyeEC;\n};\n"});define("Shaders/Builtin/Structs/ray",[],function(){"use strict";return"struct czm_ray\n{\nvec3 origin;\nvec3 direction;\n};\n"});define("Shaders/Builtin/Structs/raySegment",[],function(){"use strict"
;return"struct czm_raySegment\n{\nfloat start;\nfloat stop;\n};\nconst czm_raySegment czm_emptyRaySegment = czm_raySegment(-czm_infinity, -czm_infinity);\nconst czm_raySegment czm_fullRaySegment = czm_raySegment(0.0, czm_infinity);\n"});define("Shaders/Builtin/Structs/shadowParameters",[],function(){"use strict";return"struct czm_shadowParameters\n{\n#ifdef USE_CUBE_MAP_SHADOW\nvec3 texCoords;\n#else\nvec2 texCoords;\n#endif\nfloat depthBias;\nfloat depth;\nfloat nDotL;\nvec2 texelStepSize;\nfloat normalShadingSmooth;\nfloat darkness;\n};\n"});define("Shaders/Builtin/Functions/alphaWeight",[],function(){"use strict";return"float czm_alphaWeight(float a)\n{\nfloat x = 2.0 * (gl_FragCoord.x - czm_viewport.x) / czm_viewport.z - 1.0;\nfloat y = 2.0 * (gl_FragCoord.y - czm_viewport.y) / czm_viewport.w - 1.0;\nfloat z = (gl_FragCoord.z - czm_viewportTransformation[3][2]) / czm_viewportTransformation[2][2];\nvec4 q = vec4(x, y, z, 0.0);\nq /= gl_FragCoord.w;\nif (czm_inverseProjection != mat4(0.0)) {\nq = czm_inverseProjection * q;\n} else {\nfloat top = czm_frustumPlanes.x;\nfloat bottom = czm_frustumPlanes.y;\nfloat left = czm_frustumPlanes.z;\nfloat right = czm_frustumPlanes.w;\nfloat near = czm_currentFrustum.x;\nfloat far = czm_currentFrustum.y;\nq.x = (q.x * (right - left) + left + right) * 0.5;\nq.y = (q.y * (top - bottom) + bottom + top) * 0.5;\nq.z = (q.z * (near - far) - near - far) * 0.5;\nq.w = 1.0;\n}\nreturn pow(a + 0.01, 4.0) + max(1e-2, min(3.0 * 1e3, 100.0 / (1e-5 + pow(abs(z) / 10.0, 3.0) + pow(abs(z) / 200.0, 6.0))));\n}\n"});define("Shaders/Builtin/Functions/antialias",[],function(){"use strict";return"vec4 czm_antialias(vec4 color1, vec4 color2, vec4 currentColor, float dist, float fuzzFactor)\n{\nfloat val1 = clamp(dist / fuzzFactor, 0.0, 1.0);\nfloat val2 = clamp((dist - 0.5) / fuzzFactor, 0.0, 1.0);\nval1 = val1 * (1.0 - val2);\nval1 = val1 * val1 * (3.0 - (2.0 * val1));\nval1 = pow(val1, 0.5);\nvec4 midColor = (color1 + color2) * 0.5;\nreturn mix(midColor, currentColor, val1);\n}\nvec4 czm_antialias(vec4 color1, vec4 color2, vec4 currentColor, float dist)\n{\nreturn czm_antialias(color1, color2, currentColor, dist, 0.1);\n}\n"});define("Shaders/Builtin/Functions/cascadeColor",[],function(){"use strict";return"vec4 czm_cascadeColor(vec4 weights)\n{\nreturn vec4(1.0, 0.0, 0.0, 1.0) * weights.x +\nvec4(0.0, 1.0, 0.0, 1.0) * weights.y +\nvec4(0.0, 0.0, 1.0, 1.0) * weights.z +\nvec4(1.0, 0.0, 1.0, 1.0) * weights.w;\n}\n"});define("Shaders/Builtin/Functions/cascadeDistance",[],function(){"use strict";return"uniform vec4 shadowMap_cascadeDistances;\nfloat czm_cascadeDistance(vec4 weights)\n{\nreturn dot(shadowMap_cascadeDistances, weights);\n}\n"});define("Shaders/Builtin/Functions/cascadeMatrix",[],function(){"use strict";return"uniform mat4 shadowMap_cascadeMatrices[4];\nmat4 czm_cascadeMatrix(vec4 weights)\n{\nreturn shadowMap_cascadeMatrices[0] * weights.x +\nshadowMap_cascadeMatrices[1] * weights.y +\nshadowMap_cascadeMatrices[2] * weights.z +\nshadowMap_cascadeMatrices[3] * weights.w;\n}\n"});define("Shaders/Builtin/Functions/cascadeWeights",[],function(){"use strict";return"uniform vec4 shadowMap_cascadeSplits[2];\nvec4 czm_cascadeWeights(float depthEye)\n{\nvec4 near = step(shadowMap_cascadeSplits[0], vec4(depthEye));\nvec4 far = step(depthEye, shadowMap_cascadeSplits[1]);\nreturn near * far;\n}\n"});define("Shaders/Builtin/Functions/columbusViewMorph",[],function(){"use strict";return"vec4 czm_columbusViewMorph(vec4 position2D, vec4 position3D, float time)\n{\nvec3 p = mix(position2D.xyz, position3D.xyz, time);\nreturn vec4(p, 1.0);\n}\n"});define("Shaders/Builtin/Functions/computePosition",[],function(){"use strict";return"vec4 czm_computePosition();\n"});define("Shaders/Builtin/Functions/cosineAndSine",[],function(){"use strict";return"vec2 cordic(float angle)\n{\nvec2 vector = vec2(6.0725293500888267e-1, 0.0);\nfloat sense = (angle < 0.0) ? -1.0 : 1.0;\nmat2 rotation = mat2(1.0, sense, -sense, 1.0);\nvector = rotation * vector;\nangle -= sense * 7.8539816339744828e-1;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfloat factor = sense * 5.0e-1;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 4.6364760900080609e-1;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 2.5e-1;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 2.4497866312686414e-1;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 1.25e-1;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 1.2435499454676144e-1;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 6.25e-2;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 6.2418809995957350e-2;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 3.125e-2;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 3.1239833430268277e-2;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 1.5625e-2;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 1.5623728620476831e-2;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 7.8125e-3;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 7.8123410601011111e-3;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 3.90625e-3;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 3.9062301319669718e-3;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 1.953125e-3;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 1.9531225164788188e-3;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 9.765625e-4;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 9.7656218955931946e-4;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 4.8828125e-4;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 4.8828121119489829e-4;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 2.44140625e-4;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 2.4414062014936177e-4;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 1.220703125e-4;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 1.2207031189367021e-4;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 6.103515625e-5;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 6.1035156174208773e-5;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 3.0517578125e-5;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 3.0517578115526096e-5;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 1.52587890625e-5;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 1.5258789061315762e-5;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 7.62939453125e-6;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 7.6293945311019700e-6;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 3.814697265625e-6;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 3.8146972656064961e-6;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 1.9073486328125e-6;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 1.9073486328101870e-6;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 9.5367431640625e-7;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 9.5367431640596084e-7;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 4.76837158203125e-7;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 4.7683715820308884e-7;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 2.384185791015625e-7;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 2.3841857910155797e-7;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 1.1920928955078125e-7;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nreturn vector;\n}\nvec2 czm_cosineAndSine(float angle)\n{\nif (angle < -czm_piOverTwo || angle > czm_piOverTwo)\n{\nif (angle < 0.0)\n{\nreturn -cordic(angle + czm_pi);\n}\nelse\n{\nreturn -cordic(angle - czm_pi);\n}\n}\nelse\n{\nreturn cordic(angle);\n}\n}\n"});define("Shaders/Builtin/Functions/decompressTextureCoordinates",[],function(){"use strict";return"vec2 czm_decompressTextureCoordinates(float encoded)\n{\nfloat temp = encoded / 4096.0;\nfloat xZeroTo4095 = floor(temp);\nfloat stx = xZeroTo4095 / 4095.0;\nfloat sty = (encoded - xZeroTo4095 * 4096.0) / 4095.0;\nreturn vec2(stx, sty);\n}\n"});define("Shaders/Builtin/Functions/eastNorthUpToEyeCoordinates",[],function(){"use strict";return"mat3 czm_eastNorthUpToEyeCoordinates(vec3 positionMC, vec3 normalEC)\n{\nvec3 tangentMC = normalize(vec3(-positionMC.y, positionMC.x, 0.0));\nvec3 tangentEC = normalize(czm_normal3D * tangentMC);\nvec3 bitangentEC = normalize(cross(normalEC, tangentEC));\nreturn mat3(\ntangentEC.x,   tangentEC.y,   tangentEC.z,\nbitangentEC.x, bitangentEC.y, bitangentEC.z,\nnormalEC.x,    normalEC.y,    normalEC.z);\n}\n"});define("Shaders/Builtin/Functions/ellipsoidContainsPoint",[],function(){"use strict";return"bool czm_ellipsoidContainsPoint(czm_ellipsoid ellipsoid, vec3 point)\n{\nvec3 scaled = ellipsoid.inverseRadii * (czm_inverseModelView * vec4(point, 1.0)).xyz;\nreturn (dot(scaled, scaled) <= 1.0);\n}\n"});define("Shaders/Builtin/Functions/ellipsoidNew",[],function(){"use strict";return"czm_ellipsoid czm_ellipsoidNew(vec3 center, vec3 radii)\n{\nvec3 inverseRadii = vec3(1.0 / radii.x, 1.0 / radii.y, 1.0 / radii.z);\nvec3 inverseRadiiSquared = inverseRadii * inverseRadii;\nczm_ellipsoid temp = czm_ellipsoid(center, radii, inverseRadii, inverseRadiiSquared);\nreturn temp;\n}\n"});define("Shaders/Builtin/Functions/ellipsoidWgs84TextureCoordinates",[],function(){"use strict";return"vec2 czm_ellipsoidWgs84TextureCoordinates(vec3 normal)\n{\nreturn vec2(atan(normal.y, normal.x) * czm_oneOverTwoPi + 0.5, asin(normal.z) * czm_oneOverPi + 0.5);\n}\n"});define("Shaders/Builtin/Functions/equalsEpsilon",[],function(){"use strict";return"bool czm_equalsEpsilon(vec4 left, vec4 right, float epsilon) {\nreturn all(lessThanEqual(abs(left - right), vec4(epsilon)));\n}\nbool czm_equalsEpsilon(vec3 left, vec3 right, float epsilon) {\nreturn all(lessThanEqual(abs(left - right), vec3(epsilon)));\n}\nbool czm_equalsEpsilon(vec2 left, vec2 right, float epsilon) {\nreturn all(lessThanEqual(abs(left - right), vec2(epsilon)));\n}\nbool czm_equalsEpsilon(float left, float right, float epsilon) {\nreturn (abs(left - right) <= epsilon);\n}\n"});define("Shaders/Builtin/Functions/eyeOffset",[],function(){"use strict";return"vec4 czm_eyeOffset(vec4 positionEC, vec3 eyeOffset)\n{\nvec4 p = positionEC;\nvec4 zEyeOffset = normalize(p) * eyeOffset.z;\np.xy += eyeOffset.xy + zEyeOffset.xy;\np.z += zEyeOffset.z;\nreturn p;\n}\n"});define("Shaders/Builtin/Functions/eyeToWindowCoordinates",[],function(){"use strict";return"vec4 czm_eyeToWindowCoordinates(vec4 positionEC)\n{\nvec4 q = czm_projection * positionEC;\nq.xyz /= q.w;\nq.xyz = (czm_viewportTransformation * vec4(q.xyz, 1.0)).xyz;\nreturn q;\n}\n"});define("Shaders/Builtin/Functions/fog",[],function(){"use strict";return"vec3 czm_fog(float distanceToCamera, vec3 color, vec3 fogColor)\n{\nfloat scalar = distanceToCamera * czm_fogDensity;\nfloat fog = 1.0 - exp(-(scalar * scalar));\nreturn mix(color, fogColor, fog);\n}\n"});define("Shaders/Builtin/Functions/geodeticSurfaceNormal",[],function(){"use strict";return"vec3 czm_geodeticSurfaceNormal(vec3 positionOnEllipsoid, vec3 ellipsoidCenter, vec3 oneOverEllipsoidRadiiSquared)\n{\nreturn normalize((positionOnEllipsoid - ellipsoidCenter) * oneOverEllipsoidRadiiSquared);\n}\n"});define("Shaders/Builtin/Functions/getDefaultMaterial",[],function(){"use strict";return"czm_material czm_getDefaultMaterial(czm_materialInput materialInput)\n{\nczm_material material;\nmaterial.diffuse = vec3(0.0);\nmaterial.specular = 0.0;\nmaterial.shininess = 1.0;\nmaterial.normal = materialInput.normalEC;\nmaterial.emission = vec3(0.0);\nmaterial.alpha = 1.0;\nreturn material;\n}\n"});define("Shaders/Builtin/Functions/getLambertDiffuse",[],function(){"use strict";return"float czm_getLambertDiffuse(vec3 lightDirectionEC, vec3 normalEC)\n{\nreturn max(dot(lightDirectionEC, normalEC), 0.0);\n}\n"});define("Shaders/Builtin/Functions/getSpecular",[],function(){"use strict";return"float czm_getSpecular(vec3 lightDirectionEC, vec3 toEyeEC, vec3 normalEC, float shininess)\n{\nvec3 toReflectedLight = reflect(-lightDirectionEC, normalEC);\nfloat specular = max(dot(toReflectedLight, toEyeEC), 0.0);\nreturn pow(specular, max(shininess, czm_epsilon2));\n}\n"});define("Shaders/Builtin/Functions/getWaterNoise",[],function(){"use strict";return"vec4 czm_getWaterNoise(sampler2D normalMap, vec2 uv, float time, float angleInRadians)\n{\nfloat cosAngle = cos(angleInRadians);\nfloat sinAngle = sin(angleInRadians);\nvec2 s0 = vec2(1.0/17.0, 0.0);\nvec2 s1 = vec2(-1.0/29.0, 0.0);\nvec2 s2 = vec2(1.0/101.0, 1.0/59.0);\nvec2 s3 = vec2(-1.0/109.0, -1.0/57.0);\ns0 = vec2((cosAngle * s0.x) - (sinAngle * s0.y), (sinAngle * s0.x) + (cosAngle * s0.y));\ns1 = vec2((cosAngle * s1.x) - (sinAngle * s1.y), (sinAngle * s1.x) + (cosAngle * s1.y));\ns2 = vec2((cosAngle * s2.x) - (sinAngle * s2.y), (sinAngle * s2.x) + (cosAngle * s2.y));\ns3 = vec2((cosAngle * s3.x) - (sinAngle * s3.y), (sinAngle * s3.x) + (cosAngle * s3.y));\nvec2 uv0 = (uv/103.0) + (time * s0);\nvec2 uv1 = uv/107.0 + (time * s1) + vec2(0.23);\nvec2 uv2 = uv/vec2(897.0, 983.0) + (time * s2) + vec2(0.51);\nvec2 uv3 = uv/vec2(991.0, 877.0) + (time * s3) + vec2(0.71);\nuv0 = fract(uv0);\nuv1 = fract(uv1);\nuv2 = fract(uv2);\nuv3 = fract(uv3);\nvec4 noise = (texture2D(normalMap, uv0)) +\n(texture2D(normalMap, uv1)) +\n(texture2D(normalMap, uv2)) +\n(texture2D(normalMap, uv3));\nreturn ((noise / 4.0) - 0.5) * 2.0;\n}\n"});define("Shaders/Builtin/Functions/getWgs84EllipsoidEC",[],function(){"use strict";return"czm_ellipsoid czm_getWgs84EllipsoidEC()\n{\nvec3 radii = vec3(6378137.0, 6378137.0, 6356752.314245);\nvec3 inverseRadii = vec3(1.0 / radii.x, 1.0 / radii.y, 1.0 / radii.z);\nvec3 inverseRadiiSquared = inverseRadii * inverseRadii;\nczm_ellipsoid temp = czm_ellipsoid(czm_view[3].xyz, radii, inverseRadii, inverseRadiiSquared);\nreturn temp;\n}\n"});define("Shaders/Builtin/Functions/HSBToRGB",[],function(){"use strict";return"const vec4 K_HSB2RGB = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\nvec3 czm_HSBToRGB(vec3 hsb)\n{\nvec3 p = abs(fract(hsb.xxx + K_HSB2RGB.xyz) * 6.0 - K_HSB2RGB.www);\nreturn hsb.z * mix(K_HSB2RGB.xxx, clamp(p - K_HSB2RGB.xxx, 0.0, 1.0), hsb.y);\n}\n"});define("Shaders/Builtin/Functions/HSLToRGB",[],function(){"use strict";return"vec3 hueToRGB(float hue)\n{\nfloat r = abs(hue * 6.0 - 3.0) - 1.0;\nfloat g = 2.0 - abs(hue * 6.0 - 2.0);\nfloat b = 2.0 - abs(hue * 6.0 - 4.0);\nreturn clamp(vec3(r, g, b), 0.0, 1.0);\n}\nvec3 czm_HSLToRGB(vec3 hsl)\n{\nvec3 rgb = hueToRGB(hsl.x);\nfloat c = (1.0 - abs(2.0 * hsl.z - 1.0)) * hsl.y;\nreturn (rgb - 0.5) * c + hsl.z;\n}\n"});define("Shaders/Builtin/Functions/hue",[],function(){"use strict";return"vec3 czm_hue(vec3 rgb, float adjustment)\n{\nconst mat3 toYIQ = mat3(0.299,     0.587,     0.114,\n0.595716, -0.274453, -0.321263,\n0.211456, -0.522591,  0.311135);\nconst mat3 toRGB = mat3(1.0,  0.9563,  0.6210,\n1.0, -0.2721, -0.6474,\n1.0, -1.107,   1.7046);\nvec3 yiq = toYIQ * rgb;\nfloat hue = atan(yiq.z, yiq.y) + adjustment;\nfloat chroma = sqrt(yiq.z * yiq.z + yiq.y * yiq.y);\nvec3 color = vec3(yiq.x, chroma * cos(hue), chroma * sin(hue));\nreturn toRGB * color;\n}\n"});define("Shaders/Builtin/Functions/isEmpty",[],function(){"use strict";return"bool czm_isEmpty(czm_raySegment interval)\n{\nreturn (interval.stop < 0.0);\n}\n"});define("Shaders/Builtin/Functions/isFull",[],function(){"use strict";return"bool czm_isFull(czm_raySegment interval)\n{\nreturn (interval.start == 0.0 && interval.stop == czm_infinity);\n}\n"});define("Shaders/Builtin/Functions/latitudeToWebMercatorFraction",[],function(){"use strict";return"float czm_latitudeToWebMercatorFraction(float latitude, float southMercatorY, float oneOverMercatorHeight)\n{\nfloat sinLatitude = sin(latitude);\nfloat mercatorY = 0.5 * log((1.0 + sinLatitude) / (1.0 - sinLatitude));\nreturn (mercatorY - southMercatorY) * oneOverMercatorHeight;\n}\n"});define("Shaders/Builtin/Functions/luminance",[],function(){"use strict";return"float czm_luminance(vec3 rgb)\n{\nconst vec3 W = vec3(0.2125, 0.7154, 0.0721);\nreturn dot(rgb, W);\n}\n"});define("Shaders/Builtin/Functions/metersPerPixel",[],function(){"use strict";return"float czm_metersPerPixel(vec4 positionEC)\n{\nfloat width = czm_viewport.z;\nfloat height = czm_viewport.w;\nfloat pixelWidth;\nfloat pixelHeight;\nfloat top = czm_frustumPlanes.x;\nfloat bottom = czm_frustumPlanes.y;\nfloat left = czm_frustumPlanes.z;\nfloat right = czm_frustumPlanes.w;\nif (czm_sceneMode == czm_sceneMode2D)\n{\nfloat frustumWidth = right - left;\nfloat frustumHeight = top - bottom;\npixelWidth = frustumWidth / width;\npixelHeight = frustumHeight / height;\n}\nelse\n{\nfloat distanceToPixel = -positionEC.z;\nfloat inverseNear = 1.0 / czm_currentFrustum.x;\nfloat tanTheta = top * inverseNear;\npixelHeight = 2.0 * distanceToPixel * tanTheta / height;\ntanTheta = right * inverseNear;\npixelWidth = 2.0 * distanceToPixel * tanTheta / width;\n}\nreturn max(pixelWidth, pixelHeight);\n}\n"});define("Shaders/Builtin/Functions/modelToWindowCoordinates",[],function(){"use strict";return"vec4 czm_modelToWindowCoordinates(vec4 position)\n{\nvec4 q = czm_modelViewProjection * position;\nq.xyz /= q.w;\nq.xyz = (czm_viewportTransformation * vec4(q.xyz, 1.0)).xyz;\nreturn q;\n}\n"});define("Shaders/Builtin/Functions/multiplyWithColorBalance",[],function(){"use strict";return"vec3 czm_multiplyWithColorBalance(vec3 left, vec3 right)\n{\nconst vec3 W = vec3(0.2125, 0.7154, 0.0721);\nvec3 target = left * right;\nfloat leftLuminance = dot(left, W);\nfloat rightLuminance = dot(right, W);\nfloat targetLuminance = dot(target, W);\nreturn ((leftLuminance + rightLuminance) / (2.0 * targetLuminance)) * target;\n}\n"});define("Shaders/Builtin/Functions/nearFarScalar",[],function(){"use strict";return"float czm_nearFarScalar(vec4 nearFarScalar, float cameraDistSq)\n{\nfloat valueAtMin = nearFarScalar.y;\nfloat valueAtMax = nearFarScalar.w;\nfloat nearDistanceSq = nearFarScalar.x * nearFarScalar.x;\nfloat farDistanceSq = nearFarScalar.z * nearFarScalar.z;\nfloat t = (cameraDistSq - nearDistanceSq) / (farDistanceSq - nearDistanceSq);\nt = pow(clamp(t, 0.0, 1.0), 0.2);\nreturn mix(valueAtMin, valueAtMax, t);\n}\n"});define("Shaders/Builtin/Functions/octDecode",[],function(){"use strict";return"vec3 czm_octDecode(vec2 encoded, float range)\n{\nif (encoded.x == 0.0 && encoded.y == 0.0) {\nreturn vec3(0.0, 0.0, 0.0);\n}\nencoded = encoded / range * 2.0 - 1.0;\nvec3 v = vec3(encoded.x, encoded.y, 1.0 - abs(encoded.x) - abs(encoded.y));\nif (v.z < 0.0)\n{\nv.xy = (1.0 - abs(v.yx)) * czm_signNotZero(v.xy);\n}\nreturn normalize(v);\n}\nvec3 czm_octDecode(vec2 encoded)\n{\nreturn czm_octDecode(encoded, 255.0);\n}\nvec3 czm_octDecode(float encoded)\n{\nfloat temp = encoded / 256.0;\nfloat x = floor(temp);\nfloat y = (temp - x) * 256.0;\nreturn czm_octDecode(vec2(x, y));\n}\nvoid czm_octDecode(vec2 encoded, out vec3 vector1, out vec3 vector2, out vec3 vector3)\n{\nfloat temp = encoded.x / 65536.0;\nfloat x = floor(temp);\nfloat encodedFloat1 = (temp - x) * 65536.0;\ntemp = encoded.y / 65536.0;\nfloat y = floor(temp);\nfloat encodedFloat2 = (temp - y) * 65536.0;\nvector1 = czm_octDecode(encodedFloat1);\nvector2 = czm_octDecode(encodedFloat2);\nvector3 = czm_octDecode(vec2(x, y));\n}\n"});define("Shaders/Builtin/Functions/packDepth",[],function(){"use strict";return"vec4 czm_packDepth(float depth)\n{\nvec4 enc = vec4(1.0, 255.0, 65025.0, 16581375.0) * depth;\nenc = fract(enc);\nenc -= enc.yzww * vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0, 0.0);\nreturn enc;\n}\n"});define("Shaders/Builtin/Functions/phong",[],function(){"use strict";return"float czm_private_getLambertDiffuseOfMaterial(vec3 lightDirectionEC, czm_material material)\n{\nreturn czm_getLambertDiffuse(lightDirectionEC, material.normal);\n}\nfloat czm_private_getSpecularOfMaterial(vec3 lightDirectionEC, vec3 toEyeEC, czm_material material)\n{\nreturn czm_getSpecular(lightDirectionEC, toEyeEC, material.normal, material.shininess);\n}\nvec4 czm_phong(vec3 toEye, czm_material material)\n{\nfloat diffuse = czm_private_getLambertDiffuseOfMaterial(vec3(0.0, 0.0, 1.0), material);\nif (czm_sceneMode == czm_sceneMode3D) {\ndiffuse += czm_private_getLambertDiffuseOfMaterial(vec3(0.0, 1.0, 0.0), material);\n}\nfloat specular = czm_private_getSpecularOfMaterial(czm_sunDirectionEC, toEye, material) + czm_private_getSpecularOfMaterial(czm_moonDirectionEC, toEye, material);\nvec3 materialDiffuse = material.diffuse * 0.5;\nvec3 ambient = materialDiffuse;\nvec3 color = ambient + material.emission;\ncolor += materialDiffuse * diffuse;\ncolor += material.specular * specular;\nreturn vec4(color, material.alpha);\n}\nvec4 czm_private_phong(vec3 toEye, czm_material material)\n{\nfloat diffuse = czm_private_getLambertDiffuseOfMaterial(czm_sunDirectionEC, material);\nfloat specular = czm_private_getSpecularOfMaterial(czm_sunDirectionEC, toEye, material);\nvec3 ambient = vec3(0.0);\nvec3 color = ambient + material.emission;\ncolor += material.diffuse * diffuse;\ncolor += material.specular * specular;\nreturn vec4(color, material.alpha);\n}\n"});define("Shaders/Builtin/Functions/pointAlongRay",[],function(){"use strict";return"vec3 czm_pointAlongRay(czm_ray ray, float time)\n{\nreturn ray.origin + (time * ray.direction);\n}\n"});define("Shaders/Builtin/Functions/rayEllipsoidIntersectionInterval",[],function(){"use strict";return"czm_raySegment czm_rayEllipsoidIntersectionInterval(czm_ray ray, czm_ellipsoid ellipsoid)\n{\nvec3 q = ellipsoid.inverseRadii * (czm_inverseModelView * vec4(ray.origin, 1.0)).xyz;\nvec3 w = ellipsoid.inverseRadii * (czm_inverseModelView * vec4(ray.direction, 0.0)).xyz;\nq = q - ellipsoid.inverseRadii * (czm_inverseModelView * vec4(ellipsoid.center, 1.0)).xyz;\nfloat q2 = dot(q, q);\nfloat qw = dot(q, w);\nif (q2 > 1.0)\n{\nif (qw >= 0.0)\n{\nreturn czm_emptyRaySegment;\n}\nelse\n{\nfloat qw2 = qw * qw;\nfloat difference = q2 - 1.0;\nfloat w2 = dot(w, w);\nfloat product = w2 * difference;\nif (qw2 < product)\n{\nreturn czm_emptyRaySegment;\n}\nelse if (qw2 > product)\n{\nfloat discriminant = qw * qw - product;\nfloat temp = -qw + sqrt(discriminant);\nfloat root0 = temp / w2;\nfloat root1 = difference / temp;\nif (root0 < root1)\n{\nczm_raySegment i = czm_raySegment(root0, root1);\nreturn i;\n}\nelse\n{\nczm_raySegment i = czm_raySegment(root1, root0);\nreturn i;\n}\n}\nelse\n{\nfloat root = sqrt(difference / w2);\nczm_raySegment i = czm_raySegment(root, root);\nreturn i;\n}\n}\n}\nelse if (q2 < 1.0)\n{\nfloat difference = q2 - 1.0;\nfloat w2 = dot(w, w);\nfloat product = w2 * difference;\nfloat discriminant = qw * qw - product;\nfloat temp = -qw + sqrt(discriminant);\nczm_raySegment i = czm_raySegment(0.0, temp / w2);\nreturn i;\n}\nelse\n{\nif (qw < 0.0)\n{\nfloat w2 = dot(w, w);\nczm_raySegment i = czm_raySegment(0.0, -qw / w2);\nreturn i;\n}\nelse\n{\nreturn czm_emptyRaySegment;\n}\n}\n}\n"});define("Shaders/Builtin/Functions/RGBToHSB",[],function(){"use strict";return"const vec4 K_RGB2HSB = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\nvec3 czm_RGBToHSB(vec3 rgb)\n{\nvec4 p = mix(vec4(rgb.bg, K_RGB2HSB.wz), vec4(rgb.gb, K_RGB2HSB.xy), step(rgb.b, rgb.g));\nvec4 q = mix(vec4(p.xyw, rgb.r), vec4(rgb.r, p.yzx), step(p.x, rgb.r));\nfloat d = q.x - min(q.w, q.y);\nreturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + czm_epsilon7)), d / (q.x + czm_epsilon7), q.x);\n}\n"});define("Shaders/Builtin/Functions/RGBToHSL",[],function(){"use strict";return"vec3 RGBtoHCV(vec3 rgb)\n{\nvec4 p = (rgb.g < rgb.b) ? vec4(rgb.bg, -1.0, 2.0 / 3.0) : vec4(rgb.gb, 0.0, -1.0 / 3.0);\nvec4 q = (rgb.r < p.x) ? vec4(p.xyw, rgb.r) : vec4(rgb.r, p.yzx);\nfloat c = q.x - min(q.w, q.y);\nfloat h = abs((q.w - q.y) / (6.0 * c + czm_epsilon7) + q.z);\nreturn vec3(h, c, q.x);\n}\nvec3 czm_RGBToHSL(vec3 rgb)\n{\nvec3 hcv = RGBtoHCV(rgb);\nfloat l = hcv.z - hcv.y * 0.5;\nfloat s = hcv.y / (1.0 - abs(l * 2.0 - 1.0) + czm_epsilon7);\nreturn vec3(hcv.x, s, l);\n}\n"});define("Shaders/Builtin/Functions/RGBToXYZ",[],function(){"use strict";return"vec3 czm_RGBToXYZ(vec3 rgb)\n{\nconst mat3 RGB2XYZ = mat3(0.4124, 0.2126, 0.0193,\n0.3576, 0.7152, 0.1192,\n0.1805, 0.0722, 0.9505);\nvec3 xyz = RGB2XYZ * rgb;\nvec3 Yxy;\nYxy.r = xyz.g;\nfloat temp = dot(vec3(1.0), xyz);\nYxy.gb = xyz.rg / temp;\nreturn Yxy;\n}\n"});define("Shaders/Builtin/Functions/saturation",[],function(){"use strict";return"vec3 czm_saturation(vec3 rgb, float adjustment)\n{\nconst vec3 W = vec3(0.2125, 0.7154, 0.0721);\nvec3 intensity = vec3(dot(rgb, W));\nreturn mix(intensity, rgb, adjustment);\n}\n"});define("Shaders/Builtin/Functions/shadowDepthCompare",[],function(){"use strict";return"float czm_sampleShadowMap(samplerCube shadowMap, vec3 d)\n{\nreturn czm_unpackDepth(textureCube(shadowMap, d));\n}\nfloat czm_sampleShadowMap(sampler2D shadowMap, vec2 uv)\n{\n#ifdef USE_SHADOW_DEPTH_TEXTURE\nreturn texture2D(shadowMap, uv).r;\n#else\nreturn czm_unpackDepth(texture2D(shadowMap, uv));\n#endif\n}\nfloat czm_shadowDepthCompare(samplerCube shadowMap, vec3 uv, float depth)\n{\nreturn step(depth, czm_sampleShadowMap(shadowMap, uv));\n}\nfloat czm_shadowDepthCompare(sampler2D shadowMap, vec2 uv, float depth)\n{\nreturn step(depth, czm_sampleShadowMap(shadowMap, uv));\n}\n"});define("Shaders/Builtin/Functions/shadowVisibility",[],function(){"use strict";return"float czm_private_shadowVisibility(float visibility, float nDotL, float normalShadingSmooth, float darkness)\n{\n#ifdef USE_NORMAL_SHADING\n#ifdef USE_NORMAL_SHADING_SMOOTH\nfloat strength = clamp(nDotL / normalShadingSmooth, 0.0, 1.0);\n#else\nfloat strength = step(0.0, nDotL);\n#endif\nvisibility *= strength;\n#endif\nvisibility = max(visibility, darkness);\nreturn visibility;\n}\n#ifdef USE_CUBE_MAP_SHADOW\nfloat czm_shadowVisibility(samplerCube shadowMap, czm_shadowParameters shadowParameters)\n{\nfloat depthBias = shadowParameters.depthBias;\nfloat depth = shadowParameters.depth;\nfloat nDotL = shadowParameters.nDotL;\nfloat normalShadingSmooth = shadowParameters.normalShadingSmooth;\nfloat darkness = shadowParameters.darkness;\nvec3 uvw = shadowParameters.texCoords;\ndepth -= depthBias;\nfloat visibility = czm_shadowDepthCompare(shadowMap, uvw, depth);\nreturn czm_private_shadowVisibility(visibility, nDotL, normalShadingSmooth, darkness);\n}\n#else\nfloat czm_shadowVisibility(sampler2D shadowMap, czm_shadowParameters shadowParameters)\n{\nfloat depthBias = shadowParameters.depthBias;\nfloat depth = shadowParameters.depth;\nfloat nDotL = shadowParameters.nDotL;\nfloat normalShadingSmooth = shadowParameters.normalShadingSmooth;\nfloat darkness = shadowParameters.darkness;\nvec2 uv = shadowParameters.texCoords;\ndepth -= depthBias;\n#ifdef USE_SOFT_SHADOWS\nvec2 texelStepSize = shadowParameters.texelStepSize;\nfloat radius = 1.0;\nfloat dx0 = -texelStepSize.x * radius;\nfloat dy0 = -texelStepSize.y * radius;\nfloat dx1 = texelStepSize.x * radius;\nfloat dy1 = texelStepSize.y * radius;\nfloat visibility = (\nczm_shadowDepthCompare(shadowMap, uv, depth) +\nczm_shadowDepthCompare(shadowMap, uv + vec2(dx0, dy0), depth) +\nczm_shadowDepthCompare(shadowMap, uv + vec2(0.0, dy0), depth) +\nczm_shadowDepthCompare(shadowMap, uv + vec2(dx1, dy0), depth) +\nczm_shadowDepthCompare(shadowMap, uv + vec2(dx0, 0.0), depth) +\nczm_shadowDepthCompare(shadowMap, uv + vec2(dx1, 0.0), depth) +\nczm_shadowDepthCompare(shadowMap, uv + vec2(dx0, dy1), depth) +\nczm_shadowDepthCompare(shadowMap, uv + vec2(0.0, dy1), depth) +\nczm_shadowDepthCompare(shadowMap, uv + vec2(dx1, dy1), depth)\n) * (1.0 / 9.0);\n#else\nfloat visibility = czm_shadowDepthCompare(shadowMap, uv, depth);\n#endif\nreturn czm_private_shadowVisibility(visibility, nDotL, normalShadingSmooth, darkness);\n}\n#endif\n"});define("Shaders/Builtin/Functions/signNotZero",[],function(){"use strict";return"float czm_signNotZero(float value)\n{\nreturn value >= 0.0 ? 1.0 : -1.0;\n}\nvec2 czm_signNotZero(vec2 value)\n{\nreturn vec2(czm_signNotZero(value.x), czm_signNotZero(value.y));\n}\nvec3 czm_signNotZero(vec3 value)\n{\nreturn vec3(czm_signNotZero(value.x), czm_signNotZero(value.y), czm_signNotZero(value.z));\n}\nvec4 czm_signNotZero(vec4 value)\n{\nreturn vec4(czm_signNotZero(value.x), czm_signNotZero(value.y), czm_signNotZero(value.z), czm_signNotZero(value.w));\n}\n"});define("Shaders/Builtin/Functions/tangentToEyeSpaceMatrix",[],function(){"use strict";return"mat3 czm_tangentToEyeSpaceMatrix(vec3 normalEC, vec3 tangentEC, vec3 bitangentEC)\n{\nvec3 normal = normalize(normalEC);\nvec3 tangent = normalize(tangentEC);\nvec3 bitangent = normalize(bitangentEC);\nreturn mat3(tangent.x  , tangent.y  , tangent.z,\nbitangent.x, bitangent.y, bitangent.z,\nnormal.x   , normal.y   , normal.z);\n}\n"});define("Shaders/Builtin/Functions/translateRelativeToEye",[],function(){"use strict";return"vec4 czm_translateRelativeToEye(vec3 high, vec3 low)\n{\nvec3 highDifference = high - czm_encodedCameraPositionMCHigh;\nvec3 lowDifference = low - czm_encodedCameraPositionMCLow;\nreturn vec4(highDifference + lowDifference, 1.0);\n}\n"});define("Shaders/Builtin/Functions/translucentPhong",[],function(){"use strict";return"vec4 czm_translucentPhong(vec3 toEye, czm_material material)\n{\nfloat diffuse = czm_getLambertDiffuse(vec3(0.0, 0.0, 1.0), material.normal);\nif (czm_sceneMode == czm_sceneMode3D) {\ndiffuse += czm_getLambertDiffuse(vec3(0.0, 1.0, 0.0), material.normal);\n}\ndiffuse = clamp(diffuse, 0.0, 1.0);\nfloat specular = czm_getSpecular(czm_sunDirectionEC, toEye, material.normal, material.shininess);\nspecular += czm_getSpecular(czm_moonDirectionEC, toEye, material.normal, material.shininess);\nvec3 materialDiffuse = material.diffuse * 0.5;\nvec3 ambient = materialDiffuse;\nvec3 color = ambient + material.emission;\ncolor += materialDiffuse * diffuse;\ncolor += material.specular * specular;\nreturn vec4(color, material.alpha);\n}\n"});define("Shaders/Builtin/Functions/transpose",[],function(){"use strict";return"mat2 czm_transpose(mat2 matrix)\n{\nreturn mat2(\nmatrix[0][0], matrix[1][0],\nmatrix[0][1], matrix[1][1]);\n}\nmat3 czm_transpose(mat3 matrix)\n{\nreturn mat3(\nmatrix[0][0], matrix[1][0], matrix[2][0],\nmatrix[0][1], matrix[1][1], matrix[2][1],\nmatrix[0][2], matrix[1][2], matrix[2][2]);\n}\nmat4 czm_transpose(mat4 matrix)\n{\nreturn mat4(\nmatrix[0][0], matrix[1][0], matrix[2][0], matrix[3][0],\nmatrix[0][1], matrix[1][1], matrix[2][1], matrix[3][1],\nmatrix[0][2], matrix[1][2], matrix[2][2], matrix[3][2],\nmatrix[0][3], matrix[1][3], matrix[2][3], matrix[3][3]);\n}\n"});define("Shaders/Builtin/Functions/unpackDepth",[],function(){"use strict";return"float czm_unpackDepth(vec4 packedDepth)\n{\nreturn dot(packedDepth, vec4(1.0, 1.0 / 255.0, 1.0 / 65025.0, 1.0 / 16581375.0));\n}\n"});define("Shaders/Builtin/Functions/windowToEyeCoordinates",[],function(){"use strict"
;return"vec4 czm_windowToEyeCoordinates(vec4 fragmentCoordinate)\n{\nfloat x = 2.0 * (fragmentCoordinate.x - czm_viewport.x) / czm_viewport.z - 1.0;\nfloat y = 2.0 * (fragmentCoordinate.y - czm_viewport.y) / czm_viewport.w - 1.0;\nfloat z = (fragmentCoordinate.z - czm_viewportTransformation[3][2]) / czm_viewportTransformation[2][2];\nvec4 q = vec4(x, y, z, 1.0);\nq /= fragmentCoordinate.w;\nif (czm_inverseProjection != mat4(0.0)) {\nq = czm_inverseProjection * q;\n} else {\nfloat top = czm_frustumPlanes.x;\nfloat bottom = czm_frustumPlanes.y;\nfloat left = czm_frustumPlanes.z;\nfloat right = czm_frustumPlanes.w;\nfloat near = czm_currentFrustum.x;\nfloat far = czm_currentFrustum.y;\nq.x = (q.x * (right - left) + left + right) * 0.5;\nq.y = (q.y * (top - bottom) + bottom + top) * 0.5;\nq.z = (q.z * (near - far) - near - far) * 0.5;\nq.w = 1.0;\n}\nreturn q;\n}\n"});define("Shaders/Builtin/Functions/XYZToRGB",[],function(){"use strict";return"vec3 czm_XYZToRGB(vec3 Yxy)\n{\nconst mat3 XYZ2RGB = mat3( 3.2405, -0.9693,  0.0556,\n-1.5371,  1.8760, -0.2040,\n-0.4985,  0.0416,  1.0572);\nvec3 xyz;\nxyz.r = Yxy.r * Yxy.g / Yxy.b;\nxyz.g = Yxy.r;\nxyz.b = Yxy.r * (1.0 - Yxy.g - Yxy.b) / Yxy.b;\nreturn XYZ2RGB * xyz;\n}\n"});define("Shaders/Builtin/CzmBuiltins",["./Constants/degreesPerRadian","./Constants/depthRange","./Constants/epsilon1","./Constants/epsilon2","./Constants/epsilon3","./Constants/epsilon4","./Constants/epsilon5","./Constants/epsilon6","./Constants/epsilon7","./Constants/infinity","./Constants/oneOverPi","./Constants/oneOverTwoPi","./Constants/passCompute","./Constants/passEnvironment","./Constants/passGlobe","./Constants/passGround","./Constants/passOpaque","./Constants/passOverlay","./Constants/passTranslucent","./Constants/pi","./Constants/piOverFour","./Constants/piOverSix","./Constants/piOverThree","./Constants/piOverTwo","./Constants/radiansPerDegree","./Constants/sceneMode2D","./Constants/sceneMode3D","./Constants/sceneModeColumbusView","./Constants/sceneModeMorphing","./Constants/solarRadius","./Constants/threePiOver2","./Constants/twoPi","./Constants/webMercatorMaxLatitude","./Structs/depthRangeStruct","./Structs/ellipsoid","./Structs/material","./Structs/materialInput","./Structs/ray","./Structs/raySegment","./Structs/shadowParameters","./Functions/alphaWeight","./Functions/antialias","./Functions/cascadeColor","./Functions/cascadeDistance","./Functions/cascadeMatrix","./Functions/cascadeWeights","./Functions/columbusViewMorph","./Functions/computePosition","./Functions/cosineAndSine","./Functions/decompressTextureCoordinates","./Functions/eastNorthUpToEyeCoordinates","./Functions/ellipsoidContainsPoint","./Functions/ellipsoidNew","./Functions/ellipsoidWgs84TextureCoordinates","./Functions/equalsEpsilon","./Functions/eyeOffset","./Functions/eyeToWindowCoordinates","./Functions/fog","./Functions/geodeticSurfaceNormal","./Functions/getDefaultMaterial","./Functions/getLambertDiffuse","./Functions/getSpecular","./Functions/getWaterNoise","./Functions/getWgs84EllipsoidEC","./Functions/HSBToRGB","./Functions/HSLToRGB","./Functions/hue","./Functions/isEmpty","./Functions/isFull","./Functions/latitudeToWebMercatorFraction","./Functions/luminance","./Functions/metersPerPixel","./Functions/modelToWindowCoordinates","./Functions/multiplyWithColorBalance","./Functions/nearFarScalar","./Functions/octDecode","./Functions/packDepth","./Functions/phong","./Functions/pointAlongRay","./Functions/rayEllipsoidIntersectionInterval","./Functions/RGBToHSB","./Functions/RGBToHSL","./Functions/RGBToXYZ","./Functions/saturation","./Functions/shadowDepthCompare","./Functions/shadowVisibility","./Functions/signNotZero","./Functions/tangentToEyeSpaceMatrix","./Functions/translateRelativeToEye","./Functions/translucentPhong","./Functions/transpose","./Functions/unpackDepth","./Functions/windowToEyeCoordinates","./Functions/XYZToRGB"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w,C,b,S,E,T,x,A,P,D,M,I,O,R,N,L,B,F,k,V,z,U,q,G,H,W,j,Y,X,Z,K,Q,J,$,ee,te,re,ie,ne,ae,oe,se,ue,le,ce,de,fe,he,pe,me,ve,_e,ge,ye,we,Ce,be,Se,Ee,Te,xe,Ae,Pe,De,Me,Ie,Oe,Re,Ne,Le,Be,Fe,ke,Ve){"use strict";return{czm_degreesPerRadian:e,czm_depthRange:t,czm_epsilon1:r,czm_epsilon2:i,czm_epsilon3:n,czm_epsilon4:a,czm_epsilon5:o,czm_epsilon6:s,czm_epsilon7:u,czm_infinity:l,czm_oneOverPi:c,czm_oneOverTwoPi:d,czm_passCompute:f,czm_passEnvironment:h,czm_passGlobe:p,czm_passGround:m,czm_passOpaque:v,czm_passOverlay:_,czm_passTranslucent:g,czm_pi:y,czm_piOverFour:w,czm_piOverSix:C,czm_piOverThree:b,czm_piOverTwo:S,czm_radiansPerDegree:E,czm_sceneMode2D:T,czm_sceneMode3D:x,czm_sceneModeColumbusView:A,czm_sceneModeMorphing:P,czm_solarRadius:D,czm_threePiOver2:M,czm_twoPi:I,czm_webMercatorMaxLatitude:O,czm_depthRangeStruct:R,czm_ellipsoid:N,czm_material:L,czm_materialInput:B,czm_ray:F,czm_raySegment:k,czm_shadowParameters:V,czm_alphaWeight:z,czm_antialias:U,czm_cascadeColor:q,czm_cascadeDistance:G,czm_cascadeMatrix:H,czm_cascadeWeights:W,czm_columbusViewMorph:j,czm_computePosition:Y,czm_cosineAndSine:X,czm_decompressTextureCoordinates:Z,czm_eastNorthUpToEyeCoordinates:K,czm_ellipsoidContainsPoint:Q,czm_ellipsoidNew:J,czm_ellipsoidWgs84TextureCoordinates:$,czm_equalsEpsilon:ee,czm_eyeOffset:te,czm_eyeToWindowCoordinates:re,czm_fog:ie,czm_geodeticSurfaceNormal:ne,czm_getDefaultMaterial:ae,czm_getLambertDiffuse:oe,czm_getSpecular:se,czm_getWaterNoise:ue,czm_getWgs84EllipsoidEC:le,czm_HSBToRGB:ce,czm_HSLToRGB:de,czm_hue:fe,czm_isEmpty:he,czm_isFull:pe,czm_latitudeToWebMercatorFraction:me,czm_luminance:ve,czm_metersPerPixel:_e,czm_modelToWindowCoordinates:ge,czm_multiplyWithColorBalance:ye,czm_nearFarScalar:we,czm_octDecode:Ce,czm_packDepth:be,czm_phong:Se,czm_pointAlongRay:Ee,czm_rayEllipsoidIntersectionInterval:Te,czm_RGBToHSB:xe,czm_RGBToHSL:Ae,czm_RGBToXYZ:Pe,czm_saturation:De,czm_shadowDepthCompare:Me,czm_shadowVisibility:Ie,czm_signNotZero:Oe,czm_tangentToEyeSpaceMatrix:Re,czm_translateRelativeToEye:Ne,czm_translucentPhong:Le,czm_transpose:Be,czm_unpackDepth:Fe,czm_windowToEyeCoordinates:ke,czm_XYZToRGB:Ve}});define("Renderer/ShaderSource",["../Core/defaultValue","../Core/defined","../Core/DeveloperError","../Shaders/Builtin/CzmBuiltins","./AutomaticUniforms"],function(e,t,r,i,n){"use strict";function a(e){e=e.replace(/\/\/.*/g,"");return e.replace(/\/\*\*[\s\S]*?\*\//gm,function(e){var t=e.match(/\n/gm).length;var r="";for(var i=0;i<t;++i){r+="\n"}return r})}function o(e,r,i){var n;for(var o=0;o<i.length;++o){if(i[o].name===e){n=i[o]}}if(!t(n)){r=a(r);n={name:e,glslSource:r,dependsOn:[],requiredBy:[],evaluated:false};i.push(n)}return n}function s(e,r){if(e.evaluated){return}e.evaluated=true;var i=e.glslSource.match(/\bczm_[a-zA-Z0-9_]*/g);if(t(i)&&i!==null){i=i.filter(function(e,t){return i.indexOf(e)===t});i.forEach(function(t){if(t!==e.name&&d._czmBuiltinsAndUniforms.hasOwnProperty(t)){var i=o(t,d._czmBuiltinsAndUniforms[t],r);e.dependsOn.push(i);i.requiredBy.push(e);s(i,r)}})}}function u(e){var t=[];var i=[];while(e.length>0){var n=e.pop();i.push(n);if(n.requiredBy.length===0){t.push(n)}}while(t.length>0){var a=t.shift();e.push(a);for(var o=0;o<a.dependsOn.length;++o){var s=a.dependsOn[o];var u=s.requiredBy.indexOf(a);s.requiredBy.splice(u,1);if(s.requiredBy.length===0){t.push(s)}}}var l=[];for(var c=0;c<i.length;++c){if(i[c].requiredBy.length!==0){l.push(i[c])}}if(l.length!==0){var d="A circular dependency was found in the following built-in functions/structs/constants: \n";for(c=0;c<l.length;++c){d=d+l[c].name+"\n"}throw new r(d)}}function l(e){var t=[];var r=o("main",e,t);s(r,t);u(t);var i="";for(var n=t.length-1;n>=0;--n){i=i+t[n].glslSource+"\n"}return i.replace(r.glslSource,"")}function c(e,i){var n;var o;var s="";var u=e.sources;if(t(u)){for(n=0,o=u.length;n<o;++n){s+="\n#line 0\n"+u[n]}}s=a(s);var c;s=s.replace(/#version\s+(.*?)\n/gm,function(e,i){if(t(c)&&c!==i){throw new r("inconsistent versions found: "+c+" and "+i)}c=i;return"\n"});s=s.replace(/precision\s(lowp|mediump|highp)\s(float|int);/,"");var f=e.pickColorQualifier;if(t(f)){s=d.createPickFragmentShaderSource(s,f)}var h="";if(t(c)){h="#version "+c}if(i){h+="#ifdef GL_FRAGMENT_PRECISION_HIGH\n    precision highp float;\n#else\n    precision mediump float;\n#endif\n\n"}var p=e.defines;if(t(p)){for(n=0,o=p.length;n<o;++n){var m=p[n];if(m.length!==0){h+="#define "+m+"\n"}}}if(e.includeBuiltIns){h+=l(s)}h+="\n#line 0\n";h+=s;return h}function d(i){i=e(i,e.EMPTY_OBJECT);var n=i.pickColorQualifier;if(t(n)&&n!=="uniform"&&n!=="varying"){throw new r("options.pickColorQualifier must be 'uniform' or 'varying'.")}this.defines=t(i.defines)?i.defines.slice(0):[];this.sources=t(i.sources)?i.sources.slice(0):[];this.pickColorQualifier=n;this.includeBuiltIns=e(i.includeBuiltIns,true)}d.prototype.clone=function(){return new d({sources:this.sources,defines:this.defines,pickColorQuantifier:this.pickColorQualifier,includeBuiltIns:this.includeBuiltIns})};d.replaceMain=function(e,t){t="void "+t+"()";return e.replace(/void\s+main\s*\(\s*(?:void)?\s*\)/g,t)};d.prototype.createCombinedVertexShader=function(){return c(this,false)};d.prototype.createCombinedFragmentShader=function(){return c(this,true)};d._czmBuiltinsAndUniforms={};for(var f in i){if(i.hasOwnProperty(f)){d._czmBuiltinsAndUniforms[f]=i[f]}}for(var h in n){if(n.hasOwnProperty(h)){var p=n[h];if(typeof p.getDeclaration==="function"){d._czmBuiltinsAndUniforms[h]=p.getDeclaration(h)}}}d.createPickVertexShaderSource=function(e){var t=d.replaceMain(e,"czm_old_main");var r="attribute vec4 pickColor; \n"+"varying vec4 czm_pickColor; \n"+"void main() \n"+"{ \n"+"    czm_old_main(); \n"+"    czm_pickColor = pickColor; \n"+"}";return t+"\n"+r};d.createPickFragmentShaderSource=function(e,t){var r=d.replaceMain(e,"czm_old_main");var i=t+" vec4 czm_pickColor; \n"+"void main() \n"+"{ \n"+"    czm_old_main(); \n"+"    if (gl_FragColor.a == 0.0) { \n"+"       discard; \n"+"    } \n"+"    gl_FragColor = czm_pickColor; \n"+"}";return r+"\n"+i};d.findVarying=function(e,t){var r=e.sources;var i=t.length;for(var n=0;n<i;++n){var a=t[n];var o=r.length;for(var s=0;s<o;++s){if(r[s].indexOf(a)!==-1){return a}}}return undefined};var m=["v_normalEC","v_normal"];d.findNormalVarying=function(e){return d.findVarying(e,m)};var v=["v_positionEC"];d.findPositionVarying=function(e){return d.findVarying(e,v)};return d});define("Renderer/Buffer",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/IndexDatatype","../Core/WebGLConstants","./BufferUsage"],function(e,t,r,i,n,a,o,s){"use strict";function u(r){r=e(r,e.EMPTY_OBJECT);if(!t(r.context)){throw new n("options.context is required.")}if(!t(r.typedArray)&&!t(r.sizeInBytes)){throw new n("Either options.sizeInBytes or options.typedArray is required.")}if(t(r.typedArray)&&t(r.sizeInBytes)){throw new n("Cannot pass in both options.sizeInBytes and options.typedArray.")}if(t(r.typedArray)&&!(typeof r.typedArray==="object"&&typeof r.typedArray.byteLength==="number")){throw new n("options.typedArray must be a typed array")}if(!s.validate(r.usage)){throw new n("usage is invalid.")}var i=r.context._gl;var a=r.bufferTarget;var o=r.typedArray;var u=r.sizeInBytes;var l=r.usage;var c=t(o);if(c){u=o.byteLength}if(u<=0){throw new n("Buffer size must be greater than zero.")}var d=i.createBuffer();i.bindBuffer(a,d);i.bufferData(a,c?o:u,l);i.bindBuffer(a,null);this._gl=i;this._bufferTarget=a;this._sizeInBytes=u;this._usage=l;this._buffer=d;this.vertexArrayDestroyable=true}u.createVertexBuffer=function(e){if(!t(e.context)){throw new n("options.context is required.")}return new u({context:e.context,bufferTarget:o.ARRAY_BUFFER,typedArray:e.typedArray,sizeInBytes:e.sizeInBytes,usage:e.usage})};u.createIndexBuffer=function(e){if(!t(e.context)){throw new n("options.context is required.")}if(!a.validate(e.indexDatatype)){throw new n("Invalid indexDatatype.")}if(e.indexDatatype===a.UNSIGNED_INT&&!e.context.elementIndexUint){throw new n("IndexDatatype.UNSIGNED_INT requires OES_element_index_uint, which is not supported on this system.  Check context.elementIndexUint.")}var i=e.context;var s=e.indexDatatype;var l=a.getSizeInBytes(s);var c=new u({context:i,bufferTarget:o.ELEMENT_ARRAY_BUFFER,typedArray:e.typedArray,sizeInBytes:e.sizeInBytes,usage:e.usage});var d=c.sizeInBytes/l;r(c,{indexDatatype:{get:function(){return s}},bytesPerIndex:{get:function(){return l}},numberOfIndices:{get:function(){return d}}});return c};r(u.prototype,{sizeInBytes:{get:function(){return this._sizeInBytes}},usage:{get:function(){return this._usage}}});u.prototype._getBuffer=function(){return this._buffer};u.prototype.copyFromArrayView=function(t,r){r=e(r,0);if(!t){throw new n("arrayView is required.")}if(r+t.byteLength>this._sizeInBytes){throw new n("This buffer is not large enough.")}var i=this._gl;var a=this._bufferTarget;i.bindBuffer(a,this._buffer);i.bufferSubData(a,r,t);i.bindBuffer(a,null)};u.prototype.isDestroyed=function(){return false};u.prototype.destroy=function(){this._gl.deleteBuffer(this._buffer);return i(this)};return u});define("Renderer/VertexArray",["../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/Geometry","../Core/IndexDatatype","../Core/Math","../Core/RuntimeError","./Buffer","./BufferUsage","./ContextLimits"],function(e,t,r,i,n,a,o,s,u,l,c,d,f){"use strict";function h(i,n,o,s){var u=r(n.vertexBuffer);var l=r(n.value);var c=n.value?n.value.length:n.componentsPerAttribute;if(!u&&!l){throw new a("attribute must have a vertexBuffer or a value.")}if(u&&l){throw new a("attribute cannot have both a vertexBuffer and a value.  It must have either a vertexBuffer property defining per-vertex data or a value property defining data for all vertices.")}if(c!==1&&c!==2&&c!==3&&c!==4){if(l){throw new a("attribute.value.length must be in the range [1, 4].")}throw new a("attribute.componentsPerAttribute must be in the range [1, 4].")}if(r(n.componentDatatype)&&!e.validate(n.componentDatatype)){throw new a("attribute must have a valid componentDatatype or not specify it.")}if(r(n.strideInBytes)&&n.strideInBytes>255){throw new a("attribute must have a strideInBytes less than or equal to 255 or not specify it.")}if(r(n.instanceDivisor)&&n.instanceDivisor>0&&!s.instancedArrays){throw new a("instanced arrays is not supported")}if(r(n.instanceDivisor)&&n.instanceDivisor<0){throw new a("attribute must have an instanceDivisor greater than or equal to zero")}if(r(n.instanceDivisor)&&l){throw new a("attribute cannot have have an instanceDivisor if it is not backed by a buffer")}if(r(n.instanceDivisor)&&n.instanceDivisor>0&&n.index===0){throw new a("attribute zero cannot have an instanceDivisor greater than 0")}var d={index:t(n.index,o),enabled:t(n.enabled,true),vertexBuffer:n.vertexBuffer,value:l?n.value.slice(0):undefined,componentsPerAttribute:c,componentDatatype:t(n.componentDatatype,e.FLOAT),normalize:t(n.normalize,false),offsetInBytes:t(n.offsetInBytes,0),strideInBytes:t(n.strideInBytes,0),instanceDivisor:t(n.instanceDivisor,0)};if(u){d.vertexAttrib=function(e){var t=this.index;e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer._getBuffer());e.vertexAttribPointer(t,this.componentsPerAttribute,this.componentDatatype,this.normalize,this.strideInBytes,this.offsetInBytes);e.enableVertexAttribArray(t);if(this.instanceDivisor>0){s.glVertexAttribDivisor(t,this.instanceDivisor);s._vertexAttribDivisors[t]=this.instanceDivisor;s._previousDrawInstanced=true}};d.disableVertexAttribArray=function(e){e.disableVertexAttribArray(this.index);if(this.instanceDivisor>0){s.glVertexAttribDivisor(o,0)}}}else{switch(d.componentsPerAttribute){case 1:d.vertexAttrib=function(e){e.vertexAttrib1fv(this.index,this.value)};break;case 2:d.vertexAttrib=function(e){e.vertexAttrib2fv(this.index,this.value)};break;case 3:d.vertexAttrib=function(e){e.vertexAttrib3fv(this.index,this.value)};break;case 4:d.vertexAttrib=function(e){e.vertexAttrib4fv(this.index,this.value)};break}d.disableVertexAttribArray=function(e){}}i.push(d)}function p(e,t,i){for(var n=0;n<t.length;++n){var a=t[n];if(a.enabled){a.vertexAttrib(e)}}if(r(i)){e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,i._getBuffer())}}function m(i){i=t(i,t.EMPTY_OBJECT);if(!r(i.context)){throw new a("options.context is required.")}if(!r(i.attributes)){throw new a("options.attributes is required.")}var n=i.context;var o=n._gl;var s=i.attributes;var u=i.indexBuffer;var l;var c=[];var d=1;var f=false;var m=false;var v=s.length;for(l=0;l<v;++l){h(c,s[l],l,n)}v=c.length;for(l=0;l<v;++l){var _=c[l];if(r(_.vertexBuffer)&&_.instanceDivisor===0){var g=_.strideInBytes||_.componentsPerAttribute*e.getSizeInBytes(_.componentDatatype);d=_.vertexBuffer.sizeInBytes/g;break}}for(l=0;l<v;++l){if(c[l].instanceDivisor>0){f=true}if(r(c[l].value)){m=true}}var y={};for(l=0;l<v;++l){var w=c[l].index;if(y[w]){throw new a("Index "+w+" is used by more than one attribute.")}y[w]=true}var C;if(n.vertexArrayObject){C=n.glCreateVertexArray();n.glBindVertexArray(C);p(o,c,u);n.glBindVertexArray(null)}this._numberOfVertices=d;this._hasInstancedAttributes=f;this._hasConstantAttributes=m;this._context=n;this._gl=o;this._vao=C;this._attributes=c;this._indexBuffer=u}function v(e){return e.values.length/e.componentsPerAttribute}function _(t){return e.getSizeInBytes(t.componentDatatype)*t.componentsPerAttribute}function g(t){var i;var n;var a;var o=[];for(n in t){if(t.hasOwnProperty(n)&&r(t[n])&&r(t[n].values)){o.push(n);if(t[n].componentDatatype===e.DOUBLE){t[n].componentDatatype=e.FLOAT;t[n].values=e.createTypedArray(e.FLOAT,t[n].values)}}}var s;var u=o.length;if(u>0){s=v(t[o[0]]);for(i=1;i<u;++i){var c=v(t[o[i]]);if(c!==s){throw new l("Each attribute list must have the same number of vertices.  "+"Attribute "+o[i]+" has a different number of vertices "+"("+c.toString()+")"+" than attribute "+o[0]+" ("+s.toString()+").")}}}o.sort(function(r,i){return e.getSizeInBytes(t[i].componentDatatype)-e.getSizeInBytes(t[r].componentDatatype)});var d=0;var f={};for(i=0;i<u;++i){n=o[i];a=t[n];f[n]=d;d+=_(a)}if(d>0){var h=e.getSizeInBytes(t[o[0]].componentDatatype);var p=d%h;if(p!==0){d+=h-p}var m=s*d;var g=new ArrayBuffer(m);var y={};for(i=0;i<u;++i){n=o[i];var w=e.getSizeInBytes(t[n].componentDatatype);y[n]={pointer:e.createTypedArray(t[n].componentDatatype,g),index:f[n]/w,strideInComponentType:d/w}}for(i=0;i<s;++i){for(var C=0;C<u;++C){n=o[C];a=t[n];var b=a.values;var S=y[n];var E=S.pointer;var T=a.componentsPerAttribute;for(var x=0;x<T;++x){E[S.index+x]=b[i*T+x]}S.index+=S.strideInComponentType}}return{buffer:g,offsetsInBytes:f,vertexSizeInBytes:d}}return undefined}m.fromGeometry=function(i){i=t(i,t.EMPTY_OBJECT);if(!r(i.context)){throw new a("options.context is required.")}var n=i.context;var l=t(i.geometry,t.EMPTY_OBJECT);var f=t(i.bufferUsage,d.DYNAMIC_DRAW);var h=t(i.attributeLocations,t.EMPTY_OBJECT);var p=t(i.interleave,false);var v=i.vertexArrayAttributes;var _;var y;var w;var C=r(v)?v:[];var b=l.attributes;if(p){var S=g(b);if(r(S)){w=c.createVertexBuffer({context:n,typedArray:S.buffer,usage:f});var E=S.offsetsInBytes;var T=S.vertexSizeInBytes;for(_ in b){if(b.hasOwnProperty(_)&&r(b[_])){y=b[_];if(r(y.values)){C.push({index:h[_],vertexBuffer:w,componentDatatype:y.componentDatatype,componentsPerAttribute:y.componentsPerAttribute,normalize:y.normalize,offsetInBytes:E[_],strideInBytes:T})}else{C.push({index:h[_],value:y.value,componentDatatype:y.componentDatatype,normalize:y.normalize})}}}}}else{for(_ in b){if(b.hasOwnProperty(_)&&r(b[_])){y=b[_];var x=y.componentDatatype;if(x===e.DOUBLE){x=e.FLOAT}w=undefined;if(r(y.values)){w=c.createVertexBuffer({context:n,typedArray:e.createTypedArray(x,y.values),usage:f})}C.push({index:h[_],vertexBuffer:w,value:y.value,componentDatatype:x,componentsPerAttribute:y.componentsPerAttribute,normalize:y.normalize})}}}var A;var P=l.indices;if(r(P)){if(o.computeNumberOfVertices(l)>=u.SIXTY_FOUR_KILOBYTES&&n.elementIndexUint){A=c.createIndexBuffer({context:n,typedArray:new Uint32Array(P),usage:f,indexDatatype:s.UNSIGNED_INT})}else{A=c.createIndexBuffer({context:n,typedArray:new Uint16Array(P),usage:f,indexDatatype:s.UNSIGNED_SHORT})}}return new m({context:n,attributes:C,indexBuffer:A})};i(m.prototype,{numberOfAttributes:{get:function(){return this._attributes.length}},numberOfVertices:{get:function(){return this._numberOfVertices}},indexBuffer:{get:function(){return this._indexBuffer}}});m.prototype.getAttribute=function(e){if(!r(e)){throw new a("index is required.")}return this._attributes[e]};function y(e){var t=e._context;var r=e._hasInstancedAttributes;if(!r&&!t._previousDrawInstanced){return}t._previousDrawInstanced=r;var i=t._vertexAttribDivisors;var n=e._attributes;var a=f.maximumVertexAttributes;var o;if(r){var s=n.length;for(o=0;o<s;++o){var u=n[o];if(u.enabled){var l=u.instanceDivisor;var c=u.index;if(l!==i[c]){t.glVertexAttribDivisor(c,l);i[c]=l}}}}else{for(o=0;o<a;++o){if(i[o]>0){t.glVertexAttribDivisor(o,0);i[o]=0}}}}function w(e,t){var i=e._attributes;var n=i.length;for(var a=0;a<n;++a){var o=i[a];if(o.enabled&&r(o.value)){o.vertexAttrib(t)}}}m.prototype._bind=function(){if(r(this._vao)){this._context.glBindVertexArray(this._vao);if(this._context.instancedArrays){y(this)}if(this._hasConstantAttributes){w(this,this._gl)}}else{p(this._gl,this._attributes,this._indexBuffer)}};m.prototype._unBind=function(){if(r(this._vao)){this._context.glBindVertexArray(null)}else{var e=this._attributes;var t=this._gl;for(var i=0;i<e.length;++i){var n=e[i];if(n.enabled){n.disableVertexAttribArray(t)}}if(this._indexBuffer){t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)}}};m.prototype.isDestroyed=function(){return false};m.prototype.destroy=function(){var e=this._attributes;for(var t=0;t<e.length;++t){var i=e[t].vertexBuffer;if(r(i)&&!i.isDestroyed()&&i.vertexArrayDestroyable){i.destroy()}}var a=this._indexBuffer;if(r(a)&&!a.isDestroyed()&&a.vertexArrayDestroyable){a.destroy()}if(r(this._vao)){this._context.glDeleteVertexArray(this._vao)}return n(this)};return m});define("Scene/BatchTable",["../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/combine","../Core/ComponentDatatype","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/FeatureDetection","../Core/Math","../Core/PixelFormat","../Renderer/ContextLimits","../Renderer/PixelDatatype","../Renderer/Sampler","../Renderer/Texture","../Renderer/TextureMagnificationFilter","../Renderer/TextureMinificationFilter"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_){"use strict";function g(t,i,n){if(!a(t)){throw new u("context is required")}if(!a(i)){throw new u("attributes is required")}if(!a(n)){throw new u("numberOfInstances is required")}this._attributes=i;this._numberOfInstances=n;if(i.length===0){return}var o=y(i);var s=t.floatingPointTexture;var l=o===h.FLOAT&&!s;var c=C(i,l);var d=b(c,i,l);var p=Math.floor(f.maximumTextureSize/d);var m=Math.min(n,p);var v=d*m;var _=Math.ceil(n/m);var g=1/v;var w=g*.5;var S=1/_;var E=S*.5;this._textureDimensions=new e(v,_);this._textureStep=new r(g,w,S,E);this._pixelDatatype=!l?o:h.UNSIGNED_BYTE;this._packFloats=l;this._offsets=c;this._stride=d;this._texture=undefined;var T=4*v*_;this._batchValues=o===h.FLOAT&&!l?new Float32Array(T):new Uint8Array(T);this._batchValuesDirty=false}o(g.prototype,{attributes:{get:function(){return this._attributes}},numberOfInstances:{get:function(){return this._numberOfInstances}}});function y(e){var t=false;var r=e.length;for(var i=0;i<r;++i){if(e[i].componentDatatype!==n.UNSIGNED_BYTE){t=true;break}}return t?h.FLOAT:h.UNSIGNED_BYTE}function w(i,n){var a=i[n].componentsPerAttribute;if(a===2){return e}else if(a===3){return t}else if(a===4){return r}return Number}function C(e,t){var r=new Array(e.length);var i=0;var a=e.length;for(var o=0;o<a;++o){var s=e[o];var u=s.componentDatatype;r[o]=i;if(u!==n.UNSIGNED_BYTE&&t){i+=4}else{++i}}return r}function b(e,t,r){var i=e.length;var a=e[i-1];var o=t[i-1];var s=o.componentDatatype;if(s!==n.UNSIGNED_BYTE&&r){return a+4}return a+1}var S=new r;var E=256;var T=65536;var x=16777216;var A=1/E;var P=1/T;var D=1/x;var M=38;function I(e){var t=e.w/2;var r=Math.floor(t);var i=(t-r)*2;r=r-M;i=i*2-1;i=-i;if(r>=M){return i<0?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY}var n=i*e.x*A;n+=i*e.y*P;n+=i*e.z*D;return n*Math.pow(10,r)}function O(e,t,i){var n=r.unpack(e,t,S);var a=I(n);n=r.unpack(e,t+4,S);var o=I(n);n=r.unpack(e,t+8,S);var s=I(n);n=r.unpack(e,t+12,S);var u=I(n);return r.fromElements(a,o,s,u,i)}if(!l.supportsTypedArrays()){return}var R=new Float32Array(1);function N(e,t){R[0]=e;e=R[0];if(e===0){return r.clone(r.ZERO,t)}var i=e<0?1:0;var n;if(!isFinite(e)){e=.1;n=M}else{e=Math.abs(e);n=Math.floor(c.logBase(e,10))+1;e=e/Math.pow(10,n)}var a=e*E;t.x=Math.floor(a);a=(a-t.x)*E;t.y=Math.floor(a);a=(a-t.y)*E;t.z=Math.floor(a);t.w=(n+M)*2+i;return t}function L(e,t,i){var n=N(e.x,S);r.pack(n,t,i);n=N(e.y,n);r.pack(n,t,i+4);n=N(e.z,n);r.pack(n,t,i+8);n=N(e.w,n);r.pack(n,t,i+12)}var B=new r;g.prototype.getBatchedAttribute=function(e,t,i){if(e<0||e>=this._numberOfInstances){throw new u("instanceIndex is out of range.")}if(t<0||t>=this._attributes.length){throw new u("attributeIndex is out of range")}var n=this._attributes;var o=this._offsets[t];var s=this._stride;var l=4*s*e+4*o;var c;if(this._packFloats&&n[t].componentDatatype!==h.UNSIGNED_BYTE){c=O(this._batchValues,l,B)}else{c=r.unpack(this._batchValues,l,B)}var d=w(n,t);if(a(d.fromCartesian4)){return d.fromCartesian4(c,i)}else if(a(d.clone)){return d.clone(c,i)}return c.x};var F=[undefined,undefined,new e,new t,new r];var k=new r;g.prototype.setBatchedAttribute=function(e,t,i){if(e<0||e>=this._numberOfInstances){throw new u("instanceIndex is out of range.")}if(t<0||t>=this._attributes.length){throw new u("attributeIndex is out of range")}if(!a(i)){throw new u("value is required.")}var n=this._attributes;var o=F[n[t].componentsPerAttribute];var s=this.getBatchedAttribute(e,t,o);var l=w(this._attributes,t);var c=a(l.equals)?l.equals(s,i):s===i;if(c){return}var d=k;d.x=a(i.x)?i.x:i;d.y=a(i.y)?i.y:0;d.z=a(i.z)?i.z:0;d.w=a(i.w)?i.w:0;var f=this._offsets[t];var p=this._stride;var m=4*p*e+4*f;if(this._packFloats&&n[t].componentDatatype!==h.UNSIGNED_BYTE){L(d,this._batchValues,m)}else{r.pack(d,this._batchValues,m)}this._batchValuesDirty=true};function V(e,t){var r=e._textureDimensions;e._texture=new m({context:t,pixelFormat:d.RGBA,pixelDatatype:e._pixelDatatype,width:r.x,height:r.y,sampler:new p({minificationFilter:_.NEAREST,magnificationFilter:v.NEAREST})})}function z(e){var t=e._textureDimensions;e._texture.copyFrom({width:t.x,height:t.y,arrayBufferView:e._batchValues})}g.prototype.update=function(e){if(a(this._texture)&&!this._batchValuesDirty||this._attributes.length===0){return}this._batchValuesDirty=false;if(!a(this._texture)){V(this,e.context)}z(this)};g.prototype.getUniformMapCallback=function(){var e=this;return function(t){if(e._attributes.length===0){return t}var r={batchTexture:function(){return e._texture},batchTextureDimensions:function(){return e._textureDimensions},batchTextureStep:function(){return e._textureStep}};return i(t,r)}};function U(e){var t=e._stride;if(e._textureDimensions.y===1){return"uniform vec4 batchTextureStep; \n"+"vec2 computeSt(float batchId) \n"+"{ \n"+"    float stepX = batchTextureStep.x; \n"+"    float centerX = batchTextureStep.y; \n"+"    float numberOfAttributes = float("+t+"); \n"+"    return vec2(centerX + (batchId * numberOfAttributes * stepX), 0.5); \n"+"} \n"}return"uniform vec4 batchTextureStep; \n"+"uniform vec2 batchTextureDimensions; \n"+"vec2 computeSt(float batchId) \n"+"{ \n"+"    float stepX = batchTextureStep.x; \n"+"    float centerX = batchTextureStep.y; \n"+"    float stepY = batchTextureStep.z; \n"+"    float centerY = batchTextureStep.w; \n"+"    float numberOfAttributes = float("+t+"); \n"+"    float xId = mod(batchId * numberOfAttributes, batchTextureDimensions.x); \n"+"    float yId = floor(batchId * numberOfAttributes / batchTextureDimensions.x); \n"+"    return vec2(centerX + (xId * stepX), 1.0 - (centerY + (yId * stepY))); \n"+"} \n"}function q(e){if(!e._packFloats){return""}return"float unpackFloat(vec4 value) \n"+"{ \n"+"    value *= 255.0; \n"+"    float temp = value.w / 2.0; \n"+"    float exponent = floor(temp); \n"+"    float sign = (temp - exponent) * 2.0; \n"+"    exponent = exponent - float("+M+"); \n"+"    sign = sign * 2.0 - 1.0; \n"+"    sign = -sign; \n"+"    float unpacked = sign * value.x * float("+A+"); \n"+"    unpacked += sign * value.y * float("+P+"); \n"+"    unpacked += sign * value.z * float("+D+"); \n"+"    return unpacked * pow(10.0, exponent); \n"+"} \n"}function G(e){if(e===1){return"float"}return"vec"+e}function H(e){if(e===1){return".x"}else if(e===2){return".xy"}else if(e===3){return".xyz"}return""}function W(e){e=e+"";if(e.indexOf(".")<0)return"float("+e+")";return e}function j(e,t){var r=e._attributes;var i=r[t];var a=i.componentsPerAttribute;var o=i.functionName;var s=G(a);var u=H(a);var l=e._offsets[t];var c=s+" "+o+"(float batchId) \n"+"{ \n"+"    vec2 st = computeSt(batchId); \n"+"    st.x += batchTextureStep.x * float("+l+"); \n";if(f.maximumVertexTextureImageUnits===0){c+="    "+s+" value =  "+o.replace("czm_","")+"; \n"}else{if(e._packFloats&&i.componentDatatype!==h.UNSIGNED_BYTE){c+="vec4 textureValue; \n"+"textureValue.x = unpackFloat(texture2D(batchTexture, st)); \n"+"textureValue.y = unpackFloat(texture2D(batchTexture, st + vec2(batchTextureStep.x, 0.0))); \n"+"textureValue.z = unpackFloat(texture2D(batchTexture, st + vec2(batchTextureStep.x * 2.0, 0.0))); \n"+"textureValue.w = unpackFloat(texture2D(batchTexture, st + vec2(batchTextureStep.x * 3.0, 0.0))); \n"}else{c+="    vec4 textureValue = texture2D(batchTexture, st); \n"}c+="    "+s+" value = textureValue"+u+"; \n";if(e._pixelDatatype===h.UNSIGNED_BYTE&&i.componentDatatype===n.UNSIGNED_BYTE&&!i.normalize){c+="value *= 255.0; \n"}else if(e._pixelDatatype===h.FLOAT&&i.componentDatatype===n.UNSIGNED_BYTE&&i.normalize){c+="value /= 255.0; \n"}}c+="    return value; \n"+"} \n\n";return c}g.prototype.getVertexShaderCallback=function(){var e=this._attributes;if(e.length===0){return function(e){return e}}var t="uniform sampler2D batchTexture; \n";t+=U(this)+"\n";t+=q(this)+"\n";var r=e.length;for(var i=0;i<r;++i){t+=j(this,i)}return function(e){var r=e.indexOf("void main");var i=e.substring(0,r);var n=e.substring(r);return i+"\n"+t+"\n"+n}};g.prototype.isDestroyed=function(){return false};g.prototype.destroy=function(){this._texture=this._texture&&this._texture.destroy();return s(this)};return g});define("Scene/PrimitivePipeline",["../Core/BoundingSphere","../Core/ComponentDatatype","../Core/defined","../Core/DeveloperError","../Core/Ellipsoid","../Core/FeatureDetection","../Core/GeographicProjection","../Core/Geometry","../Core/GeometryAttribute","../Core/GeometryAttributes","../Core/GeometryPipeline","../Core/IndexDatatype","../Core/Matrix4","../Core/WebMercatorProjection"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h){"use strict";if(!a.supportsTypedArrays()){return{}}function p(e,t,i){var n=!i;var a=e.length;var o;if(!n&&a>1){var s=e[0].modelMatrix;for(o=1;o<a;++o){if(!f.equals(s,e[o].modelMatrix)){n=true;break}}}if(n){for(o=0;o<a;++o){if(r(e[o].geometry)){c.transformToWorldCoordinates(e[o])}}}else{f.multiplyTransformation(t,e[0].modelMatrix,t)}}function m(e,r){var i=e.attributes;var n=i.position;var a=n.values.length/n.componentsPerAttribute;i.batchId=new u({componentDatatype:t.FLOAT,componentsPerAttribute:1,values:new Float32Array(a)});var o=i.batchId.values;for(var s=0;s<a;++s){o[s]=r}}function v(e){var t=e.length;for(var i=0;i<t;++i){var n=e[i];if(r(n.geometry)){m(n.geometry,i)}else if(r(n.westHemisphereGeometry)&&r(n.eastHemisphereGeometry)){m(n.westHemisphereGeometry,i);m(n.eastHemisphereGeometry,i)}}}function _(n){var a=n.instances;var o=n.projection;var s=n.elementIndexUintSupported
;var u=n.scene3DOnly;var l=n.vertexCacheOptimize;var d=n.compressVertices;var f=n.modelMatrix;var h;var m;var _;var g=a.length;for(h=0;h<g;++h){if(r(a[h].geometry)){_=a[h].geometry.primitiveType;break}}for(h=1;h<g;++h){if(r(a[h].geometry)&&a[h].geometry.primitiveType!==_){throw new i("All instance geometries must have the same primitiveType.")}}p(a,f,u);if(!u){for(h=0;h<g;++h){if(r(a[h].geometry)){c.splitLongitude(a[h])}}}v(a);if(l){for(h=0;h<g;++h){var y=a[h];if(r(y.geometry)){c.reorderForPostVertexCache(y.geometry);c.reorderForPreVertexCache(y.geometry)}else if(r(y.westHemisphereGeometry)&&r(y.eastHemisphereGeometry)){c.reorderForPostVertexCache(y.westHemisphereGeometry);c.reorderForPreVertexCache(y.westHemisphereGeometry);c.reorderForPostVertexCache(y.eastHemisphereGeometry);c.reorderForPreVertexCache(y.eastHemisphereGeometry)}}}var w=c.combineInstances(a);g=w.length;for(h=0;h<g;++h){m=w[h];var C=m.attributes;var b;if(!u){for(b in C){if(C.hasOwnProperty(b)&&C[b].componentDatatype===t.DOUBLE){var S=b+"3D";var E=b+"2D";c.projectTo2D(m,b,S,E,o);if(r(m.boundingSphere)&&b==="position"){m.boundingSphereCV=e.fromVertices(m.attributes.position2D.values)}c.encodeAttribute(m,S,S+"High",S+"Low");c.encodeAttribute(m,E,E+"High",E+"Low")}}}else{for(b in C){if(C.hasOwnProperty(b)&&C[b].componentDatatype===t.DOUBLE){c.encodeAttribute(m,b,b+"3DHigh",b+"3DLow")}}}if(d){c.compressVertices(m)}}if(!s){var T=[];g=w.length;for(h=0;h<g;++h){m=w[h];T=T.concat(c.fitToUnsignedShortIndices(m))}w=T}return w}function g(e,t,i,n){var a;var o;var s;var u=n.length-1;if(u>=0){var l=n[u];a=l.offset+l.count;s=l.index;o=i[s].indices.length}else{a=0;s=0;o=i[s].indices.length}var c=e.length;for(var d=0;d<c;++d){var f=e[d];var h=f[t];if(!r(h)){continue}var p=h.indices.length;if(a+p>o){a=0;o=i[++s].indices.length}n.push({index:s,offset:a,count:p});a+=p}}function y(e,t){var r=[];g(e,"geometry",t,r);g(e,"westHemisphereGeometry",t,r);g(e,"eastHemisphereGeometry",t,r);return r}var w={};w.combineGeometry=function(t){var i;var n;var a=t.instances;var o=a.length;if(o>0){i=_(t);if(i.length>0){n=c.createAttributeLocations(i[0])}}var s;if(t.createPickOffsets&&i.length>0){s=y(a,i)}var u=new Array(o);var l=new Array(o);for(var d=0;d<o;++d){var f=a[d];var h=f.geometry;if(r(h)){u[d]=h.boundingSphere;l[d]=h.boundingSphereCV}var p=f.eastHemisphereGeometry;var m=f.westHemisphereGeometry;if(r(p)&&r(m)){if(r(p.boundingSphere)&&r(m.boundingSphere)){u[d]=e.union(p.boundingSphere,m.boundingSphere)}if(r(p.boundingSphereCV)&&r(m.boundingSphereCV)){l[d]=e.union(p.boundingSphereCV,m.boundingSphereCV)}}}return{geometries:i,modelMatrix:t.modelMatrix,attributeLocations:n,pickOffsets:s,boundingSpheres:u,boundingSpheresCV:l}};function C(e,t){var i=e.attributes;for(var n in i){if(i.hasOwnProperty(n)){var a=i[n];if(r(a)&&r(a.values)){t.push(a.values.buffer)}}}if(r(e.indices)){t.push(e.indices.buffer)}}function b(e,t){var r=e.length;for(var i=0;i<r;++i){C(e[i],t)}}function S(t){var i=1;var n=t.length;for(var a=0;a<n;a++){var o=t[a];++i;if(!r(o)){continue}var s=o.attributes;i+=6+2*e.packedLength+(r(o.indices)?o.indices.length:0);for(var u in s){if(s.hasOwnProperty(u)&&r(s[u])){var l=s[u];i+=5+l.values.length}}}return i}w.packCreateGeometryResults=function(t,i){var n=new Float64Array(S(t));var a=[];var o={};var s=t.length;var u=0;n[u++]=s;for(var l=0;l<s;l++){var c=t[l];var d=r(c);n[u++]=d?1:0;if(!d){continue}n[u++]=c.primitiveType;n[u++]=c.geometryType;var f=r(c.boundingSphere)?1:0;n[u++]=f;if(f){e.pack(c.boundingSphere,n,u)}u+=e.packedLength;var h=r(c.boundingSphereCV)?1:0;n[u++]=h;if(h){e.pack(c.boundingSphereCV,n,u)}u+=e.packedLength;var p=c.attributes;var m=[];for(var v in p){if(p.hasOwnProperty(v)&&r(p[v])){m.push(v);if(!r(o[v])){o[v]=a.length;a.push(v)}}}n[u++]=m.length;for(var _=0;_<m.length;_++){var g=m[_];var y=p[g];n[u++]=o[g];n[u++]=y.componentDatatype;n[u++]=y.componentsPerAttribute;n[u++]=y.normalize?1:0;n[u++]=y.values.length;n.set(y.values,u);u+=y.values.length}var w=r(c.indices)?c.indices.length:0;n[u++]=w;if(w>0){n.set(c.indices,u);u+=w}}i.push(n.buffer);return{stringTable:a,packedData:n}};w.unpackCreateGeometryResults=function(r){var i=r.stringTable;var n=r.packedData;var a;var o=new Array(n[0]);var c=0;var f=1;while(f<n.length){var h=n[f++]===1;if(!h){o[c++]=undefined;continue}var p=n[f++];var m=n[f++];var v;var _;var g=n[f++]===1;if(g){v=e.unpack(n,f)}f+=e.packedLength;var y=n[f++]===1;if(y){_=e.unpack(n,f)}f+=e.packedLength;var w;var C;var b;var S=new l;var E=n[f++];for(a=0;a<E;a++){var T=i[n[f++]];var x=n[f++];b=n[f++];var A=n[f++]!==0;w=n[f++];C=t.createTypedArray(x,w);for(var P=0;P<w;P++){C[P]=n[f++]}S[T]=new u({componentDatatype:x,componentsPerAttribute:b,normalize:A,values:C})}var D;w=n[f++];if(w>0){var M=C.length/b;D=d.createTypedArray(M,w);for(a=0;a<w;a++){D[a]=n[f++]}}o[c++]=new s({primitiveType:p,geometryType:m,boundingSphere:v,boundingSphereCV:_,indices:D,attributes:S})}return o};function E(e,t){var r=e.length;var i=new Float64Array(1+r*16);var n=0;i[n++]=r;for(var a=0;a<r;a++){var o=e[a];f.pack(o.modelMatrix,i,n);n+=f.packedLength}t.push(i.buffer);return i}function T(e){var t=e;var r=new Array(t[0]);var i=0;var n=1;while(n<t.length){var a=f.unpack(t,n);n+=f.packedLength;r[i++]={modelMatrix:a}}return r}w.packCombineGeometryParameters=function(e,t){var r=e.createGeometryResults;var i=r.length;for(var n=0;n<i;n++){t.push(r[n].packedData.buffer)}return{createGeometryResults:e.createGeometryResults,packedInstances:E(e.instances,t),ellipsoid:e.ellipsoid,isGeographic:e.projection instanceof o,elementIndexUintSupported:e.elementIndexUintSupported,scene3DOnly:e.scene3DOnly,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:e.modelMatrix,createPickOffsets:e.createPickOffsets}};w.unpackCombineGeometryParameters=function(e){var t=T(e.packedInstances);var r=e.createGeometryResults;var i=r.length;var a=0;for(var s=0;s<i;s++){var u=w.unpackCreateGeometryResults(r[s]);var l=u.length;for(var c=0;c<l;c++){var d=u[c];var p=t[a];p.geometry=d;++a}}var m=n.clone(e.ellipsoid);var v=e.isGeographic?new o(m):new h(m);return{instances:t,ellipsoid:m,projection:v,elementIndexUintSupported:e.elementIndexUintSupported,scene3DOnly:e.scene3DOnly,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:f.clone(e.modelMatrix),createPickOffsets:e.createPickOffsets}};function x(t){var i=t.length;var n=1+(e.packedLength+1)*i;var a=new Float32Array(n);var o=0;a[o++]=i;for(var s=0;s<i;++s){var u=t[s];if(!r(u)){a[o++]=0}else{a[o++]=1;e.pack(t[s],a,o)}o+=e.packedLength}return a}function A(t){var r=new Array(t[0]);var i=0;var n=1;while(n<t.length){if(t[n++]===1){r[i]=e.unpack(t,n)}++i;n+=e.packedLength}return r}w.packCombineGeometryResults=function(e,t){if(r(e.geometries)){b(e.geometries,t)}var i=x(e.boundingSpheres);var n=x(e.boundingSpheresCV);t.push(i.buffer,n.buffer);return{geometries:e.geometries,attributeLocations:e.attributeLocations,modelMatrix:e.modelMatrix,pickOffsets:e.pickOffsets,boundingSpheres:i,boundingSpheresCV:n}};w.unpackCombineGeometryResults=function(e){return{geometries:e.geometries,attributeLocations:e.attributeLocations,modelMatrix:e.modelMatrix,pickOffsets:e.pickOffsets,boundingSpheres:A(e.boundingSpheres),boundingSpheresCV:A(e.boundingSpheresCV)}};return w});define("Scene/PrimitiveState",["../Core/freezeObject"],function(e){"use strict";var t={READY:0,CREATING:1,CREATED:2,COMBINING:3,COMBINED:4,COMPLETE:5,FAILED:6};return e(t)});define("Scene/SceneMode",["../Core/freezeObject"],function(e){"use strict";var t={MORPHING:0,COLUMBUS_VIEW:1,SCENE2D:2,SCENE3D:3};t.getMorphTime=function(e){if(e===t.SCENE3D){return 1}else if(e===t.MORPHING){return undefined}return 0};return e(t)});define("Scene/ShadowMode",["../Core/freezeObject"],function(e){"use strict";var t={DISABLED:0,ENABLED:1,CAST_ONLY:2,RECEIVE_ONLY:3,NUMBER_OF_SHADOW_MODES:4};t.castShadows=function(e){return e===t.ENABLED||e===t.CAST_ONLY};t.receiveShadows=function(e){return e===t.ENABLED||e===t.RECEIVE_ONLY};t.fromCastReceive=function(e,r){if(e&&r){return t.ENABLED}else if(e){return t.CAST_ONLY}else if(r){return t.RECEIVE_ONLY}else{return t.DISABLED}};return e(t)});define("Scene/Primitive",["../Core/BoundingSphere","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Cartographic","../Core/clone","../Core/Color","../Core/combine","../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/EncodedCartesian3","../Core/FeatureDetection","../Core/Geometry","../Core/GeometryAttribute","../Core/GeometryAttributes","../Core/isArray","../Core/Matrix4","../Core/RuntimeError","../Core/subdivideArray","../Core/TaskProcessor","../Renderer/BufferUsage","../Renderer/ContextLimits","../Renderer/DrawCommand","../Renderer/Pass","../Renderer/RenderState","../Renderer/ShaderProgram","../Renderer/ShaderSource","../Renderer/VertexArray","../ThirdParty/when","./BatchTable","./CullFace","./PrimitivePipeline","./PrimitiveState","./SceneMode","./ShadowMode"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w,C,b,S,E,T,x,A,P,D,M,I,O,R,N,L,B,F,k){"use strict";function V(e){e=l(e,l.EMPTY_OBJECT);this.geometryInstances=e.geometryInstances;this.appearance=e.appearance;this._appearance=undefined;this._material=undefined;this.modelMatrix=w.clone(l(e.modelMatrix,w.IDENTITY));this._modelMatrix=new w;this.show=l(e.show,true);this._vertexCacheOptimize=l(e.vertexCacheOptimize,false);this._interleave=l(e.interleave,false);this._releaseGeometryInstances=l(e.releaseGeometryInstances,true);this._allowPicking=l(e.allowPicking,true);this._asynchronous=l(e.asynchronous,true);this._compressVertices=l(e.compressVertices,true);this.cull=l(e.cull,true);this.debugShowBoundingVolume=l(e.debugShowBoundingVolume,false);this.rtcCenter=e.rtcCenter;if(c(this.rtcCenter)&&(!c(this.geometryInstances)||y(this.geometryInstances)&&this.geometryInstances!==1)){throw new h("Relative-to-center rendering only supports one geometry instance.")}this.shadows=l(e.shadows,k.DISABLED);this._translucent=undefined;this._state=B.READY;this._geometries=[];this._error=undefined;this._numberOfInstances=0;this._boundingSpheres=[];this._boundingSphereWC=[];this._boundingSphereCV=[];this._boundingSphere2D=[];this._boundingSphereMorph=[];this._perInstanceAttributeCache=[];this._instanceIds=[];this._lastPerInstanceAttributeIndex=0;this._va=[];this._attributeLocations=undefined;this._primitiveType=undefined;this._frontFaceRS=undefined;this._backFaceRS=undefined;this._sp=undefined;this._pickRS=undefined;this._pickSP=undefined;this._pickIds=[];this._colorCommands=[];this._pickCommands=[];this._readOnlyInstanceAttributes=e._readOnlyInstanceAttributes;this._createBoundingVolumeFunction=e._createBoundingVolumeFunction;this._createRenderStatesFunction=e._createRenderStatesFunction;this._createShaderProgramFunction=e._createShaderProgramFunction;this._createCommandsFunction=e._createCommandsFunction;this._updateAndQueueCommandsFunction=e._updateAndQueueCommandsFunction;this._createPickOffsets=e._createPickOffsets;this._pickOffsets=undefined;this._createGeometryResults=undefined;this._ready=false;this._readyPromise=O.defer();this._batchTable=undefined;this._batchTableAttributeIndices=undefined;this._instanceBoundingSpheres=undefined;this._instanceBoundingSpheresCV=undefined;this._batchTableBoundingSpheresUpdated=false;this._batchTableBoundingSphereAttributeIndices=undefined}d(V.prototype,{vertexCacheOptimize:{get:function(){return this._vertexCacheOptimize}},interleave:{get:function(){return this._interleave}},releaseGeometryInstances:{get:function(){return this._releaseGeometryInstances}},allowPicking:{get:function(){return this._allowPicking}},asynchronous:{get:function(){return this._asynchronous}},compressVertices:{get:function(){return this._compressVertices}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}}});function z(e){var t=e.length;var r=[];var i=e[0].attributes;var n;for(n in i){if(i.hasOwnProperty(n)){var a=i[n];var o=true;for(var s=1;s<t;++s){var u=e[s].attributes[n];if(!c(u)||a.componentDatatype!==u.componentDatatype||a.componentsPerAttribute!==u.componentsPerAttribute||a.normalize!==u.normalize){o=false;break}}if(o){r.push(n)}}}return r}var U=new t;var q=new r;var G=new i;function H(e){var n=e.length;if(n===1){return e[0]}else if(n===2){return t.unpack(e,0,U)}else if(n===3){return r.unpack(e,0,q)}else if(n===4){return i.unpack(e,0,G)}}function W(e,t){try{var r=e.geometryInstances;var i=y(r)?r:[r];var n=i.length;if(n===0){return}var a=z(i);var s=a.length;var d=e.allowPicking;var f=[];var p={};var m={};var v=i[0];var _=v.attributes;var g;var w;var C;for(g=0;g<s;++g){w=a[g];C=_[w];p[w]=g;f.push({functionName:"czm_batchTable_"+w,componentDatatype:C.componentDatatype,componentsPerAttribute:C.componentsPerAttribute,normalize:C.normalize})}if(a.indexOf("distanceDisplayCondition")!==-1){f.push({functionName:"czm_batchTable_boundingSphereCenter3DHigh",componentDatatype:u.FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereCenter3DLow",componentDatatype:u.FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereCenter2DHigh",componentDatatype:u.FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereCenter2DLow",componentDatatype:u.FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereRadius",componentDatatype:u.FLOAT,componentsPerAttribute:1});m.center3DHigh=f.length-5;m.center3DLow=f.length-4;m.center2DHigh=f.length-3;m.center2DLow=f.length-2;m.radius=f.length-1}if(d){f.push({functionName:"czm_batchTable_pickColor",componentDatatype:u.UNSIGNED_BYTE,componentsPerAttribute:4,normalize:true})}var b=f.length;var S=new R(t,f,n);for(g=0;g<n;++g){var E=i[g];_=E.attributes;for(var T=0;T<s;++T){w=a[T];C=_[w];var x=H(C.value);var A=p[w];S.setBatchedAttribute(g,A,x)}if(d){var P={primitive:l(E.pickPrimitive,e)};if(c(E.id)){P.id=E.id}var D=t.createPickId(P);e._pickIds.push(D);var M=D.color;var I=G;I.x=o.floatToByte(M.red);I.y=o.floatToByte(M.green);I.z=o.floatToByte(M.blue);I.w=o.floatToByte(M.alpha);S.setBatchedAttribute(g,b-1,I)}}e._batchTable=S;e._batchTableAttributeIndices=p;e._batchTableBoundingSphereAttributeIndices=m}catch(e){throw new h(e)}}function j(e){var t;if(y(e.values)){t=e.values.slice(0)}else{t=new e.values.constructor(e.values)}return new _({componentDatatype:e.componentDatatype,componentsPerAttribute:e.componentsPerAttribute,normalize:e.normalize,values:t})}function Y(t){var r=t.attributes;var i=new g;for(var n in r){if(r.hasOwnProperty(n)&&c(r[n])){i[n]=j(r[n])}}var a;if(c(t.indices)){var o=t.indices;if(y(o)){a=o.slice(0)}else{a=new o.constructor(o)}}return new v({attributes:i,indices:a,primitiveType:t.primitiveType,boundingSphere:e.clone(t.boundingSphere)})}function X(e,t){return{geometry:t,modelMatrix:w.clone(e.modelMatrix),pickPrimitive:e.pickPrimitive,id:e.id}}var Z=/attribute\s+vec(?:3|4)\s+(.*)3DHigh;/g;V._modifyShaderPosition=function(e,t,r){var i;var n="";var a="";var o="";while((i=Z.exec(t))!==null){var s=i[1];var u="vec4 czm_compute"+s[0].toUpperCase()+s.substr(1)+"()";if(u!=="vec4 czm_computePosition()"){n+=u+";\n"}if(!c(e.rtcCenter)){if(!r){a+="attribute vec3 "+s+"2DHigh;\n"+"attribute vec3 "+s+"2DLow;\n";o+=u+"\n"+"{\n"+"    vec4 p;\n"+"    if (czm_morphTime == 1.0)\n"+"    {\n"+"        p = czm_translateRelativeToEye("+s+"3DHigh, "+s+"3DLow);\n"+"    }\n"+"    else if (czm_morphTime == 0.0)\n"+"    {\n"+"        p = czm_translateRelativeToEye("+s+"2DHigh.zxy, "+s+"2DLow.zxy);\n"+"    }\n"+"    else\n"+"    {\n"+"        p = czm_columbusViewMorph(\n"+"                czm_translateRelativeToEye("+s+"2DHigh.zxy, "+s+"2DLow.zxy),\n"+"                czm_translateRelativeToEye("+s+"3DHigh, "+s+"3DLow),\n"+"                czm_morphTime);\n"+"    }\n"+"    return p;\n"+"}\n\n"}else{o+=u+"\n"+"{\n"+"    return czm_translateRelativeToEye("+s+"3DHigh, "+s+"3DLow);\n"+"}\n\n"}}else{t=t.replace(/attribute\s+vec(?:3|4)\s+position3DHigh;/g,"");t=t.replace(/attribute\s+vec(?:3|4)\s+position3DLow;/g,"");n+="uniform mat4 u_modifiedModelView;\n";a+="attribute vec4 position;\n";o+=u+"\n"+"{\n"+"    return u_modifiedModelView * position;\n"+"}\n\n";t=t.replace(/czm_modelViewRelativeToEye\s+\*\s+/g,"");t=t.replace(/czm_modelViewProjectionRelativeToEye/g,"czm_projection")}}return[n,a,t,o].join("\n")};V._appendShowToShader=function(e,t){if(!c(e._batchTableAttributeIndices.show)){return t}var r=M.replaceMain(t,"czm_non_show_main");var i="void main() \n"+"{ \n"+"    czm_non_show_main(); \n"+"    gl_Position *= czm_batchTable_show(batchId); \n"+"}";return r+"\n"+i};V._updateColorAttribute=function(e,t){if(!c(e._batchTableAttributeIndices.color)){return t}if(t.search(/attribute\s+vec4\s+color;/g)===-1){return t}var r=t;r=r.replace(/attribute\s+vec4\s+color;/g,"");r=r.replace(/(\b)color(\b)/g,"$1czm_batchTable_color(batchId)$2");return r};V._updatePickColorAttribute=function(e){var t=e.replace(/attribute\s+vec4\s+pickColor;/g,"");t=t.replace(/(\b)pickColor(\b)/g,"$1czm_batchTable_pickColor(batchId)$2");return t};V._appendDistanceDisplayConditionToShader=function(e,t,r){if(!c(e._batchTableAttributeIndices.distanceDisplayCondition)){return t}var i=M.replaceMain(t,"czm_non_distanceDisplayCondition_main");var n="void main() \n"+"{ \n"+"    czm_non_distanceDisplayCondition_main(); \n"+"    vec2 distanceDisplayCondition = czm_batchTable_distanceDisplayCondition(batchId);\n"+"    vec3 boundingSphereCenter3DHigh = czm_batchTable_boundingSphereCenter3DHigh(batchId);\n"+"    vec3 boundingSphereCenter3DLow = czm_batchTable_boundingSphereCenter3DLow(batchId);\n"+"    vec3 boundingSphereCenter2DHigh = czm_batchTable_boundingSphereCenter2DHigh(batchId);\n"+"    vec3 boundingSphereCenter2DLow = czm_batchTable_boundingSphereCenter2DLow(batchId);\n"+"    float boundingSphereRadius = czm_batchTable_boundingSphereRadius(batchId);\n";if(!r){n+="    vec4 centerRTE;\n"+"    if (czm_morphTime == 1.0)\n"+"    {\n"+"        centerRTE = czm_translateRelativeToEye(boundingSphereCenter3DHigh, boundingSphereCenter3DLow);\n"+"    }\n"+"    else if (czm_morphTime == 0.0)\n"+"    {\n"+"        centerRTE = czm_translateRelativeToEye(boundingSphereCenter2DHigh.zxy, boundingSphereCenter2DLow.zxy);\n"+"    }\n"+"    else\n"+"    {\n"+"        centerRTE = czm_columbusViewMorph(\n"+"                czm_translateRelativeToEye(boundingSphereCenter2DHigh.zxy, boundingSphereCenter2DLow.zxy),\n"+"                czm_translateRelativeToEye(boundingSphereCenter3DHigh, boundingSphereCenter3DLow),\n"+"                czm_morphTime);\n"+"    }\n"}else{n+="    vec4 centerRTE = czm_translateRelativeToEye(boundingSphereCenter3DHigh, boundingSphereCenter3DLow);\n"}n+="    float radiusSq = boundingSphereRadius * boundingSphereRadius; \n"+"    float distanceSq; \n"+"    if (czm_sceneMode == czm_sceneMode2D) \n"+"    { \n"+"        distanceSq = czm_eyeHeight2D.y - radiusSq; \n"+"    } \n"+"    else \n"+"    { \n"+"        distanceSq = dot(centerRTE.xyz, centerRTE.xyz) - radiusSq; \n"+"    } \n"+"    distanceSq = max(distanceSq, 0.0); \n"+"    float nearSq = distanceDisplayCondition.x * distanceDisplayCondition.x; \n"+"    float farSq = distanceDisplayCondition.y * distanceDisplayCondition.y; \n"+"    float show = (distanceSq >= nearSq && distanceSq <= farSq) ? 1.0 : 0.0; \n"+"    gl_Position *= show; \n"+"}";return i+"\n"+n};function K(e,t){if(!e.compressVertices){return t}var r=t.search(/attribute\s+vec3\s+normal;/g)!==-1;var i=t.search(/attribute\s+vec2\s+st;/g)!==-1;if(!r&&!i){return t}var n=t.search(/attribute\s+vec3\s+tangent;/g)!==-1;var a=t.search(/attribute\s+vec3\s+bitangent;/g)!==-1;var o=i&&r?2:1;o+=n||a?1:0;var s=o>1?"vec"+o:"float";var u="compressedAttributes";var l="attribute "+s+" "+u+";";var c="";var d="";if(i){c+="vec2 st;\n";var f=o>1?u+".x":u;d+="    st = czm_decompressTextureCoordinates("+f+");\n"}if(r&&n&&a){c+="vec3 normal;\n"+"vec3 tangent;\n"+"vec3 bitangent;\n";d+="    czm_octDecode("+u+"."+(i?"yz":"xy")+", normal, tangent, bitangent);\n"}else{if(r){c+="vec3 normal;\n";d+="    normal = czm_octDecode("+u+(o>1?"."+(i?"y":"x"):"")+");\n"}if(n){c+="vec3 tangent;\n";d+="    tangent = czm_octDecode("+u+"."+(i&&r?"z":"y")+");\n"}if(a){c+="vec3 bitangent;\n";d+="    bitangent = czm_octDecode("+u+"."+(i&&r?"z":"y")+");\n"}}var h=t;h=h.replace(/attribute\s+vec3\s+normal;/g,"");h=h.replace(/attribute\s+vec2\s+st;/g,"");h=h.replace(/attribute\s+vec3\s+tangent;/g,"");h=h.replace(/attribute\s+vec3\s+bitangent;/g,"");h=M.replaceMain(h,"czm_non_compressed_main");var p="void main() \n"+"{ \n"+d+"    czm_non_compressed_main(); \n"+"}";return[l,c,h,p].join("\n")}function Q(e,t){var r=e.vertexAttributes;for(var i in r){if(r.hasOwnProperty(i)){if(!c(t[i])){throw new h("Appearance/Geometry mismatch.  The appearance requires vertex shader attribute input '"+i+"', which was not computed as part of the Geometry.  Use the appearance's vertexFormat property when constructing the geometry.")}}}}function J(e,t){return function(){return e[t]}}var $=Math.max(m.hardwareConcurrency-1,1);var ee;var te=new S("combineGeometry",Number.POSITIVE_INFINITY);function re(e,t){var r;var i;var n;var a;var o=e._instanceIds;if(e._state===B.READY){r=y(e.geometryInstances)?e.geometryInstances:[e.geometryInstances];var s=e._numberOfInstances=r.length;var u=[];var d=[];for(n=0;n<s;++n){i=r[n].geometry;o.push(r[n].id);if(!c(i._workerName)){throw new h("_workerName must be defined for asynchronous geometry.")}d.push({moduleName:i._workerName,geometry:i})}if(!c(ee)){ee=new Array($);for(n=0;n<$;n++){ee[n]=new S("createGeometry",Number.POSITIVE_INFINITY)}}var f;d=b(d,$);for(n=0;n<d.length;n++){var p=0;var m=d[n];var v=m.length;for(a=0;a<v;++a){f=m[a];i=f.geometry;if(c(i.constructor.pack)){f.offset=p;p+=l(i.constructor.packedLength,i.packedLength)}}var _;if(p>0){var g=new Float64Array(p);_=[g.buffer];for(a=0;a<v;++a){f=m[a];i=f.geometry;if(c(i.constructor.pack)){i.constructor.pack(i,g,f.offset);f.geometry=g}}}u.push(ee[n].scheduleTask({subTasks:d[n]},_))}e._state=B.CREATING;O.all(u,function(t){e._createGeometryResults=t;e._state=B.CREATED}).otherwise(function(r){Ce(e,t,B.FAILED,r)})}else if(e._state===B.CREATED){var C=[];r=y(e.geometryInstances)?e.geometryInstances:[e.geometryInstances];var E=t.scene3DOnly;var T=t.mapProjection;var x=te.scheduleTask(L.packCombineGeometryParameters({createGeometryResults:e._createGeometryResults,instances:r,ellipsoid:T.ellipsoid,projection:T,elementIndexUintSupported:t.context.elementIndexUint,scene3DOnly:E,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:e.modelMatrix,createPickOffsets:e._createPickOffsets},C),C);e._createGeometryResults=undefined;e._state=B.COMBINING;O(x,function(r){var i=L.unpackCombineGeometryResults(r);e._geometries=i.geometries;e._attributeLocations=i.attributeLocations;e.modelMatrix=w.clone(i.modelMatrix,e.modelMatrix);e._pickOffsets=i.pickOffsets;e._instanceBoundingSpheres=i.boundingSpheres;e._instanceBoundingSpheresCV=i.boundingSpheresCV;if(c(e._geometries)&&e._geometries.length>0){e._state=B.COMBINED}else{Ce(e,t,B.FAILED,undefined)}}).otherwise(function(r){Ce(e,t,B.FAILED,r)})}}function ie(e,t){var r=y(e.geometryInstances)?e.geometryInstances:[e.geometryInstances];var i=e._numberOfInstances=r.length;var n=new Array(i);var a=e._instanceIds;var o;var s;var u=0;for(s=0;s<i;s++){o=r[s];var l=o.geometry;var d;if(c(l.attributes)&&c(l.primitiveType)){d=Y(l)}else{d=l.constructor.createGeometry(l)}n[u++]=X(o,d);a.push(o.id)}n.length=u;var f=t.scene3DOnly;var h=t.mapProjection;var p=L.combineGeometry({instances:n,ellipsoid:h.ellipsoid,projection:h,elementIndexUintSupported:t.context.elementIndexUint,scene3DOnly:f,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:e.modelMatrix,createPickOffsets:e._createPickOffsets});e._geometries=p.geometries;e._attributeLocations=p.attributeLocations;e.modelMatrix=w.clone(p.modelMatrix,e.modelMatrix);e._pickOffsets=p.pickOffsets;e._instanceBoundingSpheres=p.boundingSpheres;e._instanceBoundingSpheresCV=p.boundingSpheresCV;if(c(e._geometries)&&e._geometries.length>0){e._state=B.COMBINED}else{Ce(e,t,B.FAILED,undefined)}}var ne=new p;var ae=new n;var oe=new r;function se(t,r){var i=c(t._batchTableAttributeIndices.distanceDisplayCondition);if(!i&&t._batchTableBoundingSpheresUpdated){return}var n=t._batchTableBoundingSphereAttributeIndices;var a=n.center3DHigh;var o=n.center3DLow;var s=n.center2DHigh;var u=n.center2DLow;var l=n.radius;var d=r.mapProjection;var f=d.ellipsoid;var h=t._batchTable;var m=t._instanceBoundingSpheres;var v=m.length;for(var _=0;_<v;++_){var g=m[_];if(!c(g)){continue}var y=t.modelMatrix;if(c(y)){g=e.transform(g,y,g)}if(i){var w=g.center;var C=g.radius;var b=p.fromCartesian(w,ne);h.setBatchedAttribute(_,a,b.high);h.setBatchedAttribute(_,o,b.low);var S=f.cartesianToCartographic(w,ae);var E=d.project(S,oe);b=p.fromCartesian(E,ne);h.setBatchedAttribute(_,s,b.high);h.setBatchedAttribute(_,u,b.low);h.setBatchedAttribute(_,l,C)}}t._batchTableBoundingSpheresUpdated=true}function ue(t,r){var i=t._attributeLocations;var n=t._geometries;var a=r.scene3DOnly;var o=r.context;var s=[];var u=n.length;for(var l=0;l<u;++l){var d=n[l];s.push(I.fromGeometry({context:o,geometry:d,attributeLocations:i,bufferUsage:E.STATIC_DRAW,interleave:t._interleave}));if(c(t._createBoundingVolumeFunction)){t._createBoundingVolumeFunction(r,d)}else{t._boundingSpheres.push(e.clone(d.boundingSphere));t._boundingSphereWC.push(new e);if(!a){var f=d.boundingSphereCV.center;var h=f.x;var p=f.y;var m=f.z;f.x=m;f.y=h;f.z=p;t._boundingSphereCV.push(e.clone(d.boundingSphereCV));t._boundingSphere2D.push(new e);t._boundingSphereMorph.push(new e)}}}t._va=s;t._primitiveType=n[0].primitiveType;if(t.releaseGeometryInstances){t.geometryInstances=undefined}t._geometries=undefined;Ce(t,r,B.COMPLETE,undefined)}function le(e,t,r,i){var n=r.getRenderState();var o;if(i){o=a(n,false);o.cull={enabled:true,face:N.BACK};e._frontFaceRS=P.fromCache(o);o.cull.face=N.FRONT;e._backFaceRS=P.fromCache(o)}else{e._frontFaceRS=P.fromCache(n);e._backFaceRS=e._frontFaceRS}if(e.allowPicking){if(i){o=a(n,false);o.cull={enabled:false};e._pickRS=P.fromCache(o)}else{e._pickRS=e._frontFaceRS}}else{o=a(n,false);o.colorMask={red:false,green:false,blue:false,alpha:false};if(i){o.cull={enabled:false};e._pickRS=P.fromCache(o)}else{e._pickRS=P.fromCache(o)}}}function ce(e,t,r){var i=t.context;var n=e._attributeLocations;var a=e._batchTable.getVertexShaderCallback()(r.vertexShaderSource);a=V._appendShowToShader(e,a);a=V._appendDistanceDisplayConditionToShader(e,a,t.scene3DOnly);a=V._updateColorAttribute(e,a);a=K(e,a);a=V._modifyShaderPosition(e,a,t.scene3DOnly);var o=r.getFragmentShaderSource();if(e.allowPicking){var s=M.createPickVertexShaderSource(a);s=V._updatePickColorAttribute(s);e._pickSP=D.replaceCache({context:i,shaderProgram:e._pickSP,vertexShaderSource:s,fragmentShaderSource:M.createPickFragmentShaderSource(o,"varying"),attributeLocations:n})}else{e._pickSP=D.fromCache({context:i,vertexShaderSource:a,fragmentShaderSource:o,attributeLocations:n})}Q(e._pickSP,n);e._sp=D.replaceCache({context:i,shaderProgram:e._sp,vertexShaderSource:a,fragmentShaderSource:o,attributeLocations:n});Q(e._sp,n)}var de=new w;var fe=new r;function he(e,t,r,i,n,a,o,u){var l=c(r)?r._uniforms:undefined;var d={};var f=t.uniforms;if(c(f)){for(var p in f){if(f.hasOwnProperty(p)){if(c(l)&&c(l[p])){throw new h("Appearance and material have a uniform with the same name: "+p)}d[p]=J(f,p)}}}var m=s(d,l);m=e._batchTable.getUniformMapCallback()(m);if(c(e.rtcCenter)){m.u_modifiedModelView=function(){var t=u.context.uniformState.view;w.multiply(t,e._modelMatrix,de);w.multiplyByPoint(de,e.rtcCenter,fe);w.setTranslation(de,fe,de);return de}}var v=i?A.TRANSLUCENT:A.OPAQUE;a.length=e._va.length*(n?2:1);o.length=e._va.length;var _=a.length;var g=0;var y=0;for(var C=0;C<_;++C){var b;if(n){b=a[C];if(!c(b)){b=a[C]=new x({owner:e,primitiveType:e._primitiveType})}b.vertexArray=e._va[y];b.renderState=e._backFaceRS;b.shaderProgram=e._sp;b.uniformMap=m;b.pass=v;++C}b=a[C];if(!c(b)){b=a[C]=new x({owner:e,primitiveType:e._primitiveType})}b.vertexArray=e._va[y];b.renderState=e._frontFaceRS;b.shaderProgram=e._sp;b.uniformMap=m;b.pass=v;var S=o[g];if(!c(S)){S=o[g]=new x({owner:e,primitiveType:e._primitiveType})}S.vertexArray=e._va[y];S.renderState=e._pickRS;S.shaderProgram=e._pickSP;S.uniformMap=m;S.pass=v;++g;++y}}function pe(e,t){var r=e.appearance.pixelSize;if(c(r)){var i=e._boundingSpheres.length;for(var n=0;n<i;++n){var a=e._boundingSpheres[n];var o=e._boundingSphereWC[n];var s=t.camera.getPixelSize(a,t.context.drawingBufferWidth,t.context.drawingBufferHeight);var u=s*r;o.radius=a.radius+u}}}function me(t,r,i,n,a,o,s,u){if(r.mode!==F.SCENE3D&&!w.equals(a,w.IDENTITY)){throw new h("Primitive.modelMatrix is only supported in 3D mode.")}pe(t,r);if(!w.equals(a,t._modelMatrix)){w.clone(a,t._modelMatrix);var l=t._boundingSpheres.length;for(var d=0;d<l;++d){var f=t._boundingSpheres[d];if(c(f)){t._boundingSphereWC[d]=e.transform(f,a,t._boundingSphereWC[d]);if(!r.scene3DOnly){t._boundingSphere2D[d]=e.clone(t._boundingSphereCV[d],t._boundingSphere2D[d]);t._boundingSphere2D[d].center.x=0;t._boundingSphereMorph[d]=e.union(t._boundingSphereWC[d],t._boundingSphereCV[d])}}}}var p;if(r.mode===F.SCENE3D){p=t._boundingSphereWC}else if(r.mode===F.COLUMBUS_VIEW){p=t._boundingSphereCV}else if(r.mode===F.SCENE2D&&c(t._boundingSphere2D)){p=t._boundingSphere2D}else if(c(t._boundingSphereMorph)){p=t._boundingSphereMorph}var m=r.commandList;var v=r.passes;if(v.render){var _=k.castShadows(t.shadows);var g=k.receiveShadows(t.shadows);var y=i.length;for(var C=0;C<y;++C){var b=u?Math.floor(C/2):C;var S=i[C];S.modelMatrix=a;S.boundingVolume=p[b];S.cull=o;S.debugShowBoundingVolume=s;S.castShadows=_;S.receiveShadows=g;m.push(S)}}if(v.pick){var E=n.length;for(var T=0;T<E;++T){var x=n[T];x.modelMatrix=a;x.boundingVolume=p[T];x.cull=o;m.push(x)}}}function ve(e){var t="";for(var r=0;r<e._batchTable.attributes.length;r++){var i=e._batchTable.attributes[r];var n=i.functionName.replace("czm_batchTable_","batchTable_");var a="float";var o=i.componentsPerAttribute;switch(o){case 1:a="float";break;case 2:a="vec2";break;case 3:a="vec3";break;case 4:a="vec4";break}if(n.indexOf("boundingSphereCenter2D")>=0){continue}var s="attribute "+a+" "+n+";\n";t+=s}e.appearance._vertexShaderSource=t+e.appearance._vertexShaderSource}function _e(e){var n=0;for(var a in e._attributeLocations){if(e._attributeLocations.hasOwnProperty(a)){n=Math.max(e._attributeLocations[a],n)}}var o={};for(var a=0;a<e._batchTable.attributes.length;a++){var s=e._batchTable.attributes[a];var l=s.functionName.replace("czm_batchTable_","batchTable_");o[l]={};for(var c in s){if(s.hasOwnProperty(c)){o[l][c]=s[c]}}e._attributeLocations[l]=++n}for(var a=0;a<e._geometries.length;a++){var d=e._geometries[a].attributes;for(var c in o){if(o.hasOwnProperty(c)){d[c]=o[c];var f=d[c].componentDatatype;var h=d.batchId.values.length*d[c].componentsPerAttribute;d[c].values=u.createTypedArray(f,h)}}for(var p=0;p<d.batchId.values.length;p++){var m=d.batchId.values[p];for(var v=0;v<e._batchTable.attributes.length;v++){var s=e._batchTable.attributes[v];var l=s.functionName.replace("czm_batchTable_","batchTable_");var _=e._batchTable.getBatchedAttribute(m,v);if(_.clone){_=_.clone();if(typeof _==="number"){_=Number.isFinite(_)?parseFloat(_):40489014}else{if(_.x){_.x=Number.isFinite(_.x)?_.x:40489014}if(_.y){_.y=Number.isFinite(_.y)?_.y:40489014}if(_.z){_.z=Number.isFinite(_.z)?_.z:40489014}if(_.w){_.w=Number.isFinite(_.w)?_.w:40489014}}}if(_ instanceof i){i.pack(_,d[l].values,p*4)}else if(_ instanceof r){r.pack(_,d[l].values,p*3)}else if(_ instanceof t){t.pack(_,d[l].values,p*2)}else{d[l].values[p]=_}}}}}V.prototype.update=function(e){
if(!c(this.geometryInstances)&&this._va.length===0||c(this.geometryInstances)&&y(this.geometryInstances)&&this.geometryInstances.length===0||!c(this.appearance)||e.mode!==F.SCENE3D&&e.scene3DOnly||!e.passes.render&&!e.passes.pick){return}if(c(this._error)){throw this._error}if(c(this.rtcCenter)&&!e.scene3DOnly){throw new h("RTC rendering is only available for 3D only scenes.")}if(this._state===B.FAILED){return}var t=e.context;if(!c(this._batchTable)){W(this,t)}if(this._batchTable.attributes.length>0){this._batchTable.update(e)}if(this._state!==B.COMPLETE&&this._state!==B.COMBINED){if(this.asynchronous){re(this,e)}else{ie(this,e)}}if(this._state===B.COMBINED){if(T.maximumVertexTextureImageUnits===0){_e(this);ve(this)}se(this,e);ue(this,e)}if(!this.show||this._state!==B.COMPLETE){return}var r=this.appearance;var i=r.material;var n=false;var a=false;if(this._appearance!==r){this._appearance=r;this._material=i;n=true;a=true}else if(this._material!==i){this._material=i;a=true}var o=this._appearance.isTranslucent();if(this._translucent!==o){this._translucent=o;n=true}if(c(this._material)){this._material.update(t)}var s=r.closed&&o;if(n){var u=l(this._createRenderStatesFunction,le);u(this,t,r,s)}if(a){var d=l(this._createShaderProgramFunction,ce);d(this,e,r)}if(n||a){var f=l(this._createCommandsFunction,he);f(this,r,i,o,s,this._colorCommands,this._pickCommands,e)}var p=l(this._updateAndQueueCommandsFunction,me);p(this,e,this._colorCommands,this._pickCommands,this.modelMatrix,this.cull,this.debugShowBoundingVolume,s)};function ge(e,t,r){return function(){var i=e.getBatchedAttribute(t,r);var n=e.attributes[r];var a=n.componentsPerAttribute;var o=u.createTypedArray(n.componentDatatype,a);if(c(i.constructor.pack)){i.constructor.pack(i,o,0)}else{o[0]=i}return o}}function ye(e,t,r){return function(i){if(!c(i)||!c(i.length)||i.length<1||i.length>4){throw new h("value must be and array with length between 1 and 4.")}var n=H(i);e.setBatchedAttribute(t,r,n)}}function we(e,t,r){t.boundingSphere={get:function(){return e._instanceBoundingSpheres[r]}};t.boundingSphereCV={get:function(){return e._instanceBoundingSpheresCV[r]}}}V.prototype.getGeometryInstanceAttributes=function(e){if(!c(e)){throw new h("id is required")}if(!c(this._batchTable)){throw new h("must call update before calling getGeometryInstanceAttributes")}var t=-1;var r=this._lastPerInstanceAttributeIndex;var i=this._instanceIds;var n=i.length;for(var a=0;a<n;++a){var o=(r+a)%n;if(e===i[o]){t=o;break}}if(t===-1){return undefined}var s=this._perInstanceAttributeCache[t];if(c(s)){return s}var u=this._batchTable;var l=this._batchTableAttributeIndices;s={};var f={};for(var p in l){if(l.hasOwnProperty(p)){var m=l[p];f[p]={get:ge(u,t,m)};var v=true;var _=this._readOnlyInstanceAttributes;if(v&&c(_)){n=_.length;for(var g=0;g<n;++g){if(p===_[g]){v=false;break}}}if(v){f[p].set=ye(u,t,m)}}}we(this,f,t);d(s,f);this._lastPerInstanceAttributeIndex=t;this._perInstanceAttributeCache[t]=s;return s};V.prototype.isDestroyed=function(){return false};V.prototype.destroy=function(){var e;var t;this._sp=this._sp&&this._sp.destroy();this._pickSP=this._pickSP&&this._pickSP.destroy();var r=this._va;e=r.length;for(t=0;t<e;++t){r[t].destroy()}this._va=undefined;var i=this._pickIds;e=i.length;for(t=0;t<e;++t){i[t].destroy()}this._pickIds=undefined;this._batchTable=this._batchTable&&this._batchTable.destroy();this._instanceIds=undefined;this._perInstanceAttributeCache=undefined;this._attributeLocations=undefined;return f(this)};function Ce(e,t,r,i){e._error=i;e._state=r;t.afterRender.push(function(){e._ready=e._state===B.COMPLETE||e._state===B.FAILED;if(!c(i)){e._readyPromise.resolve(e)}else{e._readyPromise.reject(i)}})}return V});define("DataSources/ColorMaterialProperty",["../Core/Color","../Core/defined","../Core/defineProperties","../Core/Event","./createPropertyDescriptor","./Property"],function(e,t,r,i,n,a){"use strict";function o(e){this._definitionChanged=new i;this._color=undefined;this._colorSubscription=undefined;this.color=e}r(o.prototype,{isConstant:{get:function(){return a.isConstant(this._color)}},definitionChanged:{get:function(){return this._definitionChanged}},color:n("color")});o.prototype.getType=function(e){return"Color"};o.prototype.getValue=function(r,i){if(!t(i)){i={}}i.color=a.getValueOrClonedDefault(this._color,r,e.WHITE,i.color);return i};o.prototype.equals=function(e){return this===e||e instanceof o&&a.equals(this._color,e._color)};return o});define("DataSources/dynamicGeometryGetBoundingSphere",["../Core/BoundingSphere","../Core/defined","../Core/DeveloperError","./BoundingSphereState"],function(e,t,r,i){"use strict";function n(n,a,o,s){if(!t(n)){throw new r("entity is required.")}if(!t(s)){throw new r("result is required.")}var u;if(t(a)&&a.show&&a.ready){u=a.getGeometryInstanceAttributes(n);if(t(u)&&t(u.boundingSphere)){e.clone(u.boundingSphere,s);return i.DONE}}if(t(o)&&o.show&&o.ready){u=o.getGeometryInstanceAttributes(n);if(t(u)&&t(u.boundingSphere)){e.clone(u.boundingSphere,s);return i.DONE}}if(t(a)&&!a.ready||t(o)&&!o.ready){return i.PENDING}return i.FAILED}return n});define("DataSources/MaterialProperty",["../Core/Color","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Scene/Material"],function(e,t,r,i,n){"use strict";function a(){i.throwInstantiationError()}r(a.prototype,{isConstant:{get:i.throwInstantiationError},definitionChanged:{get:i.throwInstantiationError}});a.prototype.getType=i.throwInstantiationError;a.prototype.getValue=i.throwInstantiationError;a.prototype.equals=i.throwInstantiationError;a.getValue=function(r,i,a){var o;if(t(i)){o=i.getType(r);if(t(o)){if(!t(a)||a.type!==o){a=n.fromType(o)}i.getValue(r,a.uniforms);return a}}if(!t(a)||a.type!==n.ColorType){a=n.fromType(n.ColorType)}e.clone(e.WHITE,a.uniforms.color);return a};return a});define("DataSources/BoxGeometryUpdater",["../Core/BoxGeometry","../Core/BoxOutlineGeometry","../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/Event","../Core/GeometryInstance","../Core/Iso8601","../Core/ShowGeometryInstanceAttribute","../Scene/MaterialAppearance","../Scene/PerInstanceColorAppearance","../Scene/Primitive","../Scene/ShadowMode","./ColorMaterialProperty","./ConstantProperty","./dynamicGeometryGetBoundingSphere","./MaterialProperty","./Property"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w,C,b,S){"use strict";var E=new y(r.WHITE);var T=new w(true);var x=new w(true);var A=new w(false);var P=new w(r.BLACK);var D=new w(g.DISABLED);var M=new w(new l);var I=new r;function O(e){this.id=e;this.vertexFormat=undefined;this.dimensions=undefined}function R(e,t){if(!a(e)){throw new u("entity is required")}if(!a(t)){throw new u("scene is required")}this._entity=e;this._scene=t;this._entitySubscription=e.definitionChanged.addEventListener(R.prototype._onEntityPropertyChanged,this);this._fillEnabled=false;this._dynamic=false;this._outlineEnabled=false;this._geometryChanged=new d;this._showProperty=undefined;this._materialProperty=undefined;this._hasConstantOutline=true;this._showOutlineProperty=undefined;this._outlineColorProperty=undefined;this._outlineWidth=1;this._shadowsProperty=undefined;this._distanceDisplayConditionProperty=undefined;this._options=new O(e);this._onEntityPropertyChanged(e,"box",e.box,undefined)}o(R,{perInstanceColorAppearanceType:{value:v},materialAppearanceType:{value:m}});o(R.prototype,{entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!a(this._entity.availability)&&S.isConstant(this._showProperty)&&S.isConstant(this._fillProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},outlineEnabled:{get:function(){return this._outlineEnabled}},hasConstantOutline:{get:function(){return!this._outlineEnabled||!a(this._entity.availability)&&S.isConstant(this._showProperty)&&S.isConstant(this._showOutlineProperty)}},outlineColorProperty:{get:function(){return this._outlineColorProperty}},outlineWidth:{get:function(){return this._outlineWidth}},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayConditionProperty}},isDynamic:{get:function(){return this._dynamic}},isClosed:{value:true},geometryChanged:{get:function(){return this._geometryChanged}}});R.prototype.isOutlineVisible=function(e){var t=this._entity;return this._outlineEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)};R.prototype.isFilled=function(e){var t=this._entity;return this._fillEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)};R.prototype.createFillGeometryInstance=function(t){if(!a(t)){throw new u("time is required.")}if(!this._fillEnabled){throw new u("This instance does not represent a filled geometry.")}var n=this._entity;var o=n.isAvailable(t);var s;var l;var d=new p(o&&n.isShowing&&this._showProperty.getValue(t)&&this._fillProperty.getValue(t));var m=this._distanceDisplayConditionProperty.getValue(t);var v=c.fromDistanceDisplayCondition(m);if(this._materialProperty instanceof y){var _=r.WHITE;if(a(this._materialProperty.color)&&(this._materialProperty.color.isConstant||o)){_=this._materialProperty.color.getValue(t)}l=i.fromColor(_);s={show:d,distanceDisplayCondition:v,color:l}}else{s={show:d,distanceDisplayCondition:v}}return new f({id:n,geometry:e.fromDimensions(this._options),modelMatrix:n._getModelMatrix(h.MINIMUM_VALUE),attributes:s})};R.prototype.createOutlineGeometryInstance=function(e){if(!a(e)){throw new u("time is required.")}if(!this._outlineEnabled){throw new u("This instance does not represent an outlined geometry.")}var n=this._entity;var o=n.isAvailable(e);var s=S.getValueOrDefault(this._outlineColorProperty,e,r.BLACK);var l=this._distanceDisplayConditionProperty.getValue(e);return new f({id:n,geometry:t.fromDimensions(this._options),modelMatrix:n._getModelMatrix(h.MINIMUM_VALUE),attributes:{show:new p(o&&n.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:i.fromColor(s),distanceDisplayCondition:c.fromDistanceDisplayCondition(l)}})};R.prototype.isDestroyed=function(){return false};R.prototype.destroy=function(){this._entitySubscription();s(this)};R.prototype._onEntityPropertyChanged=function(e,t,r,i){if(!(t==="availability"||t==="position"||t==="orientation"||t==="box")){return}var o=this._entity.box;if(!a(o)){if(this._fillEnabled||this._outlineEnabled){this._fillEnabled=false;this._outlineEnabled=false;this._geometryChanged.raiseEvent(this)}return}var s=o.fill;var u=a(s)&&s.isConstant?s.getValue(h.MINIMUM_VALUE):true;var l=o.outline;var c=a(l);if(c&&l.isConstant){c=l.getValue(h.MINIMUM_VALUE)}if(!u&&!c){if(this._fillEnabled||this._outlineEnabled){this._fillEnabled=false;this._outlineEnabled=false;this._geometryChanged.raiseEvent(this)}return}var d=o.dimensions;var f=e.position;var p=o.show;if(!a(d)||!a(f)||a(p)&&p.isConstant&&!p.getValue(h.MINIMUM_VALUE)){if(this._fillEnabled||this._outlineEnabled){this._fillEnabled=false;this._outlineEnabled=false;this._geometryChanged.raiseEvent(this)}return}var _=n(o.material,E);var g=_ instanceof y;this._materialProperty=_;this._fillProperty=n(s,x);this._showProperty=n(p,T);this._showOutlineProperty=n(o.outline,A);this._outlineColorProperty=c?n(o.outlineColor,P):undefined;this._shadowsProperty=n(o.shadows,D);this._distanceDisplayConditionProperty=n(o.distanceDisplayCondition,M);var w=o.outlineWidth;this._fillEnabled=u;this._outlineEnabled=c;if(!f.isConstant||!S.isConstant(e.orientation)||!d.isConstant||!S.isConstant(w)){if(!this._dynamic){this._dynamic=true;this._geometryChanged.raiseEvent(this)}}else{var C=this._options;C.vertexFormat=g?v.VERTEX_FORMAT:m.MaterialSupport.TEXTURED.vertexFormat;C.dimensions=d.getValue(h.MINIMUM_VALUE,C.dimensions);this._outlineWidth=a(w)?w.getValue(h.MINIMUM_VALUE):1;this._dynamic=false;this._geometryChanged.raiseEvent(this)}};R.prototype.createDynamicUpdater=function(e){if(!this._dynamic){throw new u("This instance does not represent dynamic geometry.")}if(!a(e)){throw new u("primitives is required.")}return new N(e,this)};function N(e,t){this._primitives=e;this._primitive=undefined;this._outlinePrimitive=undefined;this._geometryUpdater=t;this._options=new O(t._entity)}N.prototype.update=function(n){if(!a(n)){throw new u("time is required.")}var o=this._primitives;o.removeAndDestroy(this._primitive);o.removeAndDestroy(this._outlinePrimitive);this._primitive=undefined;this._outlinePrimitive=undefined;var s=this._geometryUpdater;var l=s._entity;var d=l.box;if(!l.isShowing||!l.isAvailable(n)||!S.getValueOrDefault(d.show,n,true)){return}var h=this._options;var p=l._getModelMatrix(n);var g=S.getValueOrUndefined(d.dimensions,n,h.dimensions);if(!a(p)||!a(g)){return}h.dimensions=g;var y=this._geometryUpdater.shadowsProperty.getValue(n);var w=this._geometryUpdater.distanceDisplayConditionProperty;var C=w.getValue(n);var E=c.fromDistanceDisplayCondition(C);if(S.getValueOrDefault(d.fill,n,true)){var T=b.getValue(n,s.fillMaterialProperty,this._material);this._material=T;var x=new m({material:T,translucent:T.isTranslucent(),closed:true});h.vertexFormat=x.vertexFormat;this._primitive=o.add(new _({geometryInstances:new f({id:l,geometry:e.fromDimensions(h),modelMatrix:p,attributes:{distanceDisplayCondition:E}}),appearance:x,asynchronous:false,shadows:y}))}if(S.getValueOrDefault(d.outline,n,false)){h.vertexFormat=v.VERTEX_FORMAT;var A=S.getValueOrClonedDefault(d.outlineColor,n,r.BLACK,I);var P=S.getValueOrDefault(d.outlineWidth,n,1);var D=A.alpha!==1;this._outlinePrimitive=o.add(new _({geometryInstances:new f({id:l,geometry:t.fromDimensions(h),modelMatrix:p,attributes:{color:i.fromColor(A),distanceDisplayCondition:E}}),appearance:new v({flat:true,translucent:D,renderState:{lineWidth:s._scene.clampLineWidth(P)}}),asynchronous:false,shadows:y}))}};N.prototype.getBoundingSphere=function(e,t){return C(e,this._primitive,this._outlinePrimitive,t)};N.prototype.isDestroyed=function(){return false};N.prototype.destroy=function(){var e=this._primitives;e.removeAndDestroy(this._primitive);e.removeAndDestroy(this._outlinePrimitive);s(this)};return R});define("DataSources/ImageMaterialProperty",["../Core/Cartesian2","../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/Event","./createPropertyDescriptor","./Property"],function(e,t,r,i,n,a,o,s){"use strict";var u=new e(1,1);var l=false;var c=t.WHITE;function d(e){e=r(e,r.EMPTY_OBJECT);this._definitionChanged=new a;this._image=undefined;this._imageSubscription=undefined;this._repeat=undefined;this._repeatSubscription=undefined;this._color=undefined;this._colorSubscription=undefined;this._transparent=undefined;this._transparentSubscription=undefined;this.image=e.image;this.repeat=e.repeat;this.color=e.color;this.transparent=e.transparent}n(d.prototype,{isConstant:{get:function(){return s.isConstant(this._image)&&s.isConstant(this._repeat)}},definitionChanged:{get:function(){return this._definitionChanged}},image:o("image"),repeat:o("repeat"),color:o("color"),transparent:o("transparent")});d.prototype.getType=function(e){return"Image"};d.prototype.getValue=function(e,t){if(!i(t)){t={}}t.image=s.getValueOrUndefined(this._image,e);t.repeat=s.getValueOrClonedDefault(this._repeat,e,u,t.repeat);t.color=s.getValueOrClonedDefault(this._color,e,c,t.color);if(s.getValueOrDefault(this._transparent,e,l)){t.color.alpha=Math.min(.99,t.color.alpha)}return t};d.prototype.equals=function(e){return this===e||e instanceof d&&s.equals(this._image,e._image)&&s.equals(this._color,e._color)&&s.equals(this._transparent,e._transparent)&&s.equals(this._repeat,e._repeat)};return d});define("DataSources/createMaterialPropertyDescriptor",["../Core/Color","../Core/DeveloperError","./ColorMaterialProperty","./createPropertyDescriptor","./ImageMaterialProperty"],function(e,t,r,i,n){"use strict";function a(i){if(i instanceof e){return new r(i)}if(typeof i==="string"||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement){var a=new n;a.image=i;return a}throw new t("Unable to infer material type: "+i)}function o(e,t){return i(e,t,a)}return o});define("DataSources/BoxGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createMaterialPropertyDescriptor","./createPropertyDescriptor"],function(e,t,r,i,n,a,o){"use strict";function s(t){this._dimensions=undefined;this._dimensionsSubscription=undefined;this._show=undefined;this._showSubscription=undefined;this._fill=undefined;this._fillSubscription=undefined;this._material=undefined;this._materialSubscription=undefined;this._outline=undefined;this._outlineSubscription=undefined;this._outlineColor=undefined;this._outlineColorSubscription=undefined;this._outlineWidth=undefined;this._outlineWidthSubscription=undefined;this._shadows=undefined;this._shadowsSubscription=undefined;this._distanceDisplayCondition=undefined;this._distanceDisplayConditionSubscription=undefined;this._definitionChanged=new n;this.merge(e(t,e.EMPTY_OBJECT))}r(s.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:o("show"),dimensions:o("dimensions"),material:a("material"),fill:o("fill"),outline:o("outline"),outlineColor:o("outlineColor"),outlineWidth:o("outlineWidth"),shadows:o("shadows"),distanceDisplayCondition:o("distanceDisplayCondition")});s.prototype.clone=function(e){if(!t(e)){return new s(this)}e.dimensions=this.dimensions;e.show=this.show;e.material=this.material;e.fill=this.fill;e.outline=this.outline;e.outlineColor=this.outlineColor;e.outlineWidth=this.outlineWidth;e.shadows=this.shadows;e.distanceDisplayCondition=this.distanceDisplayCondition;return e};s.prototype.merge=function(r){if(!t(r)){throw new i("source is required.")}this.dimensions=e(this.dimensions,r.dimensions);this.show=e(this.show,r.show);this.material=e(this.material,r.material);this.fill=e(this.fill,r.fill);this.outline=e(this.outline,r.outline);this.outlineColor=e(this.outlineColor,r.outlineColor);this.outlineWidth=e(this.outlineWidth,r.outlineWidth);this.shadows=e(this.shadows,r.shadows);this.distanceDisplayCondition=e(this.distanceDisplayCondition,r.distanceDisplayCondition)};return s});define("DataSources/CallbackProperty",["../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event"],function(e,t,r,i){"use strict";function n(e,t){this._callback=undefined;this._isConstant=undefined;this._definitionChanged=new i;this.setCallback(e,t)}t(n.prototype,{isConstant:{get:function(){return this._isConstant}},definitionChanged:{get:function(){return this._definitionChanged}}});n.prototype.getValue=function(e,t){return this._callback(e,t)};n.prototype.setCallback=function(t,i){if(!e(t)){throw new r("callback is required.")}if(!e(i)){throw new r("isConstant is required.")}var n=this._callback!==t||this._isConstant!==i;this._callback=t;this._isConstant=i;if(n){this._definitionChanged.raiseEvent(this)}};n.prototype.equals=function(e){return this===e||e instanceof n&&this._callback===e._callback&&this._isConstant===e._isConstant};return n});define("DataSources/CheckerboardMaterialProperty",["../Core/Cartesian2","../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/Event","./createPropertyDescriptor","./Property"],function(e,t,r,i,n,a,o,s){"use strict";var u=t.WHITE;var l=t.BLACK;var c=new e(2,2);function d(e){e=r(e,r.EMPTY_OBJECT);this._definitionChanged=new a;this._evenColor=undefined;this._evenColorSubscription=undefined;this._oddColor=undefined;this._oddColorSubscription=undefined;this._repeat=undefined;this._repeatSubscription=undefined;this.evenColor=e.evenColor;this.oddColor=e.oddColor;this.repeat=e.repeat}n(d.prototype,{isConstant:{get:function(){return s.isConstant(this._evenColor)&&s.isConstant(this._oddColor)&&s.isConstant(this._repeat)}},definitionChanged:{get:function(){return this._definitionChanged}},evenColor:o("evenColor"),oddColor:o("oddColor"),repeat:o("repeat")});d.prototype.getType=function(e){return"Checkerboard"};d.prototype.getValue=function(e,t){if(!i(t)){t={}}t.lightColor=s.getValueOrClonedDefault(this._evenColor,e,u,t.lightColor);t.darkColor=s.getValueOrClonedDefault(this._oddColor,e,l,t.darkColor);t.repeat=s.getValueOrDefault(this._repeat,e,c);return t};d.prototype.equals=function(e){return this===e||e instanceof d&&s.equals(this._evenColor,e._evenColor)&&s.equals(this._oddColor,e._oddColor)&&s.equals(this._repeat,e._repeat)};return d});define("DataSources/PositionProperty",["../Core/Cartesian3","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Matrix3","../Core/ReferenceFrame","../Core/Transforms"],function(e,t,r,i,n,a,o){"use strict";function s(){i.throwInstantiationError()}r(s.prototype,{isConstant:{get:i.throwInstantiationError},definitionChanged:{get:i.throwInstantiationError},referenceFrame:{get:i.throwInstantiationError}});s.prototype.getValue=i.throwInstantiationError;s.prototype.getValueInReferenceFrame=i.throwInstantiationError;s.prototype.equals=i.throwInstantiationError;var u=new n;s.convertToReferenceFrame=function(r,i,s,l,c){if(!t(i)){return i}if(!t(c)){c=new e}if(s===l){return e.clone(i,c)}var d=o.computeIcrfToFixedMatrix(r,u);if(!t(d)){d=o.computeTemeToPseudoFixedMatrix(r,u)}if(s===a.INERTIAL){return n.multiplyByVector(d,i,c)}if(s===a.FIXED){return n.multiplyByVector(n.transpose(d,u),i,c)}};return s});define("DataSources/ConstantPositionProperty",["../Core/Cartesian3","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/ReferenceFrame","./PositionProperty"],function(e,t,r,i,n,a,o,s){"use strict";function u(r,i){this._definitionChanged=new a;this._value=e.clone(r);this._referenceFrame=t(i,o.FIXED)}i(u.prototype,{isConstant:{get:function(){return!r(this._value)||this._referenceFrame===o.FIXED}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return this._referenceFrame}}});u.prototype.getValue=function(e,t){return this.getValueInReferenceFrame(e,o.FIXED,t)};u.prototype.setValue=function(t,i){var n=false;if(!e.equals(this._value,t)){n=true;this._value=e.clone(t)}if(r(i)&&this._referenceFrame!==i){n=true;this._referenceFrame=i}if(n){this._definitionChanged.raiseEvent(this)}};u.prototype.getValueInReferenceFrame=function(e,t,i){if(!r(e)){throw new n("time is required.")}if(!r(t)){throw new n("referenceFrame is required.")}return s.convertToReferenceFrame(e,this._value,this._referenceFrame,t,i)};u.prototype.equals=function(t){return this===t||t instanceof u&&e.equals(this._value,t._value)&&this._referenceFrame===t._referenceFrame};return u});define("DataSources/CorridorGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createMaterialPropertyDescriptor","./createPropertyDescriptor"],function(e,t,r,i,n,a,o){"use strict";function s(t){this._show=undefined;this._showSubscription=undefined;this._material=undefined;this._materialSubscription=undefined;this._positions=undefined;this._positionsSubscription=undefined;this._height=undefined;this._heightSubscription=undefined;this._extrudedHeight=undefined;this._extrudedHeightSubscription=undefined;this._granularity=undefined;this._granularitySubscription=undefined;this._width=undefined;this._widthSubscription=undefined;this._cornerType=undefined;this._cornerTypeSubscription=undefined;this._fill=undefined;this._fillSubscription=undefined;this._outline=undefined;this._outlineSubscription=undefined;this._outlineColor=undefined;this._outlineColorSubscription=undefined;this._outlineWidth=undefined;this._outlineWidthSubscription=undefined;this._shadows=undefined;this._shadowsSubscription=undefined;this._distanceDisplayCondition=undefined;this._distanceDisplayConditionSubscription=undefined;this._definitionChanged=new n;this.merge(e(t,e.EMPTY_OBJECT))}r(s.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:o("show"),material:a("material"),positions:o("positions"),height:o("height"),extrudedHeight:o("extrudedHeight"),granularity:o("granularity"),width:o("width"),fill:o("fill"),outline:o("outline"),outlineColor:o("outlineColor"),outlineWidth:o("outlineWidth"),cornerType:o("cornerType"),shadows:o("shadows"),distanceDisplayCondition:o("distanceDisplayCondition")});s.prototype.clone=function(e){if(!t(e)){return new s(this)}e.show=this.show;e.material=this.material;e.positions=this.positions;e.height=this.height;e.extrudedHeight=this.extrudedHeight;e.granularity=this.granularity;e.width=this.width;e.fill=this.fill;e.outline=this.outline;e.outlineColor=this.outlineColor;e.outlineWidth=this.outlineWidth;e.cornerType=this.cornerType;e.shadows=this.shadows;e.distanceDisplayCondition=this.distanceDisplayCondition;return e};s.prototype.merge=function(r){if(!t(r)){throw new i("source is required.")}this.show=e(this.show,r.show);this.material=e(this.material,r.material);this.positions=e(this.positions,r.positions);this.height=e(this.height,r.height);this.extrudedHeight=e(this.extrudedHeight,r.extrudedHeight);this.granularity=e(this.granularity,r.granularity);this.width=e(this.width,r.width);this.fill=e(this.fill,r.fill);this.outline=e(this.outline,r.outline);this.outlineColor=e(this.outlineColor,r.outlineColor);this.outlineWidth=e(this.outlineWidth,r.outlineWidth);this.cornerType=e(this.cornerType,r.cornerType);this.shadows=e(this.shadows,r.shadows);this.distanceDisplayCondition=e(this.distanceDisplayCondition,r.distanceDisplayCondition)};return s});define("DataSources/createRawPropertyDescriptor",["./createPropertyDescriptor"],function(e){"use strict";function t(e){return e}function r(r,i){return e(r,i,t)}return r});define("DataSources/CylinderGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createMaterialPropertyDescriptor","./createPropertyDescriptor"],function(e,t,r,i,n,a,o){"use strict";function s(t){this._length=undefined;this._lengthSubscription=undefined;this._topRadius=undefined;this._topRadiusSubscription=undefined;this._bottomRadius=undefined;this._bottomRadiusSubscription=undefined;this._numberOfVerticalLines=undefined;this._numberOfVerticalLinesSubscription=undefined;this._slices=undefined;this._slicesSubscription=undefined;this._show=undefined;this._showSubscription=undefined;this._material=undefined;this._materialSubscription=undefined;this._fill=undefined;this._fillSubscription=undefined;this._outline=undefined;this._outlineSubscription=undefined;this._outlineColor=undefined;this._outlineColorSubscription=undefined;this._outlineWidth=undefined;this._outlineWidthSubscription=undefined;this._shadows=undefined;this._shadowsSubscription=undefined;this._distanceDisplayCondition=undefined;this._distanceDisplayConditionSubscription=undefined;this._definitionChanged=new n;this.merge(e(t,e.EMPTY_OBJECT))}r(s.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},length:o("length"),topRadius:o("topRadius"),bottomRadius:o("bottomRadius"),numberOfVerticalLines:o("numberOfVerticalLines"),slices:o("slices"),show:o("show"),material:a("material"),fill:o("fill"),outline:o("outline"),outlineColor:o("outlineColor"),outlineWidth:o("outlineWidth"),shadows:o("shadows"),distanceDisplayCondition:o("distanceDisplayCondition")});s.prototype.clone=function(e){if(!t(e)){return new s(this)}e.bottomRadius=this.bottomRadius;e.length=this.length;e.topRadius=this.topRadius;e.show=this.show;e.material=this.material;e.numberOfVerticalLines=this.numberOfVerticalLines;e.slices=this.slices;e.fill=this.fill;e.outline=this.outline;e.outlineColor=this.outlineColor;e.outlineWidth=this.outlineWidth;e.shadows=this.shadows;e.distanceDisplayCondition=this.distanceDisplayCondition;return e};s.prototype.merge=function(r){if(!t(r)){throw new i("source is required.")}this.bottomRadius=e(this.bottomRadius,r.bottomRadius);this.length=e(this.length,r.length);this.topRadius=e(this.topRadius,r.topRadius);this.show=e(this.show,r.show);this.material=e(this.material,r.material);this.numberOfVerticalLines=e(this.numberOfVerticalLines,r.numberOfVerticalLines);this.slices=e(this.slices,r.slices);this.fill=e(this.fill,r.fill);this.outline=e(this.outline,r.outline);this.outlineColor=e(this.outlineColor,r.outlineColor);this.outlineWidth=e(this.outlineWidth,r.outlineWidth);this.shadows=e(this.shadows,r.shadows);this.distanceDisplayCondition=e(this.distanceDisplayCondition,r.distanceDisplayCondition)};return s});define("DataSources/EllipseGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createMaterialPropertyDescriptor","./createPropertyDescriptor"],function(e,t,r,i,n,a,o){"use strict";function s(t){this._semiMajorAxis=undefined;this._semiMajorAxisSubscription=undefined;this._semiMinorAxis=undefined;this._semiMinorAxisSubscription=undefined;this._rotation=undefined;this._rotationSubscription=undefined;this._show=undefined;this._showSubscription=undefined;this._material=undefined;this._materialSubscription=undefined;this._height=undefined;this._heightSubscription=undefined;this._extrudedHeight=undefined;this._extrudedHeightSubscription=undefined;this._granularity=undefined;this._granularitySubscription=undefined;this._stRotation=undefined;this._stRotationSubscription=undefined;this._fill=undefined;this._fillSubscription=undefined;this._outline=undefined;this._outlineSubscription=undefined;this._outlineColor=undefined;this._outlineColorSubscription=undefined;this._outlineWidth=undefined;this._outlineWidthSubscription=undefined;this._numberOfVerticalLines=undefined;this._numberOfVerticalLinesSubscription=undefined;this._shadows=undefined;this._shadowsSubscription=undefined;this._distanceDisplayCondition=undefined;this._distanceDisplayConditionSubscription=undefined;this._definitionChanged=new n;this.merge(e(t,e.EMPTY_OBJECT))}r(s.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},semiMajorAxis:o("semiMajorAxis"),semiMinorAxis:o("semiMinorAxis"),rotation:o("rotation"),show:o("show"),material:a("material"),height:o("height"),extrudedHeight:o("extrudedHeight"),granularity:o("granularity"),stRotation:o("stRotation"),fill:o("fill"),outline:o("outline"),outlineColor:o("outlineColor"),outlineWidth:o("outlineWidth"),numberOfVerticalLines:o("numberOfVerticalLines"),shadows:o("shadows"),distanceDisplayCondition:o("distanceDisplayCondition")});s.prototype.clone=function(e){if(!t(e)){return new s(this)}e.rotation=this.rotation;e.semiMajorAxis=this.semiMajorAxis;e.semiMinorAxis=this.semiMinorAxis;e.show=this.show;e.material=this.material;e.height=this.height;e.extrudedHeight=this.extrudedHeight;e.granularity=this.granularity;e.stRotation=this.stRotation;e.fill=this.fill;e.outline=this.outline;e.outlineColor=this.outlineColor;e.outlineWidth=this.outlineWidth;e.numberOfVerticalLines=this.numberOfVerticalLines;e.shadows=this.shadows;e.distanceDisplayCondition=this.distanceDisplayCondition;return e};s.prototype.merge=function(r){if(!t(r)){throw new i("source is required.")}this.rotation=e(this.rotation,r.rotation);this.semiMajorAxis=e(this.semiMajorAxis,r.semiMajorAxis);this.semiMinorAxis=e(this.semiMinorAxis,r.semiMinorAxis);this.show=e(this.show,r.show);this.material=e(this.material,r.material);this.height=e(this.height,r.height);this.extrudedHeight=e(this.extrudedHeight,r.extrudedHeight);this.granularity=e(this.granularity,r.granularity);this.stRotation=e(this.stRotation,r.stRotation);this.fill=e(this.fill,r.fill);this.outline=e(this.outline,r.outline);this.outlineColor=e(this.outlineColor,r.outlineColor)
;this.outlineWidth=e(this.outlineWidth,r.outlineWidth);this.numberOfVerticalLines=e(this.numberOfVerticalLines,r.numberOfVerticalLines);this.shadows=e(this.shadows,r.shadows);this.distanceDisplayCondition=e(this.distanceDisplayCondition,r.distanceDisplayCondition)};return s});define("DataSources/EllipsoidGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createMaterialPropertyDescriptor","./createPropertyDescriptor"],function(e,t,r,i,n,a,o){"use strict";function s(t){this._show=undefined;this._showSubscription=undefined;this._radii=undefined;this._radiiSubscription=undefined;this._material=undefined;this._materialSubscription=undefined;this._stackPartitions=undefined;this._stackPartitionsSubscription=undefined;this._slicePartitions=undefined;this._slicePartitionsSubscription=undefined;this._subdivisions=undefined;this._subdivisionsSubscription=undefined;this._fill=undefined;this._fillSubscription=undefined;this._outline=undefined;this._outlineSubscription=undefined;this._outlineColor=undefined;this._outlineColorSubscription=undefined;this._outlineWidth=undefined;this._outlineWidthSubscription=undefined;this._shadows=undefined;this._shadowsSubscription=undefined;this._distanceDisplayCondition=undefined;this._distanceDisplayConditionSubscription=undefined;this._definitionChanged=new n;this.merge(e(t,e.EMPTY_OBJECT))}r(s.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:o("show"),radii:o("radii"),material:a("material"),fill:o("fill"),outline:o("outline"),outlineColor:o("outlineColor"),outlineWidth:o("outlineWidth"),stackPartitions:o("stackPartitions"),slicePartitions:o("slicePartitions"),subdivisions:o("subdivisions"),shadows:o("shadows"),distanceDisplayCondition:o("distanceDisplayCondition")});s.prototype.clone=function(e){if(!t(e)){return new s(this)}e.show=this.show;e.radii=this.radii;e.material=this.material;e.fill=this.fill;e.outline=this.outline;e.outlineColor=this.outlineColor;e.outlineWidth=this.outlineWidth;e.stackPartitions=this.stackPartitions;e.slicePartitions=this.slicePartitions;e.subdivisions=this.subdivisions;e.shadows=this.shadows;e.distanceDisplayCondition=this.distanceDisplayCondition;return e};s.prototype.merge=function(r){if(!t(r)){throw new i("source is required.")}this.show=e(this.show,r.show);this.radii=e(this.radii,r.radii);this.material=e(this.material,r.material);this.fill=e(this.fill,r.fill);this.outline=e(this.outline,r.outline);this.outlineColor=e(this.outlineColor,r.outlineColor);this.outlineWidth=e(this.outlineWidth,r.outlineWidth);this.stackPartitions=e(this.stackPartitions,r.stackPartitions);this.slicePartitions=e(this.slicePartitions,r.slicePartitions);this.subdivisions=e(this.subdivisions,r.subdivisions);this.shadows=e(this.shadows,r.shadows);this.distanceDisplayCondition=e(this.distanceDisplayCondition,r.distanceDisplayCondition)};return s});define("DataSources/LabelGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createPropertyDescriptor"],function(e,t,r,i,n,a){"use strict";function o(t){this._text=undefined;this._textSubscription=undefined;this._font=undefined;this._fontSubscription=undefined;this._style=undefined;this._styleSubscription=undefined;this._fillColor=undefined;this._fillColorSubscription=undefined;this._outlineColor=undefined;this._outlineColorSubscription=undefined;this._outlineWidth=undefined;this._outlineWidthSubscription=undefined;this._horizontalOrigin=undefined;this._horizontalOriginSubscription=undefined;this._verticalOrigin=undefined;this._verticalOriginSubscription=undefined;this._eyeOffset=undefined;this._eyeOffsetSubscription=undefined;this._heightReference=undefined;this._heightReferenceSubscription=undefined;this._pixelOffset=undefined;this._pixelOffsetSubscription=undefined;this._scale=undefined;this._scaleSubscription=undefined;this._show=undefined;this._showSubscription=undefined;this._showBackground=undefined;this._showBackgroundSubscription=undefined;this._backgroundColor=undefined;this._backgroundColorSubscription=undefined;this._backgroundPadding=undefined;this._backgroundPaddingSubscription=undefined;this._translucencyByDistance=undefined;this._translucencyByDistanceSubscription=undefined;this._pixelOffsetScaleByDistance=undefined;this._pixelOffsetScaleByDistanceSubscription=undefined;this._scaleByDistance=undefined;this._scaleByDistanceSubscription=undefined;this._distanceDisplayCondition=undefined;this._distanceDisplayConditionSubscription=undefined;this._definitionChanged=new n;this.merge(e(t,e.EMPTY_OBJECT))}r(o.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},text:a("text"),font:a("font"),style:a("style"),fillColor:a("fillColor"),outlineColor:a("outlineColor"),outlineWidth:a("outlineWidth"),horizontalOrigin:a("horizontalOrigin"),verticalOrigin:a("verticalOrigin"),eyeOffset:a("eyeOffset"),heightReference:a("heightReference"),pixelOffset:a("pixelOffset"),scale:a("scale"),show:a("show"),showBackground:a("showBackground"),backgroundColor:a("backgroundColor"),backgroundPadding:a("backgroundPadding"),translucencyByDistance:a("translucencyByDistance"),pixelOffsetScaleByDistance:a("pixelOffsetScaleByDistance"),scaleByDistance:a("scaleByDistance"),distanceDisplayCondition:a("distanceDisplayCondition")});o.prototype.clone=function(e){if(!t(e)){return new o(this)}e.text=this.text;e.font=this.font;e.show=this.show;e.style=this.style;e.fillColor=this.fillColor;e.outlineColor=this.outlineColor;e.outlineWidth=this.outlineWidth;e.showBackground=this.showBackground;e.backgroundColor=this.backgroundColor;e.backgroundPadding=this.backgroundPadding;e.scale=this.scale;e.horizontalOrigin=this.horizontalOrigin;e.verticalOrigin=this.verticalOrigin;e.eyeOffset=this.eyeOffset;e.heightReference=this.heightReference;e.pixelOffset=this.pixelOffset;e.translucencyByDistance=this.translucencyByDistance;e.pixelOffsetScaleByDistance=this.pixelOffsetScaleByDistance;e.scaleByDistance=this.scaleByDistance;e.distanceDisplayCondition=this.distanceDisplayCondition;return e};o.prototype.merge=function(r){if(!t(r)){throw new i("source is required.")}this.text=e(this.text,r.text);this.font=e(this.font,r.font);this.show=e(this.show,r.show);this.style=e(this.style,r.style);this.fillColor=e(this.fillColor,r.fillColor);this.outlineColor=e(this.outlineColor,r.outlineColor);this.outlineWidth=e(this.outlineWidth,r.outlineWidth);this.showBackground=e(this.showBackground,r.showBackground);this.backgroundColor=e(this.backgroundColor,r.backgroundColor);this.backgroundPadding=e(this.backgroundPadding,r.backgroundPadding);this.scale=e(this.scale,r.scale);this.horizontalOrigin=e(this.horizontalOrigin,r.horizontalOrigin);this.verticalOrigin=e(this.verticalOrigin,r.verticalOrigin);this.eyeOffset=e(this.eyeOffset,r.eyeOffset);this.heightReference=e(this.heightReference,r.heightReference);this.pixelOffset=e(this.pixelOffset,r.pixelOffset);this.translucencyByDistance=e(this._translucencyByDistance,r.translucencyByDistance);this.pixelOffsetScaleByDistance=e(this._pixelOffsetScaleByDistance,r.pixelOffsetScaleByDistance);this.scaleByDistance=e(this._scaleByDistance,r.scaleByDistance);this.distanceDisplayCondition=e(this.distanceDisplayCondition,r.distanceDisplayCondition)};return o});define("DataSources/NodeTransformationProperty",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/Event","../Core/TranslationRotationScale","./createPropertyDescriptor","./Property"],function(e,t,r,i,n,a,o){"use strict";var s=new n;var u=function(t){t=e(t,e.EMPTY_OBJECT);this._definitionChanged=new i;this._translation=undefined;this._translationSubscription=undefined;this._rotation=undefined;this._rotationSubscription=undefined;this._scale=undefined;this._scaleSubscription=undefined;this.translation=t.translation;this.rotation=t.rotation;this.scale=t.scale};r(u.prototype,{isConstant:{get:function(){return o.isConstant(this._translation)&&o.isConstant(this._rotation)&&o.isConstant(this._scale)}},definitionChanged:{get:function(){return this._definitionChanged}},translation:a("translation"),rotation:a("rotation"),scale:a("scale")});u.prototype.getValue=function(e,r){if(!t(r)){r=new n}r.translation=o.getValueOrClonedDefault(this._translation,e,s.translation,r.translation);r.rotation=o.getValueOrClonedDefault(this._rotation,e,s.rotation,r.rotation);r.scale=o.getValueOrClonedDefault(this._scale,e,s.scale,r.scale);return r};u.prototype.equals=function(e){return this===e||e instanceof u&&o.equals(this._translation,e._translation)&&o.equals(this._rotation,e._rotation)&&o.equals(this._scale,e._scale)};return u});define("DataSources/PropertyBag",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./ConstantProperty","./createPropertyDescriptor","./Property"],function(e,t,r,i,n,a,o,s){"use strict";var u=function(e,r){this._propertyNames=[];this._definitionChanged=new n;if(t(e)){this.merge(e,r)}};r(u.prototype,{propertyNames:{get:function(){return this._propertyNames}},isConstant:{get:function(){var e=this._propertyNames;for(var t=0,r=e.length;t<r;t++){if(!s.isConstant(this[e[t]])){return false}}return true}},definitionChanged:{get:function(){return this._definitionChanged}}});u.prototype.hasProperty=function(e){return this._propertyNames.indexOf(e)!==-1};function l(e){return new a(e)}u.prototype.addProperty=function(r,n,a){var s=this._propertyNames;if(!t(r)){throw new i("propertyName is required.")}if(s.indexOf(r)!==-1){throw new i(r+" is already a registered property.")}s.push(r);Object.defineProperty(this,r,o(r,true,e(a,l)));if(t(n)){this[r]=n}this._definitionChanged.raiseEvent(this)};u.prototype.removeProperty=function(e){var r=this._propertyNames;var n=r.indexOf(e);if(!t(e)){throw new i("propertyName is required.")}if(n===-1){throw new i(e+" is not a registered property.")}this._propertyNames.splice(n,1);delete this[e];this._definitionChanged.raiseEvent(this)};u.prototype.getValue=function(e,r){if(!t(e)){throw new i("time is required.")}if(!t(r)){r={}}var n=this._propertyNames;for(var a=0,o=n.length;a<o;a++){var u=n[a];r[u]=s.getValueOrUndefined(this[u],e,r[u])}return r};u.prototype.merge=function(e,r){if(!t(e)){throw new i("source is required.")}var n=this._propertyNames;var a=t(e._propertyNames)?e._propertyNames:Object.keys(e);for(var o=0,s=a.length;o<s;o++){var u=a[o];var l=this[u];var c=e[u];if(!t(l)&&n.indexOf(u)===-1){this.addProperty(u,undefined,r)}if(t(c)){if(t(l)){if(t(l.merge)){l.merge(c)}}else if(t(c.merge)&&t(c.clone)){this[u]=c.clone()}else{this[u]=c}}}};function c(e,t){var r=e._propertyNames;var i=t._propertyNames;var n=r.length;if(n!==i.length){return false}for(var a=0;a<n;++a){var o=r[a];var u=i.indexOf(o);if(u===-1){return false}if(!s.equals(e[o],t[o])){return false}}return true}u.prototype.equals=function(e){return this===e||e instanceof u&&c(this,e)};return u});define("DataSources/ModelGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createPropertyDescriptor","./NodeTransformationProperty","./PropertyBag"],function(e,t,r,i,n,a,o,s){"use strict";function u(e){return new o(e)}function l(e){return new s(e,u)}function c(t){this._show=undefined;this._showSubscription=undefined;this._scale=undefined;this._scaleSubscription=undefined;this._minimumPixelSize=undefined;this._minimumPixelSizeSubscription=undefined;this._maximumScale=undefined;this._maximumScaleSubscription=undefined;this._incrementallyLoadTextures=undefined;this._incrementallyLoadTexturesSubscription=undefined;this._shadows=undefined;this._shadowsSubscription=undefined;this._uri=undefined;this._uriSubscription=undefined;this._runAnimations=undefined;this._runAnimationsSubscription=undefined;this._nodeTransformations=undefined;this._nodeTransformationsSubscription=undefined;this._heightReference=undefined;this._heightReferenceSubscription=undefined;this._distanceDisplayCondition=undefined;this._distanceDisplayConditionSubscription=undefined;this._silhouetteColor=undefined;this._silhouetteColorSubscription=undefined;this._silhouetteSize=undefined;this._silhouetteSizeSubscription=undefined;this._color=undefined;this._colorSubscription=undefined;this._colorBlendMode=undefined;this._colorBlendModeSubscription=undefined;this._colorBlendAmount=undefined;this._colorBlendAmountSubscription=undefined;this._definitionChanged=new n;this.merge(e(t,e.EMPTY_OBJECT))}r(c.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:a("show"),scale:a("scale"),minimumPixelSize:a("minimumPixelSize"),maximumScale:a("maximumScale"),incrementallyLoadTextures:a("incrementallyLoadTextures"),shadows:a("shadows"),uri:a("uri"),runAnimations:a("runAnimations"),nodeTransformations:a("nodeTransformations",undefined,l),heightReference:a("heightReference"),distanceDisplayCondition:a("distanceDisplayCondition"),silhouetteColor:a("silhouetteColor"),silhouetteSize:a("silhouetteSize"),color:a("color"),colorBlendMode:a("colorBlendMode"),colorBlendAmount:a("colorBlendAmount")});c.prototype.clone=function(e){if(!t(e)){return new c(this)}e.show=this.show;e.scale=this.scale;e.minimumPixelSize=this.minimumPixelSize;e.maximumScale=this.maximumScale;e.incrementallyLoadTextures=this.incrementallyLoadTextures;e.shadows=this.shadows;e.uri=this.uri;e.runAnimations=this.runAnimations;e.nodeTransformations=this.nodeTransformations;e.heightReference=this._heightReference;e.distanceDisplayCondition=this.distanceDisplayCondition;e.silhouetteColor=this.silhouetteColor;e.silhouetteSize=this.silhouetteSize;e.color=this.color;e.colorBlendMode=this.colorBlendMode;e.colorBlendAmount=this.colorBlendAmount;return e};c.prototype.merge=function(r){if(!t(r)){throw new i("source is required.")}this.show=e(this.show,r.show);this.scale=e(this.scale,r.scale);this.minimumPixelSize=e(this.minimumPixelSize,r.minimumPixelSize);this.maximumScale=e(this.maximumScale,r.maximumScale);this.incrementallyLoadTextures=e(this.incrementallyLoadTextures,r.incrementallyLoadTextures);this.shadows=e(this.shadows,r.shadows);this.uri=e(this.uri,r.uri);this.runAnimations=e(this.runAnimations,r.runAnimations);this.heightReference=e(this.heightReference,r.heightReference);this.distanceDisplayCondition=e(this.distanceDisplayCondition,r.distanceDisplayCondition);this.silhouetteColor=e(this.silhouetteColor,r.silhouetteColor);this.silhouetteSize=e(this.silhouetteSize,r.silhouetteSize);this.color=e(this.color,r.color);this.colorBlendMode=e(this.colorBlendMode,r.colorBlendMode);this.colorBlendAmount=e(this.colorBlendAmount,r.colorBlendAmount);var n=r.nodeTransformations;if(t(n)){var a=this.nodeTransformations;if(t(a)){a.merge(n)}else{this.nodeTransformations=new s(n,u)}}};return c});define("DataSources/PathGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createMaterialPropertyDescriptor","./createPropertyDescriptor"],function(e,t,r,i,n,a,o){"use strict";function s(t){this._material=undefined;this._materialSubscription=undefined;this._show=undefined;this._showSubscription=undefined;this._width=undefined;this._widthSubscription=undefined;this._resolution=undefined;this._resolutionSubscription=undefined;this._leadTime=undefined;this._leadTimeSubscription=undefined;this._trailTime=undefined;this._trailTimeSubscription=undefined;this._distanceDisplayCondition=undefined;this._distanceDisplayConditionSubscription=undefined;this._definitionChanged=new n;this.merge(e(t,e.EMPTY_OBJECT))}r(s.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:o("show"),material:a("material"),width:o("width"),resolution:o("resolution"),leadTime:o("leadTime"),trailTime:o("trailTime"),distanceDisplayCondition:o("distanceDisplayCondition")});s.prototype.clone=function(e){if(!t(e)){return new s(this)}e.material=this.material;e.width=this.width;e.resolution=this.resolution;e.show=this.show;e.leadTime=this.leadTime;e.trailTime=this.trailTime;e.distanceDisplayCondition=this.distanceDisplayCondition;return e};s.prototype.merge=function(r){if(!t(r)){throw new i("source is required.")}this.material=e(this.material,r.material);this.width=e(this.width,r.width);this.resolution=e(this.resolution,r.resolution);this.show=e(this.show,r.show);this.leadTime=e(this.leadTime,r.leadTime);this.trailTime=e(this.trailTime,r.trailTime);this.distanceDisplayCondition=e(this.distanceDisplayCondition,r.distanceDisplayCondition)};return s});define("DataSources/PointGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createPropertyDescriptor"],function(e,t,r,i,n,a){"use strict";function o(t){this._color=undefined;this._colorSubscription=undefined;this._pixelSize=undefined;this._pixelSizeSubscription=undefined;this._outlineColor=undefined;this._outlineColorSubscription=undefined;this._outlineWidth=undefined;this._outlineWidthSubscription=undefined;this._show=undefined;this._showSubscription=undefined;this._scaleByDistance=undefined;this._scaleByDistanceSubscription=undefined;this._translucencyByDistance=undefined;this._translucencyByDistanceSubscription=undefined;this._heightReference=undefined;this._heightReferenceSubscription=undefined;this._distanceDisplayCondition=undefined;this._distanceDisplayConditionSubscription=undefined;this._definitionChanged=new n;this.merge(e(t,e.EMPTY_OBJECT))}r(o.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},color:a("color"),pixelSize:a("pixelSize"),outlineColor:a("outlineColor"),outlineWidth:a("outlineWidth"),show:a("show"),scaleByDistance:a("scaleByDistance"),translucencyByDistance:a("translucencyByDistance"),heightReference:a("heightReference"),distanceDisplayCondition:a("distanceDisplayCondition")});o.prototype.clone=function(e){if(!t(e)){return new o(this)}e.color=this.color;e.pixelSize=this.pixelSize;e.outlineColor=this.outlineColor;e.outlineWidth=this.outlineWidth;e.show=this.show;e.scaleByDistance=this.scaleByDistance;e.translucencyByDistance=this._translucencyByDistance;e.heightReference=this.heightReference;e.distanceDisplayCondition=this.distanceDisplayCondition;return e};o.prototype.merge=function(r){if(!t(r)){throw new i("source is required.")}this.color=e(this.color,r.color);this.pixelSize=e(this.pixelSize,r.pixelSize);this.outlineColor=e(this.outlineColor,r.outlineColor);this.outlineWidth=e(this.outlineWidth,r.outlineWidth);this.show=e(this.show,r.show);this.scaleByDistance=e(this.scaleByDistance,r.scaleByDistance);this.translucencyByDistance=e(this._translucencyByDistance,r.translucencyByDistance);this.heightReference=e(this.heightReference,r.heightReference);this.distanceDisplayCondition=e(this.distanceDisplayCondition,r.distanceDisplayCondition)};return o});define("DataSources/PolygonGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createMaterialPropertyDescriptor","./createPropertyDescriptor"],function(e,t,r,i,n,a,o){"use strict";function s(t){this._show=undefined;this._showSubscription=undefined;this._material=undefined;this._materialSubscription=undefined;this._hierarchy=undefined;this._hierarchySubscription=undefined;this._height=undefined;this._heightSubscription=undefined;this._extrudedHeight=undefined;this._extrudedHeightSubscription=undefined;this._granularity=undefined;this._granularitySubscription=undefined;this._stRotation=undefined;this._stRotationSubscription=undefined;this._perPositionHeight=undefined;this._perPositionHeightSubscription=undefined;this._outline=undefined;this._outlineSubscription=undefined;this._outlineColor=undefined;this._outlineColorSubscription=undefined;this._outlineWidth=undefined;this._outlineWidthSubscription=undefined;this._fill=undefined;this._fillSubscription=undefined;this._definitionChanged=new n;this._closeTop=undefined;this._closeTopSubscription=undefined;this._closeBottom=undefined;this._closeBottomSubscription=undefined;this._shadows=undefined;this._shadowsSubscription=undefined;this._distanceDisplayCondition=undefined;this._distanceDisplayConditionSubscription=undefined;this.merge(e(t,e.EMPTY_OBJECT))}r(s.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:o("show"),material:a("material"),hierarchy:o("hierarchy"),height:o("height"),extrudedHeight:o("extrudedHeight"),granularity:o("granularity"),stRotation:o("stRotation"),fill:o("fill"),outline:o("outline"),outlineColor:o("outlineColor"),outlineWidth:o("outlineWidth"),perPositionHeight:o("perPositionHeight"),closeTop:o("closeTop"),closeBottom:o("closeBottom"),shadows:o("shadows"),distanceDisplayCondition:o("distanceDisplayCondition")});s.prototype.clone=function(e){if(!t(e)){return new s(this)}e.show=this.show;e.material=this.material;e.hierarchy=this.hierarchy;e.height=this.height;e.extrudedHeight=this.extrudedHeight;e.granularity=this.granularity;e.stRotation=this.stRotation;e.fill=this.fill;e.outline=this.outline;e.outlineColor=this.outlineColor;e.outlineWidth=this.outlineWidth;e.perPositionHeight=this.perPositionHeight;e.closeTop=this.closeTop;e.closeBottom=this.closeBottom;e.shadows=this.shadows;e.distanceDisplayCondition=this.distanceDisplayCondition;return e};s.prototype.merge=function(r){if(!t(r)){throw new i("source is required.")}this.show=e(this.show,r.show);this.material=e(this.material,r.material);this.hierarchy=e(this.hierarchy,r.hierarchy);this.height=e(this.height,r.height);this.extrudedHeight=e(this.extrudedHeight,r.extrudedHeight);this.granularity=e(this.granularity,r.granularity);this.stRotation=e(this.stRotation,r.stRotation);this.fill=e(this.fill,r.fill);this.outline=e(this.outline,r.outline);this.outlineColor=e(this.outlineColor,r.outlineColor);this.outlineWidth=e(this.outlineWidth,r.outlineWidth);this.perPositionHeight=e(this.perPositionHeight,r.perPositionHeight);this.closeTop=e(this.closeTop,r.closeTop);this.closeBottom=e(this.closeBottom,r.closeBottom);this.shadows=e(this.shadows,r.shadows);this.distanceDisplayCondition=e(this.distanceDisplayCondition,r.distanceDisplayCondition)};return s});define("DataSources/PolylineGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createMaterialPropertyDescriptor","./createPropertyDescriptor"],function(e,t,r,i,n,a,o){"use strict";function s(t){this._show=undefined;this._showSubscription=undefined;this._material=undefined;this._materialSubscription=undefined;this._positions=undefined;this._positionsSubscription=undefined;this._followSurface=undefined;this._followSurfaceSubscription=undefined;this._granularity=undefined;this._granularitySubscription=undefined;this._widthSubscription=undefined;this._width=undefined;this._widthSubscription=undefined;this._shadows=undefined;this._shadowsSubscription=undefined;this._distanceDisplayCondition=undefined;this._distanceDisplayConditionSubscription=undefined;this._definitionChanged=new n;this.merge(e(t,e.EMPTY_OBJECT))}r(s.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:o("show"),material:a("material"),positions:o("positions"),width:o("width"),followSurface:o("followSurface"),granularity:o("granularity"),shadows:o("shadows"),distanceDisplayCondition:o("distanceDisplayCondition")});s.prototype.clone=function(e){if(!t(e)){return new s(this)}e.show=this.show;e.material=this.material;e.positions=this.positions;e.width=this.width;e.followSurface=this.followSurface;e.granularity=this.granularity;e.shadows=this.shadows;e.distanceDisplayCondition=this.distanceDisplayCondition;return e};s.prototype.merge=function(r){if(!t(r)){throw new i("source is required.")}this.show=e(this.show,r.show);this.material=e(this.material,r.material);this.positions=e(this.positions,r.positions);this.width=e(this.width,r.width);this.followSurface=e(this.followSurface,r.followSurface);this.granularity=e(this.granularity,r.granularity);this.shadows=e(this.shadows,r.shadows);this.distanceDisplayCondition=e(this.distanceDisplayCondition,r.distanceDisplayCondition)};return s});define("DataSources/PolylineVolumeGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createMaterialPropertyDescriptor","./createPropertyDescriptor"],function(e,t,r,i,n,a,o){"use strict";function s(t){this._show=undefined;this._showSubscription=undefined;this._material=undefined;this._materialSubscription=undefined;this._positions=undefined;this._positionsSubscription=undefined;this._shape=undefined;this._shapeSubscription=undefined;this._granularity=undefined;this._granularitySubscription=undefined;this._cornerType=undefined;this._cornerTypeSubscription=undefined;this._fill=undefined;this._fillSubscription=undefined;this._outline=undefined;this._outlineSubscription=undefined;this._outlineColor=undefined;this._outlineColorSubscription=undefined;this._outlineWidth=undefined;this._outlineWidthSubscription=undefined;this._shadows=undefined;this._shadowsSubscription=undefined;this._distanceDisplayCondition=undefined;this._distanceDisplayConditionSubsription=undefined;this._definitionChanged=new n;this.merge(e(t,e.EMPTY_OBJECT))}r(s.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:o("show"),material:a("material"),positions:o("positions"),shape:o("shape"),granularity:o("granularity"),fill:o("fill"),outline:o("outline"),outlineColor:o("outlineColor"),outlineWidth:o("outlineWidth"),cornerType:o("cornerType"),shadows:o("shadows"),distanceDisplayCondition:o("distanceDisplayCondition")});s.prototype.clone=function(e){if(!t(e)){return new s(this)}e.show=this.show;e.material=this.material;e.positions=this.positions;e.shape=this.shape;e.granularity=this.granularity;e.fill=this.fill;e.outline=this.outline;e.outlineColor=this.outlineColor;e.outlineWidth=this.outlineWidth;e.cornerType=this.cornerType;e.shadows=this.shadows;e.distanceDisplayCondition=this.distanceDisplayCondition;return e};s.prototype.merge=function(r){if(!t(r)){throw new i("source is required.")}this.show=e(this.show,r.show);this.material=e(this.material,r.material);this.positions=e(this.positions,r.positions);this.shape=e(this.shape,r.shape);this.granularity=e(this.granularity,r.granularity);this.fill=e(this.fill,r.fill);this.outline=e(this.outline,r.outline);this.outlineColor=e(this.outlineColor,r.outlineColor);this.outlineWidth=e(this.outlineWidth,r.outlineWidth);this.cornerType=e(this.cornerType,r.cornerType);this.shadows=e(this.shadows,r.shadows);this.distanceDisplayCondition=e(this.distanceDisplayCondition,r.distanceDisplayCondition)};return s});define("DataSources/RectangleGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createMaterialPropertyDescriptor","./createPropertyDescriptor"],function(e,t,r,i,n,a,o){"use strict";function s(t){this._show=undefined;this._showSubscription=undefined;this._material=undefined;this._materialSubscription=undefined;this._coordinates=undefined;this._coordinatesSubscription=undefined;this._height=undefined;this._heightSubscription=undefined;this._extrudedHeight=undefined;this._extrudedHeightSubscription=undefined;this._granularity=undefined;this._granularitySubscription=undefined;this._stRotation=undefined;this._stRotationSubscription=undefined;this._rotation=undefined;this._rotationSubscription=undefined;this._closeTop=undefined;this._closeTopSubscription=undefined;this._closeBottom=undefined;this._closeBottomSubscription=undefined;this._fill=undefined;this._fillSubscription=undefined;this._outline=undefined;this._outlineSubscription=undefined;this._outlineColor=undefined;this._outlineColorSubscription=undefined;this._outlineWidth=undefined;this._outlineWidthSubscription=undefined;this._shadows=undefined;this._shadowsSubscription=undefined;this._distanceDisplayCondition=undefined;this._distancedisplayConditionSubscription=undefined;this._definitionChanged=new n;this.merge(e(t,e.EMPTY_OBJECT))}r(s.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:o("show"),coordinates:o("coordinates"),material:a("material"),height:o("height"),extrudedHeight:o("extrudedHeight"),granularity:o("granularity"),stRotation:o("stRotation"),rotation:o("rotation"),fill:o("fill"),outline:o("outline"),outlineColor:o("outlineColor"),outlineWidth:o("outlineWidth"),closeTop:o("closeTop"),closeBottom:o("closeBottom"),shadows:o("shadows"),distanceDisplayCondition:o("distanceDisplayCondition")});s.prototype.clone=function(e){if(!t(e)){return new s(this)}e.show=this.show;e.coordinates=this.coordinates;e.material=this.material;e.height=this.height;e.extrudedHeight=this.extrudedHeight;e.granularity=this.granularity;e.stRotation=this.stRotation;e.rotation=this.rotation;e.fill=this.fill;e.outline=this.outline;e.outlineColor=this.outlineColor;e.outlineWidth=this.outlineWidth;e.closeTop=this.closeTop;e.closeBottom=this.closeBottom;e.shadows=this.shadows;e.distanceDisplayCondition=this.distanceDisplayCondition;return e};s.prototype.merge=function(r){if(!t(r)){throw new i("source is required.")}this.show=e(this.show,r.show);this.coordinates=e(this.coordinates,r.coordinates);this.material=e(this.material,r.material);this.height=e(this.height,r.height);this.extrudedHeight=e(this.extrudedHeight,r.extrudedHeight);this.granularity=e(this.granularity,r.granularity);this.stRotation=e(this.stRotation,r.stRotation);this.rotation=e(this.rotation,r.rotation);this.fill=e(this.fill,r.fill);this.outline=e(this.outline,r.outline);this.outlineColor=e(this.outlineColor,r.outlineColor);this.outlineWidth=e(this.outlineWidth,r.outlineWidth);this.closeTop=e(this.closeTop,r.closeTop);this.closeBottom=e(this.closeBottom,r.closeBottom);this.shadows=e(this.shadows,r.shadows);this.distanceDisplayCondition=e(this.distanceDisplayCondition,r.distanceDisplayCondition)};return s});define("DataSources/WallGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createMaterialPropertyDescriptor","./createPropertyDescriptor"],function(e,t,r,i,n,a,o){"use strict";function s(t){this._show=undefined;this._showSubscription=undefined;this._material=undefined;this._materialSubscription=undefined;this._positions=undefined;this._positionsSubscription=undefined;this._minimumHeights=undefined;this._minimumHeightsSubscription=undefined;this._maximumHeights=undefined;this._maximumHeightsSubscription=undefined;this._granularity=undefined;this._granularitySubscription=undefined;this._fill=undefined;this._fillSubscription=undefined;this._outline=undefined;this._outlineSubscription=undefined;this._outlineColor=undefined;this._outlineColorSubscription=undefined;this._outlineWidth=undefined;this._outlineWidthSubscription=undefined;this._shadows=undefined;this._shadowsSubscription=undefined;this._distanceDisplayCondition=undefined;this._distanceDisplayConditionSubscription=undefined;this._definitionChanged=new n;this.merge(e(t,e.EMPTY_OBJECT))}r(s.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:o("show"),material:a("material"),positions:o("positions"),minimumHeights:o("minimumHeights"),maximumHeights:o("maximumHeights"),granularity:o("granularity"),fill:o("fill"),outline:o("outline"),outlineColor:o("outlineColor"),outlineWidth:o("outlineWidth"),shadows:o("shadows"),distanceDisplayCondition:o("distanceDisplayCondition")});s.prototype.clone=function(e){if(!t(e)){return new s(this)}e.show=this.show;e.material=this.material;e.positions=this.positions;e.minimumHeights=this.minimumHeights;e.maximumHeights=this.maximumHeights;e.granularity=this.granularity;e.fill=this.fill;e.outline=this.outline;e.outlineColor=this.outlineColor;e.outlineWidth=this.outlineWidth;e.shadows=this.shadows;e.distanceDisplayCondition=this.distanceDisplayCondition;return e};s.prototype.merge=function(r){if(!t(r)){
throw new i("source is required.")}this.show=e(this.show,r.show);this.material=e(this.material,r.material);this.positions=e(this.positions,r.positions);this.minimumHeights=e(this.minimumHeights,r.minimumHeights);this.maximumHeights=e(this.maximumHeights,r.maximumHeights);this.granularity=e(this.granularity,r.granularity);this.fill=e(this.fill,r.fill);this.outline=e(this.outline,r.outline);this.outlineColor=e(this.outlineColor,r.outlineColor);this.outlineWidth=e(this.outlineWidth,r.outlineWidth);this.shadows=e(this.shadows,r.shadows);this.distanceDisplayCondition=e(this.distanceDisplayCondition,r.distanceDisplayCondition)};return s});define("DataSources/Entity",["../Core/Cartesian3","../Core/createGuid","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/Matrix3","../Core/Matrix4","../Core/Quaternion","../Core/Transforms","./BillboardGraphics","./BoxGraphics","./ConstantPositionProperty","./CorridorGraphics","./createPropertyDescriptor","./createRawPropertyDescriptor","./CylinderGraphics","./EllipseGraphics","./EllipsoidGraphics","./LabelGraphics","./ModelGraphics","./PathGraphics","./PointGraphics","./PolygonGraphics","./PolylineGraphics","./PolylineVolumeGraphics","./Property","./RectangleGraphics","./WallGraphics"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w,C,b,S,E,T,x,A,P,D){"use strict";function M(e){return new h(e)}function I(e){return m(e,undefined,M)}function O(e,t){return m(e,undefined,function(e){if(e instanceof t){return e}return new t(e)})}function R(e){e=r(e,r.EMPTY_OBJECT);var n=e.id;if(!i(n)){n=t()}this._availability=undefined;this._id=n;this._definitionChanged=new o;this._name=e.name;this._show=r(e.show,true);this._parent=undefined;this._propertyNames=["billboard","box","corridor","cylinder","description","ellipse","ellipsoid","label","model","orientation","path","point","polygon","polyline","polylineVolume","position","rectangle","viewFrom","wall"];this._billboard=undefined;this._billboardSubscription=undefined;this._box=undefined;this._boxSubscription=undefined;this._corridor=undefined;this._corridorSubscription=undefined;this._cylinder=undefined;this._cylinderSubscription=undefined;this._description=undefined;this._descriptionSubscription=undefined;this._ellipse=undefined;this._ellipseSubscription=undefined;this._ellipsoid=undefined;this._ellipsoidSubscription=undefined;this._label=undefined;this._labelSubscription=undefined;this._model=undefined;this._modelSubscription=undefined;this._orientation=undefined;this._orientationSubscription=undefined;this._path=undefined;this._pathSubscription=undefined;this._point=undefined;this._pointSubscription=undefined;this._polygon=undefined;this._polygonSubscription=undefined;this._polyline=undefined;this._polylineSubscription=undefined;this._polylineVolume=undefined;this._polylineVolumeSubscription=undefined;this._position=undefined;this._positionSubscription=undefined;this._rectangle=undefined;this._rectangleSubscription=undefined;this._viewFrom=undefined;this._viewFromSubscription=undefined;this._wall=undefined;this._wallSubscription=undefined;this._children=[];this.entityCollection=undefined;this.parent=e.parent;this.merge(e)}function N(e,t,r){var i=t.length;for(var n=0;n<i;n++){var a=t[n];var o=a._show;var s=!r&&o;var u=r&&o;if(s!==u){N(a,a._children,r)}}e._definitionChanged.raiseEvent(e,"isShowing",r,!r)}n(R.prototype,{availability:v("availability"),id:{get:function(){return this._id}},definitionChanged:{get:function(){return this._definitionChanged}},name:v("name"),show:{get:function(){return this._show},set:function(e){if(!i(e)){throw new a("value is required.")}if(e===this._show){return}var t=this.isShowing;this._show=e;var r=this.isShowing;if(t!==r){N(this,this._children,r)}this._definitionChanged.raiseEvent(this,"show",e,!e)}},isShowing:{get:function(){return this._show&&(!i(this.entityCollection)||this.entityCollection.show)&&(!i(this._parent)||this._parent.isShowing)}},parent:{get:function(){return this._parent},set:function(e){var t=this._parent;if(t===e){return}var r=this.isShowing;if(i(t)){var n=t._children.indexOf(this);t._children.splice(n,1)}this._parent=e;if(i(e)){e._children.push(this)}var a=this.isShowing;if(r!==a){N(this,this._children,a)}this._definitionChanged.raiseEvent(this,"parent",e,t)}},propertyNames:{get:function(){return this._propertyNames}},billboard:O("billboard",d),box:O("box",f),corridor:O("corridor",p),cylinder:O("cylinder",_),description:m("description"),ellipse:O("ellipse",g),ellipsoid:O("ellipsoid",y),label:O("label",w),model:O("model",C),orientation:m("orientation"),path:O("path",b),point:O("point",S),polygon:O("polygon",E),polyline:O("polyline",T),polylineVolume:O("polylineVolume",x),position:I("position"),rectangle:O("rectangle",P),viewFrom:m("viewFrom"),wall:O("wall",D)});R.prototype.isAvailable=function(e){if(!i(e)){throw new a("time is required.")}var t=this._availability;return!i(t)||t.contains(e)};R.prototype.addProperty=function(e){var t=this._propertyNames;if(!i(e)){throw new a("propertyName is required.")}if(t.indexOf(e)!==-1){throw new a(e+" is already a registered property.")}if(e in this){throw new a(e+" is a reserved property name.")}t.push(e);Object.defineProperty(this,e,v(e,true))};R.prototype.removeProperty=function(e){var t=this._propertyNames;var r=t.indexOf(e);if(!i(e)){throw new a("propertyName is required.")}if(r===-1){throw new a(e+" is not a registered property.")}this._propertyNames.splice(r,1);delete this[e]};R.prototype.merge=function(e){if(!i(e)){throw new a("source is required.")}this.name=r(this.name,e.name);this.availability=r(e.availability,this.availability);var t=this._propertyNames;var n=i(e._propertyNames)?e._propertyNames:Object.keys(e);var o=n.length;for(var s=0;s<o;s++){var u=n[s];if(u==="parent"){continue}var l=this[u];var c=e[u];if(!i(l)&&t.indexOf(u)===-1){this.addProperty(u)}if(i(c)){if(i(l)){if(i(l.merge)){l.merge(c)}}else if(i(c.merge)&&i(c.clone)){this[u]=c.clone()}else{this[u]=c}}}};var L=new s;var B=new e;var F=new l;R.prototype._getModelMatrix=function(e,t){var r=A.getValueOrUndefined(this._position,e,B);if(!i(r)){return undefined}var n=A.getValueOrUndefined(this._orientation,e,F);if(!i(n)){t=c.eastNorthUpToFixedFrame(r,undefined,t)}else{t=u.fromRotationTranslation(s.fromQuaternion(n,L),r,t)}return t};return R});define("DataSources/EntityCollection",["../Core/AssociativeArray","../Core/createGuid","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/Iso8601","../Core/JulianDate","../Core/RuntimeError","../Core/TimeInterval","./Entity"],function(e,t,r,i,n,a,o,s,u,l,c){"use strict";var d={id:undefined};function f(e){if(e._firing){e._refire=true;return}if(e._suspendCount===0){var t=e._addedEntities;var r=e._removedEntities;var i=e._changedEntities;if(i.length!==0||t.length!==0||r.length!==0){e._firing=true;do{e._refire=false;var n=t.values.slice(0);var a=r.values.slice(0);var o=i.values.slice(0);t.removeAll();r.removeAll();i.removeAll();e._collectionChanged.raiseEvent(e,n,a,o)}while(e._refire);e._firing=false}}}function h(r){this._owner=r;this._entities=new e;this._addedEntities=new e;this._removedEntities=new e;this._changedEntities=new e;this._suspendCount=0;this._collectionChanged=new a;this._id=t();this._show=true;this._firing=false;this._refire=false}h.prototype.suspendEvents=function(){this._suspendCount++};h.prototype.resumeEvents=function(){if(this._suspendCount===0){throw new n("resumeEvents can not be called before suspendEvents.")}this._suspendCount--;f(this)};h.collectionChangedEventCallback=undefined;i(h.prototype,{collectionChanged:{get:function(){return this._collectionChanged}},id:{get:function(){return this._id}},values:{get:function(){return this._entities.values}},show:{get:function(){return this._show},set:function(e){if(!r(e)){throw new n("value is required.")}if(e===this._show){return}this.suspendEvents();var t;var i=[];var a=this._entities.values;var o=a.length;for(t=0;t<o;t++){i.push(a[t].isShowing)}this._show=e;for(t=0;t<o;t++){var s=i[t];var u=a[t];if(s!==u.isShowing){u.definitionChanged.raiseEvent(u,"isShowing",u.isShowing,s)}}this.resumeEvents()}},owner:{get:function(){return this._owner}}});h.prototype.computeAvailability=function(){var e=o.MAXIMUM_VALUE;var t=o.MINIMUM_VALUE;var i=this._entities.values;for(var n=0,a=i.length;n<a;n++){var u=i[n];var c=u.availability;if(r(c)){var d=c.start;var f=c.stop;if(s.lessThan(d,e)&&!d.equals(o.MINIMUM_VALUE)){e=d}if(s.greaterThan(f,t)&&!f.equals(o.MAXIMUM_VALUE)){t=f}}}if(o.MAXIMUM_VALUE.equals(e)){e=o.MINIMUM_VALUE}if(o.MINIMUM_VALUE.equals(t)){t=o.MAXIMUM_VALUE}return new l({start:e,stop:t})};h.prototype.add=function(e){if(!r(e)){throw new n("entity is required.")}if(!(e instanceof c)){e=new c(e)}var t=e.id;var i=this._entities;if(i.contains(t)){throw new u("An entity with id "+t+" already exists in this collection.")}e.entityCollection=this;i.set(t,e);if(!this._removedEntities.remove(t)){this._addedEntities.set(t,e)}e.definitionChanged.addEventListener(h.prototype._onEntityDefinitionChanged,this);f(this);return e};h.prototype.remove=function(e){if(!r(e)){return false}return this.removeById(e.id)};h.prototype.contains=function(e){if(!r(e)){throw new n("entity is required")}return this._entities.get(e.id)===e};h.prototype.removeById=function(e){if(!r(e)){return false}var t=this._entities;var i=t.get(e);if(!this._entities.remove(e)){return false}if(!this._addedEntities.remove(e)){this._removedEntities.set(e,i);this._changedEntities.remove(e)}this._entities.remove(e);i.definitionChanged.removeEventListener(h.prototype._onEntityDefinitionChanged,this);f(this);return true};h.prototype.removeAll=function(){var e=this._entities;var t=e.length;var i=e.values;var n=this._addedEntities;var a=this._removedEntities;for(var o=0;o<t;o++){var s=i[o];var u=s.id;var l=n.get(u);if(!r(l)){s.definitionChanged.removeEventListener(h.prototype._onEntityDefinitionChanged,this);a.set(u,s)}}e.removeAll();n.removeAll();this._changedEntities.removeAll();f(this)};h.prototype.getById=function(e){if(!r(e)){throw new n("id is required.")}return this._entities.get(e)};h.prototype.getOrCreateEntity=function(e){if(!r(e)){throw new n("id is required.")}var t=this._entities.get(e);if(!r(t)){d.id=e;t=new c(d);this.add(t)}return t};h.prototype._onEntityDefinitionChanged=function(e){var t=e.id;if(!this._addedEntities.contains(t)){this._changedEntities.set(t,e)}f(this)};return h});define("DataSources/CompositeEntityCollection",["../Core/createGuid","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Math","./Entity","./EntityCollection"],function(e,t,r,i,n,a,o){"use strict";var s={id:undefined};var u=new Array(2);function l(e){var t=e.propertyNames;var r=t.length;for(var i=0;i<r;i++){e[t[i]]=undefined}}function c(e,t,r,i){u[0]=r;u[1]=i.id;t[JSON.stringify(u)]=i.definitionChanged.addEventListener(h.prototype._onDefinitionChanged,e)}function d(e,t,r,i){u[0]=r;u[1]=i.id;var n=JSON.stringify(u);t[n]();t[n]=undefined}function f(e){e._shouldRecomposite=true;if(e._suspendCount!==0){return}var r=e._collections;var i=r.length;var n=e._collectionsCopy;var u=n.length;var f;var p;var m;var v;var _;var g=e._composite;var y=new o(e);var w=e._eventHash;var C;for(f=0;f<u;f++){_=n[f];_.collectionChanged.removeEventListener(h.prototype._onCollectionChanged,e);m=_.values;C=_.id;for(v=m.length-1;v>-1;v--){p=m[v];d(e,w,C,p)}}for(f=i-1;f>=0;f--){_=r[f];_.collectionChanged.addEventListener(h.prototype._onCollectionChanged,e);m=_.values;C=_.id;for(v=m.length-1;v>-1;v--){p=m[v];c(e,w,C,p);var b=y.getById(p.id);if(!t(b)){b=g.getById(p.id);if(!t(b)){s.id=p.id;b=new a(s)}else{l(b)}y.add(b)}b.merge(p)}}e._collectionsCopy=r.slice(0);g.suspendEvents();g.removeAll();var S=y.values;for(f=0;f<S.length;f++){g.add(S[f])}g.resumeEvents()}function h(r,i){this._owner=i;this._composite=new o(this);this._suspendCount=0;this._collections=t(r)?r.slice():[];this._collectionsCopy=[];this._id=e();this._eventHash={};f(this);this._shouldRecomposite=false}r(h.prototype,{collectionChanged:{get:function(){return this._composite._collectionChanged}},id:{get:function(){return this._id}},values:{get:function(){return this._composite.values}},owner:{get:function(){return this._owner}}});h.prototype.addCollection=function(e,r){var n=t(r);if(!t(e)){throw new i("collection is required.")}if(n){if(r<0){throw new i("index must be greater than or equal to zero.")}else if(r>this._collections.length){throw new i("index must be less than or equal to the number of collections.")}}if(!n){r=this._collections.length;this._collections.push(e)}else{this._collections.splice(r,0,e)}f(this)};h.prototype.removeCollection=function(e){var t=this._collections.indexOf(e);if(t!==-1){this._collections.splice(t,1);f(this);return true}return false};h.prototype.removeAllCollections=function(){this._collections.length=0;f(this)};h.prototype.containsCollection=function(e){return this._collections.indexOf(e)!==-1};h.prototype.contains=function(e){return this._composite.contains(e)};h.prototype.indexOfCollection=function(e){return this._collections.indexOf(e)};h.prototype.getCollection=function(e){if(!t(e)){throw new i("index is required.","index")}return this._collections[e]};h.prototype.getCollectionsLength=function(){return this._collections.length};function p(e,r){if(!t(r)){throw new i("collection is required.")}var n=e.indexOf(r);if(n===-1){throw new i("collection is not in this composite.")}return n}function m(e,t,r){var i=e._collections;t=n.clamp(t,0,i.length-1);r=n.clamp(r,0,i.length-1);if(t===r){return}var a=i[t];i[t]=i[r];i[r]=a;f(e)}h.prototype.raiseCollection=function(e){var t=p(this._collections,e);m(this,t,t+1)};h.prototype.lowerCollection=function(e){var t=p(this._collections,e);m(this,t,t-1)};h.prototype.raiseCollectionToTop=function(e){var t=p(this._collections,e);if(t===this._collections.length-1){return}this._collections.splice(t,1);this._collections.push(e);f(this)};h.prototype.lowerCollectionToBottom=function(e){var t=p(this._collections,e);if(t===0){return}this._collections.splice(t,1);this._collections.splice(0,0,e);f(this)};h.prototype.suspendEvents=function(){this._suspendCount++;this._composite.suspendEvents()};h.prototype.resumeEvents=function(){if(this._suspendCount===0){throw new i("resumeEvents can not be called before suspendEvents.")}this._suspendCount--;if(this._shouldRecomposite&&this._suspendCount===0){f(this);this._shouldRecomposite=false}this._composite.resumeEvents()};h.prototype.computeAvailability=function(){return this._composite.computeAvailability()};h.prototype.getById=function(e){return this._composite.getById(e)};h.prototype._onCollectionChanged=function(e,r,i){var n=this._collectionsCopy;var o=n.length;var u=this._composite;u.suspendEvents();var f;var h;var p;var m;var v=i.length;var _=this._eventHash;var g=e.id;for(f=0;f<v;f++){var y=i[f];d(this,_,g,y);var w=y.id;for(h=o-1;h>=0;h--){p=n[h].getById(w);if(t(p)){if(!t(m)){m=u.getById(w);l(m)}m.merge(p)}}if(!t(m)){u.removeById(w)}m=undefined}var C=r.length;for(f=0;f<C;f++){var b=r[f];c(this,_,g,b);var S=b.id;for(h=o-1;h>=0;h--){p=n[h].getById(S);if(t(p)){if(!t(m)){m=u.getById(S);if(!t(m)){s.id=S;m=new a(s);u.add(m)}else{l(m)}}m.merge(p)}}m=undefined}u.resumeEvents()};h.prototype._onDefinitionChanged=function(e,r,i,n){var a=this._collections;var o=this._composite;var s=a.length;var u=e.id;var l=o.getById(u);var c=l[r];var d=!t(c);var f=true;for(var h=s-1;h>=0;h--){var p=a[h].getById(e.id);if(t(p)){var m=p[r];if(t(m)){if(f){f=false;if(t(m.merge)&&t(m.clone)){c=m.clone(c)}else{c=m;break}}c.merge(m)}}}if(d&&l.propertyNames.indexOf(r)===-1){l.addProperty(r)}l[r]=c};return h});define("DataSources/CompositeProperty",["../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/EventHelper","../Core/TimeIntervalCollection","./Property"],function(e,t,r,i,n,a,o){"use strict";function s(t,r,i,n){function a(){i.raiseEvent(t)}var o=[];r.removeAll();var s=n.length;for(var u=0;u<s;u++){var l=n.get(u);if(e(l.data)&&o.indexOf(l.data)===-1){r.add(l.data.definitionChanged,a)}}}function u(){this._eventHelper=new n;this._definitionChanged=new i;this._intervals=new a;this._intervals.changedEvent.addEventListener(u.prototype._intervalsChanged,this)}t(u.prototype,{isConstant:{get:function(){return this._intervals.isEmpty}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._intervals}}});u.prototype.getValue=function(t,i){if(!e(t)){throw new r("time is required")}var n=this._intervals.findDataForIntervalContainingDate(t);if(e(n)){return n.getValue(t,i)}return undefined};u.prototype.equals=function(e){return this===e||e instanceof u&&this._intervals.equals(e._intervals,o.equals)};u.prototype._intervalsChanged=function(){s(this,this._eventHelper,this._definitionChanged,this._intervals);this._definitionChanged.raiseEvent(this)};return u});define("DataSources/CompositeMaterialProperty",["../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./CompositeProperty","./Property"],function(e,t,r,i,n,a){"use strict";function o(){this._definitionChanged=new i;this._composite=new n;this._composite.definitionChanged.addEventListener(o.prototype._raiseDefinitionChanged,this)}t(o.prototype,{isConstant:{get:function(){return this._composite.isConstant}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._composite._intervals}}});o.prototype.getType=function(t){if(!e(t)){throw new r("time is required")}var i=this._composite._intervals.findDataForIntervalContainingDate(t);if(e(i)){return i.getType(t)}return undefined};o.prototype.getValue=function(t,i){if(!e(t)){throw new r("time is required")}var n=this._composite._intervals.findDataForIntervalContainingDate(t);if(e(n)){return n.getValue(t,i)}return undefined};o.prototype.equals=function(e){return this===e||e instanceof o&&this._composite.equals(e._composite,a.equals)};o.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)};return o});define("DataSources/CompositePositionProperty",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/ReferenceFrame","./CompositeProperty","./Property"],function(e,t,r,i,n,a,o,s){"use strict";function u(t){this._referenceFrame=e(t,a.FIXED);this._definitionChanged=new n;this._composite=new o;this._composite.definitionChanged.addEventListener(u.prototype._raiseDefinitionChanged,this)}r(u.prototype,{isConstant:{get:function(){return this._composite.isConstant}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._composite.intervals}},referenceFrame:{get:function(){return this._referenceFrame},set:function(e){this._referenceFrame=e}}});u.prototype.getValue=function(e,t){return this.getValueInReferenceFrame(e,a.FIXED,t)};u.prototype.getValueInReferenceFrame=function(e,r,n){if(!t(e)){throw new i("time is required.")}if(!t(r)){throw new i("referenceFrame is required.")}var a=this._composite._intervals.findDataForIntervalContainingDate(e);if(t(a)){return a.getValueInReferenceFrame(e,r,n)}return undefined};u.prototype.equals=function(e){return this===e||e instanceof u&&this._referenceFrame===e._referenceFrame&&this._composite.equals(e._composite,s.equals)};u.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)};return u});define("Shaders/ShadowVolumeFS",[],function(){"use strict";return"#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n#endif\nvarying float v_WindowZ;\nvarying vec4 v_color;\nvoid writeDepthClampedToFarPlane()\n{\n#ifdef GL_EXT_frag_depth\ngl_FragDepthEXT = min(v_WindowZ * gl_FragCoord.w, 1.0);\n#endif\n}\nvoid main(void)\n{\ngl_FragColor = v_color;\nwriteDepthClampedToFarPlane();\n}\n"});define("Shaders/ShadowVolumeVS",[],function(){"use strict";return"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec3 extrudeDirection;\nattribute vec4 color;\nattribute float batchId;\nuniform float u_globeMinimumAltitude;\nvarying float v_WindowZ;\nvarying vec4 v_color;\nvec4 depthClampFarPlane(vec4 vertexInClipCoordinates)\n{\nv_WindowZ = (0.5 * (vertexInClipCoordinates.z / vertexInClipCoordinates.w) + 0.5) * vertexInClipCoordinates.w;\nvertexInClipCoordinates.z = min(vertexInClipCoordinates.z, vertexInClipCoordinates.w);\nreturn vertexInClipCoordinates;\n}\nvoid main()\n{\nv_color = color;\nvec4 position = czm_computePosition();\nfloat delta = min(u_globeMinimumAltitude, czm_geometricToleranceOverMeter * length(position.xyz));\ndelta *= czm_sceneMode == czm_sceneMode3D ? 1.0 : 0.0;\nposition = position + vec4(extrudeDirection * delta, 0.0);\ngl_Position = depthClampFarPlane(czm_modelViewProjectionRelativeToEye * position);\n}\n"});define("Scene/DepthFunction",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";var r={NEVER:t.NEVER,LESS:t.LESS,EQUAL:t.EQUAL,LESS_OR_EQUAL:t.LEQUAL,GREATER:t.GREATER,NOT_EQUAL:t.NOTEQUAL,GREATER_OR_EQUAL:t.GEQUAL,ALWAYS:t.ALWAYS};return e(r)});define("Scene/StencilFunction",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";var r={NEVER:t.NEVER,LESS:t.LESS,EQUAL:t.EQUAL,LESS_OR_EQUAL:t.LEQUAL,GREATER:t.GREATER,NOT_EQUAL:t.NOTEQUAL,GREATER_OR_EQUAL:t.GEQUAL,ALWAYS:t.ALWAYS};return e(r)});define("Scene/StencilOperation",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";var r={ZERO:t.ZERO,KEEP:t.KEEP,REPLACE:t.REPLACE,INCREMENT:t.INCR,DECREMENT:t.DECR,INVERT:t.INVERT,INCREMENT_WRAP:t.INCR_WRAP,DECREMENT_WRAP:t.DECR_WRAP};return e(r)});define("Scene/GroundPrimitive",["../Core/BoundingSphere","../Core/buildModuleUrl","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartographic","../Core/ColorGeometryInstanceAttribute","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/GeographicTilingScheme","../Core/GeometryInstance","../Core/isArray","../Core/loadJson","../Core/Math","../Core/OrientedBoundingBox","../Core/Rectangle","../Renderer/DrawCommand","../Renderer/Pass","../Renderer/RenderState","../Renderer/ShaderProgram","../Renderer/ShaderSource","../Shaders/ShadowVolumeFS","../Shaders/ShadowVolumeVS","../ThirdParty/when","./BlendingState","./DepthFunction","./PerInstanceColorAppearance","./Primitive","./SceneMode","./StencilFunction","./StencilOperation"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w,C,b,S,E,T,x,A,P,D,M,I,O){"use strict";function R(e){e=o(e,o.EMPTY_OBJECT);this.geometryInstances=e.geometryInstances;this.show=o(e.show,true);this.debugShowBoundingVolume=o(e.debugShowBoundingVolume,false);this.debugShowShadowVolume=o(e.debugShowShadowVolume,false);this._debugShowShadowVolume=false;this._sp=undefined;this._spPick=undefined;this._rsStencilPreloadPass=undefined;this._rsStencilDepthPass=undefined;this._rsColorPass=undefined;this._rsPickPass=undefined;this._uniformMap={u_globeMinimumAltitude:function(){return 55e3}};this._boundingVolumes=[];this._boundingVolumes2D=[];this._ready=false;this._readyPromise=T.defer();this._primitive=undefined;this._maxHeight=undefined;this._minHeight=undefined;this._maxTerrainHeight=R._defaultMaxTerrainHeight;this._minTerrainHeight=R._defaultMinTerrainHeight;this._boundingSpheresKeys=[];this._boundingSpheres=[];var t=new P({flat:true});var r;if(s(this.geometryInstances)&&h(this.geometryInstances)&&this.geometryInstances.length>1){r=N}this._primitiveOptions={geometryInstances:undefined,appearance:t,vertexCacheOptimize:o(e.vertexCacheOptimize,false),interleave:o(e.interleave,false),releaseGeometryInstances:o(e.releaseGeometryInstances,true),allowPicking:o(e.allowPicking,true),asynchronous:o(e.asynchronous,true),compressVertices:o(e.compressVertices,true),_readOnlyInstanceAttributes:r,_createRenderStatesFunction:undefined,_createShaderProgramFunction:undefined,_createCommandsFunction:undefined,_createPickOffsets:true}}var N=["color"];u(R.prototype,{vertexCacheOptimize:{get:function(){return this._primitiveOptions.vertexCacheOptimize}},interleave:{get:function(){return this._primitiveOptions.interleave}},releaseGeometryInstances:{get:function(){return this._primitiveOptions.releaseGeometryInstances}},allowPicking:{get:function(){return this._primitiveOptions.allowPicking}},asynchronous:{get:function(){return this._primitiveOptions.asynchronous}},compressVertices:{get:function(){return this._primitiveOptions.compressVertices}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}}});R.isSupported=function(e){return e.context.stencilBuffer};R._defaultMaxTerrainHeight=9e3;R._defaultMinTerrainHeight=-1e5;R._terrainHeights=undefined;R._terrainHeightsMaxLevel=6;function L(e){return function(t,r){var i=r.maximumRadius;var n=i/Math.cos(t*.5)-i;return e._maxHeight+n}}function B(e){return function(t,r){return e._minHeight}}function F(e){return{colorMask:{red:false,green:false,blue:false,alpha:false},stencilTest:{enabled:e,frontFunction:I.ALWAYS,frontOperation:{fail:O.KEEP,zFail:O.DECREMENT_WRAP,zPass:O.DECREMENT_WRAP},backFunction:I.ALWAYS,backOperation:{fail:O.KEEP,zFail:O.INCREMENT_WRAP,zPass:O.INCREMENT_WRAP},reference:0,mask:~0},depthTest:{enabled:false},depthMask:false}}function k(e){return{colorMask:{red:false,green:false,blue:false,alpha:false},stencilTest:{enabled:e,frontFunction:I.ALWAYS,frontOperation:{fail:O.KEEP,zFail:O.KEEP,zPass:O.INCREMENT_WRAP},backFunction:I.ALWAYS,backOperation:{fail:O.KEEP,zFail:O.KEEP,zPass:O.DECREMENT_WRAP},reference:0,mask:~0},depthTest:{enabled:true,func:A.LESS_OR_EQUAL},depthMask:false}}function V(e){return{stencilTest:{enabled:e,frontFunction:I.NOT_EQUAL,frontOperation:{fail:O.KEEP,zFail:O.KEEP,zPass:O.DECREMENT_WRAP},backFunction:I.NOT_EQUAL,backOperation:{fail:O.KEEP,zFail:O.KEEP,zPass:O.DECREMENT_WRAP},reference:0,mask:~0},depthTest:{enabled:false},depthMask:false,blending:x.ALPHA_BLEND}}var z={stencilTest:{enabled:true,frontFunction:I.NOT_EQUAL,frontOperation:{fail:O.KEEP,zFail:O.KEEP,zPass:O.DECREMENT_WRAP},backFunction:I.NOT_EQUAL,backOperation:{fail:O.KEEP,zFail:O.KEEP,zPass:O.DECREMENT_WRAP},reference:0,mask:~0},depthTest:{enabled:false},depthMask:false};var U=new i;var q=new i;var G=new i;var H=new n;var W=new _;var j=new d;var Y=[new n,new n,new n,new n];var X=new r;function Z(e,t){var r=e.mapProjection.ellipsoid;if(!s(t.attributes)||!s(t.attributes.position3DHigh)){if(s(t.rectangle)){return t.rectangle}return undefined}var n=t.attributes.position3DHigh.values;var a=t.attributes.position3DLow.values;var o=n.length;var u=Number.POSITIVE_INFINITY;var l=Number.POSITIVE_INFINITY;var c=Number.NEGATIVE_INFINITY;var d=Number.NEGATIVE_INFINITY;for(var f=0;f<o;f+=3){var h=i.unpack(n,f,U);var p=i.unpack(a,f,q);var m=i.add(h,p,G);var v=r.cartesianToCartographic(m,H);var _=v.latitude;var g=v.longitude;u=Math.min(u,_);l=Math.min(l,g);c=Math.max(c,_);d=Math.max(d,g)}var y=W;y.north=c;y.south=u;y.east=d;y.west=l;return y}var K=new i;var Q=new i;var J=new n;var $=new i;var ee=new i;function te(e){n.fromRadians(e.east,e.north,0,Y[0]);n.fromRadians(e.west,e.north,0,Y[1]);n.fromRadians(e.east,e.south,0,Y[2]);n.fromRadians(e.west,e.south,0,Y[3]);var t=0,r=0;var i=0,a=0;var o=R._terrainHeightsMaxLevel;for(var s=0;s<=o;++s){var u=false;for(var l=0;l<4;++l){var c=Y[l];j.positionToTileXY(c,s,X);if(l===0){i=X.x;a=X.y}else if(i!==X.x||a!==X.y){u=true;break}}if(u){break}t=i;r=a}if(s===0){return undefined}return{x:t,y:r,level:s>o?o:s-1}}function re(e,t,r){var n=te(t);var a=R._defaultMinTerrainHeight;var o=R._defaultMaxTerrainHeight;if(s(n)){var u=n.level+"-"+n.x+"-"+n.y;var l=R._terrainHeights[u];if(s(l)){a=l[0];o=l[1]}r.cartographicToCartesian(_.northeast(t,J),K);r.cartographicToCartesian(_.southwest(t,J),Q);i.subtract(Q,K,$);i.add(K,i.multiplyByScalar($,.5,$),$);var c=r.scaleToGeodeticSurface($,ee);if(s(c)){var d=i.distance($,c);a=Math.min(a,-d)}else{a=R._defaultMinTerrainHeight}}e._minTerrainHeight=Math.max(R._defaultMinTerrainHeight,a);e._maxTerrainHeight=o}var ie=new e;function ne(t,r){var i=te(t);var n=R._defaultMaxTerrainHeight;if(s(i)){var a=i.level+"-"+i.x+"-"+i.y;var o=R._terrainHeights[a];if(s(o)){n=o[1]}}var u=e.fromRectangle3D(t,r,0);e.fromRectangle3D(t,r,n,ie);return e.union(u,ie,u)}function ae(t,r,n){var a=r.mapProjection.ellipsoid;var o=Z(r,n);if(o.width<m.PI){var s=v.fromRectangle(o,t._maxHeight,t._minHeight,a);t._boundingVolumes.push(s)}else{var u=n.attributes.position3DHigh.values;var l=n.attributes.position3DLow.values;t._boundingVolumes.push(e.fromEncodedCartesianVertices(u,l))}if(!r.scene3DOnly){var c=r.mapProjection;var d=e.fromRectangleWithHeights2D(o,c,t._maxHeight,t._minHeight);i.fromElements(d.center.z,d.center.x,d.center.y,d.center);t._boundingVolumes2D.push(d)}}function oe(e,t,r,i){if(s(e._rsStencilPreloadPass)){return}var n=!e.debugShowShadowVolume;e._rsStencilPreloadPass=w.fromCache(F(n));e._rsStencilDepthPass=w.fromCache(k(n));e._rsColorPass=w.fromCache(V(n));e._rsPickPass=w.fromCache(z)}function se(e,t){if(!e.compressVertices){return t}if(t.search(/attribute\s+vec3\s+extrudeDirection;/g)!==-1){var r="compressedAttributes";var i="attribute vec2 "+r+";";var n="vec3 extrudeDirection;\n";var a="    extrudeDirection = czm_octDecode("+r+", 65535.0);\n";var o=t;o=o.replace(/attribute\s+vec3\s+extrudeDirection;/g,"");o=b.replaceMain(o,"czm_non_compressed_main");var s="void main() \n"+"{ \n"+a+"    czm_non_compressed_main(); \n"+"}";return[i,n,o,s].join("\n")}}function ue(e,t,r){if(s(e._sp)){return}var i=t.context;var n=e._primitive;var a=E;a=e._primitive._batchTable.getVertexShaderCallback()(a);a=D._appendShowToShader(n,a);a=D._appendDistanceDisplayConditionToShader(n,a);a=D._modifyShaderPosition(e,a,t.scene3DOnly);a=D._updateColorAttribute(n,a);a=se(n,a);var o=S;var u=e._primitive._attributeLocations;e._sp=C.replaceCache({context:i,shaderProgram:e._sp,vertexShaderSource:a,fragmentShaderSource:o,attributeLocations:u});if(e._primitive.allowPicking){var l=b.createPickVertexShaderSource(a);l=D._updatePickColorAttribute(l);var c=new b({sources:[o],pickColorQualifier:"varying"});e._spPick=C.replaceCache({context:i,shaderProgram:e._spPick,vertexShaderSource:l,fragmentShaderSource:c,attributeLocations:u})}else{e._spPick=C.fromCache({context:i,vertexShaderSource:a,fragmentShaderSource:o,attributeLocations:u})}}function le(e,t){var r=e._primitive;var i=r._va.length*3;t.length=i;var n=0;var a=r._batchTable.getUniformMapCallback()(e._uniformMap);for(var o=0;o<i;o+=3){var u=r._va[n++];var l=t[o];if(!s(l)){l=t[o]=new g({owner:e,primitiveType:r._primitiveType})}l.vertexArray=u;l.renderState=e._rsStencilPreloadPass;l.shaderProgram=e._sp;l.uniformMap=a;l.pass=y.GROUND;l=t[o+1];if(!s(l)){l=t[o+1]=new g({owner:e,primitiveType:r._primitiveType})}l.vertexArray=u;l.renderState=e._rsStencilDepthPass;l.shaderProgram=e._sp;l.uniformMap=a;l.pass=y.GROUND;l=t[o+2];if(!s(l)){l=t[o+2]=new g({owner:e,primitiveType:r._primitiveType})}l.vertexArray=u;l.renderState=e._rsColorPass;l.shaderProgram=e._sp;l.uniformMap=a;l.pass=y.GROUND}}function ce(e,t){var r=e._primitive;var i=r._pickOffsets;var n=i.length*3;t.length=n;var a=0;var o=r._batchTable.getUniformMapCallback()(e._uniformMap);for(var u=0;u<n;u+=3){var l=i[a++];var c=l.offset;var d=l.count;var f=r._va[l.index];var h=t[u];if(!s(h)){h=t[u]=new g({owner:e,primitiveType:r._primitiveType})}h.vertexArray=f;h.offset=c;h.count=d;h.renderState=e._rsStencilPreloadPass;h.shaderProgram=e._sp;h.uniformMap=o;h.pass=y.GROUND;h=t[u+1];if(!s(h)){h=t[u+1]=new g({owner:e,primitiveType:r._primitiveType})}h.vertexArray=f;h.offset=c;h.count=d;h.renderState=e._rsStencilDepthPass;h.shaderProgram=e._sp;h.uniformMap=o;h.pass=y.GROUND;h=t[u+2];if(!s(h)){h=t[u+2]=new g({owner:e,primitiveType:r._primitiveType})}h.vertexArray=f;h.offset=c;h.count=d;h.renderState=e._rsPickPass;h.shaderProgram=e._spPick;h.uniformMap=o;h.pass=y.GROUND}}
function de(e,t,r,i,n,a,o){le(e,a);ce(e,o)}function fe(e,t,r,i,n,a,o,u){var l;if(t.mode===M.SCENE3D){l=e._boundingVolumes}else if(t.mode!==M.SCENE3D&&s(e._boundingVolumes2D)){l=e._boundingVolumes2D}var c=t.commandList;var d=t.passes;if(d.render){var f=r.length;for(var h=0;h<f;++h){r[h].modelMatrix=n;r[h].boundingVolume=l[Math.floor(h/3)];r[h].cull=a;r[h].debugShowBoundingVolume=o;c.push(r[h])}}if(d.pick){var p=e._primitive;var m=p._pickOffsets;var v=m.length*3;i.length=v;var _=0;for(var g=0;g<v;g+=3){var y=m[_++];var w=l[y.index];i[g].modelMatrix=n;i[g].boundingVolume=w;i[g].cull=a;i[g+1].modelMatrix=n;i[g+1].boundingVolume=w;i[g+1].cull=a;i[g+2].modelMatrix=n;i[g+2].boundingVolume=w;i[g+2].cull=a;c.push(i[g],i[g+1],i[g+2])}}}R._initialized=false;R._initPromise=undefined;R.initializeTerrainHeights=function(){var e=R._initPromise;if(s(e)){return e}R._initPromise=p(t("Assets/approximateTerrainHeights.json")).then(function(e){R._initialized=true;R._terrainHeights=e});return R._initPromise};R.prototype.update=function(e){if(!this.show||!s(this._primitive)&&!s(this.geometryInstances)){return}if(!R._initialized){if(!this.asynchronous){throw new c("For synchronous GroundPrimitives, you must call GroundPrimitive.initializeTerrainHeights() and wait for the returned promise to resolve.")}R.initializeTerrainHeights();return}var t=this;var r=this._primitiveOptions;if(!s(this._primitive)){var i=e.mapProjection.ellipsoid;var n;var o;var u;var l=h(this.geometryInstances)?this.geometryInstances:[this.geometryInstances];var d=l.length;var p=new Array(d);var m;var v;var g;for(m=0;m<d;++m){n=l[m];o=n.geometry;var y=Z(e,o);if(!s(g)){g=y}else{if(s(y)){_.union(g,y,g)}}var C=n.id;if(s(C)&&s(y)){var b=ne(y,i);this._boundingSpheresKeys.push(C);this._boundingSpheres.push(b)}u=o.constructor;if(s(u)&&s(u.createShadowVolume)){var S=n.attributes;if(!s(S)||!s(S.color)){throw new c("Not all of the geometry instances have the same color attribute.")}else if(s(v)&&!a.equals(v,S.color)){throw new c("Not all of the geometry instances have the same color attribute.")}else if(!s(v)){v=S.color}}else{throw new c("Not all of the geometry instances have GroundPrimitive support.")}}re(this,g,e.mapProjection.ellipsoid);var E=e.terrainExaggeration;this._minHeight=this._minTerrainHeight*E;this._maxHeight=this._maxTerrainHeight*E;for(m=0;m<d;++m){n=l[m];o=n.geometry;u=o.constructor;p[m]=new f({geometry:u.createShadowVolume(o,B(this),L(this)),attributes:n.attributes,id:n.id,pickPrimitive:this})}r.geometryInstances=p;r._createBoundingVolumeFunction=function(e,r){ae(t,e,r)};r._createRenderStatesFunction=function(e,r,i,n){oe(t,r)};r._createShaderProgramFunction=function(e,r,i){ue(t,r)};r._createCommandsFunction=function(e,r,i,n,a,o,s){de(t,undefined,undefined,true,false,o,s)};r._updateAndQueueCommandsFunction=function(e,r,i,n,a,o,s,u){fe(t,r,i,n,a,o,s,u)};this._primitive=new D(r);this._primitive.readyPromise.then(function(e){t._ready=true;if(t.releaseGeometryInstances){t.geometryInstances=undefined}var r=e._error;if(!s(r)){t._readyPromise.resolve(t)}else{t._readyPromise.reject(r)}})}if(this.debugShowShadowVolume&&!this._debugShowShadowVolume&&this._ready){this._debugShowShadowVolume=true;this._rsStencilPreloadPass=w.fromCache(F(false));this._rsStencilDepthPass=w.fromCache(k(false));this._rsColorPass=w.fromCache(V(false))}else if(!this.debugShowShadowVolume&&this._debugShowShadowVolume){this._debugShowShadowVolume=false;this._rsStencilPreloadPass=w.fromCache(F(true));this._rsStencilDepthPass=w.fromCache(k(true));this._rsColorPass=w.fromCache(V(true))}this._primitive.debugShowBoundingVolume=this.debugShowBoundingVolume;this._primitive.update(e)};R.prototype.getBoundingSphere=function(e){var t=this._boundingSpheresKeys.indexOf(e);if(t!==-1){return this._boundingSpheres[t]}return undefined};R.prototype.getGeometryInstanceAttributes=function(e){if(!s(this._primitive)){throw new c("must call update before calling getGeometryInstanceAttributes")}return this._primitive.getGeometryInstanceAttributes(e)};R.prototype.isDestroyed=function(){return false};R.prototype.destroy=function(){this._primitive=this._primitive&&this._primitive.destroy();this._sp=this._sp&&this._sp.destroy();this._spPick=this._spPick&&this._spPick.destroy();return l(this)};return R});define("DataSources/CorridorGeometryUpdater",["../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/CorridorGeometry","../Core/CorridorOutlineGeometry","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/Event","../Core/GeometryInstance","../Core/Iso8601","../Core/oneTimeWarning","../Core/ShowGeometryInstanceAttribute","../Scene/GroundPrimitive","../Scene/MaterialAppearance","../Scene/PerInstanceColorAppearance","../Scene/Primitive","../Scene/ShadowMode","./ColorMaterialProperty","./ConstantProperty","./dynamicGeometryGetBoundingSphere","./MaterialProperty","./Property"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w,C,b,S,E,T){"use strict";var x=new C(e.WHITE);var A=new b(true);var P=new b(true);var D=new b(false);var M=new b(e.BLACK);var I=new b(w.DISABLED);var O=new b(new l);var R=new e;function N(e){this.id=e;this.vertexFormat=undefined;this.positions=undefined;this.width=undefined;this.cornerType=undefined;this.height=undefined;this.extrudedHeight=undefined;this.granularity=undefined}function L(e,t){if(!a(e)){throw new u("entity is required")}if(!a(t)){throw new u("scene is required")}this._entity=e;this._scene=t;this._entitySubscription=e.definitionChanged.addEventListener(L.prototype._onEntityPropertyChanged,this);this._fillEnabled=false;this._isClosed=false;this._dynamic=false;this._outlineEnabled=false;this._geometryChanged=new d;this._showProperty=undefined;this._materialProperty=undefined;this._hasConstantOutline=true;this._showOutlineProperty=undefined;this._outlineColorProperty=undefined;this._outlineWidth=1;this._shadowsProperty=undefined;this._distanceDisplayConditionProperty=undefined;this._onTerrain=false;this._options=new N(e);this._onEntityPropertyChanged(e,"corridor",e.corridor,undefined)}o(L,{perInstanceColorAppearanceType:{value:g},materialAppearanceType:{value:_}});o(L.prototype,{entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!a(this._entity.availability)&&T.isConstant(this._showProperty)&&T.isConstant(this._fillProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},outlineEnabled:{get:function(){return this._outlineEnabled}},hasConstantOutline:{get:function(){return!this._outlineEnabled||!a(this._entity.availability)&&T.isConstant(this._showProperty)&&T.isConstant(this._showOutlineProperty)}},outlineColorProperty:{get:function(){return this._outlineColorProperty}},outlineWidth:{get:function(){return this._outlineWidth}},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayCondition}},isDynamic:{get:function(){return this._dynamic}},isClosed:{get:function(){return this._isClosed}},onTerrain:{get:function(){return this._onTerrain}},geometryChanged:{get:function(){return this._geometryChanged}}});L.prototype.isOutlineVisible=function(e){var t=this._entity;return this._outlineEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)};L.prototype.isFilled=function(e){var t=this._entity;return this._fillEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)};L.prototype.createFillGeometryInstance=function(i){if(!a(i)){throw new u("time is required.")}if(!this._fillEnabled){throw new u("This instance does not represent a filled geometry.")}var n=this._entity;var o=n.isAvailable(i);var s;var l;var d=new m(o&&n.isShowing&&this._showProperty.getValue(i)&&this._fillProperty.getValue(i));var h=c.fromDistanceDisplayCondition(this._distanceDisplayCondition.getValue(i));if(this._materialProperty instanceof C){var p=e.WHITE;if(a(this._materialProperty.color)&&(this._materialProperty.color.isConstant||o)){p=this._materialProperty.color.getValue(i)}l=t.fromColor(p);s={show:d,distanceDisplayCondition:h,color:l}}else{s={show:d,distanceDisplayCondition:h}}return new f({id:n,geometry:new r(this._options),attributes:s})};L.prototype.createOutlineGeometryInstance=function(r){if(!a(r)){throw new u("time is required.")}if(!this._outlineEnabled){throw new u("This instance does not represent an outlined geometry.")}var n=this._entity;var o=n.isAvailable(r);var s=T.getValueOrDefault(this._outlineColorProperty,r,e.BLACK);return new f({id:n,geometry:new i(this._options),attributes:{show:new m(o&&n.isShowing&&this._showProperty.getValue(r)&&this._showOutlineProperty.getValue(r)),color:t.fromColor(s),distanceDisplayCondition:c.fromDistanceDisplayCondition(this._distanceDisplayCondition.getValue(r))}})};L.prototype.isDestroyed=function(){return false};L.prototype.destroy=function(){this._entitySubscription();s(this)};L.prototype._onEntityPropertyChanged=function(e,t,r,i){if(!(t==="availability"||t==="corridor")){return}var o=this._entity.corridor;if(!a(o)){if(this._fillEnabled||this._outlineEnabled){this._fillEnabled=false;this._outlineEnabled=false;this._geometryChanged.raiseEvent(this)}return}var s=o.fill;var u=a(s)&&s.isConstant?s.getValue(h.MINIMUM_VALUE):true;var l=o.outline;var c=a(l);if(c&&l.isConstant){c=l.getValue(h.MINIMUM_VALUE)}if(!u&&!c){if(this._fillEnabled||this._outlineEnabled){this._fillEnabled=false;this._outlineEnabled=false;this._geometryChanged.raiseEvent(this)}return}var d=o.positions;var f=o.show;if(a(f)&&f.isConstant&&!f.getValue(h.MINIMUM_VALUE)||!a(d)){if(this._fillEnabled||this._outlineEnabled){this._fillEnabled=false;this._outlineEnabled=false;this._geometryChanged.raiseEvent(this)}return}var m=n(o.material,x);var y=m instanceof C;this._materialProperty=m;this._fillProperty=n(s,P);this._showProperty=n(f,A);this._showOutlineProperty=n(o.outline,D);this._outlineColorProperty=c?n(o.outlineColor,M):undefined;this._shadowsProperty=n(o.shadows,I);this._distanceDisplayCondition=n(o.distanceDisplayCondition,O);var w=o.height;var b=o.extrudedHeight;var S=o.granularity;var E=o.width;var R=o.outlineWidth;var N=o.cornerType;var L=u&&!a(w)&&!a(b)&&y&&v.isSupported(this._scene);if(c&&L){p(p.geometryOutlines);c=false}this._fillEnabled=u;this._onTerrain=L;this._isClosed=a(b)||L;this._outlineEnabled=c;if(!d.isConstant||!T.isConstant(w)||!T.isConstant(b)||!T.isConstant(S)||!T.isConstant(E)||!T.isConstant(R)||!T.isConstant(N)||L&&!T.isConstant(m)){if(!this._dynamic){this._dynamic=true;this._geometryChanged.raiseEvent(this)}}else{var B=this._options;B.vertexFormat=y?g.VERTEX_FORMAT:_.MaterialSupport.TEXTURED.vertexFormat;B.positions=d.getValue(h.MINIMUM_VALUE,B.positions);B.height=a(w)?w.getValue(h.MINIMUM_VALUE):undefined;B.extrudedHeight=a(b)?b.getValue(h.MINIMUM_VALUE):undefined;B.granularity=a(S)?S.getValue(h.MINIMUM_VALUE):undefined;B.width=a(E)?E.getValue(h.MINIMUM_VALUE):undefined;B.cornerType=a(N)?N.getValue(h.MINIMUM_VALUE):undefined;this._outlineWidth=a(R)?R.getValue(h.MINIMUM_VALUE):1;this._dynamic=false;this._geometryChanged.raiseEvent(this)}};L.prototype.createDynamicUpdater=function(e,t){if(!this._dynamic){throw new u("This instance does not represent dynamic geometry.")}if(!a(e)){throw new u("primitives is required.")}return new B(e,t,this)};function B(e,t,r){this._primitives=e;this._groundPrimitives=t;this._primitive=undefined;this._outlinePrimitive=undefined;this._geometryUpdater=r;this._options=new N(r._entity)}B.prototype.update=function(n){if(!a(n)){throw new u("time is required.")}var o=this._geometryUpdater;var s=o._onTerrain;var l=this._primitives;var d=this._groundPrimitives;if(s){d.removeAndDestroy(this._primitive)}else{l.removeAndDestroy(this._primitive);l.removeAndDestroy(this._outlinePrimitive);this._outlinePrimitive=undefined}this._primitive=undefined;var h=o._entity;var p=h.corridor;if(!h.isShowing||!h.isAvailable(n)||!T.getValueOrDefault(p.show,n,true)){return}var m=this._options;var w=T.getValueOrUndefined(p.positions,n,m.positions);var C=T.getValueOrUndefined(p.width,n);if(!a(w)||!a(C)){return}m.positions=w;m.width=C;m.height=T.getValueOrUndefined(p.height,n);m.extrudedHeight=T.getValueOrUndefined(p.extrudedHeight,n);m.granularity=T.getValueOrUndefined(p.granularity,n);m.cornerType=T.getValueOrUndefined(p.cornerType,n);var b=this._geometryUpdater.shadowsProperty.getValue(n);var S=this._geometryUpdater.distanceDisplayConditionProperty.getValue(n);var x=c.fromDistanceDisplayCondition(S);if(!a(p.fill)||p.fill.getValue(n)){var A=o.fillMaterialProperty;var P=E.getValue(n,A,this._material);this._material=P;if(s){var D=e.WHITE;if(a(A.color)){D=A.color.getValue(n)}this._primitive=d.add(new v({geometryInstances:new f({id:h,geometry:new r(m),attributes:{color:t.fromColor(D),distanceDisplayCondition:x}}),asynchronous:false,shadows:b}))}else{var M=new _({material:P,translucent:P.isTranslucent(),closed:a(m.extrudedHeight)});m.vertexFormat=M.vertexFormat;this._primitive=l.add(new y({geometryInstances:new f({id:h,geometry:new r(m),attributes:{distanceDisplayCondition:x}}),appearance:M,asynchronous:false,shadows:b}))}}if(!s&&a(p.outline)&&p.outline.getValue(n)){m.vertexFormat=g.VERTEX_FORMAT;var I=T.getValueOrClonedDefault(p.outlineColor,n,e.BLACK,R);var O=T.getValueOrDefault(p.outlineWidth,n,1);var N=I.alpha!==1;this._outlinePrimitive=l.add(new y({geometryInstances:new f({id:h,geometry:new i(m),attributes:{color:t.fromColor(I),distanceDisplayCondition:x}}),appearance:new g({flat:true,translucent:N,renderState:{lineWidth:o._scene.clampLineWidth(O)}}),asynchronous:false,shadows:b}))}};B.prototype.getBoundingSphere=function(e,t){return S(e,this._primitive,this._outlinePrimitive,t)};B.prototype.isDestroyed=function(){return false};B.prototype.destroy=function(){var e=this._primitives;var t=this._groundPrimitives;if(this._geometryUpdater._onTerrain){t.removeAndDestroy(this._primitive)}else{e.removeAndDestroy(this._primitive)}e.removeAndDestroy(this._outlinePrimitive);s(this)};return L});define("DataSources/DataSource",["../Core/defineProperties","../Core/DeveloperError"],function(e,t){"use strict";function r(){t.throwInstantiationError()}e(r.prototype,{name:{get:t.throwInstantiationError},clock:{get:t.throwInstantiationError},entities:{get:t.throwInstantiationError},isLoading:{get:t.throwInstantiationError},changedEvent:{get:t.throwInstantiationError},errorEvent:{get:t.throwInstantiationError},loadingEvent:{get:t.throwInstantiationError},show:{get:t.throwInstantiationError},clustering:{get:t.throwInstantiationError}});r.prototype.update=t.throwInstantiationError;r.setLoading=function(e,t){if(e._isLoading!==t){if(t){e._entityCollection.suspendEvents()}else{e._entityCollection.resumeEvents()}e._isLoading=t;e._loading.raiseEvent(e,t)}};return r});define("Scene/CullingVolume",["../Core/Cartesian3","../Core/Cartesian4","../Core/defaultValue","../Core/defined","../Core/DeveloperError","../Core/Intersect","../Core/Plane"],function(e,t,r,i,n,a,o){"use strict";function s(e){this.planes=r(e,[])}var u=[new e,new e,new e];e.clone(e.UNIT_X,u[0]);e.clone(e.UNIT_Y,u[1]);e.clone(e.UNIT_Z,u[2]);var l=new e;var c=new e;var d=new o(new e,0);s.fromBoundingSphere=function(r,a){if(!i(r)){throw new n("boundingSphere is required.")}if(!i(a)){a=new s}var o=u.length;var d=a.planes;d.length=2*o;var f=r.center;var h=r.radius;var p=0;for(var m=0;m<o;++m){var v=u[m];var _=d[p];var g=d[p+1];if(!i(_)){_=d[p]=new t}if(!i(g)){g=d[p+1]=new t}e.multiplyByScalar(v,-h,l);e.add(f,l,l);_.x=v.x;_.y=v.y;_.z=v.z;_.w=-e.dot(v,l);e.multiplyByScalar(v,h,l);e.add(f,l,l);g.x=-v.x;g.y=-v.y;g.z=-v.z;g.w=-e.dot(e.negate(v,c),l);p+=2}return a};s.prototype.computeVisibility=function(e){if(!i(e)){throw new n("boundingVolume is required.")}var t=this.planes;var r=false;for(var s=0,u=t.length;s<u;++s){var l=e.intersectPlane(o.fromCartesian4(t[s],d));if(l===a.OUTSIDE){return a.OUTSIDE}else if(l===a.INTERSECTING){r=true}}return r?a.INTERSECTING:a.INSIDE};s.prototype.computeVisibilityWithPlaneMask=function(e,t){if(!i(e)){throw new n("boundingVolume is required.")}if(!i(t)){throw new n("parentPlaneMask is required.")}if(t===s.MASK_OUTSIDE||t===s.MASK_INSIDE){return t}var r=s.MASK_INSIDE;var u=this.planes;for(var l=0,c=u.length;l<c;++l){var f=l<31?1<<l:0;if(l<31&&(t&f)===0){continue}var h=e.intersectPlane(o.fromCartesian4(u[l],d));if(h===a.OUTSIDE){return s.MASK_OUTSIDE}else if(h===a.INTERSECTING){r|=f}}return r};s.MASK_OUTSIDE=4294967295;s.MASK_INSIDE=0;s.MASK_INDETERMINATE=2147483647;return s});define("Scene/OrthographicOffCenterFrustum",["../Core/Cartesian3","../Core/Cartesian4","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Matrix4","./CullingVolume"],function(e,t,r,i,n,a,o){"use strict";function s(){this.left=undefined;this._left=undefined;this.right=undefined;this._right=undefined;this.top=undefined;this._top=undefined;this.bottom=undefined;this._bottom=undefined;this.near=1;this._near=this.near;this.far=5e8;this._far=this.far;this._cullingVolume=new o;this._orthographicMatrix=new a}function u(e){if(!r(e.right)||!r(e.left)||!r(e.top)||!r(e.bottom)||!r(e.near)||!r(e.far)){throw new n("right, left, top, bottom, near, or far parameters are not set.")}if(e.top!==e._top||e.bottom!==e._bottom||e.left!==e._left||e.right!==e._right||e.near!==e._near||e.far!==e._far){if(e.left>e.right){throw new n("right must be greater than left.")}if(e.bottom>e.top){throw new n("top must be greater than bottom.")}if(e.near<=0||e.near>e.far){throw new n("near must be greater than zero and less than far.")}e._left=e.left;e._right=e.right;e._top=e.top;e._bottom=e.bottom;e._near=e.near;e._far=e.far;e._orthographicMatrix=a.computeOrthographicOffCenter(e.left,e.right,e.bottom,e.top,e.near,e.far,e._orthographicMatrix)}}i(s.prototype,{projectionMatrix:{get:function(){u(this);return this._orthographicMatrix}}});var l=new e;var c=new e;var d=new e;var f=new e;s.prototype.computeCullingVolume=function(i,a,o){if(!r(i)){throw new n("position is required.")}if(!r(a)){throw new n("direction is required.")}if(!r(o)){throw new n("up is required.")}var s=this._cullingVolume.planes;var u=this.top;var h=this.bottom;var p=this.right;var m=this.left;var v=this.near;var _=this.far;var g=e.cross(a,o,l);var y=c;e.multiplyByScalar(a,v,y);e.add(i,y,y);var w=d;e.multiplyByScalar(g,m,w);e.add(y,w,w);var C=s[0];if(!r(C)){C=s[0]=new t}C.x=g.x;C.y=g.y;C.z=g.z;C.w=-e.dot(g,w);e.multiplyByScalar(g,p,w);e.add(y,w,w);C=s[1];if(!r(C)){C=s[1]=new t}C.x=-g.x;C.y=-g.y;C.z=-g.z;C.w=-e.dot(e.negate(g,f),w);e.multiplyByScalar(o,h,w);e.add(y,w,w);C=s[2];if(!r(C)){C=s[2]=new t}C.x=o.x;C.y=o.y;C.z=o.z;C.w=-e.dot(o,w);e.multiplyByScalar(o,u,w);e.add(y,w,w);C=s[3];if(!r(C)){C=s[3]=new t}C.x=-o.x;C.y=-o.y;C.z=-o.z;C.w=-e.dot(e.negate(o,f),w);C=s[4];if(!r(C)){C=s[4]=new t}C.x=a.x;C.y=a.y;C.z=a.z;C.w=-e.dot(a,y);e.multiplyByScalar(a,_,w);e.add(i,w,w);C=s[5];if(!r(C)){C=s[5]=new t}C.x=-a.x;C.y=-a.y;C.z=-a.z;C.w=-e.dot(e.negate(a,f),w);return this._cullingVolume};s.prototype.getPixelDimensions=function(e,t,i,a){u(this);if(!r(e)||!r(t)){throw new n("Both drawingBufferWidth and drawingBufferHeight are required.")}if(e<=0){throw new n("drawingBufferWidth must be greater than zero.")}if(t<=0){throw new n("drawingBufferHeight must be greater than zero.")}if(!r(i)){throw new n("distance is required.")}if(!r(a)){throw new n("A result object is required.")}var o=this.right-this.left;var s=this.top-this.bottom;var l=o/e;var c=s/t;a.x=l;a.y=c;return a};s.prototype.clone=function(e){if(!r(e)){e=new s}e.left=this.left;e.right=this.right;e.top=this.top;e.bottom=this.bottom;e.near=this.near;e.far=this.far;e._left=undefined;e._right=undefined;e._top=undefined;e._bottom=undefined;e._near=undefined;e._far=undefined;return e};s.prototype.equals=function(e){return r(e)&&this.right===e.right&&this.left===e.left&&this.top===e.top&&this.bottom===e.bottom&&this.near===e.near&&this.far===e.far};return s});define("Scene/OrthographicFrustum",["../Core/defined","../Core/defineProperties","../Core/deprecationWarning","../Core/DeveloperError","./OrthographicOffCenterFrustum"],function(e,t,r,i,n){"use strict";function a(){this._offCenterFrustum=new n;this.width=undefined;this._width=undefined;this.aspectRatio=undefined;this._aspectRatio=undefined;this.near=1;this._near=this.near;this.far=5e8;this._far=this.far;this._useDeprecated=false}function o(t){if(!e(t.width)||!e(t.aspectRatio)||!e(t.near)||!e(t.far)){throw new i("width, aspectRatio, near, or far parameters are not set.")}var r=t._offCenterFrustum;if(t.width!==t._width||t.aspectRatio!==t._aspectRatio||t.near!==t._near||t.far!==t._far){if(t.aspectRatio<0){throw new i("aspectRatio must be positive.")}if(t.near<0||t.near>t.far){throw new i("near must be greater than zero and less than far.")}t._aspectRatio=t.aspectRatio;t._width=t.width;t._near=t.near;t._far=t.far;if(!t._useDeprecated){var n=t.aspectRatio;if(n>1){n=1/t.aspectRatio}r.right=t.width*.5;r.left=-r.right;r.top=n*r.right;r.bottom=-r.top;r.near=t.near;r.far=t.far}}}t(a.prototype,{projectionMatrix:{get:function(){o(this);return this._offCenterFrustum.projectionMatrix}},left:{get:function(){r("OrthographicFrustum","OrthographicFrustum left, right, bottom and top properties were deprecated in 1.32 and will be removed in 1.33.");return this._offCenterFrustum.left},set:function(e){r("OrthographicFrustum","OrthographicFrustum left, right, bottom and top properties were deprecated in 1.32 and will be removed in 1.33.");this._useDeprecated=true;this._offCenterFrustum.left=e}},right:{get:function(){r("OrthographicFrustum","OrthographicFrustum left, right, bottom and top properties were deprecated in 1.32 and will be removed in 1.33.");return this._offCenterFrustum.right},set:function(e){r("OrthographicFrustum","OrthographicFrustum left, right, bottom and top properties were deprecated in 1.32 and will be removed in 1.33.");this._useDeprecated=true;this._offCenterFrustum.right=e}},top:{get:function(){r("OrthographicFrustum","OrthographicFrustum left, right, bottom and top properties were deprecated in 1.32 and will be removed in 1.33.");return this._offCenterFrustum.top},set:function(e){r("OrthographicFrustum","OrthographicFrustum left, right, bottom and top properties were deprecated in 1.32 and will be removed in 1.33.");this._useDeprecated=true;this._offCenterFrustum.top=e}},bottom:{get:function(){r("OrthographicFrustum","OrthographicFrustum left, right, bottom and top properties were deprecated in 1.32 and will be removed in 1.33.");return this._offCenterFrustum.bottom},set:function(e){r("OrthographicFrustum","OrthographicFrustum left, right, bottom and top properties were deprecated in 1.32 and will be removed in 1.33.");this._useDeprecated=true;this._offCenterFrustum.bottom=e}}});a.prototype.computeCullingVolume=function(e,t,r){o(this);return this._offCenterFrustum.computeCullingVolume(e,t,r)};a.prototype.getPixelDimensions=function(e,t,r,i){o(this);return this._offCenterFrustum.getPixelDimensions(e,t,r,i)};a.prototype.clone=function(t){if(!e(t)){t=new a}t.aspectRatio=this.aspectRatio;t.width=this.width;t.near=this.near;t.far=this.far;t._aspectRatio=undefined;t._width=undefined;t._near=undefined;t._far=undefined;this._offCenterFrustum.clone(t._offCenterFrustum);return t};a.prototype.equals=function(t){if(!e(t)){return false}o(this);o(t);return this.width===t.width&&this.aspectRatio===t.aspectRatio&&this.near===t.near&&this.far===t.far&&this._offCenterFrustum.equals(t._offCenterFrustum)};return a});define("Scene/SceneTransforms",["../Core/BoundingRectangle","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Cartographic","../Core/defined","../Core/DeveloperError","../Core/Math","../Core/Matrix4","../Core/Transforms","./OrthographicFrustum","./OrthographicOffCenterFrustum","./SceneMode"],function(e,t,r,i,n,a,o,s,u,l,c,d,f){"use strict";var h={};var p=new i(0,0,0,1);var m=new i;var v=new e;var _=new t;var g=new t;h.wgs84ToWindowCoordinates=function(e,t,i){return h.wgs84WithEyeOffsetToWindowCoordinates(e,t,r.ZERO,i)};var y=new i;var w=new r;function C(e,t,n,a){var o=n.viewMatrix;var s=u.multiplyByVector(o,i.fromElements(e.x,e.y,e.z,1,y),y);var l=r.multiplyComponents(t,r.normalize(s,w),w);s.x+=t.x+l.x;s.y+=t.y+l.y;s.z+=l.z;return u.multiplyByVector(n.frustum.projectionMatrix,s,a)}var b=new n(Math.PI,s.PI_OVER_TWO);var S=new r;var E=new r;h.wgs84WithEyeOffsetToWindowCoordinates=function(e,i,n,y){if(!a(e)){throw new o("scene is required.")}if(!a(i)){throw new o("position is required.")}var w=e.frameState;var T=h.computeActualWgs84Position(w,i,p);if(!a(T)){return undefined}var x=e.canvas;var A=v;A.x=0;A.y=0;A.width=x.clientWidth;A.height=x.clientHeight;var P=e.camera;var D=false;if(w.mode===f.SCENE2D){var M=e.mapProjection;var I=b;var O=M.project(I,S);var R=r.clone(P.position,E);var N=P.frustum.clone();var L=u.computeViewportTransformation(A,0,1,new u);var B=P.frustum.projectionMatrix;var F=P.positionWC.y;var k=r.fromElements(s.sign(F)*O.x-F,0,-P.positionWC.x);var V=l.pointToGLWindowCoordinates(B,L,k);if(F===0||V.x<=0||V.x>=x.clientWidth){D=true}else{if(V.x>x.clientWidth*.5){A.width=V.x;P.frustum.right=O.x-F;m=C(T,n,P,m);h.clipToGLWindowCoordinates(A,m,_);A.x+=V.x;P.position.x=-P.position.x;var z=P.frustum.right;P.frustum.right=-P.frustum.left;P.frustum.left=-z;m=C(T,n,P,m);h.clipToGLWindowCoordinates(A,m,g)}else{A.x+=V.x;A.width-=V.x;P.frustum.left=-O.x-F;m=C(T,n,P,m);h.clipToGLWindowCoordinates(A,m,_);A.x=A.x-A.width;P.position.x=-P.position.x;var U=P.frustum.left;P.frustum.left=-P.frustum.right;P.frustum.right=-U;m=C(T,n,P,m);h.clipToGLWindowCoordinates(A,m,g)}r.clone(R,P.position);P.frustum=N.clone();y=t.clone(_,y);if(y.x<0||y.x>x.clientWidth){y.x=g.x}}}if(w.mode!==f.SCENE2D||D){m=C(T,n,P,m);if(m.z<0&&!(P.frustum instanceof c)&&!(P.frustum instanceof d)){return undefined}y=h.clipToGLWindowCoordinates(A,m,y)}y.y=x.clientHeight-y.y;return y};h.wgs84ToDrawingBufferCoordinates=function(e,t,r){r=h.wgs84ToWindowCoordinates(e,t,r);if(!a(r)){return undefined}return h.transformWindowToDrawingBuffer(e,r,r)};var T=new r;var x=new n;h.computeActualWgs84Position=function(e,t,i){var n=e.mode;if(n===f.SCENE3D){return r.clone(t,i)}var o=e.mapProjection;var u=o.ellipsoid.cartesianToCartographic(t,x);if(!a(u)){return undefined}o.project(u,T);if(n===f.COLUMBUS_VIEW){return r.fromElements(T.z,T.x,T.y,i)}if(n===f.SCENE2D){return r.fromElements(0,T.x,T.y,i)}var l=e.morphTime;return r.fromElements(s.lerp(T.z,t.x,l),s.lerp(T.x,t.y,l),s.lerp(T.y,t.z,l),i)};var A=new r;var P=new r;var D=new u;h.clipToGLWindowCoordinates=function(e,i,n){r.divideByScalar(i,i.w,A);u.computeViewportTransformation(e,0,1,D);u.multiplyByPoint(D,A,P);return t.fromCartesian3(P,n)};h.transformWindowToDrawingBuffer=function(e,r,i){var n=e.canvas;var a=e.drawingBufferWidth/n.clientWidth;var o=e.drawingBufferHeight/n.clientHeight;return t.fromElements(r.x*a,r.y*o,i)};var M=new i;var I=new i;h.drawingBufferToWgs84Coordinates=function(e,t,n,o){var s=e.context;var l=s.uniformState;var c=e._passState.viewport;var d=i.clone(i.UNIT_W,M);d.x=(t.x-c.x)/c.width*2-1;d.y=(t.y-c.y)/c.height*2-1;d.z=n*2-1;d.w=1;var f;var h=e.camera.frustum;if(!a(h.fovy)){if(a(h._offCenterFrustum)){h=h._offCenterFrustum}var p=l.currentFrustum;f=I;f.x=(d.x*(h.right-h.left)+h.left+h.right)*.5;f.y=(d.y*(h.top-h.bottom)+h.bottom+h.top)*.5;f.z=(d.z*(p.x-p.y)-p.x-p.y)*.5;f.w=1;f=u.multiplyByVector(l.inverseView,f,f)}else{f=u.multiplyByVector(l.inverseViewProjection,d,I);var m=1/f.w;r.multiplyByScalar(f,m,f)}return r.fromCartesian4(f,o)};return h});define("Scene/Billboard",["../Core/BoundingRectangle","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Cartographic","../Core/Color","../Core/createGuid","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/Matrix4","../Core/NearFarScalar","./HeightReference","./HorizontalOrigin","./SceneMode","./SceneTransforms","./VerticalOrigin"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g){"use strict";function y(e,i){e=s(e,s.EMPTY_OBJECT);if(u(e.scaleByDistance)&&e.scaleByDistance.far<=e.scaleByDistance.near){throw new c("scaleByDistance.far must be greater than scaleByDistance.near.")}if(u(e.translucencyByDistance)&&e.translucencyByDistance.far<=e.translucencyByDistance.near){throw new c("translucencyByDistance.far must be greater than translucencyByDistance.near.")}if(u(e.pixelOffsetScaleByDistance)&&e.pixelOffsetScaleByDistance.far<=e.pixelOffsetScaleByDistance.near){throw new c("pixelOffsetScaleByDistance.far must be greater than pixelOffsetScaleByDistance.near.")}if(u(e.distanceDisplayCondition)&&e.distanceDisplayCondition.far<=e.distanceDisplayCondition.near){throw new c("distanceDisplayCondition.far must be greater than distanceDisplayCondition.near")}this._show=s(e.show,true);this._position=r.clone(s(e.position,r.ZERO));this._actualPosition=r.clone(this._position);this._pixelOffset=t.clone(s(e.pixelOffset,t.ZERO));this._translate=new t(0,0);this._eyeOffset=r.clone(s(e.eyeOffset,r.ZERO));this._heightReference=s(e.heightReference,p.NONE);this._verticalOrigin=s(e.verticalOrigin,g.CENTER);this._horizontalOrigin=s(e.horizontalOrigin,m.CENTER);this._scale=s(e.scale,1);this._color=a.clone(s(e.color,a.WHITE));this._rotation=s(e.rotation,0);this._alignedAxis=r.clone(s(e.alignedAxis,r.ZERO));this._width=e.width;this._height=e.height;this._scaleByDistance=e.scaleByDistance;this._translucencyByDistance=e.translucencyByDistance;this._pixelOffsetScaleByDistance=e.pixelOffsetScaleByDistance;this._sizeInMeters=s(e.sizeInMeters,false);this._distanceDisplayCondition=e.distanceDisplayCondition;this._id=e.id;this._collection=s(e.collection,i);this._pickId=undefined;this._pickPrimitive=s(e._pickPrimitive,this);this._billboardCollection=i;this._dirty=false;this._index=-1;this._imageIndex=-1;this._imageIndexPromise=undefined;this._imageId=undefined;this._image=undefined;this._imageSubRegion=undefined;this._imageWidth=undefined;this._imageHeight=undefined;var n=e.image;var l=e.imageId;if(u(n)){if(!u(l)){if(typeof n==="string"){l=n}else if(u(n.src)){l=n.src}else{l=o()}}this._imageId=l;this._image=n}if(u(e.imageSubRegion)){this._imageId=l;this._imageSubRegion=e.imageSubRegion}if(u(this._billboardCollection._textureAtlas)){this._loadImage()}this._actualClampedPosition=undefined;this._removeCallbackFunc=undefined;this._mode=v.SCENE3D;this._clusterShow=true;this._updateClamping()}var w=y.SHOW_INDEX=0;var C=y.POSITION_INDEX=1;var b=y.PIXEL_OFFSET_INDEX=2;var S=y.EYE_OFFSET_INDEX=3;var E=y.HORIZONTAL_ORIGIN_INDEX=4;var T=y.VERTICAL_ORIGIN_INDEX=5;var x=y.SCALE_INDEX=6;var A=y.IMAGE_INDEX_INDEX=7;var P=y.COLOR_INDEX=8;var D=y.ROTATION_INDEX=9;var M=y.ALIGNED_AXIS_INDEX=10;var I=y.SCALE_BY_DISTANCE_INDEX=11;var O=y.TRANSLUCENCY_BY_DISTANCE_INDEX=12;var R=y.PIXEL_OFFSET_SCALE_BY_DISTANCE_INDEX=13;var N=y.DISTANCE_DISPLAY_CONDITION=14;y.NUMBER_OF_PROPERTIES=15;function L(e,t){var r=e._billboardCollection;if(u(r)){r._updateBillboard(e,t);e._dirty=true}}l(y.prototype,{show:{get:function(){return this._show},set:function(e){if(!u(e)){throw new c("value is required.")}if(this._show!==e){this._show=e;L(this,w)}}},position:{get:function(){return this._position},set:function(e){if(!u(e)){throw new c("value is required.")}var t=this._position;if(!r.equals(t,e)){r.clone(e,t);r.clone(e,this._actualPosition);this._updateClamping();L(this,C)}}},heightReference:{get:function(){return this._heightReference},set:function(e){if(!u(e)){throw new c("value is required.")}var t=this._heightReference;if(e!==t){this._heightReference=e;this._updateClamping();L(this,C)}}},pixelOffset:{get:function(){return this._pixelOffset},set:function(e){if(!u(e)){throw new c("value is required.")}var r=this._pixelOffset
;if(!t.equals(r,e)){t.clone(e,r);L(this,b)}}},scaleByDistance:{get:function(){return this._scaleByDistance},set:function(e){if(u(e)&&e.far<=e.near){throw new c("far distance must be greater than near distance.")}var t=this._scaleByDistance;if(!h.equals(t,e)){this._scaleByDistance=h.clone(e,t);L(this,I)}}},translucencyByDistance:{get:function(){return this._translucencyByDistance},set:function(e){if(u(e)&&e.far<=e.near){throw new c("far distance must be greater than near distance.")}var t=this._translucencyByDistance;if(!h.equals(t,e)){this._translucencyByDistance=h.clone(e,t);L(this,O)}}},pixelOffsetScaleByDistance:{get:function(){return this._pixelOffsetScaleByDistance},set:function(e){if(u(e)&&e.far<=e.near){throw new c("far distance must be greater than near distance.")}var t=this._pixelOffsetScaleByDistance;if(!h.equals(t,e)){this._pixelOffsetScaleByDistance=h.clone(e,t);L(this,R)}}},eyeOffset:{get:function(){return this._eyeOffset},set:function(e){if(!u(e)){throw new c("value is required.")}var t=this._eyeOffset;if(!r.equals(t,e)){r.clone(e,t);L(this,S)}}},horizontalOrigin:{get:function(){return this._horizontalOrigin},set:function(e){if(!u(e)){throw new c("value is required.")}if(this._horizontalOrigin!==e){this._horizontalOrigin=e;L(this,E)}}},verticalOrigin:{get:function(){return this._verticalOrigin},set:function(e){if(!u(e)){throw new c("value is required.")}if(this._verticalOrigin!==e){this._verticalOrigin=e;L(this,T)}}},scale:{get:function(){return this._scale},set:function(e){if(!u(e)){throw new c("value is required.")}if(this._scale!==e){this._scale=e;L(this,x)}}},color:{get:function(){return this._color},set:function(e){if(!u(e)){throw new c("value is required.")}var t=this._color;if(!a.equals(t,e)){a.clone(e,t);L(this,P)}}},rotation:{get:function(){return this._rotation},set:function(e){if(!u(e)){throw new c("value is required.")}if(this._rotation!==e){this._rotation=e;L(this,D)}}},alignedAxis:{get:function(){return this._alignedAxis},set:function(e){if(!u(e)){throw new c("value is required.")}var t=this._alignedAxis;if(!r.equals(t,e)){r.clone(e,t);L(this,M)}}},width:{get:function(){return s(this._width,this._imageWidth)},set:function(e){if(this._width!==e){this._width=e;L(this,A)}}},height:{get:function(){return s(this._height,this._imageHeight)},set:function(e){if(this._height!==e){this._height=e;L(this,A)}}},sizeInMeters:{get:function(){return this._sizeInMeters},set:function(e){if(this._sizeInMeters!==e){this._sizeInMeters=e;L(this,P)}}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){if(!d.equals(e,this._distanceDisplayCondition)){if(u(e)&&e.far<=e.near){throw new c("far distance must be greater than near distance.")}this._distanceDisplayCondition=d.clone(e,this._distanceDisplayCondition);L(this,N)}}},id:{get:function(){return this._id},set:function(e){this._id=e;if(u(this._pickId)){this._pickId.object.id=e}}},pickPrimitive:{get:function(){return this._pickPrimitive},set:function(e){this._pickPrimitive=e;if(u(this._pickId)){this._pickId.object.primitive=e}}},image:{get:function(){return this._imageId},set:function(e){if(!u(e)){this._imageIndex=-1;this._imageSubRegion=undefined;this._imageId=undefined;this._image=undefined;this._imageIndexPromise=undefined;L(this,A)}else if(typeof e==="string"){this.setImage(e,e)}else if(u(e.src)){this.setImage(e.src,e)}else{this.setImage(o(),e)}}},ready:{get:function(){return this._imageIndex!==-1}},_clampedPosition:{get:function(){return this._actualClampedPosition},set:function(e){this._actualClampedPosition=r.clone(e,this._actualClampedPosition);L(this,C)}},clusterShow:{get:function(){return this._clusterShow},set:function(e){if(this._clusterShow!==e){this._clusterShow=e;L(this,w)}}}});y.prototype.getPickId=function(e){if(!u(this._pickId)){this._pickId=e.createPickId({primitive:this._pickPrimitive,collection:this._collection,id:this._id})}return this._pickId};y.prototype._updateClamping=function(){y._updateClamping(this._billboardCollection,this)};var B=new n;var F=new r;y._updateClamping=function(e,t){var i=e._scene;if(!u(i)){if(t._heightReference!==p.NONE){throw new c("Height reference is not supported without a scene.")}return}var a=i.globe;var o=a.ellipsoid;var s=a._surface;var l=i.frameState.mode;var d=l!==t._mode;t._mode=l;if((t._heightReference===p.NONE||d)&&u(t._removeCallbackFunc)){t._removeCallbackFunc();t._removeCallbackFunc=undefined;t._clampedPosition=undefined}if(t._heightReference===p.NONE||!u(t._position)){return}var f=o.cartesianToCartographic(t._position);if(!u(f)){return}if(u(t._removeCallbackFunc)){t._removeCallbackFunc()}function h(e){if(t._heightReference===p.RELATIVE_TO_GROUND){if(t._mode===v.SCENE3D){var i=o.cartesianToCartographic(e,B);i.height+=f.height;o.cartographicToCartesian(i,e)}else{e.x+=f.height}}t._clampedPosition=r.clone(e,t._clampedPosition)}t._removeCallbackFunc=s.updateHeight(f,h);n.clone(f,B);var m=a.getHeight(f);if(u(m)){B.height=m}o.cartographicToCartesian(B,F);h(F)};y.prototype._loadImage=function(){var t=this._billboardCollection._textureAtlas;var r=this._imageId;var i=this._image;var n=this._imageSubRegion;var a;if(u(i)){a=t.addImage(r,i)}if(u(n)){a=t.addSubRegion(r,n)}this._imageIndexPromise=a;if(!u(a)){return}var o=this;a.then(function(a){if(o._imageId!==r||o._image!==i||!e.equals(o._imageSubRegion,n)){return}var s=t.textureCoordinates[a];o._imageWidth=t.texture.width*s.width;o._imageHeight=t.texture.height*s.height;o._imageIndex=a;o._ready=true;o._image=undefined;o._imageIndexPromise=undefined;L(o,A)}).otherwise(function(e){console.error("Error loading image for billboard: "+e);o._imageIndexPromise=undefined})};y.prototype.setImage=function(e,t){if(!u(e)){throw new c("id is required.")}if(!u(t)){throw new c("image is required.")}if(this._imageId===e){return}this._imageIndex=-1;this._imageSubRegion=undefined;this._imageId=e;this._image=t;if(u(this._billboardCollection._textureAtlas)){this._loadImage()}};y.prototype.setImageSubRegion=function(t,r){if(!u(t)){throw new c("id is required.")}if(!u(r)){throw new c("subRegion is required.")}if(this._imageId===t&&e.equals(this._imageSubRegion,r)){return}this._imageIndex=-1;this._imageId=t;this._imageSubRegion=e.clone(r);if(u(this._billboardCollection._textureAtlas)){this._loadImage()}};y.prototype._setTranslate=function(e){if(!u(e)){throw new c("value is required.")}var r=this._translate;if(!t.equals(r,e)){t.clone(e,r);L(this,b)}};y.prototype._getActualPosition=function(){return u(this._clampedPosition)?this._clampedPosition:this._actualPosition};y.prototype._setActualPosition=function(e){if(!u(this._clampedPosition)){r.clone(e,this._actualPosition)}L(this,C)};var k=new i;y._computeActualPosition=function(e,t,r,i){if(u(e._clampedPosition)){if(r.mode!==e._mode){e._updateClamping()}return e._clampedPosition}else if(r.mode===v.SCENE3D){return t}f.multiplyByPoint(i,t,k);return _.computeActualWgs84Position(r,k)};var V=new r;y._computeScreenSpacePosition=function(e,r,i,n,a,o){var s=f.multiplyByPoint(e,r,V);var l=_.wgs84WithEyeOffsetToWindowCoordinates(a,s,i,o);if(!u(l)){return undefined}t.add(l,n,l);return l};var z=new t(0,0);y.prototype.computeScreenSpacePosition=function(e,r){var i=this._billboardCollection;if(!u(r)){r=new t}if(!u(i)){throw new c("Billboard must be in a collection.  Was it removed?")}if(!u(e)){throw new c("scene is required.")}t.clone(this._pixelOffset,z);t.add(z,this._translate,z);var n=i.modelMatrix;var a=this._getActualPosition();var o=y._computeScreenSpacePosition(n,a,this._eyeOffset,z,e,r);return o};y.getScreenSpaceBoundingBox=function(t,r,i){var n=t.width;var a=t.height;var o=t.scale;n*=o;a*=o;var s=r.x;if(t.horizontalOrigin===m.RIGHT){s-=n}else if(t.horizontalOrigin===m.CENTER){s-=n*.5}var l=r.y;if(t.verticalOrigin===g.BOTTOM||t.verticalOrigin===g.BASELINE){l-=a}else if(t.verticalOrigin===g.CENTER){l-=a*.5}if(!u(i)){i=new e}i.x=s;i.y=l;i.width=n;i.height=a;return i};y.prototype.equals=function(i){return this===i||u(i)&&this._id===i._id&&r.equals(this._position,i._position)&&this._imageId===i._imageId&&this._show===i._show&&this._scale===i._scale&&this._verticalOrigin===i._verticalOrigin&&this._horizontalOrigin===i._horizontalOrigin&&this._heightReference===i._heightReference&&e.equals(this._imageSubRegion,i._imageSubRegion)&&a.equals(this._color,i._color)&&t.equals(this._pixelOffset,i._pixelOffset)&&t.equals(this._translate,i._translate)&&r.equals(this._eyeOffset,i._eyeOffset)&&h.equals(this._scaleByDistance,i._scaleByDistance)&&h.equals(this._translucencyByDistance,i._translucencyByDistance)&&h.equals(this._pixelOffsetScaleByDistance,i._pixelOffsetScaleByDistance)&&d.equals(this._distanceDisplayCondition,i._distanceDisplayCondition)};y.prototype._destroy=function(){if(u(this._customData)){this._billboardCollection._scene.globe._surface.removeTileCustomData(this._customData);this._customData=undefined}if(u(this._removeCallbackFunc)){this._removeCallbackFunc();this._removeCallbackFunc=undefined}this.image=undefined;this._pickId=this._pickId&&this._pickId.destroy();this._billboardCollection=undefined};return y});define("Renderer/VertexArrayFacade",["../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Core/Math","./Buffer","./BufferUsage","./VertexArray"],function(e,t,r,i,n,a,o,s,u){"use strict";function l(i,a,o,s){if(!i){throw new n("context is required.")}if(!a||a.length===0){throw new n("At least one attribute is required.")}var u=l._verifyAttributes(a);o=t(o,0);var c=[];var d={};var f;var h;var p=u.length;for(var m=0;m<p;++m){var v=u[m];if(v.vertexBuffer){c.push(v);continue}h=v.usage;f=d[h];if(!r(f)){f=d[h]=[]}f.push(v)}function _(t,r){return e.getSizeInBytes(r.componentDatatype)-e.getSizeInBytes(t.componentDatatype)}this._allBuffers=[];for(h in d){if(d.hasOwnProperty(h)){f=d[h];f.sort(_);var g=l._vertexSizeInBytes(f);var y=f[0].usage;var w={vertexSizeInBytes:g,vertexBuffer:undefined,usage:y,needsCommit:false,arrayBuffer:undefined,arrayViews:l._createArrayViews(f,g)};this._allBuffers.push(w)}}this._size=0;this._instanced=t(s,false);this._precreated=c;this._context=i;this.writers=undefined;this.va=undefined;this.resize(o)}l._verifyAttributes=function(r){var i=[];for(var a=0;a<r.length;++a){var o=r[a];var u={index:t(o.index,a),enabled:t(o.enabled,true),componentsPerAttribute:o.componentsPerAttribute,componentDatatype:t(o.componentDatatype,e.FLOAT),normalize:t(o.normalize,false),vertexBuffer:o.vertexBuffer,usage:t(o.usage,s.STATIC_DRAW)};i.push(u);if(u.componentsPerAttribute!==1&&u.componentsPerAttribute!==2&&u.componentsPerAttribute!==3&&u.componentsPerAttribute!==4){throw new n("attribute.componentsPerAttribute must be in the range [1, 4].")}var l=u.componentDatatype;if(!e.validate(l)){throw new n("Attribute must have a valid componentDatatype or not specify it.")}if(!s.validate(u.usage)){throw new n("Attribute must have a valid usage or not specify it.")}}var c=new Array(i.length);for(var d=0;d<i.length;++d){var f=i[d];var h=f.index;if(c[h]){throw new n("Index "+h+" is used by more than one attribute.")}c[h]=true}return i};l._vertexSizeInBytes=function(t){var r=0;var i=t.length;for(var n=0;n<i;++n){var a=t[n];r+=a.componentsPerAttribute*e.getSizeInBytes(a.componentDatatype)}var o=i>0?e.getSizeInBytes(t[0].componentDatatype):0;var s=o>0?r%o:0;var u=s===0?0:o-s;r+=u;return r};l._createArrayViews=function(t,r){var i=[];var n=0;var a=t.length;for(var o=0;o<a;++o){var s=t[o];var u=s.componentDatatype;i.push({index:s.index,enabled:s.enabled,componentsPerAttribute:s.componentsPerAttribute,componentDatatype:u,normalize:s.normalize,offsetInBytes:n,vertexSizeInComponentType:r/e.getSizeInBytes(u),view:undefined});n+=s.componentsPerAttribute*e.getSizeInBytes(u)}return i};l.prototype.resize=function(e){this._size=e;var t=this._allBuffers;this.writers=[];for(var r=0,i=t.length;r<i;++r){var n=t[r];l._resize(n,this._size);l._appendWriters(this.writers,n)}h(this)};l._resize=function(t,i){if(t.vertexSizeInBytes>0){var n=new ArrayBuffer(i*t.vertexSizeInBytes);if(r(t.arrayBuffer)){var a=new Uint8Array(n);var o=new Uint8Array(t.arrayBuffer);var s=o.length;for(var u=0;u<s;++u){a[u]=o[u]}}var l=t.arrayViews;var c=l.length;for(var d=0;d<c;++d){var f=l[d];f.view=e.createArrayBufferView(f.componentDatatype,n,f.offsetInBytes)}t.arrayBuffer=n}};var c=[function(e,t,r){return function(i,n){t[i*r]=n;e.needsCommit=true}},function(e,t,r){return function(i,n,a){var o=i*r;t[o]=n;t[o+1]=a;e.needsCommit=true}},function(e,t,r){return function(i,n,a,o){var s=i*r;t[s]=n;t[s+1]=a;t[s+2]=o;e.needsCommit=true}},function(e,t,r){return function(i,n,a,o,s){var u=i*r;t[u]=n;t[u+1]=a;t[u+2]=o;t[u+3]=s;e.needsCommit=true}}];l._appendWriters=function(e,t){var r=t.arrayViews;var i=r.length;for(var n=0;n<i;++n){var a=r[n];e[a.index]=c[a.componentsPerAttribute-1](t,a.view,a.vertexSizeInComponentType)}};l.prototype.commit=function(e){var t=false;var i=this._allBuffers;var n;var o;var s;for(o=0,s=i.length;o<s;++o){n=i[o];t=d(this,n)||t}if(t||!r(this.va)){h(this);var c=this.va=[];var f=r(e)?Math.ceil(this._size/(a.SIXTY_FOUR_KILOBYTES-1)):1;for(var p=0;p<f;++p){var m=[];for(o=0,s=i.length;o<s;++o){n=i[o];var v=p*(n.vertexSizeInBytes*(a.SIXTY_FOUR_KILOBYTES-1));l._appendAttributes(m,n,v,this._instanced)}m=m.concat(this._precreated);c.push({va:new u({context:this._context,attributes:m,indexBuffer:e}),indicesCount:1.5*(p!==f-1?a.SIXTY_FOUR_KILOBYTES-1:this._size%(a.SIXTY_FOUR_KILOBYTES-1))})}}};function d(e,t){if(t.needsCommit&&t.vertexSizeInBytes>0){t.needsCommit=false;var i=t.vertexBuffer;var n=e._size*t.vertexSizeInBytes;var a=r(i);if(!a||i.sizeInBytes<n){if(a){i.destroy()}t.vertexBuffer=o.createVertexBuffer({context:e._context,typedArray:t.arrayBuffer,usage:t.usage});t.vertexBuffer.vertexArrayDestroyable=false;return true}t.vertexBuffer.copyFromArrayView(t.arrayBuffer)}return false}l._appendAttributes=function(e,t,r,i){var n=t.arrayViews;var a=n.length;for(var o=0;o<a;++o){var s=n[o];e.push({index:s.index,enabled:s.enabled,componentsPerAttribute:s.componentsPerAttribute,componentDatatype:s.componentDatatype,normalize:s.normalize,vertexBuffer:t.vertexBuffer,offsetInBytes:r+s.offsetInBytes,strideInBytes:t.vertexSizeInBytes,instanceDivisor:i?1:0})}};l.prototype.subCommit=function(e,t){if(e<0||e>=this._size){throw new n("offsetInVertices must be greater than or equal to zero and less than the vertex array size.")}if(e+t>this._size){throw new n("offsetInVertices + lengthInVertices cannot exceed the vertex array size.")}var r=this._allBuffers;for(var i=0,a=r.length;i<a;++i){f(r[i],e,t)}};function f(e,t,r){if(e.needsCommit&&e.vertexSizeInBytes>0){var i=e.vertexSizeInBytes*t;var n=e.vertexSizeInBytes*r;e.vertexBuffer.copyFromArrayView(new Uint8Array(e.arrayBuffer,i,n),i)}}l.prototype.endSubCommits=function(){var e=this._allBuffers;for(var t=0,r=e.length;t<r;++t){e[t].needsCommit=false}};function h(e){var t=e.va;if(!r(t)){return}var i=t.length;for(var n=0;n<i;++n){t[n].va.destroy()}e.va=undefined}l.prototype.isDestroyed=function(){return false};l.prototype.destroy=function(){var e=this._allBuffers;for(var t=0,r=e.length;t<r;++t){var n=e[t];n.vertexBuffer=n.vertexBuffer&&n.vertexBuffer.destroy()}h(this);return i(this)};return l});define("Shaders/BillboardCollectionFS",[],function(){"use strict";return"uniform sampler2D u_atlas;\nvarying vec2 v_textureCoordinates;\n#ifdef RENDER_FOR_PICK\nvarying vec4 v_pickColor;\n#else\nvarying vec4 v_color;\n#endif\nvoid main()\n{\n#ifdef RENDER_FOR_PICK\nvec4 vertexColor = vec4(1.0, 1.0, 1.0, 1.0);\n#else\nvec4 vertexColor = v_color;\n#endif\nvec4 color = texture2D(u_atlas, v_textureCoordinates) * vertexColor;\n#if defined(RENDER_FOR_PICK) || (!defined(OPAQUE) && !defined(TRANSLUCENT))\nif (color.a < 0.005)\n{\ndiscard;\n}\n#else\n#ifdef OPAQUE\nif (color.a < 0.995)\n{\ndiscard;\n}\n#else\nif (color.a >= 0.995)\n{\ndiscard;\n}\n#endif\n#endif\n#ifdef RENDER_FOR_PICK\ngl_FragColor = v_pickColor;\n#else\ngl_FragColor = color;\n#endif\n}\n"});define("Shaders/BillboardCollectionVS",[],function(){"use strict";return"#ifdef INSTANCED\nattribute vec2 direction;\n#endif\nattribute vec4 positionHighAndScale;\nattribute vec4 positionLowAndRotation;\nattribute vec4 compressedAttribute0;\nattribute vec4 compressedAttribute1;\nattribute vec4 compressedAttribute2;\nattribute vec4 eyeOffset;\nattribute vec4 scaleByDistance;\nattribute vec4 pixelOffsetScaleByDistance;\nattribute vec2 distanceDisplayCondition;\nvarying vec2 v_textureCoordinates;\n#ifdef RENDER_FOR_PICK\nvarying vec4 v_pickColor;\n#else\nvarying vec4 v_color;\n#endif\nconst float UPPER_BOUND = 32768.0;\nconst float SHIFT_LEFT16 = 65536.0;\nconst float SHIFT_LEFT8 = 256.0;\nconst float SHIFT_LEFT7 = 128.0;\nconst float SHIFT_LEFT5 = 32.0;\nconst float SHIFT_LEFT3 = 8.0;\nconst float SHIFT_LEFT2 = 4.0;\nconst float SHIFT_LEFT1 = 2.0;\nconst float SHIFT_RIGHT8 = 1.0 / 256.0;\nconst float SHIFT_RIGHT7 = 1.0 / 128.0;\nconst float SHIFT_RIGHT5 = 1.0 / 32.0;\nconst float SHIFT_RIGHT3 = 1.0 / 8.0;\nconst float SHIFT_RIGHT2 = 1.0 / 4.0;\nconst float SHIFT_RIGHT1 = 1.0 / 2.0;\nvec4 computePositionWindowCoordinates(vec4 positionEC, vec2 imageSize, float scale, vec2 direction, vec2 origin, vec2 translate, vec2 pixelOffset, vec3 alignedAxis, bool validAlignedAxis, float rotation, bool sizeInMeters)\n{\nvec2 halfSize = imageSize * scale * czm_resolutionScale * 0.5;\nhalfSize *= ((direction * 2.0) - 1.0);\nvec2 originTranslate = origin * abs(halfSize);\n#if defined(ROTATION) || defined(ALIGNED_AXIS)\nif (validAlignedAxis || rotation != 0.0)\n{\nfloat angle = rotation;\nif (validAlignedAxis)\n{\nvec3 pos = positionEC.xyz + czm_encodedCameraPositionMCHigh + czm_encodedCameraPositionMCLow;\nvec3 normal = normalize(cross(alignedAxis, pos));\nvec4 tangent = vec4(normalize(cross(pos, normal)), 0.0);\ntangent = czm_modelViewProjection * tangent;\nangle += sign(-tangent.x) * acos(tangent.y / length(tangent.xy));\n}\nfloat cosTheta = cos(angle);\nfloat sinTheta = sin(angle);\nmat2 rotationMatrix = mat2(cosTheta, sinTheta, -sinTheta, cosTheta);\nhalfSize = rotationMatrix * halfSize;\n}\n#endif\nif (sizeInMeters)\n{\npositionEC.xy += halfSize;\n}\nvec4 positionWC = czm_eyeToWindowCoordinates(positionEC);\nif (sizeInMeters)\n{\noriginTranslate += originTranslate / czm_metersPerPixel(positionEC);\n}\npositionWC.xy += originTranslate;\nif (!sizeInMeters)\n{\npositionWC.xy += halfSize;\n}\npositionWC.xy += translate;\npositionWC.xy += (pixelOffset * czm_resolutionScale);\nreturn positionWC;\n}\nvoid main()\n{\nvec3 positionHigh = positionHighAndScale.xyz;\nvec3 positionLow = positionLowAndRotation.xyz;\nfloat scale = positionHighAndScale.w;\n#if defined(ROTATION) || defined(ALIGNED_AXIS)\nfloat rotation = positionLowAndRotation.w;\n#else\nfloat rotation = 0.0;\n#endif\nfloat compressed = compressedAttribute0.x;\nvec2 pixelOffset;\npixelOffset.x = floor(compressed * SHIFT_RIGHT7);\ncompressed -= pixelOffset.x * SHIFT_LEFT7;\npixelOffset.x -= UPPER_BOUND;\nvec2 origin;\norigin.x = floor(compressed * SHIFT_RIGHT5);\ncompressed -= origin.x * SHIFT_LEFT5;\norigin.y = floor(compressed * SHIFT_RIGHT3);\ncompressed -= origin.y * SHIFT_LEFT3;\norigin -= vec2(1.0);\nfloat show = floor(compressed * SHIFT_RIGHT2);\ncompressed -= show * SHIFT_LEFT2;\n#ifdef INSTANCED\nvec2 textureCoordinatesBottomLeft = czm_decompressTextureCoordinates(compressedAttribute0.w);\nvec2 textureCoordinatesRange = czm_decompressTextureCoordinates(eyeOffset.w);\nvec2 textureCoordinates = textureCoordinatesBottomLeft + direction * textureCoordinatesRange;\n#else\nvec2 direction;\ndirection.x = floor(compressed * SHIFT_RIGHT1);\ndirection.y = compressed - direction.x * SHIFT_LEFT1;\nvec2 textureCoordinates = czm_decompressTextureCoordinates(compressedAttribute0.w);\n#endif\nfloat temp = compressedAttribute0.y  * SHIFT_RIGHT8;\npixelOffset.y = -(floor(temp) - UPPER_BOUND);\nvec2 translate;\ntranslate.y = (temp - floor(temp)) * SHIFT_LEFT16;\ntemp = compressedAttribute0.z * SHIFT_RIGHT8;\ntranslate.x = floor(temp) - UPPER_BOUND;\ntranslate.y += (temp - floor(temp)) * SHIFT_LEFT8;\ntranslate.y -= UPPER_BOUND;\ntemp = compressedAttribute1.x * SHIFT_RIGHT8;\nvec2 imageSize = vec2(floor(temp), compressedAttribute2.w);\n#ifdef EYE_DISTANCE_TRANSLUCENCY\nvec4 translucencyByDistance;\ntranslucencyByDistance.x = compressedAttribute1.z;\ntranslucencyByDistance.z = compressedAttribute1.w;\ntranslucencyByDistance.y = ((temp - floor(temp)) * SHIFT_LEFT8) / 255.0;\ntemp = compressedAttribute1.y * SHIFT_RIGHT8;\ntranslucencyByDistance.w = ((temp - floor(temp)) * SHIFT_LEFT8) / 255.0;\n#endif\n#ifdef ALIGNED_AXIS\nvec3 alignedAxis = czm_octDecode(floor(compressedAttribute1.y * SHIFT_RIGHT8));\ntemp = compressedAttribute2.z * SHIFT_RIGHT5;\nbool validAlignedAxis = (temp - floor(temp)) * SHIFT_LEFT1 > 0.0;\n#else\nvec3 alignedAxis = vec3(0.0);\nbool validAlignedAxis = false;\n#endif\n#ifdef RENDER_FOR_PICK\ntemp = compressedAttribute2.y;\n#else\ntemp = compressedAttribute2.x;\n#endif\nvec4 color;\ntemp = temp * SHIFT_RIGHT8;\ncolor.b = (temp - floor(temp)) * SHIFT_LEFT8;\ntemp = floor(temp) * SHIFT_RIGHT8;\ncolor.g = (temp - floor(temp)) * SHIFT_LEFT8;\ncolor.r = floor(temp);\ntemp = compressedAttribute2.z * SHIFT_RIGHT8;\nbool sizeInMeters = floor((temp - floor(temp)) * SHIFT_LEFT7) > 0.0;\ntemp = floor(temp) * SHIFT_RIGHT8;\n#ifdef RENDER_FOR_PICK\ncolor.a = (temp - floor(temp)) * SHIFT_LEFT8;\nvec4 pickColor = color / 255.0;\n#else\ncolor.a = floor(temp);\ncolor /= 255.0;\n#endif\nvec4 p = czm_translateRelativeToEye(positionHigh, positionLow);\nvec4 positionEC = czm_modelViewRelativeToEye * p;\npositionEC = czm_eyeOffset(positionEC, eyeOffset.xyz);\npositionEC.xyz *= show;\n#if defined(EYE_DISTANCE_SCALING) || defined(EYE_DISTANCE_TRANSLUCENCY) || defined(EYE_DISTANCE_PIXEL_OFFSET) || defined(DISTANCE_DISPLAY_CONDITION)\nfloat lengthSq;\nif (czm_sceneMode == czm_sceneMode2D)\n{\nlengthSq = czm_eyeHeight2D.y;\n}\nelse\n{\nlengthSq = dot(positionEC.xyz, positionEC.xyz);\n}\n#endif\n#ifdef EYE_DISTANCE_SCALING\nfloat distanceScale = czm_nearFarScalar(scaleByDistance, lengthSq);\nscale *= distanceScale;\ntranslate *= distanceScale;\nif (scale == 0.0)\n{\npositionEC.xyz = vec3(0.0);\n}\n#endif\nfloat translucency = 1.0;\n#ifdef EYE_DISTANCE_TRANSLUCENCY\ntranslucency = czm_nearFarScalar(translucencyByDistance, lengthSq);\nif (translucency == 0.0)\n{\npositionEC.xyz = vec3(0.0);\n}\n#endif\n#ifdef EYE_DISTANCE_PIXEL_OFFSET\nfloat pixelOffsetScale = czm_nearFarScalar(pixelOffsetScaleByDistance, lengthSq);\npixelOffset *= pixelOffsetScale;\n#endif\n#ifdef DISTANCE_DISPLAY_CONDITION\nfloat nearSq = distanceDisplayCondition.x * distanceDisplayCondition.x;\nfloat farSq = distanceDisplayCondition.y * distanceDisplayCondition.y;\nif (lengthSq < nearSq || lengthSq > farSq)\n{\npositionEC.xyz = vec3(0.0);\n}\n#endif\nvec4 positionWC = computePositionWindowCoordinates(positionEC, imageSize, scale, direction, origin, translate, pixelOffset, alignedAxis, validAlignedAxis, rotation, sizeInMeters);\ngl_Position = czm_viewportOrthographic * vec4(positionWC.xy, -positionWC.z, 1.0);\nv_textureCoordinates = textureCoordinates;\n#ifdef RENDER_FOR_PICK\nv_pickColor = pickColor;\n#else\nv_color = color;\nv_color.a *= translucency;\n#endif\n}\n"});define("Scene/BlendOption",["../Core/freezeObject"],function(e){"use strict";var t={OPAQUE:0,TRANSLUCENT:1,OPAQUE_AND_TRANSLUCENT:2};return e(t)});define("Renderer/Framebuffer",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/PixelFormat","./ContextLimits"],function(e,t,r,i,n,a,o){"use strict";function s(e,t,r){var i=e._gl;i.framebufferTexture2D(i.FRAMEBUFFER,t,r._target,r._texture,0)}function u(e,t,r){var i=e._gl;i.framebufferRenderbuffer(i.FRAMEBUFFER,t,i.RENDERBUFFER,r._getRenderbuffer())}function l(r){r=e(r,e.EMPTY_OBJECT);if(!t(r.context)){throw new n("options.context is required.")}var i=r.context._gl;var l=o.maximumColorAttachments;this._gl=i;this._framebuffer=i.createFramebuffer();this._colorTextures=[];this._colorRenderbuffers=[];this._activeColorAttachments=[];this._depthTexture=undefined;this._depthRenderbuffer=undefined;this._stencilRenderbuffer=undefined;this._depthStencilTexture=undefined;this._depthStencilRenderbuffer=undefined;this.destroyAttachments=e(r.destroyAttachments,true);if(t(r.colorTextures)&&t(r.colorRenderbuffers)){throw new n("Cannot have both color texture and color renderbuffer attachments.")}if(t(r.depthTexture)&&t(r.depthRenderbuffer)){throw new n("Cannot have both a depth texture and depth renderbuffer attachment.")}if(t(r.depthStencilTexture)&&t(r.depthStencilRenderbuffer)){throw new n("Cannot have both a depth-stencil texture and depth-stencil renderbuffer attachment.")}var c=t(r.depthTexture)||t(r.depthRenderbuffer);var d=t(r.depthStencilTexture)||t(r.depthStencilRenderbuffer);if(c&&d){throw new n("Cannot have both a depth and depth-stencil attachment.")}if(t(r.stencilRenderbuffer)&&d){throw new n("Cannot have both a stencil and depth-stencil attachment.")}if(c&&t(r.stencilRenderbuffer)){throw new n("Cannot have both a depth and stencil attachment.")}this._bind();var f;var h;var p;var m;var v;if(t(r.colorTextures)){var _=r.colorTextures;m=this._colorTextures.length=this._activeColorAttachments.length=_.length;if(m>l){throw new n("The number of color attachments exceeds the number supported.")}for(p=0;p<m;++p){f=_[p];if(!a.isColorFormat(f.pixelFormat)){throw new n("The color-texture pixel-format must be a color format.")}v=this._gl.COLOR_ATTACHMENT0+p;s(this,v,f);this._activeColorAttachments[p]=v;this._colorTextures[p]=f}}if(t(r.colorRenderbuffers)){var g=r.colorRenderbuffers;m=this._colorRenderbuffers.length=this._activeColorAttachments.length=g.length;if(m>l){throw new n("The number of color attachments exceeds the number supported.")}for(p=0;p<m;++p){h=g[p];v=this._gl.COLOR_ATTACHMENT0+p;u(this,v,h);this._activeColorAttachments[p]=v;this._colorRenderbuffers[p]=h}}if(t(r.depthTexture)){f=r.depthTexture;if(f.pixelFormat!==a.DEPTH_COMPONENT){throw new n("The depth-texture pixel-format must be DEPTH_COMPONENT.")}s(this,this._gl.DEPTH_ATTACHMENT,f);this._depthTexture=f}if(t(r.depthRenderbuffer)){h=r.depthRenderbuffer;u(this,this._gl.DEPTH_ATTACHMENT,h);this._depthRenderbuffer=h}if(t(r.stencilRenderbuffer)){h=r.stencilRenderbuffer;u(this,this._gl.STENCIL_ATTACHMENT,h);this._stencilRenderbuffer=h}if(t(r.depthStencilTexture)){f=r.depthStencilTexture;if(f.pixelFormat!==a.DEPTH_STENCIL){throw new n("The depth-stencil pixel-format must be DEPTH_STENCIL.")}s(this,this._gl.DEPTH_STENCIL_ATTACHMENT,f);this._depthStencilTexture=f}if(t(r.depthStencilRenderbuffer)){h=r.depthStencilRenderbuffer;u(this,this._gl.DEPTH_STENCIL_ATTACHMENT,h);this._depthStencilRenderbuffer=h}this._unBind()}r(l.prototype,{status:{get:function(){this._bind();var e=this._gl.checkFramebufferStatus(this._gl.FRAMEBUFFER);this._unBind();return e}},numberOfColorAttachments:{get:function(){return this._activeColorAttachments.length}},depthTexture:{get:function(){return this._depthTexture}},depthRenderbuffer:{get:function(){return this._depthRenderbuffer}},stencilRenderbuffer:{get:function(){return this._stencilRenderbuffer}},depthStencilTexture:{get:function(){return this._depthStencilTexture}},depthStencilRenderbuffer:{get:function(){return this._depthStencilRenderbuffer}},hasDepthAttachment:{get:function(){return!!(this.depthTexture||this.depthRenderbuffer||this.depthStencilTexture||this.depthStencilRenderbuffer)}}});l.prototype._bind=function(){var e=this._gl;e.bindFramebuffer(e.FRAMEBUFFER,this._framebuffer)};l.prototype._unBind=function(){var e=this._gl;e.bindFramebuffer(e.FRAMEBUFFER,null)};l.prototype._getActiveColorAttachments=function(){return this._activeColorAttachments};l.prototype.getColorTexture=function(e){if(!t(e)||e<0||e>=this._colorTextures.length){throw new n("index is required, must be greater than or equal to zero and must be less than the number of color attachments.")}return this._colorTextures[e]};l.prototype.getColorRenderbuffer=function(e){if(!t(e)||e<0||e>=this._colorRenderbuffers.length){throw new n("index is required, must be greater than or equal to zero and must be less than the number of color attachments.")}return this._colorRenderbuffers[e]};l.prototype.isDestroyed=function(){return false};l.prototype.destroy=function(){if(this.destroyAttachments){var e=0;var r=this._colorTextures;var n=r.length;for(;e<n;++e){var a=r[e];if(t(a)){a.destroy()}}var o=this._colorRenderbuffers;n=o.length;for(e=0;e<n;++e){var s=o[e];if(t(s)){s.destroy()}}this._depthTexture=this._depthTexture&&this._depthTexture.destroy();this._depthRenderbuffer=this._depthRenderbuffer&&this._depthRenderbuffer.destroy();this._stencilRenderbuffer=this._stencilRenderbuffer&&this._stencilRenderbuffer.destroy();this._depthStencilTexture=this._depthStencilTexture&&this._depthStencilTexture.destroy();this._depthStencilRenderbuffer=this._depthStencilRenderbuffer&&this._depthStencilRenderbuffer.destroy()}this._gl.deleteFramebuffer(this._framebuffer);return i(this)};return l});define("Scene/TextureAtlas",["../Core/BoundingRectangle","../Core/Cartesian2","../Core/createGuid","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/loadImage","../Core/PixelFormat","../Core/RuntimeError","../Renderer/Framebuffer","../Renderer/Texture","../ThirdParty/when"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h){"use strict";function p(e,r,n,a,o){this.bottomLeft=i(e,t.ZERO);this.topRight=i(r,t.ZERO);this.childNode1=n;this.childNode2=a;this.imageIndex=o}var m=new t(16,16);function v(e){e=i(e,i.EMPTY_OBJECT);var t=i(e.borderWidthInPixels,1);var a=i(e.initialSize,m);if(!n(e.context)){throw new s("context is required.")}if(t<0){throw new s("borderWidthInPixels must be greater than or equal to zero.")}if(a.x<1||a.y<1){throw new s("initialSize must be greater than zero.")}this._context=e.context;this._pixelFormat=i(e.pixelFormat,l.RGBA);this._borderWidthInPixels=t;this._textureCoordinates=[];this._guid=r();this._idHash={};this._initialSize=a;this._root=undefined}a(v.prototype,{borderWidthInPixels:{get:function(){return this._borderWidthInPixels}},textureCoordinates:{get:function(){return this._textureCoordinates}},texture:{get:function(){if(!n(this._texture)){this._texture=new f({context:this._context,width:this._initialSize.x,height:this._initialSize.y,pixelFormat:this._pixelFormat})}return this._texture}},numberOfImages:{get:function(){return this._textureCoordinates.length}},guid:{get:function(){return this._guid}}});function _(e,r){var i=e._context;var a=e.numberOfImages;var o=2;var s=e._borderWidthInPixels;if(a>0){var u=e._texture.width;var l=e._texture.height;var c=o*(u+r.width+s);var h=o*(l+r.height+s);var m=u/c;var v=l/h;var _=new p(new t(u+s,s),new t(c,l));var g=new p(new t,new t(c,l),e._root,_);var y=new p(new t(s,l+s),new t(c,h));var w=new p(new t,new t(c,h),g,y);for(var C=0;C<e._textureCoordinates.length;C++){var b=e._textureCoordinates[C];if(n(b)){b.x*=m;b.y*=v;b.width*=m;b.height*=v}}var S=new f({context:e._context,width:c,height:h,pixelFormat:e._pixelFormat});var E=new d({context:i,colorTextures:[e._texture],destroyAttachments:false});E._bind();S.copyFromFramebuffer(0,0,0,0,c,h);E._unBind();E.destroy();e._texture=e._texture&&e._texture.destroy();e._texture=S;e._root=w}else{var T=o*(r.width+2*s);var x=o*(r.height+2*s);if(T<e._initialSize.x){T=e._initialSize.x}if(x<e._initialSize.y){x=e._initialSize.y}e._texture=e._texture&&e._texture.destroy();e._texture=new f({context:e._context,width:T,height:x,pixelFormat:e._pixelFormat});e._root=new p(new t(s,s),new t(T,x))}}function g(e,r,i){if(!n(r)){return undefined}if(!n(r.childNode1)&&!n(r.childNode2)){if(n(r.imageIndex)){return undefined}var a=r.topRight.x-r.bottomLeft.x;var o=r.topRight.y-r.bottomLeft.y;var s=a-i.width;var u=o-i.height;if(s<0||u<0){return undefined}if(s===0&&u===0){return r}
if(s>u){r.childNode1=new p(new t(r.bottomLeft.x,r.bottomLeft.y),new t(r.bottomLeft.x+i.width,r.topRight.y));var l=r.bottomLeft.x+i.width+e._borderWidthInPixels;if(l<r.topRight.x){r.childNode2=new p(new t(l,r.bottomLeft.y),new t(r.topRight.x,r.topRight.y))}}else{r.childNode1=new p(new t(r.bottomLeft.x,r.bottomLeft.y),new t(r.topRight.x,r.bottomLeft.y+i.height));var c=r.bottomLeft.y+i.height+e._borderWidthInPixels;if(c<r.topRight.y){r.childNode2=new p(new t(r.bottomLeft.x,c),new t(r.topRight.x,r.topRight.y))}}return g(e,r.childNode1,i)}return g(e,r.childNode1,i)||g(e,r.childNode2,i)}function y(t,i,a){var o=g(t,t._root,i);if(n(o)){o.imageIndex=a;var s=t._texture.width;var u=t._texture.height;var l=o.topRight.x-o.bottomLeft.x;var c=o.topRight.y-o.bottomLeft.y;var d=o.bottomLeft.x/s;var f=o.bottomLeft.y/u;var h=l/s;var p=c/u;t._textureCoordinates[a]=new e(d,f,h,p);t._texture.copyFrom(i,o.bottomLeft.x,o.bottomLeft.y)}else{_(t,i);y(t,i,a)}t._guid=r()}v.prototype.addImage=function(e,t){if(!n(e)){throw new s("id is required.")}if(!n(t)){throw new s("image is required.")}var r=this._idHash[e];if(n(r)){return r}if(typeof t==="function"){t=t(e);if(!n(t)){throw new s("image is required.")}}else if(typeof t==="string"){t=u(t)}var i=this;r=h(t,function(e){if(i.isDestroyed()){return-1}var t=i.numberOfImages;y(i,e,t);return t});this._idHash[e]=r;return r};v.prototype.addSubRegion=function(t,i){if(!n(t)){throw new s("id is required.")}if(!n(i)){throw new s("subRegion is required.")}var a=this._idHash[t];if(!n(a)){throw new c('image with id "'+t+'" not found in the atlas.')}var o=this;return h(a,function(t){if(t===-1){return-1}var n=o._texture.width;var a=o._texture.height;var s=o.numberOfImages;var u=o._textureCoordinates[t];var l=u.x+i.x/n;var c=u.y+i.y/a;var d=i.width/n;var f=i.height/a;o._textureCoordinates.push(new e(l,c,d,f));o._guid=r();return s})};v.prototype.isDestroyed=function(){return false};v.prototype.destroy=function(){this._texture=this._texture&&this._texture.destroy();return o(this)};return v});define("Scene/BillboardCollection",["../Core/AttributeCompression","../Core/BoundingSphere","../Core/Cartesian2","../Core/Cartesian3","../Core/Color","../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/EncodedCartesian3","../Core/IndexDatatype","../Core/Math","../Core/Matrix4","../Core/WebGLConstants","../Renderer/Buffer","../Renderer/BufferUsage","../Renderer/DrawCommand","../Renderer/Pass","../Renderer/RenderState","../Renderer/ShaderProgram","../Renderer/ShaderSource","../Renderer/VertexArrayFacade","../Shaders/BillboardCollectionFS","../Shaders/BillboardCollectionVS","./Billboard","./BlendingState","./BlendOption","./HeightReference","./HorizontalOrigin","./SceneMode","./TextureAtlas","./VerticalOrigin"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w,C,b,S,E,T,x,A,P,D,M,I,O,R){"use strict";var N=x.SHOW_INDEX;var L=x.POSITION_INDEX;var B=x.PIXEL_OFFSET_INDEX;var F=x.EYE_OFFSET_INDEX;var k=x.HORIZONTAL_ORIGIN_INDEX;var V=x.VERTICAL_ORIGIN_INDEX;var z=x.SCALE_INDEX;var U=x.IMAGE_INDEX_INDEX;var q=x.COLOR_INDEX;var G=x.ROTATION_INDEX;var H=x.ALIGNED_AXIS_INDEX;var W=x.SCALE_BY_DISTANCE_INDEX;var j=x.TRANSLUCENCY_BY_DISTANCE_INDEX;var Y=x.PIXEL_OFFSET_SCALE_BY_DISTANCE_INDEX;var X=x.DISTANCE_DISPLAY_CONDITION_INDEX;var Z=x.NUMBER_OF_PROPERTIES;var K;var Q={positionHighAndScale:0,positionLowAndRotation:1,compressedAttribute0:2,compressedAttribute1:3,compressedAttribute2:4,eyeOffset:5,scaleByDistance:6,pixelOffsetScaleByDistance:7,distanceDisplayCondition:8};var J={direction:0,positionHighAndScale:1,positionLowAndRotation:2,compressedAttribute0:3,compressedAttribute1:4,compressedAttribute2:5,eyeOffset:6,scaleByDistance:7,pixelOffsetScaleByDistance:8,distanceDisplayCondition:9};function $(e){e=o(e,o.EMPTY_OBJECT);this._scene=e.scene;this._textureAtlas=undefined;this._textureAtlasGUID=undefined;this._destroyTextureAtlas=true;this._sp=undefined;this._spTranslucent=undefined;this._spPick=undefined;this._rsOpaque=undefined;this._rsTranslucent=undefined;this._vaf=undefined;this._billboards=[];this._billboardsToUpdate=[];this._billboardsToUpdateIndex=0;this._billboardsRemoved=false;this._createVertexArray=false;this._shaderRotation=false;this._compiledShaderRotation=false;this._compiledShaderRotationPick=false;this._shaderAlignedAxis=false;this._compiledShaderAlignedAxis=false;this._compiledShaderAlignedAxisPick=false;this._shaderScaleByDistance=false;this._compiledShaderScaleByDistance=false;this._compiledShaderScaleByDistancePick=false;this._shaderTranslucencyByDistance=false;this._compiledShaderTranslucencyByDistance=false;this._compiledShaderTranslucencyByDistancePick=false;this._shaderPixelOffsetScaleByDistance=false;this._compiledShaderPixelOffsetScaleByDistance=false;this._compiledShaderPixelOffsetScaleByDistancePick=false;this._shaderDistanceDisplayCondition=false;this._compiledShaderDistanceDisplayCondition=false;this._compiledShaderDistanceDisplayConditionPick=false;this._propertiesChanged=new Uint32Array(Z);this._maxSize=0;this._maxEyeOffset=0;this._maxScale=1;this._maxPixelOffset=0;this._allHorizontalCenter=true;this._allVerticalCenter=true;this._allSizedInMeters=true;this._baseVolume=new t;this._baseVolumeWC=new t;this._baseVolume2D=new t;this._boundingVolume=new t;this._boundingVolumeDirty=false;this._colorCommands=[];this._pickCommands=[];this.modelMatrix=p.clone(o(e.modelMatrix,p.IDENTITY));this._modelMatrix=p.clone(p.IDENTITY);this.debugShowBoundingVolume=o(e.debugShowBoundingVolume,false);this.blendOption=o(e.blendOption,P.OPAQUE_AND_TRANSLUCENT);this._blendOption=undefined;this._mode=I.SCENE3D;this._buffersUsage=[_.STATIC_DRAW,_.STATIC_DRAW,_.STATIC_DRAW,_.STATIC_DRAW,_.STATIC_DRAW,_.STATIC_DRAW,_.STATIC_DRAW,_.STATIC_DRAW,_.STATIC_DRAW,_.STATIC_DRAW,_.STATIC_DRAW,_.STATIC_DRAW,_.STATIC_DRAW,_.STATIC_DRAW,_.STATIC_DRAW];var r=this;this._uniforms={u_atlas:function(){return r._textureAtlas.texture}};var i=this._scene;if(s(i)){this._removeCallbackFunc=i.terrainProviderChanged.addEventListener(function(){var e=this._billboards;var t=e.length;for(var r=0;r<t;++r){e[r]._updateClamping()}},this)}}u($.prototype,{length:{get:function(){te(this);return this._billboards.length}},textureAtlas:{get:function(){return this._textureAtlas},set:function(e){if(this._textureAtlas!==e){this._textureAtlas=this._destroyTextureAtlas&&this._textureAtlas&&this._textureAtlas.destroy();this._textureAtlas=e;this._createVertexArray=true}}},destroyTextureAtlas:{get:function(){return this._destroyTextureAtlas},set:function(e){this._destroyTextureAtlas=e}}});function ee(e){var t=e.length;for(var r=0;r<t;++r){if(e[r]){e[r]._destroy()}}}$.prototype.add=function(e){var t=new x(e,this);t._index=this._billboards.length;this._billboards.push(t);this._createVertexArray=true;return t};$.prototype.remove=function(e){if(this.contains(e)){this._billboards[e._index]=null;this._billboardsRemoved=true;this._createVertexArray=true;e._destroy();return true}return false};$.prototype.removeAll=function(){ee(this._billboards);this._billboards=[];this._billboardsToUpdate=[];this._billboardsToUpdateIndex=0;this._billboardsRemoved=false;this._createVertexArray=true};function te(e){if(e._billboardsRemoved){e._billboardsRemoved=false;var t=[];var r=e._billboards;var i=r.length;for(var n=0,a=0;n<i;++n){var o=r[n];if(o){o._index=a++;t.push(o)}}e._billboards=t}}$.prototype._updateBillboard=function(e,t){if(!e._dirty){this._billboardsToUpdate[this._billboardsToUpdateIndex++]=e}++this._propertiesChanged[t]};$.prototype.contains=function(e){return s(e)&&e._billboardCollection===this};$.prototype.get=function(e){if(!s(e)){throw new c("index is required.")}te(this);return this._billboards[e]};var re;function ie(e){var t=16*1024;var r=e.cache.billboardCollection_indexBufferBatched;if(s(r)){return r}var i=t*6-6;var n=new Uint16Array(i);for(var a=0,o=0;a<i;a+=6,o+=4){n[a]=o;n[a+1]=o+1;n[a+2]=o+2;n[a+3]=o+0;n[a+4]=o+2;n[a+5]=o+3}r=v.createIndexBuffer({context:e,typedArray:n,usage:_.STATIC_DRAW,indexDatatype:f.UNSIGNED_SHORT});r.vertexArrayDestroyable=false;e.cache.billboardCollection_indexBufferBatched=r;return r}function ne(e){var t=e.cache.billboardCollection_indexBufferInstanced;if(s(t)){return t}t=v.createIndexBuffer({context:e,typedArray:new Uint16Array([0,1,2,0,2,3]),usage:_.STATIC_DRAW,indexDatatype:f.UNSIGNED_SHORT});t.vertexArrayDestroyable=false;e.cache.billboardCollection_indexBufferInstanced=t;return t}function ae(e){var t=e.cache.billboardCollection_vertexBufferInstanced;if(s(t)){return t}t=v.createVertexBuffer({context:e,typedArray:new Float32Array([0,0,1,0,1,1,0,1]),usage:_.STATIC_DRAW});t.vertexArrayDestroyable=false;e.cache.billboardCollection_vertexBufferInstanced=t;return t}$.prototype.computeNewBuffersUsage=function(){var e=this._buffersUsage;var t=false;var r=this._propertiesChanged;for(var i=0;i<Z;++i){var n=r[i]===0?_.STATIC_DRAW:_.STREAM_DRAW;t=t||e[i]!==n;e[i]=n}return t};function oe(e,t,r,i){var n=[{index:K.positionHighAndScale,componentsPerAttribute:4,componentDatatype:a.FLOAT,usage:r[L]},{index:K.positionLowAndRotation,componentsPerAttribute:4,componentDatatype:a.FLOAT,usage:r[L]},{index:K.compressedAttribute0,componentsPerAttribute:4,componentDatatype:a.FLOAT,usage:r[B]},{index:K.compressedAttribute1,componentsPerAttribute:4,componentDatatype:a.FLOAT,usage:r[j]},{index:K.compressedAttribute2,componentsPerAttribute:4,componentDatatype:a.FLOAT,usage:r[q]},{index:K.eyeOffset,componentsPerAttribute:4,componentDatatype:a.FLOAT,usage:r[F]},{index:K.scaleByDistance,componentsPerAttribute:4,componentDatatype:a.FLOAT,usage:r[W]},{index:K.pixelOffsetScaleByDistance,componentsPerAttribute:4,componentDatatype:a.FLOAT,usage:r[Y]},{index:K.distanceDisplayCondition,componentsPerAttribute:2,componentDatatype:a.FLOAT,usage:r[X]}];if(i){n.push({index:K.direction,componentsPerAttribute:2,componentDatatype:a.FLOAT,vertexBuffer:ae(e)})}var o=i?t:4*t;return new S(e,n,o,i)}var se=new d;function ue(e,r,i,n,a){var o;var s=n[K.positionHighAndScale];var u=n[K.positionLowAndRotation];var l=a._getActualPosition();if(e._mode===I.SCENE3D){t.expand(e._baseVolume,l,e._baseVolume);e._boundingVolumeDirty=true}d.fromCartesian(l,se);var c=a.scale;var f=a.rotation;if(f!==0){e._shaderRotation=true}e._maxScale=Math.max(e._maxScale,c);var h=se.high;var p=se.low;if(e._instanced){o=a._index;s(o,h.x,h.y,h.z,c);u(o,p.x,p.y,p.z,f)}else{o=a._index*4;s(o+0,h.x,h.y,h.z,c);s(o+1,h.x,h.y,h.z,c);s(o+2,h.x,h.y,h.z,c);s(o+3,h.x,h.y,h.z,c);u(o+0,p.x,p.y,p.z,f);u(o+1,p.x,p.y,p.z,f);u(o+2,p.x,p.y,p.z,f);u(o+3,p.x,p.y,p.z,f)}}var le=new r;var ce=32768;var de=65536;var fe=256;var he=128;var pe=32;var me=8;var ve=4;var _e=1/256;var ge=0;var ye=2;var we=3;var Ce=1;function be(t,r,i,n,a){var o;var u=n[K.compressedAttribute0];var l=a.pixelOffset;var d=l.x;var f=l.y;var p=a._translate;var m=p.x;var v=p.y;t._maxPixelOffset=Math.max(t._maxPixelOffset,Math.abs(d+m),Math.abs(-f+v));var _=a.horizontalOrigin;var g=a._verticalOrigin;var y=a.show&&a.clusterShow;if(a.color.alpha===0){y=false}if(g===R.BASELINE){g=R.BOTTOM}t._allHorizontalCenter=t._allHorizontalCenter&&_===M.CENTER;t._allVerticalCenter=t._allVerticalCenter&&g===R.CENTER;var w=0;var C=0;var b=0;var S=0;var E=a._imageIndex;if(E!==-1){var T=i[E];if(!s(T)){throw new c("Invalid billboard image index: "+E)}w=T.x;C=T.y;b=T.width;S=T.height}var x=w+b;var A=C+S;var P=Math.floor(h.clamp(d,-ce,ce)+ce)*he;P+=(_+1)*pe;P+=(g+1)*me;P+=(y?1:0)*ve;var D=Math.floor(h.clamp(f,-ce,ce)+ce)*fe;var I=Math.floor(h.clamp(m,-ce,ce)+ce)*fe;var O=(h.clamp(v,-ce,ce)+ce)*_e;var N=Math.floor(O);var L=Math.floor((O-N)*fe);D+=N;I+=L;le.x=w;le.y=C;var B=e.compressTextureCoordinates(le);le.x=x;var F=e.compressTextureCoordinates(le);le.y=A;var k=e.compressTextureCoordinates(le);le.x=w;var V=e.compressTextureCoordinates(le);if(t._instanced){o=a._index;u(o,P,D,I,B)}else{o=a._index*4;u(o+0,P+ge,D,I,B);u(o+1,P+ye,D,I,F);u(o+2,P+we,D,I,k);u(o+3,P+Ce,D,I,V)}}function Se(t,r,n,a,u){var l;var d=a[K.compressedAttribute1];var f=u.alignedAxis;if(!i.equals(f,i.ZERO)){t._shaderAlignedAxis=true}var p=0;var m=1;var v=1;var _=1;var g=u.translucencyByDistance;if(s(g)){p=g.near;m=g.nearValue;v=g.far;_=g.farValue;if(m!==1||_!==1){t._shaderTranslucencyByDistance=true}}var y=0;var w=u._imageIndex;if(w!==-1){var C=n[w];if(!s(C)){throw new c("Invalid billboard image index: "+w)}y=C.width}var b=t._textureAtlas.texture.width;var S=Math.round(o(u.width,b*y));t._maxSize=Math.max(t._maxSize,S);var E=h.clamp(S,0,de);var T=0;if(Math.abs(i.magnitudeSquared(f)-1)<h.EPSILON6){T=e.octEncodeFloat(f)}m=h.clamp(m,0,1);m=m===1?255:m*255|0;E=E*fe+m;_=h.clamp(_,0,1);_=_===1?255:_*255|0;T=T*fe+_;if(t._instanced){l=u._index;d(l,E,T,p,v)}else{l=u._index*4;d(l+0,E,T,p,v);d(l+1,E,T,p,v);d(l+2,E,T,p,v);d(l+3,E,T,p,v)}}function Ee(e,t,r,a,u){var l;var d=a[K.compressedAttribute2];var f=u.color;var p=u.getPickId(t).color;var m=u.sizeInMeters?1:0;var v=Math.abs(i.magnitudeSquared(u.alignedAxis)-1)<h.EPSILON6?1:0;e._allSizedInMeters=e._allSizedInMeters&&m===1;var _=0;var g=u._imageIndex;if(g!==-1){var y=r[g];if(!s(y)){throw new c("Invalid billboard image index: "+g)}_=y.height}var w=e._textureAtlas.texture.dimensions;var C=Math.round(o(u.height,w.y*_));e._maxSize=Math.max(e._maxSize,C);var b=n.floatToByte(f.red);var S=n.floatToByte(f.green);var E=n.floatToByte(f.blue);var T=b*de+S*fe+E;b=n.floatToByte(p.red);S=n.floatToByte(p.green);E=n.floatToByte(p.blue);var x=b*de+S*fe+E;var A=n.floatToByte(f.alpha)*de+n.floatToByte(p.alpha)*fe;A+=m*2+v;if(e._instanced){l=u._index;d(l,T,x,A,C)}else{l=u._index*4;d(l+0,T,x,A,C);d(l+1,T,x,A,C);d(l+2,T,x,A,C);d(l+3,T,x,A,C)}}function Te(t,r,i,n,a){var o;var u=n[K.eyeOffset];var l=a.eyeOffset;var d=l.z;if(a._heightReference!==D.NONE){d*=1.005}t._maxEyeOffset=Math.max(t._maxEyeOffset,Math.abs(l.x),Math.abs(l.y),Math.abs(d));if(t._instanced){var f=0;var h=0;var p=a._imageIndex;if(p!==-1){var m=i[p];if(!s(m)){throw new c("Invalid billboard image index: "+p)}f=m.width;h=m.height}le.x=f;le.y=h;var v=e.compressTextureCoordinates(le);o=a._index;u(o,l.x,l.y,d,v)}else{o=a._index*4;u(o+0,l.x,l.y,d,0);u(o+1,l.x,l.y,d,0);u(o+2,l.x,l.y,d,0);u(o+3,l.x,l.y,d,0)}}function xe(e,t,r,i,n){var a;var o=i[K.scaleByDistance];var u=0;var l=1;var c=1;var d=1;var f=n.scaleByDistance;if(s(f)){u=f.near;l=f.nearValue;c=f.far;d=f.farValue;if(l!==1||d!==1){e._shaderScaleByDistance=true}}if(e._instanced){a=n._index;o(a,u,l,c,d)}else{a=n._index*4;o(a+0,u,l,c,d);o(a+1,u,l,c,d);o(a+2,u,l,c,d);o(a+3,u,l,c,d)}}function Ae(e,t,r,i,n){var a;var o=i[K.pixelOffsetScaleByDistance];var u=0;var l=1;var c=1;var d=1;var f=n.pixelOffsetScaleByDistance;if(s(f)){u=f.near;l=f.nearValue;c=f.far;d=f.farValue;if(l!==1||d!==1){e._shaderPixelOffsetScaleByDistance=true}}if(e._instanced){a=n._index;o(a,u,l,c,d)}else{a=n._index*4;o(a+0,u,l,c,d);o(a+1,u,l,c,d);o(a+2,u,l,c,d);o(a+3,u,l,c,d)}}function Pe(e,t,r,i,n){var a;var o=i[K.distanceDisplayCondition];var u=0;var l=Number.MAX_VALUE;var c=n.distanceDisplayCondition;if(s(c)){u=c.near;l=c.far;e._shaderDistanceDisplayCondition=true}if(e._instanced){a=n._index;o(a,u,l)}else{a=n._index*4;o(a+0,u,l);o(a+1,u,l);o(a+2,u,l);o(a+3,u,l)}}function De(e,t,r,i,n){ue(e,t,r,i,n);be(e,t,r,i,n);Se(e,t,r,i,n);Ee(e,t,r,i,n);Te(e,t,r,i,n);xe(e,t,r,i,n);Ae(e,t,r,i,n);Pe(e,t,r,i,n)}function Me(e,r,i,n,a,o){var u;if(n.mode===I.SCENE3D){u=e._baseVolume;e._boundingVolumeDirty=true}else{u=e._baseVolume2D}var l=[];for(var c=0;c<i;++c){var d=r[c];var f=d.position;var h=x._computeActualPosition(d,f,n,a);if(s(h)){d._setActualPosition(h);if(o){l.push(h)}else{t.expand(u,h,u)}}}if(o){t.fromPoints(l,u)}}function Ie(e,t){var r=t.mode;var i=e._billboards;var n=e._billboardsToUpdate;var a=e._modelMatrix;if(e._createVertexArray||e._mode!==r||r!==I.SCENE3D&&!p.equals(a,e.modelMatrix)){e._mode=r;p.clone(e.modelMatrix,a);e._createVertexArray=true;if(r===I.SCENE3D||r===I.SCENE2D||r===I.COLUMBUS_VIEW){Me(e,i,i.length,t,a,true)}}else if(r===I.MORPHING){Me(e,i,i.length,t,a,true)}else if(r===I.SCENE2D||r===I.COLUMBUS_VIEW){Me(e,n,e._billboardsToUpdateIndex,t,a,false)}}function Oe(e,t,r){var i=1;if(!e._allSizedInMeters||e._maxPixelOffset!==0){i=t.camera.getPixelSize(r,t.context.drawingBufferWidth,t.context.drawingBufferHeight)}var n=i*e._maxScale*e._maxSize*2;if(e._allHorizontalCenter&&e._allVerticalCenter){n*=.5}var a=i*e._maxPixelOffset+e._maxEyeOffset;r.radius+=n+a}var Re=[];$.prototype.update=function(e){te(this);var r=this._billboards;var i=r.length;var n=e.context;this._instanced=n.instancedArrays;K=this._instanced?J:Q;re=this._instanced?ne:ie;var a=this._textureAtlas;if(!s(a)){a=this._textureAtlas=new O({context:n});for(var o=0;o<i;++o){r[o]._loadImage()}}var u=a.textureCoordinates;if(u.length===0){return}Ie(this,e);r=this._billboards;i=r.length;var l=this._billboardsToUpdate;var c=this._billboardsToUpdateIndex;var d=this._propertiesChanged;var f=a.guid;var h=this._createVertexArray||this._textureAtlasGUID!==f;this._textureAtlasGUID=f;var v;var _=e.passes;var S=_.pick;if(h||!S&&this.computeNewBuffersUsage()){this._createVertexArray=false;for(var x=0;x<Z;++x){d[x]=0}this._vaf=this._vaf&&this._vaf.destroy();if(i>0){this._vaf=oe(n,i,this._buffersUsage,this._instanced);v=this._vaf.writers;for(var D=0;D<i;++D){var M=this._billboards[D];M._dirty=false;De(this,n,u,v,M)}this._vaf.commit(re(n))}this._billboardsToUpdateIndex=0}else{if(c>0){var R=Re;R.length=0;if(d[L]||d[G]||d[z]){R.push(ue)}if(d[U]||d[B]||d[k]||d[V]||d[N]){R.push(be);if(this._instanced){R.push(Te)}}if(d[U]||d[H]||d[j]){R.push(Se);R.push(Ee)}if(d[U]||d[q]){R.push(Ee)}if(d[F]){R.push(Te)}if(d[W]){R.push(xe)}if(d[Y]){R.push(Ae)}if(d[X]){R.push(Pe)}var $=R.length;v=this._vaf.writers;if(c/i>.1){for(var ee=0;ee<c;++ee){var ae=l[ee];ae._dirty=false;for(var se=0;se<$;++se){R[se](this,n,u,v,ae)}}this._vaf.commit(re(n))}else{for(var le=0;le<c;++le){var ce=l[le];ce._dirty=false;for(var de=0;de<$;++de){R[de](this,n,u,v,ce)}if(this._instanced){this._vaf.subCommit(ce._index,1)}else{this._vaf.subCommit(ce._index*4,4)}}this._vaf.endSubCommits()}this._billboardsToUpdateIndex=0}}if(c>i*1.5){l.length=i}if(!s(this._vaf)||!s(this._vaf.va)){return}if(this._boundingVolumeDirty){this._boundingVolumeDirty=false;t.transform(this._baseVolume,this.modelMatrix,this._baseVolumeWC)}var fe;var he=p.IDENTITY;if(e.mode===I.SCENE3D){he=this.modelMatrix;fe=t.clone(this._baseVolumeWC,this._boundingVolume)}else{fe=t.clone(this._baseVolume2D,this._boundingVolume)}Oe(this,e,fe);var pe=this._blendOption!==this.blendOption;this._blendOption=this.blendOption;if(pe){if(this._blendOption===P.OPAQUE||this._blendOption===P.OPAQUE_AND_TRANSLUCENT){this._rsOpaque=w.fromCache({depthTest:{enabled:true,func:m.LESS},depthMask:true})}else{this._rsOpaque=undefined}var me=this._blendOption===P.TRANSLUCENT;if(this._blendOption===P.TRANSLUCENT||this._blendOption===P.OPAQUE_AND_TRANSLUCENT){this._rsTranslucent=w.fromCache({depthTest:{enabled:true,func:me?m.LEQUAL:m.LESS},depthMask:me,blending:A.ALPHA_BLEND})}else{this._rsTranslucent=undefined}}if(pe||this._shaderRotation!==this._compiledShaderRotation||this._shaderAlignedAxis!==this._compiledShaderAlignedAxis||this._shaderScaleByDistance!==this._compiledShaderScaleByDistance||this._shaderTranslucencyByDistance!==this._compiledShaderTranslucencyByDistance||this._shaderPixelOffsetScaleByDistance!==this._compiledShaderPixelOffsetScaleByDistance||this._shaderDistanceDisplayCondition!==this._compiledShaderDistanceDisplayCondition){ye=new b({sources:[T]});if(this._instanced){ye.defines.push("INSTANCED")}if(this._shaderRotation){ye.defines.push("ROTATION")}if(this._shaderAlignedAxis){ye.defines.push("ALIGNED_AXIS")}if(this._shaderScaleByDistance){ye.defines.push("EYE_DISTANCE_SCALING")}if(this._shaderTranslucencyByDistance){ye.defines.push("EYE_DISTANCE_TRANSLUCENCY")}if(this._shaderPixelOffsetScaleByDistance){ye.defines.push("EYE_DISTANCE_PIXEL_OFFSET")}if(this._shaderDistanceDisplayCondition){ye.defines.push("DISTANCE_DISPLAY_CONDITION")}if(this._blendOption===P.OPAQUE_AND_TRANSLUCENT){we=new b({defines:["OPAQUE"],sources:[E]});this._sp=C.replaceCache({context:n,shaderProgram:this._sp,vertexShaderSource:ye,fragmentShaderSource:we,attributeLocations:K});we=new b({defines:["TRANSLUCENT"],sources:[E]});this._spTranslucent=C.replaceCache({context:n,shaderProgram:this._spTranslucent,vertexShaderSource:ye,fragmentShaderSource:we,attributeLocations:K})}if(this._blendOption===P.OPAQUE){we=new b({sources:[E]});this._sp=C.replaceCache({context:n,shaderProgram:this._sp,vertexShaderSource:ye,fragmentShaderSource:we,attributeLocations:K})}if(this._blendOption===P.TRANSLUCENT){we=new b({sources:[E]});this._spTranslucent=C.replaceCache({context:n,shaderProgram:this._spTranslucent,vertexShaderSource:ye,fragmentShaderSource:we,attributeLocations:K})}this._compiledShaderRotation=this._shaderRotation;this._compiledShaderAlignedAxis=this._shaderAlignedAxis;this._compiledShaderScaleByDistance=this._shaderScaleByDistance;this._compiledShaderTranslucencyByDistance=this._shaderTranslucencyByDistance;this._compiledShaderPixelOffsetScaleByDistance=this._shaderPixelOffsetScaleByDistance;this._compiledShaderDistanceDisplayCondition=this._shaderDistanceDisplayCondition}if(!s(this._spPick)||this._shaderRotation!==this._compiledShaderRotationPick||this._shaderAlignedAxis!==this._compiledShaderAlignedAxisPick||this._shaderScaleByDistance!==this._compiledShaderScaleByDistancePick||this._shaderTranslucencyByDistance!==this._compiledShaderTranslucencyByDistancePick||this._shaderPixelOffsetScaleByDistance!==this._compiledShaderPixelOffsetScaleByDistancePick||this._shaderDistanceDisplayCondition!==this._compiledShaderDistanceDisplayConditionPick){ye=new b({defines:["RENDER_FOR_PICK"],sources:[T]});if(this._instanced){ye.defines.push("INSTANCED")}if(this._shaderRotation){ye.defines.push("ROTATION")}if(this._shaderAlignedAxis){ye.defines.push("ALIGNED_AXIS")}if(this._shaderScaleByDistance){ye.defines.push("EYE_DISTANCE_SCALING")}if(this._shaderTranslucencyByDistance){ye.defines.push("EYE_DISTANCE_TRANSLUCENCY")}if(this._shaderPixelOffsetScaleByDistance){ye.defines.push("EYE_DISTANCE_PIXEL_OFFSET")}if(this._shaderDistanceDisplayCondition){ye.defines.push("DISTANCE_DISPLAY_CONDITION")}we=new b({defines:["RENDER_FOR_PICK"],sources:[E]});this._spPick=C.replaceCache({context:n,shaderProgram:this._spPick,vertexShaderSource:ye,fragmentShaderSource:we,attributeLocations:K});this._compiledShaderRotationPick=this._shaderRotation;this._compiledShaderAlignedAxisPick=this._shaderAlignedAxis;this._compiledShaderScaleByDistancePick=this._shaderScaleByDistance;this._compiledShaderTranslucencyByDistancePick=this._shaderTranslucencyByDistance;this._compiledShaderPixelOffsetScaleByDistancePick=this._shaderPixelOffsetScaleByDistance;this._compiledShaderDistanceDisplayConditionPick=this._shaderDistanceDisplayCondition}var ve;var _e;var ge;var ye;var we;var Ce;var Me=e.commandList;if(_.render){var Ne=this._colorCommands;var Le=this._blendOption===P.OPAQUE;var Be=this._blendOption===P.OPAQUE_AND_TRANSLUCENT;ve=this._vaf.va;_e=ve.length;Ne.length=_e;var Fe=Be?_e*2:_e;for(Ce=0;Ce<Fe;++Ce){ge=Ne[Ce];if(!s(ge)){ge=Ne[Ce]=new g}var ke=Le||Be&&Ce%2===0;ge.pass=ke||!Be?y.OPAQUE:y.TRANSLUCENT;ge.owner=this;var Ve=Be?Math.floor(Ce/2):Ce;ge.boundingVolume=fe;ge.modelMatrix=he;ge.count=ve[Ve].indicesCount;ge.shaderProgram=ke?this._sp:this._spTranslucent;ge.uniformMap=this._uniforms;ge.vertexArray=ve[Ve].va;ge.renderState=ke?this._rsOpaque:this._rsTranslucent;ge.debugShowBoundingVolume=this.debugShowBoundingVolume;if(this._instanced){ge.count=6;ge.instanceCount=i}Me.push(ge)}}if(S){var ze=this._pickCommands;ve=this._vaf.va;_e=ve.length;ze.length=_e;for(Ce=0;Ce<_e;++Ce){ge=ze[Ce];if(!s(ge)){ge=ze[Ce]=new g({pass:y.OPAQUE,owner:this})}ge.boundingVolume=fe;ge.modelMatrix=he;ge.count=ve[Ce].indicesCount;ge.shaderProgram=this._spPick;ge.uniformMap=this._uniforms;ge.vertexArray=ve[Ce].va;ge.renderState=this._rsOpaque;if(this._instanced){ge.count=6;ge.instanceCount=i}Me.push(ge)}}};$.prototype.isDestroyed=function(){return false};$.prototype.destroy=function(){if(s(this._removeCallbackFunc)){this._removeCallbackFunc();this._removeCallbackFunc=undefined}this._textureAtlas=this._destroyTextureAtlas&&this._textureAtlas&&this._textureAtlas.destroy();this._sp=this._sp&&this._sp.destroy();this._spTranslucent=this._spTranslucent&&this._spTranslucent.destroy();this._spPick=this._spPick&&this._spPick.destroy();this._vaf=this._vaf&&this._vaf.destroy();ee(this._billboards);return l(this)};return $});define("Scene/LabelStyle",["../Core/freezeObject"],function(e){"use strict";var t={FILL:0,OUTLINE:1,FILL_AND_OUTLINE:2};return e(t)});define("Scene/Label",["../Core/BoundingRectangle","../Core/Cartesian2","../Core/Cartesian3","../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/NearFarScalar","./Billboard","./HeightReference","./HorizontalOrigin","./LabelStyle","./VerticalOrigin"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p){"use strict";function m(e){if(!e._rebindAllGlyphs&&!e._repositionAllGlyphs){e._labelCollection._labelsToUpdate.push(e)}e._rebindAllGlyphs=true}function v(e){if(!e._rebindAllGlyphs&&!e._repositionAllGlyphs){e._labelCollection._labelsToUpdate.push(e)}e._repositionAllGlyphs=true}function _(e,o){e=n(e,n.EMPTY_OBJECT);if(a(e.translucencyByDistance)&&e.translucencyByDistance.far<=e.translucencyByDistance.near){throw new s("translucencyByDistance.far must be greater than translucencyByDistance.near.")}if(a(e.pixelOffsetScaleByDistance)&&e.pixelOffsetScaleByDistance.far<=e.pixelOffsetScaleByDistance.near){throw new s("pixelOffsetScaleByDistance.far must be greater than pixelOffsetScaleByDistance.near.")}if(a(e.scaleByDistance)&&e.scaleByDistance.far<=e.scaleByDistance.near){throw new s("scaleByDistance.far must be greater than scaleByDistance.near.")}if(a(e.distanceDisplayCondition)&&e.distanceDisplayCondition.far<=e.distanceDisplayCondition.near){throw new s("distanceDisplayCondition.far must be greater than distanceDisplayCondition.near")}this._text=n(e.text,"");this._show=n(e.show,true);this._font=n(e.font,"30px sans-serif");this._fillColor=i.clone(n(e.fillColor,i.WHITE));this._outlineColor=i.clone(n(e.outlineColor,i.BLACK));this._outlineWidth=n(e.outlineWidth,1);this._showBackground=n(e.showBackground,false);this._backgroundColor=n(e.backgroundColor,new i(.165,.165,.165,.8));this._backgroundPadding=n(e.backgroundPadding,new t(7,5));this._style=n(e.style,h.FILL);this._verticalOrigin=n(e.verticalOrigin,p.BASELINE);this._horizontalOrigin=n(e.horizontalOrigin,f.LEFT);this._pixelOffset=t.clone(n(e.pixelOffset,t.ZERO));this._eyeOffset=r.clone(n(e.eyeOffset,r.ZERO));this._position=r.clone(n(e.position,r.ZERO));this._scale=n(e.scale,1);this._id=e.id;this._translucencyByDistance=e.translucencyByDistance;this._pixelOffsetScaleByDistance=e.pixelOffsetScaleByDistance;this._scaleByDistance=e.scaleByDistance;this._heightReference=n(e.heightReference,d.NONE);this._distanceDisplayCondition=e.distanceDisplayCondition;this._labelCollection=o;this._glyphs=[];this._backgroundBillboard=undefined;this._rebindAllGlyphs=true;this._repositionAllGlyphs=true;this._actualClampedPosition=undefined;this._removeCallbackFunc=undefined;this._mode=undefined;this._clusterShow=true;this._updateClamping()}o(_.prototype,{show:{get:function(){return this._show},set:function(e){if(!a(e)){throw new s("value is required.")}if(this._show!==e){this._show=e;var t=this._glyphs;for(var r=0,i=t.length;r<i;r++){var n=t[r].billboard;if(a(n)){n.show=e}}var o=this._backgroundBillboard;if(a(o)){o.show=e}}}},position:{get:function(){return this._position},set:function(e){if(!a(e)){throw new s("value is required.")}var t=this._position;if(!r.equals(t,e)){r.clone(e,t);var i=this._glyphs;for(var n=0,o=i.length;n<o;n++){var u=i[n].billboard;if(a(u)){u.position=e}}var l=this._backgroundBillboard;if(a(l)){l.position=e}if(this._heightReference!==d.NONE){this._updateClamping()}}}},heightReference:{get:function(){return this._heightReference},set:function(e){if(!a(e)){throw new s("value is required.")}if(e!==this._heightReference){this._heightReference=e;var t=this._glyphs;for(var r=0,i=t.length;r<i;r++){var n=t[r].billboard;if(a(n)){n.heightReference=e}}var o=this._backgroundBillboard;if(a(o)){o.heightReference=e}v(this);this._updateClamping()}}},text:{get:function(){return this._text},set:function(e){if(!a(e)){throw new s("value is required.")}if(this._text!==e){this._text=e;m(this)}}},font:{get:function(){return this._font},set:function(e){if(!a(e)){throw new s("value is required.")}if(this._font!==e){this._font=e;m(this)}}},fillColor:{get:function(){return this._fillColor},set:function(e){if(!a(e)){throw new s("value is required.")}var t=this._fillColor;if(!i.equals(t,e)){i.clone(e,t);m(this)}}},outlineColor:{get:function(){return this._outlineColor},set:function(e){if(!a(e)){throw new s("value is required.")}var t=this._outlineColor;if(!i.equals(t,e)){i.clone(e,t);m(this)}}},outlineWidth:{get:function(){return this._outlineWidth},set:function(e){if(!a(e)){throw new s("value is required.")}if(this._outlineWidth!==e){this._outlineWidth=e;m(this)}}},showBackground:{get:function(){return this._showBackground},set:function(e){if(!a(e)){throw new s("value is required.")}if(this._showBackground!==e){this._showBackground=e;m(this)}}},backgroundColor:{get:function(){return this._backgroundColor},set:function(e){if(!a(e)){throw new s("value is required.")}var t=this._backgroundColor;if(!i.equals(t,e)){i.clone(e,t);var r=this._backgroundBillboard;if(a(r)){r.color=t}}}},backgroundPadding:{get:function(){return this._backgroundPadding},set:function(e){if(!a(e)){throw new s("value is required.")}var r=this._backgroundPadding;if(!t.equals(r,e)){t.clone(e,r);v(this)}}},style:{get:function(){return this._style},set:function(e){if(!a(e)){throw new s("value is required.")}if(this._style!==e){this._style=e;m(this)}}},pixelOffset:{get:function(){return this._pixelOffset},set:function(e){if(!a(e)){throw new s("value is required.")}var r=this._pixelOffset;if(!t.equals(r,e)){t.clone(e,r);var i=this._glyphs;for(var n=0,o=i.length;n<o;n++){var u=i[n];if(a(u.billboard)){u.billboard.pixelOffset=e}}var l=this._backgroundBillboard;if(a(l)){l.pixelOffset=e}}}},translucencyByDistance:{get:function(){return this._translucencyByDistance},set:function(e){if(a(e)&&e.far<=e.near){throw new s("far distance must be greater than near distance.")}var t=this._translucencyByDistance;if(!l.equals(t,e)){this._translucencyByDistance=l.clone(e,t);var r=this._glyphs;for(var i=0,n=r.length;i<n;i++){var o=r[i];if(a(o.billboard)){o.billboard.translucencyByDistance=e}}var u=this._backgroundBillboard;if(a(u)){u.translucencyByDistance=e}}}},pixelOffsetScaleByDistance:{get:function(){return this._pixelOffsetScaleByDistance},set:function(e){if(a(e)&&e.far<=e.near){throw new s("far distance must be greater than near distance.")}var t=this._pixelOffsetScaleByDistance;if(!l.equals(t,e)){this._pixelOffsetScaleByDistance=l.clone(e,t);var r=this._glyphs;for(var i=0,n=r.length;i<n;i++){var o=r[i];if(a(o.billboard)){o.billboard.pixelOffsetScaleByDistance=e}}var u=this._backgroundBillboard;if(a(u)){u.pixelOffsetScaleByDistance=e}}}},scaleByDistance:{get:function(){return this._scaleByDistance},set:function(e){if(a(e)&&e.far<=e.near){throw new s("far distance must be greater than near distance.")}var t=this._scaleByDistance;if(!l.equals(t,e)){this._scaleByDistance=l.clone(e,t);var r=this._glyphs;for(var i=0,n=r.length;i<n;i++){var o=r[i];if(a(o.billboard)){o.billboard.scaleByDistance=e}}var u=this._backgroundBillboard;if(a(u)){u.scaleByDistance=e}}}},eyeOffset:{get:function(){return this._eyeOffset},set:function(e){if(!a(e)){throw new s("value is required.")}var t=this._eyeOffset;if(!r.equals(t,e)){r.clone(e,t);var i=this._glyphs;for(var n=0,o=i.length;n<o;n++){var u=i[n]
;if(a(u.billboard)){u.billboard.eyeOffset=e}}var l=this._backgroundBillboard;if(a(l)){l.eyeOffset=e}}}},horizontalOrigin:{get:function(){return this._horizontalOrigin},set:function(e){if(!a(e)){throw new s("value is required.")}if(this._horizontalOrigin!==e){this._horizontalOrigin=e;v(this)}}},verticalOrigin:{get:function(){return this._verticalOrigin},set:function(e){if(!a(e)){throw new s("value is required.")}if(this._verticalOrigin!==e){this._verticalOrigin=e;var t=this._glyphs;for(var r=0,i=t.length;r<i;r++){var n=t[r];if(a(n.billboard)){n.billboard.verticalOrigin=e}}var o=this._backgroundBillboard;if(a(o)){o.verticalOrigin=e}v(this)}}},scale:{get:function(){return this._scale},set:function(e){if(!a(e)){throw new s("value is required.")}if(this._scale!==e){this._scale=e;var t=this._glyphs;for(var r=0,i=t.length;r<i;r++){var n=t[r];if(a(n.billboard)){n.billboard.scale=e}}var o=this._backgroundBillboard;if(a(o)){o.scale=e}v(this)}}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){if(a(e)&&e.far<=e.near){throw new s("far must be greater than near")}if(!u.equals(e,this._distanceDisplayCondition)){this._distanceDisplayCondition=u.clone(e,this._distanceDisplayCondition);var t=this._glyphs;for(var r=0,i=t.length;r<i;r++){var n=t[r];if(a(n.billboard)){n.billboard.distanceDisplayCondition=e}}var o=this._backgroundBillboard;if(a(o)){o.distanceDisplayCondition=e}}}},id:{get:function(){return this._id},set:function(e){if(this._id!==e){this._id=e;var t=this._glyphs;for(var r=0,i=t.length;r<i;r++){var n=t[r];if(a(n.billboard)){n.billboard.id=e}}var o=this._backgroundBillboard;if(a(o)){o.id=e}}}},_clampedPosition:{get:function(){return this._actualClampedPosition},set:function(e){this._actualClampedPosition=r.clone(e,this._actualClampedPosition);var t=this._glyphs;e=n(e,this._position);for(var i=0,o=t.length;i<o;i++){var s=t[i];if(a(s.billboard)){s.billboard._clampedPosition=e;r.clone(e,s.billboard._position);r.clone(e,s.billboard._actualPosition)}}var u=this._backgroundBillboard;if(a(u)){u._clampedPosition=e;r.clone(e,u._position);r.clone(e,u._actualPosition)}}},clusterShow:{get:function(){return this._clusterShow},set:function(e){if(this._clusterShow!==e){this._clusterShow=e;var t=this._glyphs;for(var r=0,i=t.length;r<i;r++){var n=t[r];if(a(n.billboard)){n.billboard.clusterShow=e}}var o=this._backgroundBillboard;if(a(o)){o.clusterShow=e}}}}});_.prototype._updateClamping=function(){c._updateClamping(this._labelCollection,this)};_.prototype.computeScreenSpacePosition=function(e,r){if(!a(e)){throw new s("scene is required.")}if(!a(r)){r=new t}var i=this._labelCollection;var n=i.modelMatrix;var o=a(this._actualClampedPosition)?this._actualClampedPosition:this._position;var u=c._computeScreenSpacePosition(n,o,this._eyeOffset,this._pixelOffset,e,r);return u};_.getScreenSpaceBoundingBox=function(t,r,i){var n=0;var o=0;var s=0;var u=0;var l=t.scale;var c=t._labelCollection._resolutionScale;var d=t._backgroundBillboard;if(a(d)){n=r.x+d._translate.x/c;o=r.y-d._translate.y/c;s=d.width*l;u=d.height*l;if(t.verticalOrigin===p.BOTTOM||t.verticalOrigin===p.BASELINE){o-=u}else if(t.verticalOrigin===p.CENTER){o-=u*.5}}else{n=Number.POSITIVE_INFINITY;o=Number.POSITIVE_INFINITY;var f=0;var h=0;var m=t._glyphs;var v=m.length;for(var _=0;_<v;++_){var g=m[_];var y=g.billboard;if(!a(y)){continue}var w=r.x+y._translate.x/c;var C=r.y-y._translate.y/c;var b=y.width*l;var S=y.height*l;if(t.verticalOrigin===p.BOTTOM||t.verticalOrigin===p.BASELINE){C-=S}else if(t.verticalOrigin===p.CENTER){C-=S*.5}n=Math.min(n,w);o=Math.min(o,C);f=Math.max(f,w+b);h=Math.max(h,C+S)}s=f-n;u=h-o}if(!a(i)){i=new e}i.x=n;i.y=o;i.width=s;i.height=u;return i};_.prototype.equals=function(e){return this===e||a(e)&&this._show===e._show&&this._scale===e._scale&&this._outlineWidth===e._outlineWidth&&this._showBackground===e._showBackground&&this._style===e._style&&this._verticalOrigin===e._verticalOrigin&&this._horizontalOrigin===e._horizontalOrigin&&this._heightReference===e._heightReference&&this._text===e._text&&this._font===e._font&&r.equals(this._position,e._position)&&i.equals(this._fillColor,e._fillColor)&&i.equals(this._outlineColor,e._outlineColor)&&i.equals(this._backgroundColor,e._backgroundColor)&&t.equals(this._backgroundPadding,e._backgroundPadding)&&t.equals(this._pixelOffset,e._pixelOffset)&&r.equals(this._eyeOffset,e._eyeOffset)&&l.equals(this._translucencyByDistance,e._translucencyByDistance)&&l.equals(this._pixelOffsetScaleByDistance,e._pixelOffsetScaleByDistance)&&l.equals(this._scaleByDistance,e._scaleByDistance)&&u.equals(this._distanceDisplayCondition,e._distanceDisplayCondition)&&this._id===e._id};_.prototype.isDestroyed=function(){return false};return _});define("Scene/LabelCollection",["../Core/BoundingRectangle","../Core/Cartesian2","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/Matrix4","../Core/writeTextToCanvas","./BillboardCollection","./BlendOption","./HorizontalOrigin","./Label","./LabelStyle","./TextureAtlas","./VerticalOrigin"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m){"use strict";function v(){this.textureInfo=undefined;this.dimensions=undefined;this.billboard=undefined}function _(e,t,r){this.labelCollection=e;this.index=t;this.dimensions=r}var g=1.2;var y="ID_WHITE_PIXEL";var w=new t(4,4);var C=new e(1,1,1,1);function b(e,t){var r=document.createElement("canvas");r.width=w.x;r.height=w.y;var i=r.getContext("2d");i.fillStyle="#fff";i.fillRect(0,0,r.width,r.height);e.addImage(y,r).then(function(e){t._whitePixelIndex=e})}var S={};function E(e,t,r,i,n,a,o){S.font=t;S.fillColor=r;S.strokeColor=i;S.strokeWidth=n;if(o===m.CENTER){S.textBaseline="middle"}else if(o===m.TOP){S.textBaseline="top"}else{S.textBaseline="bottom"}S.fill=a===h.FILL||a===h.FILL_AND_OUTLINE;S.stroke=a===h.OUTLINE||a===h.FILL_AND_OUTLINE;return u(e,S)}function T(e,t){t.textureInfo=undefined;t.dimensions=undefined;var r=t.billboard;if(i(r)){r.show=false;r.image=undefined;e._spareBillboards.push(r);t.billboard=undefined}}function x(e,t,r,i){e.addImage(t,r).then(function(e,t){i.index=e})}function A(e,t){var r=t._text;var n=r.length;var a=t._glyphs;var o=a.length;var s;var u;var l;if(n<o){for(u=n;u<o;++u){T(e,a[u])}}a.length=n;var c=t._showBackground&&r.split("\n").join("").length>0;var f=t._backgroundBillboard;var h=e._backgroundBillboardCollection;if(!c){if(i(f)){h.remove(f);t._backgroundBillboard=f=undefined}}else{if(!i(f)){f=h.add({collection:e,image:y,imageSubRegion:C});t._backgroundBillboard=f}f.color=t._backgroundColor;f.show=t._show;f.position=t._position;f.eyeOffset=t._eyeOffset;f.pixelOffset=t._pixelOffset;f.horizontalOrigin=d.LEFT;f.verticalOrigin=t._verticalOrigin;f.heightReference=t._heightReference;f.scale=t._scale;f.pickPrimitive=t;f.id=t._id;f.translucencyByDistance=t._translucencyByDistance;f.pixelOffsetScaleByDistance=t._pixelOffsetScaleByDistance;f.scaleByDistance=t._scaleByDistance;f.distanceDisplayCondition=t._distanceDisplayCondition}var p=e._glyphTextureCache;for(l=0;l<n;++l){var m=r.charAt(l);var g=t._font;var w=t._fillColor;var b=t._outlineColor;var S=t._outlineWidth;var A=t._style;var P=t._verticalOrigin;var D=JSON.stringify([m,g,w.toRgba(),b.toRgba(),S,+A,+P]);var M=p[D];if(!i(M)){var I=E(m,g,w,b,S,A,P);M=new _(e,-1,I.dimensions);p[D]=M;if(I.width>0&&I.height>0){x(e._textureAtlas,D,I,M)}}s=a[l];if(i(s)){if(M.index===-1){T(e,s)}else{if(i(s.textureInfo)){s.textureInfo=undefined}}}else{s=new v;a[l]=s}s.textureInfo=M;s.dimensions=M.dimensions;if(M.index!==-1){var O=s.billboard;var R=e._spareBillboards;if(!i(O)){if(R.length>0){O=R.pop()}else{O=e._billboardCollection.add({collection:e})}s.billboard=O}O.show=t._show;O.position=t._position;O.eyeOffset=t._eyeOffset;O.pixelOffset=t._pixelOffset;O.horizontalOrigin=d.LEFT;O.verticalOrigin=t._verticalOrigin;O.heightReference=t._heightReference;O.scale=t._scale;O.pickPrimitive=t;O.id=t._id;O.image=D;O.translucencyByDistance=t._translucencyByDistance;O.pixelOffsetScaleByDistance=t._pixelOffsetScaleByDistance;O.scaleByDistance=t._scaleByDistance;O.distanceDisplayCondition=t._distanceDisplayCondition}}t._repositionAllGlyphs=true}function P(e,t,r){if(t===d.CENTER){return-e/2}else if(t===d.RIGHT){return-(e+r.x)}return r.x}var D=new t;var M=new t;function I(e,r){var n=e._glyphs;var a=e._text;var o;var s;var u=0;var l=0;var c=[];var f=Number.NEGATIVE_INFINITY;var h=0;var p=1;var v=0;var _=n.length;var y=e._backgroundBillboard;var w=M;t.clone(i(y)?e._backgroundPadding:t.ZERO,w);for(v=0;v<_;++v){if(a.charAt(v)==="\n"){c.push(u);++p;u=0}else{o=n[v];s=o.dimensions;h=Math.max(h,s.height-s.descent);f=Math.max(f,s.descent);u+=s.width-s.bounds.minx;if(v<_-1){u+=n[v+1].dimensions.bounds.minx}l=Math.max(l,u)}}c.push(u);var C=h+f;var b=e._scale;var S=e._horizontalOrigin;var E=e._verticalOrigin;var T=0;var x=c[T];var A=P(x,S,w);var I=g*C;var O=I*(p-1);D.x=A*b*r;D.y=0;var R=0;for(v=0;v<_;++v){if(a.charAt(v)==="\n"){++T;R+=I;x=c[T];A=P(x,S,w);D.x=A*b*r}else{o=n[v];s=o.dimensions;if(E===m.TOP){D.y=s.height-h-w.y}else if(E===m.CENTER){D.y=(O+s.height-h)/2}else if(E===m.BASELINE){D.y=O}else{D.y=O+f+w.y}D.y=(D.y-s.descent-R)*b*r;if(i(o.billboard)){o.billboard._setTranslate(D)}if(v<_-1){var N=n[v+1];D.x+=(s.width-s.bounds.minx+N.dimensions.bounds.minx)*b*r}}}if(i(y)&&a.split("\n").join("").length>0){if(S===d.CENTER){A=-l/2-w.x}else if(S===d.RIGHT){A=-(l+w.x*2)}else{A=0}D.x=A*b*r;if(E===m.TOP){D.y=C-h-f}else if(E===m.CENTER){D.y=(C-h)/2-f}else if(E===m.BASELINE){D.y=-w.y-f}else{D.y=0}D.y=D.y*b*r;y.width=l+w.x*2;y.height=C+O+w.y*2;y._setTranslate(D)}}function O(e,t){var r=t._glyphs;for(var n=0,o=r.length;n<o;++n){T(e,r[n])}if(i(t._backgroundBillboard)){e._backgroundBillboardCollection.remove(t._backgroundBillboard);t._backgroundBillboard=undefined}t._labelCollection=undefined;if(i(t._removeCallbackFunc)){t._removeCallbackFunc()}a(t)}function R(e){e=r(e,r.EMPTY_OBJECT);this._scene=e.scene;this._textureAtlas=undefined;this._backgroundTextureAtlas=undefined;this._whitePixelIndex=undefined;this._backgroundBillboardCollection=new l({scene:this._scene});this._backgroundBillboardCollection.destroyTextureAtlas=false;this._billboardCollection=new l({scene:this._scene});this._billboardCollection.destroyTextureAtlas=false;this._spareBillboards=[];this._glyphTextureCache={};this._labels=[];this._labelsToUpdate=[];this._totalGlyphCount=0;this._resolutionScale=undefined;this.modelMatrix=s.clone(r(e.modelMatrix,s.IDENTITY));this.debugShowBoundingVolume=r(e.debugShowBoundingVolume,false);this.blendOption=r(e.blendOption,c.OPAQUE_AND_TRANSLUCENT)}n(R.prototype,{length:{get:function(){return this._labels.length}}});R.prototype.add=function(e){var t=new f(e,this);this._labels.push(t);this._labelsToUpdate.push(t);return t};R.prototype.remove=function(e){if(i(e)&&e._labelCollection===this){var t=this._labels.indexOf(e);if(t!==-1){this._labels.splice(t,1);O(this,e);return true}}return false};R.prototype.removeAll=function(){var e=this._labels;for(var t=0,r=e.length;t<r;++t){O(this,e[t])}e.length=0};R.prototype.contains=function(e){return i(e)&&e._labelCollection===this};R.prototype.get=function(e){if(!i(e)){throw new o("index is required.")}return this._labels[e]};R.prototype.update=function(e){var t=this._billboardCollection;var r=this._backgroundBillboardCollection;t.modelMatrix=this.modelMatrix;t.debugShowBoundingVolume=this.debugShowBoundingVolume;r.modelMatrix=this.modelMatrix;r.debugShowBoundingVolume=this.debugShowBoundingVolume;var n=e.context;if(!i(this._textureAtlas)){this._textureAtlas=new p({context:n});t.textureAtlas=this._textureAtlas}if(!i(this._backgroundTextureAtlas)){this._backgroundTextureAtlas=new p({context:n,initialSize:w});r.textureAtlas=this._backgroundTextureAtlas;b(this._backgroundTextureAtlas,this)}var a=n.uniformState;var o=a.resolutionScale;var s=this._resolutionScale!==o;this._resolutionScale=o;var u;if(s){u=this._labels}else{u=this._labelsToUpdate}var l=u.length;for(var d=0;d<l;++d){var f=u[d];if(f.isDestroyed()){continue}var h=f._glyphs.length;if(f._rebindAllGlyphs){A(this,f);f._rebindAllGlyphs=false}if(s||f._repositionAllGlyphs){I(f,o);f._repositionAllGlyphs=false}var m=f._glyphs.length-h;this._totalGlyphCount+=m}var v=r.length>0?c.TRANSLUCENT:this.blendOption;t.blendOption=v;r.blendOption=v;this._labelsToUpdate.length=0;r.update(e);t.update(e)};R.prototype.isDestroyed=function(){return false};R.prototype.destroy=function(){this.removeAll();this._billboardCollection=this._billboardCollection.destroy();this._textureAtlas=this._textureAtlas&&this._textureAtlas.destroy();this._backgroundBillboardCollection=this._backgroundBillboardCollection.destroy();this._backgroundTextureAtlas=this._backgroundTextureAtlas&&this._backgroundTextureAtlas.destroy();return a(this)};return R});define("Scene/PointPrimitive",["../Core/BoundingRectangle","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/Matrix4","../Core/NearFarScalar","./SceneMode","./SceneTransforms"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h){"use strict";function p(e,t){e=a(e,a.EMPTY_OBJECT);if(o(e.scaleByDistance)&&e.scaleByDistance.far<=e.scaleByDistance.near){throw new u("scaleByDistance.far must be greater than scaleByDistance.near.")}if(o(e.translucencyByDistance)&&e.translucencyByDistance.far<=e.translucencyByDistance.near){throw new u("translucencyByDistance.far must be greater than translucencyByDistance.near.")}if(o(e.distanceDisplayCondition)&&e.distanceDisplayCondition.far<=e.distanceDisplayCondition.near){throw new u("distanceDisplayCondition.far must be greater than distanceDisplayCondition.near")}this._show=a(e.show,true);this._position=r.clone(a(e.position,r.ZERO));this._actualPosition=r.clone(this._position);this._color=n.clone(a(e.color,n.WHITE));this._outlineColor=n.clone(a(e.outlineColor,n.TRANSPARENT));this._outlineWidth=a(e.outlineWidth,0);this._pixelSize=a(e.pixelSize,10);this._scaleByDistance=e.scaleByDistance;this._translucencyByDistance=e.translucencyByDistance;this._distanceDisplayCondition=e.distanceDisplayCondition;this._id=e.id;this._collection=a(e.collection,t);this._clusterShow=true;this._pickId=undefined;this._pointPrimitiveCollection=t;this._dirty=false;this._index=-1}var m=p.SHOW_INDEX=0;var v=p.POSITION_INDEX=1;var _=p.COLOR_INDEX=2;var g=p.OUTLINE_COLOR_INDEX=3;var y=p.OUTLINE_WIDTH_INDEX=4;var w=p.PIXEL_SIZE_INDEX=5;var C=p.SCALE_BY_DISTANCE_INDEX=6;var b=p.TRANSLUCENCY_BY_DISTANCE_INDEX=7;var S=p.DISTANCE_DISPLAY_CONDITION=8;p.NUMBER_OF_PROPERTIES=9;function E(e,t){var r=e._pointPrimitiveCollection;if(o(r)){r._updatePointPrimitive(e,t);e._dirty=true}}s(p.prototype,{show:{get:function(){return this._show},set:function(e){if(!o(e)){throw new u("value is required.")}if(this._show!==e){this._show=e;E(this,m)}}},position:{get:function(){return this._position},set:function(e){if(!o(e)){throw new u("value is required.")}var t=this._position;if(!r.equals(t,e)){r.clone(e,t);r.clone(e,this._actualPosition);E(this,v)}}},scaleByDistance:{get:function(){return this._scaleByDistance},set:function(e){if(o(e)&&e.far<=e.near){throw new u("far distance must be greater than near distance.")}var t=this._scaleByDistance;if(!d.equals(t,e)){this._scaleByDistance=d.clone(e,t);E(this,C)}}},translucencyByDistance:{get:function(){return this._translucencyByDistance},set:function(e){if(o(e)&&e.far<=e.near){throw new u("far distance must be greater than near distance.")}var t=this._translucencyByDistance;if(!d.equals(t,e)){this._translucencyByDistance=d.clone(e,t);E(this,b)}}},pixelSize:{get:function(){return this._pixelSize},set:function(e){if(!o(e)){throw new u("value is required.")}if(this._pixelSize!==e){this._pixelSize=e;E(this,w)}}},color:{get:function(){return this._color},set:function(e){if(!o(e)){throw new u("value is required.")}var t=this._color;if(!n.equals(t,e)){n.clone(e,t);E(this,_)}}},outlineColor:{get:function(){return this._outlineColor},set:function(e){if(!o(e)){throw new u("value is required.")}var t=this._outlineColor;if(!n.equals(t,e)){n.clone(e,t);E(this,g)}}},outlineWidth:{get:function(){return this._outlineWidth},set:function(e){if(!o(e)){throw new u("value is required.")}if(this._outlineWidth!==e){this._outlineWidth=e;E(this,y)}}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){if(o(e)&&e.far<=e.near){throw new u("far must be greater than near")}if(!l.equals(this._distanceDisplayCondition,e)){this._distanceDisplayCondition=l.clone(e,this._distanceDisplayCondition);E(this,S)}}},id:{get:function(){return this._id},set:function(e){this._id=e;if(o(this._pickId)){this._pickId.object.id=e}}},clusterShow:{get:function(){return this._clusterShow},set:function(e){if(this._clusterShow!==e){this._clusterShow=e;E(this,m)}}}});p.prototype.getPickId=function(e){if(!o(this._pickId)){this._pickId=e.createPickId({primitive:this,collection:this._collection,id:this._id})}return this._pickId};p.prototype._getActualPosition=function(){return this._actualPosition};p.prototype._setActualPosition=function(e){r.clone(e,this._actualPosition);E(this,v)};var T=new i;p._computeActualPosition=function(e,t,r){if(t.mode===f.SCENE3D){return e}c.multiplyByPoint(r,e,T);return h.computeActualWgs84Position(t,T)};var x=new i;p._computeScreenSpacePosition=function(e,t,r,n){var a=c.multiplyByVector(e,i.fromElements(t.x,t.y,t.z,1,x),x);var o=h.wgs84ToWindowCoordinates(r,a,n);return o};p.prototype.computeScreenSpacePosition=function(e,r){var i=this._pointPrimitiveCollection;if(!o(r)){r=new t}if(!o(i)){throw new u("PointPrimitive must be in a collection.")}if(!o(e)){throw new u("scene is required.")}var n=i.modelMatrix;var a=p._computeScreenSpacePosition(n,this._actualPosition,e,r);if(!o(a)){return undefined}a.y=e.canvas.clientHeight-a.y;return a};p.getScreenSpaceBoundingBox=function(t,r,i){var n=t.pixelSize;var a=n*.5;var s=r.x-a;var u=r.y-a;var l=n;var c=n;if(!o(i)){i=new e}i.x=s;i.y=u;i.width=l;i.height=c;return i};p.prototype.equals=function(e){return this===e||o(e)&&this._id===e._id&&r.equals(this._position,e._position)&&n.equals(this._color,e._color)&&this._pixelSize===e._pixelSize&&this._outlineWidth===e._outlineWidth&&this._show===e._show&&n.equals(this._outlineColor,e._outlineColor)&&d.equals(this._scaleByDistance,e._scaleByDistance)&&d.equals(this._translucencyByDistance,e._translucencyByDistance)&&l.equals(this._distanceDisplayCondition,e._distanceDisplayCondition)};p.prototype._destroy=function(){this._pickId=this._pickId&&this._pickId.destroy();this._pointPrimitiveCollection=undefined};return p});define("Shaders/PointPrimitiveCollectionFS",[],function(){"use strict";return"varying vec4 v_color;\nvarying vec4 v_outlineColor;\nvarying float v_innerPercent;\nvarying float v_pixelDistance;\n#ifdef RENDER_FOR_PICK\nvarying vec4 v_pickColor;\n#endif\nvoid main()\n{\nfloat distanceToCenter = length(gl_PointCoord - vec2(0.5));\nfloat maxDistance = max(0.0, 0.5 - v_pixelDistance);\nfloat wholeAlpha = 1.0 - smoothstep(maxDistance, 0.5, distanceToCenter);\nfloat innerAlpha = 1.0 - smoothstep(maxDistance * v_innerPercent, 0.5 * v_innerPercent, distanceToCenter);\nvec4 color = mix(v_outlineColor, v_color, innerAlpha);\ncolor.a *= wholeAlpha;\n#if defined(RENDER_FOR_PICK) || (!defined(OPAQUE) && !defined(TRANSLUCENT))\nif (color.a < 0.005)\n{\ndiscard;\n}\n#else\n#ifdef OPAQUE\nif (color.a < 0.995)\n{\ndiscard;\n}\n#else\nif (color.a >= 0.995)\n{\ndiscard;\n}\n#endif\n#endif\n#ifdef RENDER_FOR_PICK\ngl_FragColor = v_pickColor;\n#else\ngl_FragColor = color;\n#endif\n}\n"});define("Shaders/PointPrimitiveCollectionVS",[],function(){"use strict";return"uniform float u_maxTotalPointSize;\nattribute vec4 positionHighAndSize;\nattribute vec4 positionLowAndOutline;\nattribute vec4 compressedAttribute0;\nattribute vec4 compressedAttribute1;\nattribute vec4 scaleByDistance;\nattribute vec2 distanceDisplayCondition;\nvarying vec4 v_color;\nvarying vec4 v_outlineColor;\nvarying float v_innerPercent;\nvarying float v_pixelDistance;\n#ifdef RENDER_FOR_PICK\nvarying vec4 v_pickColor;\n#endif\nconst float SHIFT_LEFT8 = 256.0;\nconst float SHIFT_RIGHT8 = 1.0 / 256.0;\nvoid main()\n{\nvec3 positionHigh = positionHighAndSize.xyz;\nvec3 positionLow = positionLowAndOutline.xyz;\nfloat outlineWidthBothSides = 2.0 * positionLowAndOutline.w;\nfloat totalSize = positionHighAndSize.w + outlineWidthBothSides;\nfloat outlinePercent = outlineWidthBothSides / totalSize;\ntotalSize *= czm_resolutionScale;\ntotalSize += 3.0;\nfloat temp = compressedAttribute1.x * SHIFT_RIGHT8;\nfloat show = floor(temp);\n#ifdef EYE_DISTANCE_TRANSLUCENCY\nvec4 translucencyByDistance;\ntranslucencyByDistance.x = compressedAttribute1.z;\ntranslucencyByDistance.z = compressedAttribute1.w;\ntranslucencyByDistance.y = ((temp - floor(temp)) * SHIFT_LEFT8) / 255.0;\ntemp = compressedAttribute1.y * SHIFT_RIGHT8;\ntranslucencyByDistance.w = ((temp - floor(temp)) * SHIFT_LEFT8) / 255.0;\n#endif\nvec4 color;\nvec4 outlineColor;\n#ifdef RENDER_FOR_PICK\ncolor = vec4(0.0);\noutlineColor = vec4(0.0);\nvec4 pickColor;\ntemp = compressedAttribute0.z * SHIFT_RIGHT8;\npickColor.b = (temp - floor(temp)) * SHIFT_LEFT8;\ntemp = floor(temp) * SHIFT_RIGHT8;\npickColor.g = (temp - floor(temp)) * SHIFT_LEFT8;\npickColor.r = floor(temp);\n#else\ntemp = compressedAttribute0.x * SHIFT_RIGHT8;\ncolor.b = (temp - floor(temp)) * SHIFT_LEFT8;\ntemp = floor(temp) * SHIFT_RIGHT8;\ncolor.g = (temp - floor(temp)) * SHIFT_LEFT8;\ncolor.r = floor(temp);\ntemp = compressedAttribute0.y * SHIFT_RIGHT8;\noutlineColor.b = (temp - floor(temp)) * SHIFT_LEFT8;\ntemp = floor(temp) * SHIFT_RIGHT8;\noutlineColor.g = (temp - floor(temp)) * SHIFT_LEFT8;\noutlineColor.r = floor(temp);\n#endif\ntemp = compressedAttribute0.w * SHIFT_RIGHT8;\n#ifdef RENDER_FOR_PICK\npickColor.a = (temp - floor(temp)) * SHIFT_LEFT8;\npickColor = pickColor / 255.0;\n#endif\ntemp = floor(temp) * SHIFT_RIGHT8;\noutlineColor.a = (temp - floor(temp)) * SHIFT_LEFT8;\noutlineColor /= 255.0;\ncolor.a = floor(temp);\ncolor /= 255.0;\nvec4 p = czm_translateRelativeToEye(positionHigh, positionLow);\nvec4 positionEC = czm_modelViewRelativeToEye * p;\npositionEC.xyz *= show;\n#if defined(EYE_DISTANCE_SCALING) || defined(EYE_DISTANCE_TRANSLUCENCY) || defined(DISTANCE_DISPLAY_CONDITION)\nfloat lengthSq;\nif (czm_sceneMode == czm_sceneMode2D)\n{\nlengthSq = czm_eyeHeight2D.y;\n}\nelse\n{\nlengthSq = dot(positionEC.xyz, positionEC.xyz);\n}\n#endif\n#ifdef EYE_DISTANCE_SCALING\ntotalSize *= czm_nearFarScalar(scaleByDistance, lengthSq);\n#endif\ntotalSize = min(totalSize, u_maxTotalPointSize);\nif (totalSize < 1.0)\n{\npositionEC.xyz = vec3(0.0);\ntotalSize = 1.0;\n}\nfloat translucency = 1.0;\n#ifdef EYE_DISTANCE_TRANSLUCENCY\ntranslucency = czm_nearFarScalar(translucencyByDistance, lengthSq);\nif (translucency < 0.004)\n{\npositionEC.xyz = vec3(0.0);\n}\n#endif\n#ifdef DISTANCE_DISPLAY_CONDITION\nfloat nearSq = distanceDisplayCondition.x * distanceDisplayCondition.x;\nfloat farSq = distanceDisplayCondition.y * distanceDisplayCondition.y;\nif (lengthSq < nearSq || lengthSq > farSq) {\npositionEC.xyz = vec3(0.0);\n}\n#endif\nvec4 positionWC = czm_eyeToWindowCoordinates(positionEC);\ngl_Position = czm_viewportOrthographic * vec4(positionWC.xy, -positionWC.z, 1.0);\nv_color = color;\nv_color.a *= translucency;\nv_outlineColor = outlineColor;\nv_outlineColor.a *= translucency;\nv_innerPercent = 1.0 - outlinePercent;\nv_pixelDistance = 2.0 / totalSize;\ngl_PointSize = totalSize;\n#ifdef RENDER_FOR_PICK\nv_pickColor = pickColor;\n#endif\n}\n"});define("Scene/PointPrimitiveCollection",["../Core/BoundingSphere","../Core/Color","../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/EncodedCartesian3","../Core/Math","../Core/Matrix4","../Core/PrimitiveType","../Core/WebGLConstants","../Renderer/BufferUsage","../Renderer/ContextLimits","../Renderer/DrawCommand","../Renderer/Pass","../Renderer/RenderState","../Renderer/ShaderProgram","../Renderer/ShaderSource","../Renderer/VertexArrayFacade","../Shaders/PointPrimitiveCollectionFS","../Shaders/PointPrimitiveCollectionVS","./BlendingState","./BlendOption","./PointPrimitive","./SceneMode"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w,C,b,S,E,T,x){"use strict";var A=T.SHOW_INDEX;var P=T.POSITION_INDEX;var D=T.COLOR_INDEX;var M=T.OUTLINE_COLOR_INDEX;var I=T.OUTLINE_WIDTH_INDEX;var O=T.PIXEL_SIZE_INDEX;var R=T.SCALE_BY_DISTANCE_INDEX;var N=T.TRANSLUCENCY_BY_DISTANCE_INDEX;var L=T.DISTANCE_DISPLAY_CONDITION_INDEX;var B=T.NUMBER_OF_PROPERTIES;var F={positionHighAndSize:0,positionLowAndOutline:1,compressedAttribute0:2,compressedAttribute1:3,scaleByDistance:4,distanceDisplayCondition:5};function k(t){t=i(t,i.EMPTY_OBJECT);this._sp=undefined;this._spTranslucent=undefined;this._spPick=undefined;this._rsOpaque=undefined;this._rsTranslucent=undefined;this._vaf=undefined;this._pointPrimitives=[];this._pointPrimitivesToUpdate=[];this._pointPrimitivesToUpdateIndex=0;this._pointPrimitivesRemoved=false;this._createVertexArray=false;this._shaderScaleByDistance=false;this._compiledShaderScaleByDistance=false;this._compiledShaderScaleByDistancePick=false;this._shaderTranslucencyByDistance=false;this._compiledShaderTranslucencyByDistance=false;this._compiledShaderTranslucencyByDistancePick=false;this._shaderDistanceDisplayCondition=false;this._compiledShaderDistanceDisplayCondition=false;this._compiledShaderDistanceDisplayConditionPick=false;this._propertiesChanged=new Uint32Array(B);this._maxPixelSize=1;this._baseVolume=new e;this._baseVolumeWC=new e;this._baseVolume2D=new e;this._boundingVolume=new e;this._boundingVolumeDirty=false;this._colorCommands=[];this._pickCommands=[];this.modelMatrix=c.clone(i(t.modelMatrix,c.IDENTITY));this._modelMatrix=c.clone(c.IDENTITY);this.debugShowBoundingVolume=i(t.debugShowBoundingVolume,false);this.blendOption=i(t.blendOption,E.OPAQUE_AND_TRANSLUCENT);this._blendOption=undefined;this._mode=x.SCENE3D;this._maxTotalPointSize=1;this._buffersUsage=[h.STATIC_DRAW,h.STATIC_DRAW,h.STATIC_DRAW,h.STATIC_DRAW,h.STATIC_DRAW,h.STATIC_DRAW,h.STATIC_DRAW,h.STATIC_DRAW,h.STATIC_DRAW];var r=this;this._uniforms={u_maxTotalPointSize:function(){return r._maxTotalPointSize}}}a(k.prototype,{length:{get:function(){z(this);return this._pointPrimitives.length}}});function V(e){var t=e.length;for(var r=0;r<t;++r){if(e[r]){e[r]._destroy()}}}k.prototype.add=function(e){var t=new T(e,this);t._index=this._pointPrimitives.length;this._pointPrimitives.push(t);this._createVertexArray=true;return t};k.prototype.remove=function(e){if(this.contains(e)){this._pointPrimitives[e._index]=null;this._pointPrimitivesRemoved=true;this._createVertexArray=true;e._destroy();return true}return false};k.prototype.removeAll=function(){V(this._pointPrimitives);this._pointPrimitives=[];this._pointPrimitivesToUpdate=[];this._pointPrimitivesToUpdateIndex=0;this._pointPrimitivesRemoved=false;this._createVertexArray=true};function z(e){if(e._pointPrimitivesRemoved){e._pointPrimitivesRemoved=false;var t=[];var r=e._pointPrimitives;var i=r.length;for(var n=0,a=0;n<i;++n){var o=r[n];if(o){o._index=a++;t.push(o)}}e._pointPrimitives=t}}k.prototype._updatePointPrimitive=function(e,t){if(!e._dirty){this._pointPrimitivesToUpdate[this._pointPrimitivesToUpdateIndex++]=e}++this._propertiesChanged[t]};k.prototype.contains=function(e){return n(e)&&e._pointPrimitiveCollection===this};k.prototype.get=function(e){if(!n(e)){throw new s("index is required.")}z(this);return this._pointPrimitives[e]};k.prototype.computeNewBuffersUsage=function(){var e=this._buffersUsage;var t=false;var r=this._propertiesChanged;for(var i=0;i<B;++i){var n=r[i]===0?h.STATIC_DRAW:h.STREAM_DRAW;t=t||e[i]!==n;e[i]=n}return t};function U(e,t,i){return new w(e,[{index:F.positionHighAndSize,componentsPerAttribute:4,componentDatatype:r.FLOAT,usage:i[P]},{index:F.positionLowAndShow,componentsPerAttribute:4,componentDatatype:r.FLOAT,usage:i[P]},{index:F.compressedAttribute0,componentsPerAttribute:4,componentDatatype:r.FLOAT,usage:i[D]},{index:F.compressedAttribute1,componentsPerAttribute:4,componentDatatype:r.FLOAT,usage:i[N]},{index:F.scaleByDistance,componentsPerAttribute:4,componentDatatype:r.FLOAT,usage:i[R]},{index:F.distanceDisplayCondition,componentsPerAttribute:2,componentDatatype:r.FLOAT,usage:i[L]}],t)}var q=new u;function G(t,r,i,n){var a=n._index;var o=n._getActualPosition();if(t._mode===x.SCENE3D){e.expand(t._baseVolume,o,t._baseVolume);t._boundingVolumeDirty=true}u.fromCartesian(o,q);var s=n.pixelSize;var l=n.outlineWidth;t._maxPixelSize=Math.max(t._maxPixelSize,s+l);var c=i[F.positionHighAndSize];var d=q.high;c(a,d.x,d.y,d.z,s);var f=i[F.positionLowAndOutline];var h=q.low;f(a,h.x,h.y,h.z,l)}var H=65536;var W=256;function j(e,r,i,n){var a=n._index;var o=n.color;var s=n.getPickId(r).color;var u=n.outlineColor;var l=t.floatToByte(o.red);var c=t.floatToByte(o.green);var d=t.floatToByte(o.blue);var f=l*H+c*W+d;l=t.floatToByte(u.red);c=t.floatToByte(u.green);d=t.floatToByte(u.blue);var h=l*H+c*W+d;l=t.floatToByte(s.red);c=t.floatToByte(s.green);d=t.floatToByte(s.blue);var p=l*H+c*W+d;var m=t.floatToByte(o.alpha)*H+t.floatToByte(u.alpha)*W+t.floatToByte(s.alpha);var v=i[F.compressedAttribute0];v(a,f,h,p,m)}function Y(e,t,r,i){var a=i._index;var o=0;var s=1;var u=1;var c=1;var d=i.translucencyByDistance;if(n(d)){o=d.near;s=d.nearValue;u=d.far;c=d.farValue;if(s!==1||c!==1){e._shaderTranslucencyByDistance=true}}var f=i.show&&i.clusterShow;if(i.color.alpha===0&&i.outlineColor.alpha===0){f=false}s=l.clamp(s,0,1);s=s===1?255:s*255|0;var h=(f?1:0)*W+s;c=l.clamp(c,0,1);c=c===1?255:c*255|0;var p=c;var m=r[F.compressedAttribute1];m(a,h,p,o,u)}function X(e,t,r,i){var a=i._index;var o=r[F.scaleByDistance];var s=0;var u=1;var l=1;var c=1;var d=i.scaleByDistance;if(n(d)){s=d.near;u=d.nearValue;l=d.far;c=d.farValue;if(u!==1||c!==1){e._shaderScaleByDistance=true}}o(a,s,u,l,c)}function Z(e,t,r,i){var a=i._index;var o=r[F.distanceDisplayCondition];var s=0;var u=Number.MAX_VALUE;var l=i.distanceDisplayCondition;if(n(l)){s=l.near;u=l.far;e._shaderDistanceDisplayCondition=true}o(a,s,u)}function K(e,t,r,i){G(e,t,r,i);j(e,t,r,i);Y(e,t,r,i);X(e,t,r,i);Z(e,t,r,i)}function Q(t,r,i,a,o,s){var u;if(a.mode===x.SCENE3D){u=t._baseVolume;t._boundingVolumeDirty=true}else{u=t._baseVolume2D}var l=[];for(var c=0;c<i;++c){var d=r[c];var f=d.position;var h=T._computeActualPosition(f,a,o);if(n(h)){d._setActualPosition(h);if(s){l.push(h)}else{e.expand(u,h,u)}}}if(s){e.fromPoints(l,u)}}function J(e,t){var r=t.mode;var i=e._pointPrimitives;var n=e._pointPrimitivesToUpdate;var a=e._modelMatrix;if(e._createVertexArray||e._mode!==r||r!==x.SCENE3D&&!c.equals(a,e.modelMatrix)){e._mode=r;c.clone(e.modelMatrix,a);e._createVertexArray=true;if(r===x.SCENE3D||r===x.SCENE2D||r===x.COLUMBUS_VIEW){Q(e,i,i.length,t,a,true)}}else if(r===x.MORPHING){Q(e,i,i.length,t,a,true)}else if(r===x.SCENE2D||r===x.COLUMBUS_VIEW){Q(e,n,e._pointPrimitivesToUpdateIndex,t,a,false)}}function $(e,t,r){var i=t.camera.getPixelSize(r,t.context.drawingBufferWidth,t.context.drawingBufferHeight);var n=i*e._maxPixelSize;r.radius+=n}var ee=[];k.prototype.update=function(t){z(this);this._maxTotalPointSize=p.maximumAliasedPointSize;J(this,t);var r=this._pointPrimitives;var i=r.length;var a=this._pointPrimitivesToUpdate;var o=this._pointPrimitivesToUpdateIndex;var s=this._propertiesChanged;var u=this._createVertexArray;var l;var h=t.context;var w=t.passes;var T=w.pick;if(u||!T&&this.computeNewBuffersUsage()){this._createVertexArray=false;for(var k=0;k<B;++k){s[k]=0}this._vaf=this._vaf&&this._vaf.destroy();if(i>0){this._vaf=U(h,i,this._buffersUsage);l=this._vaf.writers;for(var V=0;V<i;++V){var q=this._pointPrimitives[V];q._dirty=false;K(this,h,l,q)}this._vaf.commit()}
this._pointPrimitivesToUpdateIndex=0}else{if(o>0){var H=ee;H.length=0;if(s[P]||s[I]||s[O]){H.push(G)}if(s[D]||s[M]){H.push(j)}if(s[A]||s[N]){H.push(Y)}if(s[R]){H.push(X)}if(s[L]){H.push(Z)}var W=H.length;l=this._vaf.writers;if(o/i>.1){for(var Q=0;Q<o;++Q){var te=a[Q];te._dirty=false;for(var re=0;re<W;++re){H[re](this,h,l,te)}}this._vaf.commit()}else{for(var ie=0;ie<o;++ie){var ne=a[ie];ne._dirty=false;for(var ae=0;ae<W;++ae){H[ae](this,h,l,ne)}this._vaf.subCommit(ne._index,1)}this._vaf.endSubCommits()}this._pointPrimitivesToUpdateIndex=0}}if(o>i*1.5){a.length=i}if(!n(this._vaf)||!n(this._vaf.va)){return}if(this._boundingVolumeDirty){this._boundingVolumeDirty=false;e.transform(this._baseVolume,this.modelMatrix,this._baseVolumeWC)}var oe;var se=c.IDENTITY;if(t.mode===x.SCENE3D){se=this.modelMatrix;oe=e.clone(this._baseVolumeWC,this._boundingVolume)}else{oe=e.clone(this._baseVolume2D,this._boundingVolume)}$(this,t,oe);var ue=this._blendOption!==this.blendOption;this._blendOption=this.blendOption;if(ue){if(this._blendOption===E.OPAQUE||this._blendOption===E.OPAQUE_AND_TRANSLUCENT){this._rsOpaque=_.fromCache({depthTest:{enabled:true,func:f.LEQUAL},depthMask:true})}else{this._rsOpaque=undefined}if(this._blendOption===E.TRANSLUCENT||this._blendOption===E.OPAQUE_AND_TRANSLUCENT){this._rsTranslucent=_.fromCache({depthTest:{enabled:true,func:f.LEQUAL},depthMask:false,blending:S.ALPHA_BLEND})}else{this._rsTranslucent=undefined}}if(ue||this._shaderScaleByDistance&&!this._compiledShaderScaleByDistance||this._shaderTranslucencyByDistance&&!this._compiledShaderTranslucencyByDistance||this._shaderDistanceDisplayCondition&&!this._compiledShaderDistanceDisplayCondition){he=new y({sources:[b]});if(this._shaderScaleByDistance){he.defines.push("EYE_DISTANCE_SCALING")}if(this._shaderTranslucencyByDistance){he.defines.push("EYE_DISTANCE_TRANSLUCENCY")}if(this._shaderDistanceDisplayCondition){he.defines.push("DISTANCE_DISPLAY_CONDITION")}if(this._blendOption===E.OPAQUE_AND_TRANSLUCENT){pe=new y({defines:["OPAQUE"],sources:[C]});this._sp=g.replaceCache({context:h,shaderProgram:this._sp,vertexShaderSource:he,fragmentShaderSource:pe,attributeLocations:F});pe=new y({defines:["TRANSLUCENT"],sources:[C]});this._spTranslucent=g.replaceCache({context:h,shaderProgram:this._spTranslucent,vertexShaderSource:he,fragmentShaderSource:pe,attributeLocations:F})}if(this._blendOption===E.OPAQUE){pe=new y({sources:[C]});this._sp=g.replaceCache({context:h,shaderProgram:this._sp,vertexShaderSource:he,fragmentShaderSource:pe,attributeLocations:F})}if(this._blendOption===E.TRANSLUCENT){pe=new y({sources:[C]});this._spTranslucent=g.replaceCache({context:h,shaderProgram:this._spTranslucent,vertexShaderSource:he,fragmentShaderSource:pe,attributeLocations:F})}this._compiledShaderScaleByDistance=this._shaderScaleByDistance;this._compiledShaderTranslucencyByDistance=this._shaderTranslucencyByDistance;this._compiledShaderDistanceDisplayCondition=this._shaderDistanceDisplayCondition}if(!n(this._spPick)||this._shaderScaleByDistance&&!this._compiledShaderScaleByDistancePick||this._shaderTranslucencyByDistance&&!this._compiledShaderTranslucencyByDistancePick||this._shaderDistanceDisplayCondition&&!this._compiledShaderDistanceDisplayConditionPick){he=new y({defines:["RENDER_FOR_PICK"],sources:[b]});if(this._shaderScaleByDistance){he.defines.push("EYE_DISTANCE_SCALING")}if(this._shaderTranslucencyByDistance){he.defines.push("EYE_DISTANCE_TRANSLUCENCY")}if(this._shaderDistanceDisplayCondition){he.defines.push("DISTANCE_DISPLAY_CONDITION")}pe=new y({defines:["RENDER_FOR_PICK"],sources:[C]});this._spPick=g.replaceCache({context:h,shaderProgram:this._spPick,vertexShaderSource:he,fragmentShaderSource:pe,attributeLocations:F});this._compiledShaderScaleByDistancePick=this._shaderScaleByDistance;this._compiledShaderTranslucencyByDistancePick=this._shaderTranslucencyByDistance;this._compiledShaderDistanceDisplayConditionPick=this._shaderDistanceDisplayCondition}var le;var ce;var de;var fe;var he;var pe;var me=t.commandList;if(w.render){var ve=this._colorCommands;var _e=this._blendOption===E.OPAQUE;var ge=this._blendOption===E.OPAQUE_AND_TRANSLUCENT;le=this._vaf.va;ce=le.length;ve.length=ce;var ye=ge?ce*2:ce;for(fe=0;fe<ye;++fe){var we=_e||ge&&fe%2===0;de=ve[fe];if(!n(de)){de=ve[fe]=new m}de.primitiveType=d.POINTS;de.pass=we||!ge?v.OPAQUE:v.TRANSLUCENT;de.owner=this;var Ce=ge?Math.floor(fe/2):fe;de.boundingVolume=oe;de.modelMatrix=se;de.shaderProgram=we?this._sp:this._spTranslucent;de.uniformMap=this._uniforms;de.vertexArray=le[Ce].va;de.renderState=we?this._rsOpaque:this._rsTranslucent;de.debugShowBoundingVolume=this.debugShowBoundingVolume;me.push(de)}}if(T){var be=this._pickCommands;le=this._vaf.va;ce=le.length;be.length=ce;for(fe=0;fe<ce;++fe){de=be[fe];if(!n(de)){de=be[fe]=new m({primitiveType:d.POINTS,pass:v.OPAQUE,owner:this})}de.boundingVolume=oe;de.modelMatrix=se;de.shaderProgram=this._spPick;de.uniformMap=this._uniforms;de.vertexArray=le[fe].va;de.renderState=this._rsOpaque;me.push(de)}}};k.prototype.isDestroyed=function(){return false};k.prototype.destroy=function(){this._sp=this._sp&&this._sp.destroy();this._spTranslucent=this._spTranslucent&&this._spTranslucent.destroy();this._spPick=this._spPick&&this._spPick.destroy();this._vaf=this._vaf&&this._vaf.destroy();V(this._pointPrimitives);return o(this)};return k});define("ThirdParty/kdbush",[],function(){"use strict";function e(e,r,i,n,a){return new t(e,r,i,n,a)}function t(e,t,n,o,s){t=t||r;n=n||i;s=s||Array;this.nodeSize=o||64;this.points=e;this.ids=new s(e.length);this.coords=new s(e.length*2);for(var u=0;u<e.length;u++){this.ids[u]=u;this.coords[2*u]=t(e[u]);this.coords[2*u+1]=n(e[u])}a(this.ids,this.coords,this.nodeSize,0,this.ids.length-1,0)}t.prototype={range:function(e,t,r,i){return n(this.ids,this.coords,e,t,r,i,this.nodeSize)},within:function(e,t,r){return l(this.ids,this.coords,e,t,r,this.nodeSize)}};function r(e){return e[0]}function i(e){return e[1]}function n(e,t,r,i,n,a,o){var s=[0,e.length-1,0];var u=[];var l,c;while(s.length){var d=s.pop();var f=s.pop();var h=s.pop();if(f-h<=o){for(var p=h;p<=f;p++){l=t[2*p];c=t[2*p+1];if(l>=r&&l<=n&&c>=i&&c<=a)u.push(e[p])}continue}var m=Math.floor((h+f)/2);l=t[2*m];c=t[2*m+1];if(l>=r&&l<=n&&c>=i&&c<=a)u.push(e[m]);var v=(d+1)%2;if(d===0?r<=l:i<=c){s.push(h);s.push(m-1);s.push(v)}if(d===0?n>=l:a>=c){s.push(m+1);s.push(f);s.push(v)}}return u}function a(e,t,r,i,n,s){if(n-i<=r)return;var u=Math.floor((i+n)/2);o(e,t,u,i,n,s%2);a(e,t,r,i,u-1,s+1);a(e,t,r,u+1,n,s+1)}function o(e,t,r,i,n,a){while(n>i){if(n-i>600){var u=n-i+1;var l=r-i+1;var c=Math.log(u);var d=.5*Math.exp(2*c/3);var f=.5*Math.sqrt(c*d*(u-d)/u)*(l-u/2<0?-1:1);var h=Math.max(i,Math.floor(r-l*d/u+f));var p=Math.min(n,Math.floor(r+(u-l)*d/u+f));o(e,t,r,h,p,a)}var m=t[2*r+a];var v=i;var _=n;s(e,t,i,r);if(t[2*n+a]>m)s(e,t,i,n);while(v<_){s(e,t,v,_);v++;_--;while(t[2*v+a]<m)v++;while(t[2*_+a]>m)_--}if(t[2*i+a]===m)s(e,t,i,_);else{_++;s(e,t,_,n)}if(_<=r)i=_+1;if(r<=_)n=_-1}}function s(e,t,r,i){u(e,r,i);u(t,2*r,2*i);u(t,2*r+1,2*i+1)}function u(e,t,r){var i=e[t];e[t]=e[r];e[r]=i}function l(e,t,r,i,n,a){var o=[0,e.length-1,0];var s=[];var u=n*n;while(o.length){var l=o.pop();var d=o.pop();var f=o.pop();if(d-f<=a){for(var h=f;h<=d;h++){if(c(t[2*h],t[2*h+1],r,i)<=u)s.push(e[h])}continue}var p=Math.floor((f+d)/2);var m=t[2*p];var v=t[2*p+1];if(c(m,v,r,i)<=u)s.push(e[p]);var _=(l+1)%2;if(l===0?r-n<=m:i-n<=v){o.push(f);o.push(p-1);o.push(_)}if(l===0?r+n>=m:i+n>=v){o.push(p+1);o.push(d);o.push(_)}}return s}function c(e,t,r,i){var n=e-r;var a=t-i;return n*n+a*a}return e});define("DataSources/EntityCluster",["../Core/BoundingRectangle","../Core/Cartesian2","../Core/Cartesian3","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/EllipsoidalOccluder","../Core/Event","../Core/Matrix4","../Scene/Billboard","../Scene/BillboardCollection","../Scene/Label","../Scene/LabelCollection","../Scene/PointPrimitive","../Scene/PointPrimitiveCollection","../ThirdParty/kdbush"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m){"use strict";function v(e){e=i(e,i.EMPTY_OBJECT);this._enabled=i(e.enabled,false);this._pixelRange=i(e.pixelRange,80);this._minimumClusterSize=i(e.minimumClusterSize,2);this._clusterBillboards=i(e.clusterBillboards,true);this._clusterLabels=i(e.clusterLabels,true);this._clusterPoints=i(e.clusterPoints,true);this._labelCollection=undefined;this._billboardCollection=undefined;this._pointCollection=undefined;this._clusterBillboardCollection=undefined;this._clusterLabelCollection=undefined;this._clusterPointCollection=undefined;this._collectionIndicesByEntity={};this._unusedLabelIndices=[];this._unusedBillboardIndices=[];this._unusedPointIndices=[];this._previousClusters=[];this._previousHeight=undefined;this._enabledDirty=false;this._clusterDirty=false;this._cluster=undefined;this._removeEventListener=undefined;this._clusterEvent=new s}function _(e){return e.coord.x}function g(e){return e.coord.y}function y(e,t){e.x-=t;e.y-=t;e.width+=t*2;e.height+=t*2}var w=new e;function C(t,r,i,a,o){if(n(t._labelCollection)&&a._clusterLabels){o=d.getScreenSpaceBoundingBox(t,r,o)}else if(n(t._billboardCollection)&&a._clusterBillboards){o=l.getScreenSpaceBoundingBox(t,r,o)}else if(n(t._pointPrimitiveCollection)&&a._clusterPoints){o=h.getScreenSpaceBoundingBox(t,r,o)}y(o,i);if(a._clusterLabels&&!n(t._labelCollection)&&n(t.id)&&E(a,t.id)&&n(t.id._label)){var s=a._collectionIndicesByEntity[t.id];var u=a._labelCollection.get(s);var c=d.getScreenSpaceBoundingBox(u,r,w);y(c,i);o=e.union(o,c,o)}return o}function b(e,t){e.clusterShow=true;if(!n(e._labelCollection)&&n(e.id)&&E(t,e.id)&&n(e.id._label)){var r=t._collectionIndicesByEntity[e.id];var i=t._labelCollection.get(r);i.clusterShow=true}}function S(e,t,r,i){var n={billboard:i._clusterBillboardCollection.add(),label:i._clusterLabelCollection.add(),point:i._clusterPointCollection.add()};n.billboard.show=false;n.point.show=false;n.label.show=true;n.label.text=t.toLocaleString();n.billboard.position=n.label.position=n.point.position=e;i._clusterEvent.raiseEvent(r,n)}function E(e,t){return n(e)&&n(e._collectionIndicesByEntity[t])&&n(e._collectionIndicesByEntity[t].labelIndex)}function T(e,t,r,i,a){if(!n(e)){return}var o=e.length;for(var s=0;s<o;++s){var u=e.get(s);u.clusterShow=false;if(!u.show||!i.isPointVisible(u.position)){continue}var l=a._clusterLabels&&n(u._labelCollection);var c=a._clusterBillboards&&n(u.id._billboard);var d=a._clusterPoints&&n(u.id._point);if(l&&(d||c)){continue}var f=u.computeScreenSpacePosition(r);if(!n(f)){continue}t.push({index:s,collection:e,clustered:false,coord:f})}}var x=new e;var A=new e;var P=new e;function D(i){return function(a){if(n(a)&&a<.05||!i.enabled){return}var s=i._scene;var d=i._labelCollection;var h=i._billboardCollection;var v=i._pointCollection;if(!n(d)&&!n(h)&&!n(v)||!i._clusterBillboards&&!i._clusterLabels&&!i._clusterPoints){return}var y=i._clusterLabelCollection;var w=i._clusterBillboardCollection;var E=i._clusterPointCollection;if(n(y)){y.removeAll()}else{y=i._clusterLabelCollection=new f({scene:s})}if(n(w)){w.removeAll()}else{w=i._clusterBillboardCollection=new c({scene:s})}if(n(E)){E.removeAll()}else{E=i._clusterPointCollection=new p}var D=i._pixelRange;var M=i._minimumClusterSize;var I=i._previousClusters;var O=[];var R=i._previousHeight;var N=s.camera.positionCartographic.height;var L=s.mapProjection.ellipsoid;var B=s.camera.positionWC;var F=new o(L,B);var k=[];if(i._clusterLabels){T(d,k,s,F,i)}if(i._clusterBillboards){T(h,k,s,F,i)}if(i._clusterPoints){T(v,k,s,F,i)}var V;var z;var U;var q;var G;var H;var W;var j;var Y;var X;var Z;var K;var Q=m(k,_,g,64,Int32Array);if(N<R){U=I.length;for(V=0;V<U;++V){var J=I[V];if(!F.isPointVisible(J.position)){continue}var $=l._computeScreenSpacePosition(u.IDENTITY,J.position,r.ZERO,t.ZERO,s);if(!n($)){continue}var ee=1-N/R;var te=J.width=J.width*ee;var re=J.height=J.height*ee;te=Math.max(te,J.minimumWidth);re=Math.max(re,J.minimumHeight);var ie=$.x-te*.5;var ne=$.y-re*.5;var ae=$.x+te;var oe=$.y+re;G=Q.range(ie,ne,ae,oe);H=G.length;X=0;Y=[];for(z=0;z<H;++z){W=G[z];j=k[W];if(!j.clustered){++X;Z=j.collection;K=j.index;Y.push(Z.get(K).id)}}if(X>=M){S(J.position,X,Y,i);O.push(J);for(z=0;z<H;++z){k[G[z]].clustered=true}}}}U=k.length;for(V=0;V<U;++V){var se=k[V];if(se.clustered){continue}se.clustered=true;Z=se.collection;K=se.index;var ue=Z.get(K);q=C(ue,se.coord,D,i,x);var le=e.clone(q,A);G=Q.range(q.x,q.y,q.x+q.width,q.y+q.height);H=G.length;var ce=r.clone(ue.position);X=1;Y=[ue.id];for(z=0;z<H;++z){W=G[z];j=k[W];if(!j.clustered){var de=j.collection.get(j.index);var fe=C(de,j.coord,D,i,P);r.add(de.position,ce,ce);e.union(le,fe,le);++X;Y.push(de.id)}}if(X>=M){var he=r.multiplyByScalar(ce,1/X,ce);S(he,X,Y,i);O.push({position:he,width:le.width,height:le.height,minimumWidth:q.width,minimumHeight:q.height});for(z=0;z<H;++z){k[G[z]].clustered=true}}else{b(ue,i)}}if(y.length===0){y.destroy();i._clusterLabelCollection=undefined}if(w.length===0){w.destroy();i._clusterBillboardCollection=undefined}if(E.length===0){E.destroy();i._clusterPointCollection=undefined}i._previousClusters=O;i._previousHeight=N}}v.prototype._initialize=function(e){this._scene=e;var t=D(this);this._cluster=t;this._removeEventListener=e.camera.changed.addEventListener(t)};a(v.prototype,{enabled:{get:function(){return this._enabled},set:function(e){this._enabledDirty=e!==this._enabled;this._enabled=e}},pixelRange:{get:function(){return this._pixelRange},set:function(e){this._clusterDirty=this._clusterDirty||e!==this._pixelRange;this._pixelRange=e}},minimumClusterSize:{get:function(){return this._minimumClusterSize},set:function(e){this._clusterDirty=this._clusterDirty||e!==this._minimumClusterSize;this._minimumClusterSize=e}},clusterEvent:{get:function(){return this._clusterEvent}},clusterBillboards:{get:function(){return this._clusterBillboards},set:function(e){this._clusterDirty=this._clusterDirty||e!==this._clusterBillboards;this._clusterBillboards=e}},clusterLabels:{get:function(){return this._clusterLabels},set:function(e){this._clusterDirty=this._clusterDirty||e!==this._clusterLabels;this._clusterLabels=e}},clusterPoints:{get:function(){return this._clusterPoints},set:function(e){this._clusterDirty=this._clusterDirty||e!==this._clusterPoints;this._clusterPoints=e}}});function M(e,t,r,i){return function(a){var o=this[e];if(!n(this._collectionIndicesByEntity)){this._collectionIndicesByEntity={}}var s=this._collectionIndicesByEntity[a.id];if(!n(s)){s=this._collectionIndicesByEntity[a.id]={billboardIndex:undefined,labelIndex:undefined,pointIndex:undefined}}if(n(o)&&n(s[i])){return o.get(s[i])}if(!n(o)){o=this[e]=new t({scene:this._scene})}var u;var l;var c=this[r];if(c.length>0){u=c.pop();l=o.get(u)}else{l=o.add();u=o.length-1}s[i]=u;this._clusterDirty=true;return l}}function I(e,t){var r=e._collectionIndicesByEntity[t];if(!n(r.billboardIndex)&&!n(r.labelIndex)&&!n(r.pointIndex)){delete e._collectionIndicesByEntity[t]}}v.prototype.getLabel=M("_labelCollection",f,"_unusedLabelIndices","labelIndex");v.prototype.removeLabel=function(e){var t=this._collectionIndicesByEntity&&this._collectionIndicesByEntity[e.id];if(!n(this._labelCollection)||!n(t)||!n(t.labelIndex)){return}var r=t.labelIndex;t.labelIndex=undefined;I(this,e.id);var i=this._labelCollection.get(r);i.show=false;i.text="";i.id=undefined;this._unusedLabelIndices.push(r);this._clusterDirty=true};v.prototype.getBillboard=M("_billboardCollection",c,"_unusedBillboardIndices","billboardIndex");v.prototype.removeBillboard=function(e){var t=this._collectionIndicesByEntity&&this._collectionIndicesByEntity[e.id];if(!n(this._billboardCollection)||!n(t)||!n(t.billboardIndex)){return}var r=t.billboardIndex;t.billboardIndex=undefined;I(this,e.id);var i=this._billboardCollection.get(r);i.id=undefined;i.show=false;i.image=undefined;this._unusedBillboardIndices.push(r);this._clusterDirty=true};v.prototype.getPoint=M("_pointCollection",p,"_unusedPointIndices","pointIndex");v.prototype.removePoint=function(e){var t=this._collectionIndicesByEntity&&this._collectionIndicesByEntity[e.id];if(!n(this._pointCollection)||!n(t)||!n(t.pointIndex)){return}var r=t.pointIndex;t.pointIndex=undefined;I(this,e.id);var i=this._pointCollection.get(r);i.show=false;i.id=undefined;this._unusedPointIndices.push(r);this._clusterDirty=true};function O(e){if(!n(e)){return}var t=e.length;for(var r=0;r<t;++r){e.get(r).clusterShow=true}}function R(e){if(e.enabled){return}if(n(e._clusterLabelCollection)){e._clusterLabelCollection.destroy()}if(n(e._clusterBillboardCollection)){e._clusterBillboardCollection.destroy()}if(n(e._clusterPointCollection)){e._clusterPointCollection.destroy()}e._clusterLabelCollection=undefined;e._clusterBillboardCollection=undefined;e._clusterPointCollection=undefined;O(e._labelCollection);O(e._billboardCollection);O(e._pointCollection)}v.prototype.update=function(e){if(n(this._labelCollection)&&this._labelCollection.length>0&&this._labelCollection.get(0)._glyphs.length===0){var t=e.commandList;e.commandList=[];this._labelCollection.update(e);e.commandList=t}if(this._enabledDirty){this._enabledDirty=false;R(this);this._clusterDirty=true}if(this._clusterDirty){this._clusterDirty=false;this._cluster()}if(n(this._clusterLabelCollection)){this._clusterLabelCollection.update(e)}if(n(this._clusterBillboardCollection)){this._clusterBillboardCollection.update(e)}if(n(this._clusterPointCollection)){this._clusterPointCollection.update(e)}if(n(this._labelCollection)){this._labelCollection.update(e)}if(n(this._billboardCollection)){this._billboardCollection.update(e)}if(n(this._pointCollection)){this._pointCollection.update(e)}};v.prototype.destroy=function(){this._labelCollection=this._labelCollection&&this._labelCollection.destroy();this._billboardCollection=this._billboardCollection&&this._billboardCollection.destroy();this._pointCollection=this._pointCollection&&this._pointCollection.destroy();this._clusterLabelCollection=this._clusterLabelCollection&&this._clusterLabelCollection.destroy();this._clusterBillboardCollection=this._clusterBillboardCollection&&this._clusterBillboardCollection.destroy();this._clusterPointCollection=this._clusterPointCollection&&this._clusterPointCollection.destroy();if(n(this._removeEventListener)){this._removeEventListener();this._removeEventListener=undefined}this._labelCollection=undefined;this._billboardCollection=undefined;this._pointCollection=undefined;this._clusterBillboardCollection=undefined;this._clusterLabelCollection=undefined;this._clusterPointCollection=undefined;this._collectionIndicesByEntity=undefined;this._unusedLabelIndices=[];this._unusedBillboardIndices=[];this._unusedPointIndices=[];this._previousClusters=[];this._previousHeight=undefined;this._enabledDirty=false;this._pixelRangeDirty=false;this._minimumClusterSizeDirty=false;return undefined};return v});define("DataSources/CustomDataSource",["../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./DataSource","./EntityCluster","./EntityCollection"],function(e,t,r,i,n,a,o){"use strict";function s(e){this._name=e;this._clock=undefined;this._changed=new i;this._error=new i;this._isLoading=false;this._loading=new i;this._entityCollection=new o(this);this._entityCluster=new a}t(s.prototype,{name:{get:function(){return this._name},set:function(e){if(this._name!==e){this._name=e;this._changed.raiseEvent(this)}}},clock:{get:function(){return this._clock},set:function(e){if(this._clock!==e){this._clock=e;this._changed.raiseEvent(this)}}},entities:{get:function(){return this._entityCollection}},isLoading:{get:function(){return this._isLoading},set:function(e){n.setLoading(this,e)}},changedEvent:{get:function(){return this._changed}},errorEvent:{get:function(){return this._error}},loadingEvent:{get:function(){return this._loading}},show:{get:function(){return this._entityCollection.show},set:function(e){this._entityCollection.show=e}},clustering:{get:function(){return this._entityCluster},set:function(t){if(!e(t)){throw new r("value must be defined.")}this._entityCluster=t}}});return s});define("DataSources/CylinderGeometryUpdater",["../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/CylinderGeometry","../Core/CylinderOutlineGeometry","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/Event","../Core/GeometryInstance","../Core/Iso8601","../Core/ShowGeometryInstanceAttribute","../Scene/MaterialAppearance","../Scene/PerInstanceColorAppearance","../Scene/Primitive","../Scene/ShadowMode","./ColorMaterialProperty","./ConstantProperty","./dynamicGeometryGetBoundingSphere","./MaterialProperty","./Property"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w,C,b,S){"use strict";var E=new y(e.WHITE);var T=new w(true);var x=new w(true);var A=new w(false);var P=new w(e.BLACK);var D=new w(g.DISABLED);var M=new w(new l);var I=new e;function O(e){this.id=e;this.vertexFormat=undefined;this.length=undefined;this.topRadius=undefined;this.bottomRadius=undefined;this.slices=undefined;this.numberOfVerticalLines=undefined}function R(e,t){if(!a(e)){throw new u("entity is required")}if(!a(t)){throw new u("scene is required")}this._entity=e;this._scene=t;this._entitySubscription=e.definitionChanged.addEventListener(R.prototype._onEntityPropertyChanged,this);this._fillEnabled=false;this._dynamic=false;this._outlineEnabled=false;this._geometryChanged=new d;this._showProperty=undefined;this._materialProperty=undefined;this._hasConstantOutline=true;this._showOutlineProperty=undefined;this._outlineColorProperty=undefined;this._outlineWidth=1;this._shadowsProperty=undefined;this._distanceDisplayConditionProperty=undefined;this._options=new O(e);this._onEntityPropertyChanged(e,"cylinder",e.cylinder,undefined)}o(R,{perInstanceColorAppearanceType:{value:v},materialAppearanceType:{value:m}});o(R.prototype,{entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!a(this._entity.availability)&&S.isConstant(this._showProperty)&&S.isConstant(this._fillProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},outlineEnabled:{get:function(){return this._outlineEnabled}},hasConstantOutline:{get:function(){return!this._outlineEnabled||!a(this._entity.availability)&&S.isConstant(this._showProperty)&&S.isConstant(this._showOutlineProperty)}},outlineColorProperty:{get:function(){return this._outlineColorProperty}},outlineWidth:{get:function(){return this._outlineWidth}},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayConditionProperty}},isDynamic:{get:function(){return this._dynamic}},isClosed:{value:true},geometryChanged:{get:function(){return this._geometryChanged}}});R.prototype.isOutlineVisible=function(e){var t=this._entity;return this._outlineEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)};R.prototype.isFilled=function(e){var t=this._entity;return this._fillEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)};R.prototype.createFillGeometryInstance=function(i){if(!a(i)){throw new u("time is required.")}if(!this._fillEnabled){throw new u("This instance does not represent a filled geometry.")}var n=this._entity;var o=n.isAvailable(i);var s;var l;var d=new p(o&&n.isShowing&&this._showProperty.getValue(i)&&this._fillProperty.getValue(i));var m=this._distanceDisplayConditionProperty.getValue(i);var v=c.fromDistanceDisplayCondition(m);if(this._materialProperty instanceof y){var _=e.WHITE;if(a(this._materialProperty.color)&&(this._materialProperty.color.isConstant||o)){_=this._materialProperty.color.getValue(i)}l=t.fromColor(_);s={show:d,distanceDisplayCondition:v,color:l}}else{s={show:d,distanceDisplayCondition:v}}return new f({id:n,geometry:new r(this._options),modelMatrix:n._getModelMatrix(h.MINIMUM_VALUE),attributes:s})};R.prototype.createOutlineGeometryInstance=function(r){if(!a(r)){throw new u("time is required.")}if(!this._outlineEnabled){throw new u("This instance does not represent an outlined geometry.")}var n=this._entity;var o=n.isAvailable(r);var s=S.getValueOrDefault(this._outlineColorProperty,r,e.BLACK);var l=this._distanceDisplayConditionProperty.getValue(r);return new f({id:n,geometry:new i(this._options),modelMatrix:n._getModelMatrix(h.MINIMUM_VALUE),attributes:{show:new p(o&&n.isShowing&&this._showProperty.getValue(r)&&this._showOutlineProperty.getValue(r)),color:t.fromColor(s),distanceDisplayCondition:c.fromDistanceDisplayCondition(l)}})};R.prototype.isDestroyed=function(){return false};R.prototype.destroy=function(){this._entitySubscription();s(this)};R.prototype._onEntityPropertyChanged=function(e,t,r,i){if(!(t==="availability"||t==="position"||t==="orientation"||t==="cylinder")){return}var o=e.cylinder;if(!a(o)){if(this._fillEnabled||this._outlineEnabled){this._fillEnabled=false;this._outlineEnabled=false;this._geometryChanged.raiseEvent(this)}return}var s=o.fill;var u=a(s)&&s.isConstant?s.getValue(h.MINIMUM_VALUE):true;var l=o.outline;var c=a(l);if(c&&l.isConstant){c=l.getValue(h.MINIMUM_VALUE)}if(!u&&!c){if(this._fillEnabled||this._outlineEnabled){this._fillEnabled=false;this._outlineEnabled=false;this._geometryChanged.raiseEvent(this)}return}var d=e.position;var f=o.length;var p=o.topRadius;var _=o.bottomRadius;var g=o.show;if(a(g)&&g.isConstant&&!g.getValue(h.MINIMUM_VALUE)||(!a(d)||!a(f)||!a(p)||!a(_))){if(this._fillEnabled||this._outlineEnabled){this._fillEnabled=false;this._outlineEnabled=false;this._geometryChanged.raiseEvent(this)}return}var w=n(o.material,E);var C=w instanceof y;this._materialProperty=w;this._fillProperty=n(s,x);this._showProperty=n(g,T);this._showOutlineProperty=n(o.outline,A);this._outlineColorProperty=c?n(o.outlineColor,P):undefined;this._shadowsProperty=n(o.shadows,D);this._distanceDisplayConditionProperty=n(o.distanceDisplayCondition,M);var b=o.slices;var I=o.outlineWidth;var O=o.numberOfVerticalLines;this._fillEnabled=u;this._outlineEnabled=c;if(!d.isConstant||!S.isConstant(e.orientation)||!f.isConstant||!p.isConstant||!_.isConstant||!S.isConstant(b)||!S.isConstant(I)||!S.isConstant(O)){if(!this._dynamic){this._dynamic=true;this._geometryChanged.raiseEvent(this)}}else{var R=this._options;R.vertexFormat=C?v.VERTEX_FORMAT:m.MaterialSupport.TEXTURED.vertexFormat;R.length=f.getValue(h.MINIMUM_VALUE);R.topRadius=p.getValue(h.MINIMUM_VALUE);R.bottomRadius=_.getValue(h.MINIMUM_VALUE);R.slices=a(b)?b.getValue(h.MINIMUM_VALUE):undefined;R.numberOfVerticalLines=a(O)?O.getValue(h.MINIMUM_VALUE):undefined;this._outlineWidth=a(I)?I.getValue(h.MINIMUM_VALUE):1;this._dynamic=false;this._geometryChanged.raiseEvent(this)}};R.prototype.createDynamicUpdater=function(e){if(!this._dynamic){throw new u("This instance does not represent dynamic geometry.")}if(!a(e)){throw new u("primitives is required.")}return new N(e,this)};function N(e,t){this._primitives=e;this._primitive=undefined;this._outlinePrimitive=undefined;this._geometryUpdater=t;this._options=new O(t._entity)}N.prototype.update=function(n){if(!a(n)){throw new u("time is required.")}var o=this._primitives;o.removeAndDestroy(this._primitive);o.removeAndDestroy(this._outlinePrimitive);this._primitive=undefined;this._outlinePrimitive=undefined;var s=this._geometryUpdater;var l=s._entity;var d=l.cylinder;if(!l.isShowing||!l.isAvailable(n)||!S.getValueOrDefault(d.show,n,true)){return}var h=this._options;var p=l._getModelMatrix(n);var g=S.getValueOrUndefined(d.length,n);var y=S.getValueOrUndefined(d.topRadius,n);var w=S.getValueOrUndefined(d.bottomRadius,n);if(!a(p)||!a(g)||!a(y)||!a(w)){return}h.length=g;h.topRadius=y;h.bottomRadius=w;h.slices=S.getValueOrUndefined(d.slices,n);h.numberOfVerticalLines=S.getValueOrUndefined(d.numberOfVerticalLines,n);var C=this._geometryUpdater.shadowsProperty.getValue(n);var E=this._geometryUpdater.distanceDisplayConditionProperty;var T=E.getValue(n);var x=c.fromDistanceDisplayCondition(T);if(S.getValueOrDefault(d.fill,n,true)){var A=b.getValue(n,s.fillMaterialProperty,this._material);this._material=A;var P=new m({material:A,translucent:A.isTranslucent(),closed:true});h.vertexFormat=P.vertexFormat;this._primitive=o.add(new _({geometryInstances:new f({id:l,geometry:new r(h),modelMatrix:p,attributes:{distanceDisplayCondition:x}}),appearance:P,asynchronous:false,shadows:C}))}if(S.getValueOrDefault(d.outline,n,false)){h.vertexFormat=v.VERTEX_FORMAT;var D=S.getValueOrClonedDefault(d.outlineColor,n,e.BLACK,I);var M=S.getValueOrDefault(d.outlineWidth,n,1);var O=D.alpha!==1;this._outlinePrimitive=o.add(new _({geometryInstances:new f({id:l,geometry:new i(h),modelMatrix:p,attributes:{color:t.fromColor(D),distanceDisplayCondition:x}}),appearance:new v({flat:true,translucent:O,renderState:{lineWidth:s._scene.clampLineWidth(M)}}),asynchronous:false,shadows:C}))}};N.prototype.getBoundingSphere=function(e,t){return C(e,this._primitive,this._outlinePrimitive,t)};N.prototype.isDestroyed=function(){return false};N.prototype.destroy=function(){var e=this._primitives;e.removeAndDestroy(this._primitive);e.removeAndDestroy(this._outlinePrimitive);s(this)};return R});define("Scene/ColorBlendMode",["../Core/freezeObject","../Core/Math"],function(e,t){"use strict";var r={HIGHLIGHT:0,REPLACE:1,MIX:2};r.getColorBlend=function(e,i){if(e===r.HIGHLIGHT){return 0}else if(e===r.REPLACE){return 1}else if(e===r.MIX){return t.clamp(i,t.EPSILON4,1)}};return e(r)});define("DataSources/DataSourceClock",["../Core/Clock","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/JulianDate","./createRawPropertyDescriptor"],function(e,t,r,i,n,a,o,s){"use strict";function u(){this._startTime=undefined;this._stopTime=undefined;this._currentTime=undefined;this._clockRange=undefined;this._clockStep=undefined;this._multiplier=undefined;this._definitionChanged=new a}i(u.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},startTime:s("startTime"),stopTime:s("stopTime"),currentTime:s("currentTime"),clockRange:s("clockRange"),clockStep:s("clockStep"),multiplier:s("multiplier")});u.prototype.clone=function(e){if(!r(e)){e=new u}e.startTime=this.startTime;e.stopTime=this.stopTime;e.currentTime=this.currentTime;e.clockRange=this.clockRange;e.clockStep=this.clockStep;e.multiplier=this.multiplier;return e};u.prototype.equals=function(e){return this===e||r(e)&&o.equals(this.startTime,e.startTime)&&o.equals(this.stopTime,e.stopTime)&&o.equals(this.currentTime,e.currentTime)&&this.clockRange===e.clockRange&&this.clockStep===e.clockStep&&this.multiplier===e.multiplier};u.prototype.merge=function(e){if(!r(e)){throw new n("source is required.")}this.startTime=t(this.startTime,e.startTime);this.stopTime=t(this.stopTime,e.stopTime);this.currentTime=t(this.currentTime,e.currentTime);this.clockRange=t(this.clockRange,e.clockRange);this.clockStep=t(this.clockStep,e.clockStep);this.multiplier=t(this.multiplier,e.multiplier)};u.prototype.getValue=function(i){if(!r(i)){i=new e}i.startTime=t(this.startTime,i.startTime);i.stopTime=t(this.stopTime,i.stopTime);i.currentTime=t(this.currentTime,i.currentTime);i.clockRange=t(this.clockRange,i.clockRange);i.multiplier=t(this.multiplier,i.multiplier);i.clockStep=t(this.clockStep,i.clockStep);return i};return u});define("DataSources/GridMaterialProperty",["../Core/Cartesian2","../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/Event","./createPropertyDescriptor","./Property"],function(e,t,r,i,n,a,o,s){"use strict";var u=t.WHITE;var l=.1;var c=new e(8,8);var d=new e(0,0);var f=new e(1,1);function h(e){e=r(e,r.EMPTY_OBJECT);this._definitionChanged=new a;this._color=undefined
;this._colorSubscription=undefined;this._cellAlpha=undefined;this._cellAlphaSubscription=undefined;this._lineCount=undefined;this._lineCountSubscription=undefined;this._lineThickness=undefined;this._lineThicknessSubscription=undefined;this._lineOffset=undefined;this._lineOffsetSubscription=undefined;this.color=e.color;this.cellAlpha=e.cellAlpha;this.lineCount=e.lineCount;this.lineThickness=e.lineThickness;this.lineOffset=e.lineOffset}n(h.prototype,{isConstant:{get:function(){return s.isConstant(this._color)&&s.isConstant(this._cellAlpha)&&s.isConstant(this._lineCount)&&s.isConstant(this._lineThickness)&&s.isConstant(this._lineOffset)}},definitionChanged:{get:function(){return this._definitionChanged}},color:o("color"),cellAlpha:o("cellAlpha"),lineCount:o("lineCount"),lineThickness:o("lineThickness"),lineOffset:o("lineOffset")});h.prototype.getType=function(e){return"Grid"};h.prototype.getValue=function(e,t){if(!i(t)){t={}}t.color=s.getValueOrClonedDefault(this._color,e,u,t.color);t.cellAlpha=s.getValueOrDefault(this._cellAlpha,e,l);t.lineCount=s.getValueOrClonedDefault(this._lineCount,e,c,t.lineCount);t.lineThickness=s.getValueOrClonedDefault(this._lineThickness,e,f,t.lineThickness);t.lineOffset=s.getValueOrClonedDefault(this._lineOffset,e,d,t.lineOffset);return t};h.prototype.equals=function(e){return this===e||e instanceof h&&s.equals(this._color,e._color)&&s.equals(this._cellAlpha,e._cellAlpha)&&s.equals(this._lineCount,e._lineCount)&&s.equals(this._lineThickness,e._lineThickness)&&s.equals(this._lineOffset,e._lineOffset)};return h});define("DataSources/PolylineArrowMaterialProperty",["../Core/Color","../Core/defined","../Core/defineProperties","../Core/Event","./createPropertyDescriptor","./Property"],function(e,t,r,i,n,a){"use strict";function o(e){this._definitionChanged=new i;this._color=undefined;this._colorSubscription=undefined;this.color=e}r(o.prototype,{isConstant:{get:function(){return a.isConstant(this._color)}},definitionChanged:{get:function(){return this._definitionChanged}},color:n("color")});o.prototype.getType=function(e){return"PolylineArrow"};o.prototype.getValue=function(r,i){if(!t(i)){i={}}i.color=a.getValueOrClonedDefault(this._color,r,e.WHITE,i.color);return i};o.prototype.equals=function(e){return this===e||e instanceof o&&a.equals(this._color,e._color)};return o});define("DataSources/PolylineGlowMaterialProperty",["../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/Event","./createPropertyDescriptor","./Property"],function(e,t,r,i,n,a,o){"use strict";var s=e.WHITE;var u=.25;function l(e){e=t(e,t.EMPTY_OBJECT);this._definitionChanged=new n;this._color=undefined;this._colorSubscription=undefined;this._glowPower=undefined;this._glowPowerSubscription=undefined;this.color=e.color;this.glowPower=e.glowPower}i(l.prototype,{isConstant:{get:function(){return o.isConstant(this._color)&&o.isConstant(this._glow)}},definitionChanged:{get:function(){return this._definitionChanged}},color:a("color"),glowPower:a("glowPower")});l.prototype.getType=function(e){return"PolylineGlow"};l.prototype.getValue=function(e,t){if(!r(t)){t={}}t.color=o.getValueOrClonedDefault(this._color,e,s,t.color);t.glowPower=o.getValueOrDefault(this._glowPower,e,u,t.glowPower);return t};l.prototype.equals=function(e){return this===e||e instanceof l&&o.equals(this._color,e._color)&&o.equals(this._glowPower,e._glowPower)};return l});define("DataSources/PolylineOutlineMaterialProperty",["../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/Event","./createPropertyDescriptor","./Property"],function(e,t,r,i,n,a,o){"use strict";var s=e.WHITE;var u=e.BLACK;var l=1;function c(e){e=t(e,t.EMPTY_OBJECT);this._definitionChanged=new n;this._color=undefined;this._colorSubscription=undefined;this._outlineColor=undefined;this._outlineColorSubscription=undefined;this._outlineWidth=undefined;this._outlineWidthSubscription=undefined;this.color=e.color;this.outlineColor=e.outlineColor;this.outlineWidth=e.outlineWidth}i(c.prototype,{isConstant:{get:function(){return o.isConstant(this._color)&&o.isConstant(this._outlineColor)&&o.isConstant(this._outlineWidth)}},definitionChanged:{get:function(){return this._definitionChanged}},color:a("color"),outlineColor:a("outlineColor"),outlineWidth:a("outlineWidth")});c.prototype.getType=function(e){return"PolylineOutline"};c.prototype.getValue=function(e,t){if(!r(t)){t={}}t.color=o.getValueOrClonedDefault(this._color,e,s,t.color);t.outlineColor=o.getValueOrClonedDefault(this._outlineColor,e,u,t.outlineColor);t.outlineWidth=o.getValueOrDefault(this._outlineWidth,e,l);return t};c.prototype.equals=function(e){return this===e||e instanceof c&&o.equals(this._color,e._color)&&o.equals(this._outlineColor,e._outlineColor)&&o.equals(this._outlineWidth,e._outlineWidth)};return c});define("DataSources/PositionPropertyArray",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/EventHelper","../Core/ReferenceFrame","./Property"],function(e,t,r,i,n,a,o,s){"use strict";function u(t,r){this._value=undefined;this._definitionChanged=new n;this._eventHelper=new a;this._referenceFrame=e(r,o.FIXED);this.setValue(t)}r(u.prototype,{isConstant:{get:function(){var e=this._value;if(!t(e)){return true}var r=e.length;for(var i=0;i<r;i++){if(!s.isConstant(e[i])){return false}}return true}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return this._referenceFrame}}});u.prototype.getValue=function(e,t){return this.getValueInReferenceFrame(e,o.FIXED,t)};u.prototype.getValueInReferenceFrame=function(e,r,n){if(!t(e)){throw new i("time is required.")}if(!t(r)){throw new i("referenceFrame is required.")}var a=this._value;if(!t(a)){return undefined}var o=a.length;if(!t(n)){n=new Array(o)}var s=0;var u=0;while(s<o){var l=a[s];var c=l.getValueInReferenceFrame(e,r,n[s]);if(t(c)){n[u]=c;u++}s++}n.length=u;return n};u.prototype.setValue=function(e){var r=this._eventHelper;r.removeAll();if(t(e)){this._value=e.slice();var i=e.length;for(var n=0;n<i;n++){var a=e[n];if(t(a)){r.add(a.definitionChanged,u.prototype._raiseDefinitionChanged,this)}}}else{this._value=undefined}this._definitionChanged.raiseEvent(this)};u.prototype.equals=function(e){return this===e||e instanceof u&&this._referenceFrame===e._referenceFrame&&s.arrayEquals(this._value,e._value)};u.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)};return u});define("DataSources/PropertyArray",["../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/EventHelper","./Property"],function(e,t,r,i,n,a){"use strict";function o(e){this._value=undefined;this._definitionChanged=new i;this._eventHelper=new n;this.setValue(e)}t(o.prototype,{isConstant:{get:function(){var t=this._value;if(!e(t)){return true}var r=t.length;for(var i=0;i<r;i++){if(!a.isConstant(t[i])){return false}}return true}},definitionChanged:{get:function(){return this._definitionChanged}}});o.prototype.getValue=function(t,i){if(!e(t)){throw new r("time is required.")}var n=this._value;if(!e(n)){return undefined}var a=n.length;if(!e(i)){i=new Array(a)}var o=0;var s=0;while(o<a){var u=this._value[o];var l=u.getValue(t,i[o]);if(e(l)){i[s]=l;s++}o++}i.length=s;return i};o.prototype.setValue=function(t){var r=this._eventHelper;r.removeAll();if(e(t)){this._value=t.slice();var i=t.length;for(var n=0;n<i;n++){var a=t[n];if(e(a)){r.add(a.definitionChanged,o.prototype._raiseDefinitionChanged,this)}}}else{this._value=undefined}this._definitionChanged.raiseEvent(this)};o.prototype.equals=function(e){return this===e||e instanceof o&&a.arrayEquals(this._value,e._value)};o.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)};return o});define("DataSources/ReferenceProperty",["../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/RuntimeError","./Property"],function(e,t,r,i,n,a){"use strict";function o(t){var r=true;if(t._resolveEntity){var i=t._targetCollection.getById(t._targetId);if(e(i)){i.definitionChanged.addEventListener(u.prototype._onTargetEntityDefinitionChanged,t);t._targetEntity=i;t._resolveEntity=false}else{i=t._targetEntity;r=false}if(!e(i)){throw new n('target entity "'+t._targetId+'" could not be resolved.')}}return r}function s(t){var r=t._targetProperty;if(t._resolveProperty){var i=o(t);var a=t._targetPropertyNames;r=t._targetEntity;var s=a.length;for(var u=0;u<s&&e(r);u++){r=r[a[u]]}if(e(r)){t._targetProperty=r;t._resolveProperty=!i}else if(!e(t._targetProperty)){throw new n('targetProperty "'+t._targetId+"."+a.join(".")+'" could not be resolved.')}}return r}function u(t,n,a){if(!e(t)){throw new r("targetCollection is required.")}if(!e(n)||n===""){throw new r("targetId is required.")}if(!e(a)||a.length===0){throw new r("targetPropertyNames is required.")}for(var o=0;o<a.length;o++){var s=a[o];if(!e(s)||s===""){throw new r("reference contains invalid properties.")}}this._targetCollection=t;this._targetId=n;this._targetPropertyNames=a;this._targetProperty=undefined;this._targetEntity=undefined;this._definitionChanged=new i;this._resolveEntity=true;this._resolveProperty=true;t.collectionChanged.addEventListener(u.prototype._onCollectionChanged,this)}t(u.prototype,{isConstant:{get:function(){return a.isConstant(s(this))}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return s(this).referenceFrame}},targetId:{get:function(){return this._targetId}},targetCollection:{get:function(){return this._targetCollection}},targetPropertyNames:{get:function(){return this._targetPropertyNames}},resolvedProperty:{get:function(){return s(this)}}});u.fromString=function(t,i){if(!e(t)){throw new r("targetCollection is required.")}if(!e(i)){throw new r("referenceString is required.")}var n;var a=[];var o=true;var s=false;var l="";for(var c=0;c<i.length;++c){var d=i.charAt(c);if(s){l+=d;s=false}else if(d==="\\"){s=true}else if(o&&d==="#"){n=l;o=false;l=""}else if(!o&&d==="."){a.push(l);l=""}else{l+=d}}a.push(l);return new u(t,n,a)};u.prototype.getValue=function(e,t){return s(this).getValue(e,t)};u.prototype.getValueInReferenceFrame=function(e,t,r){return s(this).getValueInReferenceFrame(e,t,r)};u.prototype.getType=function(e){return s(this).getType(e)};u.prototype.equals=function(e){if(this===e){return true}var t=this._targetPropertyNames;var r=e._targetPropertyNames;if(this._targetCollection!==e._targetCollection||this._targetId!==e._targetId||t.length!==r.length){return false}var i=this._targetPropertyNames.length;for(var n=0;n<i;n++){if(t[n]!==r[n]){return false}}return true};u.prototype._onTargetEntityDefinitionChanged=function(e,t,r,i){if(this._targetPropertyNames[0]===t){this._resolveProperty=true;this._definitionChanged.raiseEvent(this)}};u.prototype._onCollectionChanged=function(t,r,i){var n=this._targetEntity;if(e(n)){if(i.indexOf(n)!==-1){n.definitionChanged.removeEventListener(u.prototype._onTargetEntityDefinitionChanged,this);this._resolveEntity=true;this._resolveProperty=true}else if(this._resolveEntity){s(this);if(!this._resolveEntity){this._definitionChanged.raiseEvent(this)}}}};return u});define("DataSources/Rotation",["../Core/defaultValue","../Core/defined","../Core/DeveloperError","../Core/Math"],function(e,t,r,i){"use strict";var n={packedLength:1,pack:function(i,n,a){if(!t(i)){throw new r("value is required")}if(!t(n)){throw new r("array is required")}a=e(a,0);n[a]=i;return n},unpack:function(i,n,a){if(!t(i)){throw new r("array is required")}n=e(n,0);return i[n]},convertPackedArrayForInterpolation:function(n,a,o,s){if(!t(n)){throw new r("packedArray is required")}a=e(a,0);o=e(o,n.length);var u;for(var l=0,c=o-a+1;l<c;l++){var d=n[a+l];if(l===0||Math.abs(u-d)<Math.PI){s[l]=d}else{s[l]=d-i.TWO_PI}u=d}},unpackInterpolationResult:function(e,n,a,o,s){if(!t(e)){throw new r("array is required")}if(!t(n)){throw new r("sourceArray is required")}s=e[0];if(s<0){return s+i.TWO_PI}return s}};return n});define("DataSources/SampledProperty",["../Core/binarySearch","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/ExtrapolationType","../Core/JulianDate","../Core/LinearApproximation"],function(e,t,r,i,n,a,o,s,u){"use strict";var l={packedLength:1,pack:function(e,r,i){i=t(i,0);r[i]=e},unpack:function(e,r,i){r=t(r,0);return e[r]}};function c(e,t,r){var i;var n=e.length;var a=r.length;var o=n+a;e.length=o;if(n!==t){var s=n-1;for(i=o-1;i>=t;i--){e[i]=e[s--]}}for(i=0;i<a;i++){e[t++]=r[i]}}function d(e,t){if(e instanceof s){return e}if(typeof e==="string"){return s.fromIso8601(e)}return s.addSeconds(t,e,new s)}var f=[];var h=[];function p(t,i,n,a,o){var u=0;var l;var p;var m;var v;var _;var g;while(u<a.length){_=d(a[u],t);m=e(i,_,s.compare);var y=0;var w=0;if(m<0){m=~m;v=m*o;p=undefined;g=i[m];while(u<a.length){_=d(a[u],t);if(r(p)&&s.compare(p,_)>=0||r(g)&&s.compare(_,g)>=0){break}f[y++]=_;u=u+1;for(l=0;l<o;l++){h[w++]=a[u];u=u+1}p=_}if(y>0){h.length=w;c(n,v,h);f.length=y;c(i,m,f)}}else{for(l=0;l<o;l++){u++;n[m*o+l]=a[u]}u++}}}function m(e,i){if(!r(e)){throw new n("type is required.")}var s=e;if(s===Number){s=l}var c=s.packedLength;var d=t(s.packedInterpolationLength,c);var f=0;var h;if(r(i)){var p=i.length;h=new Array(p);for(var m=0;m<p;m++){var v=i[m];if(v===Number){v=l}var _=v.packedLength;c+=_;d+=t(v.packedInterpolationLength,_);h[m]=v}f=p}this._type=e;this._innerType=s;this._interpolationDegree=1;this._interpolationAlgorithm=u;this._numberOfPoints=0;this._times=[];this._values=[];this._xTable=[];this._yTable=[];this._packedLength=c;this._packedInterpolationLength=d;this._updateTableLength=true;this._interpolationResult=new Array(d);this._definitionChanged=new a;this._derivativeTypes=i;this._innerDerivativeTypes=h;this._inputOrder=f;this._forwardExtrapolationType=o.NONE;this._forwardExtrapolationDuration=0;this._backwardExtrapolationType=o.NONE;this._backwardExtrapolationDuration=0}i(m.prototype,{isConstant:{get:function(){return this._values.length===0}},definitionChanged:{get:function(){return this._definitionChanged}},type:{get:function(){return this._type}},derivativeTypes:{get:function(){return this._derivativeTypes}},interpolationDegree:{get:function(){return this._interpolationDegree}},interpolationAlgorithm:{get:function(){return this._interpolationAlgorithm}},forwardExtrapolationType:{get:function(){return this._forwardExtrapolationType},set:function(e){if(this._forwardExtrapolationType!==e){this._forwardExtrapolationType=e;this._definitionChanged.raiseEvent(this)}}},forwardExtrapolationDuration:{get:function(){return this._forwardExtrapolationDuration},set:function(e){if(this._forwardExtrapolationDuration!==e){this._forwardExtrapolationDuration=e;this._definitionChanged.raiseEvent(this)}}},backwardExtrapolationType:{get:function(){return this._backwardExtrapolationType},set:function(e){if(this._backwardExtrapolationType!==e){this._backwardExtrapolationType=e;this._definitionChanged.raiseEvent(this)}}},backwardExtrapolationDuration:{get:function(){return this._backwardExtrapolationDuration},set:function(e){if(this._backwardExtrapolationDuration!==e){this._backwardExtrapolationDuration=e;this._definitionChanged.raiseEvent(this)}}}});m.prototype.getValue=function(t,i){if(!r(t)){throw new n("time is required.")}var a=this._times;var u=a.length;if(u===0){return undefined}var l;var c=this._innerType;var d=this._values;var f=e(a,t,s.compare);if(f<0){f=~f;if(f===0){var h=a[f];l=this._backwardExtrapolationDuration;if(this._backwardExtrapolationType===o.NONE||l!==0&&s.secondsDifference(h,t)>l){return undefined}if(this._backwardExtrapolationType===o.HOLD){return c.unpack(d,0,i)}}if(f>=u){f=u-1;var p=a[f];l=this._forwardExtrapolationDuration;if(this._forwardExtrapolationType===o.NONE||l!==0&&s.secondsDifference(t,p)>l){return undefined}if(this._forwardExtrapolationType===o.HOLD){f=u-1;return c.unpack(d,f*c.packedLength,i)}}var m=this._xTable;var v=this._yTable;var _=this._interpolationAlgorithm;var g=this._packedInterpolationLength;var y=this._inputOrder;if(this._updateTableLength){this._updateTableLength=false;var w=Math.min(_.getRequiredDataPoints(this._interpolationDegree,y),u);if(w!==this._numberOfPoints){this._numberOfPoints=w;m.length=w;v.length=w*g}}var C=this._numberOfPoints-1;if(C<1){return undefined}var b=0;var S=u-1;var E=S-b+1;if(E>=C+1){var T=f-(C/2|0)-1;if(T<b){T=b}var x=T+C;if(x>S){x=S;T=x-C;if(T<b){T=b}}b=T;S=x}var A=S-b+1;for(var P=0;P<A;++P){m[P]=s.secondsDifference(a[b+P],a[S])}if(!r(c.convertPackedArrayForInterpolation)){var D=0;var M=this._packedLength;var I=b*M;var O=(S+1)*M;while(I<O){v[D]=d[I];I++;D++}}else{c.convertPackedArrayForInterpolation(d,b,S,v)}var R=s.secondsDifference(t,a[S]);var N;if(y===0||!r(_.interpolate)){N=_.interpolateOrderZero(R,m,v,g,this._interpolationResult)}else{var L=Math.floor(g/(y+1));N=_.interpolate(R,m,v,L,y,y,this._interpolationResult)}if(!r(c.unpackInterpolationResult)){return c.unpack(N,0,i)}return c.unpackInterpolationResult(N,d,b,S,i)}return c.unpack(d,f*this._packedLength,i)};m.prototype.setInterpolationOptions=function(e){if(!r(e)){throw new n("options is required.")}var t=false;var i=e.interpolationAlgorithm;var a=e.interpolationDegree;if(this._interpolationAlgorithm!==i){this._interpolationAlgorithm=i;t=true}if(this._interpolationDegree!==a){this._interpolationDegree=a;t=true}if(t){this._updateTableLength=true;this._definitionChanged.raiseEvent(this)}};m.prototype.addSample=function(e,t,i){var a=this._innerDerivativeTypes;var o=r(a);if(!r(e)){throw new n("time is required.")}if(!r(t)){throw new n("value is required.")}if(o&&!r(i)){throw new n("derivatives is required.")}var s=this._innerType;var u=[];u.push(e);s.pack(t,u,u.length);if(o){var l=a.length;for(var c=0;c<l;c++){a[c].pack(i[c],u,u.length)}}p(undefined,this._times,this._values,u,this._packedLength);this._updateTableLength=true;this._definitionChanged.raiseEvent(this)};m.prototype.addSamples=function(e,t,i){var a=this._innerDerivativeTypes;var o=r(a);if(!r(e)){throw new n("times is required.")}if(!r(t)){throw new n("values is required.")}if(e.length!==t.length){throw new n("times and values must be the same length.")}if(o&&(!r(i)||i.length!==e.length)){throw new n("times and derivativeValues must be the same length.")}var s=this._innerType;var u=e.length;var l=[];for(var c=0;c<u;c++){l.push(e[c]);s.pack(t[c],l,l.length);if(o){var d=i[c];var f=a.length;for(var h=0;h<f;h++){a[h].pack(d[h],l,l.length)}}}p(undefined,this._times,this._values,l,this._packedLength);this._updateTableLength=true;this._definitionChanged.raiseEvent(this)};m.prototype.addSamplesPackedArray=function(e,t){if(!r(e)){throw new n("packedSamples is required.")}p(t,this._times,this._values,e,this._packedLength);this._updateTableLength=true;this._definitionChanged.raiseEvent(this)};m.prototype.equals=function(e){if(this===e){return true}if(!r(e)){return false}if(this._type!==e._type||this._interpolationDegree!==e._interpolationDegree||this._interpolationAlgorithm!==e._interpolationAlgorithm){return false}var t=this._derivativeTypes;var i=r(t);var n=e._derivativeTypes;var a=r(n);if(i!==a){return false}var o;var u;if(i){u=t.length;if(u!==n.length){return false}for(o=0;o<u;o++){if(t[o]!==n[o]){return false}}}var l=this._times;var c=e._times;u=l.length;if(u!==c.length){return false}for(o=0;o<u;o++){if(!s.equals(l[o],c[o])){return false}}var d=this._values;var f=e._values;for(o=0;o<u;o++){if(d[o]!==f[o]){return false}}return true};m._mergeNewSamples=p;return m});define("DataSources/SampledPositionProperty",["../Core/Cartesian3","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/ReferenceFrame","./PositionProperty","./Property","./SampledProperty"],function(e,t,r,i,n,a,o,s,u,l){"use strict";function c(r,i){i=t(i,0);var n;if(i>0){n=new Array(i);for(var s=0;s<i;s++){n[s]=e}}this._numberOfDerivatives=i;this._property=new l(e,n);this._definitionChanged=new a;this._referenceFrame=t(r,o.FIXED);this._property._definitionChanged.addEventListener(function(){this._definitionChanged.raiseEvent(this)},this)}i(c.prototype,{isConstant:{get:function(){return this._property.isConstant}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return this._referenceFrame}},interpolationDegree:{get:function(){return this._property.interpolationDegree}},interpolationAlgorithm:{get:function(){return this._property.interpolationAlgorithm}},numberOfDerivatives:{get:function(){return this._numberOfDerivatives}},forwardExtrapolationType:{get:function(){return this._property.forwardExtrapolationType},set:function(e){this._property.forwardExtrapolationType=e}},forwardExtrapolationDuration:{get:function(){return this._property.forwardExtrapolationDuration},set:function(e){this._property.forwardExtrapolationDuration=e}},backwardExtrapolationType:{get:function(){return this._property.backwardExtrapolationType},set:function(e){this._property.backwardExtrapolationType=e}},backwardExtrapolationDuration:{get:function(){return this._property.backwardExtrapolationDuration},set:function(e){this._property.backwardExtrapolationDuration=e}}});c.prototype.getValue=function(e,t){return this.getValueInReferenceFrame(e,o.FIXED,t)};c.prototype.getValueInReferenceFrame=function(e,t,i){if(!r(e)){throw new n("time is required.")}if(!r(t)){throw new n("referenceFrame is required.")}i=this._property.getValue(e,i);if(r(i)){return s.convertToReferenceFrame(e,i,this._referenceFrame,t,i)}return undefined};c.prototype.setInterpolationOptions=function(e){this._property.setInterpolationOptions(e)};c.prototype.addSample=function(e,t,i){var a=this._numberOfDerivatives;if(a>0&&(!r(i)||i.length!==a)){throw new n("derivatives length must be equal to the number of derivatives.")}this._property.addSample(e,t,i)};c.prototype.addSamples=function(e,t,r){this._property.addSamples(e,t,r)};c.prototype.addSamplesPackedArray=function(e,t){this._property.addSamplesPackedArray(e,t)};c.prototype.equals=function(e){return this===e||e instanceof c&&u.equals(this._property,e._property)&&this._referenceFrame===e._referenceFrame};return c});define("DataSources/StripeOrientation",["../Core/freezeObject"],function(e){"use strict";var t={HORIZONTAL:0,VERTICAL:1};return e(t)});define("DataSources/StripeMaterialProperty",["../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/Event","./createPropertyDescriptor","./Property","./StripeOrientation"],function(e,t,r,i,n,a,o,s){"use strict";var u=s.HORIZONTAL;var l=e.WHITE;var c=e.BLACK;var d=0;var f=1;function h(e){e=t(e,t.EMPTY_OBJECT);this._definitionChanged=new n;this._orientation=undefined;this._orientationSubscription=undefined;this._evenColor=undefined;this._evenColorSubscription=undefined;this._oddColor=undefined;this._oddColorSubscription=undefined;this._offset=undefined;this._offsetSubscription=undefined;this._repeat=undefined;this._repeatSubscription=undefined;this.orientation=e.orientation;this.evenColor=e.evenColor;this.oddColor=e.oddColor;this.offset=e.offset;this.repeat=e.repeat}i(h.prototype,{isConstant:{get:function(){return o.isConstant(this._orientation)&&o.isConstant(this._evenColor)&&o.isConstant(this._oddColor)&&o.isConstant(this._offset)&&o.isConstant(this._repeat)}},definitionChanged:{get:function(){return this._definitionChanged}},orientation:a("orientation"),evenColor:a("evenColor"),oddColor:a("oddColor"),offset:a("offset"),repeat:a("repeat")});h.prototype.getType=function(e){return"Stripe"};h.prototype.getValue=function(e,t){if(!r(t)){t={}}t.horizontal=o.getValueOrDefault(this._orientation,e,u)===s.HORIZONTAL;t.evenColor=o.getValueOrClonedDefault(this._evenColor,e,l,t.evenColor);t.oddColor=o.getValueOrClonedDefault(this._oddColor,e,c,t.oddColor);t.offset=o.getValueOrDefault(this._offset,e,d);t.repeat=o.getValueOrDefault(this._repeat,e,f);return t};h.prototype.equals=function(e){return this===e||e instanceof h&&o.equals(this._orientation,e._orientation)&&o.equals(this._evenColor,e._evenColor)&&o.equals(this._oddColor,e._oddColor)&&o.equals(this._offset,e._offset)&&o.equals(this._repeat,e._repeat)};return h});define("DataSources/TimeIntervalCollectionPositionProperty",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/ReferenceFrame","../Core/TimeIntervalCollection","./PositionProperty","./Property"],function(e,t,r,i,n,a,o,s,u){"use strict";function l(t){this._definitionChanged=new n;this._intervals=new o;this._intervals.changedEvent.addEventListener(l.prototype._intervalsChanged,this);this._referenceFrame=e(t,a.FIXED)}r(l.prototype,{isConstant:{get:function(){return this._intervals.isEmpty}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._intervals}},referenceFrame:{get:function(){return this._referenceFrame}}});l.prototype.getValue=function(e,t){return this.getValueInReferenceFrame(e,a.FIXED,t)};l.prototype.getValueInReferenceFrame=function(e,r,n){if(!t(e)){throw new i("time is required.")}if(!t(r)){throw new i("referenceFrame is required.")}var a=this._intervals.findDataForIntervalContainingDate(e);if(t(a)){return s.convertToReferenceFrame(e,a,this._referenceFrame,r,n)}return undefined};l.prototype.equals=function(e){return this===e||e instanceof l&&this._intervals.equals(e._intervals,u.equals)&&this._referenceFrame===e._referenceFrame};l.prototype._intervalsChanged=function(){this._definitionChanged.raiseEvent(this)};return l});define("DataSources/TimeIntervalCollectionProperty",["../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/TimeIntervalCollection","./Property"],function(e,t,r,i,n,a){"use strict";function o(){this._definitionChanged=new i;this._intervals=new n;this._intervals.changedEvent.addEventListener(o.prototype._intervalsChanged,this)}t(o.prototype,{isConstant:{get:function(){return this._intervals.isEmpty}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._intervals}}});o.prototype.getValue=function(t,i){if(!e(t)){throw new r("time is required")}var n=this._intervals.findDataForIntervalContainingDate(t);if(e(n)&&typeof n.clone==="function"){return n.clone(i)}return n};o.prototype.equals=function(e){return this===e||e instanceof o&&this._intervals.equals(e._intervals,a.equals)};o.prototype._intervalsChanged=function(){this._definitionChanged.raiseEvent(this)};return o});define("DataSources/VelocityVectorProperty",["../Core/Cartesian3","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/JulianDate","./Property"],function(e,t,r,i,n,a,o,s){"use strict";function u(e,r){this._position=undefined;this._subscription=undefined;this._definitionChanged=new a;this._normalize=t(r,true);this.position=e}i(u.prototype,{isConstant:{get:function(){return s.isConstant(this._position)}},definitionChanged:{get:function(){return this._definitionChanged}},position:{get:function(){return this._position},set:function(e){var t=this._position;if(t!==e){if(r(t)){this._subscription()}this._position=e;if(r(e)){this._subscription=e._definitionChanged.addEventListener(function(){this._definitionChanged.raiseEvent(this)},this)}this._definitionChanged.raiseEvent(this)}}},normalize:{get:function(){return this._normalize},set:function(e){if(this._normalize===e){return}this._normalize=e;this._definitionChanged.raiseEvent(this)}}});var l=new e;var c=new e;var d=new o;var f=1/60;u.prototype.getValue=function(e,t){return this._getValue(e,t)};u.prototype._getValue=function(t,i,a){if(!r(t)){throw new n("time is required")}if(!r(i)){i=new e}var u=this._position;if(s.isConstant(u)){return this._normalize?undefined:e.clone(e.ZERO,i)}var h=u.getValue(t,l);var p=u.getValue(o.addSeconds(t,f,d),c);if(!r(h)){return undefined}if(!r(p)){p=h;h=u.getValue(o.addSeconds(t,-f,d),c);if(!r(h)){return undefined}}if(e.equals(h,p)){return this._normalize?undefined:e.clone(e.ZERO,i)}if(r(a)){h.clone(a)}var m=e.subtract(p,h,i);if(this._normalize){return e.normalize(m,i)}else{return e.divideByScalar(m,f,i)}};u.prototype.equals=function(e){return this===e||e instanceof u&&s.equals(this._position,e._position)};return u});define("DataSources/CzmlDataSource",["../Core/BoundingRectangle","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartographic","../Core/ClockRange","../Core/ClockStep","../Core/Color","../Core/CornerType","../Core/createGuid","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Ellipsoid","../Core/Event","../Core/ExtrapolationType","../Core/getAbsoluteUri","../Core/getFilenameFromUri","../Core/HermitePolynomialApproximation","../Core/isArray","../Core/Iso8601","../Core/JulianDate","../Core/LagrangePolynomialApproximation","../Core/LinearApproximation","../Core/loadJson","../Core/Math","../Core/NearFarScalar","../Core/Quaternion","../Core/Rectangle","../Core/ReferenceFrame","../Core/RequestScheduler","../Core/RuntimeError","../Core/Spherical","../Core/TimeInterval","../Core/TimeIntervalCollection","../Scene/ColorBlendMode","../Scene/HeightReference","../Scene/HorizontalOrigin","../Scene/LabelStyle","../Scene/ShadowMode","../Scene/VerticalOrigin","../ThirdParty/Uri","../ThirdParty/when","./BillboardGraphics","./BoxGraphics","./ColorMaterialProperty","./CompositeMaterialProperty","./CompositePositionProperty","./CompositeProperty","./ConstantPositionProperty","./ConstantProperty","./CorridorGraphics","./CylinderGraphics","./DataSource","./DataSourceClock","./EllipseGraphics","./EllipsoidGraphics","./EntityCluster","./EntityCollection","./GridMaterialProperty","./ImageMaterialProperty","./LabelGraphics","./ModelGraphics","./NodeTransformationProperty","./PathGraphics","./PointGraphics","./PolygonGraphics","./PolylineArrowMaterialProperty","./PolylineGlowMaterialProperty","./PolylineGraphics","./PolylineOutlineMaterialProperty","./PositionPropertyArray","./PropertyArray","./PropertyBag","./RectangleGraphics","./ReferenceProperty","./Rotation","./SampledPositionProperty","./SampledProperty","./StripeMaterialProperty","./StripeOrientation","./TimeIntervalCollectionPositionProperty","./TimeIntervalCollectionProperty","./VelocityVectorProperty","./WallGraphics"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w,C,b,S,E,T,x,A,P,D,M,I,O,R,N,L,B,F,k,V,z,U,q,G,H,W,j,Y,X,Z,K,Q,J,$,ee,te,re,ie,ne,ae,oe,se,ue,le,ce,de,fe,he,pe,me,ve,_e,ge,ye,we,Ce,be,Se,Ee,Te,xe,Ae,Pe,De,Me){"use strict";var Ie;function Oe(e,t){if(t[0]==="#"){t=Ie+t}return Ce.fromString(e,t)}var Re=new r;var Ne=new O;var Le=new i;var Be=new R;function Fe(e){var t=e.rgbaf;if(c(t)){return t}var r=e.rgba;if(!c(r)){return undefined}var i=r.length;if(i===o.packedLength){return[o.byteToFloat(r[0]),o.byteToFloat(r[1]),o.byteToFloat(r[2]),o.byteToFloat(r[3])]}t=new Array(i);for(var n=0;n<i;n+=5){t[n]=r[n];t[n+1]=o.byteToFloat(r[n+1]);t[n+2]=o.byteToFloat(r[n+2]);t[n+3]=o.byteToFloat(r[n+3]);t[n+4]=o.byteToFloat(r[n+4])}return t}function ke(e,t){var r=l(e.uri,e);if(c(t)){r=v(r,v(t))}return r}function Ve(e){var t=e.wsen;if(c(t)){return t}var r=e.wsenDegrees;if(!c(r)){return undefined}var i=r.length;if(i===P.packedLength){return[T.toRadians(r[0]),T.toRadians(r[1]),T.toRadians(r[2]),T.toRadians(r[3])]}t=new Array(i);for(var n=0;n<i;n+=5){t[n]=r[n];t[n+1]=T.toRadians(r[n+1]);t[n+2]=T.toRadians(r[n+2]);t[n+3]=T.toRadians(r[n+3]);t[n+4]=T.toRadians(r[n+4])}return t}function ze(e){var t=e.length;Ne.magnitude=1;if(t===2){Ne.clock=e[0];Ne.cone=e[1];r.fromSpherical(Ne,Re);return[Re.x,Re.y,Re.z]}else{var i=new Array(t/3*4);for(var n=0,a=0;n<t;n+=3,a+=4){i[a]=e[n];Ne.clock=e[n+1];Ne.cone=e[n+2];r.fromSpherical(Ne,Re);i[a+1]=Re.x;i[a+2]=Re.y;i[a+3]=Re.z}return i}}function Ue(e){var t=e.length;if(t===3){Ne.clock=e[0];Ne.cone=e[1]
;Ne.magnitude=e[2];r.fromSpherical(Ne,Re);return[Re.x,Re.y,Re.z]}else{var i=new Array(t);for(var n=0;n<t;n+=4){i[n]=e[n];Ne.clock=e[n+1];Ne.cone=e[n+2];Ne.magnitude=e[n+3];r.fromSpherical(Ne,Re);i[n+1]=Re.x;i[n+2]=Re.y;i[n+3]=Re.z}return i}}function qe(e){var t=e.length;if(t===3){Le.longitude=e[0];Le.latitude=e[1];Le.height=e[2];h.WGS84.cartographicToCartesian(Le,Re);return[Re.x,Re.y,Re.z]}else{var r=new Array(t);for(var i=0;i<t;i+=4){r[i]=e[i];Le.longitude=e[i+1];Le.latitude=e[i+2];Le.height=e[i+3];h.WGS84.cartographicToCartesian(Le,Re);r[i+1]=Re.x;r[i+2]=Re.y;r[i+3]=Re.z}return r}}function Ge(e){var t=e.length;if(t===3){Le.longitude=T.toRadians(e[0]);Le.latitude=T.toRadians(e[1]);Le.height=e[2];h.WGS84.cartographicToCartesian(Le,Re);return[Re.x,Re.y,Re.z]}else{var r=new Array(t);for(var i=0;i<t;i+=4){r[i]=e[i];Le.longitude=T.toRadians(e[i+1]);Le.latitude=T.toRadians(e[i+2]);Le.height=e[i+3];h.WGS84.cartographicToCartesian(Le,Re);r[i+1]=Re.x;r[i+2]=Re.y;r[i+3]=Re.z}return r}}function He(e){var t=e.cartesian;if(c(t)){return t}var r=e.cartesianVelocity;if(c(r)){return r}var i=e.unitCartesian;if(c(i)){return i}var n=e.unitSpherical;if(c(n)){return ze(n)}var a=e.spherical;if(c(a)){return Ue(a)}var o=e.cartographicRadians;if(c(o)){return qe(o)}var s=e.cartographicDegrees;if(c(s)){return Ge(s)}throw new I(JSON.stringify(e)+" is not a valid CZML interval.")}function We(e,t){var r=e[t];var i=e[t+1];var n=e[t+2];var a=e[t+3];var o=1/Math.sqrt(r*r+i*i+n*n+a*a);e[t]=r*o;e[t+1]=i*o;e[t+2]=n*o;e[t+3]=a*o}function je(e){var t=e.unitQuaternion;if(c(t)){if(t.length===4){We(t,0);return t}for(var r=1;r<t.length;r+=5){We(t,r)}}return t}function Ye(i,n,a){switch(i){case Array:return n.array;case Boolean:return l(n["boolean"],n);case e:return n.boundingRectangle;case t:return n.cartesian2;case r:return He(n);case o:return Fe(n);case L:return L[l(n.colorBlendMode,n)];case s:return s[l(n.cornerType,n)];case B:return B[l(n.heightReference,n)];case F:return F[l(n.horizontalOrigin,n)];case Image:return ke(n,a);case C:return C.fromIso8601(l(n.date,n));case k:return k[l(n.labelStyle,n)];case Number:return l(n.number,n);case x:return n.nearFarScalar;case A:return je(n);case be:return l(n.number,n);case V:return V[l(n.shadows,n)];case String:return l(n.string,n);case xe:return xe[l(n.stripeOrientation,n)];case P:return Ve(n);case U:return ke(n,a);case z:return z[l(n.verticalOrigin,n)];default:throw new I(i)}}var Xe={HERMITE:g,LAGRANGE:b,LINEAR:S};function Ze(e,t){var r=e.interpolationAlgorithm;if(c(r)||c(e.interpolationDegree)){t.setInterpolationOptions({interpolationAlgorithm:Xe[r],interpolationDegree:e.interpolationDegree})}var i=e.forwardExtrapolationType;if(c(i)){t.forwardExtrapolationType=m[i]}var n=e.forwardExtrapolationDuration;if(c(n)){t.forwardExtrapolationDuration=n}var a=e.backwardExtrapolationType;if(c(a)){t.backwardExtrapolationType=m[a]}var o=e.backwardExtrapolationDuration;if(c(o)){t.backwardExtrapolationDuration=o}}function Ke(e,t,r,i,n,a,o){var s;var u=i.interval;if(c(u)){ft.iso8601=u;s=R.fromIso8601(ft);if(c(n)){s=R.intersect(s,n,Be)}}else if(c(n)){s=n}var d;var f;var h;var p;var m=c(i.reference);var v=c(s)&&!s.equals(w.MAXIMUM_INTERVAL);if(!m){h=Ye(e,i,a);d=l(e.packedLength,1);p=l(h.length,1);f=!c(i.array)&&typeof h!=="string"&&p>d}var _=typeof e.unpack==="function"&&e!==be;if(!f&&!v){if(m){t[r]=Oe(o,i.reference)}else if(_){t[r]=new K(e.unpack(h,0))}else{t[r]=new K(h)}return}var g=t[r];var y;var b=i.epoch;if(c(b)){y=C.fromIso8601(b)}if(f&&!v){if(!(g instanceof Ee)){g=new Ee(e);t[r]=g}g.addSamplesPackedArray(h,y);Ze(i,g);return}var S;if(!f&&v){s=s.clone();if(m){s.data=Oe(o,i.reference)}else if(_){s.data=e.unpack(h,0)}else{s.data=h}if(!c(g)){if(m){g=new X}else{g=new Pe}t[r]=g}if(!m&&g instanceof Pe){g.intervals.addInterval(s)}else if(g instanceof X){s.data=m?s.data:new K(s.data);g.intervals.addInterval(s)}else{S=w.MAXIMUM_INTERVAL.clone();S.data=g;g=new X;t[r]=g;g.intervals.addInterval(S);s.data=m?s.data:new K(s.data);g.intervals.addInterval(s)}return}if(!c(g)){g=new X;t[r]=g}if(!(g instanceof X)){S=w.MAXIMUM_INTERVAL.clone();S.data=g;g=new X;t[r]=g;g.intervals.addInterval(S)}var E=g.intervals;S=E.findInterval(s);if(!c(S)||!(S.data instanceof Ee)){S=s.clone();S.data=new Ee(e);E.addInterval(S)}S.data.addSamplesPackedArray(h,y);Ze(i,S.data)}function Qe(e,t,r,i,n,a,o){if(!c(i)){return}if(y(i)){for(var s=0,u=i.length;s<u;s++){Ke(e,t,r,i[s],n,a,o)}}else{Ke(e,t,r,i,n,a,o)}}function Je(e,t,i,n,a,o){var s;var u=i.interval;if(c(u)){ft.iso8601=u;s=R.fromIso8601(ft);if(c(n)){s=R.intersect(s,n,Be)}}else if(c(n)){s=n}var d;var f;var h=false;var p;var m=c(i.cartesianVelocity)?1:0;var v=r.packedLength*(m+1);var _=c(i.reference);var g=c(s)&&!s.equals(w.MAXIMUM_INTERVAL);if(!_){if(c(i.referenceFrame)){d=D[i.referenceFrame]}d=l(d,D.FIXED);f=He(i);p=l(f.length,1);h=p>v}if(!h&&!g){if(_){e[t]=Oe(o,i.reference)}else{e[t]=new Z(r.unpack(f),d)}return}var y=e[t];var b;var S=i.epoch;if(c(S)){b=C.fromIso8601(S)}if(h&&!g){if(!(y instanceof Se)||c(d)&&y.referenceFrame!==d){y=new Se(d,m);e[t]=y}y.addSamplesPackedArray(f,b);Ze(i,y);return}var E;if(!h&&g){s=s.clone();if(_){s.data=Oe(o,i.reference)}else{s.data=r.unpack(f)}if(!c(y)){if(_){y=new Y(d)}else{y=new Ae(d)}e[t]=y}if(!_&&y instanceof Ae&&(c(d)&&y.referenceFrame===d)){y.intervals.addInterval(s)}else if(y instanceof Y){s.data=_?s.data:new Z(s.data,d);y.intervals.addInterval(s)}else{E=w.MAXIMUM_INTERVAL.clone();E.data=y;y=new Y(y.referenceFrame);e[t]=y;y.intervals.addInterval(E);s.data=_?s.data:new Z(s.data,d);y.intervals.addInterval(s)}return}if(!c(y)){y=new Y(d);e[t]=y}else if(!(y instanceof Y)){E=w.MAXIMUM_INTERVAL.clone();E.data=y;y=new Y(y.referenceFrame);e[t]=y;y.intervals.addInterval(E)}var T=y.intervals;E=T.findInterval(s);if(!c(E)||!(E.data instanceof Se)||c(d)&&E.data.referenceFrame!==d){E=s.clone();E.data=new Se(d,m);T.addInterval(E)}E.data.addSamplesPackedArray(f,b);Ze(i,E.data)}function $e(e,t,r,i,n,a){if(!c(r)){return}if(y(r)){for(var o=0,s=r.length;o<s;o++){Je(e,t,r[o],i,n,a)}}else{Je(e,t,r,i,n,a)}}function et(e,r,i,n,a,s){var u;var l=i.interval;if(c(l)){ft.iso8601=l;u=R.fromIso8601(ft);if(c(n)){u=R.intersect(u,n,Be)}}else if(c(n)){u=n}var d=e[r];var f;var h;if(c(u)){if(!(d instanceof j)){d=new j;e[r]=d}var p=d.intervals;h=p.findInterval({start:u.start,stop:u.stop});if(c(h)){f=h.data}else{h=u.clone();p.addInterval(h)}}else{f=d}var m;if(c(i.solidColor)){if(!(f instanceof W)){f=new W}m=i.solidColor;Qe(o,f,"color",m.color,undefined,undefined,s)}else if(c(i.grid)){if(!(f instanceof ae)){f=new ae}m=i.grid;Qe(o,f,"color",m.color,undefined,a,s);Qe(Number,f,"cellAlpha",m.cellAlpha,undefined,a,s);Qe(t,f,"lineCount",m.lineCount,undefined,a,s);Qe(t,f,"lineThickness",m.lineThickness,undefined,a,s);Qe(t,f,"lineOffset",m.lineOffset,undefined,a,s)}else if(c(i.image)){if(!(f instanceof oe)){f=new oe}m=i.image;Qe(Image,f,"image",m.image,undefined,a,s);Qe(t,f,"repeat",m.repeat,undefined,a,s);Qe(o,f,"color",m.color,undefined,a,s);Qe(Boolean,f,"transparent",m.transparent,undefined,a,s)}else if(c(i.stripe)){if(!(f instanceof Te)){f=new Te}m=i.stripe;Qe(xe,f,"orientation",m.orientation,undefined,a,s);Qe(o,f,"evenColor",m.evenColor,undefined,a,s);Qe(o,f,"oddColor",m.oddColor,undefined,a,s);Qe(Number,f,"offset",m.offset,undefined,a,s);Qe(Number,f,"repeat",m.repeat,undefined,a,s)}else if(c(i.polylineOutline)){if(!(f instanceof ve)){f=new ve}m=i.polylineOutline;Qe(o,f,"color",m.color,undefined,a,s);Qe(o,f,"outlineColor",m.outlineColor,undefined,a,s);Qe(Number,f,"outlineWidth",m.outlineWidth,undefined,a,s)}else if(c(i.polylineGlow)){if(!(f instanceof pe)){f=new pe}m=i.polylineGlow;Qe(o,f,"color",m.color,undefined,a,s);Qe(Number,f,"glowPower",m.glowPower,undefined,a,s)}else if(c(i.polylineArrow)){if(!(f instanceof he)){f=new he}m=i.polylineArrow;Qe(o,f,"color",m.color,undefined,undefined,s)}if(c(h)){h.data=f}else{e[r]=f}}function tt(e,t,r,i,n,a){if(!c(r)){return}if(y(r)){for(var o=0,s=r.length;o<s;o++){et(e,t,r[o],i,n,a)}}else{et(e,t,r,i,n,a)}}function rt(e,t,r,i){e.name=l(t.name,e.name)}function it(e,t,r,i){var n=t.description;if(c(n)){Qe(String,e,"description",n,undefined,i,r)}}function nt(e,t,r,i){var n=t.position;if(c(n)){$e(e,"position",n,undefined,i,r)}}function at(e,t,i,n){var a=t.viewFrom;if(c(a)){Qe(r,e,"viewFrom",a,undefined,n,i)}}function ot(e,t,r,i){var n=t.orientation;if(c(n)){Qe(A,e,"orientation",n,undefined,i,r)}}function st(e,t,r,i){var n=r.references;if(c(n)){var a=n.map(function(e){return Oe(i,e)});var o=r.interval;if(c(o)){o=R.fromIso8601(o);if(!(e[t]instanceof Y)){o.data=new ge(a);var s=new X;s.intervals.addInterval(o);e[t]=s}}else{e[t]=new ge(a)}}else{Qe(Array,e,t,r,undefined,undefined,i)}}function ut(e,t,r,i){if(!c(r)){return}if(y(r)){for(var n=0,a=r.length;n<a;++n){st(e,t,r[n],i)}}else{st(e,t,r,i)}}function lt(e,t,i,n){if(c(i.references)){var a=i.references.map(function(e){return Oe(n,e)});var o=i.interval;if(c(o)){o=R.fromIso8601(o);if(!(e[t]instanceof Y)){o.data=new _e(a);var s=new Y;s.intervals.addInterval(o);e[t]=s}}else{e[t]=new _e(a)}}else{if(c(i.cartesian)){i.array=r.unpackArray(i.cartesian)}else if(c(i.cartographicRadians)){i.array=r.fromRadiansArrayHeights(i.cartographicRadians)}else if(c(i.cartographicDegrees)){i.array=r.fromDegreesArrayHeights(i.cartographicDegrees)}if(c(i.array)){Qe(Array,e,t,i,undefined,undefined,n)}}}function ct(e,t,r,i){if(!c(r)){return}if(y(r)){for(var n=0,a=r.length;n<a;n++){lt(e,t,r[n],i)}}else{lt(e,t,r,i)}}function dt(e,t,r,i){var n;var a=t.availability;if(!c(a)){return}var o;if(y(a)){var s=a.length;for(var u=0;u<s;u++){if(!c(o)){o=new N}ft.iso8601=a[u];n=R.fromIso8601(ft);o.addInterval(n)}}else{ft.iso8601=a;n=R.fromIso8601(ft);o=new N;o.addInterval(n)}e.availability=o}var ft={iso8601:undefined};function ht(e,t,i,n,a){if(!c(t)){return}if(c(t.velocityReference)){e.alignedAxis=new De(Oe(a,t.velocityReference),true)}else{Qe(r,e,"alignedAxis",t,i,n,a)}}function pt(i,n,a,s){var u=n.billboard;if(!c(u)){return}var l;var d=u.interval;if(c(d)){ft.iso8601=d;l=R.fromIso8601(ft)}var f=i.billboard;if(!c(f)){i.billboard=f=new G}Qe(Boolean,f,"show",u.show,l,s,a);Qe(Image,f,"image",u.image,l,s,a);Qe(Number,f,"scale",u.scale,l,s,a);Qe(t,f,"pixelOffset",u.pixelOffset,l,s,a);Qe(r,f,"eyeOffset",u.eyeOffset,l,s,a);Qe(F,f,"horizontalOrigin",u.horizontalOrigin,l,s,a);Qe(z,f,"verticalOrigin",u.verticalOrigin,l,s,a);Qe(B,f,"heightReference",u.heightReference,l,s,a);Qe(o,f,"color",u.color,l,s,a);Qe(be,f,"rotation",u.rotation,l,s,a);ht(f,u.alignedAxis,l,s,a);Qe(Boolean,f,"sizeInMeters",u.sizeInMeters,l,s,a);Qe(Number,f,"width",u.width,l,s,a);Qe(Number,f,"height",u.height,l,s,a);Qe(x,f,"scaleByDistance",u.scaleByDistance,l,s,a);Qe(x,f,"translucencyByDistance",u.translucencyByDistance,l,s,a);Qe(x,f,"pixelOffsetScaleByDistance",u.pixelOffsetScaleByDistance,l,s,a);Qe(e,f,"imageSubRegion",u.imageSubRegion,l,s,a)}function mt(e,t,i,n){var a=t.box;if(!c(a)){return}var s;var u=a.interval;if(c(u)){ft.iso8601=u;s=R.fromIso8601(ft)}var l=e.box;if(!c(l)){e.box=l=new H}Qe(Boolean,l,"show",a.show,s,n,i);Qe(r,l,"dimensions",a.dimensions,s,n,i);Qe(Boolean,l,"fill",a.fill,s,n,i);tt(l,"material",a.material,s,n,i);Qe(Boolean,l,"outline",a.outline,s,n,i);Qe(o,l,"outlineColor",a.outlineColor,s,n,i);Qe(Number,l,"outlineWidth",a.outlineWidth,s,n,i);Qe(V,l,"shadows",a.shadows,s,n,i)}function vt(e,t,r,i){var n=t.corridor;if(!c(n)){return}var a;var u=n.interval;if(c(u)){ft.iso8601=u;a=R.fromIso8601(ft)}var l=e.corridor;if(!c(l)){e.corridor=l=new Q}Qe(Boolean,l,"show",n.show,a,i,r);ct(l,"positions",n.positions,r);Qe(Number,l,"width",n.width,a,i,r);Qe(Number,l,"height",n.height,a,i,r);Qe(Number,l,"extrudedHeight",n.extrudedHeight,a,i,r);Qe(s,l,"cornerType",n.cornerType,a,i,r);Qe(Number,l,"granularity",n.granularity,a,i,r);Qe(Boolean,l,"fill",n.fill,a,i,r);tt(l,"material",n.material,a,i,r);Qe(Boolean,l,"outline",n.outline,a,i,r);Qe(o,l,"outlineColor",n.outlineColor,a,i,r);Qe(Number,l,"outlineWidth",n.outlineWidth,a,i,r);Qe(V,l,"shadows",n.shadows,a,i,r)}function _t(e,t,r,i){var n=t.cylinder;if(!c(n)){return}var a;var s=n.interval;if(c(s)){ft.iso8601=s;a=R.fromIso8601(ft)}var u=e.cylinder;if(!c(u)){e.cylinder=u=new J}Qe(Boolean,u,"show",n.show,a,i,r);Qe(Number,u,"length",n.length,a,i,r);Qe(Number,u,"topRadius",n.topRadius,a,i,r);Qe(Number,u,"bottomRadius",n.bottomRadius,a,i,r);Qe(Boolean,u,"fill",n.fill,a,i,r);tt(u,"material",n.material,a,i,r);Qe(Boolean,u,"outline",n.outline,a,i,r);Qe(o,u,"outlineColor",n.outlineColor,a,i,r);Qe(Number,u,"outlineWidth",n.outlineWidth,a,i,r);Qe(Number,u,"numberOfVerticalLines",n.numberOfVerticalLines,a,i,r);Qe(Number,u,"slices",n.slices,a,i,r);Qe(V,u,"shadows",n.shadows,a,i,r)}function gt(e,t){var r=e.version;if(c(r)){if(typeof r==="string"){var i=r.split(".");if(i.length===2){if(i[0]!=="1"){throw new I("Cesium only supports CZML version 1.")}t._version=r}}}if(!c(t._version)){throw new I("CZML version information invalid.  It is expected to be a property on the document object in the <Major>.<Minor> version format.")}var n=t._documentPacket;if(c(e.name)){n.name=e.name}var a=e.clock;if(c(a)){var o=n.clock;if(!c(o)){n.clock={interval:a.interval,currentTime:a.currentTime,range:a.range,step:a.step,multiplier:a.multiplier}}else{o.interval=l(a.interval,o.interval);o.currentTime=l(a.currentTime,o.currentTime);o.range=l(a.range,o.range);o.step=l(a.step,o.step);o.multiplier=l(a.multiplier,o.multiplier)}}}function yt(e,t,r,i){var n=t.ellipse;if(!c(n)){return}var a;var s=n.interval;if(c(s)){ft.iso8601=s;a=R.fromIso8601(ft)}var u=e.ellipse;if(!c(u)){e.ellipse=u=new te}Qe(Boolean,u,"show",n.show,a,i,r);Qe(Number,u,"semiMajorAxis",n.semiMajorAxis,a,i,r);Qe(Number,u,"semiMinorAxis",n.semiMinorAxis,a,i,r);Qe(Number,u,"height",n.height,a,i,r);Qe(Number,u,"extrudedHeight",n.extrudedHeight,a,i,r);Qe(be,u,"rotation",n.rotation,a,i,r);Qe(be,u,"stRotation",n.stRotation,a,i,r);Qe(Number,u,"granularity",n.granularity,a,i,r);Qe(Boolean,u,"fill",n.fill,a,i,r);tt(u,"material",n.material,a,i,r);Qe(Boolean,u,"outline",n.outline,a,i,r);Qe(o,u,"outlineColor",n.outlineColor,a,i,r);Qe(Number,u,"outlineWidth",n.outlineWidth,a,i,r);Qe(Number,u,"numberOfVerticalLines",n.numberOfVerticalLines,a,i,r);Qe(V,u,"shadows",n.shadows,a,i,r)}function wt(e,t,i,n){var a=t.ellipsoid;if(!c(a)){return}var s;var u=a.interval;if(c(u)){ft.iso8601=u;s=R.fromIso8601(ft)}var l=e.ellipsoid;if(!c(l)){e.ellipsoid=l=new re}Qe(Boolean,l,"show",a.show,s,n,i);Qe(r,l,"radii",a.radii,s,n,i);Qe(Boolean,l,"fill",a.fill,s,n,i);tt(l,"material",a.material,s,n,i);Qe(Boolean,l,"outline",a.outline,s,n,i);Qe(o,l,"outlineColor",a.outlineColor,s,n,i);Qe(Number,l,"outlineWidth",a.outlineWidth,s,n,i);Qe(Number,l,"stackPartitions",a.stackPartitions,s,n,i);Qe(Number,l,"slicePartitions",a.slicePartitions,s,n,i);Qe(Number,l,"subdivisions",a.subdivisions,s,n,i);Qe(V,l,"shadows",a.shadows,s,n,i)}function Ct(e,i,n,a){var s=i.label;if(!c(s)){return}var u;var l=s.interval;if(c(l)){ft.iso8601=l;u=R.fromIso8601(ft)}var d=e.label;if(!c(d)){e.label=d=new se}Qe(Boolean,d,"show",s.show,u,a,n);Qe(String,d,"text",s.text,u,a,n);Qe(String,d,"font",s.font,u,a,n);Qe(k,d,"style",s.style,u,a,n);Qe(Number,d,"scale",s.scale,u,a,n);Qe(Boolean,d,"showBackground",s.showBackground,u,a,n);Qe(o,d,"backgroundColor",s.backgroundColor,u,a,n);Qe(t,d,"backgroundPadding",s.backgroundPadding,u,a,n);Qe(t,d,"pixelOffset",s.pixelOffset,u,a,n);Qe(r,d,"eyeOffset",s.eyeOffset,u,a,n);Qe(F,d,"horizontalOrigin",s.horizontalOrigin,u,a,n);Qe(z,d,"verticalOrigin",s.verticalOrigin,u,a,n);Qe(B,d,"heightReference",s.heightReference,u,a,n);Qe(o,d,"fillColor",s.fillColor,u,a,n);Qe(o,d,"outlineColor",s.outlineColor,u,a,n);Qe(Number,d,"outlineWidth",s.outlineWidth,u,a,n);Qe(x,d,"translucencyByDistance",s.translucencyByDistance,u,a,n);Qe(x,d,"pixelOffsetScaleByDistance",s.pixelOffsetScaleByDistance,u,a,n)}function bt(e,t,r,i){var n=t.model;if(!c(n)){return}var a;var s=n.interval;if(c(s)){ft.iso8601=s;a=R.fromIso8601(ft)}var u=e.model;if(!c(u)){e.model=u=new ue}Qe(Boolean,u,"show",n.show,a,i,r);Qe(U,u,"uri",n.gltf,a,i,r);Qe(Number,u,"scale",n.scale,a,i,r);Qe(Number,u,"minimumPixelSize",n.minimumPixelSize,a,i,r);Qe(Number,u,"maximumScale",n.maximumScale,a,i,r);Qe(Boolean,u,"incrementallyLoadTextures",n.incrementallyLoadTextures,a,i,r);Qe(Boolean,u,"runAnimations",n.runAnimations,a,i,r);Qe(V,u,"shadows",n.shadows,a,i,r);Qe(B,u,"heightReference",n.heightReference,a,i,r);Qe(o,u,"silhouetteColor",n.silhouetteColor,a,i,r);Qe(Number,u,"silhouetteSize",n.silhouetteSize,a,i,r);Qe(o,u,"color",n.color,a,i,r);Qe(L,u,"colorBlendMode",n.colorBlendMode,a,i,r);Qe(Number,u,"colorBlendAmount",n.colorBlendAmount,a,i,r);var l=n.nodeTransformations;if(c(l)){if(y(l)){for(var d=0,f=l.length;d<f;d++){St(u,l[d],a,i,r)}}else{St(u,l,a,i,r)}}}function St(e,t,i,n,a){var o;var s=t.interval;if(c(s)){ft.iso8601=s;o=R.fromIso8601(ft);if(c(i)){o=R.intersect(o,i,Be)}}else if(c(i)){o=i}var u=e.nodeTransformations;var l=Object.keys(t);for(var d=0,f=l.length;d<f;++d){var h=l[d];if(h==="interval"){continue}var p=t[h];if(!c(p)){continue}if(!c(u)){e.nodeTransformations=u=new ye}if(!u.hasProperty(h)){u.addProperty(h)}var m=u[h];if(!c(m)){u[h]=m=new le}Qe(r,m,"translation",p.translation,o,n,a);Qe(A,m,"rotation",p.rotation,o,n,a);Qe(r,m,"scale",p.scale,o,n,a)}}function Et(e,t,r,i){var n=t.path;if(!c(n)){return}var a;var o=n.interval;if(c(o)){ft.iso8601=o;a=R.fromIso8601(ft)}var s=e.path;if(!c(s)){e.path=s=new ce}Qe(Boolean,s,"show",n.show,a,i,r);Qe(Number,s,"width",n.width,a,i,r);Qe(Number,s,"resolution",n.resolution,a,i,r);Qe(Number,s,"leadTime",n.leadTime,a,i,r);Qe(Number,s,"trailTime",n.trailTime,a,i,r);tt(s,"material",n.material,a,i,r)}function Tt(e,t,r,i){var n=t.point;if(!c(n)){return}var a;var s=n.interval;if(c(s)){ft.iso8601=s;a=R.fromIso8601(ft)}var u=e.point;if(!c(u)){e.point=u=new de}Qe(Boolean,u,"show",n.show,a,i,r);Qe(Number,u,"pixelSize",n.pixelSize,a,i,r);Qe(B,u,"heightReference",n.heightReference,a,i,r);Qe(o,u,"color",n.color,a,i,r);Qe(o,u,"outlineColor",n.outlineColor,a,i,r);Qe(Number,u,"outlineWidth",n.outlineWidth,a,i,r);Qe(x,u,"scaleByDistance",n.scaleByDistance,a,i,r);Qe(x,u,"translucencyByDistance",n.translucencyByDistance,a,i,r)}function xt(e,t,r,i){var n=t.polygon;if(!c(n)){return}var a;var s=n.interval;if(c(s)){ft.iso8601=s;a=R.fromIso8601(ft)}var u=e.polygon;if(!c(u)){e.polygon=u=new fe}Qe(Boolean,u,"show",n.show,a,i,r);ct(u,"hierarchy",n.positions,r);Qe(Number,u,"height",n.height,a,i,r);Qe(Number,u,"extrudedHeight",n.extrudedHeight,a,i,r);Qe(be,u,"stRotation",n.stRotation,a,i,r);Qe(Number,u,"granularity",n.granularity,a,i,r);Qe(Boolean,u,"fill",n.fill,a,i,r);tt(u,"material",n.material,a,i,r);Qe(Boolean,u,"outline",n.outline,a,i,r);Qe(o,u,"outlineColor",n.outlineColor,a,i,r);Qe(Number,u,"outlineWidth",n.outlineWidth,a,i,r);Qe(Boolean,u,"perPositionHeight",n.perPositionHeight,a,i,r);Qe(Boolean,u,"closeTop",n.closeTop,a,i,r);Qe(Boolean,u,"closeBottom",n.closeBottom,a,i,r);Qe(V,u,"shadows",n.shadows,a,i,r)}function At(e,t,r,i){var n=t.polyline;if(!c(n)){return}var a;var o=n.interval;if(c(o)){ft.iso8601=o;a=R.fromIso8601(ft)}var s=e.polyline;if(!c(s)){e.polyline=s=new me}Qe(Boolean,s,"show",n.show,a,i,r);ct(s,"positions",n.positions,r);Qe(Number,s,"width",n.width,a,i,r);Qe(Number,s,"granularity",n.granularity,a,i,r);tt(s,"material",n.material,a,i,r);Qe(Boolean,s,"followSurface",n.followSurface,a,i,r);Qe(V,s,"shadows",n.shadows,a,i,r)}function Pt(e,t,r,i){var n=t.rectangle;if(!c(n)){return}var a;var s=n.interval;if(c(s)){ft.iso8601=s;a=R.fromIso8601(ft)}var u=e.rectangle;if(!c(u)){e.rectangle=u=new we}Qe(Boolean,u,"show",n.show,a,i,r);Qe(P,u,"coordinates",n.coordinates,a,i,r);Qe(Number,u,"height",n.height,a,i,r);Qe(Number,u,"extrudedHeight",n.extrudedHeight,a,i,r);Qe(be,u,"rotation",n.rotation,a,i,r);Qe(be,u,"stRotation",n.stRotation,a,i,r);Qe(Number,u,"granularity",n.granularity,a,i,r);Qe(Boolean,u,"fill",n.fill,a,i,r);tt(u,"material",n.material,a,i,r);Qe(Boolean,u,"outline",n.outline,a,i,r);Qe(o,u,"outlineColor",n.outlineColor,a,i,r);Qe(Number,u,"outlineWidth",n.outlineWidth,a,i,r);Qe(Boolean,u,"closeTop",n.closeTop,a,i,r);Qe(Boolean,u,"closeBottom",n.closeBottom,a,i,r);Qe(V,u,"shadows",n.shadows,a,i,r)}function Dt(e,t,r,i){var n=t.wall;if(!c(n)){return}var a;var s=n.interval;if(c(s)){ft.iso8601=s;a=R.fromIso8601(ft)}var u=e.wall;if(!c(u)){e.wall=u=new Me}Qe(Boolean,u,"show",n.show,a,i,r);ct(u,"positions",n.positions,r);ut(u,"minimumHeights",n.minimumHeights,r);ut(u,"maximumHeights",n.maximumHeights,r);Qe(Number,u,"granularity",n.granularity,a,i,r);Qe(Boolean,u,"fill",n.fill,a,i,r);tt(u,"material",n.material,a,i,r);Qe(Boolean,u,"outline",n.outline,a,i,r);Qe(o,u,"outlineColor",n.outlineColor,a,i,r);Qe(Number,u,"outlineWidth",n.outlineWidth,a,i,r);Qe(V,u,"shadows",n.shadows,a,i,r)}function Mt(e,t,r,i,n){var a=e.id;if(!c(a)){a=u()}Ie=a;if(!c(n._version)&&a!=="document"){throw new I("The first CZML packet is required to be the document object.")}if(e["delete"]===true){t.removeById(a)}else if(a==="document"){gt(e,n)}else{var o=t.getOrCreateEntity(a);var s=e.parent;if(c(s)){o.parent=t.getOrCreateEntity(s)}for(var l=r.length-1;l>-1;l--){r[l](o,e,t,i)}}Ie=undefined}function It(e){var t;var r=e._documentPacket.clock;if(!c(r)){if(!c(e._clock)){var i=e._entityCollection.computeAvailability();if(!i.start.equals(w.MINIMUM_VALUE)){var o=i.start;var s=i.stop;var u=C.secondsDifference(s,o);var d=Math.round(u/120);t=new ee;t.startTime=C.clone(o);t.stopTime=C.clone(s);t.clockRange=n.LOOP_STOP;t.multiplier=d;t.currentTime=C.clone(o);t.clockStep=a.SYSTEM_CLOCK_MULTIPLIER;e._clock=t;return true}}return false}if(c(e._clock)){t=e._clock.clone()}else{t=new ee;t.startTime=w.MINIMUM_VALUE.clone();t.stopTime=w.MAXIMUM_VALUE.clone();t.currentTime=w.MINIMUM_VALUE.clone();t.clockRange=n.LOOP_STOP;t.clockStep=a.SYSTEM_CLOCK_MULTIPLIER;t.multiplier=1}if(c(r.interval)){ft.iso8601=r.interval;var f=R.fromIso8601(ft);t.startTime=f.start;t.stopTime=f.stop}if(c(r.currentTime)){t.currentTime=C.fromIso8601(r.currentTime)}if(c(r.range)){t.clockRange=l(n[r.range],n.LOOP_STOP)}if(c(r.step)){t.clockStep=l(a[r.step],a.SYSTEM_CLOCK_MULTIPLIER)}if(c(r.multiplier)){t.multiplier=r.multiplier}if(!t.equals(e._clock)){e._clock=t.clone(e._clock);return true}return false}function Ot(e,t,r,i){if(!c(t)){throw new f("czml is required.")}r=l(r,l.EMPTY_OBJECT);var n=t;var a=r.sourceUri;if(typeof t==="string"){n=M.request(t,E);a=l(a,t)}$.setLoading(e,true);return q(n,function(t){return Rt(e,t,a,i)}).otherwise(function(t){$.setLoading(e,false);e._error.raiseEvent(e,t);console.log(t);return q.reject(t)})}function Rt(e,t,r,i){$.setLoading(e,true);var n=e._entityCollection;if(i){e._version=undefined;e._documentPacket=new Nt;n.removeAll()}Lt._processCzml(t,n,r,undefined,e);var a=It(e);var o=e._documentPacket;if(c(o.name)&&e._name!==o.name){e._name=o.name;a=true}else if(!c(e._name)&&c(r)){e._name=_(r);a=true}$.setLoading(e,false);if(a){e._changed.raiseEvent(e)}return e}function Nt(){this.name=undefined;this.clock=undefined}function Lt(e){this._name=e;this._changed=new p;this._error=new p;this._isLoading=false;this._loading=new p;this._clock=undefined;this._documentPacket=new Nt;this._version=undefined;this._entityCollection=new ne(this);this._entityCluster=new ie}Lt.load=function(e,t){return(new Lt).load(e,t)};d(Lt.prototype,{name:{get:function(){return this._name}},clock:{get:function(){return this._clock}},entities:{get:function(){return this._entityCollection}},isLoading:{get:function(){return this._isLoading}},changedEvent:{get:function(){return this._changed}},errorEvent:{get:function(){return this._error}},loadingEvent:{get:function(){return this._loading}},show:{get:function(){return this._entityCollection.show},set:function(e){this._entityCollection.show=e}},clustering:{get:function(){return this._entityCluster},set:function(e){if(!c(e)){throw new f("value must be defined.")}this._entityCluster=e}}});Lt.updaters=[pt,mt,vt,_t,yt,wt,Ct,bt,rt,it,Et,Tt,xt,At,Pt,nt,at,Dt,ot,dt];Lt.prototype.process=function(e,t){return Ot(this,e,t,false)};Lt.prototype.load=function(e,t){return Ot(this,e,t,true)};Lt.processPacketData=Qe;Lt.processPositionPacketData=$e;Lt.processMaterialPacketData=tt;Lt._processCzml=function(e,t,r,i,n){i=c(i)?i:Lt.updaters;if(y(e)){for(var a=0,o=e.length;a<o;a++){Mt(e[a],t,i,r,n)}}else{Mt(e,t,i,r,n)}};return Lt});define("DataSources/DataSourceCollection",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/Event","../ThirdParty/when"],function(e,t,r,i,n,a,o){"use strict";function s(){this._dataSources=[];this._dataSourceAdded=new a;this._dataSourceRemoved=new a}r(s.prototype,{length:{get:function(){return this._dataSources.length}},dataSourceAdded:{get:function(){return this._dataSourceAdded}},dataSourceRemoved:{get:function(){return this._dataSourceRemoved}}});s.prototype.add=function(e){if(!t(e)){throw new n("dataSource is required.")}var r=this;var i=this._dataSources;return o(e,function(e){if(i===r._dataSources){r._dataSources.push(e);r._dataSourceAdded.raiseEvent(r,e)}return e})};s.prototype.remove=function(t,r){r=e(r,false);var i=this._dataSources.indexOf(t);if(i!==-1){this._dataSources.splice(i,1);this._dataSourceRemoved.raiseEvent(this,t);if(r&&typeof t.destroy==="function"){t.destroy()}return true}return false};s.prototype.removeAll=function(t){t=e(t,false);var r=this._dataSources;for(var i=0,n=r.length;i<n;++i){var a=r[i];this._dataSourceRemoved.raiseEvent(this,a);if(t&&typeof a.destroy==="function"){a.destroy()}}this._dataSources=[]};s.prototype.contains=function(e){return this.indexOf(e)!==-1};s.prototype.indexOf=function(e){return this._dataSources.indexOf(e)};s.prototype.get=function(e){if(!t(e)){throw new n("index is required.")}return this._dataSources[e]};s.prototype.isDestroyed=function(){return false};s.prototype.destroy=function(){this.removeAll(true);return i(this)};return s});define("DataSources/EllipseGeometryUpdater",["../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/EllipseGeometry","../Core/EllipseOutlineGeometry","../Core/Event","../Core/GeometryInstance","../Core/Iso8601","../Core/oneTimeWarning","../Core/ShowGeometryInstanceAttribute","../Scene/GroundPrimitive","../Scene/MaterialAppearance","../Scene/PerInstanceColorAppearance","../Scene/Primitive","../Scene/ShadowMode","./ColorMaterialProperty","./ConstantProperty","./dynamicGeometryGetBoundingSphere","./MaterialProperty","./Property"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w,C,b,S,E,T){"use strict";var x=new C(e.WHITE);var A=new b(true);var P=new b(true);var D=new b(false);var M=new b(e.BLACK);var I=new b(w.DISABLED);var O=new b(new s);var R=new e;function N(e){this.id=e;this.vertexFormat=undefined;this.center=undefined;this.semiMajorAxis=undefined;this.semiMinorAxis=undefined;this.rotation=undefined;this.height=undefined;this.extrudedHeight=undefined;this.granularity=undefined;this.stRotation=undefined;this.numberOfVerticalLines=undefined}function L(e,t){if(!i(e)){throw new o("entity is required")}if(!i(t)){throw new o("scene is required")}this._entity=e;this._scene=t;this._entitySubscription=e.definitionChanged.addEventListener(L.prototype._onEntityPropertyChanged,this);this._fillEnabled=false;this._isClosed=false;this._dynamic=false;this._outlineEnabled=false;this._geometryChanged=new d;this._showProperty=undefined;this._materialProperty=undefined;this._hasConstantOutline=true;this._showOutlineProperty=undefined;this._outlineColorProperty=undefined;this._outlineWidth=1;this._shadowsProperty=undefined;this._distanceDisplayConditionProperty=undefined;this._onTerrain=false;this._options=new N(e);this._onEntityPropertyChanged(e,"ellipse",e.ellipse,undefined)}n(L,{perInstanceColorAppearanceType:{value:g},materialAppearanceType:{value:_}});n(L.prototype,{entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!i(this._entity.availability)&&T.isConstant(this._showProperty)&&T.isConstant(this._fillProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},outlineEnabled:{get:function(){return this._outlineEnabled}},hasConstantOutline:{get:function(){return!this._outlineEnabled||!i(this._entity.availability)&&T.isConstant(this._showProperty)&&T.isConstant(this._showOutlineProperty)}},outlineColorProperty:{get:function(){return this._outlineColorProperty}},outlineWidth:{get:function(){return this._outlineWidth}},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayConditionProperty}},isDynamic:{get:function(){return this._dynamic}},isClosed:{get:function(){return this._isClosed}},onTerrain:{get:function(){return this._onTerrain}},geometryChanged:{get:function(){return this._geometryChanged}}});L.prototype.isOutlineVisible=function(e){var t=this._entity;return this._outlineEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)};L.prototype.isFilled=function(e){var t=this._entity;return this._fillEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)};L.prototype.createFillGeometryInstance=function(r){if(!i(r)){throw new o("time is required.")}if(!this._fillEnabled){throw new o("This instance does not represent a filled geometry.")}var n=this._entity;var a=n.isAvailable(r);var s;var c;var d=new m(a&&n.isShowing&&this._showProperty.getValue(r)&&this._fillProperty.getValue(r));var h=this._distanceDisplayConditionProperty.getValue(r);var p=u.fromDistanceDisplayCondition(h);if(this._materialProperty instanceof C){var v=e.WHITE;if(i(this._materialProperty.color)&&(this._materialProperty.color.isConstant||a)){v=this._materialProperty.color.getValue(r)}c=t.fromColor(v);s={show:d,distanceDisplayCondition:p,color:c}}else{s={show:d,distanceDisplayCondition:p}}return new f({id:n,geometry:new l(this._options),attributes:s})};L.prototype.createOutlineGeometryInstance=function(r){if(!i(r)){throw new o("time is required.")}if(!this._outlineEnabled){throw new o("This instance does not represent an outlined geometry.")}var n=this._entity;var a=n.isAvailable(r);var s=T.getValueOrDefault(this._outlineColorProperty,r,e.BLACK);var l=this._distanceDisplayConditionProperty.getValue(r);return new f({id:n,geometry:new c(this._options),attributes:{show:new m(a&&n.isShowing&&this._showProperty.getValue(r)&&this._showOutlineProperty.getValue(r)),color:t.fromColor(s),distanceDisplayCondition:u.fromDistanceDisplayCondition(l)}})};L.prototype.isDestroyed=function(){return false};L.prototype.destroy=function(){this._entitySubscription();a(this)};L.prototype._onEntityPropertyChanged=function(e,t,n,a){if(!(t==="availability"||t==="position"||t==="ellipse")){return}var o=this._entity.ellipse;if(!i(o)){if(this._fillEnabled||this._outlineEnabled){this._fillEnabled=false;this._outlineEnabled=false;this._geometryChanged.raiseEvent(this)}return}var s=o.fill;var u=i(s)&&s.isConstant?s.getValue(h.MINIMUM_VALUE):true;var l=o.outline;var c=i(l);if(c&&l.isConstant){c=l.getValue(h.MINIMUM_VALUE)}if(!u&&!c){if(this._fillEnabled||this._outlineEnabled){this._fillEnabled=false;this._outlineEnabled=false;this._geometryChanged.raiseEvent(this)}return}var d=this._entity.position;var f=o.semiMajorAxis;var m=o.semiMinorAxis;var y=o.show;if(i(y)&&y.isConstant&&!y.getValue(h.MINIMUM_VALUE)||(!i(d)||!i(f)||!i(m))){if(this._fillEnabled||this._outlineEnabled){this._fillEnabled=false;this._outlineEnabled=false;this._geometryChanged.raiseEvent(this)}return}var w=r(o.material,x);var b=w instanceof C;this._materialProperty=w;this._fillProperty=r(s,P);this._showProperty=r(y,A);this._showOutlineProperty=r(o.outline,D)
;this._outlineColorProperty=c?r(o.outlineColor,M):undefined;this._shadowsProperty=r(o.shadows,I);this._distanceDisplayConditionProperty=r(o.distanceDisplayCondition,O);var S=o.rotation;var E=o.height;var R=o.extrudedHeight;var N=o.granularity;var L=o.stRotation;var B=o.outlineWidth;var F=o.numberOfVerticalLines;var k=u&&!i(E)&&!i(R)&&b&&v.isSupported(this._scene);if(c&&k){p(p.geometryOutlines);c=false}this._fillEnabled=u;this._onTerrain=k;this._isClosed=i(R)||k;this._outlineEnabled=c;if(!d.isConstant||!f.isConstant||!m.isConstant||!T.isConstant(S)||!T.isConstant(E)||!T.isConstant(R)||!T.isConstant(N)||!T.isConstant(L)||!T.isConstant(B)||!T.isConstant(F)||k&&!T.isConstant(w)){if(!this._dynamic){this._dynamic=true;this._geometryChanged.raiseEvent(this)}}else{var V=this._options;V.vertexFormat=b?g.VERTEX_FORMAT:_.MaterialSupport.TEXTURED.vertexFormat;V.center=d.getValue(h.MINIMUM_VALUE,V.center);V.semiMajorAxis=f.getValue(h.MINIMUM_VALUE,V.semiMajorAxis);V.semiMinorAxis=m.getValue(h.MINIMUM_VALUE,V.semiMinorAxis);V.rotation=i(S)?S.getValue(h.MINIMUM_VALUE):undefined;V.height=i(E)?E.getValue(h.MINIMUM_VALUE):undefined;V.extrudedHeight=i(R)?R.getValue(h.MINIMUM_VALUE):undefined;V.granularity=i(N)?N.getValue(h.MINIMUM_VALUE):undefined;V.stRotation=i(L)?L.getValue(h.MINIMUM_VALUE):undefined;V.numberOfVerticalLines=i(F)?F.getValue(h.MINIMUM_VALUE):undefined;this._outlineWidth=i(B)?B.getValue(h.MINIMUM_VALUE):1;this._dynamic=false;this._geometryChanged.raiseEvent(this)}};L.prototype.createDynamicUpdater=function(e,t){if(!this._dynamic){throw new o("This instance does not represent dynamic geometry.")}if(!i(e)){throw new o("primitives is required.")}return new B(e,t,this)};function B(e,t,r){this._primitives=e;this._groundPrimitives=t;this._primitive=undefined;this._outlinePrimitive=undefined;this._geometryUpdater=r;this._options=new N(r._entity)}B.prototype.update=function(r){if(!i(r)){throw new o("time is required.")}var n=this._geometryUpdater;var a=n._onTerrain;var s=this._primitives;var d=this._groundPrimitives;if(a){d.removeAndDestroy(this._primitive)}else{s.removeAndDestroy(this._primitive);s.removeAndDestroy(this._outlinePrimitive);this._outlinePrimitive=undefined}this._primitive=undefined;var h=n._entity;var p=h.ellipse;if(!h.isShowing||!h.isAvailable(r)||!T.getValueOrDefault(p.show,r,true)){return}var m=this._options;var w=T.getValueOrUndefined(h.position,r,m.center);var C=T.getValueOrUndefined(p.semiMajorAxis,r);var b=T.getValueOrUndefined(p.semiMinorAxis,r);if(!i(w)||!i(C)||!i(b)){return}m.center=w;m.semiMajorAxis=C;m.semiMinorAxis=b;m.rotation=T.getValueOrUndefined(p.rotation,r);m.height=T.getValueOrUndefined(p.height,r);m.extrudedHeight=T.getValueOrUndefined(p.extrudedHeight,r);m.granularity=T.getValueOrUndefined(p.granularity,r);m.stRotation=T.getValueOrUndefined(p.stRotation,r);m.numberOfVerticalLines=T.getValueOrUndefined(p.numberOfVerticalLines,r);var S=this._geometryUpdater.shadowsProperty.getValue(r);var x=this._geometryUpdater.distanceDisplayConditionProperty;var A=x.getValue(r);var P=u.fromDistanceDisplayCondition(A);if(T.getValueOrDefault(p.fill,r,true)){var D=n.fillMaterialProperty;var M=E.getValue(r,D,this._material);this._material=M;if(a){var I=e.WHITE;if(i(D.color)){I=D.color.getValue(r)}this._primitive=d.add(new v({geometryInstances:new f({id:h,geometry:new l(m),attributes:{color:t.fromColor(I),distanceDisplayCondition:P}}),asynchronous:false,shadows:S}))}else{var O=new _({material:M,translucent:M.isTranslucent(),closed:i(m.extrudedHeight)});m.vertexFormat=O.vertexFormat;this._primitive=s.add(new y({geometryInstances:new f({id:h,geometry:new l(m)}),attributes:{distanceDisplayCondition:P},appearance:O,asynchronous:false,shadows:S}))}}if(!a&&T.getValueOrDefault(p.outline,r,false)){m.vertexFormat=g.VERTEX_FORMAT;var N=T.getValueOrClonedDefault(p.outlineColor,r,e.BLACK,R);var L=T.getValueOrDefault(p.outlineWidth,r,1);var B=N.alpha!==1;this._outlinePrimitive=s.add(new y({geometryInstances:new f({id:h,geometry:new c(m),attributes:{color:t.fromColor(N),distanceDisplayCondition:P}}),appearance:new g({flat:true,translucent:B,renderState:{lineWidth:n._scene.clampLineWidth(L)}}),asynchronous:false,shadows:S}))}};B.prototype.getBoundingSphere=function(e,t){return S(e,this._primitive,this._outlinePrimitive,t)};B.prototype.isDestroyed=function(){return false};B.prototype.destroy=function(){var e=this._primitives;var t=this._groundPrimitives;if(this._geometryUpdater._onTerrain){t.removeAndDestroy(this._primitive)}else{e.removeAndDestroy(this._primitive)}e.removeAndDestroy(this._outlinePrimitive);a(this)};return L});define("DataSources/EllipsoidGeometryUpdater",["../Core/Cartesian3","../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/EllipsoidGeometry","../Core/EllipsoidOutlineGeometry","../Core/Event","../Core/GeometryInstance","../Core/Iso8601","../Core/Matrix4","../Core/ShowGeometryInstanceAttribute","../Scene/MaterialAppearance","../Scene/PerInstanceColorAppearance","../Scene/Primitive","../Scene/SceneMode","../Scene/ShadowMode","./ColorMaterialProperty","./ConstantProperty","./dynamicGeometryGetBoundingSphere","./MaterialProperty","./Property"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w,C,b,S,E,T,x){"use strict";var A=new b(t.WHITE);var P=new S(true);var D=new S(true);var M=new S(false);var I=new S(t.BLACK);var O=new S(C.DISABLED);var R=new S(new u);var N=new e;var L=new t;var B=new e(1,1,1);function F(e){this.id=e;this.vertexFormat=undefined;this.radii=undefined;this.stackPartitions=undefined;this.slicePartitions=undefined;this.subdivisions=undefined}function k(e,t){if(!n(e)){throw new s("entity is required")}if(!n(t)){throw new s("scene is required")}this._scene=t;this._entity=e;this._entitySubscription=e.definitionChanged.addEventListener(k.prototype._onEntityPropertyChanged,this);this._fillEnabled=false;this._dynamic=false;this._outlineEnabled=false;this._geometryChanged=new f;this._showProperty=undefined;this._materialProperty=undefined;this._hasConstantOutline=true;this._showOutlineProperty=undefined;this._outlineColorProperty=undefined;this._outlineWidth=1;this._shadowsProperty=undefined;this._distanceDisplayConditionProperty=undefined;this._options=new F(e);this._onEntityPropertyChanged(e,"ellipsoid",e.ellipsoid,undefined)}a(k,{perInstanceColorAppearanceType:{value:g},materialAppearanceType:{value:_}});a(k.prototype,{entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!n(this._entity.availability)&&x.isConstant(this._showProperty)&&x.isConstant(this._fillProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},outlineEnabled:{get:function(){return this._outlineEnabled}},hasConstantOutline:{get:function(){return!this._outlineEnabled||!n(this._entity.availability)&&x.isConstant(this._showProperty)&&x.isConstant(this._showOutlineProperty)}},outlineColorProperty:{get:function(){return this._outlineColorProperty}},outlineWidth:{get:function(){return this._outlineWidth}},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayConditionProperty}},isDynamic:{get:function(){return this._dynamic}},isClosed:{value:true},geometryChanged:{get:function(){return this._geometryChanged}}});k.prototype.isOutlineVisible=function(e){var t=this._entity;return this._outlineEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)};k.prototype.isFilled=function(e){var t=this._entity;return this._fillEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)};k.prototype.createFillGeometryInstance=function(e){if(!n(e)){throw new s("time is required.")}if(!this._fillEnabled){throw new s("This instance does not represent a filled geometry.")}var i=this._entity;var a=i.isAvailable(e);var o;var u;var d=new v(a&&i.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e));var f=this._distanceDisplayConditionProperty.getValue(e);var m=l.fromDistanceDisplayCondition(f);if(this._materialProperty instanceof b){var _=t.WHITE;if(n(this._materialProperty.color)&&(this._materialProperty.color.isConstant||a)){_=this._materialProperty.color.getValue(e)}u=r.fromColor(_);o={show:d,distanceDisplayCondition:m,color:u}}else{o={show:d,distanceDisplayCondition:m}}return new h({id:i,geometry:new c(this._options),modelMatrix:i._getModelMatrix(p.MINIMUM_VALUE),attributes:o})};k.prototype.createOutlineGeometryInstance=function(e){if(!n(e)){throw new s("time is required.")}if(!this._outlineEnabled){throw new s("This instance does not represent an outlined geometry.")}var i=this._entity;var a=i.isAvailable(e);var o=x.getValueOrDefault(this._outlineColorProperty,e,t.BLACK);var u=this._distanceDisplayConditionProperty.getValue(e);return new h({id:i,geometry:new d(this._options),modelMatrix:i._getModelMatrix(p.MINIMUM_VALUE),attributes:{show:new v(a&&i.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:r.fromColor(o),distanceDisplayCondition:l.fromDistanceDisplayCondition(u)}})};k.prototype.isDestroyed=function(){return false};k.prototype.destroy=function(){this._entitySubscription();o(this)};k.prototype._onEntityPropertyChanged=function(e,t,r,a){if(!(t==="availability"||t==="position"||t==="orientation"||t==="ellipsoid")){return}var o=e.ellipsoid;if(!n(o)){if(this._fillEnabled||this._outlineEnabled){this._fillEnabled=false;this._outlineEnabled=false;this._geometryChanged.raiseEvent(this)}return}var s=o.fill;var u=n(s)&&s.isConstant?s.getValue(p.MINIMUM_VALUE):true;var l=o.outline;var c=n(l);if(c&&l.isConstant){c=l.getValue(p.MINIMUM_VALUE)}if(!u&&!c){if(this._fillEnabled||this._outlineEnabled){this._fillEnabled=false;this._outlineEnabled=false;this._geometryChanged.raiseEvent(this)}return}var d=e.position;var f=o.radii;var h=o.show;if(n(h)&&h.isConstant&&!h.getValue(p.MINIMUM_VALUE)||(!n(d)||!n(f))){if(this._fillEnabled||this._outlineEnabled){this._fillEnabled=false;this._outlineEnabled=false;this._geometryChanged.raiseEvent(this)}return}var m=i(o.material,A);var v=m instanceof b;this._materialProperty=m;this._fillProperty=i(s,D);this._showProperty=i(h,P);this._showOutlineProperty=i(o.outline,M);this._outlineColorProperty=c?i(o.outlineColor,I):undefined;this._shadowsProperty=i(o.shadows,O);this._distanceDisplayConditionProperty=i(o.distanceDisplayCondition,R);this._fillEnabled=u;this._outlineEnabled=c;var y=o.stackPartitions;var w=o.slicePartitions;var C=o.outlineWidth;var S=o.subdivisions;if(!d.isConstant||!x.isConstant(e.orientation)||!f.isConstant||!x.isConstant(y)||!x.isConstant(w)||!x.isConstant(C)||!x.isConstant(S)){if(!this._dynamic){this._dynamic=true;this._geometryChanged.raiseEvent(this)}}else{var E=this._options;E.vertexFormat=v?g.VERTEX_FORMAT:_.MaterialSupport.TEXTURED.vertexFormat;E.radii=f.getValue(p.MINIMUM_VALUE,E.radii);E.stackPartitions=n(y)?y.getValue(p.MINIMUM_VALUE):undefined;E.slicePartitions=n(w)?w.getValue(p.MINIMUM_VALUE):undefined;E.subdivisions=n(S)?S.getValue(p.MINIMUM_VALUE):undefined;this._outlineWidth=n(C)?C.getValue(p.MINIMUM_VALUE):1;this._dynamic=false;this._geometryChanged.raiseEvent(this)}};k.prototype.createDynamicUpdater=function(e){if(!this._dynamic){throw new s("This instance does not represent dynamic geometry.")}if(!n(e)){throw new s("primitives is required.")}return new V(e,this)};function V(e,t){this._entity=t._entity;this._scene=t._scene;this._primitives=e;this._primitive=undefined;this._outlinePrimitive=undefined;this._geometryUpdater=t;this._options=new F(t._entity);this._modelMatrix=new m;this._material=undefined;this._attributes=undefined;this._outlineAttributes=undefined;this._lastSceneMode=undefined;this._lastShow=undefined;this._lastOutlineShow=undefined;this._lastOutlineWidth=undefined;this._lastOutlineColor=undefined}V.prototype.update=function(e){if(!n(e)){throw new s("time is required.")}var a=this._entity;var o=a.ellipsoid;if(!a.isShowing||!a.isAvailable(e)||!x.getValueOrDefault(o.show,e,true)){if(n(this._primitive)){this._primitive.show=false}if(n(this._outlinePrimitive)){this._outlinePrimitive.show=false}return}var f=x.getValueOrUndefined(o.radii,e,N);var p=a._getModelMatrix(e,this._modelMatrix);if(!n(p)||!n(f)){if(n(this._primitive)){this._primitive.show=false}if(n(this._outlinePrimitive)){this._outlinePrimitive.show=false}return}var C;var b=x.getValueOrDefault(o.fill,e,true);var S=x.getValueOrDefault(o.outline,e,false);var E=x.getValueOrClonedDefault(o.outlineColor,e,t.BLACK,L);var P=T.getValue(e,i(o.material,A),this._material);this._material=P;var D=x.getValueOrUndefined(o.stackPartitions,e);var M=x.getValueOrUndefined(o.slicePartitions,e);var I=x.getValueOrUndefined(o.subdivisions,e);var O=x.getValueOrDefault(o.outlineWidth,e,1);var R=this._scene.mode;var F=R===w.SCENE3D;var k=this._options;var V=this._geometryUpdater.shadowsProperty.getValue(e);var z=this._geometryUpdater.distanceDisplayConditionProperty;var U=z.getValue(e);var q=l.fromDistanceDisplayCondition(U);var G=!F||this._lastSceneMode!==R||!n(this._primitive)||k.stackPartitions!==D||k.slicePartitions!==M||k.subdivisions!==I||this._lastOutlineWidth!==O;if(G){var H=this._primitives;H.removeAndDestroy(this._primitive);H.removeAndDestroy(this._outlinePrimitive);this._primitive=undefined;this._outlinePrimitive=undefined;this._lastSceneMode=R;this._lastOutlineWidth=O;k.stackPartitions=D;k.slicePartitions=M;k.subdivisions=I;k.radii=F?B:f;C=new _({material:P,translucent:P.isTranslucent(),closed:true});k.vertexFormat=C.vertexFormat;this._primitive=H.add(new y({geometryInstances:new h({id:a,geometry:new c(k),modelMatrix:!F?p:undefined,attributes:{show:new v(b),distanceDisplayCondition:q}}),appearance:C,asynchronous:false,shadows:V}));k.vertexFormat=g.VERTEX_FORMAT;this._outlinePrimitive=H.add(new y({geometryInstances:new h({id:a,geometry:new d(k),modelMatrix:!F?p:undefined,attributes:{show:new v(S),color:r.fromColor(E),distanceDisplayCondition:q}}),appearance:new g({flat:true,translucent:E.alpha!==1,renderState:{lineWidth:this._geometryUpdater._scene.clampLineWidth(O)}}),asynchronous:false,shadows:V}));this._lastShow=b;this._lastOutlineShow=S;this._lastOutlineColor=t.clone(E,this._lastOutlineColor);this._lastDistanceDisplayCondition=U}else if(this._primitive.ready){var W=this._primitive;var j=this._outlinePrimitive;W.show=true;j.show=true;C=W.appearance;C.material=P;var Y=this._attributes;if(!n(Y)){Y=W.getGeometryInstanceAttributes(a);this._attributes=Y}if(b!==this._lastShow){Y.show=v.toValue(b,Y.show);this._lastShow=b}var X=this._outlineAttributes;if(!n(X)){X=j.getGeometryInstanceAttributes(a);this._outlineAttributes=X}if(S!==this._lastOutlineShow){X.show=v.toValue(S,X.show);this._lastOutlineShow=S}if(!t.equals(E,this._lastOutlineColor)){X.color=r.toValue(E,X.color);t.clone(E,this._lastOutlineColor)}if(!u.equals(U,this._lastDistanceDisplayCondition)){Y.distanceDisplayCondition=l.toValue(U,Y.distanceDisplayCondition);X.distanceDisplayCondition=l.toValue(U,X.distanceDisplayCondition);u.clone(U,this._lastDistanceDisplayCondition)}}if(F){f.x=Math.max(f.x,.001);f.y=Math.max(f.y,.001);f.z=Math.max(f.z,.001);p=m.multiplyByScale(p,f,p);this._primitive.modelMatrix=p;this._outlinePrimitive.modelMatrix=p}};V.prototype.getBoundingSphere=function(e,t){return E(e,this._primitive,this._outlinePrimitive,t)};V.prototype.isDestroyed=function(){return false};V.prototype.destroy=function(){var e=this._primitives;e.removeAndDestroy(this._primitive);e.removeAndDestroy(this._outlinePrimitive);o(this)};return k});define("DataSources/StaticGeometryColorBatch",["../Core/AssociativeArray","../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/defined","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/ShowGeometryInstanceAttribute","../Scene/Primitive","./BoundingSphereState","./Property"],function(e,t,r,i,n,a,o,s,u,l){"use strict";var c=new t;var d=new n;function f(t,r,i,n,a){this.translucent=r;this.appearanceType=i;this.closed=n;this.shadows=a;this.primitives=t;this.createPrimitive=false;this.waitingOnCreate=false;this.primitive=undefined;this.oldPrimitive=undefined;this.geometry=new e;this.updaters=new e;this.updatersWithAttributes=new e;this.attributes=new e;this.subscriptions=new e;this.showsUpdated=new e;this.itemsToRemove=[]}f.prototype.add=function(e,t){var r=e.entity.id;this.createPrimitive=true;this.geometry.set(r,t);this.updaters.set(r,e);if(!e.hasConstantFill||!e.fillMaterialProperty.isConstant||!l.isConstant(e.distanceDisplayConditionProperty)){this.updatersWithAttributes.set(r,e)}else{var i=this;this.subscriptions.set(r,e.entity.definitionChanged.addEventListener(function(t,r,n,a){if(r==="isShowing"){i.showsUpdated.set(t.id,e)}}))}};f.prototype.remove=function(e){var t=e.entity.id;this.createPrimitive=this.geometry.remove(t)||this.createPrimitive;if(this.updaters.remove(t)){this.updatersWithAttributes.remove(t);var r=this.subscriptions.get(t);if(i(r)){r();this.subscriptions.remove(t)}}};f.prototype.update=function(e){var u=true;var f=0;var h=this.primitive;var p=this.primitives;var m;var v;if(this.createPrimitive){var _=this.geometry.values;var g=_.length;if(g>0){if(i(h)){if(!i(this.oldPrimitive)){this.oldPrimitive=h}else{p.remove(h)}}for(v=0;v<g;v++){var y=_[v];var w=y.attributes;m=this.attributes.get(y.id.id);if(i(m)){if(i(w.show)){w.show.value=m.show}if(i(w.color)){w.color.value=m.color}}}h=new s({asynchronous:true,geometryInstances:_,appearance:new this.appearanceType({translucent:this.translucent,closed:this.closed}),shadows:this.shadows});p.add(h);u=false}else{if(i(h)){p.remove(h);h=undefined}var C=this.oldPrimitive;if(i(C)){p.remove(C);this.oldPrimitive=undefined}}this.attributes.removeAll();this.primitive=h;this.createPrimitive=false;this.waitingOnCreate=true}else if(i(h)&&h.ready){if(i(this.oldPrimitive)){p.remove(this.oldPrimitive);this.oldPrimitive=undefined}var b=this.updatersWithAttributes.values;var S=b.length;var E=this.waitingOnCreate;for(v=0;v<S;v++){var T=b[v];var x=this.geometry.get(T.entity.id);m=this.attributes.get(x.id.id);if(!i(m)){m=h.getGeometryInstanceAttributes(x.id);this.attributes.set(x.id.id,m)}if(!T.fillMaterialProperty.isConstant||E){var A=T.fillMaterialProperty.color;A.getValue(e,c);if(!t.equals(m._lastColor,c)){m._lastColor=t.clone(c,m._lastColor);m.color=r.toValue(c,m.color);if(this.translucent&&m.color[3]===255||!this.translucent&&m.color[3]!==255){this.itemsToRemove[f++]=T}}}var P=T.entity.isShowing&&(T.hasConstantFill||T.isFilled(e));var D=m.show[0]===1;if(P!==D){m.show=o.toValue(P,m.show)}var M=T.distanceDisplayConditionProperty;if(!l.isConstant(M)){var I=M.getValue(e,d);if(!n.equals(I,m._lastDistanceDisplayCondition)){m._lastDistanceDisplayCondition=n.clone(I,m._lastDistanceDisplayCondition);m.distanceDisplayCondition=a.toValue(I,m.distanceDisplayCondition)}}}this.updateShows(h);this.waitingOnCreate=false}else if(i(h)&&!h.ready){u=false}this.itemsToRemove.length=f;return u};f.prototype.updateShows=function(e){var t=this.showsUpdated.values;var r=t.length;for(var n=0;n<r;n++){var a=t[n];var s=this.geometry.get(a.entity.id);var u=this.attributes.get(s.id.id);if(!i(u)){u=e.getGeometryInstanceAttributes(s.id);this.attributes.set(s.id.id,u)}var l=a.entity.isShowing;var c=u.show[0]===1;if(l!==c){u.show=o.toValue(l,u.show)}}this.showsUpdated.removeAll()};f.prototype.contains=function(e){return this.updaters.contains(e.id)};f.prototype.getBoundingSphere=function(e,t){var r=this.primitive;if(!r.ready){return u.PENDING}var n=r.getGeometryInstanceAttributes(e);if(!i(n)||!i(n.boundingSphere)||i(n.show)&&n.show[0]===0){return u.FAILED}n.boundingSphere.clone(t);return u.DONE};f.prototype.removeAllPrimitives=function(){var e=this.primitives;var t=this.primitive;if(i(t)){e.remove(t);this.primitive=undefined;this.geometry.removeAll();this.updaters.removeAll()}var r=this.oldPrimitive;if(i(r)){e.remove(r);this.oldPrimitive=undefined}};function h(e,t,r,i){this._solidBatch=new f(e,false,t,r,i);this._translucentBatch=new f(e,true,t,r,i)}h.prototype.add=function(e,t){var r=t.createFillGeometryInstance(e);if(r.attributes.color.value[3]===255){this._solidBatch.add(t,r)}else{this._translucentBatch.add(t,r)}};h.prototype.remove=function(e){if(!this._solidBatch.remove(e)){this._translucentBatch.remove(e)}};h.prototype.update=function(e){var t;var r;var i=this._solidBatch.update(e);i=this._translucentBatch.update(e)&&i;var n=this._solidBatch.itemsToRemove;var a=n.length;if(a>0){for(t=0;t<a;t++){r=n[t];this._solidBatch.remove(r);this._translucentBatch.add(r,r.createFillGeometryInstance(e))}}n=this._translucentBatch.itemsToRemove;var o=n.length;if(o>0){for(t=0;t<o;t++){r=n[t];this._translucentBatch.remove(r);this._solidBatch.add(r,r.createFillGeometryInstance(e))}}if(a>0||o>0){i=this._solidBatch.update(e)&&i;i=this._translucentBatch.update(e)&&i}return i};h.prototype.getBoundingSphere=function(e,t){if(this._solidBatch.contains(e)){return this._solidBatch.getBoundingSphere(e,t)}else if(this._translucentBatch.contains(e)){return this._translucentBatch.getBoundingSphere(e,t)}return u.FAILED};h.prototype.removeAllPrimitives=function(){this._solidBatch.removeAllPrimitives();this._translucentBatch.removeAllPrimitives()};return h});define("DataSources/StaticGeometryPerMaterialBatch",["../Core/AssociativeArray","../Core/defined","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/ShowGeometryInstanceAttribute","../Scene/Primitive","./BoundingSphereState","./MaterialProperty","./Property"],function(e,t,r,i,n,a,o,s,u){"use strict";var l=new r;function c(t,r,i,n,a){this.primitives=t;this.appearanceType=r;this.materialProperty=i;this.closed=n;this.shadows=a;this.updaters=new e;this.createPrimitive=true;this.primitive=undefined;this.oldPrimitive=undefined;this.geometry=new e;this.material=undefined;this.updatersWithAttributes=new e;this.attributes=new e;this.invalidated=false;this.removeMaterialSubscription=i.definitionChanged.addEventListener(c.prototype.onMaterialChanged,this);this.subscriptions=new e;this.showsUpdated=new e}c.prototype.onMaterialChanged=function(){this.invalidated=true};c.prototype.isMaterial=function(e){var r=this.materialProperty;var i=e.fillMaterialProperty;if(i===r){return true}if(t(r)){return r.equals(i)}return false};c.prototype.add=function(e,t){var r=t.entity.id;this.updaters.set(r,t);this.geometry.set(r,t.createFillGeometryInstance(e));if(!t.hasConstantFill||!t.fillMaterialProperty.isConstant||!u.isConstant(t.distanceDisplayConditionProperty)){this.updatersWithAttributes.set(r,t)}else{var i=this;this.subscriptions.set(r,t.entity.definitionChanged.addEventListener(function(e,r,n,a){if(r==="isShowing"){i.showsUpdated.set(e.id,t)}}))}this.createPrimitive=true};c.prototype.remove=function(e){var r=e.entity.id;this.createPrimitive=this.geometry.remove(r)||this.createPrimitive;if(this.updaters.remove(r)){this.updatersWithAttributes.remove(r);var i=this.subscriptions.get(r);if(t(i)){i();this.subscriptions.remove(r)}}return this.createPrimitive};c.prototype.update=function(e){var o=true;var c=this.primitive;var d=this.primitives;var f=this.geometry.values;var h;var p;if(this.createPrimitive){var m=f.length;if(m>0){if(t(c)){if(!t(this.oldPrimitive)){this.oldPrimitive=c}else{d.remove(c)}}for(p=0;p<m;p++){var v=f[p];var _=v.attributes;h=this.attributes.get(v.id.id);if(t(h)){if(t(_.show)){_.show.value=h.show}if(t(_.color)){_.color.value=h.color}}}this.material=s.getValue(e,this.materialProperty,this.material);c=new a({asynchronous:true,geometryInstances:f,appearance:new this.appearanceType({material:this.material,translucent:this.material.isTranslucent(),closed:this.closed}),shadows:this.shadows});d.add(c);o=false}else{if(t(c)){d.remove(c);c=undefined}var g=this.oldPrimitive;if(t(g)){d.remove(g);this.oldPrimitive=undefined}}this.attributes.removeAll();this.primitive=c;this.createPrimitive=false}else if(t(c)&&c.ready){if(t(this.oldPrimitive)){d.remove(this.oldPrimitive);this.oldPrimitive=undefined}this.material=s.getValue(e,this.materialProperty,this.material);this.primitive.appearance.material=this.material;var y=this.updatersWithAttributes.values;var w=y.length;for(p=0;p<w;p++){var C=y[p];var b=C.entity;var S=this.geometry.get(b.id);h=this.attributes.get(S.id.id);if(!t(h)){h=c.getGeometryInstanceAttributes(S.id);this.attributes.set(S.id.id,h)}var E=b.isShowing&&(C.hasConstantFill||C.isFilled(e));var T=h.show[0]===1;if(E!==T){h.show=n.toValue(E,h.show)}var x=C.distanceDisplayConditionProperty;if(!u.isConstant(x)){var A=x.getValue(e,l);if(!r.equals(A,h._lastDistanceDisplayCondition)){h._lastDistanceDisplayCondition=r.clone(A,h._lastDistanceDisplayCondition);h.distanceDisplayCondition=i.toValue(A,h.distanceDisplayCondition)}}}this.updateShows(c)}else if(t(c)&&!c.ready){o=false}return o};c.prototype.updateShows=function(e){var r=this.showsUpdated.values;var i=r.length;for(var a=0;a<i;a++){var o=r[a];var s=o.entity;var u=this.geometry.get(s.id);var l=this.attributes.get(u.id.id);if(!t(l)){l=e.getGeometryInstanceAttributes(u.id);this.attributes.set(u.id.id,l)}var c=s.isShowing;var d=l.show[0]===1;if(c!==d){l.show=n.toValue(c,l.show)}}this.showsUpdated.removeAll()};c.prototype.contains=function(e){return this.updaters.contains(e.id)};c.prototype.getBoundingSphere=function(e,r){var i=this.primitive;if(!i.ready){return o.PENDING}var n=i.getGeometryInstanceAttributes(e);if(!t(n)||!t(n.boundingSphere)||t(n.show)&&n.show[0]===0){return o.FAILED}n.boundingSphere.clone(r);return o.DONE};c.prototype.destroy=function(e){var r=this.primitive;var i=this.primitives;if(t(r)){i.remove(r)}var n=this.oldPrimitive;if(t(n)){i.remove(n)}this.removeMaterialSubscription()};function d(e,t,r,i){this._items=[];this._primitives=e;this._appearanceType=t;this._closed=r;this._shadows=i}d.prototype.add=function(e,t){var r=this._items;var i=r.length;for(var n=0;n<i;n++){var a=r[n];if(a.isMaterial(t)){a.add(e,t);return}}var o=new c(this._primitives,this._appearanceType,t.fillMaterialProperty,this._closed,this._shadows);o.add(e,t);r.push(o)};d.prototype.remove=function(e){var t=this._items;var r=t.length;for(var i=r-1;i>=0;i--){var n=t[i];if(n.remove(e)){if(n.updaters.length===0){t.splice(i,1);n.destroy()}break}}};d.prototype.update=function(e){var t;var r=this._items;var i=r.length;for(t=i-1;t>=0;t--){var n=r[t];if(n.invalidated){r.splice(t,1);var a=n.updaters.values;var o=a.length;for(var s=0;s<o;s++){this.add(e,a[s])}n.destroy()}}var u=true;for(t=0;t<i;t++){u=r[t].update(e)&&u}return u};d.prototype.getBoundingSphere=function(e,t){var r=this._items;var i=r.length;for(var n=0;n<i;n++){var a=r[n];if(a.contains(e)){return a.getBoundingSphere(e,t)}}return o.FAILED};d.prototype.removeAllPrimitives=function(){var e=this._items;var t=e.length;for(var r=0;r<t;r++){e[r].destroy()}this._items.length=0};return d});define("DataSources/StaticGroundGeometryColorBatch",["../Core/AssociativeArray","../Core/Color","../Core/defined","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/ShowGeometryInstanceAttribute","../Scene/GroundPrimitive","./BoundingSphereState","./Property"],function(e,t,r,i,n,a,o,s,u){"use strict";var l=new t;var c=new i;function d(t,r,i){this.primitives=t;this.color=r;this.key=i;this.createPrimitive=false;this.waitingOnCreate=false;this.primitive=undefined;this.oldPrimitive=undefined;this.geometry=new e;this.updaters=new e;this.updatersWithAttributes=new e;this.attributes=new e;this.subscriptions=new e;this.showsUpdated=new e;this.itemsToRemove=[];this.isDirty=false}d.prototype.add=function(e,t){var r=e.entity.id;this.createPrimitive=true;this.geometry.set(r,t);this.updaters.set(r,e);if(!e.hasConstantFill||!e.fillMaterialProperty.isConstant||!u.isConstant(e.distanceDisplayConditionProperty)){this.updatersWithAttributes.set(r,e)}else{var i=this;this.subscriptions.set(r,e.entity.definitionChanged.addEventListener(function(t,r,n,a){if(r==="isShowing"){i.showsUpdated.set(t.id,e)}}))}};d.prototype.remove=function(e){var t=e.entity.id;this.createPrimitive=this.geometry.remove(t)||this.createPrimitive;if(this.updaters.remove(t)){this.updatersWithAttributes.remove(t);var i=this.subscriptions.get(t);if(r(i)){i();this.subscriptions.remove(t)}}};var f=new Array(4);d.prototype.update=function(e){var s=true;var d=0;var h=this.primitive;var p=this.primitives;var m;var v;if(this.createPrimitive){var _=this.geometry.values;var g=_.length;if(g>0){if(r(h)){if(!r(this.oldPrimitive)){this.oldPrimitive=h}else{p.remove(h)}}for(v=0;v<g;v++){var y=_[v];var w=y.attributes;m=this.attributes.get(y.id.id);if(r(m)){if(r(w.show)){w.show.value=m.show}if(r(w.color)){w.color.value=m.color}}}h=new o({asynchronous:true,geometryInstances:_});p.add(h);s=false}else{if(r(h)){p.remove(h);h=undefined}var C=this.oldPrimitive;if(r(C)){p.remove(C);this.oldPrimitive=undefined}}this.attributes.removeAll();this.primitive=h;this.createPrimitive=false;this.waitingOnCreate=true}else if(r(h)&&h.ready){if(r(this.oldPrimitive)){p.remove(this.oldPrimitive);this.oldPrimitive=undefined}var b=this.updatersWithAttributes.values;var S=b.length;var E=this.waitingOnCreate;for(v=0;v<S;v++){var T=b[v];var x=this.geometry.get(T.entity.id);m=this.attributes.get(x.id.id);if(!r(m)){m=h.getGeometryInstanceAttributes(x.id);this.attributes.set(x.id.id,m)}if(!T.fillMaterialProperty.isConstant||E){var A=T.fillMaterialProperty.color;A.getValue(e,l);if(!t.equals(m._lastColor,l)){m._lastColor=t.clone(l,m._lastColor);var P=this.color;var D=l.toBytes(f);if(P[0]!==D[0]||P[1]!==D[1]||P[2]!==D[2]||P[3]!==D[3]){this.itemsToRemove[d++]=T}}}var M=T.entity.isShowing&&(T.hasConstantFill||T.isFilled(e));var I=m.show[0]===1;if(M!==I){m.show=a.toValue(M,m.show)}var O=T.distanceDisplayConditionProperty;if(!u.isConstant(O)){var R=O.getValue(e,c);if(!i.equals(R,m._lastDistanceDisplayCondition)){m._lastDistanceDisplayCondition=i.clone(R,m._lastDistanceDisplayCondition);m.distanceDisplayCondition=n.toValue(R,m.distanceDisplayCondition)}}}this.updateShows(h);this.waitingOnCreate=false}else if(r(h)&&!h.ready){s=false}this.itemsToRemove.length=d;return s};d.prototype.updateShows=function(e){var t=this.showsUpdated.values;var i=t.length;for(var n=0;n<i;n++){var o=t[n];var s=this.geometry.get(o.entity.id);var u=this.attributes.get(s.id.id);if(!r(u)){u=e.getGeometryInstanceAttributes(s.id);this.attributes.set(s.id.id,u)}var l=o.entity.isShowing;var c=u.show[0]===1;if(l!==c){u.show=a.toValue(l,u.show)}}this.showsUpdated.removeAll()};d.prototype.contains=function(e){return this.updaters.contains(e.id)};d.prototype.getBoundingSphere=function(e,t){var i=this.primitive;if(!i.ready){return s.PENDING}var n=i.getBoundingSphere(e);if(!r(n)){return s.FAILED}n.clone(t);return s.DONE};d.prototype.removeAllPrimitives=function(){var e=this.primitives;var t=this.primitive;if(r(t)){e.remove(t);this.primitive=undefined;this.geometry.removeAll();this.updaters.removeAll()}var i=this.oldPrimitive;if(r(i)){e.remove(i);this.oldPrimitive=undefined}};function h(t){this._batches=new e;this._primitives=t}h.prototype.add=function(e,t){var r=t.createFillGeometryInstance(e);var i=this._batches;var n=new Uint32Array(r.attributes.color.value.buffer)[0];var a;if(i.contains(n)){a=i.get(n)}else{a=new d(this._primitives,r.attributes.color.value,n);i.set(n,a)}a.add(t,r);return a};h.prototype.remove=function(e){var t=this._batches.values;var r=t.length;for(var i=0;i<r;++i){if(t[i].remove(e)){return}}};h.prototype.update=function(e){var t;var r;var i=true;var n=this._batches;var a=n.values;var o=a.length;for(t=0;t<o;++t){i=a[t].update(e)&&i}for(t=0;t<o;++t){var s=a[t];var u=s.itemsToRemove;var l=u.length;for(var c=0;c<l;c++){r=u[c];s.remove(r)
;var d=this.add(e,r);s.isDirty=true;d.isDirty=true}}var f=a.slice();var h=f.length;for(t=0;t<h;++t){var p=f[t];if(p.isDirty){i=f[t].update(e)&&i;p.isDirty=false}if(p.geometry.length===0){n.remove(p.key)}}return i};h.prototype.getBoundingSphere=function(e,t){var r=this._batches.values;var i=r.length;for(var n=0;n<i;++n){var a=r[n];if(a.contains(e)){return a.getBoundingSphere(e,t)}}return s.FAILED};h.prototype.removeAllPrimitives=function(){var e=this._batches.values;var t=e.length;for(var r=0;r<t;++r){e[r].removeAllPrimitives()}};return h});define("DataSources/StaticOutlineGeometryBatch",["../Core/AssociativeArray","../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/defined","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/ShowGeometryInstanceAttribute","../Scene/PerInstanceColorAppearance","../Scene/Primitive","./BoundingSphereState","./Property"],function(e,t,r,i,n,a,o,s,u,l,c){"use strict";function d(t,r,i,n){this.translucent=r;this.width=i;this.shadows=n;this.primitives=t;this.createPrimitive=false;this.waitingOnCreate=false;this.primitive=undefined;this.oldPrimitive=undefined;this.geometry=new e;this.updaters=new e;this.updatersWithAttributes=new e;this.attributes=new e;this.itemsToRemove=[];this.subscriptions=new e;this.showsUpdated=new e}d.prototype.add=function(e,t){var r=e.entity.id;this.createPrimitive=true;this.geometry.set(r,t);this.updaters.set(r,e);if(!e.hasConstantOutline||!e.outlineColorProperty.isConstant||!c.isConstant(e.distanceDisplayConditionProperty)){this.updatersWithAttributes.set(r,e)}else{var i=this;this.subscriptions.set(r,e.entity.definitionChanged.addEventListener(function(t,r,n,a){if(r==="isShowing"){i.showsUpdated.set(t.id,e)}}))}};d.prototype.remove=function(e){var t=e.entity.id;this.createPrimitive=this.geometry.remove(t)||this.createPrimitive;if(this.updaters.remove(t)){this.updatersWithAttributes.remove(t);var r=this.subscriptions.get(t);if(i(r)){r();this.subscriptions.remove(t)}}};var f=new t;var h=new n;d.prototype.update=function(e){var l=true;var d=0;var p=this.primitive;var m=this.primitives;var v;var _;if(this.createPrimitive){var g=this.geometry.values;var y=g.length;if(y>0){if(i(p)){if(!i(this.oldPrimitive)){this.oldPrimitive=p}else{m.remove(p)}}for(_=0;_<y;_++){var w=g[_];var C=w.attributes;v=this.attributes.get(w.id.id);if(i(v)){if(i(C.show)){C.show.value=v.show}if(i(C.color)){C.color.value=v.color}}}p=new u({asynchronous:true,geometryInstances:g,appearance:new s({flat:true,translucent:this.translucent,renderState:{lineWidth:this.width}}),shadows:this.shadows});m.add(p);l=false}else{if(i(p)){m.remove(p);p=undefined}var b=this.oldPrimitive;if(i(b)){m.remove(b);this.oldPrimitive=undefined}}this.attributes.removeAll();this.primitive=p;this.createPrimitive=false;this.waitingOnCreate=true}else if(i(p)&&p.ready){if(i(this.oldPrimitive)){m.remove(this.oldPrimitive);this.oldPrimitive=undefined}var S=this.updatersWithAttributes.values;var E=S.length;var T=this.waitingOnCreate;for(_=0;_<E;_++){var x=S[_];var A=this.geometry.get(x.entity.id);v=this.attributes.get(A.id.id);if(!i(v)){v=p.getGeometryInstanceAttributes(A.id);this.attributes.set(A.id.id,v)}if(!x.outlineColorProperty.isConstant||T){var P=x.outlineColorProperty;P.getValue(e,f);if(!t.equals(v._lastColor,f)){v._lastColor=t.clone(f,v._lastColor);v.color=r.toValue(f,v.color);if(this.translucent&&v.color[3]===255||!this.translucent&&v.color[3]!==255){this.itemsToRemove[d++]=x}}}var D=x.entity.isShowing&&(x.hasConstantOutline||x.isOutlineVisible(e));var M=v.show[0]===1;if(D!==M){v.show=o.toValue(D,v.show)}var I=x.distanceDisplayConditionProperty;if(!c.isConstant(I)){var O=I.getValue(e,h);if(!n.equals(O,v._lastDistanceDisplayCondition)){v._lastDistanceDisplayCondition=n.clone(O,v._lastDistanceDisplayCondition);v.distanceDisplayCondition=a.toValue(O,v.distanceDisplayCondition)}}}this.updateShows(p);this.waitingOnCreate=false}else if(i(p)&&!p.ready){l=false}this.itemsToRemove.length=d;return l};d.prototype.updateShows=function(e){var t=this.showsUpdated.values;var r=t.length;for(var n=0;n<r;n++){var a=t[n];var s=this.geometry.get(a.entity.id);var u=this.attributes.get(s.id.id);if(!i(u)){u=e.getGeometryInstanceAttributes(s.id);this.attributes.set(s.id.id,u)}var l=a.entity.isShowing;var c=u.show[0]===1;if(l!==c){u.show=o.toValue(l,u.show)}}this.showsUpdated.removeAll()};d.prototype.contains=function(e){return this.updaters.contains(e.id)};d.prototype.getBoundingSphere=function(e,t){var r=this.primitive;if(!r.ready){return l.PENDING}var n=r.getGeometryInstanceAttributes(e);if(!i(n)||!i(n.boundingSphere)||i(n.show)&&n.show[0]===0){return l.FAILED}n.boundingSphere.clone(t);return l.DONE};d.prototype.removeAllPrimitives=function(){var e=this.primitives;var t=this.primitive;if(i(t)){e.remove(t);this.primitive=undefined;this.geometry.removeAll();this.updaters.removeAll()}var r=this.oldPrimitive;if(i(r)){e.remove(r);this.oldPrimitive=undefined}};function p(t,r,i){this._primitives=t;this._scene=r;this._shadows=i;this._solidBatches=new e;this._translucentBatches=new e}p.prototype.add=function(e,t){var r=t.createOutlineGeometryInstance(e);var n=this._scene.clampLineWidth(t.outlineWidth);var a;var o;if(r.attributes.color.value[3]===255){a=this._solidBatches;o=a.get(n);if(!i(o)){o=new d(this._primitives,false,n,this._shadows);a.set(n,o)}o.add(t,r)}else{a=this._translucentBatches;o=a.get(n);if(!i(o)){o=new d(this._primitives,true,n,this._shadows);a.set(n,o)}o.add(t,r)}};p.prototype.remove=function(e){var t;var r=this._solidBatches.values;var i=r.length;for(t=0;t<i;t++){if(r[t].remove(e)){return}}var n=this._translucentBatches.values;var a=n.length;for(t=0;t<a;t++){if(n[t].remove(e)){return}}};p.prototype.update=function(e){var t;var r;var i;var n;var a=this._solidBatches.values;var o=a.length;var s=this._translucentBatches.values;var u=s.length;var l;var c=true;var d=false;do{d=false;for(r=0;r<o;r++){n=a[r];c=n.update(e);l=n.itemsToRemove;var f=l.length;if(f>0){d=true;for(t=0;t<f;t++){i=l[t];n.remove(i);this.add(e,i)}}}for(r=0;r<u;r++){n=s[r];c=n.update(e);l=n.itemsToRemove;var h=l.length;if(h>0){d=true;for(t=0;t<h;t++){i=l[t];n.remove(i);this.add(e,i)}}}}while(d);return c};p.prototype.getBoundingSphere=function(e,t){var r;var i=this._solidBatches.values;var n=i.length;for(r=0;r<n;r++){var a=i[r];if(a.contains(e)){return a.getBoundingSphere(e,t)}}var o=this._translucentBatches.values;var s=o.length;for(r=0;r<s;r++){var u=o[r];if(u.contains(e)){return u.getBoundingSphere(e,t)}}return l.FAILED};p.prototype.removeAllPrimitives=function(){var e;var t=this._solidBatches.values;var r=t.length;for(e=0;e<r;e++){t[e].removeAllPrimitives()}var i=this._translucentBatches.values;var n=i.length;for(e=0;e<n;e++){i[e].removeAllPrimitives()}};return p});define("DataSources/GeometryVisualizer",["../Core/AssociativeArray","../Core/BoundingSphere","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Scene/ShadowMode","./BoundingSphereState","./ColorMaterialProperty","./StaticGeometryColorBatch","./StaticGeometryPerMaterialBatch","./StaticGroundGeometryColorBatch","./StaticOutlineGeometryBatch"],function(e,t,r,i,n,a,o,s,u,l,c,d){"use strict";var f=[];function h(t,r){this._primitives=t;this._groundPrimitives=r;this._dynamicUpdaters=new e}h.prototype.add=function(e,t){this._dynamicUpdaters.set(t.entity.id,t.createDynamicUpdater(this._primitives,this._groundPrimitives))};h.prototype.remove=function(e){var t=e.entity.id;var i=this._dynamicUpdaters.get(t);if(r(i)){this._dynamicUpdaters.remove(t);i.destroy()}};h.prototype.update=function(e){var t=this._dynamicUpdaters.values;for(var r=0,i=t.length;r<i;r++){t[r].update(e)}return true};h.prototype.removeAllPrimitives=function(){var e=this._dynamicUpdaters.values;for(var t=0,r=e.length;t<r;t++){e[t].destroy()}this._dynamicUpdaters.removeAll()};h.prototype.getBoundingSphere=function(e,t){var i=this._dynamicUpdaters.get(e.id);if(r(i)&&r(i.getBoundingSphere)){return i.getBoundingSphere(e,t)}return o.FAILED};function p(e,t){var r=e._batches;var i=r.length;for(var n=0;n<i;n++){r[n].remove(t)}}function m(e,t,r){if(r.isDynamic){e._dynamicBatch.add(t,r);return}var i;if(r.outlineEnabled||r.fillEnabled){i=r.shadowsProperty.getValue(t)}if(r.outlineEnabled){e._outlineBatches[i].add(t,r)}if(r.fillEnabled){if(r.onTerrain){e._groundColorBatch.add(t,r)}else{if(r.isClosed){if(r.fillMaterialProperty instanceof s){e._closedColorBatches[i].add(t,r)}else{e._closedMaterialBatches[i].add(t,r)}}else{if(r.fillMaterialProperty instanceof s){e._openColorBatches[i].add(t,r)}else{e._openMaterialBatches[i].add(t,r)}}}}}function v(t,i,o){if(!r(t)){throw new n("type is required.")}if(!r(i)){throw new n("scene is required.")}if(!r(o)){throw new n("entityCollection is required.")}this._type=t;var s=i.primitives;var p=i.groundPrimitives;this._scene=i;this._primitives=s;this._groundPrimitives=p;this._entityCollection=undefined;this._addedObjects=new e;this._removedObjects=new e;this._changedObjects=new e;var m=a.NUMBER_OF_SHADOW_MODES;this._outlineBatches=new Array(m);this._closedColorBatches=new Array(m);this._closedMaterialBatches=new Array(m);this._openColorBatches=new Array(m);this._openMaterialBatches=new Array(m);for(var _=0;_<m;++_){this._outlineBatches[_]=new d(s,i,_);this._closedColorBatches[_]=new u(s,t.perInstanceColorAppearanceType,true,_);this._closedMaterialBatches[_]=new l(s,t.materialAppearanceType,true,_);this._openColorBatches[_]=new u(s,t.perInstanceColorAppearanceType,false,_);this._openMaterialBatches[_]=new l(s,t.materialAppearanceType,false,_)}this._groundColorBatch=new c(p);this._dynamicBatch=new h(s,p);this._batches=this._outlineBatches.concat(this._closedColorBatches,this._closedMaterialBatches,this._openColorBatches,this._openMaterialBatches,this._groundColorBatch,this._dynamicBatch);this._subscriptions=new e;this._updaters=new e;this._entityCollection=o;o.collectionChanged.addEventListener(v.prototype._onCollectionChanged,this);this._onCollectionChanged(o,o.values,f)}v.prototype.update=function(e){if(!r(e)){throw new n("time is required.")}var t=this._addedObjects;var i=t.values;var a=this._removedObjects;var o=a.values;var s=this._changedObjects;var u=s.values;var l;var c;var d;var f;for(l=u.length-1;l>-1;l--){c=u[l];d=c.id;f=this._updaters.get(d);if(f.entity===c){p(this,f);m(this,e,f)}else{o.push(c);i.push(c)}}for(l=o.length-1;l>-1;l--){c=o[l];d=c.id;f=this._updaters.get(d);p(this,f);f.destroy();this._updaters.remove(d);this._subscriptions.get(d)();this._subscriptions.remove(d)}for(l=i.length-1;l>-1;l--){c=i[l];d=c.id;f=new this._type(c,this._scene);this._updaters.set(d,f);m(this,e,f);this._subscriptions.set(d,f.geometryChanged.addEventListener(v._onGeometryChanged,this))}t.removeAll();a.removeAll();s.removeAll();var h=true;var _=this._batches;var g=_.length;for(l=0;l<g;l++){h=_[l].update(e)&&h}return h};var _=[];var g=new t;v.prototype.getBoundingSphere=function(e,i){if(!r(e)){throw new n("entity is required.")}if(!r(i)){throw new n("result is required.")}var a=_;var s=g;var u=0;var l=o.DONE;var c=this._batches;var d=c.length;for(var f=0;f<d;f++){l=c[f].getBoundingSphere(e,s);if(l===o.PENDING){return o.PENDING}else if(l===o.DONE){a[u]=t.clone(s,a[u]);u++}}if(u===0){return o.FAILED}a.length=u;t.fromBoundingSpheres(a,i);return o.DONE};v.prototype.isDestroyed=function(){return false};v.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(v.prototype._onCollectionChanged,this);this._addedObjects.removeAll();this._removedObjects.removeAll();var e;var t=this._batches;var r=t.length;for(e=0;e<r;e++){t[e].removeAllPrimitives()}var n=this._subscriptions.values;r=n.length;for(e=0;e<r;e++){n[e]()}this._subscriptions.removeAll();return i(this)};v._onGeometryChanged=function(e){var t=this._removedObjects;var i=this._changedObjects;var n=e.entity;var a=n.id;if(!r(t.get(a))&&!r(i.get(a))){i.set(a,n)}};v.prototype._onCollectionChanged=function(e,t,r){var i=this._addedObjects;var n=this._removedObjects;var a=this._changedObjects;var o;var s;var u;for(o=r.length-1;o>-1;o--){u=r[o];s=u.id;if(!i.remove(s)){n.set(s,u);a.remove(s)}}for(o=t.length-1;o>-1;o--){u=t[o];s=u.id;if(n.remove(s)){a.set(s,u)}else{i.set(s,u)}}};return v});define("DataSources/LabelVisualizer",["../Core/AssociativeArray","../Core/Cartesian2","../Core/Cartesian3","../Core/Color","../Core/defaultValue","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/NearFarScalar","../Scene/HeightReference","../Scene/HorizontalOrigin","../Scene/LabelStyle","../Scene/VerticalOrigin","./BoundingSphereState","./Property"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m){"use strict";var v=1;var _="30px sans-serif";var g=f.FILL;var y=i.WHITE;var w=i.BLACK;var C=1;var b=false;var S=new i(.165,.165,.165,.8);var E=new t(7,5);var T=t.ZERO;var x=r.ZERO;var A=c.NONE;var P=d.CENTER;var D=h.CENTER;var M=new r;var I=new i;var O=new i;var R=new i;var N=new t;var L=new r;var B=new t;var F=new l;var k=new l;var V=new l;var z=new u;function U(e){this.entity=e;this.label=undefined;this.index=undefined}function q(t,r){if(!a(t)){throw new s("entityCluster is required.")}if(!a(r)){throw new s("entityCollection is required.")}r.collectionChanged.addEventListener(q.prototype._onCollectionChanged,this);this._cluster=t;this._entityCollection=r;this._items=new e;this._onCollectionChanged(r,r.values,[],[])}q.prototype.update=function(e){if(!a(e)){throw new s("time is required.")}var t=this._items.values;var r=this._cluster;for(var i=0,n=t.length;i<n;i++){var o=t[i];var u=o.entity;var l=u._label;var c;var d=o.label;var f=u.isShowing&&u.isAvailable(e)&&m.getValueOrDefault(l._show,e,true);if(f){M=m.getValueOrUndefined(u._position,e,M);c=m.getValueOrUndefined(l._text,e);f=a(M)&&a(c)}if(!f){G(o,u,r);continue}if(!m.isConstant(u._position)){r._clusterDirty=true}if(!a(d)){d=r.getLabel(u);d.id=u;o.label=d}d.show=true;d.position=M;d.text=c;d.scale=m.getValueOrDefault(l._scale,e,v);d.font=m.getValueOrDefault(l._font,e,_);d.style=m.getValueOrDefault(l._style,e,g);d.fillColor=m.getValueOrDefault(l._fillColor,e,y,I);d.outlineColor=m.getValueOrDefault(l._outlineColor,e,w,O);d.outlineWidth=m.getValueOrDefault(l._outlineWidth,e,C);d.showBackground=m.getValueOrDefault(l._showBackground,e,b);d.backgroundColor=m.getValueOrDefault(l._backgroundColor,e,S,R);d.backgroundPadding=m.getValueOrDefault(l._backgroundPadding,e,E,N);d.pixelOffset=m.getValueOrDefault(l._pixelOffset,e,T,B);d.eyeOffset=m.getValueOrDefault(l._eyeOffset,e,x,L);d.heightReference=m.getValueOrDefault(l._heightReference,e,A);d.horizontalOrigin=m.getValueOrDefault(l._horizontalOrigin,e,P);d.verticalOrigin=m.getValueOrDefault(l._verticalOrigin,e,D);d.translucencyByDistance=m.getValueOrUndefined(l._translucencyByDistance,e,F);d.pixelOffsetScaleByDistance=m.getValueOrUndefined(l._pixelOffsetScaleByDistance,e,k);d.scaleByDistance=m.getValueOrUndefined(l._scaleByDistance,e,V);d.distanceDisplayCondition=m.getValueOrUndefined(l._distanceDisplayCondition,e,z)}return true};q.prototype.getBoundingSphere=function(e,t){if(!a(e)){throw new s("entity is required.")}if(!a(t)){throw new s("result is required.")}var i=this._items.get(e.id);if(!a(i)||!a(i.label)){return p.FAILED}var o=i.label;t.center=r.clone(n(o._clampedPosition,o.position),t.center);t.radius=0;return p.DONE};q.prototype.isDestroyed=function(){return false};q.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(q.prototype._onCollectionChanged,this);var e=this._entityCollection.values;for(var t=0;t<e.length;t++){this._cluster.removeLabel(e[t])}return o(this)};q.prototype._onCollectionChanged=function(e,t,r,i){var n;var o;var s=this._items;var u=this._cluster;for(n=t.length-1;n>-1;n--){o=t[n];if(a(o._label)&&a(o._position)){s.set(o.id,new U(o))}}for(n=i.length-1;n>-1;n--){o=i[n];if(a(o._label)&&a(o._position)){if(!s.contains(o.id)){s.set(o.id,new U(o))}}else{G(s.get(o.id),o,u);s.remove(o.id)}}for(n=r.length-1;n>-1;n--){o=r[n];G(s.get(o.id),o,u);s.remove(o.id)}};function G(e,t,r){if(a(e)){e.label=undefined;r.removeLabel(t)}}return q});define("ThirdParty/gltfDefaults",["../Core/Cartesian3","../Core/defaultValue","../Core/defined","../Core/Quaternion","../Core/WebGLConstants"],function(e,t,r,i,n){"use strict";function a(e){if(!r(e.accessors)){e.accessors={}}var i=e.accessors;for(var n in i){if(i.hasOwnProperty(n)){var a=i[n];a.byteStride=t(a.byteStride,0)}}}function o(e){if(!r(e.animations)){e.animations={}}var i=e.animations;for(var n in i){if(i.hasOwnProperty(n)){var a=i[n];if(!r(a.channels)){a.channels=[]}if(!r(a.parameters)){a.parameters={}}if(!r(a.samplers)){a.samplers={}}var o=i.samplers;for(var s in o){if(o.hasOwnProperty(s)){var u=o[s];u.interpolation=t(u.interpolation,"LINEAR")}}}}}function s(e){if(!r(e.asset)){e.asset={}}var i=e.asset;if(!r(i.profile)||typeof i.profile==="string"){i.profile={}}var n=i.profile;i.premultipliedAlpha=t(i.premultipliedAlpha,false);n.api=t(n.api,"WebGL");n.version=t(n.version,"1.0.2");if(r(e.version)){i.version=t(i.version,e.version);delete e.version}if(typeof i.version==="number"){i.version=i.version.toFixed(1).toString()}}function u(e){if(!r(e.buffers)){e.buffers={}}var i=e.buffers;for(var n in i){if(i.hasOwnProperty(n)){var a=i[n];a.type=t(a.type,"arraybuffer")}}}function l(e){if(!r(e.bufferViews)){e.bufferViews={}}}function c(e){if(!r(e.cameras)){e.cameras={}}}function d(e){if(!r(e.images)){e.images={}}}function f(e){if(!r(e.extensions)){e.extensions={}}var i=e.extensions;if(!r(i.KHR_materials_common)){i.KHR_materials_common={}}var n=i.KHR_materials_common;if(r(e.lights)){n.lights=e.lights;delete e.lights}else if(!r(n.lights)){n.lights={}}var a=n.lights;for(var o in a){if(a.hasOwnProperty(o)){var s=a[o];if(s.type==="ambient"){if(!r(s.ambient)){s.ambient={}}var u=s.ambient;if(!r(u.color)){u.color=[1,1,1]}}else if(s.type==="directional"){if(!r(s.directional)){s.directional={}}var l=s.directional;if(!r(l.color)){l.color=[1,1,1]}}else if(s.type==="point"){if(!r(s.point)){s.point={}}var c=s.point;if(!r(c.color)){c.color=[1,1,1]}c.constantAttenuation=t(c.constantAttenuation,1);c.linearAttenuation=t(c.linearAttenuation,0);c.quadraticAttenuation=t(c.quadraticAttenuation,0)}else if(s.type==="spot"){if(!r(s.spot)){s.spot={}}var d=s.spot;if(!r(d.color)){d.color=[1,1,1]}d.constantAttenuation=t(d.constantAttenuation,1);d.fallOffAngle=t(d.fallOffAngle,3.14159265);d.fallOffExponent=t(d.fallOffExponent,0);d.linearAttenuation=t(d.linearAttenuation,0);d.quadraticAttenuation=t(d.quadraticAttenuation,0)}}}}function h(e){if(!r(e.materials)){e.materials={}}var t=e.materials;for(var i in t){if(t.hasOwnProperty(i)){var a=t[i];var o=a.instanceTechnique;if(r(o)){a.technique=o.technique;a.values=o.values;delete a.instanceTechnique}if(!r(a.extensions)){if(!r(a.technique)){delete a.values;a.extensions={KHR_materials_common:{technique:"CONSTANT",transparent:false,values:{emission:{type:n.FLOAT_VEC4,value:[.5,.5,.5,1]}}}};if(!r(e.extensionsUsed)){e.extensionsUsed=[]}var s=e.extensionsUsed;if(s.indexOf("KHR_materials_common")===-1){s.push("KHR_materials_common")}}else if(!r(a.values)){a.values={}}}}}}function p(e){if(!r(e.meshes)){e.meshes={}}var i=e.meshes;for(var a in i){if(i.hasOwnProperty(a)){var o=i[a];if(!r(o.primitives)){o.primitives=[]}var s=o.primitives.length;var u=s.length;for(var l=0;l<u;++l){var c=s[l];if(!r(c.attributes)){c.attributes={}}var d=t(c.primitive,n.TRIANGLES);c.mode=t(c.mode,d)}}}}function m(t){if(!r(t.nodes)){t.nodes={}}var n=t.nodes;var a=parseFloat(t.asset.version)<1;var o=new e;var s=new i;for(var u in n){if(n.hasOwnProperty(u)){var l=n[u];if(!r(l.children)){l.children=[]}if(a&&r(l.rotation)){var c=l.rotation;e.fromArray(c,0,o);i.fromAxisAngle(o,c[3],s);l.rotation=[s.x,s.y,s.z,s.w]}if(!r(l.matrix)){if(!r(l.translation)&&!r(l.rotation)&&!r(l.scale)){l.matrix=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}else{if(!r(l.translation)){l.translation=[0,0,0]}if(!r(l.rotation)){l.rotation=[0,0,0,1]}if(!r(l.scale)){l.scale=[1,1,1]}}}var d=l.instanceSkin;if(r(d)){l.skeletons=d.skeletons;l.skin=d.skin;l.meshes=d.meshes;delete l.instanceSkin}}}}function v(e){if(!r(e.programs)){e.programs={}}var t=e.programs;for(var i in t){if(t.hasOwnProperty(i)){var n=t[i];if(!r(n.attributes)){n.attributes=[]}}}}function _(e){if(!r(e.samplers)){e.samplers={}}var i=e.samplers;for(var a in i){if(i.hasOwnProperty(a)){var o=i[a];o.magFilter=t(o.magFilter,n.LINEAR);o.minFilter=t(o.minFilter,n.NEAREST_MIPMAP_LINEAR);o.wrapS=t(o.wrapS,n.REPEAT);o.wrapT=t(o.wrapT,n.REPEAT)}}}function g(e){if(!r(e.scenes)){e.scenes={}}var t=e.scenes;for(var i in t){if(t.hasOwnProperty(i)){var n=t[i];if(!r(n.node)){n.node=[]}}}}function y(e){if(!r(e.shaders)){e.shaders={}}}function w(e){if(!r(e.skins)){e.skins={}}var t=e.skins;for(var i in t){if(t.hasOwnProperty(i)){var n=t[i];if(!r(n.bindShapeMatrix)){n.bindShapeMatrix=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}}}}function C(e){if(!r(e.enable)){e.enable=[]}if(!r(e.disable)){e.disable=[]}}function b(e){if(!r(e.techniques)){e.techniques={}}var i=e.techniques;for(var n in i){if(i.hasOwnProperty(n)){var a=i[n];if(!r(a.parameters)){a.parameters={}}var o=a.parameters;for(var s in o){var u=o[s];u.node=t(u.node,u.source);u.source=undefined}var l=a.passes;if(r(l)){var c=t(a.pass,"defaultPass");if(l.hasOwnProperty(c)){var d=l[c];var f=d.instanceProgram;a.attributes=t(a.attributes,f.attributes);a.program=t(a.program,f.program);a.uniforms=t(a.uniforms,f.uniforms);a.states=t(a.states,d.states)}a.passes=undefined;a.pass=undefined}if(!r(a.attributes)){a.attributes={}}if(!r(a.uniforms)){a.uniforms={}}if(!r(a.states)){a.states={}}C(a.states)}}}function S(e){if(!r(e.textures)){e.textures={}}var i=e.textures;for(var a in i){if(i.hasOwnProperty(a)){var o=i[a];o.format=t(o.format,n.RGBA);o.internalFormat=t(o.internalFormat,o.format);o.target=t(o.target,n.TEXTURE_2D);o.type=t(o.type,n.UNSIGNED_BYTE)}}}var E=function(e){if(!r(e)){return undefined}if(r(e.allExtensions)){e.extensionsUsed=e.allExtensions;e.allExtensions=undefined}e.extensionsUsed=t(e.extensionsUsed,[]);a(e);o(e);s(e);u(e);l(e);c(e);d(e);f(e);h(e);p(e);m(e);v(e);_(e);g(e);y(e);w(e);b(e);S(e);return e};return E});define("Scene/Axis",["../Core/Check","../Core/freezeObject","../Core/Math","../Core/Matrix3","../Core/Matrix4"],function(e,t,r,i,n){"use strict";var a={X:0,Y:1,Z:2,Y_UP_TO_Z_UP:n.fromRotationTranslation(i.fromRotationX(r.PI_OVER_TWO)),Z_UP_TO_Y_UP:n.fromRotationTranslation(i.fromRotationX(-r.PI_OVER_TWO)),X_UP_TO_Z_UP:n.fromRotationTranslation(i.fromRotationY(-r.PI_OVER_TWO)),Z_UP_TO_X_UP:n.fromRotationTranslation(i.fromRotationY(r.PI_OVER_TWO)),X_UP_TO_Y_UP:n.fromRotationTranslation(i.fromRotationZ(r.PI_OVER_TWO)),Y_UP_TO_X_UP:n.fromRotationTranslation(i.fromRotationZ(-r.PI_OVER_TWO)),fromName:function(t){e.typeOf.string("name",t);return a[t]}};return t(a)});define("Scene/getAttributeOrUniformBySemantic",[],function(){"use strict";function e(e,t){var r=e.techniques;for(var i in r){if(r.hasOwnProperty(i)){var n=r[i];var a=n.parameters;var o=n.attributes;var s=n.uniforms;for(var u in o){if(o.hasOwnProperty(u)){if(a[o[u]].semantic===t){return u}}}for(var l in s){if(s.hasOwnProperty(l)){if(a[s[l]].semantic===t){return l}}}}}return undefined}return e});define("Scene/getBinaryAccessor",["../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/ComponentDatatype","../Core/Matrix2","../Core/Matrix3","../Core/Matrix4"],function(e,t,r,i,n,a,o){"use strict";var s={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};var u={SCALAR:undefined,VEC2:e,VEC3:t,VEC4:r,MAT2:n,MAT3:a,MAT4:o};function l(e){var t=e.componentType;var r;if(typeof t==="string"){r=i.fromName(t)}else{r=t}var n=s[e.type];var a=u[e.type];return{componentsPerAttribute:n,classType:a,createArrayBufferView:function(e,t,a){return i.createArrayBufferView(r,e,t,n*a)}}}return l});define("Scene/JobType",["../Core/freezeObject"],function(e){"use strict";var t={TEXTURE:0,PROGRAM:1,BUFFER:2,NUMBER_OF_JOB_TYPES:3};return e(t)});define("Scene/ModelAnimationCache",["../Core/Cartesian3","../Core/defaultValue","../Core/defined","../Core/LinearSpline","../Core/Matrix4","../Core/Quaternion","../Core/QuaternionSpline","../Core/WebGLConstants","./getBinaryAccessor"],function(e,t,r,i,n,a,o,s,u){"use strict";function l(){}var c=/^data\:/i;function d(e,t){var r=e.gltf;var i=r.buffers;var n=r.bufferViews;var a=n[t.bufferView];var o=i[a.buffer];var s=a.byteOffset+t.byteOffset;var l=t.count*u(t).componentsPerAttribute;var d=c.test(o.uri)?"":o.uri;return e.cacheKey+"//"+d+"/"+s+"/"+l}var f={};var h=new e;l.getAnimationParameterValues=function(t,i){var n=d(t,i);var o=f[n];if(!r(o)){var l=t._loadResources;var c=t.gltf;var p=parseFloat(c.asset.version)<1;var m=c.bufferViews;var v=m[i.bufferView];var _=i.componentType;var g=i.type;var y=i.count;var w=l.getBuffer(v);var C=u(i).createArrayBufferView(w.buffer,w.byteOffset+i.byteOffset,y);var b;if(_===s.FLOAT&&g==="SCALAR"){o=C}else if(_===s.FLOAT&&g==="VEC3"){o=new Array(y);for(b=0;b<y;++b){o[b]=e.fromArray(C,3*b)}}else if(_===s.FLOAT&&g==="VEC4"){o=new Array(y);for(b=0;b<y;++b){var S=4*b;if(p){o[b]=a.fromAxisAngle(e.fromArray(C,S,h),C[S+3])}else{o[b]=a.unpack(C,S)}}}if(r(t.cacheKey)){f[n]=o}}return o};var p={};function m(e,t,r){return e.cacheKey+"//"+t+"/"+r}function v(e){this._value=e}v.prototype.evaluate=function(e,t){return this._value};l.getAnimationSpline=function(e,t,n,a,u,l){var c=m(e,t,a);var d=p[c];if(!r(d)){var f=l[u.input];var h=e.gltf.accessors[n.parameters[u.output]];var _=l[u.output];if(f.length===1&&_.length===1){d=new v(_[0])}else{var g=h.componentType;var y=h.type;if(u.interpolation==="LINEAR"){if(g===s.FLOAT&&y==="VEC3"){d=new i({times:f,points:_})}else if(g===s.FLOAT&&y==="VEC4"){d=new o({times:f,points:_})}}}if(r(e.cacheKey)){p[c]=d}}return d};var _={};l.getSkinInverseBindMatrices=function(e,t){var i=d(e,t);var a=_[i];if(!r(a)){var o=e._loadResources;var l=e.gltf;var c=l.bufferViews;var f=c[t.bufferView];var h=t.componentType;var p=t.type;var m=t.count;var v=o.getBuffer(f);var g=u(t).createArrayBufferView(v.buffer,v.byteOffset+t.byteOffset,m);a=new Array(m);if(h===s.FLOAT&&p==="MAT4"){for(var y=0;y<m;++y){a[y]=n.fromArray(g,16*y)}}_[i]=a}return a};return l});define("Scene/ModelAnimationLoop",["../Core/freezeObject"],function(e){"use strict";var t={NONE:0,REPEAT:1,MIRRORED_REPEAT:2};return e(t)});define("Scene/ModelAnimationState",["../Core/freezeObject"],function(e){"use strict";return e({STOPPED:0,ANIMATING:1})});define("Scene/ModelAnimation",["../Core/defaultValue","../Core/defineProperties","../Core/Event","../Core/JulianDate","./ModelAnimationLoop","./ModelAnimationState"],function(e,t,r,i,n,a){"use strict";function o(t,o,s){this._name=t.name;this._startTime=i.clone(t.startTime);this._delay=e(t.delay,0);this._stopTime=t.stopTime;this.removeOnStop=e(t.removeOnStop,false);this._speedup=e(t.speedup,1);this._reverse=e(t.reverse,false);this._loop=e(t.loop,n.NONE);this.start=new r;this.update=new r;this.stop=new r;this._state=a.STOPPED;this._runtimeAnimation=s;this._computedStartTime=undefined;this._duration=undefined;var u=this;this._raiseStartEvent=function(){u.start.raiseEvent(o,u)};this._updateEventTime=0;this._raiseUpdateEvent=function(){u.update.raiseEvent(o,u,u._updateEventTime)};this._raiseStopEvent=function(){u.stop.raiseEvent(o,u)}}t(o.prototype,{name:{get:function(){return this._name}},startTime:{get:function(){return this._startTime}},delay:{get:function(){return this._delay}},stopTime:{get:function(){return this._stopTime}},speedup:{get:function(){return this._speedup}},reverse:{get:function(){return this._reverse}},loop:{get:function(){return this._loop}}});return o});define("Scene/ModelAnimationCollection",["../Core/clone","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/JulianDate","../Core/Math","./ModelAnimation","./ModelAnimationLoop","./ModelAnimationState"],function(e,t,r,i,n,a,o,s,u,l,c){"use strict";function d(e){this.animationAdded=new a;this.animationRemoved=new a;this._model=e;this._scheduledAnimations=[];this._previousTime=undefined}i(d.prototype,{length:{get:function(){return this._scheduledAnimations.length}}});d.prototype.add=function(e){e=t(e,t.EMPTY_OBJECT);var i=this._model;var a=i._runtime.animations;if(!r(a)){throw new n("Animations are not loaded.  Wait for Model.readyPromise to resolve.")}var o=a[e.name];if(!r(o)){throw new n("options.name must be a valid animation name.")}if(r(e.speedup)&&e.speedup<=0){throw new n("options.speedup must be greater than zero.")}var s=new u(e,i,o);this._scheduledAnimations.push(s);this.animationAdded.raiseEvent(i,s);return s};d.prototype.addAll=function(i){i=t(i,t.EMPTY_OBJECT);if(!r(this._model._runtime.animations)){throw new n("Animations are not loaded.  Wait for Model.readyPromise to resolve.")}if(r(i.speedup)&&i.speedup<=0){throw new n("options.speedup must be greater than zero.")}i=e(i);var a=[];var o=this._model._animationIds;var s=o.length;for(var u=0;u<s;++u){i.name=o[u];a.push(this.add(i))}return a};d.prototype.remove=function(e){if(r(e)){var t=this._scheduledAnimations;var i=t.indexOf(e);if(i!==-1){t.splice(i,1);this.animationRemoved.raiseEvent(this._model,e);return true}}return false};d.prototype.removeAll=function(){var e=this._model;var t=this._scheduledAnimations;var r=t.length;this._scheduledAnimations=[];for(var i=0;i<r;++i){this.animationRemoved.raiseEvent(e,t[i])}};d.prototype.contains=function(e){if(r(e)){return this._scheduledAnimations.indexOf(e)!==-1}return false};d.prototype.get=function(e){if(!r(e)){throw new n("index is required.")}return this._scheduledAnimations[e]};function f(e,t){var r=e.channelEvaluators;var i=r.length;for(var n=0;n<i;++n){r[n](t)}}var h=[];function p(e,t,r){return function(){e.animationRemoved.raiseEvent(t,r)}}d.prototype.update=function(e){var i=this._scheduledAnimations;var n=i.length;if(n===0){this._previousTime=undefined;return false}if(o.equals(e.time,this._previousTime)){return false}this._previousTime=o.clone(e.time,this._previousTime);var a=false;var u=e.time;var d=this._model;for(var m=0;m<n;++m){var v=i[m];var _=v._runtimeAnimation;if(!r(v._computedStartTime)){v._computedStartTime=o.addSeconds(t(v.startTime,u),v.delay,new o)}if(!r(v._duration)){v._duration=_.stopTime*(1/v.speedup)}var g=v._computedStartTime;var y=v._duration;var w=v.stopTime;var C=y!==0?o.secondsDifference(u,g)/y:0;var b=C>=0;var S=v.loop===l.REPEAT||v.loop===l.MIRRORED_REPEAT;var E=(b||S&&!r(v.startTime))&&(C<=1||S)&&(!r(w)||o.lessThanOrEquals(u,w));if(E){if(v._state===c.STOPPED){v._state=c.ANIMATING;if(v.start.numberOfListeners>0){e.afterRender.push(v._raiseStartEvent)}}if(v.loop===l.REPEAT){C=C-Math.floor(C)}else if(v.loop===l.MIRRORED_REPEAT){var T=Math.floor(C);var x=C-T;C=T%2===1?1-x:x}if(v.reverse){C=1-C}var A=C*y*v.speedup;A=s.clamp(A,_.startTime,_.stopTime);f(_,A);if(v.update.numberOfListeners>0){v._updateEventTime=A;e.afterRender.push(v._raiseUpdateEvent)}a=true}else{if(b&&v._state===c.ANIMATING){v._state=c.STOPPED;if(v.stop.numberOfListeners>0){e.afterRender.push(v._raiseStopEvent)}if(v.removeOnStop){h.push(v)}}}}n=h.length;for(var P=0;P<n;++P){var D=h[P];i.splice(i.indexOf(D),1);e.afterRender.push(p(this,d,D))}h.length=0;return a};return d});define("Scene/ModelMaterial",["../Core/defined","../Core/defineProperties","../Core/DeveloperError"],function(e,t,r){"use strict";function i(e,t,r){this._name=t.name;this._id=r;this._uniformMap=e._uniformMaps[r]}t(i.prototype,{name:{get:function(){return this._name}},id:{get:function(){return this._id}}});i.prototype.setValue=function(t,i){if(!e(t)){throw new r("name is required.")}var n=this._uniformMap.values[t];if(!e(n)){throw new r("name must match a parameter name in the material's technique that is targetable and not optimized out.")}n.value=n.clone(i,n.value)};i.prototype.getValue=function(t){if(!e(t)){throw new r("name is required.")}var i=this._uniformMap.values[t];if(!e(i)){return undefined}
return i.value};return i});define("Scene/modelMaterialsCommon",["../Core/defaultValue","../Core/defined","../Core/WebGLConstants"],function(e,t,r){"use strict";function i(e){switch(e){case r.FLOAT:return"float";case r.FLOAT_VEC2:return"vec2";case r.FLOAT_VEC3:return"vec3";case r.FLOAT_VEC4:return"vec4";case r.FLOAT_MAT2:return"mat2";case r.FLOAT_MAT3:return"mat3";case r.FLOAT_MAT4:return"mat4";case r.SAMPLER_2D:return"sampler2D"}}function n(e){var i={};var n;if(t(e.extensions)&&t(e.extensions.KHR_materials_common)){n=e.extensions.KHR_materials_common.lights}if(t(n)){var a=e.nodes;for(var o in a){if(a.hasOwnProperty(o)){var s=a[o];if(t(s.extensions)&&t(s.extensions.KHR_materials_common)){var u=s.extensions.KHR_materials_common.light;if(t(u)&&t(n[u])){n[u].node=o}delete s.extensions.KHR_materials_common}}}var l=0;for(var c in n){if(n.hasOwnProperty(c)){var d=n[c];var f=d.type;if(f!=="ambient"&&!t(d.node)){delete n[c];continue}var h="light"+l.toString();d.baseName=h;switch(f){case"ambient":var p=d.ambient;i[h+"Color"]={type:r.FLOAT_VEC3,value:p.color};break;case"directional":var m=d.directional;i[h+"Color"]={type:r.FLOAT_VEC3,value:m.color};if(t(d.node)){i[h+"Transform"]={node:d.node,semantic:"MODELVIEW",type:r.FLOAT_MAT4}}break;case"point":var v=d.point;i[h+"Color"]={type:r.FLOAT_VEC3,value:v.color};if(t(d.node)){i[h+"Transform"]={node:d.node,semantic:"MODELVIEW",type:r.FLOAT_MAT4}}i[h+"Attenuation"]={type:r.FLOAT_VEC3,value:[v.constantAttenuation,v.linearAttenuation,v.quadraticAttenuation]};break;case"spot":var _=d.spot;i[h+"Color"]={type:r.FLOAT_VEC3,value:_.color};if(t(d.node)){i[h+"Transform"]={node:d.node,semantic:"MODELVIEW",type:r.FLOAT_MAT4};i[h+"InverseTransform"]={node:d.node,semantic:"MODELVIEWINVERSE",type:r.FLOAT_MAT4,useInFragment:true}}i[h+"Attenuation"]={type:r.FLOAT_VEC3,value:[_.constantAttenuation,_.linearAttenuation,_.quadraticAttenuation]};i[h+"FallOff"]={type:r.FLOAT_VEC2,value:[_.fallOffAngle,_.fallOffExponent]};break}++l}}}return i}function a(r,i,n){var a=e(n,0);var o;do{o=i+(a++).toString()}while(t(r[o]));return o}var o=0;var s=0;var u=0;var l=0;function c(n,c,f,h){var p=n.techniques;var m=n.shaders;var v=n.programs;var _=c.technique.toUpperCase();var g;if(t(n.extensions)&&t(n.extensions.KHR_materials_common)){g=n.extensions.KHR_materials_common.lights}var y=e(c.jointCount,0);var w=y>0;var C=c.values;var b="precision highp float;\n";var S="precision highp float;\n";var E=a(p,"technique",o);var T=a(m,"vertexShader",s);var x=a(m,"fragmentShader",u);var A=a(v,"program",l);var P=_!=="CONSTANT";var D={modelViewMatrix:{semantic:h.useCesiumRTCMatrixInShaders?"CESIUM_RTC_MODELVIEW":"MODELVIEW",type:r.FLOAT_MAT4},projectionMatrix:{semantic:"PROJECTION",type:r.FLOAT_MAT4}};if(P){D.normalMatrix={semantic:"MODELVIEWINVERSETRANSPOSE",type:r.FLOAT_MAT3}}if(w){D.jointMatrix={count:y,semantic:"JOINTMATRIX",type:r.FLOAT_MAT4}}var M;var I=false;for(var O in C){if(C.hasOwnProperty(O)&&O!=="transparent"&&O!=="doubleSided"){var R=d(O,C[O]);M=O.toLowerCase();if(!I&&R===r.SAMPLER_2D){I=true}D[M]={type:R}}}if(t(D.diffuse)){D.diffuse.semantic="_3DTILESDIFFUSE"}if(t(f)){for(var N in f){if(f.hasOwnProperty(N)){D[N]=f[N]}}}var L={};for(var B in D){if(D.hasOwnProperty(B)){var F=D[B];L["u_"+B]=B;var k=t(F.count)?"["+F.count+"]":"";if(F.type!==r.FLOAT_MAT3&&F.type!==r.FLOAT_MAT4||F.useInFragment){S+="uniform "+i(F.type)+" u_"+B+k+";\n";delete F.useInFragment}else{b+="uniform "+i(F.type)+" u_"+B+k+";\n"}}}var V="";if(w){V+="  mat4 skinMat = a_weight.x * u_jointMatrix[int(a_joint.x)];\n";V+="  skinMat += a_weight.y * u_jointMatrix[int(a_joint.y)];\n";V+="  skinMat += a_weight.z * u_jointMatrix[int(a_joint.z)];\n";V+="  skinMat += a_weight.w * u_jointMatrix[int(a_joint.w)];\n"}var z={a_position:"position"};D.position={semantic:"POSITION",type:r.FLOAT_VEC3};b+="attribute vec3 a_position;\n";b+="varying vec3 v_positionEC;\n";if(w){V+="  vec4 pos = u_modelViewMatrix * skinMat * vec4(a_position,1.0);\n"}else{V+="  vec4 pos = u_modelViewMatrix * vec4(a_position,1.0);\n"}V+="  v_positionEC = pos.xyz;\n";V+="  gl_Position = u_projectionMatrix * pos;\n";S+="varying vec3 v_positionEC;\n";if(P){z.a_normal="normal";D.normal={semantic:"NORMAL",type:r.FLOAT_VEC3};b+="attribute vec3 a_normal;\n";b+="varying vec3 v_normal;\n";if(w){V+="  v_normal = u_normalMatrix * mat3(skinMat) * a_normal;\n"}else{V+="  v_normal = u_normalMatrix * a_normal;\n"}S+="varying vec3 v_normal;\n"}var U;if(I){z.a_texcoord_0="texcoord_0";D.texcoord_0={semantic:"TEXCOORD_0",type:r.FLOAT_VEC2};U="v_texcoord_0";b+="attribute vec2 a_texcoord_0;\n";b+="varying vec2 "+U+";\n";V+="  "+U+" = a_texcoord_0;\n";S+="varying vec2 "+U+";\n"}if(w){z.a_joint="joint";D.joint={semantic:"JOINT",type:r.FLOAT_VEC4};z.a_weight="weight";D.weight={semantic:"WEIGHT",type:r.FLOAT_VEC4};b+="attribute vec4 a_joint;\n";b+="attribute vec4 a_weight;\n"}if(h.addBatchIdToGeneratedShaders){z.a_batchId="batchId";D.batchId={semantic:"_BATCHID",type:r.FLOAT};b+="attribute float a_batchId;\n"}var q=P&&(_==="BLINN"||_==="PHONG")&&t(D.specular)&&t(D.shininess);var G=false;var H=false;var W="";for(var j in g){if(g.hasOwnProperty(j)){var Y=g[j];var X=Y.type.toLowerCase();var Z=Y.baseName;W+="  {\n";var K="u_"+Z+"Color";var Q;var J;if(X==="ambient"){H=true;W+="    ambientLight += "+K+";\n"}else if(P){G=true;Q="v_"+Z+"Direction";J="v_"+Z+"Position";if(X!=="point"){b+="varying vec3 "+Q+";\n";S+="varying vec3 "+Q+";\n";V+="  "+Q+" = mat3(u_"+Z+"Transform) * vec3(0.,0.,1.);\n";if(X==="directional"){W+="    vec3 l = normalize("+Q+");\n"}}if(X!=="directional"){b+="varying vec3 "+J+";\n";S+="varying vec3 "+J+";\n";V+="  "+J+" = u_"+Z+"Transform[3].xyz;\n";W+="    vec3 VP = "+J+" - v_positionEC;\n";W+="    vec3 l = normalize(VP);\n";W+="    float range = length(VP);\n";W+="    float attenuation = 1.0 / (u_"+Z+"Attenuation.x + ";W+="(u_"+Z+"Attenuation.y * range) + ";W+="(u_"+Z+"Attenuation.z * range * range));\n"}else{W+="    float attenuation = 1.0;\n"}if(X==="spot"){W+="    float spotDot = dot(l, normalize("+Q+"));\n";W+="    if (spotDot < cos(u_"+Z+"FallOff.x * 0.5))\n";W+="    {\n";W+="      attenuation = 0.0;\n";W+="    }\n";W+="    else\n";W+="    {\n";W+="        attenuation *= max(0.0, pow(spotDot, u_"+Z+"FallOff.y));\n";W+="    }\n"}W+="    diffuseLight += "+K+"* max(dot(normal,l), 0.) * attenuation;\n";if(q){if(_==="BLINN"){W+="    vec3 h = normalize(l + viewDir);\n";W+="    float specularIntensity = max(0., pow(max(dot(normal, h), 0.), u_shininess)) * attenuation;\n"}else{W+="    vec3 reflectDir = reflect(-l, normal);\n";W+="    float specularIntensity = max(0., pow(max(dot(reflectDir, viewDir), 0.), u_shininess)) * attenuation;\n"}W+="    specularLight += "+K+" * specularIntensity;\n"}}W+="  }\n"}}if(!H){W+="  ambientLight += vec3(0.2, 0.2, 0.2);\n"}if(!G&&_!=="CONSTANT"){W+="  vec3 l = normalize(czm_sunDirectionEC);\n";W+="  diffuseLight += vec3(1.0, 1.0, 1.0) * max(dot(normal,l), 0.);\n";if(q){if(_==="BLINN"){W+="  vec3 h = normalize(l + viewDir);\n";W+="  float specularIntensity = max(0., pow(max(dot(normal, h), 0.), u_shininess));\n"}else{W+="  vec3 reflectDir = reflect(-l, normal);\n";W+="  float specularIntensity = max(0., pow(max(dot(reflectDir, viewDir), 0.), u_shininess));\n"}W+="  specularLight += vec3(1.0, 1.0, 1.0) * specularIntensity;\n"}}b+="void main(void) {\n";b+=V;b+="}\n";S+="void main(void) {\n";var $="  vec3 color = vec3(0.0, 0.0, 0.0);\n";if(P){S+="  vec3 normal = normalize(v_normal);\n";if(c.doubleSided){S+="  if (gl_FrontFacing == false)\n";S+="  {\n";S+="    normal = -normal;\n";S+="  }\n"}}var ee;if(_!=="CONSTANT"){if(t(D.diffuse)){if(D.diffuse.type===r.SAMPLER_2D){S+="  vec4 diffuse = texture2D(u_diffuse, "+U+");\n"}else{S+="  vec4 diffuse = u_diffuse;\n"}S+="  vec3 diffuseLight = vec3(0.0, 0.0, 0.0);\n";$+="  color += diffuse.rgb * diffuseLight;\n"}if(q){if(D.specular.type===r.SAMPLER_2D){S+="  vec3 specular = texture2D(u_specular, "+U+").rgb;\n"}else{S+="  vec3 specular = u_specular.rgb;\n"}S+="  vec3 specularLight = vec3(0.0, 0.0, 0.0);\n";$+="  color += specular * specularLight;\n"}if(t(D.transparency)){ee="  gl_FragColor = vec4(color * diffuse.a, diffuse.a * u_transparency);\n"}else{ee="  gl_FragColor = vec4(color * diffuse.a, diffuse.a);\n"}}else{if(t(D.transparency)){ee="  gl_FragColor = vec4(color, u_transparency);\n"}else{ee="  gl_FragColor = vec4(color, 1.0);\n"}}if(t(D.emission)){if(D.emission.type===r.SAMPLER_2D){S+="  vec3 emission = texture2D(u_emission, "+U+").rgb;\n"}else{S+="  vec3 emission = u_emission.rgb;\n"}$+="  color += emission;\n"}if(t(D.ambient)||_!=="CONSTANT"){if(t(D.ambient)){if(D.ambient.type===r.SAMPLER_2D){S+="  vec3 ambient = texture2D(u_ambient, "+U+").rgb;\n"}else{S+="  vec3 ambient = u_ambient.rgb;\n"}}else{S+="  vec3 ambient = diffuse.rgb;\n"}$+="  color += ambient * ambientLight;\n"}S+="  vec3 viewDir = -normalize(v_positionEC);\n";S+="  vec3 ambientLight = vec3(0.0, 0.0, 0.0);\n";S+=W;S+=$;S+=ee;S+="}\n";var te;if(c.transparent){te={enable:[r.DEPTH_TEST,r.BLEND],depthMask:false,functions:{blendEquationSeparate:[r.FUNC_ADD,r.FUNC_ADD],blendFuncSeparate:[r.ONE,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA]}}}else if(c.doubleSided){te={enable:[r.DEPTH_TEST]}}else{te={enable:[r.CULL_FACE,r.DEPTH_TEST]}}p[E]={attributes:z,parameters:D,program:A,states:te,uniforms:L};m[T]={type:r.VERTEX_SHADER,uri:"",extras:{source:b}};m[x]={type:r.FRAGMENT_SHADER,uri:"",extras:{source:S}};var re=Object.keys(z);v[A]={attributes:re,fragmentShader:x,vertexShader:T};return E}function d(e,i){var n;if(t(i.value)){n=i.value}else{n=i}switch(e){case"ambient":return n instanceof String||typeof n==="string"?r.SAMPLER_2D:r.FLOAT_VEC4;case"diffuse":return n instanceof String||typeof n==="string"?r.SAMPLER_2D:r.FLOAT_VEC4;case"emission":return n instanceof String||typeof n==="string"?r.SAMPLER_2D:r.FLOAT_VEC4;case"specular":return n instanceof String||typeof n==="string"?r.SAMPLER_2D:r.FLOAT_VEC4;case"shininess":return r.FLOAT;case"transparency":return r.FLOAT;case"transparent":return r.BOOL;case"doubleSided":return r.BOOL}}function f(t){var r="";r+="technique:"+t.technique+";";var i=t.values;var n=Object.keys(i).sort();var a=n.length;for(var o=0;o<a;++o){var s=n[o];if(i.hasOwnProperty(s)&&s!=="transparent"&&s!=="doubleSided"){r+=s+":"+d(s,i[s]);r+=";"}}var u=e(t.doubleSided,false);r+=u.toString()+";";var l=e(t.transparent,false);r+=l.toString()+";";var c=e(t.jointCount,0);r+=c.toString()+";";return r}function h(r,i){if(!t(r)){return undefined}i=e(i,e.EMPTY_OBJECT);var a=false;var o=r.extensionsUsed;if(t(o)){var s=o.length;for(var u=0;u<s;++u){if(o[u]==="KHR_materials_common"){a=true;o.splice(u,1);break}}}if(a){if(!t(r.programs)){r.programs={}}if(!t(r.shaders)){r.shaders={}}if(!t(r.techniques)){r.techniques={}}var l=n(r);var d=t(r.extensions)&&t(r.extensions.CESIUM_RTC);var h=e(i.addBatchIdToGeneratedShaders,false);var p={};var m=r.materials;for(var v in m){if(m.hasOwnProperty(v)){var _=m[v];if(t(_.extensions)&&t(_.extensions.KHR_materials_common)){var g=_.extensions.KHR_materials_common;var y=f(g);var w=p[y];if(!t(w)){w=c(r,g,l,{addBatchIdToGeneratedShaders:h,useCesiumRTCMatrixInShaders:d});p[y]=w}_.values={};var C=g.values;for(var b in C){if(C.hasOwnProperty(b)){var S=C[b];if(t(S.value)){_.values[b]=S.value}else{_.values[b]=S}}}_.technique=w;delete _.extensions.KHR_materials_common}}}if(t(r.extensions)){delete r.extensions.KHR_materials_common}}return r}return h});define("Scene/ModelMesh",["../Core/defineProperties"],function(e){"use strict";function t(e,t,r){var i=[];var n=e.primitives;var a=n.length;for(var o=0;o<a;++o){var s=n[o];i[o]=t[s.material]}this._name=e.name;this._materials=i;this._id=r}e(t.prototype,{name:{get:function(){return this._name}},id:{get:function(){return this._id}},materials:{get:function(){return this._materials}}});return t});define("Scene/ModelNode",["../Core/defineProperties","../Core/Matrix4"],function(e,t){"use strict";function r(e,r,i,n,a){this._model=e;this._runtimeNode=i;this._name=r.name;this._id=n;this.useMatrix=false;this._show=true;this._matrix=t.clone(a)}e(r.prototype,{name:{get:function(){return this._name}},id:{get:function(){return this._id}},show:{get:function(){return this._show},set:function(e){if(this._show!==e){this._show=e;this._model._perNodeShowDirty=true}}},matrix:{get:function(){return this._matrix},set:function(e){this._matrix=t.clone(e,this._matrix);this.useMatrix=true;var r=this._model;r._cesiumAnimationsDirty=true;this._runtimeNode.dirtyNumber=r._maxDirtyNumber}}});r.prototype.setMatrix=function(e){t.clone(e,this._matrix)};return r});define("Scene/Model",["../Core/BoundingSphere","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Cartographic","../Core/clone","../Core/Color","../Core/combine","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/FeatureDetection","../Core/getAbsoluteUri","../Core/getBaseUri","../Core/getMagic","../Core/getStringFromTypedArray","../Core/IndexDatatype","../Core/joinUrls","../Core/loadArrayBuffer","../Core/loadCRN","../Core/loadImage","../Core/loadImageFromTypedArray","../Core/loadKTX","../Core/loadText","../Core/Math","../Core/Matrix2","../Core/Matrix3","../Core/Matrix4","../Core/PixelFormat","../Core/PrimitiveType","../Core/Quaternion","../Core/Queue","../Core/Request","../Core/RequestScheduler","../Core/RuntimeError","../Core/Transforms","../Core/WebGLConstants","../Renderer/Buffer","../Renderer/BufferUsage","../Renderer/DrawCommand","../Renderer/Pass","../Renderer/RenderState","../Renderer/Sampler","../Renderer/ShaderProgram","../Renderer/ShaderSource","../Renderer/Texture","../Renderer/TextureMinificationFilter","../Renderer/TextureWrap","../Renderer/VertexArray","../ThirdParty/gltfDefaults","../ThirdParty/Uri","../ThirdParty/when","./Axis","./BlendingState","./ColorBlendMode","./getAttributeOrUniformBySemantic","./getBinaryAccessor","./HeightReference","./JobType","./ModelAnimationCache","./ModelAnimationCollection","./ModelMaterial","./modelMaterialsCommon","./ModelMesh","./ModelNode","./SceneMode","./ShadowMode"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w,C,b,S,E,T,x,A,P,D,M,I,O,R,N,L,B,F,k,V,z,U,q,G,H,W,j,Y,X,Z,K,Q,J,$,ee,te,re,ie,ne,ae,oe,se,ue,le,ce,de,fe,he,pe,me){"use strict";if(!p.supportsTypedArrays()){return{}}var ve=new r;var _e={NEEDS_LOAD:0,LOADING:1,LOADED:2,FAILED:3};var ge="model/vnd.gltf.binary,model/vnd.gltf+json,model/gltf.binary,model/gltf+json;q=0.8,application/json;q=0.2,*/*;q=0.01";function ye(){this.vertexBuffersToCreate=new N;this.indexBuffersToCreate=new N;this.buffers={};this.pendingBufferLoads=0;this.programsToCreate=new N;this.shaders={};this.pendingShaderLoads=0;this.texturesToCreate=new N;this.pendingTextureLoads=0;this.texturesToCreateFromBufferView=new N;this.pendingBufferViewToImage=0;this.createSamplers=true;this.createSkins=true;this.createRuntimeAnimations=true;this.createVertexArrays=true;this.createRenderStates=true;this.createUniformMaps=true;this.createRuntimeNodes=true;this.skinnedNodesIds=[]}ye.prototype.getBuffer=function(e){return Ae(this.buffers[e.buffer],e.byteOffset,e.byteLength)};ye.prototype.finishedPendingBufferLoads=function(){return this.pendingBufferLoads===0};ye.prototype.finishedBuffersCreation=function(){return this.pendingBufferLoads===0&&this.vertexBuffersToCreate.length===0&&this.indexBuffersToCreate.length===0};ye.prototype.finishedProgramCreation=function(){return this.pendingShaderLoads===0&&this.programsToCreate.length===0};ye.prototype.finishedTextureCreation=function(){var e=this.pendingTextureLoads===0;var t=this.texturesToCreate.length===0&&this.texturesToCreateFromBufferView.length===0;return e&&t};ye.prototype.finishedEverythingButTextureCreation=function(){var e=this.pendingBufferLoads===0&&this.pendingShaderLoads===0;var t=this.vertexBuffersToCreate.length===0&&this.indexBuffersToCreate.length===0&&this.programsToCreate.length===0&&this.pendingBufferViewToImage===0;return e&&t};ye.prototype.finished=function(){return this.finishedTextureCreation()&&this.finishedEverythingButTextureCreation()};function we(e,t){e._cachedGltf=t;e._animationIds=be(t)}function Ce(e){this._gltf=de(J(e.gltf),{addBatchIdToGeneratedShaders:e.addBatchIdToGeneratedShaders});this._bgltf=e.bgltf;this.ready=e.ready;this.modelsToLoad=[];this.count=0}c(Ce.prototype,{gltf:{set:function(e){this._gltf=de(J(e))},get:function(){return this._gltf}},bgltf:{get:function(){return this._bgltf}}});Ce.prototype.makeReady=function(e,t){this.gltf=e;this._bgltf=t;var r=this.modelsToLoad;var i=r.length;for(var n=0;n<i;++n){var a=r[n];if(!a.isDestroyed()){we(a,this)}}this.modelsToLoad=undefined;this.ready=true};function be(e){var t=[];if(l(e)&&l(e.gltf)){var r=e.gltf.animations;for(var i in r){if(r.hasOwnProperty(i)){t.push(i)}}}return t}var Se={};function Ee(t){t=u(t,u.EMPTY_OBJECT);var r=t.cacheKey;this._cacheKey=r;this._cachedGltf=undefined;this._releaseGltfJson=u(t.releaseGltfJson,false);this._animationIds=undefined;var i;if(l(r)&&l(Se[r])&&Se[r].ready){i=Se[r];++i.count}else{var n=t.gltf;if(l(n)){if(n instanceof ArrayBuffer){n=new Uint8Array(n)}if(n instanceof Uint8Array){var a=De(n);if(a.binaryOffset!==0){n=n.subarray(a.binaryOffset)}i=new Ce({gltf:a.glTF,bgltf:n,ready:true,addBatchIdToGeneratedShaders:t.addBatchIdToGeneratedShaders})}else{i=new Ce({gltf:t.gltf,ready:true,addBatchIdToGeneratedShaders:t.addBatchIdToGeneratedShaders})}i.count=1;if(l(r)){Se[r]=i}}}we(this,i);this._basePath=u(t.basePath,"");var s=v(document.location.href);this._baseUri=w(s,this._basePath);this.show=u(t.show,true);this.silhouetteColor=u(t.silhouetteColor,o.RED);this._silhouetteColor=new o;this._silhouetteColorPreviousAlpha=1;this._normalAttributeName=undefined;this.silhouetteSize=u(t.silhouetteSize,0);this.modelMatrix=M.clone(u(t.modelMatrix,M.IDENTITY));this._modelMatrix=M.clone(this.modelMatrix);this._clampedModelMatrix=undefined;this.scale=u(t.scale,1);this._scale=this.scale;this.minimumPixelSize=u(t.minimumPixelSize,0);this._minimumPixelSize=this.minimumPixelSize;this.maximumScale=t.maximumScale;this._maximumScale=this.maximumScale;this.id=t.id;this._id=t.id;this.heightReference=u(t.heightReference,oe.NONE);this._heightReference=this.heightReference;this._heightChanged=false;this._removeUpdateHeightCallback=undefined;var c=t.scene;this._scene=c;if(l(c)){c.terrainProviderChanged.addEventListener(function(){this._heightChanged=true},this)}this.pickPrimitive=t.pickPrimitive;this._allowPicking=u(t.allowPicking,true);this._ready=false;this._readyPromise=ee.defer();this.activeAnimations=new le(this);this._defaultTexture=undefined;this._incrementallyLoadTextures=u(t.incrementallyLoadTextures,true);this._asynchronous=u(t.asynchronous,true);this.shadows=u(t.shadows,me.ENABLED);this._shadows=this.shadows;this.color=u(t.color,o.WHITE);this._color=new o;this._colorPreviousAlpha=1;this.colorBlendMode=u(t.colorBlendMode,ie.HIGHLIGHT);this.colorBlendAmount=u(t.colorBlendAmount,.5);this.debugShowBoundingVolume=u(t.debugShowBoundingVolume,false);this._debugShowBoundingVolume=false;this.debugWireframe=u(t.debugWireframe,false);this._debugWireframe=false;this._distanceDisplayCondition=t.distanceDisplayCondition;this._precreatedAttributes=t.precreatedAttributes;this._vertexShaderLoaded=t.vertexShaderLoaded;this._fragmentShaderLoaded=t.fragmentShaderLoaded;this._uniformMapLoaded=t.uniformMapLoaded;this._pickVertexShaderLoaded=t.pickVertexShaderLoaded;this._pickFragmentShaderLoaded=t.pickFragmentShaderLoaded;this._pickUniformMapLoaded=t.pickUniformMapLoaded;this._ignoreCommands=u(t.ignoreCommands,false);this._requestType=t.requestType;this._upAxis=u(t.upAxis,te.Y);this.cull=u(t.cull,true);this._computedModelMatrix=new M;this._initialRadius=undefined;this._boundingSphere=undefined;this._scaledBoundingSphere=new e;this._state=_e.NEEDS_LOAD;this._loadResources=undefined;this._mode=undefined;this._perNodeShowDirty=false;this._cesiumAnimationsDirty=false;this._dirty=false;this._maxDirtyNumber=0;this._runtime={animations:undefined,rootNodes:undefined,nodes:undefined,nodesByName:undefined,skinnedNodes:undefined,meshesByName:undefined,materialsByName:undefined,materialsById:undefined};this._uniformMaps={};this._extensionsUsed=undefined;this._quantizedUniforms={};this._programPrimitives={};this._rendererResources={buffers:{},vertexArrays:{},programs:{},pickPrograms:{},silhouettePrograms:{},textures:{},samplers:{},renderStates:{}};this._cachedRendererResources=undefined;this._loadRendererResourcesFromCache=false;this._cachedVertexMemorySizeInBytes=0;this._cachedTextureMemorySizeInBytes=0;this._vertexMemorySizeInBytes=0;this._textureMemorySizeInBytes=0;this._nodeCommands=[];this._pickIds=[];this._rtcCenter=undefined;this._rtcCenterEye=undefined;this._rtcCenter3D=undefined;this._rtcCenter2D=undefined}c(Ee.prototype,{gltf:{get:function(){return l(this._cachedGltf)?this._cachedGltf.gltf:undefined}},releaseGltfJson:{get:function(){return this._releaseGltfJson}},cacheKey:{get:function(){return this._cacheKey}},basePath:{get:function(){return this._basePath}},boundingSphere:{get:function(){if(this._state!==_e.LOADED){throw new f("The model is not loaded.  Use Model.readyPromise or wait for Model.ready to be true.")}var e=this.modelMatrix;if(this.heightReference!==oe.NONE&&this._clampedModelMatrix){e=this._clampedModelMatrix}var t=M.getScale(e,ve);var i=l(this.maximumScale)?Math.min(this.maximumScale,this.scale):this.scale;r.multiplyByScalar(t,i,t);var n=this._scaledBoundingSphere;n.center=r.multiplyComponents(this._boundingSphere.center,t,n.center);n.radius=r.maximumComponent(t)*this._initialRadius;if(l(this._rtcCenter)){r.add(this._rtcCenter,n.center,n.center)}return n}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},asynchronous:{get:function(){return this._asynchronous}},allowPicking:{get:function(){return this._allowPicking}},incrementallyLoadTextures:{get:function(){return this._incrementallyLoadTextures}},pendingTextureLoads:{get:function(){return l(this._loadResources)?this._loadResources.pendingTextureLoads:0}},dirty:{get:function(){return this._dirty}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){if(l(e)&&e.far<=e.near){throw new f("far must be greater than near")}this._distanceDisplayCondition=h.clone(e,this._distanceDisplayCondition)}},upAxis:{get:function(){return this._upAxis}},vertexMemorySizeInBytes:{get:function(){return this._vertexMemorySizeInBytes}},textureMemorySizeInBytes:{get:function(){return this._textureMemorySizeInBytes}},cachedVertexMemorySizeInBytes:{get:function(){return this._cachedVertexMemorySizeInBytes}},cachedTextureMemorySizeInBytes:{get:function(){return this._cachedTextureMemorySizeInBytes}}});var Te=Uint32Array.BYTES_PER_ELEMENT;function xe(e){return e.stencilBuffer}Ee.silhouetteSupported=function(e){return xe(e.context)};function Ae(e,t,r){return e.subarray(t,t+r)}function Pe(e){var t=_(e);return t==="glTF"}function De(e){if(!Pe(e)){throw new f("bgltf is not a valid Binary glTF file.")}var t=new DataView(e.buffer,e.byteOffset,e.byteLength);var r=0;r+=Te;var i=t.getUint32(r,true);if(i!==1){throw new f("Only Binary glTF version 1 is supported.  Version "+i+" is not.")}r+=Te;r+=Te;var n=t.getUint32(r,true);r+=Te+Te;var a=r;var o=a+n;var s=g(e,a,n);return{glTF:JSON.parse(s),binaryOffset:o}}Ee.fromGltf=function(e){if(!l(e)||!l(e.url)){throw new f("options.url is required")}var t=e.url;var r=u(e.cacheKey,m(t));e=a(e);e.basePath=v(t,true);e.cacheKey=r;var i=new Ee(e);e.headers=l(e.headers)?a(e.headers):{};if(!l(e.headers.Accept)){e.headers.Accept=ge}var n=Se[r];if(!l(n)){n=new Ce({ready:false});n.count=1;n.modelsToLoad.push(i);we(i,n);Se[r]=n;B.request(t,C,e.headers,e.requestType).then(function(e){var t=new Uint8Array(e);if(Pe(t)){var r=De(t);if(r.binaryOffset!==0){t=t.subarray(r.binaryOffset)}n.makeReady(r.glTF,t)}else{var i=g(t);n.makeReady(JSON.parse(i))}}).otherwise(Le(i,"model",t))}else if(!n.ready){++n.count;n.modelsToLoad.push(i)}return i};Ee._gltfCache=Se;function Me(e,t,r){if(e._state!==_e.LOADED){throw new f("The model is not loaded.  Use Model.readyPromise or wait for Model.ready to be true.")}if(!l(r)){throw new f("name is required.")}return e._runtime[t][r]}Ee.prototype.getNode=function(e){var t=Me(this,"nodesByName",e);return l(t)?t.publicNode:undefined};Ee.prototype.getMesh=function(e){return Me(this,"meshesByName",e)};Ee.prototype.getMaterial=function(e){return Me(this,"materialsByName",e)};var Ie=new r;var Oe=new r;function Re(e,t){var r=e.accessors[t];var i=r.extensions;var n=r.min;var a=r.max;if(l(i)){var o=i.WEB3D_quantized_attributes;if(l(o)){n=o.decodedMin;a=o.decodedMax}}return{min:n,max:a}}function Ne(t,i){var n=i.nodes;var a=i.meshes;var o=i.scenes[i.scene].nodes;var s=o.length;var u=[];var c=new r(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE);var d=new r(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(var f=0;f<s;++f){var h=n[o[f]];h._transformToRoot=Ze(h);u.push(h);while(u.length>0){h=u.pop();var p=h._transformToRoot;var m=h.meshes;if(l(m)){var v=m.length;for(var _=0;_<v;++_){var g=a[m[_]].primitives;var y=g.length;for(var w=0;w<y;++w){var C=g[w].attributes.POSITION;if(l(C)){var b=Re(i,C);var S=r.fromArray(b.min,0,Ie);var E=r.fromArray(b.max,0,Oe);if(l(c)&&l(d)){M.multiplyByPoint(p,S,S);M.multiplyByPoint(p,E,E);r.minimumByComponent(c,S,c);r.maximumByComponent(d,E,d)}}}}}var T=h.children;var x=T.length;for(var A=0;A<x;++A){var P=n[T[A]];P._transformToRoot=Ze(P);M.multiplyTransformation(p,P._transformToRoot,P._transformToRoot);u.push(P)}delete h._transformToRoot}}var D=e.fromCornerPoints(c,d);if(t._upAxis===te.Y){e.transformWithoutScale(D,te.Y_UP_TO_Z_UP,D)}else if(t._upAxis===te.X){e.transformWithoutScale(D,te.X_UP_TO_Z_UP,D)}return D}function Le(e,t,r){return function(){e._state=_e.FAILED;e._readyPromise.reject(new F("Failed to load "+t+": "+r))}}function Be(e,t){return function(r){var i=e._loadResources;i.buffers[t]=new Uint8Array(r);--i.pendingBufferLoads}}function Fe(e){var t=e.gltf.buffers;for(var r in t){if(t.hasOwnProperty(r)){var i=t[r];if(r==="binary_glTF"||r==="KHR_binary_glTF"){var n=e._loadResources;n.buffers[r]=e._cachedGltf.bgltf}else if(i.type==="arraybuffer"){++e._loadResources.pendingBufferLoads;var a=w(e._baseUri,i.uri);var o=B.request(a,C,undefined,e._requestType);o.then(Be(e,r)).otherwise(Le(e,"buffer",a))}}}}function ke(e){var t=e.gltf.bufferViews;var r;var i=e._loadResources.vertexBuffersToCreate;for(r in t){if(t.hasOwnProperty(r)){if(t[r].target===V.ARRAY_BUFFER){i.enqueue(r)}}}var n=e._loadResources.indexBuffersToCreate;var a={};var o=e.gltf.accessors;for(r in o){if(o.hasOwnProperty(r)){var s=o[r];var u=s.bufferView;var c=t[u];if(c.target===V.ELEMENT_ARRAY_BUFFER&&!l(a[u])){a[u]=true;n.enqueue({id:u,componentType:s.componentType})}}}}function Ve(e,t,r){return function(i){var n=e._loadResources;n.shaders[r]={source:i,type:t,bufferView:undefined};--n.pendingShaderLoads}}function ze(e){var t=e.gltf.shaders;for(var r in t){if(t.hasOwnProperty(r)){var i=t[r];if(l(i.extras)&&l(i.extras.source)){e._loadResources.shaders[r]={source:i.extras.source,bufferView:undefined}}else if(l(i.extensions)&&l(i.extensions.KHR_binary_glTF)){var n=i.extensions.KHR_binary_glTF;e._loadResources.shaders[r]={source:undefined,bufferView:n.bufferView}}else{++e._loadResources.pendingShaderLoads;var a=w(e._baseUri,i.uri);var o=B.request(a,x,undefined,e.requestType);o.then(Ve(e,i.type,r)).otherwise(Le(e,"shader",a))}}}}function Ue(e){var t=e.gltf.programs;for(var r in t){if(t.hasOwnProperty(r)){e._loadResources.programsToCreate.enqueue(r)}}}function qe(e,t){return function(r){var i=e._loadResources;--i.pendingTextureLoads;i.texturesToCreate.enqueue({id:t,image:r,bufferView:r.bufferView,width:r.width,height:r.height,internalFormat:r.internalFormat})}}var Ge=/(^data:image\/ktx)|(\.ktx$)/i;var He=/(^data:image\/crn)|(\.crn$)/i;function We(e,t){var r=e.gltf.images;var i=e.gltf.textures;for(var n in i){if(i.hasOwnProperty(n)){var a=r[i[n].source];var o=a.extras;var s=undefined;var u=undefined;if(l(o)&&l(o.compressedImage3DTiles)){var c=o.compressedImage3DTiles.crunch;var d=o.compressedImage3DTiles.s3tc;var f=o.compressedImage3DTiles.pvrtc1;var h=o.compressedImage3DTiles.etc1;if(t.s3tc&&l(c)){if(l(c.extensions)&&l(c.extensions.KHR_binary_glTF)){s=c.extensions.KHR_binary_glTF}else{u=c.uri}}else if(t.s3tc&&l(d)){if(l(d.extensions)&&l(d.extensions.KHR_binary_glTF)){s=d.extensions.KHR_binary_glTF}else{u=d.uri}}else if(t.pvrtc&&l(f)){if(l(f.extensions)&&l(f.extensions.KHR_binary_glTF)){s=f.extensions.KHR_binary_glTF}else{u=f.uri}}else if(t.etc1&&l(h)){if(l(h.extensions)&&l(h.extensions.KHR_binary_glTF)){s=h.extensions.KHR_binary_glTF}else{u=h.uri}}}if(!l(s)&&!l(u)){if(l(a.extensions)&&l(a.extensions.KHR_binary_glTF)){s=a.extensions.KHR_binary_glTF}else{u=new $(a.uri)}}if(l(s)){e._loadResources.texturesToCreateFromBufferView.enqueue({id:n,image:undefined,bufferView:s.bufferView,mimeType:s.mimeType})}else{++e._loadResources.pendingTextureLoads;var p=w(e._baseUri,a.uri);var m;if(Ge.test(p)){m=B.request(p,T,undefined,e._requestType)}else if(He.test(p)){m=B.request(p,b,undefined,e._requestType)}else{m=B.request(p,S,undefined,e._requestType)}m.then(qe(e,n)).otherwise(Le(e,"image",p))}}}}var je=new r;var Ye=new R;var Xe=new r;function Ze(e){if(l(e.matrix)){return M.fromArray(e.matrix)}return M.fromTranslationQuaternionRotationScale(r.fromArray(e.translation,0,je),R.unpack(e.rotation,0,Ye),r.fromArray(e.scale,0,Xe))}function Ke(e){var t={};var r={};var i=[];var n=e._loadResources.skinnedNodesIds;var a=e.gltf.nodes;for(var o in a){if(a.hasOwnProperty(o)){var s=a[o];var u={matrix:undefined,translation:undefined,rotation:undefined,scale:undefined,computedShow:true,transformToRoot:new M,computedMatrix:new M,dirtyNumber:0,commands:[],inverseBindMatrices:undefined,bindShapeMatrix:undefined,joints:[],computedJointMatrices:[],jointName:s.jointName,children:[],parents:[],publicNode:undefined};u.publicNode=new he(e,s,u,o,Ze(s));t[o]=u;r[s.name]=u;if(l(s.skin)){n.push(o);i.push(u)}}}e._runtime.nodes=t;e._runtime.nodesByName=r;e._runtime.skinnedNodes=i}function Qe(e){var t={};var r={};var i=e.gltf.materials;var n=e._uniformMaps;for(var a in i){if(i.hasOwnProperty(a)){n[a]={uniformMap:undefined,values:undefined,jointMatrixUniformName:undefined};var o=i[a];var s=new ce(e,o,a);t[o.name]=s;r[a]=s}}e._runtime.materialsByName=t;e._runtime.materialsById=r}function Je(e){var t={};var r=e._runtime.materialsById;var i=e.gltf.meshes;var n=et(e,"WEB3D_quantized_attributes");for(var a in i){if(i.hasOwnProperty(a)){var o=i[a];t[o.name]=new fe(o,r,a);if(n){var s=o.primitives;var u=s.length;for(var c=0;c<u;c++){var d=s[c];var f=dt(e,d);var h=e._programPrimitives[f];if(!l(h)){h=[];e._programPrimitives[f]=h}h.push(d)}}}}e._runtime.meshesByName=t}function $e(e,t){if(!e._loadRendererResourcesFromCache){Fe(e);ke(e);ze(e);Ue(e);We(e,t)}Qe(e);Je(e);Ke(e)}function et(e,t){var r=e._extensionsUsed;if(!l(r)){var i=e.gltf.extensionsUsed;r={};var n=i.length;for(var a=0;a<n;a++){r[i[a]]=true}}return l(r[t])}var tt=function(){this.id=undefined;this.model=undefined;this.context=undefined};tt.prototype.set=function(e,t,r){this.id=e;this.model=t;this.context=r};tt.prototype.execute=function(){rt(this.id,this.model,this.context)};function rt(e,t,r){var i=t._loadResources;var n=t.gltf.bufferViews;var a=n[e];var o=z.createVertexBuffer({context:r,typedArray:i.getBuffer(a),usage:U.STATIC_DRAW});o.vertexArrayDestroyable=false;t._rendererResources.buffers[e]=o;t._vertexMemorySizeInBytes+=o.sizeInBytes}var it=function(){this.id=undefined;this.componentType=undefined;this.model=undefined;this.context=undefined};it.prototype.set=function(e,t,r,i){this.id=e;this.componentType=t;this.model=r;this.context=i};it.prototype.execute=function(){nt(this.id,this.componentType,this.model,this.context)};function nt(e,t,r,i){var n=r._loadResources
;var a=r.gltf.bufferViews;var o=a[e];var s=z.createIndexBuffer({context:i,typedArray:n.getBuffer(o),usage:U.STATIC_DRAW,indexDatatype:t});s.vertexArrayDestroyable=false;r._rendererResources.buffers[e]=s;r._vertexMemorySizeInBytes+=s.sizeInBytes}var at=new tt;var ot=new it;function st(e,t){var r=e._loadResources;if(r.pendingBufferLoads!==0){return}var i=t.context;var n=r.vertexBuffersToCreate;var a=r.indexBuffersToCreate;var o;if(e.asynchronous){while(n.length>0){at.set(n.peek(),e,i);if(!t.jobScheduler.execute(at,se.BUFFER)){break}n.dequeue()}while(a.length>0){o=a.peek();ot.set(o.id,o.componentType,e,i);if(!t.jobScheduler.execute(ot,se.BUFFER)){break}a.dequeue()}}else{while(n.length>0){rt(n.dequeue(),e,i)}while(a.length>0){o=a.dequeue();nt(o.id,o.componentType,e,i)}}}function ut(e,t){var r={};var i=t.length;var n;for(n=1;n<i;++n){var a=t[n];if(/pos/i.test(a)){t[n]=t[0];t[0]=a;break}}for(n=0;n<i;++n){r[t[n]]=n}return r}function lt(e,t){if(l(t.source)){return t.source}var r=e._loadResources;var i=e.gltf;var n=i.bufferViews[t.bufferView];return g(r.getBuffer(n))}function ct(e,t,r){var i=e.indexOf(t);return e.replace(new RegExp(t,"g"),function(e,t,n){return i===t?e:r})}function dt(e,t){var r=e.gltf;var i=t.material;var n=r.materials[i];var a=n.technique;var o=r.techniques[a];return o.program}function ft(e,t){var r=e.gltf;var i=r.accessors[t];var n=i.extensions;if(l(n)){return n.WEB3D_quantized_attributes}return undefined}function ht(e,t,r){var i=e.gltf;var n=t.material;var a=i.materials[n];var o=a.technique;var s=i.techniques[o];for(var u in s.parameters){if(s.parameters.hasOwnProperty(u)){var l=s.parameters[u].semantic;if(l===r){var c=s.attributes;for(var d in c){if(c.hasOwnProperty(d)){var f=c[d];if(f===u){return d}}}}}}return undefined}function pt(e,t,r,i){var n={};r._quantizedUniforms[t]=n;var a=r._programPrimitives[t];for(var o=0;o<a.length;o++){var s=a[o];if(dt(r,s)===t){for(var u in s.attributes){if(s.attributes.hasOwnProperty(u)){var c="gltf_u_dec_"+u.toLowerCase();var d=c+"_scale";var f=c+"_translate";if(!l(n[c])&&!l(n[d])){var h=s.attributes[u];var p=ft(r,h);if(l(p)){var m=ht(r,s,u);var v=p.decodeMatrix;var _="gltf_decoded_"+u;var g=m.replace("a_","gltf_a_dec_");var y=Math.floor(Math.sqrt(v.length));e=ct(e,m,g);var w;if(y>2){w="vec"+(y-1)}else{w="float"}e=w+" "+g+";\n"+e;var C="";if(y===5){e="uniform mat4 "+d+";\n"+e;e="uniform vec4 "+f+";\n"+e;C="\n"+"void main() {\n"+"    "+g+" = "+d+" * "+m+" + "+f+";\n"+"    "+_+"();\n"+"}\n";n[d]={mat:4};n[f]={vec:4}}else{e="uniform mat"+y+" "+c+";\n"+e;C="\n"+"void main() {\n"+"    "+g+" = "+w+"("+c+" * vec"+y+"("+m+",1.0));\n"+"    "+_+"();\n"+"}\n";n[c]={mat:y}}e=Y.replaceMain(e,_);e+=C}}}}}}r._programPrimitives[t]=undefined;return e}function mt(e){var t=e.gltf;return l(t.asset)?u(t.asset.premultipliedAlpha,false):false}function vt(e,t){e=Y.replaceMain(e,"gltf_blend_main");e+="uniform vec4 gltf_color; \n"+"uniform float gltf_colorBlend; \n"+"void main() \n"+"{ \n"+"    gltf_blend_main(); \n";if(t){e+="    float alpha = 1.0 - ceil(gl_FragColor.a) + gl_FragColor.a; \n"+"    gl_FragColor.rgb /= alpha; \n"}e+="    gl_FragColor.rgb = mix(gl_FragColor.rgb, gltf_color.rgb, gltf_colorBlend); \n"+"    float highlight = ceil(gltf_colorBlend); \n"+"    gl_FragColor.rgb *= mix(gltf_color.rgb, vec3(1.0), highlight); \n"+"    gl_FragColor.a *= gltf_color.a; \n"+"} \n";return e}function _t(e,t,r){if(l(r)){e=r(e,t)}return e}var gt=function(){this.id=undefined;this.model=undefined;this.context=undefined};gt.prototype.set=function(e,t,r){this.id=e;this.model=t;this.context=r};gt.prototype.execute=function(){yt(this.id,this.model,this.context)};function yt(e,t,r){var i=t.gltf.programs;var n=t._loadResources.shaders;var a=i[e];var o=ut(t,a.attributes);var s=lt(t,n[a.vertexShader]);var u=lt(t,n[a.fragmentShader]);var c=a.attributes.length;var d=t._precreatedAttributes;if(l(d)){for(var f in d){if(d.hasOwnProperty(f)){o[f]=c++}}}if(et(t,"WEB3D_quantized_attributes")){s=pt(s,e,t,r)}var h=mt(t);var p=vt(u,h);var m=_t(s,e,t._vertexShaderLoaded);var v=_t(p,e,t._fragmentShaderLoaded);t._rendererResources.programs[e]=j.fromCache({context:r,vertexShaderSource:m,fragmentShaderSource:v,attributeLocations:o});if(t.allowPicking){var _=_t(s,e,t._pickVertexShaderLoaded);var g=_t(u,e,t._pickFragmentShaderLoaded);if(!t._pickFragmentShaderLoaded){g=Y.createPickFragmentShaderSource(u,"uniform")}t._rendererResources.pickPrograms[e]=j.fromCache({context:r,vertexShaderSource:_,fragmentShaderSource:g,attributeLocations:o})}}var wt=new gt;function Ct(e,t){var r=e._loadResources;var i=r.programsToCreate;if(r.pendingShaderLoads!==0){return}if(r.pendingBufferLoads!==0){return}var n=t.context;if(e.asynchronous){while(i.length>0){wt.set(i.peek(),e,n);if(!t.jobScheduler.execute(wt,se.PROGRAM)){break}i.dequeue()}}else{while(i.length>0){yt(i.dequeue(),e,n)}}}function bt(e,t){return function(r){e.texturesToCreate.enqueue({id:t.id,image:r,bufferView:undefined});--e.pendingBufferViewToImage}}function St(e){var t=e._loadResources;if(t.pendingBufferLoads!==0){return}while(t.texturesToCreateFromBufferView.length>0){var r=t.texturesToCreateFromBufferView.dequeue();var i=e.gltf;var n=i.bufferViews[r.bufferView];var a=Le(e,"image","id: "+r.id+", bufferView: "+r.bufferView);if(r.mimeType==="image/ktx"){T(t.getBuffer(n)).then(qe(e,r.id)).otherwise(a);++e._loadResources.pendingTextureLoads}else if(r.mimeType==="image/crn"){b(t.getBuffer(n)).then(qe(e,r.id)).otherwise(a);++e._loadResources.pendingTextureLoads}else{var o=bt(t,r);E(t.getBuffer(n),r.mimeType).then(o).otherwise(a);++t.pendingBufferViewToImage}}}function Et(e,t){var r=e._loadResources;if(r.createSamplers){r.createSamplers=false;var i=e._rendererResources.samplers;var n=e.gltf.samplers;for(var a in n){if(n.hasOwnProperty(a)){var o=n[a];i[a]=new W({wrapS:o.wrapS,wrapT:o.wrapT,minificationFilter:o.minFilter,magnificationFilter:o.magFilter})}}}}var Tt=function(){this.gltfTexture=undefined;this.model=undefined;this.context=undefined};Tt.prototype.set=function(e,t,r){this.gltfTexture=e;this.model=t;this.context=r};Tt.prototype.execute=function(){xt(this.gltfTexture,this.model,this.context)};function xt(e,t,r){var i=t.gltf.textures;var n=i[e.id];var a=t._rendererResources.samplers;var o=a[n.sampler];var s=e.internalFormat;var u=!(l(s)&&I.isCompressedFormat(s))&&(o.minificationFilter===Z.NEAREST_MIPMAP_NEAREST||o.minificationFilter===Z.NEAREST_MIPMAP_LINEAR||o.minificationFilter===Z.LINEAR_MIPMAP_NEAREST||o.minificationFilter===Z.LINEAR_MIPMAP_LINEAR);var c=u||o.wrapS===K.REPEAT||o.wrapS===K.MIRRORED_REPEAT||o.wrapT===K.REPEAT||o.wrapT===K.MIRRORED_REPEAT;var d;var f=e.image;if(l(s)&&n.target===V.TEXTURE_2D){d=new X({context:r,source:{arrayBufferView:e.bufferView},width:e.width,height:e.height,pixelFormat:s,sampler:o})}else if(l(f)){var h=!A.isPowerOfTwo(f.width)||!A.isPowerOfTwo(f.height);if(c&&h){var p=document.createElement("canvas");p.width=A.nextPowerOfTwo(f.width);p.height=A.nextPowerOfTwo(f.height);var m=p.getContext("2d");m.drawImage(f,0,0,f.width,f.height,0,0,p.width,p.height);f=p}if(n.target===V.TEXTURE_2D){d=new X({context:r,source:f,pixelFormat:n.internalFormat,pixelDatatype:n.type,sampler:o,flipY:false})}if(u){d.generateMipmap()}}t._rendererResources.textures[e.id]=d;t._textureMemorySizeInBytes+=d.sizeInBytes}var At=new Tt;function Pt(e,t){var r=t.context;var i=e._loadResources.texturesToCreate;if(e.asynchronous){while(i.length>0){At.set(i.peek(),e,r);if(!t.jobScheduler.execute(At,se.TEXTURE)){break}i.dequeue()}}else{while(i.length>0){xt(i.dequeue(),e,r)}}}function Dt(e,t){var r=e.gltf;var i=r.techniques;var n=r.materials;var a={};var o;var s;var u=i[n[t.material].technique];var c=u.parameters;var d=u.attributes;var f=e._rendererResources.programs[u.program];var h=f.vertexAttributes;var p=f._attributeLocations;for(o in h){if(h.hasOwnProperty(o)){var m=d[o];s=h[o].index;if(l(m)){var v=c[m];a[v.semantic]=s}}}var _=e._precreatedAttributes;if(l(_)){for(o in _){if(_.hasOwnProperty(o)){s=p[o];a[o]=s}}}return a}function Mt(e,t,r){var i=e.length;for(var n=0;n<i;++n){var a=[e[n]];while(a.length>0){var o=a.pop();var s=r[o];if(s.jointName===t){return o}var u=s.children;var l=u.length;for(var c=0;c<l;++c){a.push(u[c])}}}return undefined}function It(e,t){var r=e.gltf;var i=r.skins;var n=r.nodes;var a=e._runtime.nodes;var o=e._loadResources.skinnedNodesIds;var s=o.length;for(var u=0;u<s;++u){var l=o[u];var c=a[l];var d=n[l];var f=t[d.skin];c.inverseBindMatrices=f.inverseBindMatrices;c.bindShapeMatrix=f.bindShapeMatrix;var h=[];var p=d.skeletons;var m=p.length;for(var v=0;v<m;++v){h.push(p[v])}var _=i[d.skin].jointNames;var g=_.length;for(var y=0;y<g;++y){var w=_[y];var C=a[Mt(h,w,n)];c.joints.push(C)}}}function Ot(e){var t=e._loadResources;if(t.pendingBufferLoads!==0){return}if(!t.createSkins){return}t.createSkins=false;var r=e.gltf;var i=r.accessors;var n=r.skins;var a={};for(var o in n){if(n.hasOwnProperty(o)){var s=n[o];var u=i[s.inverseBindMatrices];var l;if(!M.equals(s.bindShapeMatrix,M.IDENTITY)){l=M.clone(s.bindShapeMatrix)}a[o]={inverseBindMatrices:ue.getSkinInverseBindMatrices(e,u),bindShapeMatrix:l}}}It(e,a)}function Rt(e,t,r,i){return function(n){t[r]=i.evaluate(n,t[r]);t.dirtyNumber=e._maxDirtyNumber}}function Nt(e){var t=e._loadResources;if(!t.finishedPendingBufferLoads()){return}if(!t.createRuntimeAnimations){return}t.createRuntimeAnimations=false;e._runtime.animations={};var r=e._runtime.nodes;var i=e.gltf.animations;var n=e.gltf.accessors;for(var a in i){if(i.hasOwnProperty(a)){var o=i[a];var s=o.channels;var u=o.parameters;var l=o.samplers;var c={};for(var d in u){if(u.hasOwnProperty(d)){c[d]=ue.getAnimationParameterValues(e,n[u[d]])}}var f=Number.MAX_VALUE;var h=-Number.MAX_VALUE;var p=s.length;var m=new Array(p);for(var v=0;v<p;++v){var _=s[v];var g=_.target;var y=l[_.sampler];var w=c[y.input];f=Math.min(f,w[0]);h=Math.max(h,w[w.length-1]);var C=ue.getAnimationSpline(e,a,o,_.sampler,y,c);m[v]=Rt(e,r[g.id],g.path,C)}e._runtime.animations[a]={startTime:f,stopTime:h,channelEvaluators:m}}}}function Lt(e,t){var r=e._loadResources;if(!r.finishedBuffersCreation()||!r.finishedProgramCreation()){return}if(!r.createVertexArrays){return}r.createVertexArrays=false;var i=e._rendererResources.buffers;var n=e._rendererResources.vertexArrays;var a=e.gltf;var o=a.accessors;var s=a.meshes;for(var u in s){if(s.hasOwnProperty(u)){var c=s[u].primitives;var d=c.length;for(var f=0;f<d;++f){var h=c[f];var p=Dt(e,h);var m;var v;var _;var g=[];var y=h.attributes;for(m in y){if(y.hasOwnProperty(m)){v=p[m];if(l(v)){var w=o[y[m]];var C=w.componentType;C=C===5125?5123:C;g.push({index:v,vertexBuffer:i[w.bufferView],componentsPerAttribute:ae(w).componentsPerAttribute,componentDatatype:C,normalize:false,offsetInBytes:w.byteOffset,strideInBytes:w.byteStride})}}}var b=e._precreatedAttributes;if(l(b)){for(m in b){if(b.hasOwnProperty(m)){v=p[m];if(l(v)){_=b[m];_.index=v;g.push(_)}}}}var S;if(l(h.indices)){var E=o[h.indices];S=i[E.bufferView]}n[u+".primitive."+f]=new Q({context:t,attributes:g,indexBuffer:S})}}}}function Bt(e){var t={};t[V.BLEND]=false;t[V.CULL_FACE]=false;t[V.DEPTH_TEST]=false;t[V.POLYGON_OFFSET_FILL]=false;t[V.SCISSOR_TEST]=false;var r=e.enable;var i=r.length;var n;for(n=0;n<i;++n){t[r[n]]=true}return t}function Ft(e,t){var r=e._loadResources;var i=e.gltf.techniques;if(r.createRenderStates){r.createRenderStates=false;for(var n in i){if(i.hasOwnProperty(n)){kt(e,n,t)}}}}function kt(e,t,r){var i=e._rendererResources.renderStates;var n=e.gltf.techniques;var a=n[t];var o=a.states;var s=Bt(o);var c=u(o.functions,u.EMPTY_OBJECT);var d=u(c.blendColor,[0,0,0,0]);var f=u(c.blendEquationSeparate,[V.FUNC_ADD,V.FUNC_ADD]);var h=u(c.blendFuncSeparate,[V.ONE,V.ZERO,V.ONE,V.ZERO]);var p=u(c.colorMask,[true,true,true,true]);var m=u(c.depthRange,[0,1]);var v=u(c.polygonOffset,[0,0]);var _=u(c.scissor,[0,0,0,0]);if(s[V.BLEND]&&mt(e)){if(h[0]===V.ONE&&h[1]===V.ONE_MINUS_SRC_ALPHA){h[0]=V.SRC_ALPHA;h[1]=V.ONE_MINUS_SRC_ALPHA;h[2]=V.SRC_ALPHA;h[3]=V.ONE_MINUS_SRC_ALPHA}}i[t]=H.fromCache({frontFace:l(c.frontFace)?c.frontFace[0]:V.CCW,cull:{enabled:s[V.CULL_FACE],face:l(c.cullFace)?c.cullFace[0]:V.BACK},lineWidth:l(c.lineWidth)?c.lineWidth[0]:1,polygonOffset:{enabled:s[V.POLYGON_OFFSET_FILL],factor:v[0],units:v[1]},scissorTest:{enabled:s[V.SCISSOR_TEST],rectangle:{x:_[0],y:_[1],width:_[2],height:_[3]}},depthRange:{near:m[0],far:m[1]},depthTest:{enabled:s[V.DEPTH_TEST],func:l(c.depthFunc)?c.depthFunc[0]:V.LESS},colorMask:{red:p[0],green:p[1],blue:p[2],alpha:p[3]},depthMask:l(c.depthMask)?c.depthMask[0]:true,blending:{enabled:s[V.BLEND],color:{red:d[0],green:d[1],blue:d[2],alpha:d[3]},equationRgb:f[0],equationAlpha:f[1],functionSourceRgb:h[0],functionDestinationRgb:h[1],functionSourceAlpha:h[2],functionDestinationAlpha:h[3]}})}var Vt=new r;var zt={MODEL:function(e,t){return function(){return e.model}},VIEW:function(e,t){return function(){return e.view}},PROJECTION:function(e,t){return function(){return e.projection}},MODELVIEW:function(e,t){return function(){return e.modelView}},CESIUM_RTC_MODELVIEW:function(e,t){var i=new M;return function(){if(l(t._rtcCenter)){M.getTranslation(e.model,Vt);r.add(Vt,t._rtcCenter,Vt);M.multiplyByPoint(e.view,Vt,Vt);return M.setTranslation(e.modelView,Vt,i)}return e.modelView}},MODELVIEWPROJECTION:function(e,t){return function(){return e.modelViewProjection}},MODELINVERSE:function(e,t){return function(){return e.inverseModel}},VIEWINVERSE:function(e,t){return function(){return e.inverseView}},PROJECTIONINVERSE:function(e,t){return function(){return e.inverseProjection}},MODELVIEWINVERSE:function(e,t){return function(){return e.inverseModelView}},MODELVIEWPROJECTIONINVERSE:function(e,t){return function(){return e.inverseModelViewProjection}},MODELINVERSETRANSPOSE:function(e,t){return function(){return e.inverseTransposeModel}},MODELVIEWINVERSETRANSPOSE:function(e,t){return function(){return e.normal}},VIEWPORT:function(e,t){return function(){return e.viewportCartesian4}}};function Ut(e,t){var r={value:e,clone:function(e,t){return e},func:function(){return r.value}};return r}function qt(e,r){var i={value:t.fromArray(e),clone:t.clone,func:function(){return i.value}};return i}function Gt(e,t){var i={value:r.fromArray(e),clone:r.clone,func:function(){return i.value}};return i}function Ht(e,t){var r={value:i.fromArray(e),clone:i.clone,func:function(){return r.value}};return r}function Wt(e,t){var r={value:P.fromColumnMajorArray(e),clone:P.clone,func:function(){return r.value}};return r}function jt(e,t){var r={value:D.fromColumnMajorArray(e),clone:D.clone,func:function(){return r.value}};return r}function Yt(e,t){var r={value:M.fromColumnMajorArray(e),clone:M.clone,func:function(){return r.value}};return r}function Xt(e,t){this._value=undefined;this._textureId=e;this._model=t}c(Xt.prototype,{value:{get:function(){if(!l(this._value)){var e=this._model._rendererResources.textures[this._textureId];if(l(e)){this._value=e}else{return this._model._defaultTexture}}return this._value},set:function(e){this._value=e}}});Xt.prototype.clone=function(e,t){return e};Xt.prototype.func=undefined;function Zt(e,t){var r=new Xt(e,t);r.func=function(){return r.value};return r}var Kt={};Kt[V.FLOAT]=Ut;Kt[V.FLOAT_VEC2]=qt;Kt[V.FLOAT_VEC3]=Gt;Kt[V.FLOAT_VEC4]=Ht;Kt[V.INT]=Ut;Kt[V.INT_VEC2]=qt;Kt[V.INT_VEC3]=Gt;Kt[V.INT_VEC4]=Ht;Kt[V.BOOL]=Ut;Kt[V.BOOL_VEC2]=qt;Kt[V.BOOL_VEC3]=Gt;Kt[V.BOOL_VEC4]=Ht;Kt[V.FLOAT_MAT2]=Wt;Kt[V.FLOAT_MAT3]=jt;Kt[V.FLOAT_MAT4]=Yt;Kt[V.SAMPLER_2D]=Zt;var Qt={MODEL:function(e,t,r){return function(){return r.computedMatrix}},VIEW:function(e,t,r){return function(){return e.view}},PROJECTION:function(e,t,r){return function(){return e.projection}},MODELVIEW:function(e,t,r){var i=new M;return function(){return M.multiplyTransformation(e.view,r.computedMatrix,i)}},CESIUM_RTC_MODELVIEW:function(e,t,r){var i=new M;return function(){M.multiplyTransformation(e.view,r.computedMatrix,i);return M.setTranslation(i,t._rtcCenterEye,i)}},MODELVIEWPROJECTION:function(e,t,r){var i=new M;return function(){M.multiplyTransformation(e.view,r.computedMatrix,i);return M.multiply(e._projection,i,i)}},MODELINVERSE:function(e,t,r){var i=new M;return function(){return M.inverse(r.computedMatrix,i)}},VIEWINVERSE:function(e,t){return function(){return e.inverseView}},PROJECTIONINVERSE:function(e,t,r){return function(){return e.inverseProjection}},MODELVIEWINVERSE:function(e,t,r){var i=new M;var n=new M;return function(){M.multiplyTransformation(e.view,r.computedMatrix,i);return M.inverse(i,n)}},MODELVIEWPROJECTIONINVERSE:function(e,t,r){var i=new M;var n=new M;return function(){M.multiplyTransformation(e.view,r.computedMatrix,i);M.multiply(e._projection,i,i);return M.inverse(i,n)}},MODELINVERSETRANSPOSE:function(e,t,r){var i=new M;var n=new D;return function(){M.inverse(r.computedMatrix,i);M.getRotation(i,n);return D.transpose(n,n)}},MODELVIEWINVERSETRANSPOSE:function(e,t,r){var i=new M;var n=new M;var a=new D;return function(){M.multiplyTransformation(e.view,r.computedMatrix,i);M.inverse(i,n);M.getRotation(n,a);return D.transpose(a,a)}},VIEWPORT:function(e,t,r){return function(){return e.viewportCartesian4}}};function Jt(e,t,r,i){var n=t._runtime.nodes[e];return Qt[r](i,t,n)}function $t(e,t){var r=e._loadResources;if(!r.finishedProgramCreation()){return}if(!r.createUniformMaps){return}r.createUniformMaps=false;var i=e.gltf;var n=i.materials;var a=i.techniques;var o=e._uniformMaps;for(var s in n){if(n.hasOwnProperty(s)){var u=n[s];var c=u.values;var d=a[u.technique];var f=d.parameters;var h=d.uniforms;var p={};var m={};var v;for(var _ in h){if(h.hasOwnProperty(_)){var g=h[_];var y=f[g];if(l(c[g])){var w=Kt[y.type](c[g],e);p[_]=w.func;m[g]=w}else if(l(y.node)){p[_]=Jt(y.node,e,y.semantic,t.uniformState)}else if(l(y.semantic)){if(y.semantic!=="JOINTMATRIX"){p[_]=zt[y.semantic](t.uniformState,e)}else{v=_}}else if(l(y.value)){var C=Kt[y.type](y.value,e);p[_]=C.func;m[g]=C}}}var b=o[s];b.uniformMap=p;b.values=m;b.jointMatrixUniformName=v}}}function er(e){return[e[0],e[1],e[2],e[3],e[5],e[6],e[7],e[8],e[10],e[11],e[12],e[13],e[15],e[16],e[17],e[18]]}function tr(e){return[e[20],e[21],e[22],e[23]]}function rr(e,t,r){var i=e.gltf;var n=i.accessors;var a=dt(e,t);var o=e._quantizedUniforms[a];var s={};var u={};for(var c in t.attributes){if(t.attributes.hasOwnProperty(c)){var d=t.attributes[c];var f=n[d];var h=f.extensions;if(l(h)){var p=h.WEB3D_quantized_attributes;if(l(p)){var m=p.decodeMatrix;var v="gltf_u_dec_"+c.toLowerCase();switch(f.type){case"SCALAR":u[v]=Wt(m,e).func;s[v]=true;break;case"VEC2":u[v]=jt(m,e).func;s[v]=true;break;case"VEC3":u[v]=Yt(m,e).func;s[v]=true;break;case"VEC4":var _=v+"_scale";var g=v+"_translate";u[_]=Yt(er(m),e).func;u[g]=Ht(tr(m),e).func;s[_]=true;s[g]=true;break}}}}}for(var y in o){if(o.hasOwnProperty(y)){if(!s[y]){var w=o[y];if(l(w.mat)){if(w.mat===2){u[y]=Wt(P.IDENTITY,e).func}else if(w.mat===3){u[y]=jt(D.IDENTITY,e).func}else if(w.mat===4){u[y]=Yt(M.IDENTITY,e).func}}if(l(w.vec)){if(w.vec===4){u[y]=Ht([0,0,0,0],e).func}}}}}return u}function ir(e){return function(){return e}}function nr(e){return function(){return e.computedJointMatrices}}function ar(e){return function(){return e.silhouetteColor}}function or(e){return function(){return e.silhouetteSize}}function sr(e){return function(){return e.color}}function ur(e){return function(){return ie.getColorBlend(e.colorBlendMode,e.colorBlendAmount)}}function lr(t,i,n,a,o){var c=t._nodeCommands;var d=t._pickIds;var f=t.allowPicking;var h=t._runtime.meshesByName;var p=t._rendererResources;var m=p.vertexArrays;var v=p.programs;var _=p.pickPrograms;var g=p.renderStates;var w=t._uniformMaps;var C=t.gltf;var b=C.accessors;var S=C.meshes;var E=C.techniques;var T=C.materials;var x=i.meshes;var A=x.length;for(var P=0;P<A;++P){var D=x[P];var I=S[D];var O=I.primitives;var R=O.length;for(var N=0;N<R;++N){var L=O[N];var B=b[L.indices];var F=T[L.material];var k=E[F.technique];var V=k.program;var z;var U=L.attributes.POSITION;if(l(U)){var H=Re(C,U);z=e.fromCornerPoints(r.fromArray(H.min),r.fromArray(H.max))}var W=m[D+".primitive."+N];var j;var Y;if(l(B)){Y=B.count;j=B.byteOffset/y.getSizeInBytes(B.componentType)}else{var X=b[L.attributes.POSITION];Y=X.count;j=0}var Z=w[L.material];var K=Z.uniformMap;if(l(Z.jointMatrixUniformName)){var Q={};Q[Z.jointMatrixUniformName]=nr(n);K=s(K,Q)}K=s(K,{gltf_color:sr(t),gltf_colorBlend:ur(t)});if(l(t._uniformMapLoaded)){K=t._uniformMapLoaded(K,V,n)}if(et(t,"WEB3D_quantized_attributes")){var J=rr(t,L,a);K=s(K,J)}var $=g[F.technique];var ee=$.blending.enabled;var te={primitive:u(t.pickPrimitive,t),id:t.id,node:n.publicNode,mesh:h[I.name]};var re=me.castShadows(t._shadows);var ie=me.receiveShadows(t._shadows);var ne=new q({boundingVolume:new e,cull:t.cull,modelMatrix:new M,primitiveType:L.mode,vertexArray:W,count:Y,offset:j,shaderProgram:v[k.program],castShadows:re,receiveShadows:ie,uniformMap:K,renderState:$,owner:te,pass:ee?G.TRANSLUCENT:G.OPAQUE});var ae;if(f){var oe;if(l(t._pickFragmentShaderLoaded)){if(l(t._pickUniformMapLoaded)){oe=t._pickUniformMapLoaded(K)}else{oe=s(K)}}else{var se=a.createPickId(te);d.push(se);var ue={czm_pickColor:ir(se.color)};oe=s(K,ue)}ae=new q({boundingVolume:new e,cull:t.cull,modelMatrix:new M,primitiveType:L.mode,vertexArray:W,count:Y,offset:j,shaderProgram:_[k.program],uniformMap:oe,renderState:$,owner:te,pass:ee?G.TRANSLUCENT:G.OPAQUE})}var le;var ce;if(!o){le=q.shallowClone(ne);le.boundingVolume=new e;le.modelMatrix=new M;if(f){ce=q.shallowClone(ae);ce.boundingVolume=new e;ce.modelMatrix=new M}}var de={show:true,boundingSphere:z,command:ne,pickCommand:ae,command2D:le,pickCommand2D:ce,silhouetteModelCommand:undefined,silhouetteModelCommand2D:undefined,silhouetteColorCommand:undefined,silhouetteColorCommand2D:undefined,translucentCommand:undefined,translucentCommand2D:undefined};n.commands.push(de);c.push(de)}}}function cr(e,t,i){var n=e._loadResources;if(!n.finishedEverythingButTextureCreation()){return}if(!n.createRuntimeNodes){return}n.createRuntimeNodes=false;var a=[];var o=e._runtime.nodes;var s=e.gltf;var u=s.nodes;var c=s.scenes[s.scene];var d=c.nodes;var f=d.length;var h=[];for(var p=0;p<f;++p){h.push({parentRuntimeNode:undefined,gltfNode:u[d[p]],id:d[p]});while(h.length>0){var m=h.pop();var v=m.parentRuntimeNode;var _=m.gltfNode;var g=o[m.id];if(g.parents.length===0){if(l(_.matrix)){g.matrix=M.fromColumnMajorArray(_.matrix)}else{var y=_.rotation;g.translation=r.fromArray(_.translation);g.rotation=R.unpack(y);g.scale=r.fromArray(_.scale)}}if(l(v)){v.children.push(g);g.parents.push(v)}else{a.push(g)}if(l(_.meshes)){lr(e,_,g,t,i)}var w=_.children;var C=w.length;for(var b=0;b<C;++b){h.push({parentRuntimeNode:g,gltfNode:u[w[b]],id:w[b]})}}}e._runtime.rootNodes=a;e._runtime.nodes=o}function dr(e){var t=0;for(var r in e){if(e.hasOwnProperty(r)){t+=e[r].sizeInBytes}}return t}function fr(e){var t=0;for(var r in e){if(e.hasOwnProperty(r)){t+=e[r].sizeInBytes}}return t}function hr(e,t){var r=t.context;var i=t.scene3DOnly;if(e._loadRendererResourcesFromCache){var n=e._rendererResources;var a=e._cachedRendererResources;n.buffers=a.buffers;n.vertexArrays=a.vertexArrays;n.programs=a.programs;n.pickPrograms=a.pickPrograms;n.silhouettePrograms=a.silhouettePrograms;n.textures=a.textures;n.samplers=a.samplers;n.renderStates=a.renderStates;if(l(e._precreatedAttributes)){Lt(e,r)}e._cachedVertexMemorySizeInBytes+=dr(a.buffers);e._cachedTextureMemorySizeInBytes+=fr(a.textures)}else{st(e,t);Ct(e,t);Et(e,r);St(e);Pt(e,t)}Ot(e);Nt(e);if(!e._loadRendererResourcesFromCache){Lt(e,r);Ft(e,r)}$t(e,r);cr(e,r,i)}function pr(e,t){var r=e.publicNode;var i=r.matrix;if(r.useMatrix&&l(i)){M.clone(i,t)}else if(l(e.matrix)){M.clone(e.matrix,t)}else{M.fromTranslationQuaternionRotationScale(e.translation,e.rotation,e.scale,t);r.setMatrix(t)}}var mr=[];var vr=new i;var _r=new M;function gr(t,n,a,o){var s=t._maxDirtyNumber;var u=t.allowPicking;var c=t._runtime.rootNodes;var d=c.length;var f=mr;var h=t._computedModelMatrix;if(t._mode!==pe.SCENE3D&&!t._ignoreCommands){var p=M.getColumn(h,3,vr);if(!i.equals(p,i.UNIT_W)){h=k.basisTo2D(o,h,_r);t._rtcCenter=t._rtcCenter3D}else{var m=t.boundingSphere.center;var v=k.wgs84To2DModelMatrix(o,m,_r);h=M.multiply(v,h,_r);if(l(t._rtcCenter)){M.setTranslation(h,i.UNIT_W,h);t._rtcCenter=t._rtcCenter2D}}}for(var _=0;_<d;++_){var g=c[_];pr(g,g.transformToRoot);f.push(g);while(f.length>0){g=f.pop();var y=g.transformToRoot;var w=g.commands;if(g.dirtyNumber===s||n||a){var C=M.multiplyTransformation(h,y,g.computedMatrix);var b=w.length;if(b>0){for(var S=0;S<b;++S){var E=w[S];var T=E.command;M.clone(C,T.modelMatrix);e.transform(E.boundingSphere,T.modelMatrix,T.boundingVolume);if(l(t._rtcCenter)){r.add(t._rtcCenter,T.boundingVolume.center,T.boundingVolume.center)}if(u){var x=E.pickCommand;M.clone(T.modelMatrix,x.modelMatrix);e.clone(T.boundingVolume,x.boundingVolume)}T=E.command2D;if(l(T)&&t._mode===pe.SCENE2D){M.clone(C,T.modelMatrix);T.modelMatrix[13]-=A.sign(T.modelMatrix[13])*2*A.PI*o.ellipsoid.maximumRadius;e.transform(E.boundingSphere,T.modelMatrix,T.boundingVolume);if(u){var P=E.pickCommand2D;M.clone(T.modelMatrix,P.modelMatrix);e.clone(T.boundingVolume,P.boundingVolume)}}}}}var D=g.children;var I=D.length;for(var O=0;O<I;++O){var R=D[O];R.dirtyNumber=Math.max(R.dirtyNumber,g.dirtyNumber);if(R.dirtyNumber===s||a){pr(R,R.transformToRoot);M.multiplyTransformation(y,R.transformToRoot,R.transformToRoot)}f.push(R)}}}++t._maxDirtyNumber}var yr=new M;function wr(e){var t=e._runtime.skinnedNodes;var r=t.length;for(var i=0;i<r;++i){var n=t[i];yr=M.inverseTransformation(n.transformToRoot,yr);var a=n.computedJointMatrices;var o=n.joints;var s=n.bindShapeMatrix;var u=n.inverseBindMatrices;var c=u.length;for(var d=0;d<c;++d){if(!l(a[d])){a[d]=new M}a[d]=M.multiplyTransformation(yr,o[d].transformToRoot,a[d]);a[d]=M.multiplyTransformation(a[d],u[d],a[d]);if(l(s)){a[d]=M.multiplyTransformation(a[d],s,a[d])}}}}function Cr(e){var t=e._runtime.rootNodes;var r=t.length;var i=mr;for(var n=0;n<r;++n){var a=t[n];a.computedShow=a.publicNode.show;i.push(a);while(i.length>0){a=i.pop();var o=a.computedShow;var s=a.commands;var u=s.length;for(var l=0;l<u;++l){s[l].show=o}var c=a.children;var d=c.length;for(var f=0;f<d;++f){var h=c[f];h.computedShow=o&&h.publicNode.show;i.push(h)}}}}function br(e,t){var r=e.id;if(e._id!==r){e._id=r;var i=e._pickIds;var n=i.length;for(var a=0;a<n;++a){i[a].object.id=r}}}function Sr(e){if(e._debugWireframe!==e.debugWireframe){e._debugWireframe=e.debugWireframe;var t=e.debugWireframe?O.LINES:O.TRIANGLES;var r=e._nodeCommands;var i=r.length;for(var n=0;n<i;++n){r[n].command.primitiveType=t}}}function Er(e){if(e.debugShowBoundingVolume!==e._debugShowBoundingVolume){e._debugShowBoundingVolume=e.debugShowBoundingVolume;var t=e.debugShowBoundingVolume;var r=e._nodeCommands;var i=r.length;for(var n=0;n<i;++n){r[n].command.debugShowBoundingVolume=t}}}function Tr(e){if(e.shadows!==e._shadows){e._shadows=e.shadows;var t=me.castShadows(e.shadows);var r=me.receiveShadows(e.shadows);var i=e._nodeCommands;var n=i.length;for(var a=0;a<n;a++){var o=i[a];o.command.castShadows=t;o.command.receiveShadows=r}}}function xr(e){var t=a(e,true);t.cull.enabled=false;t.depthTest.enabled=true;t.depthMask=false;t.blending=re.ALPHA_BLEND;return H.fromCache(t)}function Ar(e){var t=q.shallowClone(e);t.pass=G.TRANSLUCENT;t.renderState=xr(e.renderState);return t}function Pr(e,t){var r=t.scene3DOnly;var i=e.color.alpha;if(i>0&&i<1){var n=e._nodeCommands;var a=n.length;if(!l(n[0].translucentCommand)){for(var o=0;o<a;++o){var s=n[o];var u=s.command;s.translucentCommand=Ar(u);if(!r){var c=s.command2D;s.translucentCommand2D=Ar(c)}}}}}function Dr(e,t){var r=e._rendererResources.programs;for(var i in r){if(r.hasOwnProperty(i)){if(r[i]===t){return i}}}}function Mr(e,t,r){var i=t.vertexShaderSource.sources[0];var n=t._attributeLocations;var a=e._normalAttributeName;i=Y.replaceMain(i,"gltf_silhouette_main");i+="uniform float gltf_silhouetteSize; \n"+"void main() \n"+"{ \n"+"    gltf_silhouette_main(); \n"+"    vec3 n = normalize(czm_normal3D * "+a+"); \n"+"    n.x *= czm_projection[0][0]; \n"+"    n.y *= czm_projection[1][1]; \n"+"    vec4 clip = gl_Position; \n"+"    clip.xy += n.xy * clip.w * gltf_silhouetteSize / czm_viewport.z; \n"+"    gl_Position = clip; \n"+"}";var o="uniform vec4 gltf_silhouetteColor; \n"+"void main() \n"+"{ \n"+"    gl_FragColor = gltf_silhouetteColor; \n"+"}";return j.fromCache({context:r.context,vertexShaderSource:i,fragmentShaderSource:o,attributeLocations:n})}function Ir(e,t){return xe(t.context)&&e.silhouetteSize>0&&e.silhouetteColor.alpha>0&&l(e._normalAttributeName)}function Or(e){var t=e._nodeCommands;var r=t.length;for(var i=0;i<r;++i){var n=t[i];var a=n.command;if(a.pass===G.TRANSLUCENT){return true}}return false}function Rr(e){return e.color.alpha>0&&e.color.alpha<1}function Nr(e){return e.color.alpha===0}function Lr(e,t){return Math.floor(e)!==Math.floor(t)||Math.ceil(e)!==Math.ceil(t)}var Br=0;function Fr(e,t){var r=++Br%255;var i=Or(e)||Rr(e)||e.silhouetteColor.alpha<1;var n=e._rendererResources.silhouettePrograms;var o=t.scene3DOnly;var u=e._nodeCommands;var c=u.length;for(var d=0;d<c;++d){var f=u[d];var h=f.command;var p=Rr(e)?f.translucentCommand:h;var m=q.shallowClone(p);var v=a(p.renderState);v.stencilTest={enabled:true,frontFunction:V.ALWAYS,backFunction:V.ALWAYS,reference:r,mask:~0,frontOperation:{fail:V.KEEP,zFail:V.KEEP,zPass:V.REPLACE},backOperation:{fail:V.KEEP,zFail:V.KEEP,zPass:V.REPLACE}};if(Nr(e)){v.colorMask={red:false,green:false,blue:false,alpha:false};v.depthMask=false}v=H.fromCache(v);m.renderState=v;f.silhouetteModelCommand=m;var _=q.shallowClone(h);v=a(h.renderState,true);v.depthTest.enabled=true;v.cull.enabled=false;if(i){_.pass=G.TRANSLUCENT;v.depthMask=false;v.blending=re.ALPHA_BLEND}v.stencilTest={enabled:true,frontFunction:V.NOTEQUAL,backFunction:V.NOTEQUAL,reference:r,mask:~0,frontOperation:{fail:V.KEEP,zFail:V.KEEP,zPass:V.KEEP},backOperation:{fail:V.KEEP,zFail:V.KEEP,zPass:V.KEEP}};v=H.fromCache(v);var g=h.shaderProgram;var y=Dr(e,g);var w=n[y];if(!l(w)){w=Mr(e,g,t);n[y]=w}var C=s(h.uniformMap,{gltf_silhouetteColor:ar(e),gltf_silhouetteSize:or(e)});_.renderState=v;_.shaderProgram=w;_.uniformMap=C;_.castShadows=false;_.receiveShadows=false;f.silhouetteColorCommand=_;if(!o){var b=f.command2D;var S=q.shallowClone(m);S.boundingVolume=b.boundingVolume;S.modelMatrix=b.modelMatrix;f.silhouetteModelCommand2D=S;var E=q.shallowClone(_);S.boundingVolume=b.boundingVolume;S.modelMatrix=b.modelMatrix;f.silhouetteColorCommand2D=E}}}function kr(e,t){if(!Ir(e,t)){return}var r=e._nodeCommands;var i=Lr(e.color.alpha,e._colorPreviousAlpha)||Lr(e.silhouetteColor.alpha,e._silhouetteColorPreviousAlpha)||!l(r[0].silhouetteModelCommand);e._colorPreviousAlpha=e.color.alpha;e._silhouetteColorPreviousAlpha=e.silhouetteColor.alpha;if(i){Fr(e,t)}}var Vr=new e;function zr(e,t,r){Vr.center=e;Vr.radius=t;return r.camera.getPixelSize(Vr,r.context.drawingBufferWidth,r.context.drawingBufferHeight)}var Ur=new r;var qr=new n;function Gr(e,t){var i=e.scale;if(e.minimumPixelSize!==0){var n=t.context;var a=Math.max(n.drawingBufferWidth,n.drawingBufferHeight);var o=l(e._clampedModelMatrix)?e._clampedModelMatrix:e.modelMatrix;Ur.x=o[12];Ur.y=o[13];Ur.z=o[14];if(l(e._rtcCenter)){r.add(e._rtcCenter,Ur,Ur)}if(e._mode!==pe.SCENE3D){var s=t.mapProjection;var u=s.ellipsoid.cartesianToCartographic(Ur,qr);s.project(u,Ur);r.fromElements(Ur.z,Ur.x,Ur.y,Ur)}var c=e.boundingSphere.radius;var d=zr(Ur,c,t);var f=1/d;var h=Math.min(f*(2*c),a);if(h<e.minimumPixelSize){i=e.minimumPixelSize*d/(2*e._initialRadius)}}return l(e.maximumScale)?Math.min(e.maximumScale,i):i}function Hr(e){if(l(e._cacheKey)&&l(e._cachedGltf)&&--e._cachedGltf.count===0){delete Se[e._cacheKey]}e._cachedGltf=undefined}function Wr(e){var t=e.gltf.extensionsUsed;if(l(t)){var r=t.length;for(var i=0;i<r;++i){var n=t[i]
;if(n!=="CESIUM_RTC"&&n!=="KHR_binary_glTF"&&n!=="KHR_materials_common"&&n!=="WEB3D_quantized_attributes"){throw new F("Unsupported glTF Extension: "+n)}}}}function jr(e,t){this.buffers=undefined;this.vertexArrays=undefined;this.programs=undefined;this.pickPrograms=undefined;this.silhouettePrograms=undefined;this.textures=undefined;this.samplers=undefined;this.renderStates=undefined;this.ready=false;this.context=e;this.cacheKey=t;this.count=0}function Yr(e){for(var t in e){if(e.hasOwnProperty(t)){e[t].destroy()}}}function Xr(e){Yr(e.buffers);Yr(e.vertexArrays);Yr(e.programs);Yr(e.pickPrograms);Yr(e.silhouettePrograms);Yr(e.textures)}jr.prototype.release=function(){if(--this.count===0){if(l(this.cacheKey)){delete this.context.cache.modelRendererResourceCache[this.cacheKey]}Xr(this);return d(this)}return undefined};function Zr(e,t,r){return function(i){if(e.heightReference===oe.RELATIVE_TO_GROUND){var n=t.cartesianToCartographic(i,qr);n.height+=r.height;t.cartographicToCartesian(n,i)}var a=e._clampedModelMatrix;M.clone(e.modelMatrix,a);a[12]=i.x;a[13]=i.y;a[14]=i.z;e._heightChanged=true}}function Kr(e){if(l(e._removeUpdateHeightCallback)){e._removeUpdateHeightCallback();e._removeUpdateHeightCallback=undefined}var t=e._scene;if(!l(t)||e.heightReference===oe.NONE){if(e.heightReference!==oe.NONE){throw new f("Height reference is not supported without a scene.")}e._clampedModelMatrix=undefined;return}var r=t.globe;var i=r.ellipsoid;var a=e.modelMatrix;Ur.x=a[12];Ur.y=a[13];Ur.z=a[14];var o=i.cartesianToCartographic(Ur);if(!l(e._clampedModelMatrix)){e._clampedModelMatrix=M.clone(a,new M)}var s=r._surface;e._removeUpdateHeightCallback=s.updateHeight(o,Zr(e,i,o));var u=r.getHeight(o);if(l(u)){var c=Zr(e,i,o);n.clone(o,qr);qr.height=u;i.cartographicToCartesian(qr,Ur);c(Ur)}}var Qr=new r;var Jr=new n;function $r(e,t){var i;var n=e.distanceDisplayCondition;var a=n.near*n.near;var o=n.far*n.far;if(t.mode===pe.SCENE2D){var s=t.camera.frustum.right-t.camera.frustum.left;i=s*.5;i=i*i}else{var u=M.getTranslation(e.modelMatrix,Qr);if(t.mode===pe.COLUMBUS_VIEW){var l=t.mapProjection;var c=l.ellipsoid;var d=c.cartesianToCartographic(u,Jr);u=l.project(d,u);r.fromElements(u.z,u.x,u.y,u)}i=r.distanceSquared(u,t.camera.positionWC)}return i>=a&&i<=o}Ee.prototype.update=function(e){if(e.mode===pe.MORPHING){return}var t=e.context;this._defaultTexture=t.defaultTexture;if(this._state===_e.NEEDS_LOAD&&l(this.gltf)){var i;var n=this.cacheKey;if(l(n)){t.cache.modelRendererResourceCache=u(t.cache.modelRendererResourceCache,{});var a=t.cache.modelRendererResourceCache;i=a[this.cacheKey];if(l(i)){if(!i.ready){return}++i.count;this._loadRendererResourcesFromCache=true}else{i=new jr(t,n);i.count=1;a[this.cacheKey]=i}this._cachedRendererResources=i}else{i=new jr(t);i.count=1;this._cachedRendererResources=i}this._state=_e.LOADING;this._boundingSphere=Ne(this,this.gltf);this._initialRadius=this._boundingSphere.radius;Wr(this);if(this._state!==_e.FAILED){var o=this.gltf.extensions;if(l(o)&&l(o.CESIUM_RTC)){var s=r.fromArray(o.CESIUM_RTC.center);if(!r.equals(s,r.ZERO)){this._rtcCenter3D=s;var c=e.mapProjection;var d=c.ellipsoid;var f=d.cartesianToCartographic(this._rtcCenter3D);var h=c.project(f);r.fromElements(h.z,h.x,h.y,h);this._rtcCenter2D=h;this._rtcCenterEye=new r;this._rtcCenter=this._rtcCenter3D}}this._loadResources=new ye;$e(this,t)}}var p=this._loadResources;var m=this._incrementallyLoadTextures;var v=false;if(this._state===_e.LOADING){hr(this,e);if(p.finished()||m&&p.finishedEverythingButTextureCreation()){this._state=_e.LOADED;v=true}}if(l(p)&&this._state===_e.LOADED){if(m&&!v){hr(this,e)}if(p.finished()){this._loadResources=undefined;var _=this._rendererResources;var g=this._cachedRendererResources;g.buffers=_.buffers;g.vertexArrays=_.vertexArrays;g.programs=_.programs;g.pickPrograms=_.pickPrograms;g.silhouettePrograms=_.silhouettePrograms;g.textures=_.textures;g.samplers=_.samplers;g.renderStates=_.renderStates;g.ready=true;this._normalAttributeName=ne(this.gltf,"NORMAL");if(l(this._precreatedAttributes)){g.vertexArrays={}}if(this.releaseGltfJson){Hr(this)}}}var y=Ir(this,e);var w=Rr(this);var C=Nr(this);var b=l(this.distanceDisplayCondition)?$r(this,e):true;var S=this.show&&b&&this.scale!==0&&(!C||y);if(S&&this._state===_e.LOADED||v){var E=this.activeAnimations.update(e)||this._cesiumAnimationsDirty;this._cesiumAnimationsDirty=false;this._dirty=false;var T=this.modelMatrix;var x=e.mode!==this._mode;this._mode=e.mode;var P=!M.equals(this._modelMatrix,T)||this._scale!==this.scale||this._minimumPixelSize!==this.minimumPixelSize||this.minimumPixelSize!==0||this._maximumScale!==this.maximumScale||this._heightReference!==this.heightReference||this._heightChanged||x;if(P||v){M.clone(T,this._modelMatrix);Kr(this);if(l(this._clampedModelMatrix)){T=this._clampedModelMatrix}this._scale=this.scale;this._minimumPixelSize=this.minimumPixelSize;this._maximumScale=this.maximumScale;this._heightReference=this.heightReference;this._heightChanged=false;var D=Gr(this,e);var I=this._computedModelMatrix;M.multiplyByUniformScale(T,D,I);if(this._upAxis===te.Y){M.multiplyTransformation(I,te.Y_UP_TO_Z_UP,I)}else if(this._upAxis===te.X){M.multiplyTransformation(I,te.X_UP_TO_Z_UP,I)}}if(E||P||v){gr(this,P,v,e.mapProjection);this._dirty=true;if(E||v){wr(this)}}if(this._perNodeShowDirty){this._perNodeShowDirty=false;Cr(this)}br(this,t);Sr(this);Er(this);Tr(this);Pr(this,e);kr(this,e)}if(v){var O=this;e.afterRender.push(function(){O._ready=true;O._readyPromise.resolve(O)});return}if(S&&!this._ignoreCommands){var R=e.passes;var N=this._nodeCommands;var L=N.length;var B;var F;var k=e.mapProjection.ellipsoid.maximumRadius*A.PI;var V;if(R.render){for(B=0;B<L;++B){F=N[B];if(F.show){var z=w?F.translucentCommand:F.command;z=y?F.silhouetteModelCommand:z;e.addCommand(z);V=F.command.boundingVolume;if(e.mode===pe.SCENE2D&&(V.center.y+V.radius>k||V.center.y-V.radius<k)){var U=w?F.translucentCommand2D:F.command2D;U=y?F.silhouetteModelCommand2D:U;e.addCommand(U)}}}if(y){for(B=0;B<L;++B){F=N[B];if(F.show){e.addCommand(F.silhouetteColorCommand);V=F.command.boundingVolume;if(e.mode===pe.SCENE2D&&(V.center.y+V.radius>k||V.center.y-V.radius<k)){e.addCommand(F.silhouetteColorCommand2D)}}}}}if(R.pick&&this.allowPicking){for(B=0;B<L;++B){F=N[B];if(F.show){var q=F.pickCommand;e.addCommand(q);V=q.boundingVolume;if(e.mode===pe.SCENE2D&&(V.center.y+V.radius>k||V.center.y-V.radius<k)){e.addCommand(F.pickCommand2D)}}}}}};Ee.prototype.isDestroyed=function(){return false};Ee.prototype.destroy=function(){if(l(this._precreatedAttributes)){Yr(this._rendererResources.vertexArrays)}this._rendererResources=undefined;this._cachedRendererResources=this._cachedRendererResources&&this._cachedRendererResources.release();var e=this._pickIds;var t=e.length;for(var r=0;r<t;++r){e[r].destroy()}Hr(this);return d(this)};return Ee});define("DataSources/ModelVisualizer",["../Core/AssociativeArray","../Core/BoundingSphere","../Core/Color","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Core/Matrix4","../Scene/ColorBlendMode","../Scene/HeightReference","../Scene/Model","../Scene/ModelAnimationLoop","../Scene/ShadowMode","./BoundingSphereState","./Property"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h){"use strict";var p=1;var m=0;var v=true;var _=d.ENABLED;var g=u.NONE;var y=r.RED;var w=0;var C=r.WHITE;var b=s.HIGHLIGHT;var S=.5;var E=new o;var T=new o;function x(t,r){if(!i(t)){throw new a("scene is required.")}if(!i(r)){throw new a("entityCollection is required.")}r.collectionChanged.addEventListener(x.prototype._onCollectionChanged,this);this._scene=t;this._primitives=t.primitives;this._entityCollection=r;this._modelHash={};this._entitiesToVisualize=new e;this._onCollectionChanged(r,r.values,[],[])}x.prototype.update=function(e){if(!i(e)){throw new a("time is required.")}var t=this._entitiesToVisualize.values;var r=this._modelHash;var n=this._primitives;for(var s=0,u=t.length;s<u;s++){var d=t[s];var f=d._model;var x;var A=r[d.id];var P=d.isShowing&&d.isAvailable(e)&&h.getValueOrDefault(f._show,e,true);var M;if(P){M=d._getModelMatrix(e,E);x=h.getValueOrUndefined(f._uri,e);P=i(M)&&i(x)}if(!P){if(i(A)){A.modelPrimitive.show=false}continue}var I=i(A)?A.modelPrimitive:undefined;if(!i(I)||x!==A.uri){if(i(I)){n.removeAndDestroy(I);delete r[d.id]}I=l.fromGltf({url:x,incrementallyLoadTextures:h.getValueOrDefault(f._incrementallyLoadTextures,e,v),scene:this._scene});I.readyPromise.otherwise(D);I.id=d;n.add(I);A={modelPrimitive:I,uri:x,animationsRunning:false,nodeTransformationsScratch:{},originalNodeMatrixHash:{}};r[d.id]=A}I.show=true;I.scale=h.getValueOrDefault(f._scale,e,p);I.minimumPixelSize=h.getValueOrDefault(f._minimumPixelSize,e,m);I.maximumScale=h.getValueOrUndefined(f._maximumScale,e);I.modelMatrix=o.clone(M,I.modelMatrix);I.shadows=h.getValueOrDefault(f._shadows,e,_);I.heightReference=h.getValueOrDefault(f._heightReference,e,g);I.distanceDisplayCondition=h.getValueOrUndefined(f._distanceDisplayCondition,e);I.silhouetteColor=h.getValueOrDefault(f._silhouetteColor,e,y,I._silhouetteColor);I.silhouetteSize=h.getValueOrDefault(f._silhouetteSize,e,w);I.color=h.getValueOrDefault(f._color,e,C,I._color);I.colorBlendMode=h.getValueOrDefault(f._colorBlendMode,e,b);I.colorBlendAmount=h.getValueOrDefault(f._colorBlendAmount,e,S);if(I.ready){var O=h.getValueOrDefault(f._runAnimations,e,true);if(A.animationsRunning!==O){if(O){I.activeAnimations.addAll({loop:c.REPEAT})}else{I.activeAnimations.removeAll()}A.animationsRunning=O}var R=h.getValueOrUndefined(f._nodeTransformations,e,A.nodeTransformationsScratch);if(i(R)){var N=A.originalNodeMatrixHash;var L=Object.keys(R);for(var B=0,F=L.length;B<F;++B){var k=L[B];var V=R[k];if(!i(V)){continue}var z=I.getNode(k);if(!i(z)){continue}var U=N[k];if(!i(U)){U=z.matrix.clone();N[k]=U}var q=o.fromTranslationRotationScale(V,T);z.matrix=o.multiply(U,q,q)}}}}return true};x.prototype.isDestroyed=function(){return false};x.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(x.prototype._onCollectionChanged,this);var e=this._entitiesToVisualize.values;var t=this._modelHash;var r=this._primitives;for(var i=e.length-1;i>-1;i--){A(this,e[i],t,r)}return n(this)};x.prototype.getBoundingSphere=function(e,r){if(!i(e)){throw new a("entity is required.")}if(!i(r)){throw new a("result is required.")}var n=this._modelHash[e.id];if(!i(n)){return f.FAILED}var o=n.modelPrimitive;if(!i(o)||!o.show){return f.FAILED}if(!o.ready){return f.PENDING}if(o.heightReference===u.NONE){t.transform(o.boundingSphere,o.modelMatrix,r)}else{if(!i(o._clampedModelMatrix)){return f.PENDING}t.transform(o.boundingSphere,o._clampedModelMatrix,r)}return f.DONE};x.prototype._onCollectionChanged=function(e,t,r,n){var a;var o;var s=this._entitiesToVisualize;var u=this._modelHash;var l=this._primitives;for(a=t.length-1;a>-1;a--){o=t[a];if(i(o._model)&&i(o._position)){s.set(o.id,o)}}for(a=n.length-1;a>-1;a--){o=n[a];if(i(o._model)&&i(o._position)){P(o,u);s.set(o.id,o)}else{A(this,o,u,l);s.remove(o.id)}}for(a=r.length-1;a>-1;a--){o=r[a];A(this,o,u,l);s.remove(o.id)}};function A(e,t,r,n){var a=r[t.id];if(i(a)){n.removeAndDestroy(a.modelPrimitive);delete r[t.id]}}function P(e,t){var r=t[e.id];if(i(r)){r.nodeTransformationsScratch={}}}function D(e){console.error(e)}return x});define("Shaders/PolylineCommon",[],function(){"use strict";return"void clipLineSegmentToNearPlane(\nvec3 p0,\nvec3 p1,\nout vec4 positionWC,\nout bool clipped,\nout bool culledByNearPlane)\n{\nculledByNearPlane = false;\nclipped = false;\nvec3 p1ToP0 = p1 - p0;\nfloat magnitude = length(p1ToP0);\nvec3 direction = normalize(p1ToP0);\nfloat endPoint0Distance =  -(czm_currentFrustum.x + p0.z);\nfloat denominator = -direction.z;\nif (endPoint0Distance < 0.0 && abs(denominator) < czm_epsilon7)\n{\nculledByNearPlane = true;\n}\nelse if (endPoint0Distance < 0.0 && abs(denominator) > czm_epsilon7)\n{\nfloat t = (czm_currentFrustum.x + p0.z) / denominator;\nif (t < 0.0 || t > magnitude)\n{\nculledByNearPlane = true;\n}\nelse\n{\np0 = p0 + t * direction;\nclipped = true;\n}\n}\npositionWC = czm_eyeToWindowCoordinates(vec4(p0, 1.0));\n}\nvec4 getPolylineWindowCoordinates(vec4 position, vec4 previous, vec4 next, float expandDirection, float width, bool usePrevious) {\nvec4 endPointWC, p0, p1;\nbool culledByNearPlane, clipped;\nvec4 positionEC = czm_modelViewRelativeToEye * position;\nvec4 prevEC = czm_modelViewRelativeToEye * previous;\nvec4 nextEC = czm_modelViewRelativeToEye * next;\nclipLineSegmentToNearPlane(prevEC.xyz, positionEC.xyz, p0, clipped, culledByNearPlane);\nclipLineSegmentToNearPlane(nextEC.xyz, positionEC.xyz, p1, clipped, culledByNearPlane);\nclipLineSegmentToNearPlane(positionEC.xyz, usePrevious ? prevEC.xyz : nextEC.xyz, endPointWC, clipped, culledByNearPlane);\nif (culledByNearPlane)\n{\nreturn vec4(0.0, 0.0, 0.0, 1.0);\n}\nvec2 prevWC = normalize(p0.xy - endPointWC.xy);\nvec2 nextWC = normalize(p1.xy - endPointWC.xy);\nfloat expandWidth = width * 0.5;\nvec2 direction;\nif (czm_equalsEpsilon(previous.xyz - position.xyz, vec3(0.0), czm_epsilon1) || czm_equalsEpsilon(prevWC, -nextWC, czm_epsilon1))\n{\ndirection = vec2(-nextWC.y, nextWC.x);\n}\nelse if (czm_equalsEpsilon(next.xyz - position.xyz, vec3(0.0), czm_epsilon1) || clipped)\n{\ndirection = vec2(prevWC.y, -prevWC.x);\n}\nelse\n{\nvec2 normal = vec2(-nextWC.y, nextWC.x);\ndirection = normalize((nextWC + prevWC) * 0.5);\nif (dot(direction, normal) < 0.0)\n{\ndirection = -direction;\n}\nfloat sinAngle = abs(direction.x * nextWC.y - direction.y * nextWC.x);\nexpandWidth = clamp(expandWidth / sinAngle, 0.0, width * 2.0);\n}\nvec2 offset = direction * expandDirection * expandWidth * czm_resolutionScale;\nreturn vec4(endPointWC.xy + offset, -endPointWC.z, 1.0);\n}\n"});define("Shaders/PolylineFS",[],function(){"use strict";return"varying vec2 v_st;\nvoid main()\n{\nczm_materialInput materialInput;\nmaterialInput.s = v_st.s;\nmaterialInput.st = v_st;\nmaterialInput.str = vec3(v_st, 0.0);\nczm_material material = czm_getMaterial(materialInput);\ngl_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n}\n"});define("Shaders/PolylineVS",[],function(){"use strict";return"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec3 position2DHigh;\nattribute vec3 position2DLow;\nattribute vec3 prevPosition3DHigh;\nattribute vec3 prevPosition3DLow;\nattribute vec3 prevPosition2DHigh;\nattribute vec3 prevPosition2DLow;\nattribute vec3 nextPosition3DHigh;\nattribute vec3 nextPosition3DLow;\nattribute vec3 nextPosition2DHigh;\nattribute vec3 nextPosition2DLow;\nattribute vec4 texCoordExpandAndBatchIndex;\nvarying vec2  v_st;\nvarying float v_width;\nvarying vec4  czm_pickColor;\nvoid main()\n{\nfloat texCoord = texCoordExpandAndBatchIndex.x;\nfloat expandDir = texCoordExpandAndBatchIndex.y;\nbool usePrev = texCoordExpandAndBatchIndex.z < 0.0;\nfloat batchTableIndex = texCoordExpandAndBatchIndex.w;\nvec2 widthAndShow = batchTable_getWidthAndShow(batchTableIndex);\nfloat width = widthAndShow.x + 0.5;\nfloat show = widthAndShow.y;\nif (width < 1.0)\n{\nshow = 0.0;\n}\nvec4 pickColor = batchTable_getPickColor(batchTableIndex);\nvec4 p, prev, next;\nif (czm_morphTime == 1.0)\n{\np = czm_translateRelativeToEye(position3DHigh.xyz, position3DLow.xyz);\nprev = czm_translateRelativeToEye(prevPosition3DHigh.xyz, prevPosition3DLow.xyz);\nnext = czm_translateRelativeToEye(nextPosition3DHigh.xyz, nextPosition3DLow.xyz);\n}\nelse if (czm_morphTime == 0.0)\n{\np = czm_translateRelativeToEye(position2DHigh.zxy, position2DLow.zxy);\nprev = czm_translateRelativeToEye(prevPosition2DHigh.zxy, prevPosition2DLow.zxy);\nnext = czm_translateRelativeToEye(nextPosition2DHigh.zxy, nextPosition2DLow.zxy);\n}\nelse\n{\np = czm_columbusViewMorph(\nczm_translateRelativeToEye(position2DHigh.zxy, position2DLow.zxy),\nczm_translateRelativeToEye(position3DHigh.xyz, position3DLow.xyz),\nczm_morphTime);\nprev = czm_columbusViewMorph(\nczm_translateRelativeToEye(prevPosition2DHigh.zxy, prevPosition2DLow.zxy),\nczm_translateRelativeToEye(prevPosition3DHigh.xyz, prevPosition3DLow.xyz),\nczm_morphTime);\nnext = czm_columbusViewMorph(\nczm_translateRelativeToEye(nextPosition2DHigh.zxy, nextPosition2DLow.zxy),\nczm_translateRelativeToEye(nextPosition3DHigh.xyz, nextPosition3DLow.xyz),\nczm_morphTime);\n}\n#ifdef DISTANCE_DISPLAY_CONDITION\nvec3 centerHigh = batchTable_getCenterHigh(batchTableIndex);\nvec4 centerLowAndRadius = batchTable_getCenterLowAndRadius(batchTableIndex);\nvec3 centerLow = centerLowAndRadius.xyz;\nfloat radius = centerLowAndRadius.w;\nvec2 distanceDisplayCondition = batchTable_getDistanceDisplayCondition(batchTableIndex);\nfloat lengthSq;\nif (czm_sceneMode == czm_sceneMode2D)\n{\nlengthSq = czm_eyeHeight2D.y;\n}\nelse\n{\nvec4 center = czm_translateRelativeToEye(centerHigh.xyz, centerLow.xyz);\nlengthSq = max(0.0, dot(center.xyz, center.xyz) - radius * radius);\n}\nfloat nearSq = distanceDisplayCondition.x * distanceDisplayCondition.x;\nfloat farSq = distanceDisplayCondition.y * distanceDisplayCondition.y;\nif (lengthSq < nearSq || lengthSq > farSq)\n{\nshow = 0.0;\n}\n#endif\nvec4 positionWC = getPolylineWindowCoordinates(p, prev, next, expandDir, width, usePrev);\ngl_Position = czm_viewportOrthographic * positionWC * show;\nv_st = vec2(texCoord, clamp(expandDir, 0.0, 1.0));\nv_width = width;\nczm_pickColor = pickColor;\n}\n"});define("Scene/Polyline",["../Core/arrayRemoveDuplicates","../Core/BoundingSphere","../Core/Cartesian3","../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/Matrix4","../Core/PolylinePipeline","./Material"],function(e,t,r,i,n,a,o,s,u,l,c,d){"use strict";function f(o,s){o=n(o,n.EMPTY_OBJECT);this._show=n(o.show,true);this._width=n(o.width,1);this._loop=n(o.loop,false);this._distanceDisplayCondition=o.distanceDisplayCondition;this._material=o.material;if(!a(this._material)){this._material=d.fromType(d.ColorType,{color:new i(1,1,1,1)})}var u=o.positions;if(!a(u)){u=[]}this._positions=u;this._actualPositions=e(u,r.equalsEpsilon);if(this._loop&&this._actualPositions.length>2){if(this._actualPositions===this._positions){this._actualPositions=u.slice()}this._actualPositions.push(r.clone(this._actualPositions[0]))}this._length=this._actualPositions.length;this._id=o.id;var f;if(a(s)){f=l.clone(s.modelMatrix)}this._modelMatrix=f;this._segments=c.wrapLongitude(this._actualPositions,f);this._actualLength=undefined;this._propertiesChanged=new Uint32Array(y);this._polylineCollection=s;this._dirty=false;this._pickId=undefined;this._boundingVolume=t.fromPoints(this._actualPositions);this._boundingVolumeWC=t.transform(this._boundingVolume,this._modelMatrix);this._boundingVolume2D=new t}var h=f.POSITION_INDEX=0;var p=f.SHOW_INDEX=1;var m=f.WIDTH_INDEX=2;var v=f.MATERIAL_INDEX=3;var _=f.POSITION_SIZE_INDEX=4;var g=f.DISTANCE_DISPLAY_CONDITION=5;var y=f.NUMBER_OF_PROPERTIES=6;function w(e,t){++e._propertiesChanged[t];var r=e._polylineCollection;if(a(r)){r._updatePolyline(e,t);e._dirty=true}}o(f.prototype,{show:{get:function(){return this._show},set:function(e){if(!a(e)){throw new s("value is required.")}if(e!==this._show){this._show=e;w(this,p)}}},positions:{get:function(){return this._positions},set:function(i){if(!a(i)){throw new s("value is required.")}var n=e(i,r.equalsEpsilon);if(this._loop&&n.length>2){if(n===i){n=i.slice()}n.push(r.clone(n[0]))}if(this._actualPositions.length!==n.length||this._actualPositions.length!==this._length){w(this,_)}this._positions=i;this._actualPositions=n;this._length=n.length;this._boundingVolume=t.fromPoints(this._actualPositions,this._boundingVolume);this._boundingVolumeWC=t.transform(this._boundingVolume,this._modelMatrix,this._boundingVolumeWC);w(this,h);this.update()}},material:{get:function(){return this._material},set:function(e){if(!a(e)){throw new s("material is required.")}if(this._material!==e){this._material=e;w(this,v)}}},width:{get:function(){return this._width},set:function(e){if(!a(e)){throw new s("value is required.")}var t=this._width;if(e!==t){this._width=e;w(this,m)}}},loop:{get:function(){return this._loop},set:function(e){if(!a(e)){throw new s("value is required.")}if(e!==this._loop){var t=this._actualPositions;if(e){if(t.length>2&&!r.equals(t[0],t[t.length-1])){if(t.length===this._positions.length){this._actualPositions=t=this._positions.slice()}t.push(r.clone(t[0]))}}else{if(t.length>2&&r.equals(t[0],t[t.length-1])){if(t.length-1===this._positions.length){this._actualPositions=this._positions}else{t.pop()}}}this._loop=e;w(this,_)}}},id:{get:function(){return this._id},set:function(e){this._id=e;if(a(this._pickId)){this._pickId.object.id=e}}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){if(a(e)&&e.far<=e.near){throw new s("far distance must be greater than near distance.")}if(!u.equals(e,this._distanceDisplayCondition)){this._distanceDisplayCondition=u.clone(e,this._distanceDisplayCondition);w(this,g)}}}});f.prototype.update=function(){var e=l.IDENTITY;if(a(this._polylineCollection)){e=this._polylineCollection.modelMatrix}var r=this._segments.positions.length;var i=this._segments.lengths;var n=this._propertiesChanged[h]>0||this._propertiesChanged[_]>0;if(!l.equals(e,this._modelMatrix)||n){this._segments=c.wrapLongitude(this._actualPositions,e);this._boundingVolumeWC=t.transform(this._boundingVolume,e,this._boundingVolumeWC)}this._modelMatrix=e;if(this._segments.positions.length!==r){w(this,_)}else{var o=i.length;for(var s=0;s<o;++s){if(i[s]!==this._segments.lengths[s]){w(this,_);break}}}};f.prototype.getPickId=function(e){if(!a(this._pickId)){this._pickId=e.createPickId({primitive:this,collection:this._polylineCollection,id:this._id})}return this._pickId};f.prototype._clean=function(){this._dirty=false;var e=this._propertiesChanged;for(var t=0;t<y-1;++t){e[t]=0}};f.prototype._destroy=function(){this._pickId=this._pickId&&this._pickId.destroy();this._material=this._material&&this._material.destroy();this._polylineCollection=undefined};return f});define("Scene/PolylineCollection",["../Core/BoundingSphere","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Cartographic","../Core/Color","../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/EncodedCartesian3","../Core/IndexDatatype","../Core/Intersect","../Core/Math","../Core/Matrix4","../Core/Plane","../Core/RuntimeError","../Renderer/Buffer","../Renderer/BufferUsage","../Renderer/ContextLimits","../Renderer/DrawCommand","../Renderer/Pass","../Renderer/RenderState","../Renderer/ShaderProgram","../Renderer/ShaderSource","../Renderer/VertexArray","../Shaders/PolylineCommon","../Shaders/PolylineFS","../Shaders/PolylineVS","./BatchTable","./BlendingState","./Material","./Polyline","./SceneMode"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w,C,b,S,E,T,x,A,P,D,M,I,O,R,N,L){"use strict";var B=N.SHOW_INDEX;var F=N.WIDTH_INDEX;var k=N.POSITION_INDEX;var V=N.MATERIAL_INDEX;var z=N.POSITION_SIZE_INDEX;var U=N.DISTANCE_DISPLAY_CONDITION;var q=N.NUMBER_OF_PROPERTIES;var G={texCoordExpandAndBatchIndex:0,position3DHigh:1,position3DLow:2,position2DHigh:3,position2DLow:4,prevPosition3DHigh:5,prevPosition3DLow:6,prevPosition2DHigh:7,prevPosition2DLow:8,nextPosition3DHigh:9,nextPosition3DLow:10,nextPosition2DHigh:11,nextPosition2DLow:12};function H(e){e=s(e,s.EMPTY_OBJECT);this.modelMatrix=v.clone(s(e.modelMatrix,v.IDENTITY));this._modelMatrix=v.clone(v.IDENTITY);this.debugShowBoundingVolume=s(e.debugShowBoundingVolume,false);this._opaqueRS=undefined;this._translucentRS=undefined;this._colorCommands=[];this._pickCommands=[];this._polylinesUpdated=false;this._polylinesRemoved=false;this._createVertexArray=false;this._propertiesChanged=new Uint32Array(q);this._polylines=[];this._polylineBuckets={};this._positionBufferUsage={bufferUsage:w.STATIC_DRAW,frameCount:0};this._mode=undefined;this._polylinesToUpdate=[];this._vertexArrays=[];this._positionBuffer=undefined;this._texCoordExpandAndBatchIndexBuffer=undefined;this._batchTable=undefined;this._createBatchTable=false}l(H.prototype,{length:{get:function(){ae(this);return this._polylines.length}}});H.prototype.add=function(e){var t=new N(e,this);t._index=this._polylines.length;this._polylines.push(t);this._createVertexArray=true;this._createBatchTable=true;return t};H.prototype.remove=function(e){if(this.contains(e)){this._polylines[e._index]=undefined;this._polylinesRemoved=true;this._createVertexArray=true;this._createBatchTable=true;if(u(e._bucket)){var t=e._bucket;t.shaderProgram=t.shaderProgram&&t.shaderProgram.destroy();t.pickShaderProgram=t.pickShaderProgram&&t.pickShaderProgram.destroy()}e._destroy();return true}return false};H.prototype.removeAll=function(){oe(this);ue(this);this._polylineBuckets={};this._polylinesRemoved=false;this._polylines.length=0;this._polylinesToUpdate.length=0;this._createVertexArray=true};H.prototype.contains=function(e){return u(e)&&e._polylineCollection===this};H.prototype.get=function(e){if(!u(e)){throw new d("index is required.")}ae(this);return this._polylines[e]};function W(e,t){if(u(e._batchTable)){e._batchTable.destroy()}var r=[{functionName:"batchTable_getWidthAndShow",componentDatatype:o.UNSIGNED_BYTE,componentsPerAttribute:2},{functionName:"batchTable_getPickColor",componentDatatype:o.UNSIGNED_BYTE,componentsPerAttribute:4,normalize:true},{functionName:"batchTable_getCenterHigh",componentDatatype:o.FLOAT,componentsPerAttribute:3},{functionName:"batchTable_getCenterLowAndRadius",componentDatatype:o.FLOAT,componentsPerAttribute:4},{functionName:"batchTable_getDistanceDisplayCondition",componentDatatype:o.FLOAT,componentsPerAttribute:2}];e._batchTable=new I(t,r,e._polylines.length)}var j=new f;var Y=new i;var X=new t;H.prototype.update=function(e){ae(this);if(this._polylines.length===0){return}ne(this,e);var r=e.context;var n=e.mapProjection;var a;var o=this._propertiesChanged;if(this._createBatchTable){W(this,r);this._createBatchTable=false}if(this._createVertexArray||J(this)){ee(this,r,n)}else if(this._polylinesUpdated){var s=this._polylinesToUpdate;if(this._mode!==L.SCENE3D){var l=s.length;for(var c=0;c<l;++c){a=s[c];a.update()}}if(o[z]||o[V]){ee(this,r,n)}else{var d=s.length;var h=this._polylineBuckets;for(var p=0;p<d;++p){a=s[p];o=a._propertiesChanged;var m=a._bucket;var _=0;for(var g in h){if(h.hasOwnProperty(g)){if(h[g]===m){if(o[k]){m.writeUpdate(_,a,this._positionBuffer,n)}break}_+=h[g].lengthOfPositions}}if(o[B]||o[F]){this._batchTable.setBatchedAttribute(a._index,0,new t(a._width,a._show))}if(this._batchTable.attributes.length>2){if(o[k]||o[z]){var y=e.mode===L.SCENE2D?a._boundingVolume2D:a._boundingVolumeWC;var w=f.fromCartesian(y.center,j);var C=i.fromElements(w.low.x,w.low.y,w.low.z,y.radius,Y);this._batchTable.setBatchedAttribute(a._index,2,w.high);this._batchTable.setBatchedAttribute(a._index,3,C)}if(o[U]){var b=X;b.x=0;b.y=Number.MAX_VALUE;var S=a.distanceDisplayCondition;if(u(S)){b.x=S.near;b.x=S.far}this._batchTable.setBatchedAttribute(a._index,4,b)}}a._clean()}}s.length=0;this._polylinesUpdated=false}o=this._propertiesChanged;for(var T=0;T<q;++T){o[T]=0}var x=v.IDENTITY;if(e.mode===L.SCENE3D){x=this.modelMatrix}var A=e.passes;var P=e.morphTime!==0;if(!u(this._opaqueRS)||this._opaqueRS.depthTest.enabled!==P){this._opaqueRS=E.fromCache({depthMask:P,depthTest:{enabled:P}})}if(!u(this._translucentRS)||this._translucentRS.depthTest.enabled!==P){this._translucentRS=E.fromCache({blending:O.ALPHA_BLEND,depthMask:!P,depthTest:{enabled:P}})}this._batchTable.update(e);if(A.render){var D=this._colorCommands;Q(this,e,D,x,true)}if(A.pick){var M=this._pickCommands;Q(this,e,M,x,false)}};var Z=new e;var K=new e;function Q(t,r,i,n,a){var o=r.context;var s=r.commandList;var l=i.length;var c=0;var d=true;var f=t._vertexArrays;var h=t.debugShowBoundingVolume;var p=t._batchTable;var m=p.getUniformMapCallback();var v=f.length;for(var _=0;_<v;++_){var g=f[_];var y=g.buckets;var w=y.length;for(var C=0;C<w;++C){var E=y[C];var T=E.offset;var x=a?E.bucket.shaderProgram:E.bucket.pickShaderProgram;var A=E.bucket.polylines;var P=A.length;var D;var M;var I=0;var O;for(var R=0;R<P;++R){var N=A[R];var B=re(N._material);if(B!==D){if(u(D)&&I>0){var F=M.isTranslucent();if(c>=l){O=new b({owner:t});i.push(O)}else{O=i[c]}++c;O.boundingVolume=e.clone(Z,O.boundingVolume);O.modelMatrix=n;O.shaderProgram=x;O.vertexArray=g.va;O.renderState=F?t._translucentRS:t._opaqueRS;O.pass=F?S.TRANSLUCENT:S.OPAQUE;O.debugShowBoundingVolume=a?h:false;O.uniformMap=m(M._uniforms);O.count=I;O.offset=T;T+=I;I=0;d=true;s.push(O)}M=N._material;M.update(o);D=B}var k=N._locatorBuckets;var V=k.length;for(var z=0;z<V;++z){var U=k[z];if(U.locator===E){I+=U.count}}var q;if(r.mode===L.SCENE3D){q=N._boundingVolumeWC}else if(r.mode===L.COLUMBUS_VIEW){q=N._boundingVolume2D}else if(r.mode===L.SCENE2D){if(u(N._boundingVolume2D)){q=e.clone(N._boundingVolume2D,K);q.center.x=0}}else if(u(N._boundingVolumeWC)&&u(N._boundingVolume2D)){q=e.union(N._boundingVolumeWC,N._boundingVolume2D,K)}if(d){d=false;e.clone(q,Z)}else{e.union(q,Z,Z)}}if(u(D)&&I>0){if(c>=l){O=new b({owner:t});i.push(O)}else{O=i[c]}++c;O.boundingVolume=e.clone(Z,O.boundingVolume);O.modelMatrix=n;O.shaderProgram=x;O.vertexArray=g.va;O.renderState=M.isTranslucent()?t._translucentRS:t._opaqueRS;O.pass=M.isTranslucent()?S.TRANSLUCENT:S.OPAQUE;O.debugShowBoundingVolume=a?h:false;O.uniformMap=m(M._uniforms);O.count=I;O.offset=T;d=true;s.push(O)}D=undefined}}i.length=c}H.prototype.isDestroyed=function(){return false};H.prototype.destroy=function(){se(this);oe(this);ue(this);this._batchTable=this._batchTable&&this._batchTable.destroy();return c(this)};function J(e){var t=false;var r=e._propertiesChanged;var i=e._positionBufferUsage;if(r[k]){if(i.bufferUsage!==w.STREAM_DRAW){t=true;i.bufferUsage=w.STREAM_DRAW;i.frameCount=100}else{i.frameCount=100}}else{if(i.bufferUsage!==w.STATIC_DRAW){if(i.frameCount===0){t=true;i.bufferUsage=w.STATIC_DRAW}else{i.frameCount--}}}return t}var $=[0,0,0];function ee(e,t,r){e._createVertexArray=false;oe(e);se(e);ie(e);var i=[[]];var n=i[0];var a=e._batchTable;var s=[0];var l=0;var c=[[]];var d=0;var f=e._polylineBuckets;var p;var v;for(p in f){if(f.hasOwnProperty(p)){v=f[p];v.updateShader(t,a);d+=v.lengthOfPositions}}if(d>0){var _=e._mode;var g=new Float32Array(6*d*3);var C=new Float32Array(d*4);var b;var S=0;var E=0;var T=0;for(p in f){if(f.hasOwnProperty(p)){v=f[p];v.write(g,C,S,E,T,a,t,r);if(_===L.MORPHING){if(!u(b)){b=new Float32Array(6*d*3)}v.writeForMorph(b,S)}var x=v.lengthOfPositions;S+=6*x*3;E+=x*4;T+=x*4;l=v.updateIndices(i,s,c,l)}}var P=e._positionBufferUsage.bufferUsage;var D=w.STATIC_DRAW;e._positionBuffer=y.createVertexBuffer({context:t,typedArray:g,usage:P});var M;if(u(b)){M=y.createVertexBuffer({context:t,typedArray:b,usage:P})}e._texCoordExpandAndBatchIndexBuffer=y.createVertexBuffer({context:t,typedArray:C,usage:D});var I=3*Float32Array.BYTES_PER_ELEMENT;var O=4*Float32Array.BYTES_PER_ELEMENT;var R=0;var N=i.length;for(var B=0;B<N;++B){n=i[B];if(n.length>0){var F=new Uint16Array(n);var k=y.createIndexBuffer({context:t,typedArray:F,usage:w.STATIC_DRAW,indexDatatype:h.UNSIGNED_SHORT});R+=s[B];var V=6*(B*(I*m.SIXTY_FOUR_KILOBYTES)-R*I);var z=I+V;var U=I+z;var q=I+U;var H=I+q;var W=I+H;var j=B*(O*m.SIXTY_FOUR_KILOBYTES)-R*O;var Y=[{index:G.position3DHigh,componentsPerAttribute:3,componentDatatype:o.FLOAT,offsetInBytes:V,strideInBytes:6*I},{index:G.position3DLow,componentsPerAttribute:3,componentDatatype:o.FLOAT,offsetInBytes:z,strideInBytes:6*I},{index:G.position2DHigh,componentsPerAttribute:3,componentDatatype:o.FLOAT,offsetInBytes:V,strideInBytes:6*I},{index:G.position2DLow,componentsPerAttribute:3,componentDatatype:o.FLOAT,offsetInBytes:z,strideInBytes:6*I},{index:G.prevPosition3DHigh,componentsPerAttribute:3,componentDatatype:o.FLOAT,
offsetInBytes:U,strideInBytes:6*I},{index:G.prevPosition3DLow,componentsPerAttribute:3,componentDatatype:o.FLOAT,offsetInBytes:q,strideInBytes:6*I},{index:G.prevPosition2DHigh,componentsPerAttribute:3,componentDatatype:o.FLOAT,offsetInBytes:U,strideInBytes:6*I},{index:G.prevPosition2DLow,componentsPerAttribute:3,componentDatatype:o.FLOAT,offsetInBytes:q,strideInBytes:6*I},{index:G.nextPosition3DHigh,componentsPerAttribute:3,componentDatatype:o.FLOAT,offsetInBytes:H,strideInBytes:6*I},{index:G.nextPosition3DLow,componentsPerAttribute:3,componentDatatype:o.FLOAT,offsetInBytes:W,strideInBytes:6*I},{index:G.nextPosition2DHigh,componentsPerAttribute:3,componentDatatype:o.FLOAT,offsetInBytes:H,strideInBytes:6*I},{index:G.nextPosition2DLow,componentsPerAttribute:3,componentDatatype:o.FLOAT,offsetInBytes:W,strideInBytes:6*I},{index:G.texCoordExpandAndBatchIndex,componentsPerAttribute:4,componentDatatype:o.FLOAT,vertexBuffer:e._texCoordExpandAndBatchIndexBuffer,offsetInBytes:j}];var X;var Z;var K;var Q;if(_===L.SCENE3D){X=e._positionBuffer;Z="vertexBuffer";K=$;Q="value"}else if(_===L.SCENE2D||_===L.COLUMBUS_VIEW){X=$;Z="value";K=e._positionBuffer;Q="vertexBuffer"}else{X=M;Z="vertexBuffer";K=e._positionBuffer;Q="vertexBuffer"}Y[0][Z]=X;Y[1][Z]=X;Y[2][Q]=K;Y[3][Q]=K;Y[4][Z]=X;Y[5][Z]=X;Y[6][Q]=K;Y[7][Q]=K;Y[8][Z]=X;Y[9][Z]=X;Y[10][Q]=K;Y[11][Q]=K;var J=new A({context:t,attributes:Y,indexBuffer:k});e._vertexArrays.push({va:J,buckets:c[B]})}}}}var te=[];function re(e){var t=R._uniformList[e.type];var r=t.length;te.length=2*r;var i=0;for(var n=0;n<r;++n){var a=t[n];te[i]=a;te[i+1]=e._uniforms[a]();i+=2}return e.type+":"+JSON.stringify(te)}function ie(e){var t=e._mode;var r=e._modelMatrix;var i=e._polylineBuckets={};var n=e._polylines;var a=n.length;for(var o=0;o<a;++o){var s=n[o];if(s._actualPositions.length>1){s.update();var l=s.material;var c=i[l.type];if(!u(c)){c=i[l.type]=new ce(l,t,r)}c.addPolyline(s)}}}function ne(e,t){var r=t.mode;if(e._mode!==r||!v.equals(e._modelMatrix,e.modelMatrix)){e._mode=r;e._modelMatrix=v.clone(e.modelMatrix);e._createVertexArray=true}}function ae(e){if(e._polylinesRemoved){e._polylinesRemoved=false;var t=[];var r=e._polylines.length;for(var i=0,n=0;i<r;++i){var a=e._polylines[i];if(u(a)){a._index=n++;t.push(a)}}e._polylines=t}}function oe(e){var t=e._polylines;var r=t.length;for(var i=0;i<r;++i){if(u(t[i])){var n=t[i]._bucket;if(u(n)){n.shaderProgram=n.shaderProgram&&n.shaderProgram.destroy()}}}}function se(e){var t=e._vertexArrays.length;for(var r=0;r<t;++r){e._vertexArrays[r].va.destroy()}e._vertexArrays.length=0}H.prototype._updatePolyline=function(e,t){this._polylinesUpdated=true;this._polylinesToUpdate.push(e);++this._propertiesChanged[t]};function ue(e){var t=e._polylines;var r=t.length;for(var i=0;i<r;++i){if(u(t[i])){t[i]._destroy()}}}function le(e,t,r){this.count=e;this.offset=t;this.bucket=r}function ce(e,t,r){this.polylines=[];this.lengthOfPositions=0;this.material=e;this.shaderProgram=undefined;this.pickShaderProgram=undefined;this.mode=t;this.modelMatrix=r}ce.prototype.addPolyline=function(e){var t=this.polylines;t.push(e);e._actualLength=this.getPolylinePositionsLength(e);this.lengthOfPositions+=e._actualLength;e._bucket=this};ce.prototype.updateShader=function(e,t){if(u(this.shaderProgram)){return}var r=["DISTANCE_DISPLAY_CONDITION"];var i=t.getVertexShaderCallback()(M);var n=new x({defines:r,sources:[P,i]});var a=new x({sources:[this.material.shaderSource,D]});var o=new x({sources:a.sources,pickColorQualifier:"varying"});this.shaderProgram=T.fromCache({context:e,vertexShaderSource:n,fragmentShaderSource:a,attributeLocations:G});this.pickShaderProgram=T.fromCache({context:e,vertexShaderSource:n,fragmentShaderSource:o,attributeLocations:G})};function de(e){return r.dot(r.UNIT_X,e._boundingVolume.center)<0||e._boundingVolume.intersectPlane(_.ORIGIN_ZX_PLANE)===p.INTERSECTING}ce.prototype.getPolylinePositionsLength=function(e){var t;if(this.mode===L.SCENE3D||!de(e)){t=e._actualPositions.length;return t*4-4}var r=0;var i=e._segments.lengths;t=i.length;for(var n=0;n<t;++n){r+=i[n]*4-4}return r};var fe=new r;var he=new r;var pe=new r;var me=new r;var ve=new i;var _e=new t;ce.prototype.write=function(e,t,n,o,s,l,c,d){var h=this.mode;var p=d.ellipsoid.maximumRadius*m.PI;var v=this.polylines;var _=v.length;for(var g=0;g<_;++g){var y=v[g];var w=y.width;var C=y.show&&w>0;var b=y._index;var S=this.getSegments(y,d);var E=S.positions;var T=S.lengths;var x=E.length;var A=y.getPickId(c).color;var P=0;var D=0;var M;for(var I=0;I<x;++I){if(I===0){if(y._loop){M=E[x-2]}else{M=me;r.subtract(E[0],E[1],M);r.add(E[0],M,M)}}else{M=E[I-1]}r.clone(M,he);r.clone(E[I],fe);if(I===x-1){if(y._loop){M=E[1]}else{M=me;r.subtract(E[x-1],E[x-2],M);r.add(E[x-1],M,M)}}else{M=E[I+1]}r.clone(M,pe);var O=T[P];if(I===D+O){D+=O;++P}var R=I-D===0;var N=I===D+T[P]-1;if(h===L.SCENE2D){he.z=0;fe.z=0;pe.z=0}if(h===L.SCENE2D||h===L.MORPHING){if((R||N)&&p-Math.abs(fe.x)<1){if(fe.x<0&&he.x>0||fe.x>0&&he.x<0){r.clone(fe,he)}if(fe.x<0&&pe.x>0||fe.x>0&&pe.x<0){r.clone(fe,pe)}}}var B=R?2:0;var F=N?2:4;for(var k=B;k<F;++k){f.writeElements(fe,e,n);f.writeElements(he,e,n+6);f.writeElements(pe,e,n+12);var V=k-2<0?-1:1;t[s]=I/(x-1);t[s+1]=2*(k%2)-1;t[s+2]=V;t[s+3]=b;n+=6*3;s+=4}}var z=ve;z.x=a.floatToByte(A.red);z.y=a.floatToByte(A.green);z.z=a.floatToByte(A.blue);z.w=a.floatToByte(A.alpha);var U=_e;U.x=w;U.y=C?1:0;var q=h===L.SCENE2D?y._boundingVolume2D:y._boundingVolumeWC;var G=f.fromCartesian(q.center,j);var H=G.high;var W=i.fromElements(G.low.x,G.low.y,G.low.z,q.radius,Y);var Z=X;Z.x=0;Z.y=Number.MAX_VALUE;var K=y.distanceDisplayCondition;if(u(K)){Z.x=K.near;Z.y=K.far}l.setBatchedAttribute(b,0,U);l.setBatchedAttribute(b,1,z);if(l.attributes.length>2){l.setBatchedAttribute(b,2,H);l.setBatchedAttribute(b,3,W);l.setBatchedAttribute(b,4,Z)}}};var ge=new r;var ye=new r;var we=new r;var Ce=new r;ce.prototype.writeForMorph=function(e,t){var i=this.modelMatrix;var n=this.polylines;var a=n.length;for(var o=0;o<a;++o){var s=n[o];var u=s._segments.positions;var l=s._segments.lengths;var c=u.length;var d=0;var h=0;for(var p=0;p<c;++p){var m;if(p===0){if(s._loop){m=u[c-2]}else{m=Ce;r.subtract(u[0],u[1],m);r.add(u[0],m,m)}}else{m=u[p-1]}m=v.multiplyByPoint(i,m,ye);var _=v.multiplyByPoint(i,u[p],ge);var g;if(p===c-1){if(s._loop){g=u[1]}else{g=Ce;r.subtract(u[c-1],u[c-2],g);r.add(u[c-1],g,g)}}else{g=u[p+1]}g=v.multiplyByPoint(i,g,we);var y=l[d];if(p===h+y){h+=y;++d}var w=p-h===0;var C=p===h+l[d]-1;var b=w?2:0;var S=C?2:4;for(var E=b;E<S;++E){f.writeElements(_,e,t);f.writeElements(m,e,t+6);f.writeElements(g,e,t+12);t+=6*3}}}};var be=new Array(1);ce.prototype.updateIndices=function(e,t,r,i){var n=r.length-1;var a=new le(0,i,this);r[n].push(a);var o=0;var s=e[e.length-1];var u=0;if(s.length>0){u=s[s.length-1]+1}var l=this.polylines;var c=l.length;for(var d=0;d<c;++d){var f=l[d];f._locatorBuckets=[];var h;if(this.mode===L.SCENE3D){h=be;var p=f._actualPositions.length;if(p>0){h[0]=p}else{continue}}else{h=f._segments.lengths}var v=h.length;if(v>0){var _=0;for(var g=0;g<v;++g){var y=h[g]-1;for(var w=0;w<y;++w){if(u+4>=m.SIXTY_FOUR_KILOBYTES-2){f._locatorBuckets.push({locator:a,count:_});_=0;t.push(4);s=[];e.push(s);u=0;a.count=o;o=0;i=0;a=new le(0,0,this);r[++n]=[a]}s.push(u,u+2,u+1);s.push(u+1,u+2,u+3);_+=6;o+=6;i+=6;u+=4}}f._locatorBuckets.push({locator:a,count:_});if(u+4>=m.SIXTY_FOUR_KILOBYTES-2){t.push(0);s=[];e.push(s);u=0;a.count=o;i=0;o=0;a=new le(0,0,this);r[++n]=[a]}}f._clean()}a.count=o;return i};ce.prototype.getPolylineStartIndex=function(e){var t=this.polylines;var r=0;var i=t.length;for(var n=0;n<i;++n){var a=t[n];if(a===e){break}r+=a._actualLength}return r};var Se={positions:undefined,lengths:undefined};var Ee=new Array(1);var Te=new r;var xe=new n;ce.prototype.getSegments=function(t,i){var n=t._actualPositions;if(this.mode===L.SCENE3D){Ee[0]=n.length;Se.positions=n;Se.lengths=Ee;return Se}if(de(t)){n=t._segments.positions}var a=i.ellipsoid;var o=[];var s=this.modelMatrix;var u=n.length;var l;var c=Te;for(var d=0;d<u;++d){l=n[d];c=v.multiplyByPoint(s,l,c);o.push(i.project(a.cartesianToCartographic(c,xe)))}if(o.length>0){t._boundingVolume2D=e.fromPoints(o,t._boundingVolume2D);var f=t._boundingVolume2D.center;t._boundingVolume2D.center=new r(f.z,f.x,f.y)}Se.positions=o;Se.lengths=t._segments.lengths;return Se};var Ae;ce.prototype.writeUpdate=function(e,t,i,n){var a=this.mode;var o=n.ellipsoid.maximumRadius*m.PI;var s=t._actualLength;if(s){e+=this.getPolylineStartIndex(t);var l=Ae;var c=6*s*3;if(!u(l)||l.length<c){l=Ae=new Float32Array(c)}else if(l.length>c){l=new Float32Array(l.buffer,0,c)}var d=this.getSegments(t,n);var h=d.positions;var p=d.lengths;var v=0;var _=0;var g=0;var y;s=h.length;for(var w=0;w<s;++w){if(w===0){if(t._loop){y=h[s-2]}else{y=me;r.subtract(h[0],h[1],y);r.add(h[0],y,y)}}else{y=h[w-1]}r.clone(y,he);r.clone(h[w],fe);if(w===s-1){if(t._loop){y=h[1]}else{y=me;r.subtract(h[s-1],h[s-2],y);r.add(h[s-1],y,y)}}else{y=h[w+1]}r.clone(y,pe);var C=p[_];if(w===g+C){g+=C;++_}var b=w-g===0;var S=w===g+p[_]-1;if(a===L.SCENE2D){he.z=0;fe.z=0;pe.z=0}if(a===L.SCENE2D||a===L.MORPHING){if((b||S)&&o-Math.abs(fe.x)<1){if(fe.x<0&&he.x>0||fe.x>0&&he.x<0){r.clone(fe,he)}if(fe.x<0&&pe.x>0||fe.x>0&&pe.x<0){r.clone(fe,pe)}}}var E=b?2:0;var T=S?2:4;for(var x=E;x<T;++x){f.writeElements(fe,l,v);f.writeElements(he,l,v+6);f.writeElements(pe,l,v+12);v+=6*3}}i.copyFromArrayView(l,6*3*Float32Array.BYTES_PER_ELEMENT*e)}};return H});define("DataSources/ScaledPositionProperty",["../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Ellipsoid","../Core/Event","../Core/ReferenceFrame","./Property"],function(e,t,r,i,n,a,o){"use strict";function s(e){this._definitionChanged=new n;this._value=undefined;this._removeSubscription=undefined;this.setValue(e)}t(s.prototype,{isConstant:{get:function(){return o.isConstant(this._value)}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return e(this._value)?this._value.referenceFrame:a.FIXED}}});s.prototype.getValue=function(e,t){return this.getValueInReferenceFrame(e,a.FIXED,t)};s.prototype.setValue=function(t){if(this._value!==t){this._value=t;if(e(this._removeSubscription)){this._removeSubscription();this._removeSubscription=undefined}if(e(t)){this._removeSubscription=t.definitionChanged.addEventListener(this._raiseDefinitionChanged,this)}this._definitionChanged.raiseEvent(this)}};s.prototype.getValueInReferenceFrame=function(t,n,a){if(!e(t)){throw new r("time is required.")}if(!e(n)){throw new r("referenceFrame is required.")}if(!e(this._value)){return undefined}a=this._value.getValueInReferenceFrame(t,n,a);return e(a)?i.WGS84.scaleToGeodeticSurface(a,a):undefined};s.prototype.equals=function(e){return this===e||e instanceof s&&this._value===e._value};s.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)};return s});define("DataSources/PathVisualizer",["../Core/AssociativeArray","../Core/Cartesian3","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Core/JulianDate","../Core/Matrix3","../Core/Matrix4","../Core/ReferenceFrame","../Core/TimeInterval","../Core/Transforms","../Scene/PolylineCollection","../Scene/SceneMode","./CompositePositionProperty","./ConstantPositionProperty","./MaterialProperty","./Property","./ReferenceProperty","./SampledPositionProperty","./ScaledPositionProperty","./TimeIntervalCollectionPositionProperty"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w){"use strict";var C=60;var b=1;var S=new l;var E=new l;var T=new l;function x(e){this.entity=e;this.polyline=undefined;this.index=undefined;this.updater=undefined}function A(e,t,i,n,o,s,u,l,c){var d=l;var f;f=e.getValueInReferenceFrame(t,s,c[d]);if(r(f)){c[d++]=f}var h=!r(o)||a.lessThanOrEquals(o,t)||a.greaterThanOrEquals(o,i);var p=0;var m=n.length;var v=n[p];var _=i;var g=false;var y;var w;var C;while(p<m){if(!h&&a.greaterThanOrEquals(v,o)){f=e.getValueInReferenceFrame(o,s,c[d]);if(r(f)){c[d++]=f}h=true}if(a.greaterThan(v,t)&&a.lessThan(v,_)&&!v.equals(o)){f=e.getValueInReferenceFrame(v,s,c[d]);if(r(f)){c[d++]=f}}if(p<m-1){if(u>0&&!g){var b=n[p+1];var S=a.secondsDifference(b,v);g=S>u;if(g){y=Math.ceil(S/u);w=0;C=S/Math.max(y,2);y=Math.max(y-1,1)}}if(g&&w<y){v=a.addSeconds(v,C,new a);w++;continue}}g=false;p++;v=n[p]}f=e.getValueInReferenceFrame(i,s,c[d]);if(r(f)){c[d++]=f}return d}function P(e,t,i,n,o,s,u,l){var c;var d=0;var f=u;var h=t;var p=Math.max(s,60);var m=!r(n)||a.lessThanOrEquals(n,t)||a.greaterThanOrEquals(n,i);while(a.lessThan(h,i)){if(!m&&a.greaterThanOrEquals(h,n)){m=true;c=e.getValueInReferenceFrame(n,o,l[f]);if(r(c)){l[f]=c;f++}}c=e.getValueInReferenceFrame(h,o,l[f]);if(r(c)){l[f]=c;f++}d++;h=a.addSeconds(t,p*d,new a)}c=e.getValueInReferenceFrame(i,o,l[f]);if(r(c)){l[f]=c;f++}return f}function D(e,t,i,n,o,s,u,c){T.start=t;T.stop=i;var d=u;var f=e.intervals;for(var h=0;h<f.length;h++){var p=f.get(h);if(!l.intersect(p,T,S).isEmpty){var m=p.start;if(!p.isStartIncluded){if(p.isStopIncluded){m=p.stop}else{m=a.addSeconds(p.start,a.secondsDifference(p.stop,p.start)/2,new a)}}var v=e.getValueInReferenceFrame(m,o,c[d]);if(r(v)){c[d]=v;d++}}}return d}function M(e,t,i,n,a,o,s,u){var l=e.getValueInReferenceFrame(t,a,u[s]);if(r(l)){u[s++]=l}return s}function I(e,t,r,i,n,o,s,u){E.start=t;E.stop=r;var c=s;var d=e.intervals;for(var f=0;f<d.length;f++){var h=d.get(f);if(!l.intersect(h,E,S).isEmpty){var p=h.start;var m=h.stop;var v=t;if(a.greaterThan(p,v)){v=p}var _=r;if(a.lessThan(m,_)){_=m}c=O(h.data,v,_,i,n,o,c,u)}}return c}function O(e,t,r,i,n,a,o,s){while(e instanceof _){e=e.resolvedProperty}if(e instanceof g){var u=e._property._times;o=A(e,t,r,u,i,n,a,o,s)}else if(e instanceof h){o=I(e,t,r,i,n,a,o,s)}else if(e instanceof w){o=D(e,t,r,i,n,a,o,s)}else if(e instanceof p||e instanceof y&&v.isConstant(e)){o=M(e,t,r,i,n,a,o,s)}else{o=P(e,t,r,i,n,a,o,s)}return o}function R(e,t,i,n,a,o,s){if(!r(s)){s=[]}var u=O(e,t,i,n,a,o,0,s);s.length=u;return s}var N=new o;function L(e,t){this._unusedIndexes=[];this._polylineCollection=new d;this._scene=e;this._referenceFrame=t;e.primitives.add(this._polylineCollection)}L.prototype.update=function(e){if(this._referenceFrame===u.INERTIAL){var i=c.computeIcrfToFixedMatrix(e,N);if(!r(i)){i=c.computeTemeToPseudoFixedMatrix(e,N)}s.fromRotationTranslation(i,t.ZERO,this._polylineCollection.modelMatrix)}};L.prototype.updateObject=function(e,t){var i=t.entity;var n=i._path;var o=i._position;var s;var u;var l=n._show;var c=t.polyline;var d=i.isShowing&&(!r(l)||l.getValue(e));if(d){var f=v.getValueOrUndefined(n._leadTime,e);var h=v.getValueOrUndefined(n._trailTime,e);var p=i._availability;var _=r(p);var g=r(f);var y=r(h);d=_||g&&y;if(d){if(y){s=a.addSeconds(e,-h,new a)}if(g){u=a.addSeconds(e,f,new a)}if(_){var w=p.start;var S=p.stop;if(!y||a.greaterThan(w,s)){s=w}if(!g||a.lessThan(S,u)){u=S}}d=a.lessThan(s,u)}}if(!d){if(r(c)){this._unusedIndexes.push(t.index);t.polyline=undefined;c.show=false;t.index=undefined}return}if(!r(c)){var E=this._unusedIndexes;var T=E.length;if(T>0){var x=E.pop();c=this._polylineCollection.get(x);t.index=x}else{t.index=this._polylineCollection.length;c=this._polylineCollection.add()}c.id=i;t.polyline=c}var A=v.getValueOrDefault(n._resolution,e,C);c.show=true;c.positions=R(o,s,u,e,this._referenceFrame,A,c.positions.slice());c.material=m.getValue(e,n._material,c.material);c.width=v.getValueOrDefault(n._width,e,b);c.distanceDisplayCondition=v.getValueOrUndefined(n._distanceDisplayCondition,e,c.distanceDisplayCondition)};L.prototype.removeObject=function(e){var t=e.polyline;if(r(t)){this._unusedIndexes.push(e.index);e.polyline=undefined;t.show=false;t.id=undefined;e.index=undefined}};L.prototype.destroy=function(){this._scene.primitives.remove(this._polylineCollection);return i(this)};function B(t,i){if(!r(t)){throw new n("scene is required.")}if(!r(i)){throw new n("entityCollection is required.")}i.collectionChanged.addEventListener(B.prototype._onCollectionChanged,this);this._scene=t;this._updaters={};this._entityCollection=i;this._items=new e;this._onCollectionChanged(i,i.values,[],[])}B.prototype.update=function(e){if(!r(e)){throw new n("time is required.")}var t=this._updaters;for(var i in t){if(t.hasOwnProperty(i)){t[i].update(e)}}var a=this._items.values;for(var o=0,s=a.length;o<s;o++){var l=a[o];var c=l.entity;var d=c._position;var h=l.updater;var p=u.FIXED;if(this._scene.mode===f.SCENE3D){p=d.referenceFrame}var m=this._updaters[p];if(h===m&&r(m)){m.updateObject(e,l);continue}if(r(h)){h.removeObject(l)}if(!r(m)){m=new L(this._scene,p);m.update(e);this._updaters[p]=m}l.updater=m;if(r(m)){m.updateObject(e,l)}}return true};B.prototype.isDestroyed=function(){return false};B.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(B.prototype._onCollectionChanged,this);var e=this._updaters;for(var t in e){if(e.hasOwnProperty(t)){e[t].destroy()}}return i(this)};B.prototype._onCollectionChanged=function(e,t,i,n){var a;var o;var s;var u=this._items;for(a=t.length-1;a>-1;a--){o=t[a];if(r(o._path)&&r(o._position)){u.set(o.id,new x(o))}}for(a=n.length-1;a>-1;a--){o=n[a];if(r(o._path)&&r(o._position)){if(!u.contains(o.id)){u.set(o.id,new x(o))}}else{s=u.get(o.id);if(r(s)){s.updater.removeObject(s);u.remove(o.id)}}}for(a=i.length-1;a>-1;a--){o=i[a];s=u.get(o.id);if(r(s)){if(r(s.updater)){s.updater.removeObject(s)}u.remove(o.id)}}};B._subSample=R;return B});define("DataSources/PointVisualizer",["../Core/AssociativeArray","../Core/Cartesian3","../Core/Color","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/NearFarScalar","../Scene/HeightReference","./BoundingSphereState","./Property"],function(e,t,r,i,n,a,o,s,u,l,c){"use strict";var d=r.WHITE;var f=r.BLACK;var h=0;var p=1;var m=new r;var v=new t;var _=new r;var g=new s;var y=new s;var w=new o;function C(e){this.entity=e;this.pointPrimitive=undefined;this.billboard=undefined;this.color=undefined;this.outlineColor=undefined;this.pixelSize=undefined;this.outlineWidth=undefined}function b(t,r){if(!i(t)){throw new a("entityCluster is required.")}if(!i(r)){throw new a("entityCollection is required.")}r.collectionChanged.addEventListener(b.prototype._onCollectionChanged,this);this._cluster=t;this._entityCollection=r;this._items=new e;this._onCollectionChanged(r,r.values,[],[])}b.prototype.update=function(e){if(!i(e)){throw new a("time is required.")}var t=this._items.values;var n=this._cluster;for(var o=0,s=t.length;o<s;o++){var l=t[o];var C=l.entity;var b=C._point;var T=l.pointPrimitive;var x=l.billboard;var A=c.getValueOrDefault(b._heightReference,e,u.NONE);var P=C.isShowing&&C.isAvailable(e)&&c.getValueOrDefault(b._show,e,true);if(P){v=c.getValueOrUndefined(C._position,e,v);P=i(v)}if(!P){S(l,C,n);continue}if(!c.isConstant(C._position)){n._clusterDirty=true}var D=false;if(A!==u.NONE&&!i(x)){if(i(T)){S(l,C,n);T=undefined}x=n.getBillboard(C);x.id=C;x.image=undefined;l.billboard=x;D=true}else if(A===u.NONE&&!i(T)){if(i(x)){S(l,C,n);x=undefined}T=n.getPoint(C);T.id=C;l.pointPrimitive=T}if(i(T)){T.show=true;T.position=v;T.scaleByDistance=c.getValueOrUndefined(b._scaleByDistance,e,g);T.translucencyByDistance=c.getValueOrUndefined(b._translucencyByDistance,e,y);T.color=c.getValueOrDefault(b._color,e,d,m);T.outlineColor=c.getValueOrDefault(b._outlineColor,e,f,_);T.outlineWidth=c.getValueOrDefault(b._outlineWidth,e,h);T.pixelSize=c.getValueOrDefault(b._pixelSize,e,p);T.distanceDisplayCondition=c.getValueOrUndefined(b._distanceDisplayCondition,e,w)}else{x.show=true;x.position=v;x.scaleByDistance=c.getValueOrUndefined(b._scaleByDistance,e,g);x.translucencyByDistance=c.getValueOrUndefined(b._translucencyByDistance,e,y);x.distanceDisplayCondition=c.getValueOrUndefined(b._distanceDisplayCondition,e,w);x.heightReference=A;var M=c.getValueOrDefault(b._color,e,d,m);var I=c.getValueOrDefault(b._outlineColor,e,f,_);var O=Math.round(c.getValueOrDefault(b._outlineWidth,e,h));var R=Math.max(1,Math.round(c.getValueOrDefault(b._pixelSize,e,p)));if(O>0){x.scale=1;D=D||O!==l.outlineWidth||R!==l.pixelSize||!r.equals(M,l.color)||!r.equals(I,l.outlineColor)}else{x.scale=R/50;R=50;D=D||O!==l.outlineWidth||!r.equals(M,l.color)||!r.equals(I,l.outlineColor)}if(D){l.color=r.clone(M,l.color);l.outlineColor=r.clone(I,l.outlineColor);l.pixelSize=R;l.outlineWidth=O;var N=M.alpha;var L=M.toCssColorString();var B=I.toCssColorString();var F=JSON.stringify([L,R,B,O]);x.setImage(F,E(N,L,B,O,R))}}}return true};b.prototype.getBoundingSphere=function(e,r){if(!i(e)){throw new a("entity is required.")}if(!i(r)){throw new a("result is required.")}var n=this._items.get(e.id);if(!i(n)||!(i(n.pointPrimitive)||i(n.billboard))){return l.FAILED}if(i(n.pointPrimitive)){r.center=t.clone(n.pointPrimitive.position,r.center)}else{var o=n.billboard;if(!i(o._clampedPosition)){return l.PENDING}r.center=t.clone(o._clampedPosition,r.center)}r.radius=0;return l.DONE};b.prototype.isDestroyed=function(){return false};b.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(b.prototype._onCollectionChanged,this);var e=this._entityCollection.values;for(var t=0;t<e.length;t++){this._cluster.removePoint(e[t])}return n(this)};b.prototype._onCollectionChanged=function(e,t,r,n){var a;var o;var s=this._items;var u=this._cluster;for(a=t.length-1;a>-1;a--){o=t[a];if(i(o._point)&&i(o._position)){s.set(o.id,new C(o))}}for(a=n.length-1;a>-1;a--){o=n[a];if(i(o._point)&&i(o._position)){if(!s.contains(o.id)){s.set(o.id,new C(o))}}else{S(s.get(o.id),o,u);s.remove(o.id)}}for(a=r.length-1;a>-1;a--){o=r[a];S(s.get(o.id),o,u);s.remove(o.id)}};function S(e,t,r){if(i(e)){var n=e.pointPrimitive;if(i(n)){e.pointPrimitive=undefined;r.removePoint(t);return}var a=e.billboard;if(i(a)){e.billboard=undefined;r.removeBillboard(t)}}}function E(e,t,r,i,n){return function(a){var o=document.createElement("canvas");var s=n+2*i;o.height=o.width=s;var u=o.getContext("2d");u.clearRect(0,0,s,s);if(i!==0){u.beginPath();u.arc(s/2,s/2,s/2,0,2*Math.PI,true);u.closePath();u.fillStyle=r;u.fill();if(e<1){u.save();u.globalCompositeOperation="destination-out";u.beginPath();u.arc(s/2,s/2,n/2,0,2*Math.PI,true);u.closePath();u.fillStyle="black";u.fill();u.restore()}}u.beginPath();u.arc(s/2,s/2,n/2,0,2*Math.PI,true);u.closePath();u.fillStyle=t;u.fill();return o}}return b});define("DataSources/PolygonGeometryUpdater",["../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/Event","../Core/GeometryInstance","../Core/isArray","../Core/Iso8601","../Core/oneTimeWarning","../Core/PolygonGeometry","../Core/PolygonHierarchy","../Core/PolygonOutlineGeometry","../Core/ShowGeometryInstanceAttribute","../Scene/GroundPrimitive","../Scene/MaterialAppearance","../Scene/PerInstanceColorAppearance","../Scene/Primitive","../Scene/ShadowMode","./ColorMaterialProperty","./ConstantProperty","./dynamicGeometryGetBoundingSphere","./MaterialProperty","./Property"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w,C,b,S,E,T,x,A){"use strict";var P=new S(e.WHITE);var D=new E(true);var M=new E(true);var I=new E(false);var O=new E(e.BLACK);var R=new E(b.DISABLED);var N=new E(new s);var L=new e;function B(e){this.id=e;this.vertexFormat=undefined;this.polygonHierarchy=undefined;this.perPositionHeight=undefined;this.closeTop=undefined;this.closeBottom=undefined;this.height=undefined;this.extrudedHeight=undefined;this.granularity=undefined;this.stRotation=undefined}function F(e,t){if(!i(e)){throw new o("entity is required")}if(!i(t)){throw new o("scene is required")}this._entity=e;this._scene=t;this._entitySubscription=e.definitionChanged.addEventListener(F.prototype._onEntityPropertyChanged,this);this._fillEnabled=false;this._isClosed=false;this._dynamic=false;this._outlineEnabled=false;this._geometryChanged=new l;this._showProperty=undefined;this._materialProperty=undefined;this._hasConstantOutline=true;this._showOutlineProperty=undefined;this._outlineColorProperty=undefined;this._outlineWidth=1;this._shadowsProperty=undefined;this._distanceDisplayConditionProperty=undefined;this._onTerrain=false;this._options=new B(e);this._onEntityPropertyChanged(e,"polygon",e.polygon,undefined)}n(F,{perInstanceColorAppearanceType:{value:w},materialAppearanceType:{value:y}});n(F.prototype,{entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!i(this._entity.availability)&&A.isConstant(this._showProperty)&&A.isConstant(this._fillProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},outlineEnabled:{get:function(){return this._outlineEnabled}},hasConstantOutline:{get:function(){return!this._outlineEnabled||!i(this._entity.availability)&&A.isConstant(this._showProperty)&&A.isConstant(this._showOutlineProperty)}},outlineColorProperty:{get:function(){return this._outlineColorProperty}},outlineWidth:{get:function(){return this._outlineWidth}},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayConditionProperty}},isDynamic:{get:function(){return this._dynamic}},isClosed:{get:function(){return this._isClosed}},onTerrain:{get:function(){return this._onTerrain}},geometryChanged:{get:function(){return this._geometryChanged}}});F.prototype.isOutlineVisible=function(e){var t=this._entity;return this._outlineEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)};F.prototype.isFilled=function(e){var t=this._entity;return this._fillEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)};F.prototype.createFillGeometryInstance=function(r){if(!i(r)){throw new o("time is required.")}if(!this._fillEnabled){throw new o("This instance does not represent a filled geometry.")}var n=this._entity;var a=n.isAvailable(r);var s;var l;var d=new _(a&&n.isShowing&&this._showProperty.getValue(r)&&this._fillProperty.getValue(r));var f=this._distanceDisplayConditionProperty.getValue(r);var h=u.fromDistanceDisplayCondition(f);if(this._materialProperty instanceof S){var m=e.WHITE;if(i(this._materialProperty.color)&&(this._materialProperty.color.isConstant||a)){m=this._materialProperty.color.getValue(r)}l=t.fromColor(m);s={show:d,distanceDisplayCondition:h,color:l}}else{s={show:d,distanceDisplayCondition:h}}return new c({id:n,geometry:new p(this._options),attributes:s})};F.prototype.createOutlineGeometryInstance=function(r){if(!i(r)){throw new o("time is required.")}if(!this._outlineEnabled){throw new o("This instance does not represent an outlined geometry.")}var n=this._entity;var a=n.isAvailable(r);var s=A.getValueOrDefault(this._outlineColorProperty,r,e.BLACK);var l=this._distanceDisplayConditionProperty.getValue(r);return new c({id:n,geometry:new v(this._options),attributes:{show:new _(a&&n.isShowing&&this._showProperty.getValue(r)&&this._showOutlineProperty.getValue(r)),color:t.fromColor(s),distanceDisplayCondition:u.fromDistanceDisplayCondition(l)}})};F.prototype.isDestroyed=function(){return false};F.prototype.destroy=function(){this._entitySubscription();a(this)};F.prototype._onEntityPropertyChanged=function(e,t,n,a){if(!(t==="availability"||t==="polygon")){return}var o=this._entity.polygon;if(!i(o)){if(this._fillEnabled||this._outlineEnabled){this._fillEnabled=false;this._outlineEnabled=false;this._geometryChanged.raiseEvent(this)}return}var s=o.fill;var u=i(s)&&s.isConstant?s.getValue(f.MINIMUM_VALUE):true;var l=o.perPositionHeight;var c=i(l)&&(l.isConstant?l.getValue(f.MINIMUM_VALUE):true);var p=o.outline;var v=i(p);if(v&&p.isConstant){v=p.getValue(f.MINIMUM_VALUE)}if(!u&&!v){if(this._fillEnabled||this._outlineEnabled){this._fillEnabled=false;this._outlineEnabled=false;this._geometryChanged.raiseEvent(this)}return}var _=o.hierarchy;var C=o.show;if(i(C)&&C.isConstant&&!C.getValue(f.MINIMUM_VALUE)||!i(_)){if(this._fillEnabled||this._outlineEnabled){this._fillEnabled=false;this._outlineEnabled=false;this._geometryChanged.raiseEvent(this)}return}var b=r(o.material,P);var E=b instanceof S;this._materialProperty=b;this._fillProperty=r(s,M);this._showProperty=r(C,D);this._showOutlineProperty=r(o.outline,I);this._outlineColorProperty=v?r(o.outlineColor,O):undefined;this._shadowsProperty=r(o.shadows,R);this._distanceDisplayConditionProperty=r(o.distanceDisplayCondition,N);var T=o.height;var x=o.extrudedHeight;var L=o.granularity;var B=o.stRotation;var F=o.outlineWidth;var k=u&&!i(T)&&!i(x)&&E&&!c&&g.isSupported(this._scene);if(v&&k){h(h.geometryOutlines);v=false}var V=o.perPositionHeight;var z=o.closeTop;var U=o.closeBottom;this._fillEnabled=u;this._onTerrain=k;this._outlineEnabled=v;if(!_.isConstant||!A.isConstant(T)||!A.isConstant(x)||!A.isConstant(L)||!A.isConstant(B)||!A.isConstant(F)||!A.isConstant(l)||!A.isConstant(V)||!A.isConstant(z)||!A.isConstant(U)||k&&!A.isConstant(b)){if(!this._dynamic){this._dynamic=true;this._geometryChanged.raiseEvent(this)}}else{var q=this._options;q.vertexFormat=E?w.VERTEX_FORMAT:y.MaterialSupport.TEXTURED.vertexFormat;var G=_.getValue(f.MINIMUM_VALUE);if(d(G)){G=new m(G)}var H=A.getValueOrUndefined(T,f.MINIMUM_VALUE);var W=A.getValueOrDefault(z,f.MINIMUM_VALUE,true);var j=A.getValueOrDefault(U,f.MINIMUM_VALUE,true);var Y=A.getValueOrUndefined(x,f.MINIMUM_VALUE);q.polygonHierarchy=G;q.height=H;q.extrudedHeight=Y;q.granularity=A.getValueOrUndefined(L,f.MINIMUM_VALUE);q.stRotation=A.getValueOrUndefined(B,f.MINIMUM_VALUE);q.perPositionHeight=A.getValueOrUndefined(V,f.MINIMUM_VALUE);q.closeTop=W;q.closeBottom=j;this._outlineWidth=A.getValueOrDefault(F,f.MINIMUM_VALUE,1);this._isClosed=i(Y)&&Y!==H&&W&&j;this._dynamic=false;this._geometryChanged.raiseEvent(this)}};F.prototype.createDynamicUpdater=function(e,t){if(!this._dynamic){throw new o("This instance does not represent dynamic geometry.")}if(!i(e)){throw new o("primitives is required.")}return new k(e,t,this)};function k(e,t,r){this._primitives=e;this._groundPrimitives=t;this._primitive=undefined;this._outlinePrimitive=undefined;this._geometryUpdater=r;this._options=new B(r._entity)}k.prototype.update=function(r){if(!i(r)){throw new o("time is required.")}var n=this._geometryUpdater;var a=n._onTerrain;var s=this._primitives;var u=this._groundPrimitives;if(a){u.removeAndDestroy(this._primitive)}else{s.removeAndDestroy(this._primitive);s.removeAndDestroy(this._outlinePrimitive);this._outlinePrimitive=undefined}this._primitive=undefined;var l=n._entity;var f=l.polygon;if(!l.isShowing||!l.isAvailable(r)||!A.getValueOrDefault(f.show,r,true)){return}var h=this._options;var _=A.getValueOrUndefined(f.hierarchy,r);if(!i(_)){return}if(d(_)){h.polygonHierarchy=new m(_)}else{h.polygonHierarchy=_}var b=A.getValueOrDefault(f.closeTop,r,true);var S=A.getValueOrDefault(f.closeBottom,r,true);h.height=A.getValueOrUndefined(f.height,r);h.extrudedHeight=A.getValueOrUndefined(f.extrudedHeight,r);h.granularity=A.getValueOrUndefined(f.granularity,r);h.stRotation=A.getValueOrUndefined(f.stRotation,r);h.perPositionHeight=A.getValueOrUndefined(f.perPositionHeight,r);h.closeTop=b;h.closeBottom=S;var E=this._geometryUpdater.shadowsProperty.getValue(r);if(A.getValueOrDefault(f.fill,r,true)){var T=n.fillMaterialProperty;var P=x.getValue(r,T,this._material);this._material=P;if(a){var D=e.WHITE;if(i(T.color)){D=T.color.getValue(r)}this._primitive=u.add(new g({geometryInstances:new c({id:l,geometry:new p(h),attributes:{color:t.fromColor(D)}}),asynchronous:false,shadows:E}))}else{var M=new y({material:P,translucent:P.isTranslucent(),closed:i(h.extrudedHeight)&&h.extrudedHeight!==h.height&&b&&S});h.vertexFormat=M.vertexFormat;this._primitive=s.add(new C({geometryInstances:new c({id:l,geometry:new p(h)}),appearance:M,
asynchronous:false,shadows:E}))}}if(!a&&A.getValueOrDefault(f.outline,r,false)){h.vertexFormat=w.VERTEX_FORMAT;var I=A.getValueOrClonedDefault(f.outlineColor,r,e.BLACK,L);var O=A.getValueOrDefault(f.outlineWidth,r,1);var R=I.alpha!==1;this._outlinePrimitive=s.add(new C({geometryInstances:new c({id:l,geometry:new v(h),attributes:{color:t.fromColor(I)}}),appearance:new w({flat:true,translucent:R,renderState:{lineWidth:n._scene.clampLineWidth(O)}}),asynchronous:false,shadows:E}))}};k.prototype.getBoundingSphere=function(e,t){return T(e,this._primitive,this._outlinePrimitive,t)};k.prototype.isDestroyed=function(){return false};k.prototype.destroy=function(){var e=this._primitives;var t=this._groundPrimitives;if(this._geometryUpdater._onTerrain){t.removeAndDestroy(this._primitive)}else{e.removeAndDestroy(this._primitive)}e.removeAndDestroy(this._outlinePrimitive);a(this)};return F});define("Shaders/Appearances/PolylineColorAppearanceVS",[],function(){"use strict";return"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec3 prevPosition3DHigh;\nattribute vec3 prevPosition3DLow;\nattribute vec3 nextPosition3DHigh;\nattribute vec3 nextPosition3DLow;\nattribute vec2 expandAndWidth;\nattribute vec4 color;\nattribute float batchId;\nvarying vec4 v_color;\nvoid main()\n{\nfloat expandDir = expandAndWidth.x;\nfloat width = abs(expandAndWidth.y) + 0.5;\nbool usePrev = expandAndWidth.y < 0.0;\nvec4 p = czm_computePosition();\nvec4 prev = czm_computePrevPosition();\nvec4 next = czm_computeNextPosition();\nv_color = color;\nvec4 positionWC = getPolylineWindowCoordinates(p, prev, next, expandDir, width, usePrev);\ngl_Position = czm_viewportOrthographic * positionWC;\n}\n"});define("Scene/PolylineColorAppearance",["../Core/defaultValue","../Core/defineProperties","../Core/VertexFormat","../Shaders/Appearances/PerInstanceFlatColorAppearanceFS","../Shaders/Appearances/PolylineColorAppearanceVS","../Shaders/PolylineCommon","./Appearance"],function(e,t,r,i,n,a,o){"use strict";var s=a+"\n"+n;var u=i;function l(t){t=e(t,e.EMPTY_OBJECT);var r=e(t.translucent,true);var i=false;var n=l.VERTEX_FORMAT;this.material=undefined;this.translucent=r;this._vertexShaderSource=e(t.vertexShaderSource,s);this._fragmentShaderSource=e(t.fragmentShaderSource,u);this._renderState=o.getDefaultRenderState(r,i,t.renderState);this._closed=i;this._vertexFormat=n}t(l.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},vertexFormat:{get:function(){return this._vertexFormat}}});l.VERTEX_FORMAT=r.POSITION_ONLY;l.prototype.getFragmentShaderSource=o.prototype.getFragmentShaderSource;l.prototype.isTranslucent=o.prototype.isTranslucent;l.prototype.getRenderState=o.prototype.getRenderState;return l});define("Shaders/Appearances/PolylineMaterialAppearanceVS",[],function(){"use strict";return"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec3 prevPosition3DHigh;\nattribute vec3 prevPosition3DLow;\nattribute vec3 nextPosition3DHigh;\nattribute vec3 nextPosition3DLow;\nattribute vec2 expandAndWidth;\nattribute vec2 st;\nattribute float batchId;\nvarying float v_width;\nvarying vec2 v_st;\nvoid main()\n{\nfloat expandDir = expandAndWidth.x;\nfloat width = abs(expandAndWidth.y) + 0.5;\nbool usePrev = expandAndWidth.y < 0.0;\nvec4 p = czm_computePosition();\nvec4 prev = czm_computePrevPosition();\nvec4 next = czm_computeNextPosition();\nv_width = width;\nv_st = st;\nvec4 positionWC = getPolylineWindowCoordinates(p, prev, next, expandDir, width, usePrev);\ngl_Position = czm_viewportOrthographic * positionWC;\n}\n"});define("Scene/PolylineMaterialAppearance",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/VertexFormat","../Shaders/Appearances/PolylineMaterialAppearanceVS","../Shaders/PolylineCommon","../Shaders/PolylineFS","./Appearance","./Material"],function(e,t,r,i,n,a,o,s,u){"use strict";var l=a+"\n"+n;var c=o;function d(r){r=e(r,e.EMPTY_OBJECT);var i=e(r.translucent,true);var n=false;var a=d.VERTEX_FORMAT;this.material=t(r.material)?r.material:u.fromType(u.ColorType);this.translucent=i;this._vertexShaderSource=e(r.vertexShaderSource,l);this._fragmentShaderSource=e(r.fragmentShaderSource,c);this._renderState=s.getDefaultRenderState(i,n,r.renderState);this._closed=n;this._vertexFormat=a}r(d.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},vertexFormat:{get:function(){return this._vertexFormat}}});d.VERTEX_FORMAT=i.POSITION_AND_ST;d.prototype.getFragmentShaderSource=s.prototype.getFragmentShaderSource;d.prototype.isTranslucent=s.prototype.isTranslucent;d.prototype.getRenderState=s.prototype.getRenderState;return d});define("DataSources/PolylineGeometryUpdater",["../Core/BoundingSphere","../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/Event","../Core/GeometryInstance","../Core/Iso8601","../Core/PolylineGeometry","../Core/PolylinePipeline","../Core/ShowGeometryInstanceAttribute","../Scene/PolylineCollection","../Scene/PolylineColorAppearance","../Scene/PolylineMaterialAppearance","../Scene/ShadowMode","./BoundingSphereState","./ColorMaterialProperty","./ConstantProperty","./MaterialProperty","./Property"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w,C,b,S,E){"use strict";var T={};var x=new C(t.WHITE);var A=new b(true);var P=new b(y.DISABLED);var D=new b(new u);function M(e){this.id=e;this.vertexFormat=undefined;this.positions=undefined;this.width=undefined;this.followSurface=undefined;this.granularity=undefined}function I(e,t){if(!n(e)){throw new s("entity is required")}if(!n(t)){throw new s("scene is required")}this._entity=e;this._scene=t;this._entitySubscription=e.definitionChanged.addEventListener(I.prototype._onEntityPropertyChanged,this);this._fillEnabled=false;this._dynamic=false;this._geometryChanged=new c;this._showProperty=undefined;this._materialProperty=undefined;this._shadowsProperty=undefined;this._distanceDisplayConditionProperty=undefined;this._options=new M(e);this._onEntityPropertyChanged(e,"polyline",e.polyline,undefined)}a(I,{perInstanceColorAppearanceType:{value:_},materialAppearanceType:{value:g}});a(I.prototype,{entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!n(this._entity.availability)&&E.isConstant(this._showProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},outlineEnabled:{value:false},hasConstantOutline:{value:true},outlineColorProperty:{value:undefined},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayConditionProperty}},isDynamic:{get:function(){return this._dynamic}},isClosed:{value:false},geometryChanged:{get:function(){return this._geometryChanged}}});I.prototype.isOutlineVisible=function(e){return false};I.prototype.isFilled=function(e){var t=this._entity;return this._fillEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)};I.prototype.createFillGeometryInstance=function(e){if(!n(e)){throw new s("time is required.")}if(!this._fillEnabled){throw new s("This instance does not represent a filled geometry.")}var i;var a;var o=this._entity;var u=o.isAvailable(e);var c=new m(u&&o.isShowing&&this._showProperty.getValue(e));var f=this._distanceDisplayConditionProperty.getValue(e);var p=l.fromDistanceDisplayCondition(f);if(this._materialProperty instanceof C){var v=t.WHITE;if(n(this._materialProperty.color)&&(this._materialProperty.color.isConstant||u)){v=this._materialProperty.color.getValue(e)}i=r.fromColor(v);a={show:c,distanceDisplayCondition:p,color:i}}else{a={show:c,distanceDisplayCondition:p}}return new d({id:o,geometry:new h(this._options),attributes:a})};I.prototype.createOutlineGeometryInstance=function(e){throw new s("This instance does not represent an outlined geometry.")};I.prototype.isDestroyed=function(){return false};I.prototype.destroy=function(){this._entitySubscription();o(this)};I.prototype._onEntityPropertyChanged=function(e,t,r,a){if(!(t==="availability"||t==="polyline")){return}var o=this._entity.polyline;if(!n(o)){if(this._fillEnabled){this._fillEnabled=false;this._geometryChanged.raiseEvent(this)}return}var s=o.positions;var u=o.show;if(n(u)&&u.isConstant&&!u.getValue(f.MINIMUM_VALUE)||!n(s)){if(this._fillEnabled){this._fillEnabled=false;this._geometryChanged.raiseEvent(this)}return}var l=i(o.material,x);var c=l instanceof C;this._materialProperty=l;this._showProperty=i(u,A);this._shadowsProperty=i(o.shadows,P);this._distanceDisplayConditionProperty=i(o.distanceDisplayCondition,D);this._fillEnabled=true;var d=o.width;var h=o.followSurface;var p=o.granularity;if(!s.isConstant||!E.isConstant(d)||!E.isConstant(h)||!E.isConstant(p)){if(!this._dynamic){this._dynamic=true;this._geometryChanged.raiseEvent(this)}}else{var m=this._options;var v=s.getValue(f.MINIMUM_VALUE,m.positions);if(!n(v)||v.length<2){if(this._fillEnabled){this._fillEnabled=false;this._geometryChanged.raiseEvent(this)}return}m.vertexFormat=c?_.VERTEX_FORMAT:g.VERTEX_FORMAT;m.positions=v;m.width=n(d)?d.getValue(f.MINIMUM_VALUE):undefined;m.followSurface=n(h)?h.getValue(f.MINIMUM_VALUE):undefined;m.granularity=n(p)?p.getValue(f.MINIMUM_VALUE):undefined;this._dynamic=false;this._geometryChanged.raiseEvent(this)}};I.prototype.createDynamicUpdater=function(e){if(!this._dynamic){throw new s("This instance does not represent dynamic geometry.")}if(!n(e)){throw new s("primitives is required.")}return new R(e,this)};var O={positions:undefined,granularity:undefined,height:undefined,ellipsoid:undefined};function R(e,t){var r=t._scene.id;var i=T[r];if(!n(i)||i.isDestroyed()){i=new v;T[r]=i;e.add(i)}else if(!e.contains(i)){e.add(i)}var a=i.add();a.id=t._entity;this._line=a;this._primitives=e;this._geometryUpdater=t;this._positions=[];O.ellipsoid=t._scene.globe.ellipsoid}R.prototype.update=function(e){var t=this._geometryUpdater;var r=t._entity;var i=r.polyline;var a=this._line;if(!r.isShowing||!r.isAvailable(e)||!E.getValueOrDefault(i._show,e,true)){a.show=false;return}var o=i.positions;var s=E.getValueOrUndefined(o,e,this._positions);if(!n(s)||s.length<2){a.show=false;return}var u=E.getValueOrDefault(i._followSurface,e,true);if(u){O.positions=s;O.granularity=E.getValueOrUndefined(i._granularity,e);O.height=p.extractHeights(s,this._geometryUpdater._scene.globe.ellipsoid);s=p.generateCartesianArc(O)}a.show=true;a.positions=s.slice();a.material=S.getValue(e,t.fillMaterialProperty,a.material);a.width=E.getValueOrDefault(i._width,e,1);a.distanceDisplayCondition=E.getValueOrUndefined(i._distanceDisplayCondition,e,a.distanceDisplayCondition)};R.prototype.getBoundingSphere=function(t,r){if(!n(t)){throw new s("entity is required.")}if(!n(r)){throw new s("result is required.")}var i=this._line;if(i.show&&i.positions.length>0){e.fromPoints(i.positions,r);return w.DONE}return w.FAILED};R.prototype.isDestroyed=function(){return false};R.prototype.destroy=function(){var e=this._geometryUpdater;var t=e._scene.id;var r=T[t];r.remove(this._line);if(r.length===0){this._primitives.removeAndDestroy(r);delete T[t]}o(this)};return I});define("DataSources/PolylineVolumeGeometryUpdater",["../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/Event","../Core/GeometryInstance","../Core/Iso8601","../Core/PolylineVolumeGeometry","../Core/PolylineVolumeOutlineGeometry","../Core/ShowGeometryInstanceAttribute","../Scene/MaterialAppearance","../Scene/PerInstanceColorAppearance","../Scene/Primitive","../Scene/ShadowMode","./ColorMaterialProperty","./ConstantProperty","./dynamicGeometryGetBoundingSphere","./MaterialProperty","./Property"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w,C,b,S){"use strict";var E=new y(e.WHITE);var T=new w(true);var x=new w(true);var A=new w(false);var P=new w(e.BLACK);var D=new w(g.DISABLED);var M=new w(new s);var I=new e;function O(e){this.id=e;this.vertexFormat=undefined;this.polylinePositions=undefined;this.shapePositions=undefined;this.cornerType=undefined;this.granularity=undefined}function R(e,t){if(!i(e)){throw new o("entity is required")}if(!i(t)){throw new o("scene is required")}this._entity=e;this._scene=t;this._entitySubscription=e.definitionChanged.addEventListener(R.prototype._onEntityPropertyChanged,this);this._fillEnabled=false;this._dynamic=false;this._outlineEnabled=false;this._geometryChanged=new l;this._showProperty=undefined;this._materialProperty=undefined;this._hasConstantOutline=true;this._showOutlineProperty=undefined;this._outlineColorProperty=undefined;this._outlineWidth=1;this._shadowsProperty=undefined;this._distanceDisplayConditionProperty=undefined;this._options=new O(e);this._onEntityPropertyChanged(e,"polylineVolume",e.polylineVolume,undefined)}n(R,{perInstanceColorAppearanceType:{value:v},materialAppearanceType:{value:m}});n(R.prototype,{entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!i(this._entity.availability)&&S.isConstant(this._showProperty)&&S.isConstant(this._fillProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},outlineEnabled:{get:function(){return this._outlineEnabled}},hasConstantOutline:{get:function(){return!this._outlineEnabled||!i(this._entity.availability)&&S.isConstant(this._showProperty)&&S.isConstant(this._showOutlineProperty)}},outlineColorProperty:{get:function(){return this._outlineColorProperty}},outlineWidth:{get:function(){return this._outlineWidth}},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayConditionProperty}},isDynamic:{get:function(){return this._dynamic}},isClosed:{value:true},geometryChanged:{get:function(){return this._geometryChanged}}});R.prototype.isOutlineVisible=function(e){var t=this._entity;return this._outlineEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)};R.prototype.isFilled=function(e){var t=this._entity;return this._fillEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)};R.prototype.createFillGeometryInstance=function(r){if(!i(r)){throw new o("time is required.")}if(!this._fillEnabled){throw new o("This instance does not represent a filled geometry.")}var n=this._entity;var a=n.isAvailable(r);var s;var l;var d=new p(a&&n.isShowing&&this._showProperty.getValue(r)&&this._fillProperty.getValue(r));var h=this._distanceDisplayConditionProperty.getValue(r);var m=u.fromDistanceDisplayCondition(h);if(this._materialProperty instanceof y){var v=e.WHITE;if(i(this._materialProperty.color)&&(this._materialProperty.color.isConstant||a)){v=this._materialProperty.color.getValue(r)}l=t.fromColor(v);s={show:d,distanceDisplayCondition:m,color:l}}else{s={show:d,distanceDisplayCondition:m}}return new c({id:n,geometry:new f(this._options),attributes:s})};R.prototype.createOutlineGeometryInstance=function(r){if(!i(r)){throw new o("time is required.")}if(!this._outlineEnabled){throw new o("This instance does not represent an outlined geometry.")}var n=this._entity;var a=n.isAvailable(r);var s=S.getValueOrDefault(this._outlineColorProperty,r,e.BLACK);var l=this._distanceDisplayConditionProperty.getValue(r);return new c({id:n,geometry:new h(this._options),attributes:{show:new p(a&&n.isShowing&&this._showProperty.getValue(r)&&this._showOutlineProperty.getValue(r)),color:t.fromColor(s),distanceDisplayCondition:u.fromDistanceDisplayCondition(l)}})};R.prototype.isDestroyed=function(){return false};R.prototype.destroy=function(){this._entitySubscription();a(this)};R.prototype._onEntityPropertyChanged=function(e,t,n,a){if(!(t==="availability"||t==="polylineVolume")){return}var o=this._entity.polylineVolume;if(!i(o)){if(this._fillEnabled||this._outlineEnabled){this._fillEnabled=false;this._outlineEnabled=false;this._geometryChanged.raiseEvent(this)}return}var s=o.fill;var u=i(s)&&s.isConstant?s.getValue(d.MINIMUM_VALUE):true;var l=o.outline;var c=i(l);if(c&&l.isConstant){c=l.getValue(d.MINIMUM_VALUE)}if(!u&&!c){if(this._fillEnabled||this._outlineEnabled){this._fillEnabled=false;this._outlineEnabled=false;this._geometryChanged.raiseEvent(this)}return}var f=o.positions;var h=o.shape;var p=o.show;if(!i(f)||!i(h)||i(p)&&p.isConstant&&!p.getValue(d.MINIMUM_VALUE)){if(this._fillEnabled||this._outlineEnabled){this._fillEnabled=false;this._outlineEnabled=false;this._geometryChanged.raiseEvent(this)}return}var _=r(o.material,E);var g=_ instanceof y;this._materialProperty=_;this._fillProperty=r(s,x);this._showProperty=r(p,T);this._showOutlineProperty=r(o.outline,A);this._outlineColorProperty=c?r(o.outlineColor,P):undefined;this._shadowsProperty=r(o.shadows,D);this._distanceDisplayConditionProperty=r(o.distanceDisplayCondition,M);var w=o.granularity;var C=o.outlineWidth;var b=o.cornerType;this._fillEnabled=u;this._outlineEnabled=c;if(!f.isConstant||!h.isConstant||!S.isConstant(w)||!S.isConstant(C)||!S.isConstant(b)){if(!this._dynamic){this._dynamic=true;this._geometryChanged.raiseEvent(this)}}else{var I=this._options;I.vertexFormat=g?v.VERTEX_FORMAT:m.MaterialSupport.TEXTURED.vertexFormat;I.polylinePositions=f.getValue(d.MINIMUM_VALUE,I.polylinePositions);I.shapePositions=h.getValue(d.MINIMUM_VALUE,I.shape);I.granularity=i(w)?w.getValue(d.MINIMUM_VALUE):undefined;I.cornerType=i(b)?b.getValue(d.MINIMUM_VALUE):undefined;this._outlineWidth=i(C)?C.getValue(d.MINIMUM_VALUE):1;this._dynamic=false;this._geometryChanged.raiseEvent(this)}};R.prototype.createDynamicUpdater=function(e){if(!this._dynamic){throw new o("This instance does not represent dynamic geometry.")}if(!i(e)){throw new o("primitives is required.")}return new N(e,this)};function N(e,t){this._primitives=e;this._primitive=undefined;this._outlinePrimitive=undefined;this._geometryUpdater=t;this._options=new O(t._entity)}N.prototype.update=function(r){if(!i(r)){throw new o("time is required.")}var n=this._primitives;n.removeAndDestroy(this._primitive);n.removeAndDestroy(this._outlinePrimitive);this._primitive=undefined;this._outlinePrimitive=undefined;var a=this._geometryUpdater;var s=a._entity;var u=s.polylineVolume;if(!s.isShowing||!s.isAvailable(r)||!S.getValueOrDefault(u.show,r,true)){return}var l=this._options;var d=S.getValueOrUndefined(u.positions,r,l.polylinePositions);var p=S.getValueOrUndefined(u.shape,r);if(!i(d)||!i(p)){return}l.polylinePositions=d;l.shapePositions=p;l.granularity=S.getValueOrUndefined(u.granularity,r);l.cornerType=S.getValueOrUndefined(u.cornerType,r);var g=this._geometryUpdater.shadowsProperty.getValue(r);if(!i(u.fill)||u.fill.getValue(r)){var y=b.getValue(r,a.fillMaterialProperty,this._material);this._material=y;var w=new m({material:y,translucent:y.isTranslucent(),closed:true});l.vertexFormat=w.vertexFormat;this._primitive=n.add(new _({geometryInstances:new c({id:s,geometry:new f(l)}),appearance:w,asynchronous:false,shadows:g}))}if(i(u.outline)&&u.outline.getValue(r)){l.vertexFormat=v.VERTEX_FORMAT;var C=S.getValueOrClonedDefault(u.outlineColor,r,e.BLACK,I);var E=S.getValueOrDefault(u.outlineWidth,r,1);var T=C.alpha!==1;this._outlinePrimitive=n.add(new _({geometryInstances:new c({id:s,geometry:new h(l),attributes:{color:t.fromColor(C)}}),appearance:new v({flat:true,translucent:T,renderState:{lineWidth:a._scene.clampLineWidth(E)}}),asynchronous:false,shadows:g}))}};N.prototype.getBoundingSphere=function(e,t){return C(e,this._primitive,this._outlinePrimitive,t)};N.prototype.isDestroyed=function(){return false};N.prototype.destroy=function(){var e=this._primitives;e.removeAndDestroy(this._primitive);e.removeAndDestroy(this._outlinePrimitive);a(this)};return R});define("DataSources/RectangleGeometryUpdater",["../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/Event","../Core/GeometryInstance","../Core/Iso8601","../Core/oneTimeWarning","../Core/RectangleGeometry","../Core/RectangleOutlineGeometry","../Core/ShowGeometryInstanceAttribute","../Scene/GroundPrimitive","../Scene/MaterialAppearance","../Scene/PerInstanceColorAppearance","../Scene/Primitive","../Scene/ShadowMode","./ColorMaterialProperty","./ConstantProperty","./dynamicGeometryGetBoundingSphere","./MaterialProperty","./Property"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w,C,b,S,E,T){"use strict";var x=new C(e.WHITE);var A=new b(true);var P=new b(true);var D=new b(false);var M=new b(e.BLACK);var I=new b(w.DISABLED);var O=new b(new s);var R=new e;function N(e){this.id=e;this.vertexFormat=undefined;this.rectangle=undefined;this.closeBottom=undefined;this.closeTop=undefined;this.height=undefined;this.extrudedHeight=undefined;this.granularity=undefined;this.stRotation=undefined;this.rotation=undefined}function L(e,t){if(!i(e)){throw new o("entity is required")}if(!i(t)){throw new o("scene is required")}this._entity=e;this._scene=t;this._entitySubscription=e.definitionChanged.addEventListener(L.prototype._onEntityPropertyChanged,this);this._fillEnabled=false;this._isClosed=false;this._dynamic=false;this._outlineEnabled=false;this._geometryChanged=new l;this._showProperty=undefined;this._materialProperty=undefined;this._hasConstantOutline=true;this._showOutlineProperty=undefined;this._outlineColorProperty=undefined;this._outlineWidth=1;this._shadowsProperty=undefined;this._distanceDisplayConditionProperty=undefined;this._onTerrain=false;this._options=new N(e);this._onEntityPropertyChanged(e,"rectangle",e.rectangle,undefined)}n(L,{perInstanceColorAppearanceType:{value:g},materialAppearanceType:{value:_}});n(L.prototype,{entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!i(this._entity.availability)&&T.isConstant(this._showProperty)&&T.isConstant(this._fillProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},outlineEnabled:{get:function(){return this._outlineEnabled}},hasConstantOutline:{get:function(){return!this._outlineEnabled||!i(this._entity.availability)&&T.isConstant(this._showProperty)&&T.isConstant(this._showOutlineProperty)}},outlineColorProperty:{get:function(){return this._outlineColorProperty}},outlineWidth:{get:function(){return this._outlineWidth}},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayConditionProperty}},isDynamic:{get:function(){return this._dynamic}},isClosed:{get:function(){return this._isClosed}},onTerrain:{get:function(){return this._onTerrain}},geometryChanged:{get:function(){return this._geometryChanged}}});L.prototype.isOutlineVisible=function(e){var t=this._entity;return this._outlineEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)};L.prototype.isFilled=function(e){var t=this._entity;return this._fillEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)};L.prototype.createFillGeometryInstance=function(r){if(!i(r)){throw new o("time is required.")}if(!this._fillEnabled){throw new o("This instance does not represent a filled geometry.")}var n=this._entity;var a=n.isAvailable(r);var s;var l;var d=new m(a&&n.isShowing&&this._showProperty.getValue(r)&&this._fillProperty.getValue(r));var f=this._distanceDisplayConditionProperty.getValue(r);var p=u.fromDistanceDisplayCondition(f);if(this._materialProperty instanceof C){var v=e.WHITE;if(i(this._materialProperty.color)&&(this._materialProperty.color.isConstant||a)){v=this._materialProperty.color.getValue(r)}l=t.fromColor(v);s={show:d,distanceDisplayCondition:p,color:l}}else{s={show:d,distanceDisplayCondition:p}}return new c({id:n,geometry:new h(this._options),attributes:s})};L.prototype.createOutlineGeometryInstance=function(r){if(!i(r)){throw new o("time is required.")}if(!this._outlineEnabled){throw new o("This instance does not represent an outlined geometry.")}var n=this._entity;var a=n.isAvailable(r);var s=T.getValueOrDefault(this._outlineColorProperty,r,e.BLACK);var l=this._distanceDisplayConditionProperty.getValue(r);return new c({id:n,geometry:new p(this._options),attributes:{show:new m(a&&n.isShowing&&this._showProperty.getValue(r)&&this._showOutlineProperty.getValue(r)),color:t.fromColor(s),distanceDisplayCondition:u.fromDistanceDisplayCondition(l)}})};L.prototype.isDestroyed=function(){return false};L.prototype.destroy=function(){this._entitySubscription();a(this)};L.prototype._onEntityPropertyChanged=function(e,t,n,a){if(!(t==="availability"||t==="rectangle")){return}var o=this._entity.rectangle;if(!i(o)){if(this._fillEnabled||this._outlineEnabled){this._fillEnabled=false;this._outlineEnabled=false;this._geometryChanged.raiseEvent(this)}return}var s=o.fill;var u=i(s)&&s.isConstant?s.getValue(d.MINIMUM_VALUE):true;var l=o.outline;var c=i(l);if(c&&l.isConstant){c=l.getValue(d.MINIMUM_VALUE)}if(!u&&!c){if(this._fillEnabled||this._outlineEnabled){this._fillEnabled=false;this._outlineEnabled=false;this._geometryChanged.raiseEvent(this)}return}var h=o.coordinates;var p=o.show;if(i(p)&&p.isConstant&&!p.getValue(d.MINIMUM_VALUE)||!i(h)){if(this._fillEnabled||this._outlineEnabled){this._fillEnabled=false;this._outlineEnabled=false;this._geometryChanged.raiseEvent(this)}return}var m=r(o.material,x);var y=m instanceof C;this._materialProperty=m;this._fillProperty=r(s,P);this._showProperty=r(p,A);this._showOutlineProperty=r(o.outline,D);this._outlineColorProperty=c?r(o.outlineColor,M):undefined;this._shadowsProperty=r(o.shadows,I);this._distanceDisplayConditionProperty=r(o.distanceDisplayCondition,O);var w=o.height;var b=o.extrudedHeight;var S=o.granularity;var E=o.stRotation;var R=o.rotation;var N=o.outlineWidth;var L=o.closeBottom;var B=o.closeTop;var F=u&&!i(w)&&!i(b)&&y&&v.isSupported(this._scene);if(c&&F){f(f.geometryOutlines);c=false}this._fillEnabled=u;this._onTerrain=F;this._outlineEnabled=c;if(!h.isConstant||!T.isConstant(w)||!T.isConstant(b)||!T.isConstant(S)||!T.isConstant(E)||!T.isConstant(R)||!T.isConstant(N)||!T.isConstant(L)||!T.isConstant(B)||F&&!T.isConstant(m)){if(!this._dynamic){this._dynamic=true;this._geometryChanged.raiseEvent(this)}}else{var k=this._options;k.vertexFormat=y?g.VERTEX_FORMAT:_.MaterialSupport.TEXTURED.vertexFormat;k.rectangle=h.getValue(d.MINIMUM_VALUE,k.rectangle);k.height=i(w)?w.getValue(d.MINIMUM_VALUE):undefined;k.extrudedHeight=i(b)?b.getValue(d.MINIMUM_VALUE):undefined;k.granularity=i(S)?S.getValue(d.MINIMUM_VALUE):undefined;k.stRotation=i(E)?E.getValue(d.MINIMUM_VALUE):undefined;k.rotation=i(R)?R.getValue(d.MINIMUM_VALUE):undefined;k.closeBottom=i(L)?L.getValue(d.MINIMUM_VALUE):undefined;k.closeTop=i(B)?B.getValue(d.MINIMUM_VALUE):undefined;this._isClosed=i(b)&&i(k.closeTop)&&i(k.closeBottom)&&k.closeTop&&k.closeBottom;this._outlineWidth=i(N)?N.getValue(d.MINIMUM_VALUE):1;this._dynamic=false;this._geometryChanged.raiseEvent(this)}};L.prototype.createDynamicUpdater=function(e,t){if(!this._dynamic){throw new o("This instance does not represent dynamic geometry.")}if(!i(e)){throw new o("primitives is required.")}return new B(e,t,this)};function B(e,t,r){this._primitives=e;this._groundPrimitives=t;this._primitive=undefined;this._outlinePrimitive=undefined;this._geometryUpdater=r;this._options=new N(r._entity)}B.prototype.update=function(r){if(!i(r)){throw new o("time is required.")}var n=this._geometryUpdater;var a=n._onTerrain;var s=this._primitives;var u=this._groundPrimitives;if(a){u.removeAndDestroy(this._primitive)}else{s.removeAndDestroy(this._primitive);s.removeAndDestroy(this._outlinePrimitive);this._outlinePrimitive=undefined}this._primitive=undefined;var l=n._entity;var d=l.rectangle;if(!l.isShowing||!l.isAvailable(r)||!T.getValueOrDefault(d.show,r,true)){return}var f=this._options;var m=T.getValueOrUndefined(d.coordinates,r,f.rectangle);if(!i(m)){return}f.rectangle=m;f.height=T.getValueOrUndefined(d.height,r);f.extrudedHeight=T.getValueOrUndefined(d.extrudedHeight,r);f.granularity=T.getValueOrUndefined(d.granularity,r);f.stRotation=T.getValueOrUndefined(d.stRotation,r);f.rotation=T.getValueOrUndefined(d.rotation,r);f.closeBottom=T.getValueOrUndefined(d.closeBottom,r);f.closeTop=T.getValueOrUndefined(d.closeTop,r);var w=this._geometryUpdater.shadowsProperty.getValue(r);if(T.getValueOrDefault(d.fill,r,true)){var C=n.fillMaterialProperty;var b=E.getValue(r,C,this._material);this._material=b;if(a){var S=e.WHITE;if(i(C.color)){S=C.color.getValue(r)}this._primitive=u.add(new v({geometryInstances:new c({id:l,geometry:new h(f),attributes:{color:t.fromColor(S)}}),asynchronous:false,shadows:w}))}else{var x=new _({material:b,translucent:b.isTranslucent(),closed:i(f.extrudedHeight)});f.vertexFormat=x.vertexFormat;this._primitive=s.add(new y({geometryInstances:new c({id:l,geometry:new h(f)}),appearance:x,asynchronous:false,shadows:w}))}}if(!a&&T.getValueOrDefault(d.outline,r,false)){f.vertexFormat=g.VERTEX_FORMAT;var A=T.getValueOrClonedDefault(d.outlineColor,r,e.BLACK,R);var P=T.getValueOrDefault(d.outlineWidth,r,1);var D=A.alpha!==1;this._outlinePrimitive=s.add(new y({geometryInstances:new c({id:l,geometry:new p(f),attributes:{color:t.fromColor(A)}}),appearance:new g({flat:true,translucent:D,renderState:{lineWidth:n._scene.clampLineWidth(P)}}),asynchronous:false,shadows:w}))}};B.prototype.getBoundingSphere=function(e,t){return S(e,this._primitive,this._outlinePrimitive,t)};B.prototype.isDestroyed=function(){return false};B.prototype.destroy=function(){var e=this._primitives;var t=this._groundPrimitives;if(this._geometryUpdater._onTerrain){t.removeAndDestroy(this._primitive)}else{e.removeAndDestroy(this._primitive)}e.removeAndDestroy(this._outlinePrimitive);a(this)};return L});define("DataSources/WallGeometryUpdater",["../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/Event","../Core/GeometryInstance","../Core/Iso8601","../Core/ShowGeometryInstanceAttribute","../Core/WallGeometry","../Core/WallOutlineGeometry","../Scene/MaterialAppearance","../Scene/PerInstanceColorAppearance","../Scene/Primitive","../Scene/ShadowMode","./ColorMaterialProperty","./ConstantProperty","./dynamicGeometryGetBoundingSphere","./MaterialProperty","./Property"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w,C,b,S){"use strict";var E=new y(e.WHITE);var T=new w(true);var x=new w(true);var A=new w(false);var P=new w(e.BLACK);var D=new w(g.DISABLED);var M=new w(new s);var I=new e;function O(e){this.id=e;this.vertexFormat=undefined;this.positions=undefined;this.minimumHeights=undefined;this.maximumHeights=undefined;this.granularity=undefined}function R(e,t){if(!i(e)){throw new o("entity is required")}if(!i(t)){throw new o("scene is required")}this._entity=e;this._scene=t
;this._entitySubscription=e.definitionChanged.addEventListener(R.prototype._onEntityPropertyChanged,this);this._fillEnabled=false;this._dynamic=false;this._outlineEnabled=false;this._geometryChanged=new l;this._showProperty=undefined;this._materialProperty=undefined;this._hasConstantOutline=true;this._showOutlineProperty=undefined;this._outlineColorProperty=undefined;this._outlineWidth=1;this._shadowsProperty=undefined;this._distanceDisplayConditionProperty=undefined;this._options=new O(e);this._onEntityPropertyChanged(e,"wall",e.wall,undefined)}n(R,{perInstanceColorAppearanceType:{value:v},materialAppearanceType:{value:m}});n(R.prototype,{entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!i(this._entity.availability)&&S.isConstant(this._showProperty)&&S.isConstant(this._fillProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},outlineEnabled:{get:function(){return this._outlineEnabled}},hasConstantOutline:{get:function(){return!this._outlineEnabled||!i(this._entity.availability)&&S.isConstant(this._showProperty)&&S.isConstant(this._showOutlineProperty)}},outlineColorProperty:{get:function(){return this._outlineColorProperty}},outlineWidth:{get:function(){return this._outlineWidth}},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayConditionProperty}},isDynamic:{get:function(){return this._dynamic}},isClosed:{get:function(){return false}},geometryChanged:{get:function(){return this._geometryChanged}}});R.prototype.isOutlineVisible=function(e){var t=this._entity;return this._outlineEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)};R.prototype.isFilled=function(e){var t=this._entity;return this._fillEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)};R.prototype.createFillGeometryInstance=function(r){if(!i(r)){throw new o("time is required.")}if(!this._fillEnabled){throw new o("This instance does not represent a filled geometry.")}var n=this._entity;var a=n.isAvailable(r);var s;var l;var d=new f(a&&n.isShowing&&this._showProperty.getValue(r)&&this._fillProperty.getValue(r));var p=this._distanceDisplayConditionProperty.getValue(r);var m=u.fromDistanceDisplayCondition(p);if(this._materialProperty instanceof y){var v=e.WHITE;if(i(this._materialProperty.color)&&(this._materialProperty.color.isConstant||a)){v=this._materialProperty.color.getValue(r)}l=t.fromColor(v);s={show:d,distanceDisplayCondition:m,color:l}}else{s={show:d,distanceDisplayCondition:m}}return new c({id:n,geometry:new h(this._options),attributes:s})};R.prototype.createOutlineGeometryInstance=function(r){if(!i(r)){throw new o("time is required.")}if(!this._outlineEnabled){throw new o("This instance does not represent an outlined geometry.")}var n=this._entity;var a=n.isAvailable(r);var s=S.getValueOrDefault(this._outlineColorProperty,r,e.BLACK);var l=this._distanceDisplayConditionProperty.getValue(r);return new c({id:n,geometry:new p(this._options),attributes:{show:new f(a&&n.isShowing&&this._showProperty.getValue(r)&&this._showOutlineProperty.getValue(r)),color:t.fromColor(s),distanceDisplayCondition:u.fromDistanceDisplayCondition(l)}})};R.prototype.isDestroyed=function(){return false};R.prototype.destroy=function(){this._entitySubscription();a(this)};R.prototype._onEntityPropertyChanged=function(e,t,n,a){if(!(t==="availability"||t==="wall")){return}var o=this._entity.wall;if(!i(o)){if(this._fillEnabled||this._outlineEnabled){this._fillEnabled=false;this._outlineEnabled=false;this._geometryChanged.raiseEvent(this)}return}var s=o.fill;var u=i(s)&&s.isConstant?s.getValue(d.MINIMUM_VALUE):true;var l=o.outline;var c=i(l);if(c&&l.isConstant){c=l.getValue(d.MINIMUM_VALUE)}if(!u&&!c){if(this._fillEnabled||this._outlineEnabled){this._fillEnabled=false;this._outlineEnabled=false;this._geometryChanged.raiseEvent(this)}return}var f=o.positions;var h=o.show;if(i(h)&&h.isConstant&&!h.getValue(d.MINIMUM_VALUE)||!i(f)){if(this._fillEnabled||this._outlineEnabled){this._fillEnabled=false;this._outlineEnabled=false;this._geometryChanged.raiseEvent(this)}return}var p=r(o.material,E);var _=p instanceof y;this._materialProperty=p;this._fillProperty=r(s,x);this._showProperty=r(h,T);this._showOutlineProperty=r(o.outline,A);this._outlineColorProperty=c?r(o.outlineColor,P):undefined;this._shadowsProperty=r(o.shadows,D);this._distanceDisplayConditionProperty=r(o.distanceDisplayCondition,M);var g=o.minimumHeights;var w=o.maximumHeights;var C=o.outlineWidth;var b=o.granularity;this._fillEnabled=u;this._outlineEnabled=c;if(!f.isConstant||!S.isConstant(g)||!S.isConstant(w)||!S.isConstant(C)||!S.isConstant(b)){if(!this._dynamic){this._dynamic=true;this._geometryChanged.raiseEvent(this)}}else{var I=this._options;I.vertexFormat=_?v.VERTEX_FORMAT:m.MaterialSupport.TEXTURED.vertexFormat;I.positions=f.getValue(d.MINIMUM_VALUE,I.positions);I.minimumHeights=i(g)?g.getValue(d.MINIMUM_VALUE,I.minimumHeights):undefined;I.maximumHeights=i(w)?w.getValue(d.MINIMUM_VALUE,I.maximumHeights):undefined;I.granularity=i(b)?b.getValue(d.MINIMUM_VALUE):undefined;this._outlineWidth=i(C)?C.getValue(d.MINIMUM_VALUE):1;this._dynamic=false;this._geometryChanged.raiseEvent(this)}};R.prototype.createDynamicUpdater=function(e){if(!this._dynamic){throw new o("This instance does not represent dynamic geometry.")}if(!i(e)){throw new o("primitives is required.")}return new N(e,this)};function N(e,t){this._primitives=e;this._primitive=undefined;this._outlinePrimitive=undefined;this._geometryUpdater=t;this._options=new O(t._entity)}N.prototype.update=function(r){if(!i(r)){throw new o("time is required.")}var n=this._primitives;n.removeAndDestroy(this._primitive);n.removeAndDestroy(this._outlinePrimitive);this._primitive=undefined;this._outlinePrimitive=undefined;var a=this._geometryUpdater;var s=a._entity;var u=s.wall;if(!s.isShowing||!s.isAvailable(r)||!S.getValueOrDefault(u.show,r,true)){return}var l=this._options;var d=S.getValueOrUndefined(u.positions,r,l.positions);if(!i(d)){return}l.positions=d;l.minimumHeights=S.getValueOrUndefined(u.minimumHeights,r,l.minimumHeights);l.maximumHeights=S.getValueOrUndefined(u.maximumHeights,r,l.maximumHeights);l.granularity=S.getValueOrUndefined(u.granularity,r);var f=this._geometryUpdater.shadowsProperty.getValue(r);if(S.getValueOrDefault(u.fill,r,true)){var g=b.getValue(r,a.fillMaterialProperty,this._material);this._material=g;var y=new m({material:g,translucent:g.isTranslucent(),closed:i(l.extrudedHeight)});l.vertexFormat=y.vertexFormat;this._primitive=n.add(new _({geometryInstances:new c({id:s,geometry:new h(l)}),appearance:y,asynchronous:false,shadows:f}))}if(S.getValueOrDefault(u.outline,r,false)){l.vertexFormat=v.VERTEX_FORMAT;var w=S.getValueOrClonedDefault(u.outlineColor,r,e.BLACK,I);var C=S.getValueOrDefault(u.outlineWidth,r,1);var E=w.alpha!==1;this._outlinePrimitive=n.add(new _({geometryInstances:new c({id:s,geometry:new p(l),attributes:{color:t.fromColor(w)}}),appearance:new v({flat:true,translucent:E,renderState:{lineWidth:a._scene.clampLineWidth(C)}}),asynchronous:false,shadows:f}))}};N.prototype.getBoundingSphere=function(e,t){return C(e,this._primitive,this._outlinePrimitive,t)};N.prototype.isDestroyed=function(){return false};N.prototype.destroy=function(){var e=this._primitives;e.removeAndDestroy(this._primitive);e.removeAndDestroy(this._outlinePrimitive);a(this)};return R});define("DataSources/DataSourceDisplay",["../Core/BoundingSphere","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/EventHelper","../Scene/GroundPrimitive","./BillboardVisualizer","./BoundingSphereState","./BoxGeometryUpdater","./CorridorGeometryUpdater","./CustomDataSource","./CylinderGeometryUpdater","./EllipseGeometryUpdater","./EllipsoidGeometryUpdater","./GeometryVisualizer","./LabelVisualizer","./ModelVisualizer","./PathVisualizer","./PointVisualizer","./PolygonGeometryUpdater","./PolylineGeometryUpdater","./PolylineVolumeGeometryUpdater","./RectangleGeometryUpdater","./WallGeometryUpdater"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w,C,b,S,E,T){"use strict";function x(e){if(!r(e)){throw new a("options is required.")}if(!r(e.scene)){throw new a("scene is required.")}if(!r(e.dataSourceCollection)){throw new a("dataSourceCollection is required.")}s.initializeTerrainHeights();var i=e.scene;var n=e.dataSourceCollection;this._eventHelper=new o;this._eventHelper.add(n.dataSourceAdded,this._onDataSourceAdded,this);this._eventHelper.add(n.dataSourceRemoved,this._onDataSourceRemoved,this);this._dataSourceCollection=n;this._scene=i;this._visualizersCallback=t(e.visualizersCallback,x.defaultVisualizersCallback);for(var u=0,l=n.length;u<l;u++){this._onDataSourceAdded(n,n.get(u))}var c=new f;this._onDataSourceAdded(undefined,c);this._defaultDataSource=c;this._ready=false}x.defaultVisualizersCallback=function(e,t,r){var i=r.entities;return[new u(t,i),new v(c,e,i),new v(h,e,i),new v(d,e,i),new v(p,e,i),new v(m,e,i),new v(C,e,i),new v(b,e,i),new v(S,e,i),new v(E,e,i),new v(T,e,i),new _(t,i),new g(e,i),new w(t,i),new y(e,i)]};i(x.prototype,{scene:{get:function(){return this._scene}},dataSources:{get:function(){return this._dataSourceCollection}},defaultDataSource:{get:function(){return this._defaultDataSource}},ready:{get:function(){return this._ready}}});x.prototype.isDestroyed=function(){return false};x.prototype.destroy=function(){this._eventHelper.removeAll();var e=this._dataSourceCollection;for(var t=0,r=e.length;t<r;++t){this._onDataSourceRemoved(this._dataSourceCollection,e.get(t))}this._onDataSourceRemoved(undefined,this._defaultDataSource);return n(this)};x.prototype.update=function(e){if(!r(e)){throw new a("time is required.")}if(!s._initialized){this._ready=false;return false}var t=true;var i;var n;var o;var u;var l=this._dataSourceCollection;var c=l.length;for(i=0;i<c;i++){var d=l.get(i);if(r(d.update)){t=d.update(e)&&t}o=d._visualizers;u=o.length;for(n=0;n<u;n++){t=o[n].update(e)&&t}}o=this._defaultDataSource._visualizers;u=o.length;for(n=0;n<u;n++){t=o[n].update(e)&&t}this._ready=t;return t};var A=[];var P=new e;x.prototype.getBoundingSphere=function(t,i,n){if(!r(t)){throw new a("entity is required.")}if(!r(i)){throw new a("allowPartial is required.")}if(!r(n)){throw new a("result is required.")}if(!this._ready){return l.PENDING}var o;var s;var u=this._defaultDataSource;if(!u.entities.contains(t)){u=undefined;var c=this._dataSourceCollection;s=c.length;for(o=0;o<s;o++){var d=c.get(o);if(d.entities.contains(t)){u=d;break}}}if(!r(u)){return l.FAILED}var f=A;var h=P;var p=0;var m=l.DONE;var v=u._visualizers;var _=v.length;for(o=0;o<_;o++){var g=v[o];if(r(g.getBoundingSphere)){m=v[o].getBoundingSphere(t,h);if(!i&&m===l.PENDING){return l.PENDING}else if(m===l.DONE){f[p]=e.clone(h,f[p]);p++}}}if(p===0){return l.FAILED}f.length=p;e.fromBoundingSpheres(f,n);return l.DONE};x.prototype._onDataSourceAdded=function(e,t){var r=this._scene;var i=t.clustering;i._initialize(r);r.primitives.add(i);t._visualizers=this._visualizersCallback(r,i,t)};x.prototype._onDataSourceRemoved=function(e,t){var r=this._scene;var i=t.clustering;r.primitives.remove(i);var n=t._visualizers;var a=n.length;for(var o=0;o<a;o++){n[o].destroy()}t._visualizers=undefined};return x});define("DataSources/DynamicGeometryUpdater",["../Core/DeveloperError"],function(e){"use strict";function t(){e.throwInstantiationError()}t.prototype.update=e.throwInstantiationError;t.prototype.getBoundingSphere=e.throwInstantiationError;t.prototype.isDestroyed=e.throwInstantiationError;t.prototype.destroy=e.throwInstantiationError;return t});define("DataSources/EntityView",["../Core/Cartesian3","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Ellipsoid","../Core/HeadingPitchRange","../Core/JulianDate","../Core/Math","../Core/Matrix3","../Core/Matrix4","../Core/Transforms","../Scene/SceneMode"],function(e,t,r,i,n,a,o,s,u,l,c,d,f){"use strict";var h=new l;var p=new l;var m=new l;var v=new c;var _=new e;var g=new e;var y=new e;var w=new e;var C=new e;var b=new e;var S=new s;var E=1.25;function T(t,i,n,a,o,c,T){var x=t.scene.mode;var A=o.getValue(c,t._lastCartesian);if(r(A)){var P=false;var D;var M;var I;if(x===f.SCENE3D){S=s.addSeconds(c,.001,S);var O=o.getValue(S,_);if(r(O)){var R=d.computeFixedToIcrfMatrix(c,h);var N=d.computeFixedToIcrfMatrix(S,p);var L;if(!r(R)||!r(N)){L=d.computeTemeToPseudoFixedMatrix(c,m);R=l.transpose(L,h);N=d.computeTemeToPseudoFixedMatrix(S,p);l.transpose(N,N)}else{L=l.transpose(R,m)}var B=l.multiplyByVector(R,A,C);var F=l.multiplyByVector(N,O,b);e.subtract(B,F,w);var k=e.magnitude(w)*1e3;var V=3986004418e5;var z=-V/(k*k-2*V/e.magnitude(B));if(z<0||z>E*T.maximumRadius){D=g;e.normalize(A,D);e.negate(D,D);I=e.clone(e.UNIT_Z,y);M=e.cross(I,D,_);if(e.magnitude(M)>u.EPSILON7){e.normalize(D,D);e.normalize(M,M);I=e.cross(D,M,y);e.normalize(I,I);P=true}}else if(!e.equalsEpsilon(A,O,u.EPSILON7)){I=g;e.normalize(B,I);e.normalize(F,F);M=e.cross(I,F,y);if(!e.equalsEpsilon(M,e.ZERO,u.EPSILON7)){D=e.cross(M,I,_);l.multiplyByVector(L,D,D);l.multiplyByVector(L,M,M);l.multiplyByVector(L,I,I);e.normalize(D,D);e.normalize(M,M);e.normalize(I,I);P=true}}}}if(r(t.boundingSphere)){A=t.boundingSphere.center}var U;var q;var G;if(a){U=e.clone(i.position,w);q=e.clone(i.direction,C);G=e.clone(i.up,b)}var H=v;if(P){H[0]=D.x;H[1]=D.y;H[2]=D.z;H[3]=0;H[4]=M.x;H[5]=M.y;H[6]=M.z;H[7]=0;H[8]=I.x;H[9]=I.y;H[10]=I.z;H[11]=0;H[12]=A.x;H[13]=A.y;H[14]=A.z;H[15]=0}else{d.eastNorthUpToFixedFrame(A,T,H)}i._setTransform(H);if(a){e.clone(U,i.position);e.clone(q,i.direction);e.clone(G,i.up);e.cross(q,G,i.right)}}if(n){var W=x===f.SCENE2D||e.equals(t._offset3D,e.ZERO)?undefined:t._offset3D;i.lookAtTransform(i.transform,W)}}function x(r,i,n){this.entity=r;this.scene=i;this.ellipsoid=t(n,a.WGS84);this.boundingSphere=undefined;this._lastEntity=undefined;this._mode=undefined;this._lastCartesian=new e;this._defaultOffset3D=undefined;this._offset3D=new e}i(x,{defaultOffset3D:{get:function(){return this._defaultOffset3D},set:function(t){this._defaultOffset3D=e.clone(t,new e)}}});x.defaultOffset3D=new e(-14e3,3500,3500);var A=new o;var P=new e;x.prototype.update=function(t,i){var a=this.scene;var o=this.entity;var s=this.ellipsoid;if(!r(t)){throw new n("time is required.")}if(!r(a)){throw new n("EntityView.scene is required.")}if(!r(o)){throw new n("EntityView.entity is required.")}if(!r(s)){throw new n("EntityView.ellipsoid is required.")}if(!r(o.position)){throw new n("entity.position is required.")}var l=a.mode;if(l===f.MORPHING){return}var c=o.position;var d=o!==this._lastEntity;var h=l!==this._mode;var p=this._offset3D;var m=a.camera;var v=d||h;var _=true;if(d){var g=o.viewFrom;var y=r(g);if(!y&&r(i)){var w=a.screenSpaceCameraController;w.minimumZoomDistance=Math.min(w.minimumZoomDistance,i.radius*.5);A.pitch=-u.PI_OVER_FOUR;A.range=0;var C=c.getValue(t,P);if(r(C)){var b=2-1/Math.max(1,e.magnitude(C)/s.maximumRadius);A.pitch*=b}m.viewBoundingSphere(i,A);this.boundingSphere=i;v=false;_=false}else if(!y||!r(g.getValue(t,p))){e.clone(x._defaultOffset3D,p)}}else if(!h&&a.mode!==f.MORPHING&&this._mode!==f.SCENE2D){e.clone(m.position,p)}this._lastEntity=o;this._mode=a.mode!==f.MORPHING?a.mode:this._mode;if(a.mode!==f.MORPHING){T(this,m,v,_,c,t,s)}};return x});!function(){var e={version:"1.6.18",mesh:function(e){return s(e,r.apply(this,arguments))},meshArcs:r,merge:function(e){return s(e,i.apply(this,arguments))},mergeArcs:i,feature:a,neighbors:c,presimplify:d};function t(e,t){var r={},i={},n={},a=[],o=-1;t.forEach(function(r,i){var n=e.arcs[r<0?~r:r],a;if(n.length<3&&!n[1][0]&&!n[1][1]){a=t[++o],t[o]=r,t[i]=a}});t.forEach(function(e){var t=s(e),r=t[0],a=t[1],o,u;if(o=n[r]){delete n[o.end];o.push(e);o.end=a;if(u=i[a]){delete i[u.start];var l=u===o?o:o.concat(u);i[l.start=o.start]=n[l.end=u.end]=l}else{i[o.start]=n[o.end]=o}}else if(o=i[a]){delete i[o.start];o.unshift(e);o.start=r;if(u=n[r]){delete n[u.end];var c=u===o?o:u.concat(o);i[c.start=u.start]=n[c.end=o.end]=c}else{i[o.start]=n[o.end]=o}}else{o=[e];i[o.start=r]=n[o.end=a]=o}});function s(t){var r=e.arcs[t<0?~t:t],i=r[0],n;if(e.transform)n=[0,0],r.forEach(function(e){n[0]+=e[0],n[1]+=e[1]});else n=r[r.length-1];return t<0?[n,i]:[i,n]}function u(e,t){for(var i in e){var n=e[i];delete t[n.start];delete n.start;delete n.end;n.forEach(function(e){r[e<0?~e:e]=1});a.push(n)}}u(n,i);u(i,n);t.forEach(function(e){if(!r[e<0?~e:e])a.push([e])});return a}function r(e,r,i){var n=[];if(arguments.length>1){var a=[],o;function s(e){var t=e<0?~e:e;(a[t]||(a[t]=[])).push({i:e,g:o})}function u(e){e.forEach(s)}function l(e){e.forEach(u)}function c(e){if(e.type==="GeometryCollection")e.geometries.forEach(c);else if(e.type in d)o=e,d[e.type](e.arcs)}var d={LineString:u,MultiLineString:l,Polygon:l,MultiPolygon:function(e){e.forEach(l)}};c(r);a.forEach(arguments.length<3?function(e){n.push(e[0].i)}:function(e){if(i(e[0].g,e[e.length-1].g))n.push(e[0].i)})}else{for(var f=0,h=e.arcs.length;f<h;++f)n.push(f)}return{type:"MultiLineString",arcs:t(e,n)}}function i(e,r){var i={},a=[],o=[];r.forEach(function(e){if(e.type==="Polygon")u(e.arcs);else if(e.type==="MultiPolygon")e.arcs.forEach(u)});function u(e){e.forEach(function(t){t.forEach(function(t){(i[t=t<0?~t:t]||(i[t]=[])).push(e)})});a.push(e)}function l(t){return f(s(e,{type:"Polygon",arcs:[t]}).coordinates[0])>0}a.forEach(function(e){if(!e._){var t=[],r=[e];e._=1;o.push(t);while(e=r.pop()){t.push(e);e.forEach(function(e){e.forEach(function(e){i[e<0?~e:e].forEach(function(e){if(!e._){e._=1;r.push(e)}})})})}}});a.forEach(function(e){delete e._});return{type:"MultiPolygon",arcs:o.map(function(r){var a=[];r.forEach(function(e){e.forEach(function(e){e.forEach(function(e){if(i[e<0?~e:e].length<2){a.push(e)}})})});a=t(e,a);if((n=a.length)>1){var o=l(r[0][0]);for(var s=0,u;s<n;++s){if(o===l(a[s])){u=a[0],a[0]=a[s],a[s]=u;break}}}return a})}}function a(e,t){return t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(t){return o(e,t)})}:o(e,t)}function o(e,t){var r={type:"Feature",id:t.id,properties:t.properties||{},geometry:s(e,t)};if(t.id==null)delete r.id;return r}function s(e,t){var r=v(e.transform),i=e.arcs;function n(e,t){if(t.length)t.pop();for(var n=i[e<0?~e:e],a=0,o=n.length,s;a<o;++a){t.push(s=n[a].slice());r(s,a)}if(e<0)u(t,o)}function a(e){e=e.slice();r(e,0);return e}function o(e){var t=[];for(var r=0,i=e.length;r<i;++r)n(e[r],t);if(t.length<2)t.push(t[0].slice());return t}function s(e){var t=o(e);while(t.length<4)t.push(t[0].slice());return t}function l(e){return e.map(s)}function c(e){var t=e.type;return t==="GeometryCollection"?{type:t,geometries:e.geometries.map(c)}:t in d?{type:t,coordinates:d[t](e)}:null}var d={Point:function(e){return a(e.coordinates)},MultiPoint:function(e){return e.coordinates.map(a)},LineString:function(e){return o(e.arcs)},MultiLineString:function(e){return e.arcs.map(o)},Polygon:function(e){return l(e.arcs)},MultiPolygon:function(e){return e.arcs.map(l)}};return c(t)}function u(e,t){var r,i=e.length,n=i-t;while(n<--i)r=e[n],e[n++]=e[i],e[i]=r}function l(e,t){var r=0,i=e.length;while(r<i){var n=r+i>>>1;if(e[n]<t)r=n+1;else i=n}return r}function c(e){var t={},r=e.map(function(){return[]});function i(e,r){e.forEach(function(e){if(e<0)e=~e;var i=t[e];if(i)i.push(r);else t[e]=[r]})}function n(e,t){e.forEach(function(e){i(e,t)})}function a(e,t){if(e.type==="GeometryCollection")e.geometries.forEach(function(e){a(e,t)});else if(e.type in o)o[e.type](e.arcs,t)}var o={LineString:i,MultiLineString:n,Polygon:n,MultiPolygon:function(e,t){e.forEach(function(e){n(e,t)})}};e.forEach(a);for(var s in t){for(var u=t[s],c=u.length,d=0;d<c;++d){for(var f=d+1;f<c;++f){var h=u[d],p=u[f],m;if((m=r[h])[s=l(m,p)]!==p)m.splice(s,0,p);if((m=r[p])[s=l(m,h)]!==h)m.splice(s,0,h)}}}return r}function d(e,t){var r=v(e.transform),i=_(e.transform),n=m();if(!t)t=h;e.arcs.forEach(function(e){var o=[],s=0,u;for(var l=0,c=e.length,d;l<c;++l){d=e[l];r(e[l]=[d[0],d[1],Infinity],l)}for(var l=1,c=e.length-1;l<c;++l){u=e.slice(l-1,l+2);u[1][2]=t(u);o.push(u);n.push(u)}for(var l=0,c=o.length;l<c;++l){u=o[l];u.previous=o[l-1];u.next=o[l+1]}while(u=n.pop()){var f=u.previous,h=u.next;if(u[1][2]<s)u[1][2]=s;else s=u[1][2];if(f){f.next=h;f[2]=u[2];a(f)}if(h){h.previous=f;h[0]=u[0];a(h)}}e.forEach(i)});function a(e){n.remove(e);e[1][2]=t(e);n.push(e)}return e}function f(e){var t=-1,r=e.length,i,n=e[r-1],a=0;while(++t<r){i=n;n=e[t];a+=i[0]*n[1]-i[1]*n[0]}return a*.5}function h(e){var t=e[0],r=e[1],i=e[2];return Math.abs((t[0]-i[0])*(r[1]-t[1])-(t[0]-r[0])*(i[1]-t[1]))}function p(e,t){return e[1][2]-t[1][2]}function m(){var e={},t=[],r=0;e.push=function(e){i(t[e._=r]=e,r++);return r};e.pop=function(){if(r<=0)return;var e=t[0],i;if(--r>0)i=t[r],n(t[i._=0]=i,0);return e};e.remove=function(e){var a=e._,o;if(t[a]!==e)return;if(a!==--r)o=t[r],(p(o,e)<0?i:n)(t[o._=a]=o,a);return a};function i(e,r){while(r>0){var i=(r+1>>1)-1,n=t[i];if(p(e,n)>=0)break;t[n._=r]=n;t[e._=r=i]=e}}function n(e,i){while(true){var n=i+1<<1,a=n-1,o=i,s=t[o];if(a<r&&p(t[a],s)<0)s=t[o=a];if(n<r&&p(t[n],s)<0)s=t[o=n];if(o===i)break;t[s._=i]=s;t[e._=i=o]=e}}return e}function v(e){if(!e)return g;var t,r,i=e.scale[0],n=e.scale[1],a=e.translate[0],o=e.translate[1];return function(e,s){if(!s)t=r=0;e[0]=(t+=e[0])*i+a;e[1]=(r+=e[1])*n+o}}function _(e){if(!e)return g;var t,r,i=e.scale[0],n=e.scale[1],a=e.translate[0],o=e.translate[1];return function(e,s){if(!s)t=r=0;var u=(e[0]-a)/i|0,l=(e[1]-o)/n|0;e[0]=u-t;e[1]=l-r;t=u;r=l}}function g(){}if(typeof define==="function"&&define.amd)define("ThirdParty/topojson",e);else if(typeof module==="object"&&module.exports)module.exports=e;else this.topojson=e}();define("DataSources/GeoJsonDataSource",["../Core/Cartesian3","../Core/Color","../Core/createGuid","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/getFilenameFromUri","../Core/loadJson","../Core/PinBuilder","../Core/PolygonHierarchy","../Core/RequestScheduler","../Core/RuntimeError","../Scene/HeightReference","../Scene/VerticalOrigin","../ThirdParty/topojson","../ThirdParty/when","./BillboardGraphics","./CallbackProperty","./ColorMaterialProperty","./ConstantPositionProperty","./ConstantProperty","./CorridorGraphics","./DataSource","./EntityCluster","./EntityCollection","./PolygonGraphics","./PolylineGraphics"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w,C,b,S,E,T,x,A,P){"use strict";function D(t){return e.fromDegrees(t[0],t[1],t[2])}var M={"urn:ogc:def:crs:OGC:1.3:CRS84":D,"EPSG:4326":D,"urn:ogc:def:crs:EPSG::4326":D};var I={};var O={};var R=48;var N;var L=t.ROYALBLUE;var B=t.YELLOW;var F=2;var k=t.fromBytes(255,255,0,100);var V=false;var z=new b(F);var U=new w(B);var q=new w(k);var G={small:24,medium:48,large:64};var H=["title","description","marker-size","marker-symbol","marker-color","stroke","stroke-opacity","stroke-width","fill","fill-opacity"];function W(e,t){var r="";for(var i in e){if(e.hasOwnProperty(i)){if(i===t||H.indexOf(i)!==-1){continue}var a=e[i];if(n(a)){if(typeof a==="object"){r+="<tr><th>"+i+"</th><td>"+W(a)+"</td></tr>"}else{r+="<tr><th>"+i+"</th><td>"+a+"</td></tr>"}}}}if(r.length>0){r='<table class="cesium-infoBox-defaultTable"><tbody>'+r+"</tbody></table>"}return r}function j(e,t,r){var i;return function(a,o){if(!n(i)){i=e(t,r)}return i}}function Y(e,t){return new y(j(W,e,t),true)}function X(e,t,i){var a=e.id;if(!n(a)||e.type!=="Feature"){a=r()}else{var o=2;var s=a;while(n(t.getById(s))){s=a+"_"+o;o++}a=s}var u=t.getOrCreateEntity(a);var l=e.properties;if(n(l)){u.addProperty("properties");u.properties=l;var c;var d=l.title;if(n(d)){u.name=d;c="title"}else{var f=Number.MAX_VALUE;for(var h in l){if(l.hasOwnProperty(h)&&l[h]){var p=h.toLowerCase();if(f>1&&p==="title"){f=1;c=h;break}else if(f>2&&p==="name"){f=2;c=h}else if(f>3&&/title/i.test(h)){f=3;c=h}else if(f>4&&/name/i.test(h)){f=4;c=h}}}if(n(c)){u.name=l[c]}}var m=l.description;if(m!==null){u.description=!n(m)?i(l,c):new b(m)}}return u}function Z(e,t){var r=new Array(e.length);for(var i=0;i<e.length;i++){r[i]=t(e[i])}return r}function K(e,t,r,i,a){if(t.geometry===null){X(t,e._entityCollection,a.describe);return}if(!n(t.geometry)){throw new h("feature.geometry is required.")}var o=t.geometry.type;var s=ce[o];if(!n(s)){throw new h("Unknown geometry type: "+o)}s(e,t,t.geometry,i,a)}function Q(e,t,r,i,n){var a=t.features;for(var o=0,s=a.length;o<s;o++){K(e,a[o],undefined,i,n)}}function J(e,t,r,i,a){var o=r.geometries;for(var s=0,u=o.length;s<u;s++){var l=o[s];var c=l.type;var d=ce[c];if(!n(d)){throw new h("Unknown geometry type: "+c)}d(e,t,l,i,a)}}function $(e,r,a,o,s){var u=s.markerSymbol;var l=s.markerColor;var c=s.markerSize;var d=r.properties;if(n(d)){var f=d["marker-color"];if(n(f)){l=t.fromCssColorString(f)}c=i(G[d["marker-size"]],c);var h=d["marker-symbol"];if(n(h)){u=h}}var v;if(n(u)){if(u.length===1){v=e._pinBuilder.fromText(u.toUpperCase(),l,c)}else{v=e._pinBuilder.fromMakiIconId(u,l,c)}}else{v=e._pinBuilder.fromColor(l,c)}var y=new g;y.verticalOrigin=new b(m.BOTTOM);if(o.length===2&&s.clampToGround){y.heightReference=p.CLAMP_TO_GROUND}var w=X(r,e._entityCollection,s.describe);w.billboard=y;w.position=new C(a(o));var S=_(v).then(function(e){y.image=new b(e)}).otherwise(function(){y.image=new b(e._pinBuilder.fromColor(l,c))});e._promises.push(S)}function ee(e,t,r,i,n){$(e,t,i,r.coordinates,n)}function te(e,t,r,i,n){var a=r.coordinates;for(var o=0;o<a.length;o++){$(e,t,i,a[o],n)}}function re(e,r,i,a,o){var s=o.strokeMaterialProperty;var u=o.strokeWidthProperty;var l=r.properties;if(n(l)){var c=l["stroke-width"];if(n(c)){u=new b(c)}var d;var f=l.stroke;if(n(f)){d=t.fromCssColorString(f)}var h=l["stroke-opacity"];if(n(h)&&h!==1){if(!n(d)){d=s.color.clone()}d.alpha=h}if(n(d)){s=new w(d)}}var p=X(r,e._entityCollection,o.describe);var m;if(o.clampToGround){m=new S;p.corridor=m}else{m=new P;p.polyline=m}m.material=s;m.width=u;m.positions=new b(Z(a,i))}function ie(e,t,r,i,n){re(e,t,i,r.coordinates,n)}function ne(e,t,r,i,n){var a=r.coordinates;for(var o=0;o<a.length;o++){re(e,t,i,a[o],n)}}function ae(e,r,i,a,o){if(a.length===0||a[0].length===0){return}var s=o.strokeMaterialProperty.color;var u=o.fillMaterialProperty;var l=o.strokeWidthProperty;var c=r.properties;if(n(c)){var f=c["stroke-width"];if(n(f)){l=new b(f)}var h;var p=c.stroke;if(n(p)){h=t.fromCssColorString(p)}var m=c["stroke-opacity"];if(n(m)&&m!==1){if(!n(h)){h=o.strokeMaterialProperty.color.clone()}h.alpha=m}if(n(h)){s=new b(h)}var v;var _=c.fill;if(n(_)){v=t.fromCssColorString(_);v.alpha=u.color.alpha}m=c["fill-opacity"];if(n(m)&&m!==u.color.alpha){if(!n(v)){v=u.color.clone()}v.alpha=m}if(n(v)){u=new w(v)}}var g=new A;g.outline=new b(true);g.outlineColor=s;g.outlineWidth=l;g.material=u;var y=[];for(var C=1,S=a.length;C<S;C++){y.push(new d(Z(a[C],i)))}var E=a[0];g.hierarchy=new b(new d(Z(E,i),y));if(E[0].length>2){g.perPositionHeight=new b(true)}else if(!o.clampToGround){g.height=0}var T=X(r,e._entityCollection,o.describe);T.polygon=g}function oe(e,t,r,i,n){ae(e,t,i,r.coordinates,n)}function se(e,t,r,i,n){var a=r.coordinates;for(var o=0;o<a.length;o++){ae(e,t,i,a[o],n)}}function ue(e,t,r,i,n){for(var a in r.objects){if(r.objects.hasOwnProperty(a)){var o=v.feature(r,r.objects[a]);var s=le[o.type];s(e,o,o,i,n)}}}var le={Feature:K,FeatureCollection:Q,GeometryCollection:J,LineString:ie,MultiLineString:ne,MultiPoint:te,MultiPolygon:se,Point:ee,Polygon:oe,Topology:ue};var ce={GeometryCollection:J,LineString:ie,MultiLineString:ne,MultiPoint:te,MultiPolygon:se,Point:ee,Polygon:oe,Topology:ue};function de(e){this._name=e;this._changed=new s;this._error=new s;this._isLoading=false;this._loading=new s;this._entityCollection=new x(this);this._promises=[];this._pinBuilder=new c;this._entityCluster=new T}de.load=function(e,t){return(new de).load(e,t)};a(de,{markerSize:{get:function(){return R},set:function(e){R=e}},markerSymbol:{get:function(){return N},set:function(e){N=e}},markerColor:{get:function(){return L},set:function(e){L=e}},stroke:{get:function(){return B},set:function(e){B=e;U.color.setValue(e)}},strokeWidth:{get:function(){return F},set:function(e){F=e;z.setValue(e)}},fill:{get:function(){return k},set:function(e){k=e;q=new w(k)}},clampToGround:{get:function(){return V},set:function(e){V=e}},crsNames:{get:function(){return M}},crsLinkHrefs:{get:function(){return I}},crsLinkTypes:{get:function(){return O}}});a(de.prototype,{name:{get:function(){return this._name}},clock:{value:undefined,writable:false},entities:{get:function(){return this._entityCollection}},isLoading:{get:function(){return this._isLoading}},changedEvent:{get:function(){return this._changed}},errorEvent:{get:function(){return this._error}},loadingEvent:{get:function(){return this._loading}},show:{get:function(){return this._entityCollection.show},set:function(e){this._entityCollection.show=e}},clustering:{get:function(){return this._entityCluster},set:function(e){if(!n(e)){throw new o("value must be defined.")}this._entityCluster=e}}});de.prototype.load=function(e,t){if(!n(e)){throw new o("data is required.")}E.setLoading(this,true);var r=e;t=i(t,i.EMPTY_OBJECT);var a=t.sourceUri;if(typeof e==="string"){if(!n(a)){a=e}r=f.request(e,l)}t={describe:i(t.describe,Y),markerSize:i(t.markerSize,R),markerSymbol:i(t.markerSymbol,N),markerColor:i(t.markerColor,L),strokeWidthProperty:new b(i(t.strokeWidth,F)),strokeMaterialProperty:new w(i(t.stroke,B)),fillMaterialProperty:new w(i(t.fill,k)),clampToGround:i(t.clampToGround,V)};var s=this;return _(r,function(e){return fe(s,e,t,a)}).otherwise(function(e){E.setLoading(s,false);s._error.raiseEvent(s,e);console.log(e);return _.reject(e)})};function fe(e,t,r,i){var a;if(n(i)){a=u(i)}if(n(a)&&e._name!==a){e._name=a;e._changed.raiseEvent(e)}var o=le[t.type];if(!n(o)){throw new h("Unsupported GeoJSON object type: "+t.type)}var s=t.crs;var l=s!==null?D:null;if(n(s)){if(!n(s.properties)){throw new h("crs.properties is undefined.")}var c=s.properties;if(s.type==="name"){l=M[c.name];if(!n(l)){throw new h("Unknown crs name: "+c.name)}}else if(s.type==="link"){var d=I[c.href];if(!n(d)){d=O[c.type]}if(!n(d)){throw new h("Unable to resolve crs link: "+JSON.stringify(c))}l=d(c)}else if(s.type==="EPSG"){l=M["EPSG:"+c.code];if(!n(l)){throw new h("Unknown crs EPSG code: "+c.code)}}else{throw new h("Unknown crs type: "+s.type)}}return _(l,function(i){e._entityCollection.removeAll();if(i!==null){o(e,t,t,i,r)}return _.all(e._promises,function(){e._promises.length=0;E.setLoading(e,false);return e})})}return de});define("DataSources/GeometryUpdater",["../Core/defineProperties","../Core/DeveloperError"],function(e,t){"use strict";function r(e,r){t.throwInstantiationError()}e(r,{perInstanceColorAppearanceType:{get:t.throwInstantiationError},materialAppearanceType:{get:t.throwInstantiationError}});e(r.prototype,{entity:{get:t.throwInstantiationError},fillEnabled:{get:t.throwInstantiationError},hasConstantFill:{get:t.throwInstantiationError},fillMaterialProperty:{get:t.throwInstantiationError},outlineEnabled:{get:t.throwInstantiationError},hasConstantOutline:{get:t.throwInstantiationError},outlineColorProperty:{get:t.throwInstantiationError},outlineWidth:{get:t.throwInstantiationError},isDynamic:{get:t.throwInstantiationError},isClosed:{get:t.throwInstantiationError},geometryChanged:{get:t.throwInstantiationError}});r.prototype.isOutlineVisible=t.throwInstantiationError;r.prototype.isFilled=t.throwInstantiationError;r.prototype.createFillGeometryInstance=t.throwInstantiationError;r.prototype.createOutlineGeometryInstance=t.throwInstantiationError;r.prototype.isDestroyed=t.throwInstantiationError;r.prototype.destroy=t.throwInstantiationError
;r.prototype.createDynamicUpdater=t.throwInstantiationError;return r});(function(e,t){if(typeof define==="function"&&define.amd){define("ThirdParty/Autolinker",[],function(){return e["Autolinker"]=t()})}else if(typeof exports==="object"){module.exports=t()}else{e["Autolinker"]=t()}})(this,function(){var e=function(t){e.Util.assign(this,t);var r=this.hashtag;if(r!==false&&r!=="twitter"&&r!=="facebook"){throw new Error("invalid `hashtag` cfg - see docs")}};e.prototype={constructor:e,urls:true,email:true,twitter:true,phone:true,hashtag:false,newWindow:true,stripPrefix:true,truncate:undefined,className:"",htmlParser:undefined,matchParser:undefined,tagBuilder:undefined,link:function(e){var t=this.getHtmlParser(),r=t.parse(e),i=0,n=[];for(var a=0,o=r.length;a<o;a++){var s=r[a],u=s.getType(),l=s.getText();if(u==="element"){if(s.getTagName()==="a"){if(!s.isClosing()){i++}else{i=Math.max(i-1,0)}}n.push(l)}else if(u==="entity"||u==="comment"){n.push(l)}else{if(i===0){var c=this.linkifyStr(l);n.push(c)}else{n.push(l)}}}return n.join("")},linkifyStr:function(e){return this.getMatchParser().replace(e,this.createMatchReturnVal,this)},createMatchReturnVal:function(t){var r;if(this.replaceFn){r=this.replaceFn.call(this,this,t)}if(typeof r==="string"){return r}else if(r===false){return t.getMatchedText()}else if(r instanceof e.HtmlTag){return r.toAnchorString()}else{var i=this.getTagBuilder(),n=i.build(t);return n.toAnchorString()}},getHtmlParser:function(){var t=this.htmlParser;if(!t){t=this.htmlParser=new e.htmlParser.HtmlParser}return t},getMatchParser:function(){var t=this.matchParser;if(!t){t=this.matchParser=new e.matchParser.MatchParser({urls:this.urls,email:this.email,twitter:this.twitter,phone:this.phone,hashtag:this.hashtag,stripPrefix:this.stripPrefix})}return t},getTagBuilder:function(){var t=this.tagBuilder;if(!t){t=this.tagBuilder=new e.AnchorTagBuilder({newWindow:this.newWindow,truncate:this.truncate,className:this.className})}return t}};e.link=function(t,r){var i=new e(r);return i.link(t)};e.match={};e.htmlParser={};e.matchParser={};e.Util={abstractMethod:function(){throw"abstract"},trimRegex:/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,assign:function(e,t){for(var r in t){if(t.hasOwnProperty(r)){e[r]=t[r]}}return e},extend:function(t,r){var i=t.prototype;var n=function(){};n.prototype=i;var a;if(r.hasOwnProperty("constructor")){a=r.constructor}else{a=function(){i.constructor.apply(this,arguments)}}var o=a.prototype=new n;o.constructor=a;o.superclass=i;delete r.constructor;e.Util.assign(o,r);return a},ellipsis:function(e,t,r){if(e.length>t){r=r==null?"..":r;e=e.substring(0,t-r.length)+r}return e},indexOf:function(e,t){if(Array.prototype.indexOf){return e.indexOf(t)}else{for(var r=0,i=e.length;r<i;r++){if(e[r]===t)return r}return-1}},splitAndCapture:function(e,t){if(!t.global)throw new Error("`splitRegex` must have the 'g' flag set");var r=[],i=0,n;while(n=t.exec(e)){r.push(e.substring(i,n.index));r.push(n[0]);i=n.index+n[0].length}r.push(e.substring(i));return r},trim:function(e){return e.replace(this.trimRegex,"")}};e.HtmlTag=e.Util.extend(Object,{whitespaceRegex:/\s+/,constructor:function(t){e.Util.assign(this,t);this.innerHtml=this.innerHtml||this.innerHTML},setTagName:function(e){this.tagName=e;return this},getTagName:function(){return this.tagName||""},setAttr:function(e,t){var r=this.getAttrs();r[e]=t;return this},getAttr:function(e){return this.getAttrs()[e]},setAttrs:function(t){var r=this.getAttrs();e.Util.assign(r,t);return this},getAttrs:function(){return this.attrs||(this.attrs={})},setClass:function(e){return this.setAttr("class",e)},addClass:function(t){var r=this.getClass(),i=this.whitespaceRegex,n=e.Util.indexOf,a=!r?[]:r.split(i),o=t.split(i),s;while(s=o.shift()){if(n(a,s)===-1){a.push(s)}}this.getAttrs()["class"]=a.join(" ");return this},removeClass:function(t){var r=this.getClass(),i=this.whitespaceRegex,n=e.Util.indexOf,a=!r?[]:r.split(i),o=t.split(i),s;while(a.length&&(s=o.shift())){var u=n(a,s);if(u!==-1){a.splice(u,1)}}this.getAttrs()["class"]=a.join(" ");return this},getClass:function(){return this.getAttrs()["class"]||""},hasClass:function(e){return(" "+this.getClass()+" ").indexOf(" "+e+" ")!==-1},setInnerHtml:function(e){this.innerHtml=e;return this},getInnerHtml:function(){return this.innerHtml||""},toAnchorString:function(){var e=this.getTagName(),t=this.buildAttrsStr();t=t?" "+t:"";return["<",e,t,">",this.getInnerHtml(),"</",e,">"].join("")},buildAttrsStr:function(){if(!this.attrs)return"";var e=this.getAttrs(),t=[];for(var r in e){if(e.hasOwnProperty(r)){t.push(r+'="'+e[r]+'"')}}return t.join(" ")}});e.AnchorTagBuilder=e.Util.extend(Object,{constructor:function(t){e.Util.assign(this,t)},build:function(t){var r=new e.HtmlTag({tagName:"a",attrs:this.createAttrs(t.getType(),t.getAnchorHref()),innerHtml:this.processAnchorText(t.getAnchorText())});return r},createAttrs:function(e,t){var r={href:t};var i=this.createCssClass(e);if(i){r["class"]=i}if(this.newWindow){r["target"]="_blank"}return r},createCssClass:function(e){var t=this.className;if(!t)return"";else return t+" "+t+"-"+e},processAnchorText:function(e){e=this.doTruncate(e);return e},doTruncate:function(t){return e.Util.ellipsis(t,this.truncate||Number.POSITIVE_INFINITY)}});e.htmlParser.HtmlParser=e.Util.extend(Object,{htmlRegex:function(){var e=/!--([\s\S]+?)--/,t=/[0-9a-zA-Z][0-9a-zA-Z:]*/,r=/[^\s\0"'>\/=\x01-\x1F\x7F]+/,i=/(?:"[^"]*?"|'[^']*?'|[^'"=<>`\s]+)/,n=r.source+"(?:\\s*=\\s*"+i.source+")?";return new RegExp(["(?:","<(!DOCTYPE)","(?:","\\s+","(?:",n,"|",i.source+")",")*",">",")","|","(?:","<(/)?","(?:",e.source,"|","(?:","("+t.source+")","(?:","\\s+",n,")*","\\s*/?",")",")",">",")"].join(""),"gi")}(),htmlCharacterEntitiesRegex:/(&nbsp;|&#160;|&lt;|&#60;|&gt;|&#62;|&quot;|&#34;|&#39;)/gi,parse:function(e){var t=this.htmlRegex,r,i=0,n,a=[];while((r=t.exec(e))!==null){var o=r[0],s=r[3],u=r[1]||r[4],l=!!r[2],c=e.substring(i,r.index);if(c){n=this.parseTextAndEntityNodes(c);a.push.apply(a,n)}if(s){a.push(this.createCommentNode(o,s))}else{a.push(this.createElementNode(o,u,l))}i=r.index+o.length}if(i<e.length){var d=e.substring(i);if(d){n=this.parseTextAndEntityNodes(d);a.push.apply(a,n)}}return a},parseTextAndEntityNodes:function(t){var r=[],i=e.Util.splitAndCapture(t,this.htmlCharacterEntitiesRegex);for(var n=0,a=i.length;n<a;n+=2){var o=i[n],s=i[n+1];if(o)r.push(this.createTextNode(o));if(s)r.push(this.createEntityNode(s))}return r},createCommentNode:function(t,r){return new e.htmlParser.CommentNode({text:t,comment:e.Util.trim(r)})},createElementNode:function(t,r,i){return new e.htmlParser.ElementNode({text:t,tagName:r.toLowerCase(),closing:i})},createEntityNode:function(t){return new e.htmlParser.EntityNode({text:t})},createTextNode:function(t){return new e.htmlParser.TextNode({text:t})}});e.htmlParser.HtmlNode=e.Util.extend(Object,{text:"",constructor:function(t){e.Util.assign(this,t)},getType:e.Util.abstractMethod,getText:function(){return this.text}});e.htmlParser.CommentNode=e.Util.extend(e.htmlParser.HtmlNode,{comment:"",getType:function(){return"comment"},getComment:function(){return this.comment}});e.htmlParser.ElementNode=e.Util.extend(e.htmlParser.HtmlNode,{tagName:"",closing:false,getType:function(){return"element"},getTagName:function(){return this.tagName},isClosing:function(){return this.closing}});e.htmlParser.EntityNode=e.Util.extend(e.htmlParser.HtmlNode,{getType:function(){return"entity"}});e.htmlParser.TextNode=e.Util.extend(e.htmlParser.HtmlNode,{getType:function(){return"text"}});e.matchParser.MatchParser=e.Util.extend(Object,{urls:true,email:true,twitter:true,phone:true,hashtag:false,stripPrefix:true,matcherRegex:function(){var e=/(^|[^\w])@(\w{1,15})/,t=/(^|[^\w])#(\w{1,15})/,r=/(?:[\-;:&=\+\$,\w\.]+@)/,i=/(?:\+?\d{1,3}[-\s.])?\(?\d{3}\)?[-\s.]?\d{3}[-\s.]\d{4}/,n=/(?:[A-Za-z][-.+A-Za-z0-9]+:(?![A-Za-z][-.+A-Za-z0-9]+:\/\/)(?!\d+\/?)(?:\/\/)?)/,a=/(?:www\.)/,o=/[A-Za-z0-9\.\-]*[A-Za-z0-9\-]/,s=/\.(?:international|construction|contractors|enterprises|photography|productions|foundation|immobilien|industries|management|properties|technology|christmas|community|directory|education|equipment|institute|marketing|solutions|vacations|bargains|boutique|builders|catering|cleaning|clothing|computer|democrat|diamonds|graphics|holdings|lighting|partners|plumbing|supplies|training|ventures|academy|careers|company|cruises|domains|exposed|flights|florist|gallery|guitars|holiday|kitchen|neustar|okinawa|recipes|rentals|reviews|shiksha|singles|support|systems|agency|berlin|camera|center|coffee|condos|dating|estate|events|expert|futbol|kaufen|luxury|maison|monash|museum|nagoya|photos|repair|report|social|supply|tattoo|tienda|travel|viajes|villas|vision|voting|voyage|actor|build|cards|cheap|codes|dance|email|glass|house|mango|ninja|parts|photo|shoes|solar|today|tokyo|tools|watch|works|aero|arpa|asia|best|bike|blue|buzz|camp|club|cool|coop|farm|fish|gift|guru|info|jobs|kiwi|kred|land|limo|link|menu|mobi|moda|name|pics|pink|post|qpon|rich|ruhr|sexy|tips|vote|voto|wang|wien|wiki|zone|bar|bid|biz|cab|cat|ceo|com|edu|gov|int|kim|mil|net|onl|org|pro|pub|red|tel|uno|wed|xxx|xyz|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cw|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|za|zm|zw)\b/,u=/[\-A-Za-z0-9+&@#\/%=~_()|'$*\[\]?!:,.;]*[\-A-Za-z0-9+&@#\/%=~_()|'$*\[\]]/;return new RegExp(["(",e.source,")","|","(",r.source,o.source,s.source,")","|","(","(?:","(",n.source,o.source,")","|","(?:","(.?//)?",a.source,o.source,")","|","(?:","(.?//)?",o.source,s.source,")",")","(?:"+u.source+")?",")","|","(",i.source,")","|","(",t.source,")"].join(""),"gi")}(),charBeforeProtocolRelMatchRegex:/^(.)?\/\//,constructor:function(t){e.Util.assign(this,t);this.matchValidator=new e.MatchValidator},replace:function(e,t,r){var i=this;return e.replace(this.matcherRegex,function(e,n,a,o,s,u,l,c,d,f,h,p,m){var v=i.processCandidateMatch(e,n,a,o,s,u,l,c,d,f,h,p,m);if(!v){return e}else{var _=t.call(r,v.match);return v.prefixStr+_+v.suffixStr}})},processCandidateMatch:function(t,r,i,n,a,o,s,u,l,c,d,f,h){var p=u||l,m,v="",_="";if(o&&!this.urls||a&&!this.email||c&&!this.phone||r&&!this.twitter||d&&!this.hashtag||!this.matchValidator.isValidMatch(o,s,p)){return null}if(this.matchHasUnbalancedClosingParen(t)){t=t.substr(0,t.length-1);_=")"}if(a){m=new e.match.Email({matchedText:t,email:a})}else if(r){if(i){v=i;t=t.slice(1)}m=new e.match.Twitter({matchedText:t,twitterHandle:n})}else if(c){var g=t.replace(/\D/g,"");m=new e.match.Phone({matchedText:t,number:g})}else if(d){if(f){v=f;t=t.slice(1)}m=new e.match.Hashtag({matchedText:t,serviceName:this.hashtag,hashtag:h})}else{if(p){var y=p.match(this.charBeforeProtocolRelMatchRegex)[1]||"";if(y){v=y;t=t.slice(1)}}m=new e.match.Url({matchedText:t,url:t,protocolUrlMatch:!!s,protocolRelativeMatch:!!p,stripPrefix:this.stripPrefix})}return{prefixStr:v,suffixStr:_,match:m}},matchHasUnbalancedClosingParen:function(e){var t=e.charAt(e.length-1);if(t===")"){var r=e.match(/\(/g),i=e.match(/\)/g),n=r&&r.length||0,a=i&&i.length||0;if(n<a){return true}}return false}});e.MatchValidator=e.Util.extend(Object,{invalidProtocolRelMatchRegex:/^[\w]\/\//,hasFullProtocolRegex:/^[A-Za-z][-.+A-Za-z0-9]+:\/\//,uriSchemeRegex:/^[A-Za-z][-.+A-Za-z0-9]+:/,hasWordCharAfterProtocolRegex:/:[^\s]*?[A-Za-z]/,isValidMatch:function(e,t,r){if(t&&!this.isValidUriScheme(t)||this.urlMatchDoesNotHaveProtocolOrDot(e,t)||this.urlMatchDoesNotHaveAtLeastOneWordChar(e,t)||this.isInvalidProtocolRelativeMatch(r)){return false}return true},isValidUriScheme:function(e){var t=e.match(this.uriSchemeRegex)[0].toLowerCase();return t!=="javascript:"&&t!=="vbscript:"},urlMatchDoesNotHaveProtocolOrDot:function(e,t){return!!e&&(!t||!this.hasFullProtocolRegex.test(t))&&e.indexOf(".")===-1},urlMatchDoesNotHaveAtLeastOneWordChar:function(e,t){if(e&&t){return!this.hasWordCharAfterProtocolRegex.test(e)}else{return false}},isInvalidProtocolRelativeMatch:function(e){return!!e&&this.invalidProtocolRelMatchRegex.test(e)}});e.match.Match=e.Util.extend(Object,{constructor:function(t){e.Util.assign(this,t)},getType:e.Util.abstractMethod,getMatchedText:function(){return this.matchedText},getAnchorHref:e.Util.abstractMethod,getAnchorText:e.Util.abstractMethod});e.match.Email=e.Util.extend(e.match.Match,{getType:function(){return"email"},getEmail:function(){return this.email},getAnchorHref:function(){return"mailto:"+this.email},getAnchorText:function(){return this.email}});e.match.Hashtag=e.Util.extend(e.match.Match,{getType:function(){return"hashtag"},getHashtag:function(){return this.hashtag},getAnchorHref:function(){var e=this.serviceName,t=this.hashtag;switch(e){case"twitter":return"https://twitter.com/hashtag/"+t;case"facebook":return"https://www.facebook.com/hashtag/"+t;default:throw new Error("Unknown service name to point hashtag to: ",e)}},getAnchorText:function(){return"#"+this.hashtag}});e.match.Phone=e.Util.extend(e.match.Match,{getType:function(){return"phone"},getNumber:function(){return this.number},getAnchorHref:function(){return"tel:"+this.number},getAnchorText:function(){return this.matchedText}});e.match.Twitter=e.Util.extend(e.match.Match,{getType:function(){return"twitter"},getTwitterHandle:function(){return this.twitterHandle},getAnchorHref:function(){return"https://twitter.com/"+this.twitterHandle},getAnchorText:function(){return"@"+this.twitterHandle}});e.match.Url=e.Util.extend(e.match.Match,{urlPrefixRegex:/^(https?:\/\/)?(www\.)?/i,protocolRelativeRegex:/^\/\//,protocolPrepended:false,getType:function(){return"url"},getUrl:function(){var e=this.url;if(!this.protocolRelativeMatch&&!this.protocolUrlMatch&&!this.protocolPrepended){e=this.url="http://"+e;this.protocolPrepended=true}return e},getAnchorHref:function(){var e=this.getUrl();return e.replace(/&amp;/g,"&")},getAnchorText:function(){var e=this.getUrl();if(this.protocolRelativeMatch){e=this.stripProtocolRelativePrefix(e)}if(this.stripPrefix){e=this.stripUrlPrefix(e)}e=this.removeTrailingSlash(e);return e},stripUrlPrefix:function(e){return e.replace(this.urlPrefixRegex,"")},stripProtocolRelativePrefix:function(e){return e.replace(this.protocolRelativeRegex,"")},removeTrailingSlash:function(e){if(e.charAt(e.length-1)==="/"){e=e.slice(0,-1)}return e}});return e});define("ThirdParty/zip",["../Core/buildModuleUrl","../Core/defineProperties"],function(e,t){var r={};(function(r){var i="File format is not recognized.";var n="File contains encrypted entry.";var a="File is using Zip64 (4gb+ file size).";var o="Error while reading zip file.";var s="Error while writing zip file.";var u="Error while writing file data.";var l="Error while reading file data.";var c="File already exists.";var d=512*1024;var f="inflate.js";var h="deflate.js";var p="text/plain";var m="message";var v;try{v=new Blob([new DataView(new ArrayBuffer(0))]).size===0}catch(e){}function _(){var e=-1,t=this;t.append=function(r){var i,n=t.table;for(i=0;i<r.length;i++)e=e>>>8^n[(e^r[i])&255]};t.get=function(){return~e}}_.prototype.table=function(){var e,t,r,i=[];for(e=0;e<256;e++){r=e;for(t=0;t<8;t++)if(r&1)r=r>>>1^3988292384;else r=r>>>1;i[e]=r}return i}();function g(e,t,r){if(e.slice)return e.slice(t,t+r);else if(e.webkitSlice)return e.webkitSlice(t,t+r);else if(e.mozSlice)return e.mozSlice(t,t+r);else if(e.msSlice)return e.msSlice(t,t+r)}function y(e,t){var r,i;r=new ArrayBuffer(e);i=new Uint8Array(r);if(t)i.set(t,0);return{buffer:r,array:i,view:new DataView(r)}}function w(){}function C(e){var t=this,r;function i(i,n){var a=new Blob([e],{type:p});r=new S(a);r.init(function(){t.size=r.size;i()},n)}function n(e,t,i,n){r.readUint8Array(e,t,i,n)}t.size=0;t.init=i;t.readUint8Array=n}C.prototype=new w;C.prototype.constructor=C;function b(e){var t=this,r;function i(i){var n=e.length;while(e.charAt(n-1)=="=")n--;r=e.indexOf(",")+1;t.size=Math.floor((n-r)*.75);i()}function n(t,i,n){var a,o=y(i);var s=Math.floor(t/3)*4;var u=Math.ceil((t+i)/3)*4;var l=window.atob(e.substring(s+r,u+r));var c=t-Math.floor(s/4)*3;for(a=c;a<c+i;a++)o.array[a-c]=l.charCodeAt(a);n(o.array)}t.size=0;t.init=i;t.readUint8Array=n}b.prototype=new w;b.prototype.constructor=b;function S(e){var t=this;function r(t){this.size=e.size;t()}function i(t,r,i,n){var a=new FileReader;a.onload=function(e){i(new Uint8Array(e.target.result))};a.onerror=n;a.readAsArrayBuffer(g(e,t,r))}t.size=0;t.init=r;t.readUint8Array=i}S.prototype=new w;S.prototype.constructor=S;function E(){}E.prototype.getData=function(e){e(this.data)};function T(e){var t=this,r;function i(e){r=new Blob([],{type:p});e()}function n(e,t){r=new Blob([r,v?e:e.buffer],{type:p});t()}function a(t,i){var n=new FileReader;n.onload=function(e){t(e.target.result)};n.onerror=i;n.readAsText(r,e)}t.init=i;t.writeUint8Array=n;t.getData=a}T.prototype=new E;T.prototype.constructor=T;function x(e){var t=this,r="",i="";function n(t){r+="data:"+(e||"")+";base64,";t()}function a(e,t){var n,a=i.length,o=i;i="";for(n=0;n<Math.floor((a+e.length)/3)*3-a;n++)o+=String.fromCharCode(e[n]);for(;n<e.length;n++)i+=String.fromCharCode(e[n]);if(o.length>2)r+=window.btoa(o);else i=o;t()}function o(e){e(r+window.btoa(i))}t.init=n;t.writeUint8Array=a;t.getData=o}x.prototype=new E;x.prototype.constructor=x;function A(e){var t,r=this;function i(r){t=new Blob([],{type:e});r()}function n(r,i){t=new Blob([t,v?r:r.buffer],{type:e});i()}function a(e){e(t)}r.init=i;r.writeUint8Array=n;r.getData=a}A.prototype=new E;A.prototype.constructor=A;function P(e,t,r,i,n,a,o,s,u,l){var c=0,f,h;function p(){e.removeEventListener(m,v,false);s(h)}function v(e){var t=e.data,i=t.data;if(t.onappend){h+=i.length;r.writeUint8Array(i,function(){a(false,i);_()},l)}if(t.onflush)if(i){h+=i.length;r.writeUint8Array(i,function(){a(false,i);p()},l)}else p();if(t.progress&&o)o(f+t.current,n)}function _(){f=c*d;if(f<n)t.readUint8Array(i+f,Math.min(d,n-f),function(t){e.postMessage({append:true,data:t});c++;if(o)o(f,n);a(true,t)},u);else e.postMessage({flush:true})}h=0;e.addEventListener(m,v,false);_()}function D(e,t,r,i,n,a,o,s,u,l){var c=0,f,h=0;function p(){var m;f=c*d;if(f<n)t.readUint8Array(i+f,Math.min(d,n-f),function(t){var s=e.append(t,function(){if(o)o(i+f,n)});h+=s.length;a(true,t);r.writeUint8Array(s,function(){a(false,s);c++;setTimeout(p,1)},l);if(o)o(f,n)},u);else{m=e.flush();if(m){h+=m.length;r.writeUint8Array(m,function(){a(false,m);s(h)},l)}else s(h)}}p()}function M(e,t,i,n,a,o,s,u,l){var c,d=new _;function h(e,t){if(a&&!e)d.append(t)}function p(e){o(e,d.get())}if(r.zip.useWebWorkers){c=new Worker(r.zip.workerScriptsPath+f);P(c,e,t,i,n,h,s,p,u,l)}else D(new r.zip.Inflater,e,t,i,n,h,s,p,u,l);return c}function I(e,t,i,n,a,o,s){var u,l=new _;function c(e,t){if(e)l.append(t)}function d(e){n(e,l.get())}function f(){u.removeEventListener(m,f,false);P(u,e,t,0,e.size,c,a,d,o,s)}if(r.zip.useWebWorkers){u=new Worker(r.zip.workerScriptsPath+h);u.addEventListener(m,f,false);u.postMessage({init:true,level:i})}else D(new r.zip.Deflater,e,t,0,e.size,c,a,d,o,s);return u}function O(e,t,r,i,n,a,o,s,u){var l=0,c=new _;function f(){var h=l*d;if(h<i)e.readUint8Array(r+h,Math.min(d,i-h),function(e){if(n)c.append(e);if(o)o(h,i,e);t.writeUint8Array(e,function(){l++;f()},u)},s);else a(i,c.get())}f()}function R(e){var t,r="",i,n=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","_","_","_","","","","","","","","","+","+","","","+","+","-","-","+","-","+","","","+","+","-","-","","-","+","","","","","","","i","","","","+","+","_","_","","","_","","","","","","","","","","","","","","","","","","","_","","","","","","","","","","","","_"," "];for(t=0;t<e.length;t++){i=e.charCodeAt(t)&255;if(i>127)r+=n[i-128];else r+=String.fromCharCode(i)}return r}function N(e){return decodeURIComponent(escape(e))}function L(e){var t,r="";for(t=0;t<e.length;t++)r+=String.fromCharCode(e[t]);return r}function B(e){var t=(e&4294901760)>>16,r=e&65535;try{return new Date(1980+((t&65024)>>9),((t&480)>>5)-1,t&31,(r&63488)>>11,(r&2016)>>5,(r&31)*2,0)}catch(e){}}function F(e,t,r,i,o){e.version=t.view.getUint16(r,true);e.bitFlag=t.view.getUint16(r+2,true);e.compressionMethod=t.view.getUint16(r+4,true);e.lastModDateRaw=t.view.getUint32(r+6,true);e.lastModDate=B(e.lastModDateRaw);if((e.bitFlag&1)===1){o(n);return}if(i||(e.bitFlag&8)!=8){e.crc32=t.view.getUint32(r+10,true);e.compressedSize=t.view.getUint32(r+14,true);e.uncompressedSize=t.view.getUint32(r+18,true)}if(e.compressedSize===4294967295||e.uncompressedSize===4294967295){o(a);return}e.filenameLength=t.view.getUint16(r+22,true);e.extraFieldLength=t.view.getUint16(r+24,true)}function k(e,t){function r(){}r.prototype.getData=function(r,n,a,o){var s=this,c;function d(e,t){if(c)c.terminate();c=null;if(e)e(t)}function f(e){var t=y(4);t.view.setUint32(0,e);return s.crc32==t.view.getUint32(0)}function h(e,t){if(o&&!f(t))p();else r.getData(function(e){d(n,e)})}function p(){d(t,l)}function m(){d(t,u)}e.readUint8Array(s.offset,30,function(n){var u=y(n.length,n),l;if(u.view.getUint32(0)!=1347093252){t(i);return}F(s,u,4,false,t);l=s.offset+30+s.filenameLength+s.extraFieldLength;r.init(function(){if(s.compressionMethod===0)O(e,r,l,s.compressedSize,o,h,a,p,m);else c=M(e,r,l,s.compressedSize,o,h,a,p,m)},m)},p)};function n(r,i){e.readUint8Array(e.size-r,r,function(e){var t=y(e.length,e).view;if(t.getUint32(0)!=1347093766){n(r+1,i)}else{i(t)}},function(){t(o)})}return{getEntries:function(a){if(e.size<22){t(i);return}n(22,function(n){var s,u;s=n.getUint32(16,true);u=n.getUint16(8,true);e.readUint8Array(s,e.size-s,function(e){var n,o=0,s=[],l,c,d,f=y(e.length,e);for(n=0;n<u;n++){l=new r;if(f.view.getUint32(o)!=1347092738){t(i);return}F(l,f,o+6,true,t);l.commentLength=f.view.getUint16(o+32,true);l.directory=(f.view.getUint8(o+38)&16)==16;l.offset=f.view.getUint32(o+42,true);c=L(f.array.subarray(o+46,o+46+l.filenameLength));l.filename=(l.bitFlag&2048)===2048?N(c):R(c);if(!l.directory&&l.filename.charAt(l.filename.length-1)=="/")l.directory=true;d=L(f.array.subarray(o+46+l.filenameLength+l.extraFieldLength,o+46+l.filenameLength+l.extraFieldLength+l.commentLength));l.comment=(l.bitFlag&2048)===2048?N(d):R(d);s.push(l);o+=46+l.filenameLength+l.extraFieldLength+l.commentLength}a(s)},function(){t(o)})})},close:function(e){if(e)e()}}}function V(e){return unescape(encodeURIComponent(e))}function z(e){var t,r=[];for(t=0;t<e.length;t++)r.push(e.charCodeAt(t));return r}function U(e,t,r){var i,n={},a=[],o=0;function u(e,t){if(i)i.terminate();i=null;if(e)e(t)}function d(){u(t,s)}function f(){u(t,l)}return{add:function(s,l,h,p,m){var v,_,g;function w(t){var i;g=m.lastModDate||new Date;v=y(26);n[s]={headerArray:v.array,directory:m.directory,filename:_,offset:o,comment:z(V(m.comment||""))};v.view.setUint32(0,335546376);if(m.version)v.view.setUint8(0,m.version);if(!r&&m.level!==0&&!m.directory)v.view.setUint16(4,2048);v.view.setUint16(6,(g.getHours()<<6|g.getMinutes())<<5|g.getSeconds()/2,true);v.view.setUint16(8,(g.getFullYear()-1980<<4|g.getMonth()+1)<<5|g.getDate(),true);v.view.setUint16(22,_.length,true);i=y(30+_.length);i.view.setUint32(0,1347093252);i.array.set(v.array,4);i.array.set(_,30);o+=i.array.length;e.writeUint8Array(i.array,t,d)}function C(t,r){var i=y(16);o+=t||0;i.view.setUint32(0,1347094280);if(typeof r!="undefined"){v.view.setUint32(10,r,true);i.view.setUint32(4,r,true)}if(l){i.view.setUint32(8,t,true);v.view.setUint32(14,t,true);i.view.setUint32(12,l.size,true);v.view.setUint32(18,l.size,true)}e.writeUint8Array(i.array,function(){o+=16;u(h)},d)}function b(){m=m||{};s=s.trim();if(m.directory&&s.charAt(s.length-1)!="/")s+="/";if(n.hasOwnProperty(s)){t(c);return}_=z(V(s));a.push(s);w(function(){if(l)if(r||m.level===0)O(l,e,0,l.size,true,C,p,f,d);else i=I(l,e,m.level,C,p,f,d);else C()},d)}if(l)l.init(b,f);else b()},close:function(t){var r,i=0,s=0,l,c;for(l=0;l<a.length;l++){c=n[a[l]];i+=46+c.filename.length+c.comment.length}r=y(i+22);for(l=0;l<a.length;l++){c=n[a[l]];r.view.setUint32(s,1347092738);r.view.setUint16(s+4,5120);r.array.set(c.headerArray,s+6);r.view.setUint16(s+32,c.comment.length,true);if(c.directory)r.view.setUint8(s+38,16);r.view.setUint32(s+42,c.offset,true);r.array.set(c.filename,s+46);r.array.set(c.comment,s+46+c.filename.length);s+=46+c.filename.length+c.comment.length}r.view.setUint32(s,1347093766);r.view.setUint16(s+8,a.length,true);r.view.setUint16(s+10,a.length,true);r.view.setUint32(s+12,i,true);r.view.setUint32(s+16,o,true);e.writeUint8Array(r.array,function(){u(function(){e.getData(t)})},d)}}}r.zip={Reader:w,Writer:E,BlobReader:S,Data64URIReader:b,TextReader:C,BlobWriter:A,Data64URIWriter:x,TextWriter:T,createReader:function(e,t,r){e.init(function(){t(k(e,r))},r)},createWriter:function(e,t,r,i){e.init(function(){t(U(e,r,i))},r)},useWebWorkers:true};var q;t(r.zip,{workerScriptsPath:{get:function(){if(typeof q==="undefined"){q=e("ThirdParty/Workers/")}return q}}})})(r);return r.zip});define("DataSources/KmlDataSource",["../Core/AssociativeArray","../Core/BoundingRectangle","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartographic","../Core/ClockRange","../Core/ClockStep","../Core/Color","../Core/createGuid","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Ellipsoid","../Core/Event","../Core/getAbsoluteUri","../Core/getExtensionFromUri","../Core/getFilenameFromUri","../Core/Iso8601","../Core/joinUrls","../Core/JulianDate","../Core/loadBlob","../Core/loadXML","../Core/Math","../Core/NearFarScalar","../Core/PinBuilder","../Core/PolygonHierarchy","../Core/Rectangle","../Core/RequestScheduler","../Core/RuntimeError","../Core/TimeInterval","../Core/TimeIntervalCollection","../Scene/HeightReference","../Scene/HorizontalOrigin","../Scene/LabelStyle","../Scene/SceneMode","../ThirdParty/Autolinker","../ThirdParty/Uri","../ThirdParty/when","../ThirdParty/zip","./BillboardGraphics","./CompositePositionProperty","./CorridorGraphics","./DataSource","./DataSourceClock","./Entity","./EntityCluster","./EntityCollection","./LabelGraphics","./PathGraphics","./PolygonGraphics","./PolylineGraphics","./PositionPropertyArray","./RectangleGraphics","./ReferenceProperty","./SampledPositionProperty","./ScaledPositionProperty","./TimeIntervalCollectionProperty","./WallGraphics"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w,C,b,S,E,T,x,A,P,D,M,I,O,R,N,L,B,F,k,V,z,U,q,G,H,W,j,Y,X,Z,K,Q,J,$,ee,te,re,ie,ne){"use strict";if(typeof DOMParser==="undefined"){return{}}var ae={avi:"video/x-msvideo",bmp:"image/bmp",bz2:"application/x-bzip2",chm:"application/vnd.ms-htmlhelp",css:"text/css",csv:"text/csv",doc:"application/msword",dvi:"application/x-dvi",eps:"application/postscript",flv:"video/x-flv",gif:"image/gif",gz:"application/x-gzip",htm:"text/html",html:"text/html",ico:"image/vnd.microsoft.icon",jnlp:"application/x-java-jnlp-file",jpeg:"image/jpeg",jpg:"image/jpeg",m3u:"audio/x-mpegurl",m4v:"video/mp4",mathml:"application/mathml+xml",mid:"audio/midi",midi:"audio/midi",mov:"video/quicktime",mp3:"audio/mpeg",mp4:"video/mp4",mp4v:"video/mp4",mpeg:"video/mpeg",mpg:"video/mpeg",odp:"application/vnd.oasis.opendocument.presentation",ods:"application/vnd.oasis.opendocument.spreadsheet",odt:"application/vnd.oasis.opendocument.text",ogg:"application/ogg",pdf:"application/pdf",png:"image/png",pps:"application/vnd.ms-powerpoint",ppt:"application/vnd.ms-powerpoint",ps:"application/postscript",qt:"video/quicktime",rdf:"application/rdf+xml",rss:"application/rss+xml",rtf:"application/rtf",svg:"image/svg+xml",swf:"application/x-shockwave-flash",text:"text/plain",tif:"image/tiff",tiff:"image/tiff",txt:"text/plain",wav:"audio/x-wav",wma:"audio/x-ms-wma",wmv:"video/x-ms-wmv",xml:"application/xml",zip:"application/zip",detectFromFilename:function(e){var t=e.toLowerCase();t=v(t);return ae[t]}};var oe=new DOMParser;var se=new B({stripPrefix:false,twitter:false,email:false,replaceFn:function(e,t){if(!t.protocolUrlMatch){return false}}});var ue=32;var le=2414016;var ce=1;var de=16093e3;var fe=.1;function he(e){var t=e.slice(0,Math.min(4,e.size));var r=k.defer();var i=new FileReader;i.addEventListener("load",function(){r.resolve(new DataView(i.result).getUint32(0,false)===1347093252)});i.addEventListener("error",function(){r.reject(i.error)});i.readAsArrayBuffer(t);return r.promise}function pe(e){var t=k.defer();var r=new FileReader;r.addEventListener("load",function(){t.resolve(r.result)});r.addEventListener("error",function(){t.reject(r.error)});r.readAsText(e);return t.promise}function me(e,t,r,i){t.getData(new V.TextWriter,function(e){r.kml=oe.parseFromString(e,"application/xml");i.resolve()})}function ve(e,t,r,i){var n=l(ae.detectFromFilename(t.filename),"application/octet-stream");t.getData(new V.Data64URIWriter(n),function(e){r[t.filename]=e;i.resolve()})}function _e(e,t,r,i){var n=i.keys;var a=new F(".");var o=e.querySelectorAll(t);for(var s=0;s<o.length;s++){var u=o[s];var l=u.getAttribute(r);var c=new F(l).resolve(a).toString();var d=n.indexOf(c);if(d!==-1){var f=n[d];u.setAttribute(r,i[f]);if(t==="a"&&u.getAttribute("download")===null){u.setAttribute("download",f)}}}}function ge(e,t){if(c(t)){if(new F(e).isAbsolute()){e=t.getURL(e)}}return e}function ye(e,t,r){var i=Pe(e,"id");i=c(i)&&i.length!==0?i:u();if(c(r)){i=r+i}var n=t.getById(i);if(c(n)){i=u();if(c(r)){i=r+i}}n=t.add(new W({id:i}));if(!c(n.kml)){n.addProperty("kml");n.kml=new kt}return n}function we(e,t){return e==="absolute"||e==="relativeToGround"||t==="relativeToSeaFloor"}function Ce(e){if(!c(e)){return i.fromDegrees(0,0,0)}var t=e.match(/[^\s,\n]+/g);if(!c(t)){return i.fromDegrees(0,0,0)}var r=parseFloat(t[0]);var n=parseFloat(t[1]);var a=parseFloat(t[2]);r=isNaN(r)?0:r;n=isNaN(n)?0:n;a=isNaN(a)?0:a;return i.fromDegrees(r,n,a)}function be(e){if(!c(e)){return undefined}var t=e.textContent.match(/[^\s\n]+/g);if(!c(t)){return undefined}var r=t.length;var i=new Array(r);var n=0;for(var a=0;a<r;a++){i[n++]=Ce(t[a])}return i}var Se=[null,undefined,"http://www.opengis.net/kml/2.2","http://earth.google.com/kml/2.2","http://earth.google.com/kml/2.1","http://earth.google.com/kml/2.0"];var Ee=["http://www.google.com/kml/ext/2.2"];var Te=["http://www.w3.org/2005/Atom"];var xe={kml:Se,gx:Ee,atom:Te,kmlgx:Se.concat(Ee)};function Ae(e,t){if(!c(e)){return undefined}var r=e.getAttribute(t);if(r!==null){var i=parseFloat(r);return!isNaN(i)?i:undefined}return undefined}function Pe(e,t){if(!c(e)){return undefined}var r=e.getAttribute(t);return r!==null?r:undefined}function De(e,t,r){if(!c(e)){return undefined}var i=e.childNodes;var n=i.length;for(var a=0;a<n;a++){var o=i[a];if(o.localName===t&&r.indexOf(o.namespaceURI)!==-1){return o}}return undefined}function Me(e,t,r){if(!c(e)){return undefined}var i=[];var n=e.getElementsByTagNameNS("*",t);var a=n.length;for(var o=0;o<a;o++){var s=n[o];if(s.localName===t&&r.indexOf(s.namespaceURI)!==-1){i.push(s)}}return i}function Ie(e,t,r){if(!c(e)){return[]}var i=[];var n=e.childNodes;var a=n.length;for(var o=0;o<a;o++){var s=n[o];if(s.localName===t&&r.indexOf(s.namespaceURI)!==-1){i.push(s)}}return i}function Oe(e,t,r){var i=De(e,t,r);if(c(i)){var n=parseFloat(i.textContent);return!isNaN(n)?n:undefined}return undefined}function Re(e,t,r){var i=De(e,t,r);if(c(i)){return i.textContent.trim()}return undefined}function Ne(e,t,r){var i=De(e,t,r)
;if(c(i)){var n=i.textContent.trim();return n==="1"||/^true$/i.test(n)}return undefined}function Le(e,t,r,i){if(!c(e)){return undefined}var n=false;if(c(i)){var a=i[e];if(c(a)){n=true;e=a}else{var o=m(e,r);a=i[o];if(c(a)){n=true;e=a}}}if(!n&&c(r)){e=m(e,m(r));e=ge(e,t)}return e}var Be={};function Fe(e,t){if(!c(e)||/^\s*$/gm.test(e)){return undefined}if(e[0]==="#"){e=e.substring(1)}var r=parseInt(e.substring(0,2),16)/255;var i=parseInt(e.substring(2,4),16)/255;var n=parseInt(e.substring(4,6),16)/255;var a=parseInt(e.substring(6,8),16)/255;if(!t){return new s(a,n,i,r)}if(a>0){Be.maximumRed=a}else{Be.red=0}if(n>0){Be.maximumGreen=n}else{Be.green=0}if(i>0){Be.maximumBlue=i}else{Be.blue=0}Be.alpha=r;return s.fromRandom(Be)}function ke(e,t,r){var i=Re(e,t,r);if(!c(i)){return undefined}return Fe(i,Re(e,"colorMode",r)==="random")}function Ve(e){var t=De(e,"TimeStamp",xe.kmlgx);var r=Re(t,"when",xe.kmlgx);if(!c(t)||!c(r)||r.length===0){return undefined}var i=w.fromIso8601(r);var n=new I;n.addInterval(new M({start:i,stop:g.MAXIMUM_VALUE}));return n}function ze(e){var t=De(e,"TimeSpan",xe.kmlgx);if(!c(t)){return undefined}var r;var i=De(t,"begin",xe.kmlgx);var n=c(i)?w.fromIso8601(i.textContent):undefined;var a=De(t,"end",xe.kmlgx);var o=c(a)?w.fromIso8601(a.textContent):undefined;if(c(n)&&c(o)){if(w.lessThan(o,n)){var s=n;n=o;o=s}r=new I;r.addInterval(new M({start:n,stop:o}))}else if(c(n)){r=new I;r.addInterval(new M({start:n,stop:g.MAXIMUM_VALUE}))}else if(c(o)){r=new I;r.addInterval(new M({start:g.MINIMUM_VALUE,stop:o}))}return r}function Ue(){var e=new z;e.width=ue;e.height=ue;e.scaleByDistance=new E(le,ce,de,fe);e.pixelOffsetScaleByDistance=new E(le,ce,de,fe);return e}function qe(){var e=new K;e.outline=true;e.outlineColor=s.WHITE;return e}function Ge(){var e=new X;e.translucencyByDistance=new E(3e6,1,5e6,0);e.pixelOffset=new r(17,0);e.horizontalOrigin=R.LEFT;e.font="16px sans-serif";e.style=N.FILL_AND_OUTLINE;return e}function He(e,t,r,i,n){var a=Re(e,"href",xe.kml);if(!c(a)||a.length===0){return undefined}if(a.indexOf("root://icons/palette-")===0){var o=a.charAt(21);var s=l(Oe(e,"x",xe.gx),0);var u=l(Oe(e,"y",xe.gx),0);s=Math.min(s/32,7);u=7-Math.min(u/32,7);var d=8*u+s;a="https://maps.google.com/mapfiles/kml/pal"+o+"/icon"+d+".png"}a=Le(a,t._proxy,r,i);if(n){var f=Re(e,"refreshMode",xe.kml);var h=Re(e,"viewRefreshMode",xe.kml);if(f==="onInterval"||f==="onExpire"){console.log("KML - Unsupported Icon refreshMode: "+f)}else if(h==="onStop"||h==="onRegion"){console.log("KML - Unsupported Icon viewRefreshMode: "+h)}var p=l(Re(e,"viewBoundScale",xe.kml),1);var m=h==="onStop"?"BBOX=[bboxWest],[bboxSouth],[bboxEast],[bboxNorth]":"";var v=l(Re(e,"viewFormat",xe.kml),m);var _=Re(e,"httpQuery",xe.kml);var g=bt(v,_);var w=y(a,g,false);return At(t._camera,t._canvas,w,p,t._lastCameraView.bbox)}return a}function We(e,n,a,o,s){var u=Oe(n,"scale",xe.kml);var d=Oe(n,"heading",xe.kml);var f=ke(n,"color",xe.kml);var h=De(n,"Icon",xe.kml);var p=He(h,e,o,s,false);var m=Oe(h,"x",xe.gx);var v=Oe(h,"y",xe.gx);var _=Oe(h,"w",xe.gx);var g=Oe(h,"h",xe.gx);var y=De(n,"hotSpot",xe.kml);var w=Ae(y,"x");var C=Ae(y,"y");var b=Pe(y,"xunits");var E=Pe(y,"yunits");var T=a.billboard;if(!c(T)){T=Ue();a.billboard=T}T.image=p;T.scale=u;T.color=f;if(c(m)||c(v)||c(_)||c(g)){T.imageSubRegion=new t(m,v,_,g)}if(c(d)&&d!==0){T.rotation=S.toRadians(-d);T.alignedAxis=i.UNIT_Z}u=l(u,1);var x;var A;if(c(w)){if(b==="pixels"){x=-w*u}else if(b==="insetPixels"){x=(w-ue)*u}else if(b==="fraction"){x=-w*ue*u}x+=ue*.5*u}if(c(C)){if(E==="pixels"){A=C*u}else if(E==="insetPixels"){A=(-C+ue)*u}else if(E==="fraction"){A=C*ue*u}A-=ue*.5*u}if(c(x)||c(A)){T.pixelOffset=new r(x,A)}}function je(e,t,r,i,n){for(var a=0,o=t.childNodes.length;a<o;a++){var u=t.childNodes.item(a);if(u.localName==="IconStyle"){We(e,u,r,i,n)}else if(u.localName==="LabelStyle"){var d=r.label;if(!c(d)){d=Ge();r.label=d}d.scale=l(Oe(u,"scale",xe.kml),d.scale);d.fillColor=l(ke(u,"color",xe.kml),d.fillColor);d.text=r.name}else if(u.localName==="LineStyle"){var f=r.polyline;if(!c(f)){f=new Q;r.polyline=f}f.width=Oe(u,"width",xe.kml);f.material=ke(u,"color",xe.kml);if(c(ke(u,"outerColor",xe.gx))){console.log("KML - gx:outerColor is not supported in a LineStyle")}if(c(Oe(u,"outerWidth",xe.gx))){console.log("KML - gx:outerWidth is not supported in a LineStyle")}if(c(Oe(u,"physicalWidth",xe.gx))){console.log("KML - gx:physicalWidth is not supported in a LineStyle")}if(c(Ne(u,"labelVisibility",xe.gx))){console.log("KML - gx:labelVisibility is not supported in a LineStyle")}}else if(u.localName==="PolyStyle"){var h=r.polygon;if(!c(h)){h=qe();r.polygon=h}h.material=l(ke(u,"color",xe.kml),h.material);h.fill=l(Ne(u,"fill",xe.kml),h.fill);h.outline=l(Ne(u,"outline",xe.kml),h.outline)}else if(u.localName==="BalloonStyle"){var p=l(Fe(Re(u,"bgColor",xe.kml)),s.WHITE);var m=l(Fe(Re(u,"textColor",xe.kml)),s.BLACK);var v=Re(u,"text",xe.kml);r.addProperty("balloonStyle");r.balloonStyle={bgColor:p,textColor:m,text:v}}else if(u.localName==="ListStyle"){var _=Re(u,"listItemType",xe.kml);if(_==="radioFolder"||_==="checkOffOnly"){console.log("KML - Unsupported ListStyle with listItemType: "+_)}}}}function Ye(e,t,r,i,n,a){var o=new W;var s;var u=-1;var l=r.childNodes;var d=l.length;for(var f=0;f<d;f++){var h=l[f];if(h.localName==="Style"||h.localName==="StyleMap"){u=f}}if(u!==-1){var p=l[u];if(p.localName==="Style"){je(t,p,o,n,a)}else{var v=Ie(p,"Pair",xe.kml);for(var _=0;_<v.length;_++){var g=v[_];var y=Re(g,"key",xe.kml);if(y==="normal"){var w=Re(g,"styleUrl",xe.kml);if(c(w)){s=i.getById(w);if(!c(s)){s=i.getById("#"+w)}if(c(s)){o.merge(s)}}else{var C=De(g,"Style",xe.kml);je(t,C,o,n,a)}}else{console.log("KML - Unsupported StyleMap key: "+y)}}}}var b=Re(r,"styleUrl",xe.kml);if(c(b)){var S=b;if(b[0]!=="#"&&b.indexOf("#")!==-1){var E=b.split("#");var T=E[0];if(c(n)){T=m(T,m(n))}S=T+"#"+E[1]}s=i.getById(S);if(!c(s)){s=i.getById("#"+S)}if(c(s)){o.merge(s)}}return o}function Xe(e,t,r){return k(P.request(ge(t,e._proxy),b),function(i){return Ze(e,i,r,t,true)})}function Ze(e,t,r,i,n,a){var o;var s;var u;var l;var d=Me(t,"Style",xe.kml);if(c(d)){var f=d.length;for(o=0;o<f;o++){l=d[o];s=Pe(l,"id");if(c(s)){s="#"+s;if(n&&c(i)){s=i+s}if(!c(r.getById(s))){u=new W({id:s});r.add(u);je(e,l,u,i,a)}}}}var h=Me(t,"StyleMap",xe.kml);if(c(h)){var p=h.length;for(o=0;o<p;o++){var v=h[o];s=Pe(v,"id");if(c(s)){var _=Ie(v,"Pair",xe.kml);for(var g=0;g<_.length;g++){var y=_[g];var w=Re(y,"key",xe.kml);if(w==="normal"){s="#"+s;if(n&&c(i)){s=i+s}if(!c(r.getById(s))){u=r.getOrCreateEntity(s);var C=Re(y,"styleUrl",xe.kml);if(c(C)){if(C[0]!=="#"){C="#"+C}if(n&&c(i)){C=i+C}var b=r.getById(C);if(c(b)){u.merge(b)}}else{l=De(y,"Style",xe.kml);je(e,l,u,i,a)}}}else{console.log("KML - Unsupported StyleMap key: "+w)}}}}}var S={};var E=[];var T=t.getElementsByTagName("styleUrl");var x=T.length;for(o=0;o<x;o++){var A=T[o].textContent;if(A[0]!=="#"){var P=A.split("#");if(P.length===2){var D=P[0];if(!c(S[D])){if(c(i)){D=m(D,m(i))}E.push(Xe(e,D,r,i))}}}}return E}function Ke(e,t,r){var i=new ee(e,t.id,["position"]);var n=new re(t.position);t.polyline=c(r.polyline)?r.polyline.clone():new Q;t.polyline.positions=new J([i,n])}function Qe(e,t){if(!c(e)&&!c(t)||e==="clampToGround"){return O.CLAMP_TO_GROUND}if(e==="relativeToGround"){return O.RELATIVE_TO_GROUND}if(e==="absolute"){return O.NONE}if(t==="clampToSeaFloor"){console.log("KML - <gx:altitudeMode>:clampToSeaFloor is currently not supported, using <kml:altitudeMode>:clampToGround.");return O.CLAMP_TO_GROUND}if(t==="relativeToSeaFloor"){console.log("KML - <gx:altitudeMode>:relativeToSeaFloor is currently not supported, using <kml:altitudeMode>:relativeToGround.");return O.RELATIVE_TO_GROUND}if(c(e)){console.log("KML - Unknown <kml:altitudeMode>:"+e+", using <kml:altitudeMode>:CLAMP_TO_GROUND.")}else{console.log("KML - Unknown <gx:altitudeMode>:"+t+", using <kml:altitudeMode>:CLAMP_TO_GROUND.")}return O.CLAMP_TO_GROUND}function Je(e,t,r){if(r==="relativeToSeaFloor"||t==="absolute"||t==="relativeToGround"){return e}if(c(t)&&t!=="clampToGround"||c(r)&&r!=="clampToSeaFloor"){console.log("KML - Unknown altitudeMode: "+l(t,r))}return new re(e)}function $e(e,t,r){if(!c(e)){return undefined}if(r==="relativeToSeaFloor"||t==="absolute"||t==="relativeToGround"){return e}if(c(t)&&t!=="clampToGround"||c(r)&&r!=="clampToSeaFloor"){console.log("KML - Unknown altitudeMode: "+l(t,r))}var i=e.length;for(var n=0;n<i;n++){var a=e[n];h.WGS84.scaleToGeodeticSurface(a,a)}return e}function et(e,t,i,n){var a=t.label;if(!c(a)){a=c(i.label)?i.label.clone():Ge();t.label=a}a.text=t.name;var o=t.billboard;if(!c(o)){o=c(i.billboard)?i.billboard.clone():Ue();t.billboard=o}if(!c(o.image)){o.image=e._pinBuilder.fromColor(s.YELLOW,64)}var u=1;if(c(o.scale)){u=o.scale.getValue();if(u!==0){a.pixelOffset=new r(u*16+1,0)}else{a.pixelOffset=undefined;a.horizontalOrigin=undefined}}if(c(n)&&e._clampToGround){o.heightReference=n;a.heightReference=n}}function tt(e,t,r){var i=t.path;if(!c(i)){i=new Z;i.leadTime=0;t.path=i}var n=r.polyline;if(c(n)){i.material=n.material;i.width=n.width}}function rt(e,t,r,i,n){var a=Re(r,"coordinates",xe.kml);var o=Re(r,"altitudeMode",xe.kml);var s=Re(r,"altitudeMode",xe.gx);var u=Ne(r,"extrude",xe.kml);var l=Ce(a);i.position=l;et(e,i,n,Qe(o,s));if(u&&we(o,s)){Ke(t,i,n)}return true}function it(e,t,r,i,n){var a=De(r,"coordinates",xe.kml);var o=Re(r,"altitudeMode",xe.kml);var u=Re(r,"altitudeMode",xe.gx);var d=Ne(r,"extrude",xe.kml);var f=Ne(r,"tessellate",xe.kml);var h=we(o,u);if(c(Oe(r,"drawOrder",xe.gx))){console.log("KML - gx:drawOrder is not supported in LineStrings")}var p=be(a);var m=n.polyline;if(h&&d){var v=new ne;i.wall=v;v.positions=p;var _=n.polygon;if(c(_)){v.fill=_.fill;v.material=_.material}v.outline=true;if(c(m)){v.outlineColor=c(m.material)?m.material.color:s.WHITE;v.outlineWidth=m.width}else if(c(_)){v.outlineColor=c(_.material)?_.material.color:s.WHITE}}else{if(e._clampToGround&&!h&&f){var y=new q;i.corridor=y;y.positions=p;if(c(m)){y.material=c(m.material)?m.material.color.getValue(g.MINIMUM_VALUE):s.WHITE;y.width=l(m.width,1)}else{y.material=s.WHITE;y.width=1}}else{m=c(m)?m.clone():new Q;i.polyline=m;m.positions=$e(p,o,u);if(!f||h){m.followSurface=false}}}return true}function nt(e,t,r,i,n){var a=De(r,"outerBoundaryIs",xe.kml);var o=De(a,"LinearRing",xe.kml);var u=De(o,"coordinates",xe.kml);var l=be(u);var d=Ne(r,"extrude",xe.kml);var f=Re(r,"altitudeMode",xe.kml);var h=Re(r,"altitudeMode",xe.gx);var p=we(f,h);var m=c(n.polygon)?n.polygon.clone():qe();var v=n.polyline;if(c(v)){m.outlineColor=c(v.material)?v.material.color:s.WHITE;m.outlineWidth=v.width}i.polygon=m;if(p){m.perPositionHeight=true;m.extrudedHeight=d?0:undefined}else if(!e._clampToGround){m.height=0}if(c(l)){var _=new x(l);var g=Ie(r,"innerBoundaryIs",xe.kml);for(var y=0;y<g.length;y++){o=Ie(g[y],"LinearRing",xe.kml);for(var w=0;w<o.length;w++){u=De(o[w],"coordinates",xe.kml);l=be(u);if(c(l)){_.holes.push(new x(l))}}}m.hierarchy=_}return true}function at(e,t,r,i,n){var a=Re(r,"altitudeMode",xe.kml);var o=Re(r,"altitudeMode",xe.gx);var s=Ie(r,"coord",xe.gx);var u=Ie(r,"angles",xe.gx);var l=Ie(r,"when",xe.kml);var c=Ne(r,"extrude",xe.kml);var d=we(a,o);if(u.length>0){console.log("KML - gx:angles are not supported in gx:Tracks")}var f=Math.min(s.length,l.length);var h=[];var p=[];for(var m=0;m<f;m++){var v=Ce(s[m].textContent);h.push(v);p.push(w.fromIso8601(l[m].textContent))}var _=new te;_.addSamples(p,h);i.position=_;et(e,i,n,Qe(a,o));tt(e,i,n);i.availability=new I;if(l.length>0){i.availability.addInterval(new M({start:p[0],stop:p[p.length-1]}))}if(d&&c){Ke(t,i,n)}return true}function ot(e,t,r,i,n,a,o,s,u){var l=e[0];var c=e[e.length-1];var d=new te;d.addSamples(e,t);r.intervals.addInterval(new M({start:l,stop:c,isStartIncluded:u,isStopIncluded:u,data:Je(d,o,s)}));i.addInterval(new M({start:l,stop:c,isStartIncluded:u,isStopIncluded:u}));n.intervals.addInterval(new M({start:l,stop:c,isStartIncluded:u,isStopIncluded:u,data:a}))}function st(e,t,r,i,n){var a=Ne(r,"interpolate",xe.gx);var o=Ie(r,"Track",xe.gx);var s;var u;var l;var d=false;var f=new ie;var h=new I;var p=new U;for(var m=0,v=o.length;m<v;m++){var _=o[m];var g=Ie(_,"when",xe.kml);var y=Ie(_,"coord",xe.gx);var C=Re(_,"altitudeMode",xe.kml);var b=Re(_,"altitudeMode",xe.gx);var S=we(C,b);var E=Ne(_,"extrude",xe.kml);var T=Math.min(y.length,g.length);var x=[];s=[];for(var A=0;A<T;A++){var P=Ce(y[A].textContent);x.push(P);s.push(w.fromIso8601(g[A].textContent))}if(a){if(c(u)){ot([u,s[0]],[l,x[0]],p,h,f,false,"absolute",undefined,false)}u=s[T-1];l=x[x.length-1]}ot(s,x,p,h,f,S&&E,C,b,true);d=d||S&&E}i.availability=h;i.position=p;et(e,i,n);tt(e,i,n);if(d){Ke(t,i,n);i.polyline.show=f}return true}function ut(e,t,r,i,n,a){var o=r.childNodes;var s=false;for(var u=0,l=o.length;u<l;u++){var d=o.item(u);var f=pt[d.localName];if(c(f)){var h=ye(d,t,a);h.parent=i;h.name=i.name;h.availability=i.availability;h.description=i.description;h.kml=i.kml;if(f(e,t,d,h,n)){s=true}}}return s}function lt(e,t,r,i,n){console.log("KML - Unsupported geometry: "+r.localName);return false}function ct(e,t){var r=De(e,"ExtendedData",xe.kml);if(!c(r)){return undefined}if(c(De(r,"SchemaData",xe.kml))){console.log("KML - SchemaData is unsupported")}if(c(Pe(r,"xmlns:prefix"))){console.log("KML - ExtendedData with xmlns:prefix is unsupported")}var i={};var n=Ie(r,"Data",xe.kml);if(c(n)){var a=n.length;for(var o=0;o<a;o++){var s=n[o];var u=Pe(s,"name");if(c(u)){i[u]={displayName:Re(s,"displayName",xe.kml),value:Re(s,"value",xe.kml)}}}}t.kml.extendedData=i}var dt=document.createElement("div");function ft(e,t,r,i){var n;var a;var o;var u=t.kml;var d=u.extendedData;var f=Re(e,"description",xe.kml);var h=l(t.balloonStyle,r.balloonStyle);var p=s.WHITE;var m=s.BLACK;var v=f;if(c(h)){p=l(h.bgColor,s.WHITE);m=l(h.textColor,s.BLACK);v=l(h.text,f)}var _;if(c(v)){v=v.replace("$[name]",l(t.name,""));v=v.replace("$[description]",l(f,""));v=v.replace("$[address]",l(u.address,""));v=v.replace("$[Snippet]",l(u.snippet,""));v=v.replace("$[id]",t.id);v=v.replace("$[geDirections]","");if(c(d)){var g=v.match(/\$\[.+?\]/g);if(g!==null){for(n=0;n<g.length;n++){var y=g[n];var w=y.substr(2,y.length-3);var C=/\/displayName$/.test(w);w=w.replace(/\/displayName$/,"");_=d[w];if(c(_)){_=C?_.displayName:_.value}if(c(_)){v=v.replace(y,l(_,""))}}}}}else if(c(d)){o=Object.keys(d);if(o.length>0){v='<table class="cesium-infoBox-defaultTable cesium-infoBox-defaultTable-lighter"><tbody>';for(n=0;n<o.length;n++){a=o[n];_=d[a];v+="<tr><th>"+l(_.displayName,a)+"</th><td>"+l(_.value,"")+"</td></tr>"}v+="</tbody></table>"}}if(!c(v)){return}v=se.link(v);dt.innerHTML=v;var b=dt.querySelectorAll("a");for(n=0;n<b.length;n++){b[n].setAttribute("target","_blank")}if(c(i)&&i.keys.length>1){_e(dt,"a","href",i);_e(dt,"img","src",i)}var S='<div class="cesium-infoBox-description-lighter" style="';S+="overflow:auto;";S+="word-wrap:break-word;";S+="background-color:"+p.toCssColorString()+";";S+="color:"+m.toCssColorString()+";";S+='">';S+=dt.innerHTML+"</div>";dt.innerHTML="";t.description=S}function ht(e,t,r,i,n,a,o,s,u){var d=ye(r,i,u);var f=d.kml;var h=Ye(d,e,r,n,a,o);var p=Re(r,"name",xe.kml);d.name=p;d.parent=t;var m=ze(r);if(!c(m)){m=Ve(r)}d.availability=m;Lt(d);function v(e){if(!e){return true}return e.show&&v(e.parent)}var _=Ne(r,"visibility",xe.kml);d.show=v(t)&&l(_,true);var g=De(r,"author",xe.atom);var y=f.author;y.name=Re(g,"name",xe.atom);y.uri=Re(g,"uri",xe.atom);y.email=Re(g,"email",xe.atom);var w=De(r,"link",xe.atom);var C=f.link;C.href=Pe(w,"href");C.hreflang=Pe(w,"hreflang");C.rel=Pe(w,"rel");C.type=Pe(w,"type");C.title=Pe(w,"title");C.length=Pe(w,"length");f.address=Re(r,"address",xe.kml);f.phoneNumber=Re(r,"phoneNumber",xe.kml);f.snippet=Re(r,"Snippet",xe.kml);ct(r,d);ft(r,d,h,o);if(c(De(r,"Camera",xe.kml))){console.log("KML - Unsupported view: Camera")}if(c(De(r,"LookAt",xe.kml))){console.log("KML - Unsupported view: LookAt")}if(c(De(r,"Region",xe.kml))){console.log("KML - Placemark Regions are unsupported")}return{entity:d,styleEntity:h}}var pt={Point:rt,LineString:it,LinearRing:it,Polygon:nt,Track:at,MultiTrack:st,MultiGeometry:ut,Model:lt};function mt(e,t,r,i,n,a,o,s,u){var l=Object.keys(Dt);var c=l.length;for(var d=0;d<c;d++){var f=l[d];var h=Dt[f];var p=r.childNodes;var m=p.length;for(var v=0;v<m;v++){var _=p[v];if(_.localName===f&&(xe.kml.indexOf(_.namespaceURI)!==-1||xe.gx.indexOf(_.namespaceURI)!==-1)){h(e,t,_,i,n,a,o,s,u)}}}}function vt(e,t,r,i,n,a,o,s,u){var l=ht(e,t,r,i,n,a,o,s,u);mt(e,l.entity,r,i,n,a,o,s,u)}function _t(e,t,r,i,n,a,o,s,u){var l=ht(e,t,r,i,n,a,o,s,u);var d=l.entity;var f=l.styleEntity;var h=false;var p=r.childNodes;for(var m=0,v=p.length;m<v&&!h;m++){var _=p.item(m);var g=pt[_.localName];if(c(g)){g(e,i,_,d,f,d.id);h=true}}if(!h){d.merge(f);et(e,d,f)}}function gt(e,t,r,i,n,a,o,s,u){var l=ht(e,t,r,i,n,a,o,s,u);var d=l.entity;var f;var h=false;var p=be(De(r,"LatLonQuad",xe.gx));if(c(p)){f=qe();f.hierarchy=new x(p);d.polygon=f;h=true}else{f=new $;d.rectangle=f;var m=De(r,"LatLonBox",xe.kml);if(c(m)){var v=Oe(m,"west",xe.kml);var _=Oe(m,"south",xe.kml);var g=Oe(m,"east",xe.kml);var y=Oe(m,"north",xe.kml);if(c(v)){v=S.negativePiToPi(S.toRadians(v))}if(c(_)){_=S.clampToLatitudeRange(S.toRadians(_))}if(c(g)){g=S.negativePiToPi(S.toRadians(g))}if(c(y)){y=S.clampToLatitudeRange(S.toRadians(y))}f.coordinates=new A(v,_,g,y);var w=Oe(m,"rotation",xe.kml);if(c(w)){f.rotation=S.toRadians(w)}}}var C=De(r,"Icon",xe.kml);var b=He(C,e,a,o,true);if(c(b)){if(h){console.log("KML - gx:LatLonQuad Icon does not support texture projection.")}var E=Oe(C,"x",xe.gx);var T=Oe(C,"y",xe.gx);var P=Oe(C,"w",xe.gx);var D=Oe(C,"h",xe.gx);if(c(E)||c(T)||c(P)||c(D)){console.log("KML - gx:x, gx:y, gx:w, gx:h aren't supported for GroundOverlays")}f.material=b;f.material.color=ke(r,"color",xe.kml);f.material.transparent=true}else{f.material=ke(r,"color",xe.kml)}var M=Re(r,"altitudeMode",xe.kml);if(c(M)){if(M==="absolute"){f.height=Oe(r,"altitude",xe.kml)}else if(M!=="clampToGround"){console.log("KML - Unknown altitudeMode: "+M)}}else{M=Re(r,"altitudeMode",xe.gx);if(M==="relativeToSeaFloor"){console.log("KML - altitudeMode relativeToSeaFloor is currently not supported, treating as absolute.");f.height=Oe(r,"altitude",xe.kml)}else if(M==="clampToSeaFloor"){console.log("KML - altitudeMode clampToSeaFloor is currently not supported, treating as clampToGround.")}else if(c(M)){console.log("KML - Unknown altitudeMode: "+M)}}}function yt(e,t,r,i,n,a,o,s,u){e._unsupportedNode.raiseEvent(e,t,r,i,n,a,o);console.log("KML - Unsupported feature: "+r.localName)}var wt={INTERVAL:0,EXPIRE:1,STOP:2};function Ct(e){if(!c(e)||e.length===0){return""}var t=e[0];if(t==="&"){e.splice(0,1)}if(t!=="?"){e="?"+e}return e}function bt(e,t){var r="";if(c(e)&&e.length>0||c(t)&&t.length>0){r+=y(Ct(e),Ct(t),false)}return r}var St=new A;var Et=new n;var Tt=new r;var xt=new i;function At(e,t,r,n,a){function o(e){if(e<-S.PI_OVER_TWO){return-S.PI_OVER_TWO}else if(e>S.PI_OVER_TWO){return S.PI_OVER_TWO}return e}function s(e){if(e>S.PI){return e-S.TWO_PI}else if(e<-S.PI){return e+S.TWO_PI}return e}if(c(e)&&e._mode!==L.MORPHING){var u=h.WGS84;var d;var f;a=l(a,St);if(c(t)){Tt.x=t.clientWidth*.5;Tt.y=t.clientHeight*.5;d=e.pickEllipsoid(Tt,u,xt)}if(c(d)){f=u.cartesianToCartographic(d,Et)}else{f=A.center(a,Et);d=u.cartographicToCartesian(f)}if(c(n)&&!S.equalsEpsilon(n,1,S.EPSILON9)){var p=a.width*n*.5;var m=a.height*n*.5;a=new A(s(f.longitude-p),o(f.latitude-m),s(f.longitude+p),o(f.latitude+m))}r=r.replace("[bboxWest]",S.toDegrees(a.west).toString());r=r.replace("[bboxSouth]",S.toDegrees(a.south).toString());r=r.replace("[bboxEast]",S.toDegrees(a.east).toString());r=r.replace("[bboxNorth]",S.toDegrees(a.north).toString());var v=S.toDegrees(f.longitude).toString();var _=S.toDegrees(f.latitude).toString();r=r.replace("[lookatLon]",v);r=r.replace("[lookatLat]",_);r=r.replace("[lookatTilt]",S.toDegrees(e.pitch).toString());r=r.replace("[lookatHeading]",S.toDegrees(e.heading).toString());r=r.replace("[lookatRange]",i.distance(e.positionWC,d));r=r.replace("[lookatTerrainLon]",v);r=r.replace("[lookatTerrainLat]",_);r=r.replace("[lookatTerrainAlt]",f.height.toString());u.cartesianToCartographic(e.positionWC,Et);r=r.replace("[cameraLon]",S.toDegrees(Et.longitude).toString());r=r.replace("[cameraLat]",S.toDegrees(Et.latitude).toString());r=r.replace("[cameraAlt]",S.toDegrees(Et.height).toString());var g=e.frustum;var y=g.aspectRatio;var w="";var C="";if(c(y)){var b=S.toDegrees(g.fov);if(y>1){w=b;C=b/y}else{C=b;w=b*y}}r=r.replace("[horizFov]",w.toString());r=r.replace("[vertFov]",C.toString())}else{r=r.replace("[bboxWest]","-180");r=r.replace("[bboxSouth]","-90");r=r.replace("[bboxEast]","180");r=r.replace("[bboxNorth]","90");r=r.replace("[lookatLon]","");r=r.replace("[lookatLat]","");r=r.replace("[lookatRange]","");r=r.replace("[lookatTilt]","");r=r.replace("[lookatHeading]","");r=r.replace("[lookatTerrainLon]","");r=r.replace("[lookatTerrainLat]","");r=r.replace("[lookatTerrainAlt]","");r=r.replace("[cameraLon]","");r=r.replace("[cameraLat]","");r=r.replace("[cameraAlt]","");r=r.replace("[horizFov]","");r=r.replace("[vertFov]","")}if(c(t)){r=r.replace("[horizPixels]",t.clientWidth);r=r.replace("[vertPixels]",t.clientHeight)}else{r=r.replace("[horizPixels]","");r=r.replace("[vertPixels]","")}r=r.replace("[terrainEnabled]","1");r=r.replace("[clientVersion]","1");r=r.replace("[kmlVersion]","2.2");r=r.replace("[clientName]","Cesium");r=r.replace("[language]","English");return r}function Pt(e,t,r,i,n,a,o,s,d){var f=ht(e,t,r,i,n,a,o,s,d);var h=f.entity;var p=De(r,"Link",xe.kml);if(!c(p)){p=De(r,"Url",xe.kml)}if(c(p)){var v=Re(p,"href",xe.kml);if(c(v)){var _=v;v=Le(v,undefined,a,o);var g;if(/^data:/.test(v)){g=v;if(!/\.kmz/i.test(a)){_=m(_,a)}}else{_=v;var C=Re(p,"viewRefreshMode",xe.kml);var b=l(Re(p,"viewBoundScale",xe.kml),1);var S=C==="onStop"?"BBOX=[bboxWest],[bboxSouth],[bboxEast],[bboxNorth]":"";var E=l(Re(p,"viewFormat",xe.kml),S);var T=Re(p,"httpQuery",xe.kml);var x=bt(E,T);g=At(e._camera,e._canvas,y(v,x,false),b,e._lastCameraView.bbox)}var A={sourceUri:_,uriResolver:o,context:h.id};var P=new Y;var D=Rt(e,P,g,A).then(function(t){var r=e._entityCollection;var i=P.values;r.suspendEvents();for(var n=0;n<i.length;n++){var a=i[n];if(!c(a.parent)){a.parent=h;Lt(a)}r.add(a)}r.resumeEvents();var o=Re(p,"refreshMode",xe.kml);var s=l(Oe(p,"refreshInterval",xe.kml),0);if(o==="onInterval"&&s>0||o==="onExpire"||C==="onStop"){var d=De(t,"NetworkLinkControl",xe.kml);var f=c(d);var m=w.now();var _={id:u(),href:v,cookie:"",queryString:x,lastUpdated:m,updating:false,entity:h,viewBoundScale:b,needsUpdate:false,cameraUpdateTime:m};var g=0;if(f){_.cookie=l(Re(d,"cookie",xe.kml),"");g=l(Oe(d,"minRefreshPeriod",xe.kml),0)}if(o==="onInterval"){if(f){s=Math.max(g,s)}_.refreshMode=wt.INTERVAL;_.time=s}else if(o==="onExpire"){var y;if(f){y=Re(d,"expires",xe.kml)}if(c(y)){try{var S=w.fromIso8601(y);var E=w.secondsDifference(S,m);if(E>0&&E<g){w.addSeconds(m,g,S)}_.refreshMode=wt.EXPIRE;_.time=S}catch(e){console.log("KML - NetworkLinkControl expires is not a valid date")}}else{console.log("KML - refreshMode of onExpire requires the NetworkLinkControl to have an expires element")}}else{if(e._camera){_.refreshMode=wt.STOP;_.time=l(Oe(p,"viewRefreshTime",xe.kml),0)}else{console.log("A NetworkLink with viewRefreshMode=onStop requires a camera be passed in when creating the KmlDataSource")}}if(c(_.refreshMode)){e._networkLinks.set(_.id,_)}}else if(C==="onRegion"){console.log("KML - Unsupported viewRefreshMode: onRegion")}});s.push(D)}}}var Dt={Document:mt,Folder:vt,Placemark:_t,NetworkLink:Pt,GroundOverlay:gt,PhotoOverlay:yt,ScreenOverlay:yt,Tour:yt};function Mt(e,t,r,i,n,a,o,s,u){var l=Dt[t.localName];if(c(l)){l(e,r,t,i,n,a,o,s,u)}else{yt(e,r,t,i,n,a,o,s,u)}}function It(e,t,r,i,n,a){t.removeAll();var o=[];var s=r.documentElement;var u=s.localName==="Document"?s:De(s,"Document",xe.kml);var l=Re(u,"name",xe.kml);if(!c(l)&&c(i)){l=_(i)}if(!c(e._name)){e._name=l}var d=new Y(e);return k.all(Ze(e,r,d,i,false,n,a)).then(function(){var s=r.documentElement;if(s.localName==="kml"){var u=s.childNodes;for(var l=0;l<u.length;l++){var f=u[l];if(c(Dt[f.localName])){s=f;break}}}t.suspendEvents();Mt(e,s,undefined,t,d,i,n,o,a);t.resumeEvents();return k.all(o).then(function(){return r.documentElement})})}function Ot(e,t,r,i){var n=k.defer();V.createReader(new V.BlobReader(r),function(r){r.getEntries(function(a){var o=[];var s={};var u;var l;for(var d=0;d<a.length;d++){var f=a[d];if(!f.directory){var h=k.defer();o.push(h.promise);if(/\.kml$/i.test(f.filename)){if(!c(u)||!/\//i.test(f.filename)){if(c(u)){ve(r,u,s,l)}u=f;l=h}else{ve(r,f,s,h)}}else{ve(r,f,s,h)}}}if(c(u)){me(r,u,s,l)}k.all(o).then(function(){r.close();if(!c(s.kml)){n.reject(new D("KMZ file does not contain a KML document."));return}s.keys=Object.keys(s);return It(e,t,s.kml,i,s)}).then(n.resolve).otherwise(n.reject)})},function(e){n.reject(e)});return n.promise}function Rt(e,t,r,i){i=l(i,l.EMPTY_OBJECT);var n=i.sourceUri;var a=i.uriResolver;var o=i.context;var s=r;if(typeof r==="string"){s=P.request(ge(r,e._proxy),C);n=l(n,r)}return k(s).then(function(r){if(r instanceof Blob){return he(r).then(function(i){if(i){return Ot(e,t,r,n)}return pe(r).then(function(r){var i;var s;try{i=oe.parseFromString(r,"application/xml")}catch(e){s=e.toString()}if(c(s)||i.body||i.documentElement.tagName==="parsererror"){var u=c(s)?s:i.documentElement.firstChild.nodeValue;if(!u){u=i.body.innerText}throw new D(u)}return It(e,t,i,n,a,o)})})}else{return It(e,t,r,n,a,o)}}).otherwise(function(t){e._error.raiseEvent(e,t);console.log(t);return k.reject(t)})}function Nt(t){t=l(t,{});var r=t.camera;var n=t.canvas;if(!c(r)){throw new f("options.camera is required.")}if(!c(n)){throw new f("options.canvas is required.")}this._changed=new p;this._error=new p;this._loading=new p;this._refresh=new p;this._unsupportedNode=new p;this._clock=undefined;this._entityCollection=new Y(this);this._name=undefined;this._isLoading=false;this._proxy=t.proxy;this._pinBuilder=new T;this._networkLinks=new e;this._entityCluster=new j;this._canvas=n;this._camera=r;this._lastCameraView={position:c(r)?i.clone(r.positionWC):undefined,direction:c(r)?i.clone(r.directionWC):undefined,up:c(r)?i.clone(r.upWC):undefined,bbox:c(r)?r.computeViewRectangle():A.clone(A.MAX_VALUE)}}Nt.load=function(e,t){t=l(t,l.EMPTY_OBJECT);var r=new Nt(t);return r.load(e,t)};d(Nt.prototype,{name:{get:function(){return this._name}},clock:{get:function(){return this._clock}},entities:{get:function(){return this._entityCollection}},isLoading:{get:function(){return this._isLoading}},changedEvent:{get:function(){return this._changed}},errorEvent:{get:function(){return this._error}},loadingEvent:{get:function(){return this._loading}},refreshEvent:{get:function(){return this._refresh}},unsupportedNodeEvent:{get:function(){return this._unsupportedNode}},show:{get:function(){return this._entityCollection.show},set:function(e){this._entityCollection.show=e}},clustering:{get:function(){return this._entityCluster},set:function(e){if(!c(e)){throw new f("value must be defined.")}this._entityCluster=e}}});Nt.prototype.load=function(e,t){if(!c(e)){throw new f("data is required.")}t=l(t,{});G.setLoading(this,true);var r=this._name;this._name=undefined;this._clampToGround=l(t.clampToGround,false);var i=this;return Rt(this,this._entityCollection,e,t).then(function(){var e;var t=i._entityCollection.computeAvailability();var n=t.start;var s=t.stop;var u=w.equals(n,g.MINIMUM_VALUE);var l=w.equals(s,g.MAXIMUM_VALUE);if(!u||!l){var c;if(u){c=new Date;c.setHours(0,0,0,0);n=w.fromDate(c)}if(l){c=new Date;c.setHours(24,0,0,0);s=w.fromDate(c)}e=new H;e.startTime=n;e.stopTime=s;e.currentTime=w.clone(n);e.clockRange=a.LOOP_STOP;e.clockStep=o.SYSTEM_CLOCK_MULTIPLIER;e.multiplier=Math.round(Math.min(Math.max(w.secondsDifference(s,n)/60,1),31556900))}var d=false;if(e!==i._clock){i._clock=e;d=true}if(r!==i._name){d=true}if(d){i._changed.raiseEvent(i)}G.setLoading(i,false);return i}).otherwise(function(e){G.setLoading(i,false);i._error.raiseEvent(i,e);console.log(e);return k.reject(e)})};function Lt(e){var t=e.parent;if(c(t)){var r=t.availability;if(c(r)){var i=e.availability;if(c(i)){i.intersect(r)}else{e.availability=r}}}}function Bt(e,t,r,i,n){return function(a){if(!i.contains(t.id)){return}var o=false;var s=De(a,"NetworkLinkControl",xe.kml);var u=c(s);var d=0;if(u){if(c(De(s,"Update",xe.kml))){console.log("KML - NetworkLinkControl updates aren't supported.");t.updating=false;i.remove(t.id);return}t.cookie=l(Re(s,"cookie",xe.kml),"");d=l(Oe(s,"minRefreshPeriod",xe.kml),0)}var f=w.now();var h=t.refreshMode;if(h===wt.INTERVAL){if(c(s)){t.time=Math.max(d,t.time)}}else if(h===wt.EXPIRE){var p;if(c(s)){p=Re(s,"expires",xe.kml)}if(c(p)){try{var m=w.fromIso8601(p);var v=w.secondsDifference(m,f);if(v>0&&v<d){w.addSeconds(f,d,m)}t.time=m}catch(e){console.log("KML - NetworkLinkControl expires is not a valid date");o=true}}else{console.log("KML - refreshMode of onExpire requires the NetworkLinkControl to have an expires element");o=true}}var _=t.entity;var y=e._entityCollection;var C=r.values;function b(e){y.remove(e);var t=e._children;var r=t.length;for(var i=0;i<r;++i){b(t[i])}}y.suspendEvents();var S=y.values.slice();for(var E=0;E<S.length;++E){var T=S[E];if(T.parent===_){T.parent=undefined;b(T)}}y.resumeEvents();y.suspendEvents();for(E=0;E<C.length;E++){var x=C[E];if(!c(x.parent)){x.parent=_;Lt(x)}y.add(x)}y.resumeEvents();if(o){i.remove(t.id)}else{t.lastUpdated=f}var A=y.computeAvailability();var P=A.start;var D=A.stop;var M=w.equals(P,g.MINIMUM_VALUE);var I=w.equals(D,g.MAXIMUM_VALUE);if(!M||!I){var O=e._clock;if(O.startTime!==P||O.stopTime!==D){O.startTime=P;O.stopTime=D;e._changed.raiseEvent(e)}}t.updating=false;t.needsUpdate=false;e._refresh.raiseEvent(e,n)}}var Ft=new e;Nt.prototype.update=function(t){var r=this._networkLinks;if(r.length===0){return true}var n=w.now();var a=this;Ft.removeAll();function o(e){var t=e._children;var r=t.length;for(var i=0;i<r;++i){var n=t[i];Ft.set(n.id,n);o(n)}}var s=false;var u=this._lastCameraView;var l=this._camera;if(c(l)&&!(l.positionWC.equalsEpsilon(u.position,S.EPSILON7)&&l.directionWC.equalsEpsilon(u.direction,S.EPSILON7)&&l.upWC.equalsEpsilon(u.up,S.EPSILON7))){u.position=i.clone(l.positionWC);u.direction=i.clone(l.directionWC);u.up=i.clone(l.upWC);u.bbox=l.computeViewRectangle();s=true}var d=new e;var f=false;r.values.forEach(function(e){var t=e.entity;if(Ft.contains(t.id)){return}if(!e.updating){var r=false;if(e.refreshMode===wt.INTERVAL){if(w.secondsDifference(n,e.lastUpdated)>e.time){r=true}}else if(e.refreshMode===wt.EXPIRE){if(w.greaterThan(n,e.time)){r=true}}else if(e.refreshMode===wt.STOP){if(s){e.needsUpdate=true;e.cameraUpdateTime=n}if(e.needsUpdate&&w.secondsDifference(n,e.cameraUpdateTime)>=e.time){r=true}}if(r){o(t);e.updating=true;var i=new Y;var l=y(e.href,bt(e.cookie,e.queryString),false);l=At(a._camera,a._canvas,l,e.viewBoundScale,u.bbox);Rt(a,i,l,{context:t.id}).then(Bt(a,e,i,d,l)).otherwise(function(t){var r="NetworkLink "+e.href+" refresh failed: "+t;console.log(r);a._error.raiseEvent(a,r)});f=true}}d.set(e.id,e)});if(f){this._networkLinks=d;this._changed.raiseEvent(this)}return true};function kt(){this.author={name:undefined,uri:undefined,email:undefined};this.link={href:undefined,hreflang:undefined,rel:undefined,type:undefined,title:undefined,length:undefined};this.address=undefined;this.phoneNumber=undefined;this.snippet=undefined;this.extendedData=undefined}return Nt});define("DataSources/VelocityOrientationProperty",["../Core/Cartesian3","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/Ellipsoid","../Core/Event","../Core/Matrix3","../Core/Quaternion","../Core/Transforms","./Property","./VelocityVectorProperty"],function(e,t,r,i,n,a,o,s,u,l,c){"use strict";function d(e,r){this._velocityVectorProperty=new c(e,true)
;this._subscription=undefined;this._ellipsoid=undefined;this._definitionChanged=new a;this.ellipsoid=t(r,n.WGS84);var i=this;this._velocityVectorProperty.definitionChanged.addEventListener(function(){i._definitionChanged.raiseEvent(i)})}i(d.prototype,{isConstant:{get:function(){return l.isConstant(this._velocityVectorProperty)}},definitionChanged:{get:function(){return this._definitionChanged}},position:{get:function(){return this._velocityVectorProperty.position},set:function(e){this._velocityVectorProperty.position=e}},ellipsoid:{get:function(){return this._ellipsoid},set:function(e){var t=this._ellipsoid;if(t!==e){this._ellipsoid=e;this._definitionChanged.raiseEvent(this)}}}});var f=new e;var h=new e;var p=new o;d.prototype.getValue=function(e,t){var i=this._velocityVectorProperty._getValue(e,h,f);if(!r(i)){return undefined}u.rotationMatrixFromPositionVelocity(f,i,this._ellipsoid,p);return s.fromRotationMatrix(p,t)};d.prototype.equals=function(e){return this===e||e instanceof d&&l.equals(this._velocityVectorProperty,e._velocityVectorProperty)&&(this._ellipsoid===e._ellipsoid||this._ellipsoid.equals(e._ellipsoid))};return d});define("DataSources/Visualizer",["../Core/DeveloperError"],function(e){"use strict";function t(){e.throwInstantiationError()}t.prototype.update=e.throwInstantiationError;t.prototype.getBoundingSphere=e.throwInstantiationError;t.prototype.isDestroyed=e.throwInstantiationError;t.prototype.destroy=e.throwInstantiationError;return t});define("Renderer/ClearCommand",["../Core/Color","../Core/defaultValue","../Core/freezeObject"],function(e,t,r){"use strict";function i(e){e=t(e,t.EMPTY_OBJECT);this.color=e.color;this.depth=e.depth;this.stencil=e.stencil;this.renderState=e.renderState;this.framebuffer=e.framebuffer;this.owner=e.owner}i.ALL=r(new i({color:new e(0,0,0,0),depth:1,stencil:0}));i.prototype.execute=function(e,t){e.clear(this,t)};return i});define("Renderer/ComputeCommand",["../Core/defaultValue","./Pass"],function(e,t){"use strict";function r(r){r=e(r,e.EMPTY_OBJECT);this.vertexArray=r.vertexArray;this.fragmentShaderSource=r.fragmentShaderSource;this.shaderProgram=r.shaderProgram;this.uniformMap=r.uniformMap;this.outputTexture=r.outputTexture;this.preExecute=r.preExecute;this.postExecute=r.postExecute;this.persists=e(r.persists,false);this.pass=t.COMPUTE;this.owner=r.owner}r.prototype.execute=function(e){e.execute(this)};return r});define("Shaders/ViewportQuadVS",[],function(){"use strict";return"attribute vec4 position;\nattribute vec2 textureCoordinates;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\ngl_Position = position;\nv_textureCoordinates = textureCoordinates;\n}\n"});define("Renderer/ComputeEngine",["../Core/BoundingRectangle","../Core/Color","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Core/PrimitiveType","../Shaders/ViewportQuadVS","./ClearCommand","./DrawCommand","./Framebuffer","./RenderState","./ShaderProgram"],function(e,t,r,i,n,a,o,s,u,l,c,d){"use strict";function f(e){this._context=e}var h;var p=new u({primitiveType:a.TRIANGLES});var m=new s({color:new t(0,0,0,0)});function v(e,t){return new l({context:e,colorTextures:[t],destroyAttachments:false})}function _(e,t){return d.fromCache({context:e,vertexShaderSource:o,fragmentShaderSource:t,attributeLocations:{position:0,textureCoordinates:1}})}function g(t,i){if(!r(h)||h.viewport.width!==t||h.viewport.height!==i){h=c.fromCache({viewport:new e(0,0,t,i)})}return h}f.prototype.execute=function(e){if(!r(e)){throw new n("computeCommand is required.")}if(r(e.preExecute)){e.preExecute(e)}if(!r(e.fragmentShaderSource)&&!r(e.shaderProgram)){throw new n("computeCommand.fragmentShaderSource or computeCommand.shaderProgram is required.")}if(!r(e.outputTexture)){throw new n("computeCommand.outputTexture is required.")}var t=e.outputTexture;var i=t.width;var a=t.height;var o=this._context;var s=r(e.vertexArray)?e.vertexArray:o.getViewportQuadVertexArray();var u=r(e.shaderProgram)?e.shaderProgram:_(o,e.fragmentShaderSource);var l=v(o,t);var c=g(i,a);var d=e.uniformMap;var f=m;f.framebuffer=l;f.renderState=c;f.execute(o);var h=p;h.vertexArray=s;h.renderState=c;h.shaderProgram=u;h.uniformMap=d;h.framebuffer=l;h.execute(o);l.destroy();if(!e.persists){u.destroy();if(r(e.vertexArray)){s.destroy()}}if(r(e.postExecute)){e.postExecute(t)}};f.prototype.isDestroyed=function(){return false};f.prototype.destroy=function(){return i(this)};return f});define("Renderer/PassState",[],function(){"use strict";function e(e){this.context=e;this.framebuffer=undefined;this.blendingEnabled=undefined;this.scissorTest=undefined;this.viewport=undefined}return e});define("Renderer/RenderbufferFormat",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";var r={RGBA4:t.RGBA4,RGB5_A1:t.RGB5_A1,RGB565:t.RGB565,DEPTH_COMPONENT16:t.DEPTH_COMPONENT16,STENCIL_INDEX8:t.STENCIL_INDEX8,DEPTH_STENCIL:t.DEPTH_STENCIL,validate:function(e){return e===r.RGBA4||e===r.RGB5_A1||e===r.RGB565||e===r.DEPTH_COMPONENT16||e===r.STENCIL_INDEX8||e===r.DEPTH_STENCIL}};return e(r)});define("Renderer/Renderbuffer",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","./ContextLimits","./RenderbufferFormat"],function(e,t,r,i,n,a,o){"use strict";function s(r){r=e(r,e.EMPTY_OBJECT);if(!t(r.context)){throw new n("options.context is required.")}var i=r.context;var s=i._gl;var u=a.maximumRenderbufferSize;var l=e(r.format,o.RGBA4);var c=t(r.width)?r.width:s.drawingBufferWidth;var d=t(r.height)?r.height:s.drawingBufferHeight;if(!o.validate(l)){throw new n("Invalid format.")}if(c<=0){throw new n("Width must be greater than zero.")}if(c>u){throw new n("Width must be less than or equal to the maximum renderbuffer size ("+u+").  Check maximumRenderbufferSize.")}if(d<=0){throw new n("Height must be greater than zero.")}if(d>u){throw new n("Height must be less than or equal to the maximum renderbuffer size ("+u+").  Check maximumRenderbufferSize.")}this._gl=s;this._format=l;this._width=c;this._height=d;this._renderbuffer=this._gl.createRenderbuffer();s.bindRenderbuffer(s.RENDERBUFFER,this._renderbuffer);s.renderbufferStorage(s.RENDERBUFFER,l,c,d);s.bindRenderbuffer(s.RENDERBUFFER,null)}r(s.prototype,{format:{get:function(){return this._format}},width:{get:function(){return this._width}},height:{get:function(){return this._height}}});s.prototype._getRenderbuffer=function(){return this._renderbuffer};s.prototype.isDestroyed=function(){return false};s.prototype.destroy=function(){this._gl.deleteRenderbuffer(this._renderbuffer);return i(this)};return s});define("Renderer/PickFramebuffer",["../Core/BoundingRectangle","../Core/Color","../Core/defaultValue","../Core/defined","../Core/destroyObject","./Framebuffer","./PassState","./Renderbuffer","./RenderbufferFormat","./Texture"],function(e,t,r,i,n,a,o,s,u,l){"use strict";function c(t){var r=new o(t);r.blendingEnabled=false;r.scissorTest={enabled:true,rectangle:new e};r.viewport=new e;this._context=t;this._fb=undefined;this._passState=r;this._width=0;this._height=0}c.prototype.begin=function(t){var r=this._context;var n=r.drawingBufferWidth;var o=r.drawingBufferHeight;e.clone(t,this._passState.scissorTest.rectangle);if(!i(this._fb)||this._width!==n||this._height!==o){this._width=n;this._height=o;this._fb=this._fb&&this._fb.destroy();this._fb=new a({context:r,colorTextures:[new l({context:r,width:n,height:o})],depthStencilRenderbuffer:new s({context:r,format:u.DEPTH_STENCIL})});this._passState.framebuffer=this._fb}this._passState.viewport.width=n;this._passState.viewport.height=o;return this._passState};var d=new t;c.prototype.end=function(e){var n=r(e.width,1);var a=r(e.height,1);var o=this._context;var s=o.readPixels({x:e.x,y:e.y,width:n,height:a,framebuffer:this._fb});var u=Math.max(n,a);var l=u*u;var c=Math.floor(n*.5);var f=Math.floor(a*.5);var h=0;var p=0;var m=0;var v=-1;for(var _=0;_<l;++_){if(-c<=h&&h<=c&&-f<=p&&p<=f){var g=4*((f-p)*n+h+c);d.red=t.byteToFloat(s[g]);d.green=t.byteToFloat(s[g+1]);d.blue=t.byteToFloat(s[g+2]);d.alpha=t.byteToFloat(s[g+3]);var y=o.getObjectByPickColor(d);if(i(y)){return y}}if(h===p||h<0&&-h===p||h>0&&h===1-p){var w=m;m=-v;v=w}h+=m;p+=v}return undefined};c.prototype.isDestroyed=function(){return false};c.prototype.destroy=function(){this._fb=this._fb&&this._fb.destroy();return n(this)};return c});define("Renderer/ShaderCache",["../Core/defined","../Core/defineProperties","../Core/destroyObject","./ShaderProgram","./ShaderSource"],function(e,t,r,i,n){"use strict";function a(e){this._context=e;this._shaders={};this._numberOfShaders=0;this._shadersToRelease={}}t(a.prototype,{numberOfShaders:{get:function(){return this._numberOfShaders}}});a.prototype.replaceShaderProgram=function(t){if(e(t.shaderProgram)){t.shaderProgram.destroy()}return this.getShaderProgram(t)};a.prototype.getShaderProgram=function(t){var r=t.vertexShaderSource;var a=t.fragmentShaderSource;var o=t.attributeLocations;if(typeof r==="string"){r=new n({sources:[r]})}if(typeof a==="string"){a=new n({sources:[a]})}var s=r.createCombinedVertexShader();var u=a.createCombinedFragmentShader();var l=s+u+JSON.stringify(o);var c;if(e(this._shaders[l])){c=this._shaders[l];delete this._shadersToRelease[l]}else{var d=this._context;var f=new i({gl:d._gl,logShaderCompilation:d.logShaderCompilation,debugShaders:d.debugShaders,vertexShaderSource:r,vertexShaderText:s,fragmentShaderSource:a,fragmentShaderText:u,attributeLocations:o});c={cache:this,shaderProgram:f,keyword:l,derivedKeywords:[],count:0};f._cachedShader=c;this._shaders[l]=c;++this._numberOfShaders}++c.count;return c.shaderProgram};a.prototype.getDerivedShaderProgram=function(t,r){var i=t._cachedShader;var n=r+i.keyword;var a=this._shaders[n];if(!e(a)){return undefined}return a.shaderProgram};a.prototype.createDerivedShaderProgram=function(e,t,r){var a=e._cachedShader;var o=t+a.keyword;var s=r.vertexShaderSource;var u=r.fragmentShaderSource;var l=r.attributeLocations;if(typeof s==="string"){s=new n({sources:[s]})}if(typeof u==="string"){u=new n({sources:[u]})}var c=s.createCombinedVertexShader();var d=u.createCombinedFragmentShader();var f=this._context;var h=new i({gl:f._gl,logShaderCompilation:f.logShaderCompilation,debugShaders:f.debugShaders,vertexShaderSource:s,vertexShaderText:c,fragmentShaderSource:u,fragmentShaderText:d,attributeLocations:l});var p={cache:this,shaderProgram:h,keyword:o,derivedKeywords:[],count:0};a.derivedKeywords.push(t);h._cachedShader=p;this._shaders[o]=p;return h};function o(e,t){var r=t.derivedKeywords;var i=r.length;for(var n=0;n<i;++n){var a=r[n]+t.keyword;var s=e._shaders[a];o(e,s)}delete e._shaders[t.keyword];t.shaderProgram.finalDestroy()}a.prototype.destroyReleasedShaderPrograms=function(){var e=this._shadersToRelease;for(var t in e){if(e.hasOwnProperty(t)){var r=e[t];o(this,r);--this._numberOfShaders}}this._shadersToRelease={}};a.prototype.releaseShaderProgram=function(t){if(e(t)){var r=t._cachedShader;if(r&&--r.count===0){this._shadersToRelease[r.keyword]=r}}};a.prototype.isDestroyed=function(){return false};a.prototype.destroy=function(){var e=this._shaders;for(var t in e){if(e.hasOwnProperty(t)){e[t].shaderProgram.finalDestroy()}}return r(this)};return a});define("Renderer/UniformState",["../Core/BoundingRectangle","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Cartographic","../Core/defined","../Core/defineProperties","../Core/EncodedCartesian3","../Core/Math","../Core/Matrix3","../Core/Matrix4","../Core/Simon1994PlanetaryPositions","../Core/Transforms","../Scene/OrthographicFrustum","../Scene/SceneMode"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p){"use strict";function m(){this.globeDepthTexture=undefined;this._viewport=new e;this._viewportCartesian4=new i;this._viewportDirty=false;this._viewportOrthographicMatrix=c.clone(c.IDENTITY);this._viewportTransformation=c.clone(c.IDENTITY);this._model=c.clone(c.IDENTITY);this._view=c.clone(c.IDENTITY);this._inverseView=c.clone(c.IDENTITY);this._projection=c.clone(c.IDENTITY);this._infiniteProjection=c.clone(c.IDENTITY);this._entireFrustum=new t;this._currentFrustum=new t;this._frustumPlanes=new i;this._frameState=undefined;this._temeToPseudoFixed=l.clone(c.IDENTITY);this._view3DDirty=true;this._view3D=new c;this._inverseView3DDirty=true;this._inverseView3D=new c;this._inverseModelDirty=true;this._inverseModel=new c;this._inverseTransposeModelDirty=true;this._inverseTransposeModel=new l;this._viewRotation=new l;this._inverseViewRotation=new l;this._viewRotation3D=new l;this._inverseViewRotation3D=new l;this._inverseProjectionDirty=true;this._inverseProjection=new c;this._modelViewDirty=true;this._modelView=new c;this._modelView3DDirty=true;this._modelView3D=new c;this._modelViewRelativeToEyeDirty=true;this._modelViewRelativeToEye=new c;this._inverseModelViewDirty=true;this._inverseModelView=new c;this._inverseModelView3DDirty=true;this._inverseModelView3D=new c;this._viewProjectionDirty=true;this._viewProjection=new c;this._inverseViewProjectionDirty=true;this._inverseViewProjection=new c;this._modelViewProjectionDirty=true;this._modelViewProjection=new c;this._inverseModelViewProjectionDirty=true;this._inverseModelViewProjection=new c;this._modelViewProjectionRelativeToEyeDirty=true;this._modelViewProjectionRelativeToEye=new c;this._modelViewInfiniteProjectionDirty=true;this._modelViewInfiniteProjection=new c;this._normalDirty=true;this._normal=new l;this._normal3DDirty=true;this._normal3D=new l;this._inverseNormalDirty=true;this._inverseNormal=new l;this._inverseNormal3DDirty=true;this._inverseNormal3D=new l;this._encodedCameraPositionMCDirty=true;this._encodedCameraPositionMC=new s;this._cameraPosition=new r;this._sunPositionWC=new r;this._sunPositionColumbusView=new r;this._sunDirectionWC=new r;this._sunDirectionEC=new r;this._moonDirectionEC=new r;this._pass=undefined;this._mode=undefined;this._mapProjection=undefined;this._cameraDirection=new r;this._cameraRight=new r;this._cameraUp=new r;this._frustum2DWidth=0;this._eyeHeight2D=new t;this._resolutionScale=1;this._orthographicIn3D=false;this._fogDensity=undefined;this._imagerySplitPosition=0;this._pixelSizePerMeter=undefined;this._geometricToleranceOverMeter=undefined}o(m.prototype,{frameState:{get:function(){return this._frameState}},viewport:{get:function(){return this._viewport},set:function(t){if(!e.equals(t,this._viewport)){e.clone(t,this._viewport);var r=this._viewport;var i=this._viewportCartesian4;i.x=r.x;i.y=r.y;i.z=r.width;i.w=r.height;this._viewportDirty=true}}},viewportCartesian4:{get:function(){return this._viewportCartesian4}},viewportOrthographic:{get:function(){E(this);return this._viewportOrthographicMatrix}},viewportTransformation:{get:function(){E(this);return this._viewportTransformation}},model:{get:function(){return this._model},set:function(e){c.clone(e,this._model);this._modelView3DDirty=true;this._inverseModelView3DDirty=true;this._inverseModelDirty=true;this._inverseTransposeModelDirty=true;this._modelViewDirty=true;this._inverseModelViewDirty=true;this._modelViewRelativeToEyeDirty=true;this._inverseModelViewDirty=true;this._modelViewProjectionDirty=true;this._inverseModelViewProjectionDirty=true;this._modelViewProjectionRelativeToEyeDirty=true;this._modelViewInfiniteProjectionDirty=true;this._normalDirty=true;this._inverseNormalDirty=true;this._normal3DDirty=true;this._inverseNormal3DDirty=true;this._encodedCameraPositionMCDirty=true}},inverseModel:{get:function(){if(this._inverseModelDirty){this._inverseModelDirty=false;c.inverse(this._model,this._inverseModel)}return this._inverseModel}},inverseTransposeModel:{get:function(){var e=this._inverseTransposeModel;if(this._inverseTransposeModelDirty){this._inverseTransposeModelDirty=false;c.getRotation(this.inverseModel,e);l.transpose(e,e)}return e}},view:{get:function(){return this._view}},view3D:{get:function(){Q(this);return this._view3D}},viewRotation:{get:function(){Q(this);return this._viewRotation}},viewRotation3D:{get:function(){Q(this);return this._viewRotation3D}},inverseView:{get:function(){return this._inverseView}},inverseView3D:{get:function(){J(this);return this._inverseView3D}},inverseViewRotation:{get:function(){return this._inverseViewRotation}},inverseViewRotation3D:{get:function(){J(this);return this._inverseViewRotation3D}},projection:{get:function(){return this._projection}},inverseProjection:{get:function(){T(this);return this._inverseProjection}},infiniteProjection:{get:function(){return this._infiniteProjection}},modelView:{get:function(){x(this);return this._modelView}},modelView3D:{get:function(){A(this);return this._modelView3D}},modelViewRelativeToEye:{get:function(){R(this);return this._modelViewRelativeToEye}},inverseModelView:{get:function(){P(this);return this._inverseModelView}},inverseModelView3D:{get:function(){D(this);return this._inverseModelView3D}},viewProjection:{get:function(){M(this);return this._viewProjection}},inverseViewProjection:{get:function(){I(this);return this._inverseViewProjection}},modelViewProjection:{get:function(){O(this);return this._modelViewProjection}},inverseModelViewProjection:{get:function(){N(this);return this._inverseModelViewProjection}},modelViewProjectionRelativeToEye:{get:function(){L(this);return this._modelViewProjectionRelativeToEye}},modelViewInfiniteProjection:{get:function(){B(this);return this._modelViewInfiniteProjection}},normal:{get:function(){F(this);return this._normal}},normal3D:{get:function(){k(this);return this._normal3D}},inverseNormal:{get:function(){V(this);return this._inverseNormal}},inverseNormal3D:{get:function(){z(this);return this._inverseNormal3D}},entireFrustum:{get:function(){return this._entireFrustum}},currentFrustum:{get:function(){return this._currentFrustum}},frustumPlanes:{get:function(){return this._frustumPlanes}},eyeHeight2D:{get:function(){return this._eyeHeight2D}},sunPositionWC:{get:function(){return this._sunPositionWC}},sunPositionColumbusView:{get:function(){return this._sunPositionColumbusView}},sunDirectionWC:{get:function(){return this._sunDirectionWC}},sunDirectionEC:{get:function(){return this._sunDirectionEC}},moonDirectionEC:{get:function(){return this._moonDirectionEC}},encodedCameraPositionMCHigh:{get:function(){q(this);return this._encodedCameraPositionMC.high}},encodedCameraPositionMCLow:{get:function(){q(this);return this._encodedCameraPositionMC.low}},temeToPseudoFixedMatrix:{get:function(){return this._temeToPseudoFixed}},resolutionScale:{get:function(){return this._resolutionScale}},fogDensity:{get:function(){return this._fogDensity}},geometricToleranceOverMeter:{get:function(){return this._geometricToleranceOverMeter}},pass:{get:function(){return this._pass}},imagerySplitPosition:{get:function(){return this._imagerySplitPosition}}});function v(e,t){c.clone(t,e._view);c.getRotation(t,e._viewRotation);e._view3DDirty=true;e._inverseView3DDirty=true;e._modelViewDirty=true;e._modelView3DDirty=true;e._modelViewRelativeToEyeDirty=true;e._inverseModelViewDirty=true;e._inverseModelView3DDirty=true;e._viewProjectionDirty=true;e._inverseViewProjectionDirty=true;e._modelViewProjectionDirty=true;e._modelViewProjectionRelativeToEyeDirty=true;e._modelViewInfiniteProjectionDirty=true;e._normalDirty=true;e._inverseNormalDirty=true;e._normal3DDirty=true;e._inverseNormal3DDirty=true}function _(e,t){c.clone(t,e._inverseView);c.getRotation(t,e._inverseViewRotation)}function g(e,t){c.clone(t,e._projection);e._inverseProjectionDirty=true;e._viewProjectionDirty=true;e._inverseViewProjectionDirty=true;e._modelViewProjectionDirty=true;e._modelViewProjectionRelativeToEyeDirty=true}function y(e,t){c.clone(t,e._infiniteProjection);e._modelViewInfiniteProjectionDirty=true}function w(e,t){r.clone(t.positionWC,e._cameraPosition);r.clone(t.directionWC,e._cameraDirection);r.clone(t.rightWC,e._cameraRight);r.clone(t.upWC,e._cameraUp);e._encodedCameraPositionMCDirty=true}var C=new l;var b=new n;function S(e,t){if(!a(f.computeIcrfToFixedMatrix(t.time,C))){C=f.computeTemeToPseudoFixedMatrix(t.time,C)}var i=d.computeSunPositionInEarthInertialFrame(t.time,e._sunPositionWC);l.multiplyByVector(C,i,i);r.normalize(i,e._sunDirectionWC);i=l.multiplyByVector(e.viewRotation3D,i,e._sunDirectionEC);r.normalize(i,i);i=d.computeMoonPositionInEarthInertialFrame(t.time,e._moonDirectionEC);l.multiplyByVector(C,i,i);l.multiplyByVector(e.viewRotation3D,i,i);r.normalize(i,i);var n=t.mapProjection;var o=n.ellipsoid;var s=o.cartesianToCartographic(e._sunPositionWC,b);n.project(s,e._sunPositionColumbusView)}m.prototype.updateCamera=function(e){v(this,e.viewMatrix);_(this,e.inverseViewMatrix);w(this,e);this._entireFrustum.x=e.frustum.near;this._entireFrustum.y=e.frustum.far;this.updateFrustum(e.frustum);this._orthographicIn3D=this._mode!==p.SCENE2D&&e.frustum instanceof h};m.prototype.updateFrustum=function(e){g(this,e.projectionMatrix);if(a(e.infiniteProjectionMatrix)){y(this,e.infiniteProjectionMatrix)}this._currentFrustum.x=e.near;this._currentFrustum.y=e.far;if(a(e._offCenterFrustum)){e=e._offCenterFrustum}this._frustumPlanes.x=e.top;this._frustumPlanes.y=e.bottom;this._frustumPlanes.z=e.left;this._frustumPlanes.w=e.right};m.prototype.updatePass=function(e){this._pass=e};m.prototype.update=function(e){this._mode=e.mode;this._mapProjection=e.mapProjection;var t=e.context._canvas;this._resolutionScale=t.width/t.clientWidth;var r=e.camera;this.updateCamera(r);if(e.mode===p.SCENE2D){this._frustum2DWidth=r.frustum.right-r.frustum.left;this._eyeHeight2D.x=this._frustum2DWidth*.5;this._eyeHeight2D.y=this._eyeHeight2D.x*this._eyeHeight2D.x}else{this._frustum2DWidth=0;this._eyeHeight2D.x=0;this._eyeHeight2D.y=0}S(this,e);this._fogDensity=e.fog.density;this._frameState=e;this._temeToPseudoFixed=f.computeTemeToPseudoFixedMatrix(e.time,this._temeToPseudoFixed);this._imagerySplitPosition=e.imagerySplitPosition;var i=r.frustum.fov;var n=this._viewport;var a;if(n.height>n.width){a=Math.tan(.5*i)*2/n.height}else{a=Math.tan(.5*i)*2/n.width}this._geometricToleranceOverMeter=a*e.maximumScreenSpaceError};function E(e){if(e._viewportDirty){var t=e._viewport;c.computeOrthographicOffCenter(t.x,t.x+t.width,t.y,t.y+t.height,0,1,e._viewportOrthographicMatrix);c.computeViewportTransformation(t,0,1,e._viewportTransformation);e._viewportDirty=false}}function T(e){if(e._inverseProjectionDirty){e._inverseProjectionDirty=false;if(e._mode!==p.SCENE2D&&e._mode!==p.MORPHING&&!e._orthographicIn3D){c.inverse(e._projection,e._inverseProjection)}else{c.clone(c.ZERO,e._inverseProjection)}}}function x(e){if(e._modelViewDirty){e._modelViewDirty=false;c.multiplyTransformation(e._view,e._model,e._modelView)}}function A(e){if(e._modelView3DDirty){e._modelView3DDirty=false;c.multiplyTransformation(e.view3D,e._model,e._modelView3D)}}function P(e){if(e._inverseModelViewDirty){e._inverseModelViewDirty=false;c.inverse(e.modelView,e._inverseModelView)}}function D(e){if(e._inverseModelView3DDirty){e._inverseModelView3DDirty=false;c.inverse(e.modelView3D,e._inverseModelView3D)}}function M(e){if(e._viewProjectionDirty){e._viewProjectionDirty=false;c.multiply(e._projection,e._view,e._viewProjection)}}function I(e){if(e._inverseViewProjectionDirty){e._inverseViewProjectionDirty=false;c.inverse(e.viewProjection,e._inverseViewProjection)}}function O(e){if(e._modelViewProjectionDirty){e._modelViewProjectionDirty=false;c.multiply(e._projection,e.modelView,e._modelViewProjection)}}function R(e){if(e._modelViewRelativeToEyeDirty){e._modelViewRelativeToEyeDirty=false;var t=e.modelView;var r=e._modelViewRelativeToEye;r[0]=t[0];r[1]=t[1];r[2]=t[2];r[3]=t[3];r[4]=t[4];r[5]=t[5];r[6]=t[6];r[7]=t[7];r[8]=t[8];r[9]=t[9];r[10]=t[10];r[11]=t[11];r[12]=0;r[13]=0;r[14]=0;r[15]=t[15]}}function N(e){if(e._inverseModelViewProjectionDirty){e._inverseModelViewProjectionDirty=false;c.inverse(e.modelViewProjection,e._inverseModelViewProjection)}}function L(e){if(e._modelViewProjectionRelativeToEyeDirty){e._modelViewProjectionRelativeToEyeDirty=false;c.multiply(e._projection,e.modelViewRelativeToEye,e._modelViewProjectionRelativeToEye)}}function B(e){if(e._modelViewInfiniteProjectionDirty){e._modelViewInfiniteProjectionDirty=false;c.multiply(e._infiniteProjection,e.modelView,e._modelViewInfiniteProjection)}}function F(e){if(e._normalDirty){e._normalDirty=false;var t=e._normal;c.getRotation(e.inverseModelView,t);l.transpose(t,t)}}function k(e){if(e._normal3DDirty){e._normal3DDirty=false;var t=e._normal3D;c.getRotation(e.inverseModelView3D,t);l.transpose(t,t)}}function V(e){if(e._inverseNormalDirty){e._inverseNormalDirty=false;c.getRotation(e.inverseModelView,e._inverseNormal)}}function z(e){if(e._inverseNormal3DDirty){e._inverseNormal3DDirty=false;c.getRotation(e.inverseModelView3D,e._inverseNormal3D)}}var U=new r;function q(e){if(e._encodedCameraPositionMCDirty){e._encodedCameraPositionMCDirty=false;c.multiplyByPoint(e.inverseModel,e._cameraPosition,U);s.fromCartesian(U,e._encodedCameraPositionMC)}}var G=new r;var H=new r;var W=new r;var j=new r;var Y=new n;var X=new r;var Z=new c;function K(e,t,i,n,o,s,l,d){var h=G;h.x=e.y;h.y=e.z;h.z=e.x;var m=H;m.x=i.y;m.y=i.z;m.z=i.x;var v=W;v.x=n.y;v.y=n.z;v.z=n.x;var _=j;_.x=t.y;_.y=t.z;_.z=t.x;if(s===p.SCENE2D){h.z=o*.5}var g=l.unproject(h,Y);g.longitude=u.clamp(g.longitude,-Math.PI,Math.PI);g.latitude=u.clamp(g.latitude,-u.PI_OVER_TWO,u.PI_OVER_TWO);var y=l.ellipsoid;var w=y.cartographicToCartesian(g,X);var C=f.eastNorthUpToFixedFrame(w,y,Z);c.multiplyByPointAsVector(C,m,m);c.multiplyByPointAsVector(C,v,v);c.multiplyByPointAsVector(C,_,_);if(!a(d)){d=new c}d[0]=m.x;d[1]=v.x;d[2]=-_.x;d[3]=0;d[4]=m.y;d[5]=v.y;d[6]=-_.y;d[7]=0;d[8]=m.z;d[9]=v.z;d[10]=-_.z;d[11]=0;d[12]=-r.dot(m,w);d[13]=-r.dot(v,w);d[14]=r.dot(_,w);d[15]=1;return d}function Q(e){if(e._view3DDirty){if(e._mode===p.SCENE3D){c.clone(e._view,e._view3D)}else{K(e._cameraPosition,e._cameraDirection,e._cameraRight,e._cameraUp,e._frustum2DWidth,e._mode,e._mapProjection,e._view3D)}c.getRotation(e._view3D,e._viewRotation3D);e._view3DDirty=false}}function J(e){if(e._inverseView3DDirty){c.inverseTransformation(e.view3D,e._inverseView3D);c.getRotation(e._inverseView3D,e._inverseViewRotation3D);e._inverseView3DDirty=false}}return m});define("Renderer/Context",["../Core/clone","../Core/Color","../Core/ComponentDatatype","../Core/createGuid","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/Geometry","../Core/GeometryAttribute","../Core/Matrix4","../Core/PrimitiveType","../Core/RuntimeError","../Core/WebGLConstants","../Shaders/ViewportQuadVS","./BufferUsage","./ClearCommand","./ContextLimits","./CubeMap","./DrawCommand","./PassState","./PickFramebuffer","./RenderState","./ShaderCache","./ShaderProgram","./Texture","./UniformState","./VertexArray"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w,C,b,S,E,T,x,A,P){"use strict";function D(e,t){var r="WebGL Error:  ";switch(t){case e.INVALID_ENUM:r+="INVALID_ENUM";break;case e.INVALID_VALUE:r+="INVALID_VALUE";break;case e.INVALID_OPERATION:r+="INVALID_OPERATION";break;case e.OUT_OF_MEMORY:r+="OUT_OF_MEMORY";break;case e.CONTEXT_LOST_WEBGL:r+="CONTEXT_LOST_WEBGL lost";break;default:r+="Unknown ("+t+")"}return r}function M(e,t,r,i){var n=D(e,i)+": "+t.name+"(";for(var a=0;a<r.length;++a){if(a!==0){n+=", "}n+=r[a]}n+=");";return n}function I(e,t,r){var i=e.getError();if(i!==e.NO_ERROR){throw new h(M(e,t,r,i))}}function O(e,t,r){return{get:function(){var i=e[t];r(e,"get: "+t,i);return e[t]},set:function(i){e[t]=i;r(e,"set: "+t,i)}}}function R(e,t){if(!a(t)){return e}function r(r){return function(){var i=r.apply(e,arguments);t(e,r,arguments);return i}}var i={};for(var n in e){var o=e[n];if(o instanceof Function){i[n]=r(o)}else{Object.defineProperty(i,n,O(e,n,t))}}return i}function N(e,t){var r=t.length;for(var i=0;i<r;++i){var n=e.getExtension(t[i]);if(n){return n}}return undefined}function L(r,o){if(typeof WebGLRenderingContext==="undefined"){throw new h("The browser does not support WebGL.  Visit http://get.webgl.org.")}if(!a(r)){throw new u("canvas is required.")}this._canvas=r;o=e(o,true);o=n(o,{});o.allowTextureFilterAnisotropic=n(o.allowTextureFilterAnisotropic,true);var s=n(o.webgl,{});s.alpha=n(s.alpha,false);s.stencil=n(s.stencil,true);var l=false;var c=l&&typeof WebGL2RenderingContext!=="undefined";var d=false;var f;var m=o.getWebGLStub;if(!a(m)){if(c){f=r.getContext("webgl2",s)||r.getContext("experimental-webgl2",s)||undefined;if(a(f)){d=true}}if(!a(f)){f=r.getContext("webgl",s)||r.getContext("experimental-webgl",s)||undefined}if(!a(f)){throw new h("The browser supports WebGL, but initialization failed.")}}else{f=m(r,s)}this._originalGLContext=f;this._gl=f;this._webgl2=d;this._id=i();this.validateFramebuffer=false;this.validateShaderProgram=false;this.logShaderCompilation=false;this._throwOnWebGLError=false;this._shaderCache=new E(this);var v=f;this._stencilBits=v.getParameter(v.STENCIL_BITS);g._maximumCombinedTextureImageUnits=v.getParameter(v.MAX_COMBINED_TEXTURE_IMAGE_UNITS);g._maximumCubeMapSize=v.getParameter(v.MAX_CUBE_MAP_TEXTURE_SIZE);g._maximumFragmentUniformVectors=v.getParameter(v.MAX_FRAGMENT_UNIFORM_VECTORS);g._maximumTextureImageUnits=v.getParameter(v.MAX_TEXTURE_IMAGE_UNITS);g._maximumRenderbufferSize=v.getParameter(v.MAX_RENDERBUFFER_SIZE);g._maximumTextureSize=v.getParameter(v.MAX_TEXTURE_SIZE);g._maximumVaryingVectors=v.getParameter(v.MAX_VARYING_VECTORS);g._maximumVertexAttributes=v.getParameter(v.MAX_VERTEX_ATTRIBS);g._maximumVertexTextureImageUnits=v.getParameter(v.MAX_VERTEX_TEXTURE_IMAGE_UNITS);g._maximumVertexUniformVectors=v.getParameter(v.MAX_VERTEX_UNIFORM_VECTORS);var _=v.getParameter(v.ALIASED_LINE_WIDTH_RANGE);g._minimumAliasedLineWidth=_[0];g._maximumAliasedLineWidth=_[1];var y=v.getParameter(v.ALIASED_POINT_SIZE_RANGE);g._minimumAliasedPointSize=y[0];g._maximumAliasedPointSize=y[1];var w=v.getParameter(v.MAX_VIEWPORT_DIMS);g._maximumViewportWidth=w[0];g._maximumViewportHeight=w[1];var b=v.getShaderPrecisionFormat(v.FRAGMENT_SHADER,v.HIGH_FLOAT);g._highpFloatSupported=b.precision!==0;var T=v.getShaderPrecisionFormat(v.FRAGMENT_SHADER,v.HIGH_INT);g._highpIntSupported=T.rangeMax!==0;this._antialias=v.getContextAttributes().antialias;this._standardDerivatives=!!N(v,["OES_standard_derivatives"]);this._elementIndexUint=!!N(v,["OES_element_index_uint"]);this._depthTexture=!!N(v,["WEBGL_depth_texture","WEBKIT_WEBGL_depth_texture"]);this._textureFloat=!!N(v,["OES_texture_float"]);this._fragDepth=!!N(v,["EXT_frag_depth"]);this._debugShaders=N(v,["WEBGL_debug_shaders"]);this._s3tc=!!N(v,["WEBGL_compressed_texture_s3tc","MOZ_WEBGL_compressed_texture_s3tc","WEBKIT_WEBGL_compressed_texture_s3tc"]);this._pvrtc=!!N(v,["WEBGL_compressed_texture_pvrtc","WEBKIT_WEBGL_compressed_texture_pvrtc"]);this._etc1=!!N(v,["WEBGL_compressed_texture_etc1"]);var x=o.allowTextureFilterAnisotropic?N(v,["EXT_texture_filter_anisotropic","WEBKIT_EXT_texture_filter_anisotropic"]):undefined;this._textureFilterAnisotropic=x;g._maximumTextureFilterAnisotropy=a(x)?v.getParameter(x.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1;var P;var D;var M;var I;var O;var R;var L;var B;var F;var k;if(d){var V=this;P=function(){return V._gl.createVertexArray()};D=function(e){V._gl.bindVertexArray(e)};M=function(e){V._gl.deleteVertexArray(e)};I=function(e,t,r,i,n){v.drawElementsInstanced(e,t,r,i,n)};O=function(e,t,r,i){v.drawArraysInstanced(e,t,r,i)};R=function(e,t){v.vertexAttribDivisor(e,t)};L=function(e){v.drawBuffers(e)}}else{B=N(v,["OES_vertex_array_object"]);if(a(B)){P=function(){return B.createVertexArrayOES()};D=function(e){B.bindVertexArrayOES(e)};M=function(e){B.deleteVertexArrayOES(e)}}F=N(v,["ANGLE_instanced_arrays"]);if(a(F)){I=function(e,t,r,i,n){F.drawElementsInstancedANGLE(e,t,r,i,n)};O=function(e,t,r,i){F.drawArraysInstancedANGLE(e,t,r,i)};R=function(e,t){F.vertexAttribDivisorANGLE(e,t)}}k=N(v,["WEBGL_draw_buffers"]);if(a(k)){L=function(e){k.drawBuffersWEBGL(e)}}}this.glCreateVertexArray=P;this.glBindVertexArray=D;this.glDeleteVertexArray=M
;this.glDrawElementsInstanced=I;this.glDrawArraysInstanced=O;this.glVertexAttribDivisor=R;this.glDrawBuffers=L;this._vertexArrayObject=!!B;this._instancedArrays=!!F;this._drawBuffers=!!k;g._maximumDrawBuffers=this.drawBuffers?v.getParameter(p.MAX_DRAW_BUFFERS):1;g._maximumColorAttachments=this.drawBuffers?v.getParameter(p.MAX_COLOR_ATTACHMENTS):1;this._clearColor=new t(0,0,0,0);this._clearDepth=1;this._clearStencil=0;var z=new A;var U=new C(this);var q=S.fromCache();this._defaultPassState=U;this._defaultRenderState=q;this._defaultTexture=undefined;this._defaultCubeMap=undefined;this._us=z;this._currentRenderState=q;this._currentPassState=U;this._currentFramebuffer=undefined;this._maxFrameTextureUnitIndex=0;this._vertexAttribDivisors=[];this._previousDrawInstanced=false;for(var G=0;G<g._maximumVertexAttributes;G++){this._vertexAttribDivisors.push(0)}this._pickObjects={};this._nextPickColor=new Uint32Array(1);this.options=o;this.cache={};S.apply(v,q,U)}var B={};o(L.prototype,{id:{get:function(){return this._id}},webgl2:{get:function(){return this._webgl2}},canvas:{get:function(){return this._canvas}},shaderCache:{get:function(){return this._shaderCache}},uniformState:{get:function(){return this._us}},stencilBits:{get:function(){return this._stencilBits}},stencilBuffer:{get:function(){return this._stencilBits>=8}},antialias:{get:function(){return this._antialias}},standardDerivatives:{get:function(){return this._standardDerivatives}},elementIndexUint:{get:function(){return this._elementIndexUint||this._webgl2}},depthTexture:{get:function(){return this._depthTexture}},floatingPointTexture:{get:function(){return this._textureFloat}},textureFilterAnisotropic:{get:function(){return!!this._textureFilterAnisotropic}},s3tc:{get:function(){return this._s3tc}},pvrtc:{get:function(){return this._pvrtc}},etc1:{get:function(){return this._etc1}},vertexArrayObject:{get:function(){return this._vertexArrayObject||this._webgl2}},fragmentDepth:{get:function(){return this._fragDepth}},instancedArrays:{get:function(){return this._instancedArrays||this._webgl2}},drawBuffers:{get:function(){return this._drawBuffers||this._webgl2}},debugShaders:{get:function(){return this._debugShaders}},throwOnWebGLError:{get:function(){return this._throwOnWebGLError},set:function(e){this._throwOnWebGLError=e;this._gl=R(this._originalGLContext,e?I:undefined)}},defaultTexture:{get:function(){if(this._defaultTexture===undefined){this._defaultTexture=new x({context:this,source:{width:1,height:1,arrayBufferView:new Uint8Array([255,255,255,255])}})}return this._defaultTexture}},defaultCubeMap:{get:function(){if(this._defaultCubeMap===undefined){var e={width:1,height:1,arrayBufferView:new Uint8Array([255,255,255,255])};this._defaultCubeMap=new y({context:this,source:{positiveX:e,negativeX:e,positiveY:e,negativeY:e,positiveZ:e,negativeZ:e}})}return this._defaultCubeMap}},drawingBufferHeight:{get:function(){return this._gl.drawingBufferHeight}},drawingBufferWidth:{get:function(){return this._gl.drawingBufferWidth}},defaultFramebuffer:{get:function(){return B}}});function F(e){if(e.validateFramebuffer){var t=e._gl;var r=t.checkFramebufferStatus(t.FRAMEBUFFER);if(r!==t.FRAMEBUFFER_COMPLETE){var i;switch(r){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:i="Framebuffer is not complete.  Incomplete attachment: at least one attachment point with a renderbuffer or texture attached has its attached object no longer in existence or has an attached image with a width or height of zero, or the color attachment point has a non-color-renderable image attached, or the depth attachment point has a non-depth-renderable image attached, or the stencil attachment point has a non-stencil-renderable image attached.  Color-renderable formats include GL_RGBA4, GL_RGB5_A1, and GL_RGB565. GL_DEPTH_COMPONENT16 is the only depth-renderable format. GL_STENCIL_INDEX8 is the only stencil-renderable format.";break;case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:i="Framebuffer is not complete.  Incomplete dimensions: not all attached images have the same width and height.";break;case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:i="Framebuffer is not complete.  Missing attachment: no images are attached to the framebuffer.";break;case t.FRAMEBUFFER_UNSUPPORTED:i="Framebuffer is not complete.  Unsupported: the combination of internal formats of the attached images violates an implementation-dependent set of restrictions.";break}throw new u(i)}}}function k(e,t,r,i){var n=e._currentRenderState;var a=e._currentPassState;e._currentRenderState=t;e._currentPassState=r;S.partialApply(e._gl,n,t,a,r,i)}var V;if(typeof WebGLRenderingContext!=="undefined"){V=[p.BACK]}function z(e,t){if(t!==e._currentFramebuffer){e._currentFramebuffer=t;var r=V;if(a(t)){t._bind();F(e);r=t._getActiveColorAttachments()}else{var i=e._gl;i.bindFramebuffer(i.FRAMEBUFFER,null)}if(e.drawBuffers){e.glDrawBuffers(r)}}}var U=new _;L.prototype.clear=function(e,r){e=n(e,U);r=n(r,this._defaultPassState);var i=this._gl;var o=0;var s=e.color;var u=e.depth;var l=e.stencil;if(a(s)){if(!t.equals(this._clearColor,s)){t.clone(s,this._clearColor);i.clearColor(s.red,s.green,s.blue,s.alpha)}o|=i.COLOR_BUFFER_BIT}if(a(u)){if(u!==this._clearDepth){this._clearDepth=u;i.clearDepth(u)}o|=i.DEPTH_BUFFER_BIT}if(a(l)){if(l!==this._clearStencil){this._clearStencil=l;i.clearStencil(l)}o|=i.STENCIL_BUFFER_BIT}var c=n(e.renderState,this._defaultRenderState);k(this,c,r,true);var d=n(e.framebuffer,r.framebuffer);z(this,d);i.clear(o)};function q(e,t,r,i){var o=n(r._renderState,e._defaultRenderState);if(a(t)&&o.depthTest){if(o.depthTest.enabled&&!t.hasDepthAttachment){throw new u("The depth test can not be enabled (drawCommand.renderState.depthTest.enabled) because the framebuffer (drawCommand.framebuffer) does not have a depth or depth-stencil renderbuffer.")}}z(e,t);k(e,o,i,false);var s=r._shaderProgram;s._bind();e._maxFrameTextureUnitIndex=Math.max(e._maxFrameTextureUnitIndex,s.maximumTextureUnitIndex)}function G(e,t){var r=t._primitiveType;var i=t._vertexArray;var o=t._offset;var s=t._count;var l=t.instanceCount;if(!f.validate(r)){throw new u("drawCommand.primitiveType is required and must be valid.")}if(!a(i)){throw new u("drawCommand.vertexArray is required.")}if(o<0){throw new u("drawCommand.offset must be greater than or equal to zero.")}if(s<0){throw new u("drawCommand.count must be greater than or equal to zero.")}if(l<0){throw new u("drawCommand.instanceCount must be greater than or equal to zero.")}if(l>0&&!e.instancedArrays){throw new u("Instanced arrays extension is not supported")}e._us.model=n(t._modelMatrix,d.IDENTITY);t._shaderProgram._setUniforms(t._uniformMap,e._us,e.validateShaderProgram);i._bind();var c=i.indexBuffer;if(a(c)){o=o*c.bytesPerIndex;s=n(s,c.numberOfIndices);if(l===0){e._gl.drawElements(r,s,c.indexDatatype,o)}else{e.glDrawElementsInstanced(r,s,c.indexDatatype,o,l)}}else{s=n(s,i.numberOfVertices);if(l===0){e._gl.drawArrays(r,o,s)}else{e.glDrawArraysInstanced(r,o,s,l)}}i._unBind()}L.prototype.draw=function(e,t){if(!a(e)){throw new u("drawCommand is required.")}if(!a(e._shaderProgram)){throw new u("drawCommand.shaderProgram is required.")}t=n(t,this._defaultPassState);var r=n(e._framebuffer,t.framebuffer);q(this,r,e,t);G(this,e)};L.prototype.endFrame=function(){var e=this._gl;e.useProgram(null);this._currentFramebuffer=undefined;e.bindFramebuffer(e.FRAMEBUFFER,null);var t=V;if(this.drawBuffers){this.glDrawBuffers(t)}var r=this._maxFrameTextureUnitIndex;this._maxFrameTextureUnitIndex=0;for(var i=0;i<r;++i){e.activeTexture(e.TEXTURE0+i);e.bindTexture(e.TEXTURE_2D,null);e.bindTexture(e.TEXTURE_CUBE_MAP,null)}};L.prototype.readPixels=function(e){var t=this._gl;e=e||{};var r=Math.max(e.x||0,0);var i=Math.max(e.y||0,0);var n=e.width||t.drawingBufferWidth;var a=e.height||t.drawingBufferHeight;var o=e.framebuffer;if(n<=0){throw new u("readState.width must be greater than zero.")}if(a<=0){throw new u("readState.height must be greater than zero.")}var s=new Uint8Array(4*n*a);z(this,o);t.readPixels(r,i,n,a,t.RGBA,t.UNSIGNED_BYTE,s);return s};var H={position:0,textureCoordinates:1};L.prototype.getViewportQuadVertexArray=function(){var e=this.cache.viewportQuad_vertexArray;if(!a(e)){var t=new l({attributes:{position:new c({componentDatatype:r.FLOAT,componentsPerAttribute:2,values:[-1,-1,1,-1,1,1,-1,1]}),textureCoordinates:new c({componentDatatype:r.FLOAT,componentsPerAttribute:2,values:[0,0,1,0,1,1,0,1]})},indices:new Uint16Array([0,1,2,0,2,3]),primitiveType:f.TRIANGLES});e=P.fromGeometry({context:this,geometry:t,attributeLocations:H,bufferUsage:v.STATIC_DRAW,interleave:true});this.cache.viewportQuad_vertexArray=e}return e};L.prototype.createViewportQuadCommand=function(e,t){t=n(t,n.EMPTY_OBJECT);return new w({vertexArray:this.getViewportQuadVertexArray(),primitiveType:f.TRIANGLES,renderState:t.renderState,shaderProgram:T.fromCache({context:this,vertexShaderSource:m,fragmentShaderSource:e,attributeLocations:H}),uniformMap:t.uniformMap,owner:t.owner,framebuffer:t.framebuffer})};L.prototype.createPickFramebuffer=function(){return new b(this)};L.prototype.getObjectByPickColor=function(e){if(!a(e)){throw new u("pickColor is required.")}return this._pickObjects[e.toRgba()]};function W(e,t,r){this._pickObjects=e;this.key=t;this.color=r}o(W.prototype,{object:{get:function(){return this._pickObjects[this.key]},set:function(e){this._pickObjects[this.key]=e}}});W.prototype.destroy=function(){delete this._pickObjects[this.key];return undefined};L.prototype.createPickId=function(e){if(!a(e)){throw new u("object is required.")}++this._nextPickColor[0];var r=this._nextPickColor[0];if(r===0){throw new h("Out of unique Pick IDs.")}this._pickObjects[r]=e;return new W(this._pickObjects,r,t.fromRgba(r))};L.prototype.isDestroyed=function(){return false};L.prototype.destroy=function(){var e=this.cache;for(var t in e){if(e.hasOwnProperty(t)){var r=e[t];if(a(r.destroy)){r.destroy()}}}this._shaderCache=this._shaderCache.destroy();this._defaultTexture=this._defaultTexture&&this._defaultTexture.destroy();this._defaultCubeMap=this._defaultCubeMap&&this._defaultCubeMap.destroy();return s(this)};return L});define("Renderer/loadCubeMap",["../Core/defined","../Core/DeveloperError","../Core/loadImage","../ThirdParty/when","./CubeMap"],function(e,t,r,i,n){"use strict";function a(a,o,s){if(!e(a)){throw new t("context is required.")}if(!e(o)||!e(o.positiveX)||!e(o.negativeX)||!e(o.positiveY)||!e(o.negativeY)||!e(o.positiveZ)||!e(o.negativeZ)){throw new t("urls is required and must have positiveX, negativeX, positiveY, negativeY, positiveZ, and negativeZ properties.")}var u=[r(o.positiveX,s),r(o.negativeX,s),r(o.positiveY,s),r(o.negativeY,s),r(o.positiveZ,s),r(o.negativeZ,s)];return i.all(u,function(e){return new n({context:a,source:{positiveX:e[0],negativeX:e[1],positiveY:e[2],negativeY:e[3],positiveZ:e[4],negativeZ:e[5]}})})}return a});define("Scene/DiscardMissingTileImagePolicy",["../Core/defaultValue","../Core/defined","../Core/DeveloperError","../Core/getImagePixels","../Core/loadImageViaBlob","../Core/RequestScheduler","../ThirdParty/when"],function(e,t,r,i,n,a,o){"use strict";function s(s){s=e(s,e.EMPTY_OBJECT);if(!t(s.missingImageUrl)){throw new r("options.missingImageUrl is required.")}if(!t(s.pixelsToCheck)){throw new r("options.pixelsToCheck is required.")}this._pixelsToCheck=s.pixelsToCheck;this._missingImagePixels=undefined;this._missingImageByteLength=undefined;this._isReady=false;var u=this;function l(e){if(t(e.blob)){u._missingImageByteLength=e.blob.size}var r=i(e);if(s.disableCheckIfAllPixelsAreTransparent){var n=true;var a=e.width;var o=s.pixelsToCheck;for(var l=0,c=o.length;n&&l<c;++l){var d=o[l];var f=d.x*4+d.y*a;var h=r[f+3];if(h>0){n=false}}if(n){r=undefined}}u._missingImagePixels=r;u._isReady=true}function c(){u._missingImagePixels=undefined;u._isReady=true}o(a.request(s.missingImageUrl,n),l,c)}s.prototype.isReady=function(){return this._isReady};s.prototype.shouldDiscardImage=function(e){if(!this._isReady){throw new r("shouldDiscardImage must not be called before the discard policy is ready.")}var n=this._pixelsToCheck;var a=this._missingImagePixels;if(!t(a)){return false}if(t(e.blob)&&e.blob.size!==this._missingImageByteLength){return false}var o=i(e);var s=e.width;for(var u=0,l=n.length;u<l;++u){var c=n[u];var d=c.x*4+c.y*s;for(var f=0;f<4;++f){var h=d+f;if(o[h]!==a[h]){return false}}}return true};return s});define("Scene/ImageryLayerFeatureInfo",["../Core/defined"],function(e){"use strict";function t(){this.name=undefined;this.description=undefined;this.position=undefined;this.data=undefined;this.imageryLayer=undefined}t.prototype.configureNameFromProperties=function(t){var r=10;var i;for(var n in t){if(t.hasOwnProperty(n)&&t[n]){var a=n.toLowerCase();if(r>1&&a==="name"){r=1;i=n}else if(r>2&&a==="title"){r=2;i=n}else if(r>3&&/name/i.test(n)){r=3;i=n}else if(r>4&&/title/i.test(n)){r=4;i=n}}}if(e(i)){this.name=t[i]}};t.prototype.configureDescriptionFromProperties=function(t){function r(t){var i='<table class="cesium-infoBox-defaultTable">';for(var n in t){if(t.hasOwnProperty(n)){var a=t[n];if(e(a)){if(typeof a==="object"){i+="<tr><td>"+n+"</td><td>"+r(a)+"</td></tr>"}else{i+="<tr><td>"+n+"</td><td>"+a+"</td></tr>"}}}}i+="</table>";return i}this.description=r(t)};return t});define("Scene/ImageryProvider",["../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/loadCRN","../Core/loadImage","../Core/loadImageViaBlob","../Core/loadKTX","../Core/Request","../Core/RequestScheduler","../Core/RequestType"],function(e,t,r,i,n,a,o,s,u,l){"use strict";function c(){this.defaultAlpha=undefined;this.defaultBrightness=undefined;this.defaultContrast=undefined;this.defaultHue=undefined;this.defaultSaturation=undefined;this.defaultGamma=undefined;r.throwInstantiationError()}t(c.prototype,{ready:{get:r.throwInstantiationError},readyPromise:{get:r.throwInstantiationError},rectangle:{get:r.throwInstantiationError},tileWidth:{get:r.throwInstantiationError},tileHeight:{get:r.throwInstantiationError},maximumLevel:{get:r.throwInstantiationError},minimumLevel:{get:r.throwInstantiationError},tilingScheme:{get:r.throwInstantiationError},tileDiscardPolicy:{get:r.throwInstantiationError},errorEvent:{get:r.throwInstantiationError},credit:{get:r.throwInstantiationError},proxy:{get:r.throwInstantiationError},hasAlphaChannel:{get:r.throwInstantiationError}});c.prototype.getTileCredits=r.throwInstantiationError;c.prototype.requestImage=r.throwInstantiationError;c.prototype.pickFeatures=r.throwInstantiationError;var d=/\.ktx$/i;var f=/\.crn$/i;c.loadImage=function(t,r,c){var h;if(d.test(r)){h=o}else if(f.test(r)){h=i}else if(e(t.tileDiscardPolicy)){h=a}else{h=n}return u.schedule(new s({url:r,requestFunction:h,type:l.IMAGERY,distance:c}))};return c});define("Scene/ArcGisMapServerImageryProvider",["../Core/Cartesian2","../Core/Cartesian3","../Core/Cartographic","../Core/Credit","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/GeographicTilingScheme","../Core/loadJson","../Core/loadJsonp","../Core/Math","../Core/Rectangle","../Core/RequestScheduler","../Core/RuntimeError","../Core/TileProviderError","../Core/WebMercatorProjection","../Core/WebMercatorTilingScheme","../ThirdParty/when","./DiscardMissingTileImagePolicy","./ImageryLayerFeatureInfo","./ImageryProvider"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w,C,b){"use strict";function S(r){r=n(r,{});if(!a(r.url)){throw new s("options.url is required.")}this._url=r.url;this._token=r.token;this._tileDiscardPolicy=r.tileDiscardPolicy;this._proxy=r.proxy;this._tileWidth=n(r.tileWidth,256);this._tileHeight=n(r.tileHeight,256);this._maximumLevel=r.maximumLevel;this._tilingScheme=n(r.tilingScheme,new l({ellipsoid:r.ellipsoid}));this._credit=undefined;this._useTiles=n(r.usePreCachedTilesIfAvailable,true);this._rectangle=n(r.rectangle,this._tilingScheme.rectangle);this._layers=r.layers;this.enablePickFeatures=n(r.enablePickFeatures,true);this._errorEvent=new u;this._ready=false;this._readyPromise=y.defer();var o=this;var c;function f(n){var s=n.tileInfo;if(!a(s)){o._useTiles=false}else{o._tileWidth=s.rows;o._tileHeight=s.cols;if(s.spatialReference.wkid===102100||s.spatialReference.wkid===102113){o._tilingScheme=new g({ellipsoid:r.ellipsoid})}else if(n.tileInfo.spatialReference.wkid===4326){o._tilingScheme=new l({ellipsoid:r.ellipsoid})}else{var u="Tile spatial reference WKID "+n.tileInfo.spatialReference.wkid+" is not supported.";c=v.handleError(c,o,o._errorEvent,u,undefined,undefined,undefined,b);return}o._maximumLevel=n.tileInfo.lods.length-1;if(a(n.fullExtent)){if(a(n.fullExtent.spatialReference)&&a(n.fullExtent.spatialReference.wkid)){if(n.fullExtent.spatialReference.wkid===102100||n.fullExtent.spatialReference.wkid===102113){var d=new _;var f=n.fullExtent;var p=d.unproject(new t(Math.max(f.xmin,-o._tilingScheme.ellipsoid.maximumRadius*Math.PI),Math.max(f.ymin,-o._tilingScheme.ellipsoid.maximumRadius*Math.PI),0));var m=d.unproject(new t(Math.min(f.xmax,o._tilingScheme.ellipsoid.maximumRadius*Math.PI),Math.min(f.ymax,o._tilingScheme.ellipsoid.maximumRadius*Math.PI),0));o._rectangle=new h(p.longitude,p.latitude,m.longitude,m.latitude)}else if(n.fullExtent.spatialReference.wkid===4326){o._rectangle=h.fromDegrees(n.fullExtent.xmin,n.fullExtent.ymin,n.fullExtent.xmax,n.fullExtent.ymax)}else{var y="fullExtent.spatialReference WKID "+n.fullExtent.spatialReference.wkid+" is not supported.";c=v.handleError(c,o,o._errorEvent,y,undefined,undefined,undefined,b);return}}}else{o._rectangle=o._tilingScheme.rectangle}if(!a(o._tileDiscardPolicy)){o._tileDiscardPolicy=new w({missingImageUrl:E(o,0,0,o._maximumLevel),pixelsToCheck:[new e(0,0),new e(200,20),new e(20,200),new e(80,110),new e(160,130)],disableCheckIfAllPixelsAreTransparent:true})}o._useTiles=true}if(a(n.copyrightText)&&n.copyrightText.length>0){o._credit=new i(n.copyrightText)}o._ready=true;o._readyPromise.resolve(true);v.handleSuccess(c)}function C(e){var t="An error occurred while accessing "+o._url+".";c=v.handleError(c,o,o._errorEvent,t,undefined,undefined,undefined,b);o._readyPromise.reject(new m(t))}function b(){var e={f:"json"};if(a(o._token)){e.token=o._token}var t=p.request(o._url,d,{parameters:e,proxy:o._proxy});y(t,f,C)}if(this._useTiles){b()}else{this._ready=true;this._readyPromise.resolve(true)}}function E(e,t,r,i){var n;if(e._useTiles){n=e._url+"/tile/"+i+"/"+r+"/"+t}else{var o=e._tilingScheme.tileXYToNativeRectangle(t,r,i);var s=o.west+"%2C"+o.south+"%2C"+o.east+"%2C"+o.north;n=e._url+"/export?";n+="bbox="+s;if(e._tilingScheme instanceof l){n+="&bboxSR=4326&imageSR=4326"}else{n+="&bboxSR=3857&imageSR=3857"}n+="&size="+e._tileWidth+"%2C"+e._tileHeight;n+="&format=png&transparent=true&f=image";if(e.layers){n+="&layers=show:"+e.layers}}var u=e._token;if(a(u)){if(n.indexOf("?")===-1){n+="?"}if(n[n.length-1]!=="?"){n+="&"}n+="token="+u}var c=e._proxy;if(a(c)){n=c.getURL(n)}return n}o(S.prototype,{url:{get:function(){return this._url}},token:{get:function(){return this._token}},proxy:{get:function(){return this._proxy}},tileWidth:{get:function(){if(!this._ready){throw new s("tileWidth must not be called before the imagery provider is ready.")}return this._tileWidth}},tileHeight:{get:function(){if(!this._ready){throw new s("tileHeight must not be called before the imagery provider is ready.")}return this._tileHeight}},maximumLevel:{get:function(){if(!this._ready){throw new s("maximumLevel must not be called before the imagery provider is ready.")}return this._maximumLevel}},minimumLevel:{get:function(){if(!this._ready){throw new s("minimumLevel must not be called before the imagery provider is ready.")}return 0}},tilingScheme:{get:function(){if(!this._ready){throw new s("tilingScheme must not be called before the imagery provider is ready.")}return this._tilingScheme}},rectangle:{get:function(){if(!this._ready){throw new s("rectangle must not be called before the imagery provider is ready.")}return this._rectangle}},tileDiscardPolicy:{get:function(){if(!this._ready){throw new s("tileDiscardPolicy must not be called before the imagery provider is ready.")}return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},credit:{get:function(){return this._credit}},usingPrecachedTiles:{get:function(){return this._useTiles}},hasAlphaChannel:{get:function(){return true}},layers:{get:function(){return this._layers}}});S.prototype.getTileCredits=function(e,t,r){return undefined};S.prototype.requestImage=function(e,t,r,i){if(!this._ready){throw new s("requestImage must not be called before the imagery provider is ready.")}var n=E(this,e,t,r);return b.loadImage(this,n,i)};S.prototype.pickFeatures=function(e,i,n,o,u){if(!this._ready){throw new s("pickFeatures must not be called before the imagery provider is ready.")}if(!this.enablePickFeatures){return undefined}var d=this._tilingScheme.tileXYToNativeRectangle(e,i,n);var h;var p;var m;if(this._tilingScheme instanceof l){h=f.toDegrees(o);p=f.toDegrees(u);m="4326"}else{var v=this._tilingScheme.projection.project(new r(o,u,0));h=v.x;p=v.y;m="3857"}var g=this._url+"/identify?f=json&tolerance=2&geometryType=esriGeometryPoint";g+="&geometry="+h+","+p;g+="&mapExtent="+d.west+","+d.south+","+d.east+","+d.north;g+="&imageDisplay="+this._tileWidth+","+this._tileHeight+",96";g+="&sr="+m;g+="&layers=visible";if(a(this._layers)){g+=":"+this._layers}if(a(this._token)){g+="&token="+this._token}if(a(this._proxy)){g=this._proxy.getURL(g)}return c(g).then(function(e){var i=[];var n=e.results;if(!a(n)){return i}for(var o=0;o<n.length;++o){var s=n[o];var u=new C;u.data=s;u.name=s.value;u.properties=s.attributes;u.configureDescriptionFromProperties(s.attributes);if(s.geometryType==="esriGeometryPoint"&&s.geometry){var l=s.geometry.spatialReference&&s.geometry.spatialReference.wkid?s.geometry.spatialReference.wkid:4326;if(l===4326||l===4283){u.position=r.fromDegrees(s.geometry.x,s.geometry.y,s.geometry.z)}else if(l===102100||l===900913||l===3857){var c=new _;u.position=c.unproject(new t(s.geometry.x,s.geometry.y,s.geometry.z))}}i.push(u)}return i})};return S});define("Scene/Cesium3DTileColorBlendMode",["../Core/freezeObject"],function(e){"use strict";var t={HIGHLIGHT:0,REPLACE:1,MIX:2};return e(t)});define("Scene/Cesium3DTileBatchTable",["../Core/arrayFill","../Core/Cartesian2","../Core/Cartesian4","../Core/clone","../Core/Color","../Core/combine","../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/Math","../Core/PixelFormat","../Renderer/ContextLimits","../Renderer/DrawCommand","../Renderer/Pass","../Renderer/PixelDatatype","../Renderer/RenderState","../Renderer/Sampler","../Renderer/ShaderSource","../Renderer/Texture","../Renderer/TextureMagnificationFilter","../Renderer/TextureMinificationFilter","./BlendingState","./Cesium3DTileColorBlendMode","./CullFace","./getBinaryAccessor"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w,C,b,S,E,T,x,A){"use strict";function P(e,i,n,a){i=s(i,0);this.featuresLength=i;this._translucentFeaturesLength=0;this.batchTableJson=n;this.batchTableBinary=a;var o;var l;if(u(n)){o=n.HIERARCHY;if(u(o)){delete n.HIERARCHY;o=D(o,a)}l=P.getBinaryProperties(i,n,a)}this._batchTableHierarchy=o;this._batchTableBinaryProperties=l;this._showAlphaProperties=undefined;this._batchValues=undefined;this._batchValuesDirty=false;this._batchTexture=undefined;this._defaultTexture=undefined;this._pickTexture=undefined;this._pickIds=[];this._content=e;var c;var d;if(i>0){var f=Math.min(i,p.maximumTextureSize);var h=Math.ceil(i/p.maximumTextureSize);var m=1/f;var v=m*.5;var _=1/h;var g=_*.5;c=new t(f,h);d=new r(m,v,_,g)}this._textureDimensions=c;this._textureStep=d}l(P.prototype,{memorySizeInBytes:{get:function(){var e=0;if(u(this._pickTexture)){e+=this._pickTexture.sizeInBytes}if(u(this._batchTexture)){e+=this._batchTexture.sizeInBytes}return e}}});function D(t,r){var i;var n;var o;var l=t.instancesLength;var c=t.classes;var d=t.classIds;var f=t.parentCounts;var h=t.parentIds;var p=l;if(u(d.byteOffset)){d.componentType=s(d.componentType,"UNSIGNED_SHORT");d.type="SCALAR";o=A(d);d=o.createArrayBufferView(r.buffer,r.byteOffset+d.byteOffset,l)}var m;if(u(f)){if(u(f.byteOffset)){f.componentType=s(f.componentType,"UNSIGNED_SHORT");f.type="SCALAR";o=A(f);f=o.createArrayBufferView(r.buffer,r.byteOffset+f.byteOffset,l)}m=new Uint16Array(l);p=0;for(i=0;i<l;++i){m[i]=p;p+=f[i]}}if(u(h)){if(u(h.byteOffset)){h.componentType=s(h.componentType,"UNSIGNED_SHORT");h.type="SCALAR";o=A(h);h=o.createArrayBufferView(r.buffer,r.byteOffset+h.byteOffset,p)}}var v=c.length;for(i=0;i<v;++i){var _=c[i].length;var g=c[i].instances;var y=P.getBinaryProperties(_,g,r);c[i].instances=a(y,g)}var w=e(new Array(v),0);var C=new Uint16Array(l);for(i=0;i<l;++i){n=d[i];C[i]=w[n];++w[n]}var b={classes:c,classIds:d,classIndexes:C,parentCounts:f,parentIndexes:m,parentIds:h};I(b);return b}var M=[];function I(e){var t=M;t.length=0;var r=e.classIds;var i=r.length;for(var n=0;n<i;++n){O(e,n,t)}}function O(e,t,r){var i=e.parentCounts;var n=e.parentIds;var a=e.parentIndexes;var o=e.classIds;var s=o.length;if(!u(n)){return}if(t>=s){throw new d("Parent index "+t+" exceeds the total number of instances: "+s)}if(r.indexOf(t)>-1){throw new d("Circular dependency detected in the batch table hierarchy.")}r.push(t);var l=u(i)?i[t]:1;var c=u(i)?a[t]:t;for(var f=0;f<l;++f){var h=n[c+f];if(h!==t){O(e,h,r)}}r.pop(t)}P.getBinaryProperties=function(e,t,r){var i;if(u(t)){for(var n in t){if(t.hasOwnProperty(n)){var a=t[n];var s=a.byteOffset;if(u(s)){var l=o.fromName(a.componentType);var c=a.type;if(!u(l)){throw new d("componentType is required.")}if(!u(c)){throw new d("type is required.")}if(!u(r)){throw new d("Property "+n+" requires a batch table binary.")}var f=A(a);var h=f.componentsPerAttribute;var p=f.classType;var m=f.createArrayBufferView(r.buffer,r.byteOffset+s,e);if(!u(i)){i={}}i[n]={typedArray:m,componentCount:h,type:p}}}}}return i};function R(e){var t=e._textureDimensions;return t.x*t.y*4}function N(t){if(!u(t._batchValues)){var r=R(t);var i=new Uint8Array(r);e(i,255);t._batchValues=i}return t._batchValues}function L(t){if(!u(t._showAlphaProperties)){var r=2*t.featuresLength;var i=new Uint8Array(r);e(i,255);t._showAlphaProperties=i}return t._showAlphaProperties}P.prototype.setShow=function(e,t){var r=this.featuresLength;if(!u(e)||e<0||e>r){throw new d("batchId is required and between zero and featuresLength - 1 ("+r-+").")}if(!u(t)){throw new d("show is required.")}if(t&&!u(this._showAlphaProperties)){return}var i=L(this);var n=e*2;var a=t?255:0;if(i[n]!==a){i[n]=a;var o=N(this);var s=e*4+3;o[s]=t?i[n+1]:0;this._batchValuesDirty=true}};P.prototype.getShow=function(e){var t=this.featuresLength;if(!u(e)||e<0||e>t){throw new d("batchId is required and between zero and featuresLength - 1 ("+t-+").")}if(!u(this._showAlphaProperties)){return true}var r=e*2;return this._showAlphaProperties[r]===255};var B=new Array(4);P.prototype.setColor=function(e,t){var r=this.featuresLength;if(!u(e)||e<0||e>r){throw new d("batchId is required and between zero and featuresLength - 1 ("+r-+").")}if(!u(t)){throw new d("color is required.")}if(n.equals(t,n.WHITE)&&!u(this._batchValues)){return}var i=t.toBytes(B);var a=i[3];var o=N(this);var s=e*4;var l=L(this);var c=e*2;if(o[s]!==i[0]||o[s+1]!==i[1]||o[s+2]!==i[2]||l[c+1]!==a){o[s]=i[0];o[s+1]=i[1];o[s+2]=i[2];var f=l[c+1]!==255;var h=l[c]!==0;o[s+3]=h?a:0;l[c+1]=a;var p=a!==255;if(p&&!f){++this._translucentFeaturesLength}else if(!p&&f){--this._translucentFeaturesLength}this._batchValuesDirty=true}};P.prototype.setAllColor=function(e){if(!u(e)){throw new d("color is required.")}var t=this.featuresLength;for(var r=0;r<t;++r){this.setColor(r,e)}};P.prototype.getColor=function(e,t){var r=this.featuresLength;if(!u(e)||e<0||e>r){throw new d("batchId is required and between zero and featuresLength - 1 ("+r-+").")}if(!u(t)){throw new d("result is required.")}if(!u(this._batchValues)){return n.clone(n.WHITE,t)}var i=this._batchValues;var a=e*4;var o=this._showAlphaProperties;var s=e*2;return n.fromBytes(i[a],i[a+1],i[a+2],o[s+1],t)};function F(e,t){var r=e.typedArray;var i=e.componentCount;if(i===1){return r[t]}return e.type.unpack(r,t*i)}function k(e,t,r){var i=e.typedArray;var n=e.componentCount;if(n===1){i[t]=r}else{e.type.pack(r,i,t*n)}}var V=[];var z=[];var U=0;function q(e,t,r){var i=e.classIds;var n=e.parentCounts;var a=e.parentIds;var o=e.parentIndexes;var s=i.length;var l=V;l.length=Math.max(l.length,s);var c=++U;var d=z;d.length=0;d.push(t);while(d.length>0){t=d.pop();if(l[t]===c){continue}l[t]=c;var f=r(e,t);if(u(f)){return f}var h=n[t];var p=o[t];for(var m=0;m<h;++m){var v=a[p+m];if(v!==t){d.push(v)}}}}function G(e,t,r){while(true){var i=r(e,t);if(u(i)){return i}var n=e.parentIds[t];if(n===t){break}t=n}}function H(e,t,r){return r(e,t)}function W(e,t,r){var i=e.parentCounts;var n=e.parentIds;if(!u(n)){return H(e,t,r)}else if(u(i)){return q(e,t,r)}return G(e,t,r)}function j(e,t,r){var i=e._batchTableHierarchy;var n=W(i,t,function(e,t){var i=e.classIds[t];var n=e.classes[i].instances;if(u(n[r])){return true}});return u(n)}function Y(e,t,r){var i=e._batchTableHierarchy;W(i,t,function(e,t){var i=e.classIds[t];var n=e.classes[i].instances;for(var a in n){if(n.hasOwnProperty(a)){r[a]=true}}})}function X(e,t,r){var n=e._batchTableHierarchy;return W(n,t,function(e,t){var n=e.classIds[t];var a=e.classes[n];var o=e.classIndexes[t];var s=a.instances[r];if(u(s)){if(u(s.typedArray)){return F(s,o)}return i(s[o],true)}})}function Z(e,t,r,n){var a=e._batchTableHierarchy;var o=W(a,t,function(e,a){var o=e.classIds[a];var s=e.classes[o];var l=e.classIndexes[a];var c=s.instances[r];if(u(c)){if(a!==t){throw new d('Inherited property "'+r+'" is read-only.')}if(u(c.typedArray)){k(c,l,n)}else{c[l]=i(n,true)}return true}});return u(o)}P.prototype.isClass=function(e,t){var r=this.featuresLength;if(!u(e)||e<0||e>r){throw new d("batchId is required and between zero and featuresLength - 1 ("+r-+").")}if(!u(t)){throw new d("className is required.")}var i=this._batchTableHierarchy;if(!u(i)){return false}var n=W(i,e,function(e,r){var i=e.classIds[r];var n=e.classes[i];if(n.name===t){return true}});return u(n)};P.prototype.isExactClass=function(e,t){if(!u(t)){throw new d("className is required.")}return this.getExactClassName(e)===t};P.prototype.getExactClassName=function(e){var t=this.featuresLength;if(!u(e)||e<0||e>t){throw new d("batchId is required and between zero and featuresLength - 1 ("+t-+").")}var r=this._batchTableHierarchy;if(!u(r)){return undefined}var i=r.classIds[e];var n=r.classes[i];return n.name};P.prototype.hasProperty=function(e,t){var r=this.featuresLength;if(!u(e)||e<0||e>r){throw new d("batchId is required and between zero and featuresLength - 1 ("+r-+").")}if(!u(t)){throw new d("name is required.")}var i=this.batchTableJson;return u(i)&&u(i[t])||u(this._batchTableHierarchy)&&j(this,e,t)};P.prototype.getPropertyNames=function(e){var t=this.featuresLength;if(!u(e)||e<0||e>t){throw new d("batchId is required and between zero and featuresLength - 1 ("+t-+").")}var r=this.batchTableJson;if(!u(r)){return[]}if(!u(this._batchTableHierarchy)){return Object.keys(r)}var i={};for(var n in r){if(r.hasOwnProperty(n)){i[n]=true}}Y(this,e,i);return Object.keys(i)};P.prototype.getProperty=function(e,t){var r=this.featuresLength;if(!u(e)||e<0||e>r){throw new d("batchId is required and between zero and featuresLength - 1 ("+r-+").")}if(!u(t)){throw new d("name is required.")}if(!u(this.batchTableJson)){return undefined}if(u(this._batchTableBinaryProperties)){var n=this._batchTableBinaryProperties[t];if(u(n)){return F(n,e)}}var a=this.batchTableJson[t];if(u(a)){return i(a[e],true)}if(u(this._batchTableHierarchy)){var o=X(this,e,t);if(u(o)){return o}}return undefined}
;P.prototype.setProperty=function(e,t,r){var n=this.featuresLength;if(!u(e)||e<0||e>n){throw new d("batchId is required and between zero and featuresLength - 1 ("+n-+").")}if(!u(t)){throw new d("name is required.")}if(u(this._batchTableBinaryProperties)){var a=this._batchTableBinaryProperties[t];if(u(a)){k(a,e,r);return}}if(u(this._batchTableHierarchy)){if(Z(this,e,t,r)){return}}if(!u(this.batchTableJson)){this.batchTableJson={}}var o=this.batchTableJson[t];if(!u(o)){this.batchTableJson[t]=new Array(n);o=this.batchTableJson[t]}o[e]=i(r,true)};function K(e){if(e._textureDimensions.y===1){return"uniform vec4 tile_textureStep; \n"+"vec2 computeSt(float batchId) \n"+"{ \n"+"    float stepX = tile_textureStep.x; \n"+"    float centerX = tile_textureStep.y; \n"+"    return vec2(centerX + (batchId * stepX), 0.5); \n"+"} \n"}return"uniform vec4 tile_textureStep; \n"+"uniform vec2 tile_textureDimensions; \n"+"vec2 computeSt(float batchId) \n"+"{ \n"+"    float stepX = tile_textureStep.x; \n"+"    float centerX = tile_textureStep.y; \n"+"    float stepY = tile_textureStep.z; \n"+"    float centerY = tile_textureStep.w; \n"+"    float xId = mod(batchId, tile_textureDimensions.x); \n"+"    float yId = floor(batchId / tile_textureDimensions.x); \n"+"    return vec2(centerX + (xId * stepX), 1.0 - (centerY + (yId * stepY))); \n"+"} \n"}P.prototype.getVertexShaderCallback=function(e,t){if(this.featuresLength===0){return}var r=this;return function(i){var n=w.replaceMain(i,"tile_main");var a;if(p.maximumVertexTextureImageUnits>0){a="uniform sampler2D tile_batchTexture; \n"+"uniform bool tile_translucentCommand; \n"+"varying vec4 tile_featureColor; \n"+"void main() \n"+"{ \n"+"    tile_main(); \n"+"    vec2 st = computeSt("+t+"); \n"+"    vec4 featureProperties = texture2D(tile_batchTexture, st); \n"+"    float show = ceil(featureProperties.a); \n"+"    gl_Position *= show; \n";if(e){a+="    bool isStyleTranslucent = (featureProperties.a != 1.0); \n"+"    if (czm_pass == czm_passTranslucent) \n"+"    { \n"+"        if (!isStyleTranslucent && !tile_translucentCommand) \n"+"        { \n"+"            gl_Position *= 0.0; \n"+"        } \n"+"    } \n"+"    else \n"+"    { \n"+"        if (isStyleTranslucent) \n"+"        { \n"+"            gl_Position *= 0.0; \n"+"        } \n"+"    } \n"}a+="    tile_featureColor = featureProperties; \n"+"}"}else{a="varying vec2 tile_featureSt; \n"+"void main() \n"+"{ \n"+"    tile_main(); \n"+"    tile_featureSt = computeSt("+t+"); \n"+"}"}return n+"\n"+K(r)+a}};function Q(e){e=w.replaceMain(e,"tile_main");return e+"void tile_color(vec4 tile_featureColor) \n"+"{ \n"+"    tile_main(); \n"+"    gl_FragColor *= tile_featureColor; \n"+"} \n"}function J(e,t){if(!u(t)){return Q(e)}var r=new RegExp("uniform\\s+(vec[34]|sampler2D)\\s+"+t+";");var i=e.match(r);if(!u(i)){return Q(e)}var n=i[0];var a=i[1];e=w.replaceMain(e,"tile_main");e=e.replace(n,"");var o="vec4 tile_diffuse_final(vec4 sourceDiffuse, vec4 tileDiffuse) \n"+"{ \n"+"    vec4 blendDiffuse = mix(sourceDiffuse, tileDiffuse, tile_colorBlend); \n"+"    vec4 diffuse = (tileDiffuse.rgb == vec3(1.0)) ? sourceDiffuse : blendDiffuse; \n"+"    return vec4(diffuse.rgb, sourceDiffuse.a); \n"+"} \n";var s="    gl_FragColor.a *= tile_featureColor.a; \n"+"    float highlight = ceil(tile_colorBlend); \n"+"    gl_FragColor.rgb *= mix(tile_featureColor.rgb, vec3(1.0), highlight); \n";var l;if(a==="vec3"||a==="vec4"){var c=a==="vec3"?"vec4("+t+", 1.0)":t;var d=a==="vec3"?"tile_diffuse.xyz":"tile_diffuse";r=new RegExp(t,"g");e=e.replace(r,d);l="    vec4 source = "+c+"; \n"+"    tile_diffuse = tile_diffuse_final(source, tile_featureColor); \n"+"    tile_main(); \n"}else if(a==="sampler2D"){r=new RegExp("texture2D\\("+t+".*?\\)","g");e=e.replace(r,"tile_diffuse_final($&, tile_diffuse)");l="    tile_diffuse = tile_featureColor; \n"+"    tile_main(); \n"}e="uniform float tile_colorBlend; \n"+"vec4 tile_diffuse = vec4(1.0); \n"+o+n+"\n"+e+"\n"+"void tile_color(vec4 tile_featureColor) \n"+"{ \n"+l+s+"} \n";return e}P.prototype.getFragmentShaderCallback=function(e,t){if(this.featuresLength===0){return}return function(r){r=J(r,t);if(p.maximumVertexTextureImageUnits>0){r+="varying vec4 tile_featureColor; \n"+"void main() \n"+"{ \n"+"    tile_color(tile_featureColor); \n"+"}"}else{r+="uniform sampler2D tile_batchTexture; \n"+"uniform bool tile_translucentCommand; \n"+"varying vec2 tile_featureSt; \n"+"void main() \n"+"{ \n"+"    vec4 featureProperties = texture2D(tile_batchTexture, tile_featureSt); \n"+"    if (featureProperties.a == 0.0) { \n"+"        discard; \n"+"    } \n";if(e){r+="    bool isStyleTranslucent = (featureProperties.a != 1.0); \n"+"    if (czm_pass == czm_passTranslucent) \n"+"    { \n"+"        if (!isStyleTranslucent && !tile_translucentCommand) \n"+"        { \n"+"            discard; \n"+"        } \n"+"    } \n"+"    else \n"+"    { \n"+"        if (isStyleTranslucent) \n"+"        { \n"+"            discard; \n"+"        } \n"+"    } \n"}r+="    tile_color(featureProperties); \n"+"} \n"}return r}};function $(e){var t=e._content._tileset;var r=t.colorBlendMode;var i=t.colorBlendAmount;if(r===T.HIGHLIGHT){return 0}else if(r===T.REPLACE){return 1}else if(r===T.MIX){return f.clamp(i,f.EPSILON4,1)}}P.prototype.getUniformMapCallback=function(){if(this.featuresLength===0){return}var e=this;return function(t){var r={tile_batchTexture:function(){return s(e._batchTexture,e._defaultTexture)},tile_textureDimensions:function(){return e._textureDimensions},tile_textureStep:function(){return e._textureStep},tile_colorBlend:function(){return $(e)}};return a(t,r)}};P.prototype.getPickVertexShaderCallback=function(e){if(this.featuresLength===0){return}var t=this;return function(r){var i=w.replaceMain(r,"tile_main");var n;if(p.maximumVertexTextureImageUnits>0){n="uniform sampler2D tile_batchTexture; \n"+"varying vec2 tile_featureSt; \n"+"void main() \n"+"{ \n"+"    tile_main(); \n"+"    vec2 st = computeSt("+e+"); \n"+"    vec4 featureProperties = texture2D(tile_batchTexture, st); \n"+"    float show = ceil(featureProperties.a); \n"+"    gl_Position *= show; \n"+"    tile_featureSt = st; \n"+"}"}else{n="varying vec2 tile_featureSt; \n"+"void main() \n"+"{ \n"+"    tile_main(); \n"+"    tile_featureSt = computeSt("+e+"); \n"+"}"}return i+"\n"+K(t)+n}};P.prototype.getPickFragmentShaderCallback=function(){if(this.featuresLength===0){return}return function(e){var t=w.replaceMain(e,"tile_main");var r;if(p.maximumVertexTextureImageUnits>0){r="uniform sampler2D tile_pickTexture; \n"+"varying vec2 tile_featureSt; \n"+"void main() \n"+"{ \n"+"    tile_main(); \n"+"    if (gl_FragColor.a == 0.0) { \n"+"        discard; \n"+"    } \n"+"    gl_FragColor = texture2D(tile_pickTexture, tile_featureSt); \n"+"}"}else{r="uniform sampler2D tile_pickTexture; \n"+"uniform sampler2D tile_batchTexture; \n"+"varying vec2 tile_featureSt; \n"+"void main() \n"+"{ \n"+"    vec4 featureProperties = texture2D(tile_batchTexture, tile_featureSt); \n"+"    if (featureProperties.a == 0.0) { \n"+"        discard; \n"+"    } \n"+"    tile_main(); \n"+"    if (gl_FragColor.a == 0.0) { \n"+"        discard; \n"+"    } \n"+"    gl_FragColor = texture2D(tile_pickTexture, tile_featureSt); \n"+"}"}return t+"\n"+r}};P.prototype.getPickUniformMapCallback=function(){if(this.featuresLength===0){return}var e=this;return function(t){var r={tile_batchTexture:function(){return s(e._batchTexture,e._defaultTexture)},tile_textureDimensions:function(){return e._textureDimensions},tile_textureStep:function(){return e._textureStep},tile_pickTexture:function(){return e._pickTexture}};return a(r,t)}};var ee={ALL_OPAQUE:0,ALL_TRANSLUCENT:1,OPAQUE_AND_TRANSLUCENT:2};function te(e,t){for(var r in e){if(e.hasOwnProperty(r)){var i=e[r];i.castShadows=t.castShadows;i.receiveShadows=t.receiveShadows;i.primitiveType=t.primitiveType}}}P.prototype.getAddCommand=function(){var e=re(this);return function(t){var r=this.commandList;var i=t.derivedCommands.tileset;if(!u(i)){i={};t.derivedCommands.tileset=i;i.originalCommand=ne(t);i.back=ie(t,x.FRONT);i.front=ie(t,x.BACK)}te(i,t);if(t.pass!==v.TRANSLUCENT){if(e===ee.ALL_OPAQUE){r.push(i.originalCommand)}if(e===ee.ALL_TRANSLUCENT){r.push(i.back);r.push(i.front)}if(e===ee.OPAQUE_AND_TRANSLUCENT){r.push(i.originalCommand);r.push(i.back);r.push(i.front)}}else{r.push(i.originalCommand)}}};function re(e){var t=e._translucentFeaturesLength;if(t===0){return ee.ALL_OPAQUE}else if(t===e.featuresLength){return ee.ALL_TRANSLUCENT}return ee.OPAQUE_AND_TRANSLUCENT}function ie(e,t){var r=ne(e);r.pass=v.TRANSLUCENT;r.renderState=ae(e.renderState,t);return r}function ne(e){var t=m.shallowClone(e);var r=t.pass===v.TRANSLUCENT;t.uniformMap=u(t.uniformMap)?t.uniformMap:{};t.uniformMap.tile_translucentCommand=function(){return r};return t}function ae(e,t){var r=i(e,true);r.cull.enabled=true;r.cull.face=t;r.depthTest.enabled=true;r.depthMask=false;r.blending=E.ALPHA_BLEND;return g.fromCache(r)}function oe(e,t,r){var i=e._textureDimensions;return new C({context:t,pixelFormat:h.RGBA,pixelDatatype:_.UNSIGNED_BYTE,source:{width:i.x,height:i.y,arrayBufferView:r},sampler:new y({minificationFilter:S.NEAREST,magnificationFilter:b.NEAREST})})}function se(e,t){var r=e.featuresLength;if(!u(e._pickTexture)&&r>0){var i=e._pickIds;var a=R(e);var o=new Uint8Array(a);var s=e._content;for(var l=0;l<r;++l){var c=t.createPickId(s.getFeature(l));i.push(c);var d=c.color;var f=l*4;o[f]=n.floatToByte(d.red);o[f+1]=n.floatToByte(d.green);o[f+2]=n.floatToByte(d.blue);o[f+3]=n.floatToByte(d.alpha)}e._pickTexture=oe(e,t,o);s._tileset._statistics.batchTableMemorySizeInBytes+=e._pickTexture.sizeInBytes}}function ue(e){var t=e._textureDimensions;e._batchTexture.copyFrom({width:t.x,height:t.y,arrayBufferView:e._batchValues})}P.prototype.update=function(e,t){var r=t.context;this._defaultTexture=r.defaultTexture;if(t.passes.pick){se(this,r)}if(this._batchValuesDirty){this._batchValuesDirty=false;if(!u(this._batchTexture)){this._batchTexture=oe(this,r,this._batchValues);e._statistics.batchTableMemorySizeInBytes+=this._batchTexture.sizeInBytes}ue(this)}};P.prototype.isDestroyed=function(){return false};P.prototype.destroy=function(){this._batchTexture=this._batchTexture&&this._batchTexture.destroy();this._pickTexture=this._pickTexture&&this._pickTexture.destroy();var e=this._pickIds;var t=e.length;for(var r=0;r<t;++r){e[r].destroy()}return c(this)};return P});define("Scene/Cesium3DTileContentState",["../Core/freezeObject"],function(e){"use strict";var t={UNLOADED:0,LOADING:1,PROCESSING:2,READY:3,FAILED:4};return e(t)});define("Scene/Cesium3DTileFeature",["../Core/Color","../Core/defineProperties"],function(e,t){"use strict";function r(e,t,r){this._content=t;this._batchTable=t.batchTable;this._batchId=r;this._color=undefined;this.primitive=e}t(r.prototype,{show:{get:function(){return this._batchTable.getShow(this._batchId)},set:function(e){this._batchTable.setShow(this._batchId,e)}},color:{get:function(){if(!this._color){this._color=new e}return this._batchTable.getColor(this._batchId,this._color)},set:function(e){this._batchTable.setColor(this._batchId,e)}}});r.prototype.hasProperty=function(e){return this._batchTable.hasProperty(this._batchId,e)};r.prototype.getPropertyNames=function(){return this._batchTable.getPropertyNames(this._batchId)};r.prototype.getProperty=function(e){return this._batchTable.getProperty(this._batchId,e)};r.prototype.setProperty=function(e,t){this._batchTable.setProperty(this._batchId,e,t);this._content.featurePropertiesDirty=true};r.prototype.isExactClass=function(e){return this._batchTable.isExactClass(this._batchId,e)};r.prototype.isClass=function(e){return this._batchTable.isClass(this._batchId,e)};r.prototype.getExactClassName=function(){return this._batchTable.getExactClassName(this._batchId)};return r});define("Scene/Batched3DModel3DTileContent",["../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/deprecationWarning","../Core/destroyObject","../Core/DeveloperError","../Core/getAbsoluteUri","../Core/getBaseUri","../Core/getMagic","../Core/getStringFromTypedArray","../Core/loadArrayBuffer","../Core/Request","../Core/RequestScheduler","../Core/RequestType","../ThirdParty/when","./Cesium3DTileBatchTable","./Cesium3DTileContentState","./Cesium3DTileFeature","./getAttributeOrUniformBySemantic","./Model"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w){"use strict";function C(e,t,r){this._model=undefined;this._url=r;this._tileset=e;this._tile=t;this.state=_.UNLOADED;this.batchTable=undefined;this.featurePropertiesDirty=false;this._contentReadyToProcessPromise=m.defer();this._readyPromise=m.defer();this._featuresLength=0;this._features=undefined}C._deprecationWarning=n;i(C.prototype,{featuresLength:{get:function(){return this._featuresLength}},pointsLength:{get:function(){return 0}},vertexMemorySizeInBytes:{get:function(){if(r(this._model)){return this._model.vertexMemorySizeInBytes}return 0}},textureMemorySizeInBytes:{get:function(){if(r(this._model)){return this._model.textureMemorySizeInBytes}return 0}},batchTableMemorySizeInBytes:{get:function(){if(r(this.batchTable)){return this.batchTable.memorySizeInBytes}return 0}},innerContents:{get:function(){return undefined}},contentReadyToProcessPromise:{get:function(){return this._contentReadyToProcessPromise.promise}},readyPromise:{get:function(){return this._readyPromise.promise}}});function b(e){var t=e._tileset;var i=e._featuresLength;if(!r(e._features)&&i>0){var n=new Array(i);for(var a=0;a<i;++a){n[a]=new g(t,e,a)}e._features=n}}C.prototype.hasProperty=function(e,t){return this.batchTable.hasProperty(e,t)};C.prototype.getFeature=function(e){var t=this._featuresLength;if(!r(e)||e<0||e>=t){throw new o("batchId is required and between zero and featuresLength - 1 ("+(t-1)+").")}b(this);return this._features[e]};var S=Uint32Array.BYTES_PER_ELEMENT;C.prototype.request=function(){var e=this;var t=this._tile.distanceToCamera;var i=h.schedule(new f({url:this._url,server:this._tile.requestServer,requestFunction:d,type:p.TILES3D,distance:t}));if(!r(i)){return false}this.state=_.LOADING;i.then(function(t){if(e.isDestroyed()){return m.reject("tileset is destroyed")}e.initialize(t)}).otherwise(function(t){e.state=_.FAILED;e._readyPromise.reject(t)});return true};function E(e){var t=y(e,"_BATCHID");if(!r(t)){t=y(e,"BATCHID");if(r(t)){C._deprecationWarning("b3dm-legacy-batchid","The glTF in this b3dm uses the semantic `BATCHID`. Application-specific semantics should be prefixed with an underscore: `_BATCHID`.")}}return t}function T(e){return function(t){var i=e.batchTable;var n=e._model.gltf;var a=E(n);var o=i.getVertexShaderCallback(true,a);return r(o)?o(t):t}}function x(e){return function(t){var i=e.batchTable;var n=e._model.gltf;var a=E(n);var o=i.getPickVertexShaderCallback(a);return r(o)?o(t):t}}function A(e){return function(t){var i=e.batchTable;var n=e._model.gltf;var a=y(n,"_3DTILESDIFFUSE");var o=i.getFragmentShaderCallback(true,a);return r(o)?o(t):t}}C.prototype.initialize=function(e,r){var i=t(r,0);r=i;var a=new Uint8Array(e);var d=l(a,r);if(d!=="b3dm"){throw new o("Invalid Batched 3D Model.  Expected magic=b3dm.  Read magic="+d)}var f=new DataView(e);r+=S;var h=f.getUint32(r,true);if(h!==1){throw new o("Only Batched 3D Model version 1 is supported.  Version "+h+" is not.")}r+=S;var p=f.getUint32(r,true);r+=S;var m=f.getUint32(r,true);r+=S;var g=f.getUint32(r,true);r+=S;var y=f.getUint32(r,true);r+=S;if(y>1e7){r-=S;y=m;m=g;g=0;n("b3dm-legacy-header","This b3dm header is using the legacy format [batchLength] [batchTableByteLength]. The new format is [batchTableJsonByteLength] [batchTableBinaryByteLength] [batchLength] from https://github.com/AnalyticalGraphicsInc/3d-tiles/blob/master/TileFormats/Batched3DModel/README.md.")}this._featuresLength=y;var C;var b;if(m>0){var E=c(a,r,m);C=JSON.parse(E);r+=m;if(g>0){b=new Uint8Array(e,r,g);b=new Uint8Array(b);r+=g}}var P=new v(this,y,C,b);this.batchTable=P;var D=i+p-r;var M=new Uint8Array(e,r,D);var I=new w({gltf:M,cull:false,releaseGltfJson:true,basePath:s(u(this._url,true)),modelMatrix:this._tile.computedTransform,upAxis:this._tileset._gltfUpAxis,shadows:this._tileset.shadows,debugWireframe:this._tileset.debugWireframe,incrementallyLoadTextures:false,pickPrimitive:this._tileset,vertexShaderLoaded:T(this),fragmentShaderLoaded:A(this),uniformMapLoaded:P.getUniformMapCallback(),pickVertexShaderLoaded:x(this),pickFragmentShaderLoaded:P.getPickFragmentShaderCallback(),pickUniformMapLoaded:P.getPickUniformMapCallback(),addBatchIdToGeneratedShaders:y>0});this._model=I;this.state=_.PROCESSING;this._contentReadyToProcessPromise.resolve(this);var O=this;I.readyPromise.then(function(e){O.state=_.READY;O._readyPromise.resolve(O)}).otherwise(function(e){O.state=_.FAILED;O._readyPromise.reject(e)})};C.prototype.applyDebugSettings=function(t,r){r=t?r:e.WHITE;this.batchTable.setAllColor(r)};C.prototype.applyStyleWithShader=function(e,t){return false};C.prototype.update=function(e,t){var r=t.addCommand;if(t.passes.render){t.addCommand=this.batchTable.getAddCommand()}this.batchTable.update(e,t);this._model.modelMatrix=this._tile.computedTransform;this._model.shadows=this._tileset.shadows;this._model.debugWireframe=this._tileset.debugWireframe;this._model.update(t);t.addCommand=r};C.prototype.isDestroyed=function(){return false};C.prototype.destroy=function(){this._model=this._model&&this._model.destroy();this.batchTable=this.batchTable&&this.batchTable.destroy();return a(this)};return C});define("Scene/BingMapsStyle",["../Core/freezeObject"],function(e){"use strict";var t={AERIAL:"Aerial",AERIAL_WITH_LABELS:"AerialWithLabels",ROAD:"Road",ORDNANCE_SURVEY:"OrdnanceSurvey",COLLINS_BART:"CollinsBart"};return e(t)});define("Scene/BingMapsImageryProvider",["../Core/BingMapsApi","../Core/Cartesian2","../Core/Credit","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/loadJsonp","../Core/Math","../Core/Rectangle","../Core/RequestScheduler","../Core/RuntimeError","../Core/TileProviderError","../Core/WebMercatorTilingScheme","../ThirdParty/when","./BingMapsStyle","./DiscardMissingTileImagePolicy","./ImageryProvider"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g){"use strict";function y(a){a=i(a,{});if(!n(a.url)){throw new o("options.url is required.")}this._key=e.getKey(a.key);this._keyErrorCredit=e.getErrorCredit(a.key);this._url=a.url;this._tileProtocol=a.tileProtocol;this._mapStyle=i(a.mapStyle,v.AERIAL);this._culture=i(a.culture,"");this._tileDiscardPolicy=a.tileDiscardPolicy;this._proxy=a.proxy;this._credit=new r("Bing Imagery",y._logoData,"http://www.bing.com");this.defaultGamma=1;this._tilingScheme=new p({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:2,ellipsoid:a.ellipsoid});this._tileWidth=undefined;this._tileHeight=undefined;this._maximumLevel=undefined;this._imageUrlTemplate=undefined;this._imageUrlSubdomains=undefined;this._errorEvent=new s;this._ready=false;this._readyPromise=m.defer();var g=this._url+"/REST/v1/Imagery/Metadata/"+this._mapStyle+"?incl=ImageryProviders&key="+this._key;var w=this;var b;function S(e){var i=e.resourceSets[0].resources[0];w._tileWidth=i.imageWidth;w._tileHeight=i.imageHeight;w._maximumLevel=i.zoomMax-1;w._imageUrlSubdomains=i.imageUrlSubdomains;w._imageUrlTemplate=i.imageUrl.replace("{culture}",w._culture);var a=w._tileProtocol;if(!n(a)){var o=document.location.protocol;a=/^http/.test(o)?o:"http:"}w._imageUrlTemplate=w._imageUrlTemplate.replace(/^http:/,a);if(!n(w._tileDiscardPolicy)){w._tileDiscardPolicy=new _({missingImageUrl:C(w,0,0,w._maximumLevel),pixelsToCheck:[new t(0,0),new t(120,140),new t(130,160),new t(200,50),new t(200,200)],disableCheckIfAllPixelsAreTransparent:true})}var s=w._attributionList=i.imageryProviders;if(!s){s=w._attributionList=[]}for(var u=0,d=s.length;u<d;++u){var f=s[u];f.credit=new r(f.attribution);var p=f.coverageAreas;for(var m=0,v=f.coverageAreas.length;m<v;++m){var g=p[m];var y=g.bbox;g.bbox=new c(l.toRadians(y[1]),l.toRadians(y[0]),l.toRadians(y[3]),l.toRadians(y[2]))}}w._ready=true;w._readyPromise.resolve(true);h.handleSuccess(b)}function E(e){var t="An error occurred while accessing "+g+".";b=h.handleError(b,w,w._errorEvent,t,undefined,undefined,undefined,T);w._readyPromise.reject(new f(t))}function T(){var e=d.request(g,u,{callbackParameterName:"jsonp",proxy:w._proxy});m(e,S,E)}T()}a(y.prototype,{url:{get:function(){return this._url}},proxy:{get:function(){return this._proxy}},key:{get:function(){return this._key}},mapStyle:{get:function(){return this._mapStyle}},culture:{get:function(){return this._culture}},tileWidth:{get:function(){if(!this._ready){throw new o("tileWidth must not be called before the imagery provider is ready.")}return this._tileWidth}},tileHeight:{get:function(){if(!this._ready){throw new o("tileHeight must not be called before the imagery provider is ready.")}return this._tileHeight}},maximumLevel:{get:function(){if(!this._ready){throw new o("maximumLevel must not be called before the imagery provider is ready.")}return this._maximumLevel}},minimumLevel:{get:function(){if(!this._ready){throw new o("minimumLevel must not be called before the imagery provider is ready.")}return 0}},tilingScheme:{get:function(){if(!this._ready){throw new o("tilingScheme must not be called before the imagery provider is ready.")}return this._tilingScheme}},rectangle:{get:function(){if(!this._ready){throw new o("rectangle must not be called before the imagery provider is ready.")}return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){if(!this._ready){throw new o("tileDiscardPolicy must not be called before the imagery provider is ready.")}return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return false}}});var w=new c;y.prototype.getTileCredits=function(e,t,r){if(!this._ready){throw new o("getTileCredits must not be called before the imagery provider is ready.")}var i=this._tilingScheme.tileXYToRectangle(e,t,r,w);var a=S(this._attributionList,r,i);if(n(this._keyErrorCredit)){a.push(this._keyErrorCredit)}return a};y.prototype.requestImage=function(e,t,r,i){if(!this._ready){throw new o("requestImage must not be called before the imagery provider is ready.")}var n=C(this,e,t,r);return g.loadImage(this,n,i)};y.prototype.pickFeatures=function(e,t,r,i,n){return undefined};y._logoData="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD0AAAAaCAYAAAAEy1RnAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAB3RJTUUH3gIDEgcPTMnXOQAAClZJREFUWMPdWGtsFNcV/u689uH1+sXaONhlWQzBENtxiUFBpBSLd60IpXHSNig4URtSYQUkRJNSi0igViVVVBJBaBsiAgKRQJSG8AgEHCCWU4iBCprY2MSgXfOI16y9D3s9Mzsztz9yB12WNU2i9Ecy0tHOzN4793zn3POdcy7BnRfJ8I7iB3SRDPeEExswLz8Y0DZIAYDIRGAgLQAm+7Xle31J3L3Anp1MZPY+BUBjorN332vgYhpgV1FRUd6TTz45ubq6OtDV1SXpuu5g//Oept9wNwlMyAi8IXDjyF245TsDTdivDMATCATGNDU1/WbhwoWPTZs2bWx1dXWhx+Oxrl+/PqTrus5t9W8KWEzjinTAYhro/xuBStwiIgBnJBLxKIoy1u/3V/r9/krDMMz3339/Z3t7e38ikUgCMDLEt8W+Q0cAI3McYTDDmZxh7DESG5Ni43jg9Gsa+X+OsxWxPSJTSj3JZFK5ZRVJErOzs8e6XC4fgGwALhbzDgAKU1hK28KEA6PMmTMn56233qpevnz5PQDcbJ7EzVUAuMrLy3MBeABkcWOEDELSyFe4y7iMoHkriZZlKYZh8ASHZDKpJJPJHAC5APIA5APIAeBlCjo5TwlpXnbOmTPHP3fu3KZVq1atZKBcDJQ9x7V48WJfc3Pzhp6enj+tXLnyR8w4MjdG4gyVDk7KICMClzKlLUrpbQMNw5AkScppbGz8cWdn57WjR4/2caw+DEBlYjO8wX1foZQWuN3uKZIklQD4G+fhlG0Yl8uVm5WVVW6app6dne0D0G8vnxbjJntHubCUOK/badZICyWanrJuAaeUknTQpmlKkUhEWbx48U8LCwtHhUKha+fPn+85fPhwV0tLyzUACSZx9jvMFhIByNFoVDEMw/qKB5HPvJfkUqBr9+7deklJyZ/j8bi5ffv2OAslieMLsG+m2DybT2QuzEQOsF5SUqJfvXo1yc2l6Xn6rgSRSCSEc+fOhVeuXLmwoqJixvTp0wcWLFgQ7unpudHR0dF97ty5z/fu3XseQJh5adjeerquy5ZlCalUivh8Pt8HH3ywzOPxyD09PZ81NjZ+2NnZaQEQx40b54vFYqaqquEVK1b4a2tr/WvWrDn18ssv144fP36SqqoD69ev371nz57rDLwAwHHkyJGfjRs3rtowDOv06dOnu7q6rs6bN2/s7Nmz9zIjDKenWoFZKg/AlMLCwl82Nzf/m3LX22+/fXb06NF/ALC8u7u7m6ZdkUhksL29/UpLS0vzunXrVgAoBzAaQBGAiY2NjUui0ei1RCLRFwwG/9PX19cVi8WCqqoOdHd3HysrK6sDMCccDl8IBoOtiqIsOnbs2D+i0eiV3t7ez8Ph8GeRSKRT07TB/v7+i1OnTp0HYBqABzs7O/+paVo0Fot1RyKRi/F4/Gp/f39XIpHoZnoUMn6wU+ZtRDaymwmxZFk2AWjvvvvuJ/F4PMn/n5+fn1VeXu6fOXNmbU1NzUOM4Bz8QqIoyg6HwxuLxfq3bdu2a+vWrW/09/dfKy0tffDVV199BEC20+n0ud3uQgBup9Pp83g8JYqieE+ePPnxxo0bt33xxRen8/Ly7n3hhRcWASh47bXX5pWVldWFw+GuXbt27XjzzTd3BoPBDq/XG1AUZRRHmAKPVfqaoKkgCCkA+oYNG84Eg0FHTU1N5ezZs8eWlJQ4CSF8/LvZYhJPQoQQpFKpwcrKyo1su9HBwUF99erVv588eXINgOOmacIwDEopdaZSKUIpxYkTJz6sr68/BMBav379RcMwZk2aNOl+AP+qq6t7xDTNVEVFxR+j0WgSAJk4ceKlTz/9tNzpdHpZvIvpjVW6pykhhBJCbkvwgiAQQogEQL558ybdtGlTsLm5OWJZdxZmlmWll5OUEEJN0zSGhob6GcOrALSzZ8/2apqWcLlc2axGACNRkRAimqaph0Kh68xIwwB0y7IMSZKcABz5+fkl8Xj8y2g0apOb5na7rYGBgS/JV54Q0qpAAoBKaS0jBWClg1ZVFeFw2AlgVF1dXeDpp5+eWVFRUVpcXOzgvQwAbrcbDJhdudlGpKZpGtx6JCcnRxIEQbQsS2PjbjM+AMvlchnMSBaXkr7ymCCIhmEYfMoVRVESBEHI0CaTTNubssUsQRBuubCtra33pZdeCk6YMCGwZs2aipqaGn9paWmuJEl3JP0bN258eeTIkRMABrm0YomiaImiKGVlZeWxLecAgBkzZvgdDkfWjRs3ggA0bpfpoiiahBCqKEqKAy2yULMA6MlkMp6Xl3cP1x2SWCwmFhQU+CmlFhfHNFOevpX4LcvSJUkyAeDQoUOh119//fpTTz01Zf78+UWBQCBHUZQ7yE/TNGPfvn0n33vvvSP79+//BECMeZsCMGRZNgRBgNPpHHXx4sVVDQ0Nf1+wYMGYJ554YikAevDgwUMA4oIgQJZlSggZdDqdBiGEZGdn6ww0tQlJURTT4/EMHz9+/MCjjz7622AwuHbZsmVbiouLvWvXrm1wOp3ZqVRqaKQTIInf1gAMl8ulU0q1CxcuBGOxmL5u3bryQCDgycrKEjORXGtra8eOHTsOHz169OyVK1cuA+hlRYrGlNRkWR7UNO2mYRiaz+cb3dLS8gYhhOi6Hj116tSOVatWHQNALcsaME0zLghClBDSZ9+zQsZ2SoJS2udwOKLPPffcvsrKyrJAIPDQ/v37txiGofX19V3r7e29UlBQMHqEVpjwnrYA6PF4PK6q6s2qqqqpZWVlitvtljOB7enpiWzbtu3wgQMHTre1tV0E0MeKkkGuIhMAqHv37u30er3Px+NxlyiKygMPPOAnhFiXLl0Kbd68uYPNsXbu3Lk6mUwaqqr2btmyZUdtbe3hd955pwvAEFNcO3jw4K/b2tqiqqpGIpGI4/HHH/9rQ0PDCa/XOyoSidDLly8PNTU1PcZ4QuNK1ju6NYHFRAGASXPnzv1Fa2vrxzTDpapqateuXR/Nnz+/SVGUhwFMBzCBFSLZLF75DsrJGpXRAH4EIABgPIBxAEoBFAPwARjFif1sNzZ25+VlOhaxufcCqAFQC+BhAPVLliz5XSqVUkOhUAuAKWnFyR3dlsw+fg+A+8eMGfPzTZs2bY9GozEb8JkzZ9qXLl36l+Li4l8B+AmAyQDGsGrOzfXNPGPawG2l85jksmcPm+vihH+2W1iF3bvZPN+sWbPuGx4eDrW3t+85fvz41o6OjmZN04Y0TYvV19cvYIbN5QqUjG2mwj5YAqDK4XDMe+aZZ55vbW09+sorr2yuqqpqYFatAuBn3uB7XzJCY297XeaUd2RoGzOJmHb6IjFj5D777LP3DQwMfDw8PBxSVbUvkUj0hEKhj1588cXH2O7zMSPdplumoxveMx5Zlj3jx4/39vb26gMDA4MsvgYZo+p8Pr7LqQX5Ds/U7d0jFxUVZS1atKg4Nzc317Isp67rZldXV6y5ufkmI78hFtcmrx8ZweMit6XsUs4+6kmlgbW+peLf9gyMZNCR374G0y/FxEzX8b/8+bkXEBxKFwAAAABJRU5ErkJggg==";y.tileXYToQuadKey=function(e,t,r){var i="";for(var n=r;n>=0;--n){var a=1<<n;var o=0;if((e&a)!==0){o|=1}if((t&a)!==0){o|=2}i+=o}return i};y.quadKeyToTileXY=function(e){var t=0;var r=0;var i=e.length-1;for(var n=i;n>=0;--n){var a=1<<n;var o=+e[i-n];if((o&1)!==0){t|=a}if((o&2)!==0){r|=a}}return{x:t,y:r,level:i}};function C(e,t,r,i){var a=e._imageUrlTemplate;var o=y.tileXYToQuadKey(t,r,i);a=a.replace("{quadkey}",o);var s=e._imageUrlSubdomains;var u=(t+r+i)%s.length;a=a.replace("{subdomain}",s[u]);var l=e._proxy;if(n(l)){a=l.getURL(a)}return a}var b=new c;function S(e,t,r){++t;var i=[];for(var a=0,o=e.length;a<o;++a){var s=e[a];var u=s.coverageAreas;var l=false;for(var d=0,f=s.coverageAreas.length;!l&&d<f;++d){var h=u[d];if(t>=h.zoomMin&&t<=h.zoomMax){var p=c.intersection(r,h.bbox,b);if(n(p)){l=true}}}if(l){i.push(s.credit)}}return i}return y});define("Scene/PerspectiveOffCenterFrustum",["../Core/Cartesian3","../Core/Cartesian4","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Matrix4","./CullingVolume"],function(e,t,r,i,n,a,o){"use strict";function s(){this.left=undefined;this._left=undefined;this.right=undefined;this._right=undefined;this.top=undefined;this._top=undefined;this.bottom=undefined;this._bottom=undefined;this.near=1;this._near=this.near;this.far=5e8;this._far=this.far;this._cullingVolume=new o;this._perspectiveMatrix=new a;this._infinitePerspective=new a}function u(e){if(!r(e.right)||!r(e.left)||!r(e.top)||!r(e.bottom)||!r(e.near)||!r(e.far)){throw new n("right, left, top, bottom, near, or far parameters are not set.")}var t=e.top;var i=e.bottom;var o=e.right;var s=e.left;var u=e.near;var l=e.far;if(t!==e._top||i!==e._bottom||s!==e._left||o!==e._right||u!==e._near||l!==e._far){if(e.near<=0||e.near>e.far){throw new n("near must be greater than zero and less than far.")}e._left=s;e._right=o;e._top=t;e._bottom=i;e._near=u;e._far=l;e._perspectiveMatrix=a.computePerspectiveOffCenter(s,o,i,t,u,l,e._perspectiveMatrix);e._infinitePerspective=a.computeInfinitePerspectiveOffCenter(s,o,i,t,u,e._infinitePerspective)}}i(s.prototype,{projectionMatrix:{get:function(){u(this);return this._perspectiveMatrix}},infiniteProjectionMatrix:{get:function(){u(this);return this._infinitePerspective}}});var l=new e;var c=new e;var d=new e;var f=new e;s.prototype.computeCullingVolume=function(i,a,o){if(!r(i)){throw new n("position is required.")}if(!r(a)){throw new n("direction is required.")}if(!r(o)){throw new n("up is required.")}var s=this._cullingVolume.planes;var u=this.top;var h=this.bottom;var p=this.right;var m=this.left;var v=this.near;var _=this.far;var g=e.cross(a,o,l);var y=c;e.multiplyByScalar(a,v,y);e.add(i,y,y);var w=d;e.multiplyByScalar(a,_,w);e.add(i,w,w);var C=f;e.multiplyByScalar(g,m,C);e.add(y,C,C);e.subtract(C,i,C);e.normalize(C,C);e.cross(C,o,C);var b=s[0];if(!r(b)){b=s[0]=new t}b.x=C.x;b.y=C.y;b.z=C.z;b.w=-e.dot(C,i);e.multiplyByScalar(g,p,C);e.add(y,C,C);e.subtract(C,i,C);e.normalize(C,C);e.cross(o,C,C);b=s[1];if(!r(b)){b=s[1]=new t}b.x=C.x;b.y=C.y;b.z=C.z;b.w=-e.dot(C,i);e.multiplyByScalar(o,h,C);e.add(y,C,C);e.subtract(C,i,C);e.normalize(C,C);e.cross(g,C,C);b=s[2];if(!r(b)){b=s[2]=new t}b.x=C.x;b.y=C.y;b.z=C.z;b.w=-e.dot(C,i);e.multiplyByScalar(o,u,C);e.add(y,C,C);e.subtract(C,i,C);e.normalize(C,C);e.cross(C,g,C);b=s[3];if(!r(b)){b=s[3]=new t}b.x=C.x;b.y=C.y;b.z=C.z;b.w=-e.dot(C,i);b=s[4];if(!r(b)){b=s[4]=new t}b.x=a.x;b.y=a.y;b.z=a.z;b.w=-e.dot(a,y);e.negate(a,C);b=s[5];if(!r(b)){b=s[5]=new t}b.x=C.x;b.y=C.y;b.z=C.z;b.w=-e.dot(C,w);return this._cullingVolume};s.prototype.getPixelDimensions=function(e,t,i,a){u(this);if(!r(e)||!r(t)){throw new n("Both drawingBufferWidth and drawingBufferHeight are required.")}if(e<=0){throw new n("drawingBufferWidth must be greater than zero.")}if(t<=0){throw new n("drawingBufferHeight must be greater than zero.")}if(!r(i)){throw new n("distance is required.")}if(!r(a)){throw new n("A result object is required.")}var o=1/this.near;var s=this.top*o;var l=2*i*s/t;s=this.right*o;var c=2*i*s/e;a.x=c;a.y=l;return a};s.prototype.clone=function(e){if(!r(e)){e=new s}e.right=this.right;e.left=this.left;e.top=this.top;e.bottom=this.bottom;e.near=this.near;e.far=this.far;e._left=undefined;e._right=undefined;e._top=undefined;e._bottom=undefined;e._near=undefined;e._far=undefined;return e};s.prototype.equals=function(e){return r(e)&&this.right===e.right&&this.left===e.left&&this.top===e.top&&this.bottom===e.bottom&&this.near===e.near&&this.far===e.far};return s});define("Scene/PerspectiveFrustum",["../Core/defined","../Core/defineProperties","../Core/DeveloperError","./PerspectiveOffCenterFrustum"],function(e,t,r,i){"use strict";function n(){this._offCenterFrustum=new i;this.fov=undefined;this._fov=undefined;this._fovy=undefined;this._sseDenominator=undefined;this.aspectRatio=undefined;this._aspectRatio=undefined;this.near=1;this._near=this.near;this.far=5e8;this._far=this.far;this.xOffset=0;this._xOffset=this.xOffset;this.yOffset=0;this._yOffset=this.yOffset}function a(t){if(!e(t.fov)||!e(t.aspectRatio)||!e(t.near)||!e(t.far)){throw new r("fov, aspectRatio, near, or far parameters are not set.")}var i=t._offCenterFrustum;if(t.fov!==t._fov||t.aspectRatio!==t._aspectRatio||t.near!==t._near||t.far!==t._far||t.xOffset!==t._xOffset||t.yOffset!==t._yOffset){if(t.fov<0||t.fov>=Math.PI){throw new r("fov must be in the range [0, PI).")}if(t.aspectRatio<0){throw new r("aspectRatio must be positive.")}if(t.near<0||t.near>t.far){throw new r("near must be greater than zero and less than far.")}t._aspectRatio=t.aspectRatio;t._fov=t.fov;t._fovy=t.aspectRatio<=1?t.fov:Math.atan(Math.tan(t.fov*.5)/t.aspectRatio)*2;t._near=t.near;t._far=t.far
;t._sseDenominator=2*Math.tan(.5*t._fovy);t._xOffset=t.xOffset;t._yOffset=t.yOffset;i.top=t.near*Math.tan(.5*t._fovy);i.bottom=-i.top;i.right=t.aspectRatio*i.top;i.left=-i.right;i.near=t.near;i.far=t.far;i.right+=t.xOffset;i.left+=t.xOffset;i.top+=t.yOffset;i.bottom+=t.yOffset}}t(n.prototype,{projectionMatrix:{get:function(){a(this);return this._offCenterFrustum.projectionMatrix}},infiniteProjectionMatrix:{get:function(){a(this);return this._offCenterFrustum.infiniteProjectionMatrix}},fovy:{get:function(){a(this);return this._fovy}},sseDenominator:{get:function(){a(this);return this._sseDenominator}}});n.prototype.computeCullingVolume=function(e,t,r){a(this);return this._offCenterFrustum.computeCullingVolume(e,t,r)};n.prototype.getPixelDimensions=function(e,t,r,i){a(this);return this._offCenterFrustum.getPixelDimensions(e,t,r,i)};n.prototype.clone=function(t){if(!e(t)){t=new n}t.aspectRatio=this.aspectRatio;t.fov=this.fov;t.near=this.near;t.far=this.far;t._aspectRatio=undefined;t._fov=undefined;t._near=undefined;t._far=undefined;this._offCenterFrustum.clone(t._offCenterFrustum);return t};n.prototype.equals=function(t){if(!e(t)){return false}a(this);a(t);return this.fov===t.fov&&this.aspectRatio===t.aspectRatio&&this.near===t.near&&this.far===t.far&&this._offCenterFrustum.equals(t._offCenterFrustum)};return n});define("Scene/CameraFlightPath",["../Core/Cartesian2","../Core/Cartesian3","../Core/Cartographic","../Core/defaultValue","../Core/defined","../Core/DeveloperError","../Core/EasingFunction","../Core/Math","./PerspectiveFrustum","./PerspectiveOffCenterFrustum","./SceneMode"],function(e,t,r,i,n,a,o,s,u,l,c){"use strict";var d={};function f(e,t,r){var i;var n;var a;if(e instanceof u){var o=Math.tan(.5*e.fovy);i=e.near;n=e.near*o;a=e.aspectRatio*n;return Math.max(t*i/a,r*i/n)}else if(e instanceof l){i=e.near;n=e.top;a=e.right;return Math.max(t*i/a,r*i/n)}return Math.max(t,r)}var h=new t;var p=new t;function m(e,t,r,i){if(n(i)&&r(.5)>i){var a=r(0);var o=r(1);var u=r(.5);var l=u-a;var c=u-o;return function(i){var n=r(i);if(i<=.5){var u=(n-a)/l;return s.lerp(e,-s.PI_OVER_TWO,u)}var d=(n-o)/c;return s.lerp(-s.PI_OVER_TWO,t,1-d)}}return function(r){return s.lerp(e,t,r)}}function v(e,r,i,a,o){var u=o;var l=Math.max(i,a);if(!n(u)){var c=e.position;var d=r;var m=e.up;var v=e.right;var _=e.frustum;var g=t.subtract(c,d,h);var y=t.magnitude(t.multiplyByScalar(m,t.dot(g,m),p));var w=t.magnitude(t.multiplyByScalar(v,t.dot(g,v),p));u=Math.min(f(_,y,w)*.2,1e9)}if(l<u){var C=8;var b=1e6;var S=-Math.pow((u-i)*b,1/C);var E=Math.pow((u-a)*b,1/C);return function(e){var t=e*(E-S)+S;return-Math.pow(t,C)/b+u}}return function(e){return s.lerp(i,a,e)}}function _(e,t){if(s.equalsEpsilon(e,s.TWO_PI,s.EPSILON11)){e=0}if(t>e+Math.PI){e+=s.TWO_PI}else if(t<e-Math.PI){e-=s.TWO_PI}return e}var g=new t;function y(r,i,n,a,o,u,l){var c=r.camera;var d=t.clone(c.position,g);var f=c.pitch;var h=_(c.heading,a);var p=_(c.roll,u);var m=v(c,n,d.z,n.z,l);function y(t){var r=t.time/i;c.setView({orientation:{heading:s.lerp(h,a,r),pitch:s.lerp(f,o,r),roll:s.lerp(p,u,r)}});e.lerp(d,n,r,c.position);c.position.z=m(r)}return y}function w(e,t){if(e.longitude<t.longitude){e.longitude+=s.TWO_PI}else{t.longitude+=s.TWO_PI}}function C(e,t){var r=e.longitude-t.longitude;if(r<-s.PI){e.longitude+=s.TWO_PI}else if(r>s.PI){t.longitude+=s.TWO_PI}}var b=new r;var S=new r;function E(e,i,a,o,u,l,c,d,f,h){var p=e.camera;var g=e.mapProjection;var y=g.ellipsoid;var E=r.clone(p.positionCartographic,b);var T=p.pitch;var x=_(p.heading,o);var A=_(p.roll,l);var P=y.cartesianToCartographic(a,S);E.longitude=s.zeroToTwoPi(E.longitude);P.longitude=s.zeroToTwoPi(P.longitude);var D=false;if(n(d)){var M=s.zeroToTwoPi(d);var I=Math.min(E.longitude,P.longitude);var O=Math.max(E.longitude,P.longitude);var R=M>=I&&M<=O;if(n(f)){var N=Math.abs(E.longitude-P.longitude);var L=s.TWO_PI-N;var B=R?N:L;var F=R?L:N;if(B<F*f&&!R){D=true}}else if(!R){D=true}}if(D){w(E,P)}else{C(E,P)}var k=v(p,a,E.height,P.height,c);var V=m(T,u,k,h);function z(){var e=E.longitude;var r=P.longitude;var n=E.latitude;var a=P.latitude;return function u(c){var d=c.time/i;var f=t.fromRadians(s.lerp(e,r,d),s.lerp(n,a,d),k(d));p.setView({destination:f,orientation:{heading:s.lerp(x,o,d),pitch:V(d),roll:s.lerp(A,l,d)}})}}return z()}function T(r,i,n,a,o,u,l){var c=r.camera;var d=t.clone(c.position,g);var f=_(c.heading,a);var h=c.frustum.right-c.frustum.left;var p=v(c,n,h,n.z,l);function m(t){var r=t.time/i;c.setView({orientation:{heading:s.lerp(f,a,r)}});e.lerp(d,n,r,c.position);var o=p(r);var u=c.frustum;var l=u.top/u.right;var h=(o-(u.right-u.left))*.5;u.right+=h;u.left-=h;u.top=l*u.right;u.bottom=-u.top}return m}var x=new r;var A=new t;function P(e,t){return{startObject:{},stopObject:{},duration:0,complete:e,cancel:t}}function D(e,t){function r(){if(typeof t==="function"){t()}e.enableInputs=true}return r}d.createTween=function(r,u){u=i(u,i.EMPTY_OBJECT);var l=u.destination;if(!n(r)){throw new a("scene is required.")}if(!n(l)){throw new a("destination is required.")}var d=r.mode;if(d===c.MORPHING){return P()}var f=i(u.convert,true);var h=r.mapProjection;var p=h.ellipsoid;var m=u.maximumHeight;var v=u.flyOverLongitude;var _=u.flyOverLongitudeWeight;var g=u.pitchAdjustHeight;var w=u.easingFunction;if(f&&d!==c.SCENE3D){p.cartesianToCartographic(l,x);l=h.project(x,A)}var C=r.camera;var b=u.endTransform;if(n(b)){C._setTransform(b)}var S=u.duration;if(!n(S)){S=Math.ceil(t.distance(C.position,l)/1e6)+2;S=Math.min(S,3)}var M=i(u.heading,0);var I=i(u.pitch,-s.PI_OVER_TWO);var O=i(u.roll,0);var R=r.screenSpaceCameraController;R.enableInputs=false;var N=D(R,u.complete);var L=D(R,u.cancel);var B=C.frustum;var F=r.mode===c.SCENE2D;F=F&&e.equalsEpsilon(C.position,l,s.EPSILON6);F=F&&s.equalsEpsilon(Math.max(B.right-B.left,B.top-B.bottom),l.z,s.EPSILON6);F=F||r.mode!==c.SCENE2D&&t.equalsEpsilon(l,C.position,s.EPSILON10);F=F&&s.equalsEpsilon(s.negativePiToPi(M),s.negativePiToPi(C.heading),s.EPSILON10)&&s.equalsEpsilon(s.negativePiToPi(I),s.negativePiToPi(C.pitch),s.EPSILON10)&&s.equalsEpsilon(s.negativePiToPi(O),s.negativePiToPi(C.roll),s.EPSILON10);if(F){return P(N,L)}var k=new Array(4);k[c.SCENE2D]=T;k[c.SCENE3D]=E;k[c.COLUMBUS_VIEW]=y;if(S<=0){var V=function(){var e=k[d](r,1,l,M,I,O,m,v,_,g);e({time:1});if(typeof N==="function"){N()}};return P(V,L)}var z=k[d](r,S,l,M,I,O,m,v,_,g);if(!n(w)){var U=C.positionCartographic.height;var q=d===c.SCENE3D?p.cartesianToCartographic(l).height:l.z;if(U>q&&U>11500){w=o.CUBIC_OUT}else{w=o.QUINTIC_IN_OUT}}return{duration:S,easingFunction:w,startObject:{time:0},stopObject:{time:S},update:z,complete:N,cancel:L}};return d});define("Scene/MapMode2D",["../Core/freezeObject"],function(e){"use strict";var t={ROTATE:0,INFINITE_SCROLL:1};return e(t)});define("Scene/Camera",["../Core/BoundingSphere","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Cartographic","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/EasingFunction","../Core/Ellipsoid","../Core/EllipsoidGeodesic","../Core/Event","../Core/HeadingPitchRange","../Core/HeadingPitchRoll","../Core/Intersect","../Core/IntersectionTests","../Core/Math","../Core/Matrix3","../Core/Matrix4","../Core/Quaternion","../Core/Ray","../Core/Rectangle","../Core/Transforms","./CameraFlightPath","./MapMode2D","./OrthographicFrustum","./OrthographicOffCenterFrustum","./PerspectiveFrustum","./SceneMode"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w,C,b,S,E,T,x,A,P,D){"use strict";function M(e){if(!o(e)){throw new u("scene is required.")}this._scene=e;this._transform=y.clone(y.IDENTITY);this._invTransform=y.clone(y.IDENTITY);this._actualTransform=y.clone(y.IDENTITY);this._actualInvTransform=y.clone(y.IDENTITY);this._transformChanged=false;this.position=new r;this._position=new r;this._positionWC=new r;this._positionCartographic=new n;this.direction=new r;this._direction=new r;this._directionWC=new r;this.up=new r;this._up=new r;this._upWC=new r;this.right=new r;this._right=new r;this._rightWC=new r;this.frustum=new P;this.frustum.aspectRatio=e.drawingBufferWidth/e.drawingBufferHeight;this.frustum.fov=_.toRadians(60);this.defaultMoveAmount=1e5;this.defaultLookAmount=Math.PI/60;this.defaultRotateAmount=Math.PI/3600;this.defaultZoomAmount=1e5;this.constrainedAxis=undefined;this.maximumZoomFactor=1.5;this._moveStart=new f;this._moveEnd=new f;this._changed=new f;this._changedPosition=undefined;this._changedDirection=undefined;this._changedFrustum=undefined;this.percentageChanged=.5;this._viewMatrix=new y;this._invViewMatrix=new y;I(this);this._mode=D.SCENE3D;this._modeChanged=true;var t=e.mapProjection;this._projection=t;this._maxCoord=t.project(new n(Math.PI,_.PI_OVER_TWO));this._max2Dfrustum=undefined;this._suspendTerrainAdjustment=false;$e(this,M.DEFAULT_VIEW_RECTANGLE,this.position,true);var i=r.magnitude(this.position);i+=i*M.DEFAULT_VIEW_FACTOR;r.normalize(this.position,this.position);r.multiplyByScalar(this.position,i,this.position)}M.TRANSFORM_2D=new y(0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,1);M.TRANSFORM_2D_INVERSE=y.inverseTransformation(M.TRANSFORM_2D,new y);M.DEFAULT_VIEW_RECTANGLE=b.fromDegrees(-95,-20,-70,90);M.DEFAULT_VIEW_FACTOR=.5;M.DEFAULT_OFFSET=new h(0,-_.PI_OVER_FOUR,0);function I(e){y.computeView(e._position,e._direction,e._up,e._right,e._viewMatrix);y.multiply(e._viewMatrix,e._actualInvTransform,e._viewMatrix);y.inverseTransformation(e._viewMatrix,e._invViewMatrix)}M.prototype._updateCameraChanged=function(){var e=this;if(e._changed.numberOfListeners===0){return}var t=e.percentageChanged;if(e._mode===D.SCENE2D){if(!o(e._changedFrustum)){e._changedPosition=r.clone(e.position,e._changedPosition);e._changedFrustum=e.frustum.clone();return}var i=e.position;var n=e._changedPosition;var a=e.frustum;var s=e._changedFrustum;var u=i.x+a.left;var l=i.x+a.right;var c=n.x+s.left;var d=n.x+s.right;var f=i.y+a.bottom;var h=i.y+a.top;var p=n.y+s.bottom;var m=n.y+s.top;var v=Math.max(u,c);var g=Math.min(l,d);var y=Math.max(f,p);var w=Math.min(h,m);var C;if(v>=g||y>=h){C=1}else{var b=s;if(u<c&&l>d&&f<p&&h>m){b=a}C=1-(g-v)*(w-y)/((b.right-b.left)*(b.top-b.bottom))}if(C>t){e._changed.raiseEvent(C);e._changedPosition=r.clone(e.position,e._changedPosition);e._changedFrustum=e.frustum.clone(e._changedFrustum)}return}if(!o(e._changedDirection)){e._changedPosition=r.clone(e.positionWC,e._changedPosition);e._changedDirection=r.clone(e.directionWC,e._changedDirection);return}var S=_.acosClamped(r.dot(e.directionWC,e._changedDirection));var E;if(o(e.frustum.fovy)){E=S/(e.frustum.fovy*.5)}else{E=S}var T=r.distance(e.positionWC,e._changedPosition);var x=T/e.positionCartographic.height;if(E>t||x>t){e._changed.raiseEvent(Math.max(E,x));e._changedPosition=r.clone(e.positionWC,e._changedPosition);e._changedDirection=r.clone(e.directionWC,e._changedDirection)}};var O=new y;var R=new n;M.prototype._adjustHeightForTerrain=function(){var e=this._scene;var t=e.screenSpaceCameraController;var i=t.enableCollisionDetection;var n=t.minimumCollisionTerrainHeight;var a=t.minimumZoomDistance;if(this._suspendTerrainAdjustment||!i){return}var s=this._mode;var u=e.globe;if(!o(u)||s===D.SCENE2D||s===D.MORPHING){return}var l=u.ellipsoid;var c=e.mapProjection;var d;var f;if(!y.equals(this.transform,y.IDENTITY)){d=y.clone(this.transform,O);f=r.magnitude(this.position);this._setTransform(y.IDENTITY)}var h=R;if(s===D.SCENE3D){l.cartesianToCartographic(this.position,h)}else{c.unproject(this.position,h)}var p=false;if(h.height<n){var m=u.getHeight(h);if(o(m)){m+=a;if(h.height<m){h.height=m;if(s===D.SCENE3D){l.cartographicToCartesian(h,this.position)}else{c.project(h,this.position)}p=true}}}if(o(d)){this._setTransform(d);if(p){r.normalize(this.position,this.position);r.negate(this.position,this.direction);r.multiplyByScalar(this.position,Math.max(f,a),this.position);r.normalize(this.direction,this.direction);r.cross(this.direction,this.up,this.right);r.cross(this.right,this.direction,this.up)}}};function N(e){S.basisTo2D(e._projection,e._transform,e._actualTransform)}var L=new n;var B=new r;var F=new r;var k=new i;var V=new i;var z=new i;var U=new i;var q=new i;function G(e){var t=e._projection;var n=t.ellipsoid;var a=y.getColumn(e._transform,3,k);var o=n.cartesianToCartographic(a,L);var s=t.project(o,B);var u=V;u.x=s.z;u.y=s.x;u.z=s.y;u.w=1;var l=i.clone(i.UNIT_X,q);var c=i.add(y.getColumn(e._transform,0,F),a,F);n.cartesianToCartographic(c,o);t.project(o,s);var d=z;d.x=s.z;d.y=s.x;d.z=s.y;d.w=0;r.subtract(d,u,d);d.x=0;var f=U;if(r.magnitudeSquared(d)>_.EPSILON10){r.cross(l,d,f)}else{var h=i.add(y.getColumn(e._transform,1,F),a,F);n.cartesianToCartographic(h,o);t.project(o,s);f.x=s.z;f.y=s.x;f.z=s.y;f.w=0;r.subtract(f,u,f);f.x=0;if(r.magnitudeSquared(f)<_.EPSILON10){i.clone(i.UNIT_Y,d);i.clone(i.UNIT_Z,f)}}r.cross(f,l,d);r.normalize(d,d);r.cross(l,d,f);r.normalize(f,f);y.setColumn(e._actualTransform,0,d,e._actualTransform);y.setColumn(e._actualTransform,1,f,e._actualTransform);y.setColumn(e._actualTransform,2,l,e._actualTransform);y.setColumn(e._actualTransform,3,u,e._actualTransform)}var H=new r;function W(e){var t=e._mode;var i=false;var n=0;if(t===D.SCENE2D){n=e.frustum.right-e.frustum.left;i=n!==e._positionCartographic.height}var a=e._position;var o=!r.equals(a,e.position)||i;if(o){a=r.clone(e.position,e._position)}var s=e._direction;var u=!r.equals(s,e.direction);if(u){r.normalize(e.direction,e.direction);s=r.clone(e.direction,e._direction)}var l=e._up;var c=!r.equals(l,e.up);if(c){r.normalize(e.up,e.up);l=r.clone(e.up,e._up)}var d=e._right;var f=!r.equals(d,e.right);if(f){r.normalize(e.right,e.right);d=r.clone(e.right,e._right)}var h=e._transformChanged||e._modeChanged;e._transformChanged=false;if(h){y.inverseTransformation(e._transform,e._invTransform);if(e._mode===D.COLUMBUS_VIEW||e._mode===D.SCENE2D){if(y.equals(y.IDENTITY,e._transform)){y.clone(M.TRANSFORM_2D,e._actualTransform)}else if(e._mode===D.COLUMBUS_VIEW){N(e)}else{G(e)}}else{y.clone(e._transform,e._actualTransform)}y.inverseTransformation(e._actualTransform,e._actualInvTransform);e._modeChanged=false}var p=e._actualTransform;if(o||h){e._positionWC=y.multiplyByPoint(p,a,e._positionWC);if(t===D.SCENE3D||t===D.MORPHING){e._positionCartographic=e._projection.ellipsoid.cartesianToCartographic(e._positionWC,e._positionCartographic)}else{var m=H;m.x=e._positionWC.y;m.y=e._positionWC.z;m.z=e._positionWC.x;if(t===D.SCENE2D){m.z=n}e._projection.unproject(m,e._positionCartographic)}}if(u||c||f){var v=r.dot(s,r.cross(l,d,H));if(Math.abs(1-v)>_.EPSILON2){var g=1/r.magnitudeSquared(l);var w=r.dot(l,s)*g;var C=r.multiplyByScalar(s,w,H);l=r.normalize(r.subtract(l,C,e._up),e._up);r.clone(l,e.up);d=r.cross(s,l,e._right);r.clone(d,e.right)}}if(u||h){e._directionWC=y.multiplyByPointAsVector(p,s,e._directionWC)}if(c||h){e._upWC=y.multiplyByPointAsVector(p,l,e._upWC)}if(f||h){e._rightWC=y.multiplyByPointAsVector(p,d,e._rightWC)}if(o||u||c||f||h){I(e)}}function j(e,t){var r;if(!_.equalsEpsilon(Math.abs(e.z),1,_.EPSILON3)){r=Math.atan2(e.y,e.x)-_.PI_OVER_TWO}else{r=Math.atan2(t.y,t.x)-_.PI_OVER_TWO}return _.TWO_PI-_.zeroToTwoPi(r)}function Y(e){return _.PI_OVER_TWO-_.acosClamped(e.z)}function X(e,t,r){var i=0;if(!_.equalsEpsilon(Math.abs(e.z),1,_.EPSILON3)){i=Math.atan2(-r.z,t.z);i=_.zeroToTwoPi(i+_.TWO_PI)}return i}var Z=new y;var K=new y;s(M.prototype,{transform:{get:function(){return this._transform}},inverseTransform:{get:function(){W(this);return this._invTransform}},viewMatrix:{get:function(){W(this);return this._viewMatrix}},inverseViewMatrix:{get:function(){W(this);return this._invViewMatrix}},positionCartographic:{get:function(){W(this);return this._positionCartographic}},positionWC:{get:function(){W(this);return this._positionWC}},directionWC:{get:function(){W(this);return this._directionWC}},upWC:{get:function(){W(this);return this._upWC}},rightWC:{get:function(){W(this);return this._rightWC}},heading:{get:function(){if(this._mode!==D.MORPHING){var e=this._projection.ellipsoid;var t=y.clone(this._transform,Z);var r=S.eastNorthUpToFixedFrame(this.positionWC,e,K);this._setTransform(r);var i=j(this.direction,this.up);this._setTransform(t);return i}return undefined}},pitch:{get:function(){if(this._mode!==D.MORPHING){var e=this._projection.ellipsoid;var t=y.clone(this._transform,Z);var r=S.eastNorthUpToFixedFrame(this.positionWC,e,K);this._setTransform(r);var i=Y(this.direction);this._setTransform(t);return i}return undefined}},roll:{get:function(){if(this._mode!==D.MORPHING){var e=this._projection.ellipsoid;var t=y.clone(this._transform,Z);var r=S.eastNorthUpToFixedFrame(this.positionWC,e,K);this._setTransform(r);var i=X(this.direction,this.up,this.right);this._setTransform(t);return i}return undefined}},moveStart:{get:function(){return this._moveStart}},moveEnd:{get:function(){return this._moveEnd}},changed:{get:function(){return this._changed}}});M.prototype.update=function(e){if(!o(e)){throw new u("mode is required.")}if(e===D.SCENE2D&&!(this.frustum instanceof A)){throw new u("An OrthographicOffCenterFrustum is required in 2D.")}if((e===D.SCENE3D||e===D.COLUMBUS_VIEW)&&(!(this.frustum instanceof P)&&!(this.frustum instanceof x))){throw new u("A PerspectiveFrustum or OrthographicFrustum is required in 3D and Columbus view")}var t=false;if(e!==this._mode){this._mode=e;this._modeChanged=e!==D.MORPHING;t=this._mode===D.SCENE2D}if(t){var r=this._max2Dfrustum=this.frustum.clone();if(!(r instanceof A)){throw new u("The camera frustum is expected to be orthographic for 2D camera control.")}var i=2;var n=r.top/r.right;r.right=this._maxCoord.x*i;r.left=-r.right;r.top=n*r.right;r.bottom=-r.top}if(this._mode===D.SCENE2D){we(this,this.position)}var a=this._scene.globe;var s=!o(a)||a._surface.tileProvider.ready&&a._surface._tileLoadQueueHigh.length===0&&a._surface._tileLoadQueueMedium.length===0&&a._surface._tileLoadQueueLow.length===0&&a._surface._debug.tilesWaitingForChildren===0;if(this._suspendTerrainAdjustment){this._suspendTerrainAdjustment=!s}this._adjustHeightForTerrain()};var Q=new r;var J=new r;var $=new r;M.prototype._setTransform=function(e){var t=r.clone(this.positionWC,Q);var i=r.clone(this.upWC,J);var n=r.clone(this.directionWC,$);y.clone(e,this._transform);this._transformChanged=true;W(this);var a=this._actualInvTransform;y.multiplyByPoint(a,t,this.position);y.multiplyByPointAsVector(a,n,this.direction);y.multiplyByPointAsVector(a,i,this.up);r.cross(this.direction,this.up,this.right);W(this)};var ee=new t;var te=new C;var re=new r;var ie=new r;M.prototype._adjustOrthographicFrustum=function(e){if(!(this.frustum instanceof x)){return}if(!e&&this._positionCartographic.height<15e4){return}if(!y.equals(y.IDENTITY,this.transform)){this.frustum.width=r.magnitude(this.position);return}var t=this._scene;var i=t._globe;var n;var a;if(o(i)){var s=ee;s.x=t.drawingBufferWidth/2;s.y=t.drawingBufferHeight/2;var u=this.getPickRay(s,te);n=i.pick(u,t,re);if(t.pickPositionSupported){a=t.pickPositionWorldCoordinates(s,ie)}if(o(n)&&o(a)){var l=o(a)?r.distance(a,this.positionWC):Number.POSITIVE_INFINITY;var c=o(n)?r.distance(n,this.positionWC):Number.POSITIVE_INFINITY;this.frustum.width=Math.min(l,c)}else if(o(a)){this.frustum.width=r.distance(a,this.positionWC)}else if(o(n)){this.frustum.width=r.distance(n,this.positionWC)}}if(!o(i)||!o(n)&&!o(a)){var d=Math.max(this.positionCartographic.height,0);this.frustum.width=d}};var ne=new r;var ae=new y;var oe=new y;var se=new w;var ue=new g;var le=new n;function ce(e,t,i){var n=y.clone(e.transform,ae);var a=S.eastNorthUpToFixedFrame(t,e._projection.ellipsoid,oe);e._setTransform(a);r.clone(r.ZERO,e.position);i.heading=i.heading-_.PI_OVER_TWO;var o=w.fromHeadingPitchRoll(i,se);var s=g.fromQuaternion(o,ue);g.getColumn(s,0,e.direction);g.getColumn(s,2,e.up);r.cross(e.direction,e.up,e.right);e._setTransform(n);e._adjustOrthographicFrustum(true)}function de(e,t,i,n){var a=y.clone(e.transform,ae);e._setTransform(y.IDENTITY);if(!r.equals(t,e.positionWC)){if(n){var o=e._projection;var s=o.ellipsoid.cartesianToCartographic(t,le);t=o.project(s,ne)}r.clone(t,e.position)}i.heading=i.heading-_.PI_OVER_TWO;var u=w.fromHeadingPitchRoll(i,se);var l=g.fromQuaternion(u,ue);g.getColumn(l,0,e.direction);g.getColumn(l,2,e.up);r.cross(e.direction,e.up,e.right);e._setTransform(a);e._adjustOrthographicFrustum(true)}function fe(e,i,n,a){var o=y.clone(e.transform,ae);e._setTransform(y.IDENTITY);if(!r.equals(i,e.positionWC)){if(a){var s=e._projection;var u=s.ellipsoid.cartesianToCartographic(i,le);i=s.project(u,ne)}t.clone(i,e.position);var l=-i.z*.5;var c=-l;var d=e.frustum;if(c>l){var f=d.top/d.right;d.right=c;d.left=l;d.top=d.right*f;d.bottom=-d.top}}if(e._scene.mapMode2D===T.ROTATE){n.heading=n.heading-_.PI_OVER_TWO;n.pitch=-_.PI_OVER_TWO;n.roll=0;var h=w.fromHeadingPitchRoll(n,se);var p=g.fromQuaternion(h,ue);g.getColumn(p,2,e.up);r.cross(e.direction,e.up,e.right)}e._setTransform(o)}var he=new r;var pe=new r;var me=new r;function ve(e,t,i,n){var a=r.clone(i.direction,he);var o=r.clone(i.up,pe);if(e._scene.mode===D.SCENE3D){var s=e._projection.ellipsoid;var u=S.eastNorthUpToFixedFrame(t,s,Z);var l=y.inverseTransformation(u,K);y.multiplyByPointAsVector(l,a,a);y.multiplyByPointAsVector(l,o,o)}var c=r.cross(a,o,me);n.heading=j(a,o);n.pitch=Y(a);n.roll=X(a,o,c);return n}var _e={destination:undefined,orientation:{direction:undefined,up:undefined,heading:undefined,pitch:undefined,roll:undefined},convert:undefined,endTransform:undefined};var ge=new p;M.prototype.setView=function(e){e=a(e,a.EMPTY_OBJECT);var t=a(e.orientation,a.EMPTY_OBJECT);var i=this._mode;if(i===D.MORPHING){return}if(o(e.endTransform)){this._setTransform(e.endTransform)}var n=a(e.convert,true);var s=a(e.destination,r.clone(this.positionWC,ne));if(o(s)&&o(s.west)){s=this.getRectangleCameraCoordinates(s,ne);n=false}if(o(t.direction)){t=ve(this,s,t,_e.orientation)}ge.heading=a(t.heading,0);ge.pitch=a(t.pitch,-_.PI_OVER_TWO);ge.roll=a(t.roll,0);this._suspendTerrainAdjustment=true;if(i===D.SCENE3D){ce(this,s,ge)}else if(i===D.SCENE2D){fe(this,s,ge,n)}else{de(this,s,ge,n)}};var ye=new r;M.prototype.flyHome=function(e){var t=this._mode;if(t===D.MORPHING){this._scene.completeMorph()}if(t===D.SCENE2D){this.flyTo({destination:b.MAX_VALUE,duration:e,endTransform:y.IDENTITY})}else if(t===D.SCENE3D){var i=this.getRectangleCameraCoordinates(M.DEFAULT_VIEW_RECTANGLE);var n=r.magnitude(i);n+=n*M.DEFAULT_VIEW_FACTOR;r.normalize(i,i);r.multiplyByScalar(i,n,i);this.flyTo({destination:i,duration:e,endTransform:y.IDENTITY})}else if(t===D.COLUMBUS_VIEW){var a=this._projection.ellipsoid.maximumRadius;var o=new r(0,-1,1);o=r.multiplyByScalar(r.normalize(o,o),5*a,o);this.flyTo({destination:o,duration:e,orientation:{heading:0,pitch:-Math.acos(r.normalize(o,ye).z),roll:0},endTransform:y.IDENTITY,convert:false})}};M.prototype.worldToCameraCoordinates=function(e,t){if(!o(e)){throw new u("cartesian is required.")}if(!o(t)){t=new i}W(this);return y.multiplyByVector(this._actualInvTransform,e,t)};M.prototype.worldToCameraCoordinatesPoint=function(e,t){if(!o(e)){throw new u("cartesian is required.")}if(!o(t)){t=new r}W(this);return y.multiplyByPoint(this._actualInvTransform,e,t)};M.prototype.worldToCameraCoordinatesVector=function(e,t){if(!o(e)){throw new u("cartesian is required.")}if(!o(t)){t=new r}W(this);return y.multiplyByPointAsVector(this._actualInvTransform,e,t)};M.prototype.cameraToWorldCoordinates=function(e,t){if(!o(e)){throw new u("cartesian is required.")}if(!o(t)){t=new i}W(this);return y.multiplyByVector(this._actualTransform,e,t)};M.prototype.cameraToWorldCoordinatesPoint=function(e,t){if(!o(e)){throw new u("cartesian is required.")}if(!o(t)){t=new r}W(this);return y.multiplyByPoint(this._actualTransform,e,t)};M.prototype.cameraToWorldCoordinatesVector=function(e,t){if(!o(e)){throw new u("cartesian is required.")}if(!o(t)){t=new r}W(this);return y.multiplyByPointAsVector(this._actualTransform,e,t)};function we(e,t){var r=e._scene.mapMode2D===T.ROTATE;var i=e._maxCoord.x;var n=e._maxCoord.y;var a;var o;if(r){o=i;a=-o}else{o=t.x-i*2;a=t.x+i*2}if(t.x>i){t.x=o}if(t.x<-i){t.x=a}if(t.y>n){t.y=n}if(t.y<-n){t.y=-n}}var Ce=new r;M.prototype.move=function(e,t){if(!o(e)){throw new u("direction is required.")}var i=this.position;r.multiplyByScalar(e,t,Ce);r.add(i,Ce,i);if(this._mode===D.SCENE2D){we(this,i)}this._adjustOrthographicFrustum(true)};M.prototype.moveForward=function(e){e=a(e,this.defaultMoveAmount);this.move(this.direction,e)};M.prototype.moveBackward=function(e){e=a(e,this.defaultMoveAmount);this.move(this.direction,-e)};M.prototype.moveUp=function(e){e=a(e,this.defaultMoveAmount);this.move(this.up,e)};M.prototype.moveDown=function(e){e=a(e,this.defaultMoveAmount);this.move(this.up,-e)};M.prototype.moveRight=function(e){e=a(e,this.defaultMoveAmount);this.move(this.right,e)};M.prototype.moveLeft=function(e){e=a(e,this.defaultMoveAmount);this.move(this.right,-e)};M.prototype.lookLeft=function(e){e=a(e,this.defaultLookAmount);this.look(this.up,-e)};M.prototype.lookRight=function(e){e=a(e,this.defaultLookAmount);this.look(this.up,e)};M.prototype.lookUp=function(e){e=a(e,this.defaultLookAmount);this.look(this.right,-e)};M.prototype.lookDown=function(e){e=a(e,this.defaultLookAmount);this.look(this.right,e)};var be=new w;var Se=new g;M.prototype.look=function(e,t){if(!o(e)){throw new u("axis is required.")}var r=a(t,this.defaultLookAmount);var i=w.fromAxisAngle(e,-r,be);var n=g.fromQuaternion(i,Se);var s=this.direction;var l=this.up;var c=this.right;g.multiplyByVector(n,s,s);g.multiplyByVector(n,l,l);g.multiplyByVector(n,c,c)};M.prototype.twistLeft=function(e){e=a(e,this.defaultLookAmount);this.look(this.direction,e)};M.prototype.twistRight=function(e){e=a(e,this.defaultLookAmount);this.look(this.direction,-e)};var Ee=new w;var Te=new g;M.prototype.rotate=function(e,t){if(!o(e)){throw new u("axis is required.")}var i=a(t,this.defaultRotateAmount);var n=w.fromAxisAngle(e,-i,Ee);var s=g.fromQuaternion(n,Te);g.multiplyByVector(s,this.position,this.position);g.multiplyByVector(s,this.direction,this.direction);g.multiplyByVector(s,this.up,this.up);r.cross(this.direction,this.up,this.right);r.cross(this.right,this.direction,this.up);this._adjustOrthographicFrustum(false)};M.prototype.rotateDown=function(e){e=a(e,this.defaultRotateAmount);Me(this,e)};M.prototype.rotateUp=function(e){e=a(e,this.defaultRotateAmount);Me(this,-e)};var xe=new r;var Ae=new r;var Pe=new r;var De=new r;function Me(e,t){var i=e.position;var n=r.normalize(i,xe);if(o(e.constrainedAxis)){var a=r.equalsEpsilon(n,e.constrainedAxis,_.EPSILON2);var s=r.equalsEpsilon(n,r.negate(e.constrainedAxis,De),_.EPSILON2);if(!a&&!s){var u=r.normalize(e.constrainedAxis,Ae);var l=r.dot(n,u);var c=_.acosClamped(l);if(t>0&&t>c){t=c-_.EPSILON4}l=r.dot(n,r.negate(u,De));c=_.acosClamped(l);if(t<0&&-t>c){t=-c+_.EPSILON4}var d=r.cross(u,n,Pe);e.rotate(d,t)}else if(a&&t<0||s&&t>0){e.rotate(e.right,t)}}else{e.rotate(e.right,t)}}M.prototype.rotateRight=function(e){e=a(e,this.defaultRotateAmount);Ie(this,-e)};M.prototype.rotateLeft=function(e){e=a(e,this.defaultRotateAmount);Ie(this,e)};function Ie(e,t){if(o(e.constrainedAxis)){e.rotate(e.constrainedAxis,t)}else{e.rotate(e.up,t)}}function Oe(e,t){var r=e.frustum;if(!(r instanceof A)||!o(r.left)||!o(r.right)||!o(r.bottom)||!o(r.top)){throw new u("The camera frustum is expected to be orthographic for 2D camera control.")}t=t*.5;var i=r.right-t;var n=r.left+t;var a=e._maxCoord.x;if(e._scene.mapMode2D===T.ROTATE){a*=e.maximumZoomFactor}if(i>a){i=a;n=-a}if(i<=n){i=1;n=-1}var s=r.top/r.right;r.right=i;r.left=n;r.top=r.right*s;r.bottom=-r.top}function Re(e,t){e.move(e.direction,t)}M.prototype.zoomIn=function(e){e=a(e,this.defaultZoomAmount);if(this._mode===D.SCENE2D){Oe(this,e)}else{Re(this,e)}};M.prototype.zoomOut=function(e){e=a(e,this.defaultZoomAmount);if(this._mode===D.SCENE2D){Oe(this,-e)}else{Re(this,-e)}};M.prototype.getMagnitude=function(){if(this._mode===D.SCENE3D){return r.magnitude(this.position)}else if(this._mode===D.COLUMBUS_VIEW){return Math.abs(this.position.z)}else if(this._mode===D.SCENE2D){return Math.max(this.frustum.right-this.frustum.left,this.frustum.top-this.frustum.bottom)}};var Ne=new y;M.prototype.lookAt=function(e,t){if(!o(e)){throw new u("target is required")}if(!o(t)){throw new u("offset is required")}if(this._mode===D.MORPHING){throw new u("lookAt is not supported while morphing.")}var r=S.eastNorthUpToFixedFrame(e,c.WGS84,Ne);this.lookAtTransform(r,t)};var Le=new r;var Be=new w;var Fe=new w;var ke=new g;function Ve(e,t,i){t=_.clamp(t,-_.PI_OVER_TWO,_.PI_OVER_TWO);e=_.zeroToTwoPi(e)-_.PI_OVER_TWO;var n=w.fromAxisAngle(r.UNIT_Y,-t,Be);var a=w.fromAxisAngle(r.UNIT_Z,-e,Fe);var o=w.multiply(a,n,a);var s=g.fromQuaternion(o,ke);var u=r.clone(r.UNIT_X,Le);g.multiplyByVector(s,u,u);r.negate(u,u);r.multiplyByScalar(u,i,u);return u}M.prototype.lookAtTransform=function(e,i){if(!o(e)){throw new u("transform is required")}if(this._mode===D.MORPHING){throw new u("lookAtTransform is not supported while morphing.")}this._setTransform(e);if(!o(i)){return}var n;if(o(i.heading)){n=Ve(i.heading,i.pitch,i.range)}else{n=i}if(this._mode===D.SCENE2D){t.clone(t.ZERO,this.position);r.negate(n,this.up);this.up.z=0;if(r.magnitudeSquared(this.up)<_.EPSILON10){r.clone(r.UNIT_Y,this.up)}r.normalize(this.up,this.up);this._setTransform(y.IDENTITY);r.negate(r.UNIT_Z,this.direction);r.cross(this.direction,this.up,this.right);r.normalize(this.right,this.right);var a=this.frustum;var s=a.top/a.right;a.right=r.magnitude(n)*.5;a.left=-a.right;a.top=s*a.right;a.bottom=-a.top;this._setTransform(e);return}r.clone(n,this.position);r.negate(this.position,this.direction);r.normalize(this.direction,this.direction);r.cross(this.direction,r.UNIT_Z,this.right);if(r.magnitudeSquared(this.right)<_.EPSILON10){r.clone(r.UNIT_X,this.right)}r.normalize(this.right,this.right);r.cross(this.right,this.direction,this.up);r.normalize(this.up,this.up);this._adjustOrthographicFrustum(true)};var ze=new n;var Ue=new n;var qe=new r;var Ge=new r;var He=new r;var We=new r;var je=new r;var Ye=new r;var Xe=new r;var Ze=new r;var Ke={direction:new r,right:new r,up:new r};var Qe;function Je(e,t,i,n){var a=Math.abs(r.dot(t,i));return a/n-r.dot(e,i)}function $e(e,t,i,n){var a=e._projection.ellipsoid;var s=n?e:Ke;var u=t.north;var l=t.south;var c=t.east;var f=t.west;if(f>c){c+=_.TWO_PI}var h=(f+c)*.5;var p;if(l<-_.PI_OVER_TWO+_.RADIANS_PER_DEGREE&&u>_.PI_OVER_TWO-_.RADIANS_PER_DEGREE){p=0}else{var m=ze;m.longitude=h;m.latitude=u;m.height=0;var v=Ue;v.longitude=h;v.latitude=l;v.height=0;var g=Qe;if(!o(g)||g.ellipsoid!==a){Qe=g=new d(undefined,undefined,a)}g.setEndPoints(m,v);p=g.interpolateUsingFraction(.5,ze).latitude}var y=ze;y.longitude=h;y.latitude=p;y.height=0;var w=a.cartographicToCartesian(y,Xe);var C=ze;C.longitude=c;C.latitude=u;var b=a.cartographicToCartesian(C,qe);C.longitude=f;var S=a.cartographicToCartesian(C,He);C.longitude=h;var E=a.cartographicToCartesian(C,je);C.latitude=l;var T=a.cartographicToCartesian(C,Ye);C.longitude=c;var A=a.cartographicToCartesian(C,We);C.longitude=f;var P=a.cartographicToCartesian(C,Ge);r.subtract(S,w,S);r.subtract(A,w,A);r.subtract(b,w,b);r.subtract(P,w,P);r.subtract(E,w,E);r.subtract(T,w,T);var D=a.geodeticSurfaceNormal(w,s.direction);r.negate(D,D);var M=r.cross(D,r.UNIT_Z,s.right);r.normalize(M,M);var I=r.cross(M,D,s.up);var O;if(e.frustum instanceof x){var R=Math.max(r.distance(b,S),r.distance(A,P));var N=Math.max(r.distance(b,A),r.distance(S,P));var L;var B;var F=e.frustum._offCenterFrustum.right/e.frustum._offCenterFrustum.top;var k=N*F;if(R>k){L=R;B=L/F}else{B=N;L=k}O=Math.max(L,B)}else{var V=Math.tan(e.frustum.fovy*.5);var z=e.frustum.aspectRatio*V;O=Math.max(Je(D,I,S,V),Je(D,I,A,V),Je(D,I,b,V),Je(D,I,P,V),Je(D,I,E,V),Je(D,I,T,V),Je(D,M,S,z),Je(D,M,A,z),Je(D,M,b,z),Je(D,M,P,z),Je(D,M,E,z),Je(D,M,T,z));if(l<0&&u>0){var U=ze;U.longitude=f;U.latitude=0;U.height=0;var q=a.cartographicToCartesian(U,Ze);r.subtract(q,w,q)
;O=Math.max(O,Je(D,I,q,V),Je(D,M,q,z));U.longitude=c;q=a.cartographicToCartesian(U,Ze);r.subtract(q,w,q);O=Math.max(O,Je(D,I,q,V),Je(D,M,q,z))}}return r.add(w,r.multiplyByScalar(D,-O,Ze),i)}var et=new n;var tt=new r;var rt=new r;function it(e,t,r){var i=e._projection;if(t.west>t.east){t=b.MAX_VALUE}var n=e._actualTransform;var a=e._actualInvTransform;var s=et;s.longitude=t.east;s.latitude=t.north;var u=i.project(s,tt);y.multiplyByPoint(n,u,u);y.multiplyByPoint(a,u,u);s.longitude=t.west;s.latitude=t.south;var l=i.project(s,rt);y.multiplyByPoint(n,l,l);y.multiplyByPoint(a,l,l);r.x=(u.x-l.x)*.5+l.x;r.y=(u.y-l.y)*.5+l.y;if(o(e.frustum.fovy)){var c=Math.tan(e.frustum.fovy*.5);var d=e.frustum.aspectRatio*c;r.z=Math.max((u.x-l.x)/d,(u.y-l.y)/c)*.5}else{var f=u.x-l.x;var h=u.y-l.y;r.z=Math.max(f,h)}return r}var nt=new n;var at=new r;var ot=new r;function st(e,t,r){var i=e._projection;if(t.west>t.east){t=b.MAX_VALUE}var n=nt;n.longitude=t.east;n.latitude=t.north;var a=i.project(n,at);n.longitude=t.west;n.latitude=t.south;var o=i.project(n,ot);var s=Math.abs(a.x-o.x)*.5;var u=Math.abs(a.y-o.y)*.5;var l,c;var d=e.frustum.right/e.frustum.top;var f=u*d;if(s>f){l=s;c=l/d}else{c=u;l=f}u=Math.max(2*l,2*c);r.x=(a.x-o.x)*.5+o.x;r.y=(a.y-o.y)*.5+o.y;n=i.unproject(r,n);n.height=u;r=i.project(n,r);return r}M.prototype.getRectangleCameraCoordinates=function(e,t){if(!o(e)){throw new u("rectangle is required")}var i=this._mode;if(!o(t)){t=new r}if(i===D.SCENE3D){return $e(this,e,t)}else if(i===D.COLUMBUS_VIEW){return it(this,e,t)}else if(i===D.SCENE2D){return st(this,e,t)}return undefined};var ut=new C;function lt(e,t,r,i){r=a(r,c.WGS84);var n=e.getPickRay(t,ut);var o=v.rayEllipsoid(n,r);if(!o){return undefined}var s=o.start>0?o.start:o.stop;return C.getPoint(n,s,i)}var ct=new C;function dt(e,t,r,i){var n=e.getPickRay(t,ct);var a=n.origin;a.z=0;var o=r.unproject(a);if(o.latitude<-_.PI_OVER_TWO||o.latitude>_.PI_OVER_TWO){return undefined}return r.ellipsoid.cartographicToCartesian(o,i)}var ft=new C;function ht(e,t,i,n){var a=e.getPickRay(t,ft);var o=-a.origin.x/a.direction.x;C.getPoint(a,o,n);var s=i.unproject(new r(n.y,n.z,0));if(s.latitude<-_.PI_OVER_TWO||s.latitude>_.PI_OVER_TWO||s.longitude<-Math.PI||s.longitude>Math.PI){return undefined}return i.ellipsoid.cartographicToCartesian(s,n)}M.prototype.pickEllipsoid=function(e,t,i){if(!o(e)){throw new u("windowPosition is required.")}if(!o(i)){i=new r}t=a(t,c.WGS84);if(this._mode===D.SCENE3D){i=lt(this,e,t,i)}else if(this._mode===D.SCENE2D){i=dt(this,e,this._projection,i)}else if(this._mode===D.COLUMBUS_VIEW){i=ht(this,e,this._projection,i)}else{return undefined}return i};var pt=new r;var mt=new r;var vt=new r;function _t(e,t,i){var n=e._scene.canvas;var a=n.clientWidth;var o=n.clientHeight;var s=Math.tan(e.frustum.fovy*.5);var u=e.frustum.aspectRatio*s;var l=e.frustum.near;var c=2/a*t.x-1;var d=2/o*(o-t.y)-1;var f=e.positionWC;r.clone(f,i.origin);var h=r.multiplyByScalar(e.directionWC,l,pt);r.add(f,h,h);var p=r.multiplyByScalar(e.rightWC,c*l*u,mt);var m=r.multiplyByScalar(e.upWC,d*l*s,vt);var v=r.add(h,p,i.direction);r.add(v,m,v);r.subtract(v,f,v);r.normalize(v,v);return i}var gt=new r;function yt(e,t,i){var n=e._scene.canvas;var a=n.clientWidth;var s=n.clientHeight;var u=e.frustum;if(o(u._offCenterFrustum)){u=u._offCenterFrustum}var l=2/a*t.x-1;l*=(u.right-u.left)*.5;var c=2/s*(s-t.y)-1;c*=(u.top-u.bottom)*.5;var d=i.origin;r.clone(e.position,d);r.multiplyByScalar(e.right,l,gt);r.add(gt,d,d);r.multiplyByScalar(e.up,c,gt);r.add(gt,d,d);r.clone(e.directionWC,i.direction);if(e._mode===D.COLUMBUS_VIEW){r.fromElements(i.origin.z,i.origin.x,i.origin.y,i.origin)}return i}M.prototype.getPickRay=function(e,t){if(!o(e)){throw new u("windowPosition is required.")}if(!o(t)){t=new C}var r=this.frustum;if(o(r.aspectRatio)&&o(r.fov)&&o(r.near)){return _t(this,e,t)}return yt(this,e,t)};var wt=new r;var Ct=new r;M.prototype.distanceToBoundingSphere=function(e){if(!o(e)){throw new u("boundingSphere is required.")}var t=r.subtract(this.positionWC,e.center,wt);var i=r.multiplyByScalar(this.directionWC,r.dot(t,this.directionWC),Ct);return Math.max(0,r.magnitude(i)-e.radius)};var bt=new t;M.prototype.getPixelSize=function(e,t,r){if(!o(e)){throw new u("boundingSphere is required.")}if(!o(t)){throw new u("drawingBufferWidth is required.")}if(!o(r)){throw new u("drawingBufferHeight is required.")}var i=this.distanceToBoundingSphere(e);var n=this.frustum.getPixelDimensions(t,r,i,bt);return Math.max(n.x,n.y)};function St(e,t,i,n,a,o){var s=r.clone(t);if(i.y>n){s.y-=i.y-n}else if(i.y<-n){s.y+=-n-i.y}if(i.z>a){s.z-=i.z-a}else if(i.z<-a){s.z+=-a-i.z}function u(i){var n=r.lerp(t,s,i.time,new r);e.worldToCameraCoordinatesPoint(n,e.position)}return{easingFunction:l.EXPONENTIAL_OUT,startObject:{time:0},stopObject:{time:1},duration:o,update:u}}var Et=new r;var Tt=new r;var xt=new r;var At=new r;function Pt(e,t){var i=e.position;var n=e.direction;var a=e.worldToCameraCoordinatesVector(r.UNIT_X,Et);var o=-r.dot(a,i)/r.dot(a,n);var s=r.add(i,r.multiplyByScalar(n,o,Tt),Tt);e.cameraToWorldCoordinatesPoint(s,s);i=e.cameraToWorldCoordinatesPoint(e.position,xt);var u=Math.tan(e.frustum.fovy*.5);var l=e.frustum.aspectRatio*u;var c=r.magnitude(r.subtract(i,s,At));var d=l*c;var f=u*c;var h=e._maxCoord.x;var p=e._maxCoord.y;var m=Math.max(d-h,h);var v=Math.max(f-p,p);if(i.z<-m||i.z>m||i.y<-v||i.y>v){var _=s.y<-m||s.y>m;var g=s.z<-v||s.z>v;if(_||g){return St(e,i,s,m,v,t)}}return undefined}M.prototype.createCorrectPositionTween=function(e){if(!o(e)){throw new u("duration is required.")}if(this._mode===D.COLUMBUS_VIEW){return Pt(this,e)}return undefined};var Dt=new r;var Mt={destination:undefined,heading:undefined,pitch:undefined,roll:undefined,duration:undefined,complete:undefined,cancel:undefined,endTransform:undefined,maximumHeight:undefined,easingFunction:undefined};M.prototype.cancelFlight=function(){if(o(this._currentFlight)){this._currentFlight.cancelTween();this._currentFlight=undefined}};M.prototype.flyTo=function(e){e=a(e,a.EMPTY_OBJECT);var t=e.destination;if(!o(t)){throw new u("destination is required.")}var r=this._mode;if(r===D.MORPHING){return}this.cancelFlight();var i=a(e.orientation,a.EMPTY_OBJECT);if(o(i.direction)){i=ve(this,t,i,_e.orientation)}if(o(e.duration)&&e.duration<=0){var n=_e;n.destination=e.destination;n.orientation.heading=i.heading;n.orientation.pitch=i.pitch;n.orientation.roll=i.roll;n.convert=e.convert;n.endTransform=e.endTransform;this.setView(n);if(typeof e.complete==="function"){e.complete()}return}var s=o(t.west);if(s){t=this.getRectangleCameraCoordinates(t,Dt)}var l=this;var c;Mt.destination=t;Mt.heading=i.heading;Mt.pitch=i.pitch;Mt.roll=i.roll;Mt.duration=e.duration;Mt.complete=function(){if(c===l._currentFlight){l._currentFlight=undefined}if(o(e.complete)){e.complete()}};Mt.cancel=e.cancel;Mt.endTransform=e.endTransform;Mt.convert=s?false:e.convert;Mt.maximumHeight=e.maximumHeight;Mt.pitchAdjustHeight=e.pitchAdjustHeight;Mt.flyOverLongitude=e.flyOverLongitude;Mt.flyOverLongitudeWeight=e.flyOverLongitudeWeight;Mt.easingFunction=e.easingFunction;var d=this._scene;c=d.tweens.add(E.createTween(d,Mt));this._currentFlight=c};function It(e,t){var r=e.frustum;var i=Math.tan(r.fovy*.5);var n=r.aspectRatio*i;return Math.max(t/n,t/i)}function Ot(e,t){var r=e.frustum;if(o(r._offCenterFrustum)){r=r._offCenterFrustum}var i,n;var a=r.right/r.top;var s=t*a;if(t>s){i=t;n=i/a}else{n=t;i=s}return Math.max(i,n)*1.5}var Rt=100;function Nt(e,t,r){if(!o(r)){r=h.clone(M.DEFAULT_OFFSET)}var i=r.range;if(!o(i)||i===0){var n=t.radius;if(n===0){r.range=Rt}else if(e.frustum instanceof x||e._mode===D.SCENE2D){r.range=Ot(e,n)}else{r.range=It(e,n)}}return r}M.prototype.viewBoundingSphere=function(e,t){if(!o(e)){throw new u("boundingSphere is required.")}if(this._mode===D.MORPHING){throw new u("viewBoundingSphere is not supported while morphing.")}t=Nt(this,e,t);this.lookAt(e.center,t)};var Lt=new y;var Bt=new r;var Ft=new r;var kt=new r;var Vt=new r;var zt=new i;var Ut=new w;var qt=new g;M.prototype.flyToBoundingSphere=function(e,t){if(!o(e)){throw new u("boundingSphere is required.")}t=a(t,a.EMPTY_OBJECT);var i=this._mode===D.SCENE2D||this._mode===D.COLUMBUS_VIEW;this._setTransform(y.IDENTITY);var n=Nt(this,e,t.offset);var s;if(i){s=r.multiplyByScalar(r.UNIT_Z,n.range,Bt)}else{s=Ve(n.heading,n.pitch,n.range)}var l=S.eastNorthUpToFixedFrame(e.center,c.WGS84,Lt);y.multiplyByPoint(l,s,s);var d;var f;if(!i){d=r.subtract(e.center,s,Ft);r.normalize(d,d);f=y.multiplyByPointAsVector(l,r.UNIT_Z,kt);if(1-Math.abs(r.dot(d,f))<_.EPSILON6){var h=w.fromAxisAngle(d,n.heading,Ut);var p=g.fromQuaternion(h,qt);r.fromCartesian4(y.getColumn(l,1,zt),f);g.multiplyByVector(p,f,f)}var m=r.cross(d,f,Vt);r.cross(m,d,f);r.normalize(f,f)}this.flyTo({destination:s,orientation:{direction:d,up:f},duration:t.duration,complete:t.complete,cancel:t.cancel,endTransform:t.endTransform,maximumHeight:t.maximumHeight,easingFunction:t.easingFunction,flyOverLongitude:t.flyOverLongitude,flyOverLongitudeWeight:t.flyOverLongitudeWeight,pitchAdjustHeight:t.pitchAdjustHeight})};var Gt=new r;var Ht=new r;var Wt=new r;var jt=new r;var Yt=[new r,new r,new r,new r];function Xt(e,t){var i=t.radii;var n=e.positionWC;var a=r.multiplyComponents(t.oneOverRadii,n,Gt);var o=r.magnitude(a);var s=r.normalize(a,Ht);var u;var l;if(r.equalsEpsilon(s,r.UNIT_Z,_.EPSILON10)){u=new r(0,1,0);l=new r(0,0,1)}else{u=r.normalize(r.cross(r.UNIT_Z,s,Wt),Wt);l=r.normalize(r.cross(s,u,jt),jt)}var c=Math.sqrt(r.magnitudeSquared(a)-1);var d=r.multiplyByScalar(s,1/o,Gt);var f=c/o;var h=r.multiplyByScalar(u,f,Ht);var p=r.multiplyByScalar(l,f,Wt);var m=r.add(d,p,Yt[0]);r.subtract(m,h,m);r.multiplyComponents(i,m,m);var v=r.subtract(d,p,Yt[1]);r.subtract(v,h,v);r.multiplyComponents(i,v,v);var g=r.subtract(d,p,Yt[2]);r.add(g,h,g);r.multiplyComponents(i,g,g);var y=r.add(d,p,Yt[3]);r.add(y,h,y);r.multiplyComponents(i,y,y);return Yt}var Zt=new t;var Kt=new r;var Qt=[new n,new n,new n,new n];function Jt(e,t,r,i,n,a){Zt.x=e;Zt.y=t;var s=i.pickEllipsoid(Zt,n,Kt);if(o(s)){Qt[r]=n.cartesianToCartographic(s,Qt[r]);return 1}Qt[r]=n.cartesianToCartographic(a[r],Qt[r]);return 0}M.prototype.computeViewRectangle=function(t,i){t=a(t,c.WGS84);var n=this.frustum.computeCullingVolume(this.positionWC,this.directionWC,this.upWC);var o=new e(r.ZERO,t.maximumRadius);var s=n.computeVisibility(o);if(s===m.OUTSIDE){return undefined}var u=this._scene.canvas;var l=u.clientWidth;var d=u.clientHeight;var f=0;var h=Xt(this,t);f+=Jt(0,0,0,this,t,h);f+=Jt(0,d,1,this,t,h);f+=Jt(l,d,2,this,t,h);f+=Jt(l,0,3,this,t,h);if(f<2){return b.MAX_VALUE}i=b.fromCartographicArray(Qt,i);var p=0;var v=Qt[3].longitude;for(var g=0;g<4;++g){var y=Qt[g].longitude;var w=Math.abs(y-v);if(w>_.PI){p+=_.TWO_PI-w}else{p+=w}v=y}if(_.equalsEpsilon(Math.abs(p),_.TWO_PI,_.EPSILON9)){i.west=-_.PI;i.east=_.PI;if(Qt[0].latitude>=0){i.north=_.PI_OVER_TWO}else{i.south=-_.PI_OVER_TWO}}return i};M.prototype.switchToPerspectiveFrustum=function(){if(this._mode===D.SCENE2D||this.frustum instanceof P){return}var e=this._scene;this.frustum=new P;this.frustum.aspectRatio=e.drawingBufferWidth/e.drawingBufferHeight;this.frustum.fov=_.toRadians(60)};M.prototype.switchToOrthographicFrustum=function(){if(this._mode===D.SCENE2D||this.frustum instanceof x){return}var e=this._scene;this.frustum=new x;this.frustum.aspectRatio=e.drawingBufferWidth/e.drawingBufferHeight;this.frustum.width=r.magnitude(this.position);var t=this.frustum.projectionMatrix;if(o(t)){this._adjustOrthographicFrustum(true)}};M.clone=function(e,t){if(!o(t)){t=new M(e._scene)}r.clone(e.position,t.position);r.clone(e.direction,t.direction);r.clone(e.up,t.up);r.clone(e.right,t.right);y.clone(e._transform,t.transform);t._transformChanged=true;return t};return M});define("Scene/CameraEventType",["../Core/freezeObject"],function(e){"use strict";var t={LEFT_DRAG:0,RIGHT_DRAG:1,MIDDLE_DRAG:2,WHEEL:3,PINCH:4};return e(t)});define("Scene/CameraEventAggregator",["../Core/Cartesian2","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/KeyboardEventModifier","../Core/Math","../Core/ScreenSpaceEventHandler","../Core/ScreenSpaceEventType","./CameraEventType"],function(e,t,r,i,n,a,o,s,u,l){"use strict";function c(e,r){var i=e;if(t(r)){i+="+"+r}return i}function d(t,r){e.clone(t.distance.startPosition,r.distance.startPosition);e.clone(t.distance.endPosition,r.distance.endPosition);e.clone(t.angleAndHeight.startPosition,r.angleAndHeight.startPosition);e.clone(t.angleAndHeight.endPosition,r.angleAndHeight.endPosition)}function f(r,i,n){var a=c(l.PINCH,i);var o=r._update;var s=r._isDown;var f=r._eventStartPosition;var h=r._pressTime;var p=r._releaseTime;o[a]=true;s[a]=false;f[a]=new e;var m=r._movement[a];if(!t(m)){m=r._movement[a]={}}m.distance={startPosition:new e,endPosition:new e};m.angleAndHeight={startPosition:new e,endPosition:new e};m.prevAngle=0;r._eventHandler.setInputAction(function(t){r._buttonsDown++;s[a]=true;h[a]=new Date;e.lerp(t.position1,t.position2,.5,f[a])},u.PINCH_START,i);r._eventHandler.setInputAction(function(){r._buttonsDown=Math.max(r._buttonsDown-1,0);s[a]=false;p[a]=new Date},u.PINCH_END,i);r._eventHandler.setInputAction(function(t){if(s[a]){if(!o[a]){e.clone(t.distance.endPosition,m.distance.endPosition);e.clone(t.angleAndHeight.endPosition,m.angleAndHeight.endPosition)}else{d(t,m);o[a]=false;m.prevAngle=m.angleAndHeight.startPosition.x}var r=m.angleAndHeight.endPosition.x;var i=m.prevAngle;var u=Math.PI*2;while(r>=i+Math.PI){r-=u}while(r<i-Math.PI){r+=u}m.angleAndHeight.endPosition.x=-r*n.clientWidth/12;m.angleAndHeight.startPosition.x=-i*n.clientWidth/12}},u.PINCH_MOVE,i)}function h(r,i){var n=c(l.WHEEL,i);var a=r._update;a[n]=true;var s=r._movement[n];if(!t(s)){s=r._movement[n]={}}s.startPosition=new e;s.endPosition=new e;r._eventHandler.setInputAction(function(t){var r=15*o.toRadians(t);if(!a[n]){s.endPosition.y=s.endPosition.y+r}else{e.clone(e.ZERO,s.startPosition);s.endPosition.x=0;s.endPosition.y=r;a[n]=false}},u.WHEEL,i)}function p(r,i,n){var a=c(n,i);var o=r._isDown;var s=r._eventStartPosition;var d=r._pressTime;var f=r._releaseTime;o[a]=false;s[a]=new e;var h=r._lastMovement[a];if(!t(h)){h=r._lastMovement[a]={startPosition:new e,endPosition:new e,valid:false}}var p;var m;if(n===l.LEFT_DRAG){p=u.LEFT_DOWN;m=u.LEFT_UP}else if(n===l.RIGHT_DRAG){p=u.RIGHT_DOWN;m=u.RIGHT_UP}else if(n===l.MIDDLE_DRAG){p=u.MIDDLE_DOWN;m=u.MIDDLE_UP}r._eventHandler.setInputAction(function(t){r._buttonsDown++;h.valid=false;o[a]=true;d[a]=new Date;e.clone(t.position,s[a])},p,i);r._eventHandler.setInputAction(function(){r._buttonsDown=Math.max(r._buttonsDown-1,0);o[a]=false;f[a]=new Date},m,i)}function m(t,r){e.clone(t.startPosition,r.startPosition);e.clone(t.endPosition,r.endPosition)}function v(r,i){var n=r._update;var a=r._movement;var o=r._lastMovement;var s=r._isDown;for(var d in l){if(l.hasOwnProperty(d)){var f=l[d];if(t(f)){var h=c(f,i);n[h]=true;if(!t(r._lastMovement[h])){r._lastMovement[h]={startPosition:new e,endPosition:new e,valid:false}}if(!t(r._movement[h])){r._movement[h]={startPosition:new e,endPosition:new e}}}}}r._eventHandler.setInputAction(function(u){for(var d in l){if(l.hasOwnProperty(d)){var f=l[d];if(t(f)){var h=c(f,i);if(s[h]){if(!n[h]){e.clone(u.endPosition,a[h].endPosition)}else{m(a[h],o[h]);o[h].valid=true;m(u,a[h]);n[h]=false}}}}}e.clone(u.endPosition,r._currentMousePosition)},u.MOUSE_MOVE,i)}function _(r){if(!t(r)){throw new n("canvas is required.")}this._eventHandler=new s(r,true);this._update={};this._movement={};this._lastMovement={};this._isDown={};this._eventStartPosition={};this._pressTime={};this._releaseTime={};this._buttonsDown=0;this._currentMousePosition=new e;h(this,undefined);f(this,undefined,r);p(this,undefined,l.LEFT_DRAG);p(this,undefined,l.RIGHT_DRAG);p(this,undefined,l.MIDDLE_DRAG);v(this,undefined);for(var i in a){if(a.hasOwnProperty(i)){var o=a[i];if(t(o)){h(this,o);f(this,o,r);p(this,o,l.LEFT_DRAG);p(this,o,l.RIGHT_DRAG);p(this,o,l.MIDDLE_DRAG);v(this,o)}}}}r(_.prototype,{currentMousePosition:{get:function(){return this._currentMousePosition}},anyButtonDown:{get:function(){var e=!this._update[c(l.WHEEL)]||!this._update[c(l.WHEEL,a.SHIFT)]||!this._update[c(l.WHEEL,a.CTRL)]||!this._update[c(l.WHEEL,a.ALT)];return this._buttonsDown>0||e}}});_.prototype.isMoving=function(e,r){if(!t(e)){throw new n("type is required.")}var i=c(e,r);return!this._update[i]};_.prototype.getMovement=function(e,r){if(!t(e)){throw new n("type is required.")}var i=c(e,r);var a=this._movement[i];return a};_.prototype.getLastMovement=function(e,r){if(!t(e)){throw new n("type is required.")}var i=c(e,r);var a=this._lastMovement[i];if(a.valid){return a}return undefined};_.prototype.isButtonDown=function(e,r){if(!t(e)){throw new n("type is required.")}var i=c(e,r);return this._isDown[i]};_.prototype.getStartMousePosition=function(e,r){if(!t(e)){throw new n("type is required.")}if(e===l.WHEEL){return this._currentMousePosition}var i=c(e,r);return this._eventStartPosition[i]};_.prototype.getButtonPressTime=function(e,r){if(!t(e)){throw new n("type is required.")}var i=c(e,r);return this._pressTime[i]};_.prototype.getButtonReleaseTime=function(e,r){if(!t(e)){throw new n("type is required.")}var i=c(e,r);return this._releaseTime[i]};_.prototype.reset=function(){for(var e in this._update){if(this._update.hasOwnProperty(e)){this._update[e]=true}}};_.prototype.isDestroyed=function(){return false};_.prototype.destroy=function(){this._eventHandler=this._eventHandler&&this._eventHandler.destroy();return i(this)};return _});define("Scene/Cesium3DTileChildrenVisibility",["../Core/freezeObject"],function(e){"use strict";var t={NONE:0,VISIBLE:1,IN_REQUEST_VOLUME:2,VISIBLE_IN_REQUEST_VOLUME:4};return e(t)});define("Scene/Composite3DTileContent",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/getMagic","../Core/loadArrayBuffer","../Core/Request","../Core/RequestScheduler","../Core/RequestType","../ThirdParty/when","./Cesium3DTileContentState"],function(e,t,r,i,n,a,o,s,u,l,c,d){"use strict";function f(e,t,r,i){this._url=r;this._tileset=e;this._tile=t;this._contents=[];this._factory=i;this.state=d.UNLOADED;this.batchTable=undefined;this._contentReadyToProcessPromise=c.defer();this._readyPromise=c.defer()}r(f.prototype,{featurePropertiesDirty:{get:function(){var e=this._contents;var t=e.length;for(var r=0;r<t;++r){if(e[r].featurePropertiesDirty){return true}}return false},set:function(e){var t=this._contents;var r=t.length;for(var i=0;i<r;++i){t[i].featurePropertiesDirty=e}}},featuresLength:{get:function(){return 0}},pointsLength:{get:function(){return 0}},vertexMemorySizeInBytes:{get:function(){return 0}},textureMemorySizeInBytes:{get:function(){return 0}},batchTableMemorySizeInBytes:{get:function(){return 0}},innerContents:{get:function(){return this._contents}},contentReadyToProcessPromise:{get:function(){return this._contentReadyToProcessPromise.promise}},readyPromise:{get:function(){return this._readyPromise.promise}}});f.prototype.hasProperty=function(e,t){return false};f.prototype.getFeature=function(e){return undefined};var h=Uint32Array.BYTES_PER_ELEMENT;f.prototype.request=function(){var e=this;var r=this._tile.distanceToCamera;var i=u.schedule(new s({url:this._url,server:this._tile.requestServer,requestFunction:o,type:l.TILES3D,distance:r}));if(!t(i)){return false}this.state=d.LOADING;i.then(function(t){if(e.isDestroyed()){return c.reject("tileset is destroyed")}e.initialize(t)}).otherwise(function(t){e.state=d.FAILED;e._readyPromise.reject(t)});return true};f.prototype.initialize=function(r,i){i=e(i,0);var o=new Uint8Array(r);var s=a(o,i);if(s!=="cmpt"){throw new n("Invalid Composite Tile. Expected magic=cmpt. Read magic="+s)}var u=new DataView(r);i+=h;var l=u.getUint32(i,true);if(l!==1){throw new n("Only Composite Tile version 1 is supported. Version "+l+" is not.")}i+=h;i+=h;var f=u.getUint32(i,true);i+=h;this.state=d.PROCESSING;this._contentReadyToProcessPromise.resolve(this);var p=[];for(var m=0;m<f;++m){var v=a(o,i);var _=u.getUint32(i+h*2,true);var g=this._factory[v];if(t(g)){var y=g(this._tileset,this._tile,this._url);y.initialize(r,i);this._contents.push(y);p.push(y.readyPromise)}else{throw new n("Unknown tile content type, "+v+", inside Composite tile")}i+=_}var w=this;c.all(p).then(function(){w.state=d.READY;w._readyPromise.resolve(w)}).otherwise(function(e){w.state=d.FAILED;w._readyPromise.reject(e)})};f.prototype.applyDebugSettings=function(e,t){var r=this._contents;var i=r.length;for(var n=0;n<i;++n){r[n].applyDebugSettings(e,t)}};f.prototype.update=function(e,t,r,i){var n=this._contents;var a=n.length;for(var o=0;o<a;++o){n[o].update(e,t,r,i)}};f.prototype.isDestroyed=function(){return false};f.prototype.destroy=function(){var e=this._contents;var t=e.length;for(var r=0;r<t;++r){e[r].destroy()}return i(this)};return f});define("Scene/Cesium3DTileFeatureTable",["../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/DeveloperError"],function(e,t,r,i){"use strict";function n(e,t){this.json=e;this.buffer=t;this._cachedArrayBufferViews={};this.featuresLength=0}n.prototype.getTypedArrayForSemantic=function(t,n,a,o,s){if(!r(n)){throw new i("byteOffset must be defined to read from binary data for semantic: "+t)}if(!r(a)){throw new i("componentType must be defined to read from binary data for semantic: "+t)}if(!r(o)){throw new i("count must be defined to read from binary data for semantic: "+t)}var u=this._cachedArrayBufferViews;var l=u[t];if(!r(l)){l=e.createArrayBufferView(a,this.buffer.buffer,this.buffer.byteOffset+n,o*s);u[t]=l}return l};n.prototype.getGlobalProperty=function(e,i,n){var a=this.json[e];if(r(a)){var o=a.byteOffset;if(r(o)){n=t(n,1);var s=this.getTypedArrayForSemantic(e,o,i,n,1);var u=s.subarray(0,n);if(u.length===1){return u[0]}return u}}return a};n.prototype.getPropertyArray=function(i,n,a){var o=this.json[i];if(r(o)){var s=o.byteOffset;if(r(s)){a=t(a,1);return this.getTypedArrayForSemantic(i,s,n,this.featuresLength,a)}return e.createTypedArray(n,o)}return o};n.prototype.getProperty=function(e,i,n,a){var o=this.json[e];if(r(o)){var s=o.byteOffset;if(r(s)){a=t(a,1);var u=this.getTypedArrayForSemantic(e,s,n,this.featuresLength,a);var l=u.subarray(i*a,i*a+a);if(l.length===1){return l[0]}return l}}if(Array.isArray(o)){var c=o.slice(i*a,i*a+a);if(c.length===1){return c[0]}return c}return o};return n});define("Scene/ModelInstance",["../Core/defineProperties","../Core/Matrix4"],function(e,t){"use strict";function r(e,r,i){this.primitive=e;this._modelMatrix=t.clone(r);this._instanceId=i}e(r.prototype,{instanceId:{get:function(){return this._instanceId}},model:{get:function(){return this.primitive._model}},modelMatrix:{get:function(){return t.clone(this._modelMatrix)},set:function(e){t.clone(e,this._modelMatrix);this.primitive.expandBoundingSphere(this._modelMatrix);this.primitive._dirty=true}}});return r});define("Scene/ModelInstanceCollection",["../Core/BoundingSphere","../Core/Cartesian3","../Core/Cartesian4","../Core/Cartographic","../Core/clone","../Core/Color","../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/Math","../Core/Matrix3","../Core/Matrix4","../Core/oneTimeWarning","../Core/PrimitiveType","../Core/Transforms","../Renderer/Buffer","../Renderer/BufferUsage","../Renderer/DrawCommand","../Renderer/ShaderSource","../ThirdParty/when","./getAttributeOrUniformBySemantic","./Model","./ModelInstance","./SceneMode","./ShadowMode"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w,C,b,S,E,T,x,A){"use strict";var P={NEEDS_LOAD:0,LOADING:1,LOADED:2,FAILED:3};function D(e){e=s(e,s.EMPTY_OBJECT);if(!u(e.gltf)&&!u(e.url)){throw new d("Either options.gltf or options.url is required.")}if(u(e.gltf)&&u(e.url)){throw new d("Cannot pass in both options.gltf and options.url.")}this.show=s(e.show,true);this._instancingSupported=false;this._dynamic=s(e.dynamic,false);this._allowPicking=s(e.allowPicking,true);this._cull=s(e.cull,true);this._ready=false;this._readyPromise=b.defer();this._state=P.NEEDS_LOAD;this._dirty=false;this._instances=M(this,e.instances);this._batchTable=e.batchTable;this._model=undefined;this._vertexBufferData=undefined;this._vertexBuffer=undefined;this._batchIdBuffer=undefined;this._instancedUniformsByProgram=undefined;this._drawCommands=[];this._pickCommands=[];this._modelCommands=undefined;this._boundingSphere=I(this);this._center=t.clone(this._boundingSphere.center);this._rtcTransform=new p;this._rtcModelView=new p;this._mode=undefined;this.modelMatrix=p.clone(p.IDENTITY);this._modelMatrix=p.clone(this.modelMatrix);this._url=e.url;this._headers=e.headers;this._requestType=e.requestType;this._gltf=e.gltf;this._basePath=e.basePath;this._asynchronous=e.asynchronous;this._incrementallyLoadTextures=e.incrementallyLoadTextures;this._upAxis=e.upAxis;this.shadows=s(e.shadows,A.ENABLED);this._shadows=this.shadows;this.debugShowBoundingVolume=s(e.debugShowBoundingVolume,false);this._debugShowBoundingVolume=false;this.debugWireframe=s(e.debugWireframe,false);this._debugWireframe=false}l(D.prototype,{allowPicking:{get:function(){return this._allowPicking}},length:{get:function(){return this._instances.length}},activeAnimations:{get:function(){return this._model.activeAnimations}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}}});function M(e,t){t=s(t,[]);var r=t.length;var i=new Array(r);for(var n=0;n<r;++n){var a=t[n];var o=a.modelMatrix;var u=s(a.batchId,n);i[n]=new T(e,o,u)}return i}function I(r){var i=r.length;var n=new Array(i);for(var a=0;a<i;++a){n[a]=p.getTranslation(r._instances[a]._modelMatrix,new t)}return e.fromPoints(n)}var O=new t;var R=new p;D.prototype.expandBoundingSphere=function(t){var r=p.getTranslation(t,O);e.expand(this._boundingSphere,r,this._boundingSphere)};function N(e,t){if(u(e._instancedUniformsByProgram)){return e._instancedUniformsByProgram[t]}var r={};e._instancedUniformsByProgram=r;var i=["MODEL","MODELVIEW","CESIUM_RTC_MODELVIEW","MODELVIEWPROJECTION","MODELINVERSE","MODELVIEWINVERSE","MODELVIEWPROJECTIONINVERSE","MODELINVERSETRANSPOSE","MODELVIEWINVERSETRANSPOSE"];var n=["MODELVIEW","CESIUM_RTC_MODELVIEW","MODELVIEWPROJECTION","MODELVIEWINVERSETRANSPOSE"];var a=e._model.gltf;var o=a.techniques;for(var s in o){if(o.hasOwnProperty(s)){var l=o[s];var c=l.parameters;var f=l.uniforms;var h=l.program;if(!u(r[h])){var p={};r[h]=p;for(var m in f){if(f.hasOwnProperty(m)){var v=f[m];var _=c[v];var g=_.semantic;if(u(g)&&i.indexOf(g)>-1){if(n.indexOf(g)>-1){p[m]=g}else{throw new d("Shader program cannot be optimized for instancing. "+'Parameter "'+_+'" in program "'+t+'" uses unsupported semantic "'+g+'"')}}}}}}}return r[t]}var L;function B(e){return function(t,r){var i=N(e,r);var n=u(e._batchTable);var a=C.replaceMain(t,"czm_instancing_main");var o="";var s="";for(var l in i){if(i.hasOwnProperty(l)){var c=i[l];var d;if(c==="MODELVIEW"||c==="CESIUM_RTC_MODELVIEW"){d="czm_instanced_modelView"}else if(c==="MODELVIEWPROJECTION"){d="czm_instanced_modelViewProjection";o+="mat4 czm_instanced_modelViewProjection;\n";s+="czm_instanced_modelViewProjection = czm_projection * czm_instanced_modelView;\n"}else if(c==="MODELVIEWINVERSETRANSPOSE"){d="czm_instanced_modelViewInverseTranspose";o+="mat3 czm_instanced_modelViewInverseTranspose;\n";s+="czm_instanced_modelViewInverseTranspose = mat3(czm_instanced_modelView);\n"}var f=new RegExp("uniform.*"+l+".*");a=a.replace(f,"");f=new RegExp(l+"\\b","g");a=a.replace(f,d)}}var h="uniform mat4 czm_instanced_modifiedModelView;\n"+"uniform mat4 czm_instanced_nodeTransform;\n";var p=n?"attribute float a_batchId;\n":"";var m=h+o+"mat4 czm_instanced_modelView;\n"+"attribute vec4 czm_modelMatrixRow0;\n"+"attribute vec4 czm_modelMatrixRow1;\n"+"attribute vec4 czm_modelMatrixRow2;\n"+p+a+"void main()\n"+"{\n"+"    mat4 czm_instanced_model = mat4(czm_modelMatrixRow0.x, czm_modelMatrixRow1.x, czm_modelMatrixRow2.x, 0.0, czm_modelMatrixRow0.y, czm_modelMatrixRow1.y, czm_modelMatrixRow2.y, 0.0, czm_modelMatrixRow0.z, czm_modelMatrixRow1.z, czm_modelMatrixRow2.z, 0.0, czm_modelMatrixRow0.w, czm_modelMatrixRow1.w, czm_modelMatrixRow2.w, 1.0);\n"+"    czm_instanced_modelView = czm_instanced_modifiedModelView * czm_instanced_model * czm_instanced_nodeTransform;\n"+s+"    czm_instancing_main();\n"+"}";L=m;if(n){m=e._batchTable.getVertexShaderCallback(true,"a_batchId")(m)}return m}}function F(e){return function(t){var r=e._batchTable;if(u(r)){var i=e._model.gltf;var n=S(i,"_3DTILESDIFFUSE");t=r.getFragmentShaderCallback(true,n)(t)}return t}}function k(e){return function(t){t=L;var r=u(e._batchTable);var i=e._allowPicking;if(r){t=e._batchTable.getPickVertexShaderCallback("a_batchId")(t)}else if(i){t=C.createPickVertexShaderSource(t)}return t}}function V(e){return function(t){var r=u(e._batchTable);var i=e._allowPicking;if(r){t=e._batchTable.getPickFragmentShaderCallback()(t)}else if(i){t=C.createPickFragmentShaderSource(t,"varying")}return t}}function z(e,t){return function(){return p.multiply(t.uniformState.view,e._rtcTransform,e._rtcModelView)}}function U(e){return function(){return e.computedMatrix}}function q(e,t){return function(r,i,a){r=n(r);r.czm_instanced_modifiedModelView=z(e,t);r.czm_instanced_nodeTransform=U(a);var o=N(e,i);for(var s in o){if(o.hasOwnProperty(s)){delete r[s]}}if(u(e._batchTable)){r=e._batchTable.getUniformMapCallback()(r)}return r}}function G(e){return function(t){if(u(e._batchTable)){t=e._batchTable.getPickUniformMapCallback()(t)}return t}}function H(e){return function(t){if(u(e._batchTable)){t=e._batchTable.getVertexShaderCallback(true,"a_batchId")(t);t="uniform float a_batchId\n;"+t}return t}}function W(e){return function(t){if(u(e._batchTable)){t=e._batchTable.getPickVertexShaderCallback("a_batchId")(t);t="uniform float a_batchId\n;"+t}return t}}function j(e){return function(t){var r=u(e._batchTable);var i=e._allowPicking;if(r){t=e._batchTable.getPickFragmentShaderCallback()(t)}else if(i){t=C.createPickFragmentShaderSource(t,"uniform")}return t}}function Y(e){return function(t){if(u(e._batchTable)){t=e._batchTable.getUniformMapCallback()(t)}return t}}function X(e,t){var r=e._instances;var i=e.length;var n=e._center;var a=12;var o=e._vertexBufferData;if(!u(o)){o=new Float32Array(i*a)}if(e._dynamic){e._vertexBufferData=o}for(var s=0;s<i;++s){var l=r[s]._modelMatrix;var c=p.clone(l,R);c[12]-=n.x;c[13]-=n.y;c[14]-=n.z;var d=s*a;o[d+0]=c[0];o[d+1]=c[4];o[d+2]=c[8];o[d+3]=c[12];o[d+4]=c[1];o[d+5]=c[5];o[d+6]=c[9];o[d+7]=c[13];o[d+8]=c[2];o[d+9]=c[6];o[d+10]=c[10];o[d+11]=c[14]}return o}function Z(e,t){var r;var i=e._instances;var n=e.length;var o=e._dynamic;var s=u(e._batchTable);var l=e._allowPicking;if(s){var c=new Uint16Array(n);for(r=0;r<n;++r){c[r]=i[r]._instanceId}e._batchIdBuffer=g.createVertexBuffer({context:t,typedArray:c,usage:y.STATIC_DRAW})}if(l&&!s){var d=new Uint8Array(n*4);for(r=0;r<n;++r){var f=e._pickIds[r];var h=f.color;var p=r*4;d[p]=a.floatToByte(h.red);d[p+1]=a.floatToByte(h.green);d[p+2]=a.floatToByte(h.blue);d[p+3]=a.floatToByte(h.alpha)}e._pickIdBuffer=g.createVertexBuffer({context:t,typedArray:d,usage:y.STATIC_DRAW})}var m=X(e,t);e._vertexBuffer=g.createVertexBuffer({context:t,typedArray:m,usage:o?y.STREAM_DRAW:y.STATIC_DRAW})}function K(e,t){var r=X(e,t);e._vertexBuffer.copyFromArrayView(r)}function Q(e,t){var r=e._instances;var i=r.length;var n=new Array(i);for(var a=0;a<i;++a){n[a]=t.createPickId(r[a])}return n}function J(e,t){var r=e._instancingSupported;var i=u(e._batchTable);var n=e._allowPicking;var a={url:e._url,headers:e._headers,requestType:e._requestType,gltf:e._gltf,basePath:e._basePath,shadows:e._shadows,cacheKey:undefined,asynchronous:e._asynchronous,allowPicking:n,incrementallyLoadTextures:e._incrementallyLoadTextures,upAxis:e._upAxis,
precreatedAttributes:undefined,vertexShaderLoaded:undefined,fragmentShaderLoaded:undefined,uniformMapLoaded:undefined,pickVertexShaderLoaded:undefined,pickFragmentShaderLoaded:undefined,pickUniformMapLoaded:undefined,ignoreCommands:true};if(n&&!i){e._pickIds=Q(e,t)}if(r){Z(e,t);var s=12;var l=o.getSizeInBytes(o.FLOAT);var c={czm_modelMatrixRow0:{index:0,vertexBuffer:e._vertexBuffer,componentsPerAttribute:4,componentDatatype:o.FLOAT,normalize:false,offsetInBytes:0,strideInBytes:l*s,instanceDivisor:1},czm_modelMatrixRow1:{index:0,vertexBuffer:e._vertexBuffer,componentsPerAttribute:4,componentDatatype:o.FLOAT,normalize:false,offsetInBytes:l*4,strideInBytes:l*s,instanceDivisor:1},czm_modelMatrixRow2:{index:0,vertexBuffer:e._vertexBuffer,componentsPerAttribute:4,componentDatatype:o.FLOAT,normalize:false,offsetInBytes:l*8,strideInBytes:l*s,instanceDivisor:1}};if(i){c.a_batchId={index:0,vertexBuffer:e._batchIdBuffer,componentsPerAttribute:1,componentDatatype:o.UNSIGNED_SHORT,normalize:false,offsetInBytes:0,strideInBytes:0,instanceDivisor:1}}if(n&&!i){c.pickColor={index:0,vertexBuffer:e._pickIdBuffer,componentsPerAttribute:4,componentDatatype:o.UNSIGNED_BYTE,normalize:true,offsetInBytes:0,strideInBytes:0,instanceDivisor:1}}a.precreatedAttributes=c;a.vertexShaderLoaded=B(e);a.fragmentShaderLoaded=F(e);a.uniformMapLoaded=q(e,t);a.pickVertexShaderLoaded=k(e);a.pickFragmentShaderLoaded=V(e);a.pickUniformMapLoaded=G(e);if(u(e._url)){a.cacheKey=e._url+"#instanced"}}else{a.vertexShaderLoaded=H(e);a.fragmentShaderLoaded=F(e);a.uniformMapLoaded=Y(e,t);a.pickVertexShaderLoaded=W(e);a.pickFragmentShaderLoaded=j(e);a.pickUniformMapLoaded=G(e)}if(u(e._url)){e._model=E.fromGltf(a)}else{e._model=new E(a)}}function $(e){if(e._debugWireframe!==e.debugWireframe){e._debugWireframe=e.debugWireframe;var t=e.debugWireframe?v.LINES:v.TRIANGLES;var r=e._drawCommands;var i=r.length;for(var n=0;n<i;++n){r[n].primitiveType=t}}}function ee(e){if(e.debugShowBoundingVolume!==e._debugShowBoundingVolume){e._debugShowBoundingVolume=e.debugShowBoundingVolume;var t=e._drawCommands;var r=t.length;for(var i=0;i<r;++i){t[i].debugShowBoundingVolume=e.debugShowBoundingVolume}}}function te(e,t,r){var i=t.length;var n=e.length;var a=e.allowPicking;var o=e._boundingSphere;var s=e._cull;for(var u=0;u<i;++u){var l=w.shallowClone(t[u]);l.instanceCount=n;l.boundingVolume=o;l.cull=s;e._drawCommands.push(l);if(a){var c=w.shallowClone(r[u]);c.instanceCount=n;c.boundingVolume=o;c.cull=s;e._pickCommands.push(c)}}}function re(e){return function(){return e}}function ie(e){return function(){return e}}function ne(t,r,i){var a=t._instances;var o=r.length;var s=t.length;var l=t.allowPicking;var c=u(t._batchTable);var d=t._cull;for(var f=0;f<o;++f){for(var h=0;h<s;++h){var m=w.shallowClone(r[f]);m.modelMatrix=new p;m.boundingVolume=new e;m.cull=d;m.uniformMap=n(m.uniformMap);if(c){m.uniformMap.a_batchId=re(a[h]._instanceId)}t._drawCommands.push(m);if(l){var v=w.shallowClone(i[f]);v.modelMatrix=new p;v.boundingVolume=new e;v.cull=d;v.uniformMap=n(v.uniformMap);if(c){v.uniformMap.a_batchId=re(a[h]._instanceId)}else if(l){var _=t._pickIds[h];v.uniformMap.czm_pickColor=ie(_.color)}t._pickCommands.push(v)}}}}function ae(t){var r=t._modelCommands;var i=r.length;var n=t.length;var a=t.allowPicking;var o=t._rtcTransform;var s=t._center;for(var u=0;u<i;++u){var l=r[u];for(var c=0;c<n;++c){var d=u*n+c;var f=t._drawCommands[d];var h=p.clone(t._instances[c]._modelMatrix,R);h[12]-=s.x;h[13]-=s.y;h[14]-=s.z;h=p.multiply(o,h,R);var m=l.modelMatrix;var v=f.modelMatrix;p.multiply(h,m,v);var _=l.boundingVolume;var g=f.boundingVolume;e.transform(_,h,g);if(a){var y=t._pickCommands[d];p.clone(v,y.modelMatrix);e.clone(g,y.boundingVolume)}}}}function oe(e){var t=e._nodeCommands;var r=t.length;var i=[];var n=[];for(var a=0;a<r;++a){var o=t[a];if(o.show){i.push(o.command);n.push(o.pickCommand)}}return{draw:i,pick:n}}function se(e){if(e.shadows!==e._shadows){e._shadows=e.shadows;var t=A.castShadows(e.shadows);var r=A.receiveShadows(e.shadows);var i=e._drawCommands;var n=i.length;for(var a=0;a<n;++a){var o=i[a];o.castShadows=t;o.receiveShadows=r}}}D.prototype.update=function(e){if(!this.show){return}if(this.length===0){return}var r=e.context;if(this._state===P.NEEDS_LOAD){this._state=P.LOADING;this._instancingSupported=r.instancedArrays;J(this,r);var i=this;this._model.readyPromise.otherwise(function(e){i._state=P.FAILED;i._readyPromise.reject(e)})}var n=this._instancingSupported;var a=this._model;a.update(e);if(a.ready&&this._state===P.LOADING){this._state=P.LOADED;this._ready=true;var o=a.boundingSphere.radius+t.magnitude(a.boundingSphere.center);this._boundingSphere.radius+=o;var s=oe(a);this._modelCommands=s.draw;if(n){te(this,s.draw,s.pick)}else{ne(this,s.draw,s.pick);ae(this)}this._readyPromise.resolve(this);return}if(this._state!==P.LOADED){return}var u=e.mode!==this._mode;var l=this.modelMatrix;var c=!p.equals(this._modelMatrix,l);if(u||c){this._mode=e.mode;p.clone(l,this._modelMatrix);var d=p.multiplyByTranslation(this._modelMatrix,this._center,this._rtcTransform);if(this._mode!==x.SCENE3D){d=_.basisTo2D(e.mapProjection,d,d)}p.getTranslation(d,this._boundingSphere.center)}if(n&&this._dirty){this._dynamic=true;this._dirty=false;K(this,r)}if(!n&&(a.dirty||this._dirty||u||c)){ae(this)}se(this);$(this);ee(this);var f=e.passes;var h=f.render?this._drawCommands:this._pickCommands;var m=h.length;for(var v=0;v<m;++v){e.addCommand(h[v])}};D.prototype.isDestroyed=function(){return false};D.prototype.destroy=function(){this._model=this._model&&this._model.destroy();var e=this._pickIds;if(u(e)){var t=e.length;for(var r=0;r<t;++r){e[r].destroy()}}return c(this)};return D});define("Scene/Instanced3DModel3DTileContent",["../Core/AttributeCompression","../Core/Cartesian2","../Core/Cartesian3","../Core/Color","../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/Ellipsoid","../Core/getAbsoluteUri","../Core/getBaseUri","../Core/getMagic","../Core/getStringFromTypedArray","../Core/joinUrls","../Core/loadArrayBuffer","../Core/Math","../Core/Matrix3","../Core/Matrix4","../Core/Quaternion","../Core/Request","../Core/RequestScheduler","../Core/RequestType","../Core/Transforms","../Core/TranslationRotationScale","../ThirdParty/Uri","../ThirdParty/when","./Cesium3DTileBatchTable","./Cesium3DTileContentState","./Cesium3DTileFeature","./Cesium3DTileFeatureTable","./ModelInstanceCollection"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w,C,b,S,E,T,x,A,P,D,M,I,O){"use strict";function R(e,t,r){this._modelInstanceCollection=undefined;this._url=r;this._tileset=e;this._tile=t;this.state=D.UNLOADED;this.batchTable=undefined;this.featurePropertiesDirty=false;this._contentReadyToProcessPromise=A.defer();this._readyPromise=A.defer();this._features=undefined}s(R.prototype,{featuresLength:{get:function(){if(o(this._modelInstanceCollection)){return this._modelInstanceCollection.length}else{return 0}}},pointsLength:{get:function(){return 0}},vertexMemorySizeInBytes:{get:function(){var e=this._modelInstanceCollection;if(o(e)&&o(e._model)){return e._model.vertexMemorySizeInBytes}return 0}},textureMemorySizeInBytes:{get:function(){var e=this._modelInstanceCollection;if(o(e)&&o(e._model)){return e._model.textureMemorySizeInBytes}return 0}},batchTableMemorySizeInBytes:{get:function(){if(o(this.batchTable)){return this.batchTable.memorySizeInBytes}return 0}},innerContents:{get:function(){return undefined}},contentReadyToProcessPromise:{get:function(){return this._contentReadyToProcessPromise.promise}},readyPromise:{get:function(){return this._readyPromise.promise}}});function N(e){var t=e._tileset;var r=e.featuresLength;if(!o(e._features)&&r>0){var i=new Array(r);for(var n=0;n<r;++n){i[n]=new M(t,e,n)}e._features=i}}R.prototype.hasProperty=function(e,t){return this.batchTable.hasProperty(e,t)};R.prototype.getFeature=function(e){var t=this.featuresLength;if(!o(e)||e<0||e>=t){throw new l("batchId is required and between zero and featuresLength - 1 ("+(t-1)+").")}N(this);return this._features[e]};var L=Uint32Array.BYTES_PER_ELEMENT;R.prototype.request=function(){var e=this;var t=this._tile.distanceToCamera;var r=b.schedule(new C({url:this._url,server:this._tile.requestServer,requestFunction:v,type:S.TILES3D,distance:t}));if(!o(r)){return false}this.state=D.LOADING;r.then(function(t){if(e.isDestroyed()){return A.reject("tileset is destroyed")}e.initialize(t)}).otherwise(function(t){e.state=D.FAILED;e._readyPromise.reject(t)});return true};R.prototype.initialize=function(t,i){var s=a(i,0);i=a(i,0);var u=new Uint8Array(t);var v=h(u,i);if(v!=="i3dm"){throw new l("Invalid Instanced 3D Model. Expected magic=i3dm. Read magic="+v)}var _=new DataView(t);i+=L;var C=_.getUint32(i,true);if(C!==1){throw new l("Only Instanced 3D Model version 1 is supported. Version "+C+" is not.")}i+=L;var b=_.getUint32(i,true);i+=L;var x=_.getUint32(i,true);if(x===0){throw new l("featureTableJsonByteLength is zero, the feature table must be defined.")}i+=L;var A=_.getUint32(i,true);i+=L;var M=_.getUint32(i,true);i+=L;var R=_.getUint32(i,true);i+=L;var N=_.getUint32(i,true);if(N!==1&&N!==0){throw new l("Only glTF format 0 (uri) or 1 (embedded) are supported. Format "+N+" is not.")}i+=L;var B=p(u,i,x);var F=JSON.parse(B);i+=x;var k=new Uint8Array(t,i,A);i+=A;var V=new I(F,k);var z=V.getGlobalProperty("INSTANCES_LENGTH",n.UNSIGNED_INT);V.featuresLength=z;if(!o(z)){throw new l("Feature table global property: INSTANCES_LENGTH must be defined")}var U;var q;if(M>0){var G=p(u,i,M);U=JSON.parse(G);i+=M;if(R>0){q=new Uint8Array(t,i,R);q=new Uint8Array(q);i+=R}}this.batchTable=new P(this,z,U,q);var H=s+b-i;if(H===0){throw new l("glTF byte length is zero, i3dm must have a glTF to instance.")}var W=new Uint8Array(t,i,H);i+=H;var j={instances:new Array(z),batchTable:this.batchTable,cull:false,url:undefined,requestType:S.TILES3D,gltf:undefined,basePath:undefined,incrementallyLoadTextures:false,upAxis:this._tileset._gltfUpAxis};if(N===0){var Y=p(W);j.url=d(m(f(this._url,true),Y))}else{j.gltf=W;j.basePath=f(this._url,true)}var X=V.getGlobalProperty("EAST_NORTH_UP");var Z;var K=V.getGlobalProperty("RTC_CENTER");if(o(K)){Z=r.unpack(K)}var Q=j.instances;var J=new r;var $=new Array(3);var ee=new r;var te=new r;var re=new r;var ie=new g;var ne=new w;var ae=new r;var oe=new T;var se=new y;for(var ue=0;ue<z;ue++){var le=V.getProperty("POSITION",ue,n.FLOAT,3);if(!o(le)){le=$;var ce=V.getProperty("POSITION_QUANTIZED",ue,n.UNSIGNED_SHORT,3);if(!o(ce)){throw new l("Either POSITION or POSITION_QUANTIZED must be defined for each instance.")}var de=V.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",n.FLOAT,3);if(!o(de)){throw new l("Global property: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.")}var fe=V.getGlobalProperty("QUANTIZED_VOLUME_SCALE",n.FLOAT,3);if(!o(fe)){throw new l("Global property: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.")}for(var he=0;he<3;he++){le[he]=ce[he]/65535*fe[he]+de[he]}}r.unpack(le,0,J);if(o(Z)){r.add(J,Z,J)}oe.translation=J;var pe=V.getProperty("NORMAL_UP",ue,n.FLOAT,3);var me=V.getProperty("NORMAL_RIGHT",ue,n.FLOAT,3);var ve=false;if(o(pe)){if(!o(me)){throw new l("To define a custom orientation, both NORMAL_UP and NORMAL_RIGHT must be defined.")}r.unpack(pe,0,te);r.unpack(me,0,ee);ve=true}else{var _e=V.getProperty("NORMAL_UP_OCT32P",ue,n.UNSIGNED_SHORT,2);var ge=V.getProperty("NORMAL_RIGHT_OCT32P",ue,n.UNSIGNED_SHORT,2);if(o(_e)){if(!o(ge)){throw new l("To define a custom orientation with oct-encoded vectors, both NORMAL_UP_OCT32P and NORMAL_RIGHT_OCT32P must be defined.")}e.octDecodeInRange(_e[0],_e[1],65535,te);e.octDecodeInRange(ge[0],ge[1],65535,ee);ve=true}else if(X){E.eastNorthUpToFixedFrame(J,c.WGS84,se);y.getRotation(se,ie)}else{g.clone(g.IDENTITY,ie)}}if(ve){r.cross(ee,te,re);r.normalize(re,re);g.setColumn(ie,0,ee,ie);g.setColumn(ie,1,te,ie);g.setColumn(ie,2,re,ie)}w.fromRotationMatrix(ie,ne);oe.rotation=ne;ae.x=1;ae.y=1;ae.z=1;var ye=V.getProperty("SCALE",ue,n.FLOAT,1);if(o(ye)){r.multiplyByScalar(ae,ye,ae)}var we=V.getProperty("SCALE_NON_UNIFORM",ue,n.FLOAT,3);if(o(we)){ae.x*=we[0];ae.y*=we[1];ae.z*=we[2]}oe.scale=ae;var Ce;if(o(V.json.BATCH_ID)){var be=V.json.BATCH_ID.componentType;var Se=o(be)?n.fromName(be):n.UNSIGNED_SHORT;Ce=V.getProperty("BATCH_ID",ue,Se,1)}else{Ce=ue}y.fromTranslationRotationScale(oe,se);var Ee=se.clone();Q[ue]={modelMatrix:Ee,batchId:Ce}}var Te=new O(j);this._modelInstanceCollection=Te;this.state=D.PROCESSING;this._contentReadyToProcessPromise.resolve(this);var xe=this;Te.readyPromise.then(function(e){xe.state=D.READY;xe._readyPromise.resolve(xe)}).otherwise(function(e){xe.state=D.FAILED;xe._readyPromise.reject(e)})};R.prototype.applyDebugSettings=function(e,t){t=e?t:i.WHITE;this.batchTable.setAllColor(t)};R.prototype.applyStyleWithShader=function(e,t){return false};R.prototype.update=function(e,t){var r=t.addCommand;if(t.passes.render){t.addCommand=this.batchTable.getAddCommand()}this.batchTable.update(e,t);this._modelInstanceCollection.modelMatrix=this._tile.computedTransform;this._modelInstanceCollection.shadows=this._tileset.shadows;this._modelInstanceCollection.debugWireframe=this._tileset.debugWireframe;this._modelInstanceCollection.update(t);t.addCommand=r};R.prototype.isDestroyed=function(){return false};R.prototype.destroy=function(){this._modelInstanceCollection=this._modelInstanceCollection&&this._modelInstanceCollection.destroy();this.batchTable=this.batchTable&&this.batchTable.destroy();return u(this)};return R});define("Scene/PointCloud3DTileContent",["../Core/Cartesian3","../Core/Cartesian4","../Core/Color","../Core/combine","../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/getMagic","../Core/getStringFromTypedArray","../Core/loadArrayBuffer","../Core/Matrix3","../Core/Matrix4","../Core/oneTimeWarning","../Core/PrimitiveType","../Core/Request","../Core/RequestScheduler","../Core/RequestType","../Core/Transforms","../Core/WebGLConstants","../Renderer/Buffer","../Renderer/BufferUsage","../Renderer/DrawCommand","../Renderer/Pass","../Renderer/RenderState","../Renderer/ShaderProgram","../Renderer/ShaderSource","../Renderer/VertexArray","../ThirdParty/when","./BlendingState","./Cesium3DTileBatchTable","./Cesium3DTileColorBlendMode","./Cesium3DTileContentState","./Cesium3DTileFeature","./Cesium3DTileFeatureTable","./SceneMode"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w,C,b,S,E,T,x,A,P,D,M,I,O,R,N,L,B,F){"use strict";function k(e,t,i){this._url=i;this._tileset=e;this._tile=t;this._parsedContent=undefined;this._drawCommand=undefined;this._pickCommand=undefined;this._pickId=undefined;this._isTranslucent=false;this._styleTranslucent=false;this._constantColor=r.clone(r.WHITE);this._rtcCenter=undefined;this._styleableShaderAttributes=undefined;this._isQuantized=false;this._isOctEncoded16P=false;this._isRGB565=false;this._hasColors=false;this._hasNormals=false;this._hasBatchIds=false;this.backFaceCulling=false;this._backFaceCulling=false;this._opaqueRenderState=undefined;this._translucentRenderState=undefined;this._highlightColor=r.clone(r.WHITE);this._pointSize=1;this._quantizedVolumeScale=undefined;this._quantizedVolumeOffset=undefined;this._mode=undefined;this.state=N.UNLOADED;this.batchTable=undefined;this.featurePropertiesDirty=false;this._contentReadyToProcessPromise=M.defer();this._readyPromise=M.defer();this._features=undefined;this._pointsLength=0;this._vertexMemorySizeInBytes=0}s(k.prototype,{featuresLength:{get:function(){if(o(this.batchTable)){return this.batchTable.featuresLength}return 0}},pointsLength:{get:function(){return this._pointsLength}},vertexMemorySizeInBytes:{get:function(){return this._vertexMemorySizeInBytes}},textureMemorySizeInBytes:{get:function(){return 0}},batchTableMemorySizeInBytes:{get:function(){if(o(this.batchTable)){return this.batchTable.memorySizeInBytes}return 0}},innerContents:{get:function(){return undefined}},contentReadyToProcessPromise:{get:function(){return this._contentReadyToProcessPromise.promise}},readyPromise:{get:function(){return this._readyPromise.promise}}});function V(e){var t=e._tileset;var r=e.featuresLength;if(!o(e._features)&&r>0){var i=new Array(r);for(var n=0;n<r;++n){i[n]=new L(t,e,n)}e._features=i}}k.prototype.hasProperty=function(e,t){if(o(this.batchTable)){return this.batchTable.hasProperty(e,t)}return false};k.prototype.getFeature=function(e){if(o(this.batchTable)){var t=this.featuresLength;if(!o(e)||e<0||e>=t){throw new l("batchId is required and between zero and featuresLength - 1 ("+(t-1)+").")}V(this);return this._features[e]}return undefined};var z=Uint32Array.BYTES_PER_ELEMENT;k.prototype.request=function(){var e=this;var t=this._tile.distanceToCamera;var r=g.schedule(new _({url:this._url,server:this._tile.requestServer,requestFunction:f,type:y.TILES3D,distance:t}));if(!o(r)){return false}this.state=N.LOADING;r.then(function(t){if(e.isDestroyed()){return M.reject("tileset is destroyed")}e.initialize(t)}).otherwise(function(t){e.state=N.FAILED;e._readyPromise.reject(t)});return true};k.prototype.initialize=function(t,i){i=a(i,0);var s=new Uint8Array(t);var u=c(s,i);if(u!=="pnts"){throw new l("Invalid Points tile.  Expected magic=pnts.  Read magic="+u)}var f=new DataView(t);i+=z;var h=f.getUint32(i,true);if(h!==1){throw new l("Only Points tile version 1 is supported.  Version "+h+" is not.")}i+=z;i+=z;var p=f.getUint32(i,true);if(p===0){throw new l("Feature table must have a byte length greater than zero")}i+=z;var v=f.getUint32(i,true);i+=z;var _=f.getUint32(i,true);i+=z;var g=f.getUint32(i,true);i+=z;var y=d(s,i,p);var w=JSON.parse(y);i+=p;var C=new Uint8Array(t,i,v);i+=v;var b;var S;if(_>0){var E=d(s,i,_);b=JSON.parse(E);i+=_;if(g>0){S=new Uint8Array(t,i,g);i+=g}}var T=new B(w,C);var x=T.getGlobalProperty("POINTS_LENGTH");T.featuresLength=x;if(!o(x)){throw new l("Feature table global property: POINTS_LENGTH must be defined")}var A;var P=false;if(o(w.POSITION)){A=T.getPropertyArray("POSITION",n.FLOAT,3);var D=T.getGlobalProperty("RTC_CENTER");if(o(D)){this._rtcCenter=e.unpack(D)}}else if(o(w.POSITION_QUANTIZED)){A=T.getPropertyArray("POSITION_QUANTIZED",n.UNSIGNED_SHORT,3);P=true;var M=T.getGlobalProperty("QUANTIZED_VOLUME_SCALE");if(!o(M)){throw new l("Global property: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.")}this._quantizedVolumeScale=e.unpack(M);var I=T.getGlobalProperty("QUANTIZED_VOLUME_OFFSET");if(!o(I)){throw new l("Global property: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.")}this._quantizedVolumeOffset=e.unpack(I)}if(!o(A)){throw new l("Either POSITION or POSITION_QUANTIZED must be defined.")}var R;var L=false;var F=false;if(o(w.RGBA)){R=T.getPropertyArray("RGBA",n.UNSIGNED_BYTE,4);L=true}else if(o(w.RGB)){R=T.getPropertyArray("RGB",n.UNSIGNED_BYTE,3)}else if(o(w.RGB565)){R=T.getPropertyArray("RGB565",n.UNSIGNED_SHORT,1);F=true}else if(o(w.CONSTANT_RGBA)){var k=T.getGlobalProperty("CONSTANT_RGBA");this._constantColor=r.fromBytes(k[0],k[1],k[2],k[3],this._constantColor)}else{this._constantColor=r.clone(r.DARKGRAY,this._constantColor)}this._isTranslucent=L;var V;var U=false;if(o(w.NORMAL)){V=T.getPropertyArray("NORMAL",n.FLOAT,3)}else if(o(w.NORMAL_OCT16P)){V=T.getPropertyArray("NORMAL_OCT16P",n.UNSIGNED_BYTE,2);U=true}var q;if(o(w.BATCH_ID)){var G;var H=w.BATCH_ID.componentType;if(o(H)){G=n.fromName(H)}else{G=n.UNSIGNED_SHORT}q=T.getPropertyArray("BATCH_ID",G,1);var W=T.getGlobalProperty("BATCH_LENGTH");if(!o(W)){throw new l("Global property: BATCH_LENGTH must be defined when BATCH_ID is defined.")}if(o(S)){S=new Uint8Array(S)}this.batchTable=new O(this,W,b,S)}var j;if(!o(q)&&o(S)){j=O.getBinaryProperties(x,b,S);for(var Y in j){if(j.hasOwnProperty(Y)){var X=j[Y];var Z=X.typedArray;var K=n.fromTypedArray(Z);if(K===n.INT||K===n.UNSIGNED_INT||K===n.DOUBLE){m("Cast pnts property to floats",'Point cloud property "'+Y+'" will be casted to a float array because INT, UNSIGNED_INT, and DOUBLE are not valid WebGL vertex attribute types. Some precision may be lost.');X.typedArray=new Float32Array(Z)}}}}this._parsedContent={positions:A,colors:R,normals:V,batchIds:q,styleableProperties:j};this._pointsLength=x;this._isQuantized=P;this._isOctEncoded16P=U;this._isRGB565=F;this._hasColors=o(R);this._hasNormals=o(V);this._hasBatchIds=o(q);this.state=N.PROCESSING;this._contentReadyToProcessPromise.resolve(this)};var U=0;var q=1;var G=2;var H=3;var W=4;function j(e,t){var r=t.context;var a=e._parsedContent;var s=e._pointsLength;var u=a.positions;var l=a.colors;var c=a.normals;var d=a.batchIds;var f=a.styleableProperties;var h=o(f);var m=e._isQuantized;var _=e._isOctEncoded16P;var g=e._isRGB565;var y=e._isTranslucent;var w=e._hasColors;var C=e._hasNormals;var A=e._hasBatchIds;var P=e.batchTable;var M=o(P);var O=[];var R={};e._styleableShaderAttributes=R;if(h){var N=W;for(var L in f){if(f.hasOwnProperty(L)){var B=f[L];var F=B.typedArray;var k=B.componentCount;var V=n.fromTypedArray(F);var z=b.createVertexBuffer({context:r,typedArray:B.typedArray,usage:S.STATIC_DRAW});e._vertexMemorySizeInBytes+=z.sizeInBytes;var j={index:N,vertexBuffer:z,componentsPerAttribute:k,componentDatatype:V,normalize:false,offsetInBytes:0,strideInBytes:0};O.push(j);R[L]={location:N,componentCount:k};++N}}}var Y={u_pointSize:function(){return e._pointSize},u_highlightColor:function(){return e._highlightColor},u_constantColor:function(){return e._constantColor},u_tilesetTime:function(){return e._tileset.timeSinceLoad}};if(m){Y=i(Y,{u_quantizedVolumeScale:function(){return e._quantizedVolumeScale}})}var X=b.createVertexBuffer({context:r,typedArray:u,usage:S.STATIC_DRAW});e._vertexMemorySizeInBytes+=X.sizeInBytes;var Z;if(w){Z=b.createVertexBuffer({context:r,typedArray:l,usage:S.STATIC_DRAW});e._vertexMemorySizeInBytes+=Z.sizeInBytes}var K;if(C){K=b.createVertexBuffer({context:r,typedArray:c,usage:S.STATIC_DRAW});e._vertexMemorySizeInBytes+=K.sizeInBytes}var Q;if(A){Q=b.createVertexBuffer({context:r,typedArray:d,usage:S.STATIC_DRAW});e._vertexMemorySizeInBytes+=Q.sizeInBytes}var J=[];if(m){J.push({index:U,vertexBuffer:X,componentsPerAttribute:3,componentDatatype:n.UNSIGNED_SHORT,normalize:true,offsetInBytes:0,strideInBytes:0})}else{J.push({index:U,vertexBuffer:X,componentsPerAttribute:3,componentDatatype:n.FLOAT,normalize:false,offsetInBytes:0,strideInBytes:0})}if(w){if(g){J.push({index:q,vertexBuffer:Z,componentsPerAttribute:1,componentDatatype:n.UNSIGNED_SHORT,normalize:false,offsetInBytes:0,strideInBytes:0})}else{var $=y?4:3;J.push({index:q,vertexBuffer:Z,componentsPerAttribute:$,componentDatatype:n.UNSIGNED_BYTE,normalize:true,offsetInBytes:0,strideInBytes:0})}}if(C){if(_){J.push({index:G,vertexBuffer:K,componentsPerAttribute:2,componentDatatype:n.UNSIGNED_BYTE,normalize:false,offsetInBytes:0,strideInBytes:0})}else{J.push({index:G,vertexBuffer:K,componentsPerAttribute:3,componentDatatype:n.FLOAT,normalize:false,offsetInBytes:0,strideInBytes:0})}}if(A){J.push({index:H,vertexBuffer:Q,componentsPerAttribute:1,componentDatatype:n.fromTypedArray(d),normalize:false,offsetInBytes:0,strideInBytes:0})}if(h){J=J.concat(O)}var ee=new D({context:r,attributes:J});var te=Y;if(M){te=P.getUniformMapCallback()(Y)}var re;if(M){re=P.getPickUniformMapCallback()(Y)}else{e._pickId=r.createPickId({primitive:e._tileset,content:e});re=i(Y,{czm_pickColor:function(){return e._pickId.color}})}e._opaqueRenderState=x.fromCache({depthTest:{enabled:true}});e._translucentRenderState=x.fromCache({depthTest:{enabled:true},depthMask:false,blending:I.ALPHA_BLEND});e._drawCommand=new E({boundingVolume:e._tile.contentBoundingVolume.boundingSphere,cull:false,modelMatrix:new p,primitiveType:v.POINTS,vertexArray:ee,count:s,shaderProgram:undefined,uniformMap:te,renderState:y?e._translucentRenderState:e._opaqueRenderState,pass:y?T.TRANSLUCENT:T.OPAQUE,owner:e});e._pickCommand=new E({boundingVolume:e._tile.contentBoundingVolume.boundingSphere,cull:false,modelMatrix:new p,primitiveType:v.POINTS,vertexArray:ee,count:s,shaderProgram:undefined,uniformMap:re,renderState:y?e._translucentRenderState:e._opaqueRenderState,pass:y?T.TRANSLUCENT:T.OPAQUE,owner:e})}var Y=["POSITION","COLOR","NORMAL"];function X(e,t){var r=/czm_tiles3d_style_(\w+)/g;var i=r.exec(e);while(i!==null){var n=i[1];if(Y.indexOf(n)===-1&&t.indexOf(n)===-1){t.push(n)}i=r.exec(e)}}function Z(e,t){var r=Y.length;for(var i=0;i<r;++i){var n=Y[i];var a="czm_tiles3d_style_"+n;if(e.indexOf(a)>=0){t.push(n)}}}function K(e,t){var r=e.numberOfAttributes;for(var i=0;i<r;++i){var n=e.getAttribute(i);if(n.index===t){return n}}}function Q(e){var t=Y.length;for(var r=0;r<t;++r){var i=Y[r];var n="czm_tiles3d_style_"+i;var a=i.toLowerCase();e=e.replace(new RegExp(n,"g"),a)}return e.replace("()","(vec3 position, vec4 color, vec3 normal)")}function J(e,t,r){var i;var n;var a;var s=t.context;var u=e.batchTable;var c=o(u);var d=o(r);var f=e._isQuantized;var h=e._isOctEncoded16P;var p=e._isRGB565;var m=e._isTranslucent;var v=e._hasColors;var _=e._hasNormals;var g=e._hasBatchIds;var y=e._backFaceCulling;var w=e._drawCommand.vertexArray;var C;var b;var S;var E=m;if(c){d=false}if(d){var T={translucent:false};C=r.getColorShaderFunction("getColorFromStyle","czm_tiles3d_style_",T);b=r.getShowShaderFunction("getShowFromStyle","czm_tiles3d_style_",T);S=r.getPointSizeShaderFunction("getPointSizeFromStyle","czm_tiles3d_style_",T);if(o(C)&&T.translucent){E=true}}e._styleTranslucent=E;var x=o(C);var D=o(b);var M=o(S);var I=[];var O=[];if(x){X(C,I);Z(C,O);C=Q(C)}if(D){X(b,I);Z(b,O);b=Q(b)}if(M){X(S,I);Z(S,O);S=Q(S)}var R=O.indexOf("COLOR")>=0;var N=O.indexOf("NORMAL")>=0;if(N&&!_){throw new l("Style references the NORMAL semantic but the point cloud does not have normals")}var L=e._styleableShaderAttributes;for(n in L){if(L.hasOwnProperty(n)){a=L[n];var B=I.indexOf(n)>=0;var F=K(w,a.location);F.enabled=B}}var k=v&&(!x||R);if(v){var V=K(w,q);V.enabled=k}var z={a_position:U};if(k){z.a_color=q}if(_){z.a_normal=G}if(g){z.a_batchId=H}var W="";var j=I.length;for(i=0;i<j;++i){n=I[i];a=L[n];if(!o(a)){throw new l('Style references a property "'+n+'" that does not exist or is not styleable.')}var Y=a.componentCount;var $="czm_tiles3d_style_"+n;var ee;if(Y===1){ee="float"}else{ee="vec"+Y}W+="attribute "+ee+" "+$+"; \n";z[$]=a.location}var te="attribute vec3 a_position; \n"+"varying vec4 v_color; \n"+"uniform float u_pointSize; \n"+"uniform vec4 u_constantColor; \n"+"uniform vec4 u_highlightColor; \n"+"uniform float u_tilesetTime; \n";te+=W;if(k){if(m){te+="attribute vec4 a_color; \n"}else if(p){te+="attribute float a_color; \n"+"const float SHIFT_RIGHT_11 = 1.0 / 2048.0; \n"+"const float SHIFT_RIGHT_5 = 1.0 / 32.0; \n"+"const float SHIFT_LEFT_11 = 2048.0; \n"+"const float SHIFT_LEFT_5 = 32.0; \n"+"const float NORMALIZE_6 = 1.0 / 64.0; \n"+"const float NORMALIZE_5 = 1.0 / 32.0; \n"}else{te+="attribute vec3 a_color; \n"}}if(_){if(h){te+="attribute vec2 a_normal; \n"}else{te+="attribute vec3 a_normal; \n"}}if(g){te+="attribute float a_batchId; \n"}if(f){te+="uniform vec3 u_quantizedVolumeScale; \n"}if(x){te+=C}if(D){te+=b}if(M){te+=S}te+="void main() \n"+"{ \n";if(k){if(m){te+="    vec4 color = a_color; \n"}else if(p){te+="    float compressed = a_color; \n"+"    float r = floor(compressed * SHIFT_RIGHT_11); \n"+"    compressed -= r * SHIFT_LEFT_11; \n"+"    float g = floor(compressed * SHIFT_RIGHT_5); \n"+"    compressed -= g * SHIFT_LEFT_5; \n"+"    float b = compressed; \n"+"    vec3 rgb = vec3(r * NORMALIZE_5, g * NORMALIZE_6, b * NORMALIZE_5); \n"+"    vec4 color = vec4(rgb, 1.0); \n"}else{te+="    vec4 color = vec4(a_color, 1.0); \n"}}else{te+="    vec4 color = u_constantColor; \n"}if(f){te+="    vec3 position = a_position * u_quantizedVolumeScale; \n"}else{te+="    vec3 position = a_position; \n"}if(_){if(h){te+="    vec3 normal = czm_octDecode(a_normal); \n"}else{te+="    vec3 normal = a_normal; \n"}}else{te+="    vec3 normal = vec3(1.0); \n"}if(x){te+="    color = getColorFromStyle(position, color, normal); \n"}if(D){te+="    float show = float(getShowFromStyle(position, color, normal)); \n"}if(M){te+="    gl_PointSize = getPointSizeFromStyle(position, color, normal); \n"}else{te+="    gl_PointSize = u_pointSize; \n"}te+="    color = color * u_highlightColor; \n";if(_){te+="    normal = czm_normal * normal; \n"+"    float diffuseStrength = czm_getLambertDiffuse(czm_sunDirectionEC, normal); \n"+"    diffuseStrength = max(diffuseStrength, 0.4); \n"+"    color *= diffuseStrength; \n"}te+="    v_color = color; \n"+"    gl_Position = czm_modelViewProjection * vec4(position, 1.0); \n";if(_&&y){te+="    float visible = step(-normal.z, 0.0); \n"+"    gl_Position *= visible; \n"}if(D){te+="    gl_Position *= show; \n"}te+="} \n";var re="varying vec4 v_color; \n"+"void main() \n"+"{ \n"+"    gl_FragColor = v_color; \n"+"} \n";var ie=te;var ne=re;if(c){ie=u.getVertexShaderCallback(false,"a_batchId")(ie);ne=u.getFragmentShaderCallback(false,undefined)(ne)}var ae=te;var oe=re;if(c){ae=u.getPickVertexShaderCallback("a_batchId")(ae);oe=u.getPickFragmentShaderCallback()(oe)}else{oe=P.createPickFragmentShaderSource(oe,"uniform")}var se=e._drawCommand;if(o(se.shaderProgram)){se.shaderProgram.destroy()}se.shaderProgram=A.fromCache({context:s,vertexShaderSource:ie,fragmentShaderSource:ne,attributeLocations:z});var ue=e._pickCommand;if(o(ue.shaderProgram)){ue.shaderProgram.destroy()}ue.shaderProgram=A.fromCache({context:s,vertexShaderSource:ae,fragmentShaderSource:oe,attributeLocations:z});try{se.shaderProgram._bind()}catch(r){throw new l("Error generating style shader: this may be caused by a type mismatch, index out-of-bounds, or other syntax error.");J(e,t,undefined)}}k.prototype.applyDebugSettings=function(e,t){this._highlightColor=e?t:r.WHITE};k.prototype.applyStyleWithShader=function(e,t){if(!o(this.batchTable)){J(this,e,t);return true}return false};var $=new t;var ee=new p;k.prototype.update=function(e,r){var i=this._tile.transformDirty||this._mode!==r.mode;this._mode=r.mode;if(!o(this._drawCommand)){j(this,r);J(this,r,e.style);i=true;this.state=N.READY;this._readyPromise.resolve(this);this._parsedContent=undefined}if(i){if(o(this._rtcCenter)){p.multiplyByTranslation(this._tile.computedTransform,this._rtcCenter,this._drawCommand.modelMatrix)}else if(o(this._quantizedVolumeOffset)){p.multiplyByTranslation(this._tile.computedTransform,this._quantizedVolumeOffset,this._drawCommand.modelMatrix)}else{p.clone(this._tile.computedTransform,this._drawCommand.modelMatrix)}if(r.mode!==F.SCENE3D){var n=r.mapProjection;var a=this._drawCommand.modelMatrix;var s=p.getColumn(a,3,$);if(!t.equals(s,t.UNIT_W)){w.basisTo2D(n,a,a)}else{var u=this._tile.boundingSphere.center;var l=w.wgs84To2DModelMatrix(n,u,ee);p.multiply(l,a,a)}}p.clone(this._drawCommand.modelMatrix,this._pickCommand.modelMatrix);var c;if(o(this._tile._contentBoundingVolume)){c=this._mode===F.SCENE3D?this._tile._contentBoundingVolume.boundingSphere:this._tile._contentBoundingVolume2D.boundingSphere}else{c=this._mode===F.SCENE3D?this._tile._boundingVolume.boundingSphere:this._tile._boundingVolume2D.boundingSphere}this._drawCommand.boundingVolume=c;this._pickCommand.boundingVolume=c}if(this.backFaceCulling!==this._backFaceCulling){this._backFaceCulling=this.backFaceCulling;J(this,r,e.style)}var d=this._highlightColor.alpha<1||this._constantColor.alpha<1||this._styleTranslucent;this._drawCommand.renderState=d?this._translucentRenderState:this._opaqueRenderState;this._drawCommand.pass=d?T.TRANSLUCENT:T.OPAQUE;if(o(this.batchTable)){this.batchTable.update(e,r)}var f=r.passes;if(f.render){r.addCommand(this._drawCommand)}if(f.pick){r.addCommand(this._pickCommand)}};k.prototype.isDestroyed=function(){return false};k.prototype.destroy=function(){var e=this._drawCommand;var t=this._pickCommand;if(o(e)){e.vertexArray=e.vertexArray&&e.vertexArray.destroy()
;e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy();t.shaderProgram=t.shaderProgram&&t.shaderProgram.destroy()}this.batchTable=this.batchTable&&this.batchTable.destroy();return u(this)};return k});define("Scene/Tileset3DTileContent",["../Core/defined","../Core/defineProperties","../Core/destroyObject","../ThirdParty/when","./Cesium3DTileContentState"],function(e,t,r,i,n){"use strict";function a(e,t,r){this._tileset=e;this._tile=t;this._url=r;this.state=n.UNLOADED;this.batchTable=undefined;this.featurePropertiesDirty=false;this._contentReadyToProcessPromise=i.defer();this._readyPromise=i.defer()}t(a.prototype,{featuresLength:{get:function(){return 0}},pointsLength:{get:function(){return 0}},vertexMemorySizeInBytes:{get:function(){return 0}},textureMemorySizeInBytes:{get:function(){return 0}},batchTableMemorySizeInBytes:{get:function(){return 0}},innerContents:{get:function(){return undefined}},contentReadyToProcessPromise:{get:function(){return this._contentReadyToProcessPromise.promise}},readyPromise:{get:function(){return this._readyPromise.promise}}});a.prototype.hasProperty=function(e,t){return false};a.prototype.getFeature=function(e){return undefined};a.prototype.request=function(){var e=this;this.state=n.LOADING;this._tileset.loadTileset(this._url,this._tile).then(function(){e.state=n.PROCESSING;e._contentReadyToProcessPromise.resolve(e);e.state=n.READY;e._readyPromise.resolve(e)}).otherwise(function(t){e.state=n.FAILED;e._readyPromise.reject(t)});return true};a.prototype.initialize=function(e,t){};a.prototype.applyDebugSettings=function(e,t){};a.prototype.applyStyleWithShader=function(e,t){return false};a.prototype.update=function(e,t){};a.prototype.isDestroyed=function(){return false};a.prototype.destroy=function(){return r(this)};return a});define("Scene/Cesium3DTileContentFactory",["./Batched3DModel3DTileContent","./Composite3DTileContent","./Instanced3DModel3DTileContent","./PointCloud3DTileContent","./Tileset3DTileContent"],function(e,t,r,i,n){"use strict";var a={b3dm:function(t,r,i){return new e(t,r,i)},pnts:function(e,t,r){return new i(e,t,r)},i3dm:function(e,t,i){return new r(e,t,i)},cmpt:function(e,r,i){return new t(e,r,i,a)},json:function(e,t,r){return new n(e,t,r)}};return a});define("Scene/Cesium3DTileOptimizationHint",["../Core/freezeObject"],function(e){"use strict";var t={NOT_COMPUTED:-1,USE_OPTIMIZATION:1,SKIP_OPTIMIZATION:0};return e(t)});define("Scene/TileBoundingRegion",["../Core/BoundingSphere","../Core/Cartesian3","../Core/Cartographic","../Core/ColorGeometryInstanceAttribute","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Ellipsoid","../Core/GeometryInstance","../Core/Matrix4","../Core/OrientedBoundingBox","../Core/Rectangle","../Core/RectangleOutlineGeometry","./PerInstanceColorAppearance","./Primitive","./SceneMode"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v){"use strict";function _(r){if(!a(r)||!a(r.rectangle)){throw new s("options.url is required.")}this.rectangle=f.clone(r.rectangle);this.minimumHeight=n(r.minimumHeight,0);this.maximumHeight=n(r.maximumHeight,0);this.southwestCornerCartesian=new t;this.northeastCornerCartesian=new t;this.westNormal=new t;this.southNormal=new t;this.eastNormal=new t;this.northNormal=new t;var i=n(r.ellipsoid,u.WGS84);S(this,r.rectangle,i);this._orientedBoundingBox=d.fromRectangle(this.rectangle,this.minimumHeight,this.maximumHeight,i);this._boundingSphere=e.fromOrientedBoundingBox(this._orientedBoundingBox)}o(_.prototype,{boundingVolume:{get:function(){return this._orientedBoundingBox}},boundingSphere:{get:function(){return this._boundingSphere}}});var g=new t;var y=new t;var w=new t;var C=new t;var b=new r;function S(e,r,i){i.cartographicToCartesian(f.southwest(r),e.southwestCornerCartesian);i.cartographicToCartesian(f.northeast(r),e.northeastCornerCartesian);b.longitude=r.west;b.latitude=(r.south+r.north)*.5;b.height=0;var n=i.cartographicToCartesian(b,w);var a=t.cross(n,t.UNIT_Z,g);t.normalize(a,e.westNormal);b.longitude=r.east;var o=i.cartographicToCartesian(b,C);var s=t.cross(t.UNIT_Z,o,g);t.normalize(s,e.eastNormal);var u=i.geodeticSurfaceNormalCartographic(f.southeast(r),y);var l=t.subtract(n,o,g);var c=t.cross(u,l,y);t.normalize(c,e.southNormal);var d=i.geodeticSurfaceNormalCartographic(f.northwest(r),y);var h=t.cross(l,d,y);t.normalize(h,e.northNormal)}var E=new t;var T=new t;var x=new t(0,-1,0);var A=new t(0,0,-1);var P=new t;_.prototype.distanceToCamera=function(e){if(!a(e)){throw new s("frameState is required.")}var r=e.camera;var i=r.positionWC;var n=r.positionCartographic;var o=0;if(!f.contains(this.rectangle,n)){var u=this.southwestCornerCartesian;var l=this.northeastCornerCartesian;var c=this.westNormal;var d=this.southNormal;var h=this.eastNormal;var p=this.northNormal;if(e.mode!==v.SCENE3D){u=e.mapProjection.project(f.southwest(this.rectangle),E);u.z=u.y;u.y=u.x;u.x=0;l=e.mapProjection.project(f.northeast(this.rectangle),T);l.z=l.y;l.y=l.x;l.x=0;c=x;h=t.UNIT_Y;d=A;p=t.UNIT_Z}var m=t.subtract(i,u,P);var _=t.dot(m,c);var g=t.dot(m,d);var y=t.subtract(i,l,P);var w=t.dot(y,h);var C=t.dot(y,p);if(_>0){o+=_*_}else if(w>0){o+=w*w}if(g>0){o+=g*g}else if(C>0){o+=C*C}}var b;if(e.mode===v.SCENE3D){b=n.height}else{b=i.x}var S=e.mode===v.SCENE3D?this.maximumHeight:0;var D=b-S;if(D>0){o+=D*D}return Math.sqrt(o)};_.prototype.intersectPlane=function(e){if(!a(e)){throw new s("plane is required.")}return this._orientedBoundingBox.intersectPlane(e)};_.prototype.createDebugVolume=function(e){if(!a(e)){throw new s("color is required.")}var t=new c.clone(c.IDENTITY);var r=new h({rectangle:this.rectangle,height:this.minimumHeight,extrudedHeight:this.maximumHeight});var n=new l({geometry:r,modelMatrix:t,attributes:{color:i.fromColor(e)}});return new m({geometryInstances:n,appearance:new p({translucent:false,flat:true}),asynchronous:false})};return _});define("Scene/TileOrientedBoundingBox",["../Core/BoundingSphere","../Core/BoxOutlineGeometry","../Core/Cartesian3","../Core/ColorGeometryInstanceAttribute","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/GeometryInstance","../Core/Matrix3","../Core/Matrix4","../Core/OrientedBoundingBox","./PerInstanceColorAppearance","./Primitive"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h){"use strict";function p(t,r){this._orientedBoundingBox=new d(t,r);this._boundingSphere=e.fromOrientedBoundingBox(this._orientedBoundingBox)}o(p.prototype,{boundingVolume:{get:function(){return this._orientedBoundingBox}},boundingSphere:{get:function(){return this._boundingSphere}}});p.prototype.distanceToCamera=function(e){if(!a(e)){throw new s("frameState is required.")}return Math.sqrt(this._orientedBoundingBox.distanceSquaredTo(e.camera.positionWC))};p.prototype.intersectPlane=function(e){if(!a(e)){throw new s("plane is required.")}return this._orientedBoundingBox.intersectPlane(e)};p.prototype.update=function(t,i){r.clone(t,this._orientedBoundingBox.center);l.clone(i,this._orientedBoundingBox.halfAxes);e.fromOrientedBoundingBox(this._orientedBoundingBox,this._boundingSphere)};p.prototype.createDebugVolume=function(e){if(!a(e)){throw new s("color is required.")}var n=new t({minimum:new r(-1,-1,-1),maximum:new r(1,1,1)});var o=c.fromRotationTranslation(this.boundingVolume.halfAxes,this.boundingVolume.center);var l=new u({geometry:n,modelMatrix:o,attributes:{color:i.fromColor(e)}});return new h({geometryInstances:l,appearance:new f({translucent:false,flat:true}),asynchronous:false})};return p});define("Scene/Cesium3DTileOptimizations",["../Core/Cartesian3","../Core/Check","../Core/defaultValue","../Core/freezeObject","./Cesium3DTileOptimizationHint","./TileBoundingRegion","./TileOrientedBoundingBox"],function(e,t,r,i,n,a,o){"use strict";var s={};var u=new e;s.checkChildrenWithinParent=function(i,s,l){t.typeOf.object("tile",i);s=r(s,false);l=r(l,false);if(i._optimChildrenWithinParent===n.NOT_COMPUTED&&s||l){var c=i.children;var d=c.length;var f=i._boundingVolume;if(f instanceof o||f instanceof a){var h=f._orientedBoundingBox;i._optimChildrenWithinParent=n.USE_OPTIMIZATION;for(var p=0;p<d;++p){var m=c[p];var v=m._boundingVolume;if(v instanceof o||v instanceof a){var _=v._orientedBoundingBox;var g=e.subtract(_.center,h.center,u);var y=e.magnitude(g);e.divideByScalar(g,y,g);var w=Math.abs(h.halfAxes[0]*g.x)+Math.abs(h.halfAxes[1]*g.y)+Math.abs(h.halfAxes[2]*g.z)+Math.abs(h.halfAxes[3]*g.x)+Math.abs(h.halfAxes[4]*g.y)+Math.abs(h.halfAxes[5]*g.z)+Math.abs(h.halfAxes[6]*g.x)+Math.abs(h.halfAxes[7]*g.y)+Math.abs(h.halfAxes[8]*g.z);var C=Math.abs(_.halfAxes[0]*g.x)+Math.abs(_.halfAxes[1]*g.y)+Math.abs(_.halfAxes[2]*g.z)+Math.abs(_.halfAxes[3]*g.x)+Math.abs(_.halfAxes[4]*g.y)+Math.abs(_.halfAxes[5]*g.z)+Math.abs(_.halfAxes[6]*g.x)+Math.abs(_.halfAxes[7]*g.y)+Math.abs(_.halfAxes[8]*g.z);if(w<=C+y){i._optimChildrenWithinParent=n.SKIP_OPTIMIZATION;break}}else{i._optimChildrenWithinParent=n.SKIP_OPTIMIZATION;break}}}}return i._optimChildrenWithinParent===n.USE_OPTIMIZATION};return s});define("Scene/Cesium3DTileRefine",["../Core/freezeObject"],function(e){"use strict";var t={ADD:0,REPLACE:1};return e(t)});define("Scene/Empty3DTileContent",["../Core/defineProperties","../Core/destroyObject","../ThirdParty/when","./Cesium3DTileContentState"],function(e,t,r,i){"use strict";function n(){this.state=undefined;this.batchTable=undefined;this.featurePropertiesDirty=false;this._contentReadyToProcessPromise=r.defer();this._readyPromise=r.defer();this.state=i.PROCESSING;this._contentReadyToProcessPromise.resolve(this);this.state=i.READY;this._readyPromise.resolve(this)}e(n.prototype,{featuresLength:{get:function(){return 0}},pointsLength:{get:function(){return 0}},vertexMemorySizeInBytes:{get:function(){return 0}},textureMemorySizeInBytes:{get:function(){return 0}},batchTableMemorySizeInBytes:{get:function(){return 0}},innerContents:{get:function(){return undefined}},contentReadyToProcessPromise:{get:function(){return this._contentReadyToProcessPromise.promise}},readyPromise:{get:function(){return this._readyPromise.promise}}});n.prototype.hasProperty=function(e,t){return false};n.prototype.getFeature=function(e){return undefined};n.prototype.request=function(){};n.prototype.initialize=function(e,t){};n.prototype.applyDebugSettings=function(e,t){};n.prototype.applyStyleWithShader=function(e,t){return false};n.prototype.update=function(e,t){};n.prototype.isDestroyed=function(){return false};n.prototype.destroy=function(){return t(this)};return n});define("Scene/TileBoundingSphere",["../Core/BoundingSphere","../Core/Cartesian3","../Core/ColorGeometryInstanceAttribute","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/GeometryInstance","../Core/Matrix4","../Core/SphereOutlineGeometry","./PerInstanceColorAppearance","./Primitive"],function(e,t,r,i,n,a,o,s,u,l,c){"use strict";function d(t,r){this._boundingSphere=new e(t,r)}n(d.prototype,{center:{get:function(){return this._boundingSphere.center}},radius:{get:function(){return this._boundingSphere.radius}},boundingVolume:{get:function(){return this._boundingSphere}},boundingSphere:{get:function(){return this._boundingSphere}}});d.prototype.distanceToCamera=function(e){if(!i(e)){throw new a("frameState is required.")}var r=this._boundingSphere;return Math.max(0,t.distance(r.center,e.camera.positionWC)-r.radius)};d.prototype.intersectPlane=function(t){if(!i(t)){throw new a("plane is required.")}return e.intersectPlane(this._boundingSphere,t)};d.prototype.update=function(e,r){t.clone(e,this._boundingSphere.center);this._boundingSphere.radius=r};d.prototype.createDebugVolume=function(e){if(!i(e)){throw new a("color is required.")}var t=new u({radius:this.radius});var n=s.fromTranslation(this.center,new s.clone(s.IDENTITY));var d=new o({geometry:t,modelMatrix:n,attributes:{color:r.fromColor(e)}});return new c({geometryInstances:d,appearance:new l({translucent:false,flat:true}),asynchronous:false})};return d});define("Scene/Cesium3DTile",["../Core/BoundingSphere","../Core/BoxOutlineGeometry","../Core/Cartesian3","../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/clone","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/GeometryInstance","../Core/getExtensionFromUri","../Core/Intersect","../Core/joinUrls","../Core/Matrix3","../Core/Matrix4","../Core/OrientedBoundingBox","../Core/Rectangle","../Core/RectangleOutlineGeometry","../Core/RequestScheduler","../Core/SphereOutlineGeometry","../ThirdParty/Uri","./Cesium3DTileChildrenVisibility","./Cesium3DTileContentFactory","./Cesium3DTileContentState","./Cesium3DTileOptimizations","./Cesium3DTileOptimizationHint","./Cesium3DTileRefine","./Empty3DTileContent","./PerInstanceColorAppearance","./Primitive","./SceneMode","./TileBoundingRegion","./TileBoundingSphere","./TileOrientedBoundingBox"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w,C,b,S,E,T,x,A,P,D,M,I,O,R,N,L){"use strict";function B(e,t,r,n){this._header=r;var a=r.content;this.transform=s(r.transform)?v.unpack(r.transform):v.clone(v.IDENTITY);var o=s(n)?n.computedTransform:e.modelMatrix;var u=v.multiply(o,this.transform,new v);this.computedTransform=u;this._transformDirty=true;this._boundingVolume=this.createBoundingVolume(r.boundingVolume,u);this._boundingVolume2D=undefined;var l;if(s(a)&&s(a.boundingVolume)){l=this.createBoundingVolume(a.boundingVolume,u)}this._contentBoundingVolume=l;this._contentBoundingVolume2D=undefined;var d;if(s(r.viewerRequestVolume)){d=this.createBoundingVolume(r.viewerRequestVolume,u)}this._viewerRequestVolume=d;this.geometricError=r.geometricError;var h;if(s(r.refine)){h=r.refine==="replace"?P.REPLACE:P.ADD}else if(s(n)){h=n.refine}this.refine=h;this.children=[];this.descendantsWithContent=undefined;this.parent=n;this.numberOfChildrenWithoutContent=s(r.children)?r.children.length:0;var m;var _;var g;var y;if(s(a)){var C=a.url;var b=p(t,C);g=w.getRequestServer(b);var T=f(b);var x=E[T];if(T==="json"){m=false;_=true}else{m=true;_=false}if(!s(x)){throw new c("Unknown tile content type, "+T+", for "+b)}var M=this;y=function(){return x(e,M,b)}}else{m=false;_=false;y=function(){return new D}}this._createContent=y;this._content=y();if(!m&&!_){F(this)}this._requestServer=g;this.hasContent=m;this.hasTilesetContent=_;this.replacementNode=undefined;this.distanceToCamera=0;this.selected=false;this.replaced=false;this.visibilityPlaneMask=true;this.childrenVisibility=S.VISIBLE;this.lastSelectedFrameNumber=0;this.lastStyleTime=0;this._debugBoundingVolume=undefined;this._debugContentBoundingVolume=undefined;this._debugViewerRequestVolume=undefined;this._debugColor=new i.fromRandom({alpha:1});this._debugColorizeTiles=false;this._optimChildrenWithinParent=A.NOT_COMPUTED}u(B.prototype,{content:{get:function(){return this._content}},contentBoundingVolume:{get:function(){return o(this._contentBoundingVolume,this._boundingVolume)}},boundingSphere:{get:function(){return this._boundingVolume.boundingSphere}},transformDirty:{get:function(){return this._transformDirty}},requestServer:{get:function(){return this._requestServer}},contentReady:{get:function(){return this._content.state===T.READY}},contentUnloaded:{get:function(){return this._content.state===T.UNLOADED}}});function F(e){e._content.readyPromise.then(function(t){if(s(e.parent)){--e.parent.numberOfChildrenWithoutContent}}).otherwise(function(e){})}B.prototype.requestContent=function(){if(this._content.request()){F(this)}};B.prototype.canRequestContent=function(){if(!s(this._requestServer)){return true}return this._requestServer.hasAvailableRequests()};B.prototype.unloadContent=function(){if(s(this.parent)){++this.parent.numberOfChildrenWithoutContent}this._content=this._content&&this._content.destroy();this._content=this._createContent();if(!this.hasContent&&!this.hasTilesetContent){F(this)}this.replacementNode=undefined;this.distanceToCamera=0;this.visibilityPlaneMask=0;this.selected=false;this.lastSelectedFrameNumber=0;this.lastStyleTime=0;this._debugBoundingVolume=this._debugBoundingVolume&&this._debugBoundingVolume.destroy();this._debugContentBoundingVolume=this._debugContentBoundingVolume&&this._debugContentBoundingVolume.destroy();this._debugViewerRequestVolume=this._debugViewerRequestVolume&&this._debugViewerRequestVolume.destroy()};var k=new e;function V(t,r){if(r.mode!==O.SCENE3D&&!s(t._boundingVolume2D)){var i=t._boundingVolume.boundingSphere;var n=e.projectTo2D(i,r.mapProjection,k);t._boundingVolume2D=new N(n.center,n.radius)}return r.mode!==O.SCENE3D?t._boundingVolume2D:t._boundingVolume}B.prototype.visibility=function(e,t){var r=e.cullingVolume;var i=V(this,e);return r.computeVisibilityWithPlaneMask(i,t)};B.prototype.contentsVisibility=function(t){if(!s(this._contentBoundingVolume)){return h.INSIDE}if(t.mode!==O.SCENE3D&&!s(this._contentBoundingVolume2D)){var r=this._contentBoundingVolume.boundingSphere;this._contentBoundingVolume2D=e.projectTo2D(r)}var i=t.cullingVolume;var n=t.mode!==O.SCENE3D?this._contentBoundingVolume2D:this._contentBoundingVolume;return i.computeVisibility(n)};B.prototype.distanceToTile=function(e){var t=V(this,e);return t.distanceToCamera(e)};B.prototype.insideViewerRequestVolume=function(e){var t=this._viewerRequestVolume;if(!s(t)){return true}return t.distanceToCamera(e)===0};var z=new m;var U=new r;var q=new m;var G=new r;var H=new g;B.prototype.createBoundingVolume=function(e,t,i){var n;if(s(e.box)){var a=e.box;n=r.fromElements(a[0],a[1],a[2],G);var o=m.fromArray(a,3,q);n=v.multiplyByPoint(t,n,n);var u=v.getRotation(t,z);o=m.multiply(u,o,o);if(s(i)){i.update(n,o);return i}return new L(n,o)}else if(s(e.region)){var l=e.region;var c=g.unpack(l,0,H);if(s(i)){return i}return new R({rectangle:c,minimumHeight:l[4],maximumHeight:l[5]})}else if(s(e.sphere)){var d=e.sphere;n=r.fromElements(d[0],d[1],d[2],G);var f=d[3];n=v.multiplyByPoint(t,n,n);var h=v.getScale(t,U);var p=r.maximumComponent(h);f*=p;if(s(i)){i.update(n,f);return i}return new N(n,f)}};var W=new v;B.prototype.updateTransform=function(e){e=o(e,v.IDENTITY);var t=v.multiply(e,this.transform,W);var r=!v.equals(t,this.computedTransform);if(r){this._transformDirty=true;v.clone(t,this.computedTransform);var i=this._header;var n=this._header.content;this._boundingVolume=this.createBoundingVolume(i.boundingVolume,t,this._boundingVolume);if(s(this._contentBoundingVolume)){this._contentBoundingVolume=this.createBoundingVolume(n.boundingVolume,t,this._contentBoundingVolume)}if(s(this._viewerRequestVolume)){this._viewerRequestVolume=this.createBoundingVolume(i.viewerRequestVolume,t,this._viewerRequestVolume)}this._debugBoundingVolume=this._debugBoundingVolume&&this._debugBoundingVolume.destroy();this._debugContentBoundingVolume=this._debugContentBoundingVolume&&this._debugContentBoundingVolume.destroy();this._debugViewerRequestVolume=this._debugViewerRequestVolume&&this._debugViewerRequestVolume.destroy()}};function j(e,t,r){var n=s(e._header.content)&&s(e._header.content.boundingVolume);var a=t.debugShowBoundingVolume||t.debugShowContentBoundingVolume&&!n;if(a){if(!s(e._debugBoundingVolume)){e._debugBoundingVolume=e._boundingVolume.createDebugVolume(n?i.WHITE:i.RED)}e._debugBoundingVolume.update(r)}else if(!a&&s(e._debugBoundingVolume)){e._debugBoundingVolume=e._debugBoundingVolume.destroy()}if(t.debugShowContentBoundingVolume&&n){if(!s(e._debugContentBoundingVolume)){e._debugContentBoundingVolume=e._contentBoundingVolume.createDebugVolume(i.BLUE)}e._debugContentBoundingVolume.update(r)}else if(!t.debugShowContentBoundingVolume&&s(e._debugContentBoundingVolume)){e._debugContentBoundingVolume=e._debugContentBoundingVolume.destroy()}if(t.debugShowViewerRequestVolume&&s(e._viewerRequestVolume)){if(!s(e._debugViewerRequestVolume)){e._debugViewerRequestVolume=e._viewerRequestVolume.createDebugVolume(i.YELLOW)}e._debugViewerRequestVolume.update(r)}else if(!t.debugShowViewerRequestVolume&&s(e._debugViewerRequestVolume)){e._debugViewerRequestVolume=e._debugViewerRequestVolume.destroy()}if(t.debugColorizeTiles&&!e._debugColorizeTiles){e._debugColorizeTiles=true;e._content.applyDebugSettings(true,e._debugColor)}else if(!t.debugColorizeTiles&&e._debugColorizeTiles){e._debugColorizeTiles=false;e._content.applyDebugSettings(false,e._debugColor)}}B.prototype.update=function(e,t){j(this,e,t);this._content.update(e,t);this._transformDirty=false};var Y=[];B.prototype.process=function(e,t){var r=t.commandList;t.commandList=Y;this._content.update(e,t);Y.length=0;t.commandList=r};B.prototype.isDestroyed=function(){return false};B.prototype.destroy=function(){this._content=this._content&&this._content.destroy();this._debugBoundingVolume=this._debugBoundingVolume&&this._debugBoundingVolume.destroy();this._debugContentBoundingVolume=this._debugContentBoundingVolume&&this._debugContentBoundingVolume.destroy();this._debugViewerRequestVolume=this._debugViewerRequestVolume&&this._debugViewerRequestVolume.destroy();return l(this)};return B});define("Scene/Cesium3DTileContent",["../Core/defineProperties","../Core/DeveloperError"],function(e,t){"use strict";function r(e,t,r){this.state=undefined;this.batchTable=undefined;this.featurePropertiesDirty=false}e(r.prototype,{featuresLength:{get:function(){t.throwInstantiationError()}},pointsLength:{get:function(){t.throwInstantiationError()}},vertexMemorySizeInBytes:{get:function(){t.throwInstantiationError()}},batchTableMemorySizeInBytes:{get:function(){t.throwInstantiationError()}},textureMemorySizeInBytes:{get:function(){t.throwInstantiationError()}},innerContents:{get:function(){t.throwInstantiationError()}},contentReadyToProcessPromise:{get:function(){t.throwInstantiationError()}},readyPromise:{get:function(){t.throwInstantiationError()}}});r.prototype.hasProperty=function(e,r){t.throwInstantiationError()};r.prototype.getFeature=function(e){t.throwInstantiationError()};r.prototype.request=function(){t.throwInstantiationError()};r.prototype.initialize=function(e,r){t.throwInstantiationError()};r.prototype.applyDebugSettings=function(e,r){t.throwInstantiationError()};r.prototype.applyStyleWithShader=function(e,r){t.throwInstantiationError()};r.prototype.update=function(e,r){t.throwInstantiationError()};r.prototype.isDestroyed=function(){t.throwInstantiationError()};r.prototype.destroy=function(){t.throwInstantiationError()};return r});define("Scene/Cesium3DTileStyleEngine",["../Core/Color","../Core/defined","../Core/defineProperties"],function(e,t,r){"use strict";function i(){this._style=undefined;this._styleDirty=false;this._lastStyleTime=0}r(i.prototype,{style:{get:function(){return this._style},set:function(e){this._style=e;this._styleDirty=true}}});i.prototype.makeDirty=function(){this._styleDirty=true};i.prototype.applyStyle=function(e,r){if(!e.ready){return}if(t(this._style)&&!this._style.ready){return}var i=this._styleDirty;if(r.passes.render){this._styleDirty=false}if(i){++this._lastStyleTime}var a=this._lastStyleTime;var o=e._statistics;var s=i?e._selectedTiles:e._selectedTilesToStyle;var u=s.length;for(var l=0;l<u;++l){var c=s[l];if(c.selected){if(c.lastStyleTime!==a){c.lastStyleTime=a;n(this,r,c.content,o);++o.numberOfTilesStyled}}}};function n(e,r,i,a){var s=i.innerContents;if(t(s)){var u=s.length;for(var l=0;l<u;++l){n(e,r,s[l],a)}}else{o(e,r,i,a)}}var a=new e;function o(e,t,r,i){var n=e._style;if(!r.applyStyleWithShader(t,n)){s(t,r,i,n)}}function s(e,r,i,n){var o=r.featuresLength;i.numberOfFeaturesStyled+=o;if(!t(n)){u(r);return}for(var s=0;s<o;++s){var l=r.getFeature(s);l.color=n.color.evaluateColor(e,l,a);l.show=n.show.evaluate(e,l)}}function u(t){var r=t.featuresLength;for(var i=0;i<r;++i){var n=t.getFeature(i);n.show=true;n.color=e.WHITE}}return i});define("Scene/DebugCameraPrimitive",["../Core/BoundingSphere","../Core/Cartesian3","../Core/Cartesian4","../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Core/GeometryAttribute","../Core/GeometryAttributes","../Core/GeometryInstance","../Core/Matrix4","../Core/PrimitiveType","./PerInstanceColorAppearance","./Primitive"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v){"use strict";function _(e){e=o(e,o.EMPTY_OBJECT);if(!s(e.camera)){throw new l("options.camera is required.")}this._camera=e.camera;this._color=o(e.color,i.CYAN);this._updateOnChange=o(e.updateOnChange,true);this.show=o(e.show,true);this.id=e.id;this._id=undefined;this._outlinePrimitive=undefined;this._planesPrimitive=undefined}var g=new Array(4);g[0]=new r(-1,-1,1,1);g[1]=new r(1,-1,1,1);g[2]=new r(1,1,1,1);g[3]=new r(-1,1,1,1);var y=new h;var w=new Array(4);for(var C=0;C<4;++C){w[C]=new r}var b=new i;var S=[1,1e5];_.prototype.update=function(o){if(!this.show){return}if(this._updateOnChange){this._outlinePrimitive=this._outlinePrimitive&&this._outlinePrimitive.destroy();this._planesPrimitive=this._planesPrimitive&&this._planesPrimitive.destroy()}if(!s(this._outlinePrimitive)){var u=this._camera;var l=u.frustum;var _=o.frustumSplits;var C=_.length-1;if(C<=0){_=S;_[0]=this._camera.frustum.near;_[1]=this._camera.frustum.far;C=1}var E=this._camera.viewMatrix;var T;var x;if(s(u.frustum.fovy)){var A=this._camera.frustum.projectionMatrix;var P=h.multiply(A,E,y);x=h.inverse(P,y)}else{T=h.inverseTransformation(E,y)}var D=new Float64Array(3*4*(C+1));var M;for(M=0;M<C+1;++M){for(var I=0;I<4;++I){var O=r.clone(g[I],w[I]);var R;if(!s(x)){if(s(l._offCenterFrustum)){l=l._offCenterFrustum}var N;var L;if(M===C){N=_[M-1];L=_[M]}else{N=_[M];L=_[M+1]}O.x=(O.x*(l.right-l.left)+l.left+l.right)*.5;O.y=(O.y*(l.top-l.bottom)+l.bottom+l.top)*.5;O.z=(O.z*(N-L)-N-L)*.5;O.w=1;R=h.multiplyByVector(T,O,O)}else{O=h.multiplyByVector(x,O,O);var B=1/O.w;t.multiplyByScalar(O,B,O);t.subtract(O,this._camera.positionWC,O);t.normalize(O,O);var F=t.dot(this._camera.directionWC,O);t.multiplyByScalar(O,_[M]/F,O);t.add(O,this._camera.positionWC,O)}D[12*M+I*3]=O.x;D[12*M+I*3+1]=O.y;D[12*M+I*3+2]=O.z}}var k=new e.fromVertices(D);var V=new d;V.position=new c({componentDatatype:a.DOUBLE,componentsPerAttribute:3,values:D});var z,U;var q=new Uint16Array(8*(2*C+1));for(M=0;M<C+1;++M){z=M*8;U=M*4;q[z]=U;q[z+1]=U+1;q[z+2]=U+1;q[z+3]=U+2;q[z+4]=U+2;q[z+5]=U+3;q[z+6]=U+3;q[z+7]=U}for(M=0;M<C;++M){z=(C+1+M)*8;U=M*4;q[z]=U;q[z+1]=U+4;q[z+2]=U+1;q[z+3]=U+5;q[z+4]=U+2;q[z+5]=U+6;q[z+6]=U+3;q[z+7]=U+7}this._outlinePrimitive=new v({geometryInstances:new f({geometry:{attributes:V,indices:q,primitiveType:p.LINES,boundingSphere:k},attributes:{color:n.fromColor(this._color)},id:this.id,pickPrimitive:this}),appearance:new m({translucent:false,flat:true}),asynchronous:false});var G=new Uint16Array(6*(5*C+1));for(M=0;M<C+1;++M){z=M*6;U=M*4;G[z]=U;G[z+1]=U+1;G[z+2]=U+2;G[z+3]=U;G[z+4]=U+2;G[z+5]=U+3}for(M=0;M<C;++M){z=(C+1+4*M)*6;U=M*4;G[z]=U+4;G[z+1]=U;G[z+2]=U+3;G[z+3]=U+4;G[z+4]=U+3;G[z+5]=U+7;G[z+6]=U+4;G[z+7]=U;G[z+8]=U+1;G[z+9]=U+4;G[z+10]=U+1;G[z+11]=U+5;G[z+12]=U+7;G[z+13]=U+3;G[z+14]=U+2;G[z+15]=U+7;G[z+16]=U+2;G[z+17]=U+6;G[z+18]=U+6;G[z+19]=U+2;G[z+20]=U+1;G[z+21]=U+6;G[z+22]=U+1;G[z+23]=U+5}this._planesPrimitive=new v({geometryInstances:new f({geometry:{attributes:V,indices:G,primitiveType:p.TRIANGLES,boundingSphere:k},attributes:{color:n.fromColor(i.fromAlpha(this._color,.1,b))},id:this.id,pickPrimitive:this}),appearance:new m({translucent:true,flat:true}),asynchronous:false})}this._outlinePrimitive.update(o);this._planesPrimitive.update(o)};_.prototype.isDestroyed=function(){return false};_.prototype.destroy=function(){this._outlinePrimitive=this._outlinePrimitive&&this._outlinePrimitive.destroy();this._planesPrimitive=this._planesPrimitive&&this._planesPrimitive.destroy();return u(this)};return _});define("Scene/Cesium3DTileset",["../Core/Cartesian3","../Core/Cartographic","../Core/Color","../Core/clone","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/DoublyLinkedList","../Core/Event","../Core/getBaseUri","../Core/getExtensionFromUri","../Core/Intersect","../Core/isDataUri","../Core/joinUrls","../Core/JulianDate","../Core/loadJson","../Core/Math","../Core/Matrix4","../Core/Request","../Core/RequestScheduler","../Core/RequestType","../ThirdParty/Uri","../ThirdParty/when","./Axis","./Cesium3DTile","./Cesium3DTileChildrenVisibility","./Cesium3DTileColorBlendMode","./Cesium3DTileOptimizations","./Cesium3DTileOptimizationHint","./Cesium3DTileRefine","./Cesium3DTileStyleEngine","./CullingVolume","./DebugCameraPrimitive","./LabelCollection","./OrthographicFrustum","./SceneMode","./ShadowMode","./TileBoundingRegion","./TileBoundingSphere","./TileOrientedBoundingBox"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w,C,b,S,E,T,x,A,P,D,M,I,O,R,N,L,B,F,k,V,z,U){"use strict";function q(e){e=n(e,n.EMPTY_OBJECT);var t=e.url;if(!a(t)){throw new u("options.url is required.")}var r;var i;if(f(t)==="json"){r=t;i=d(t,true)}else if(p(t)){r=t;i=""}else{i=t;r=m(i,"tileset.json")}this._url=t;this._baseUrl=i;this._tilesetUrl=r;this._root=undefined;this._asset=undefined;this._properties=undefined;this._geometricError=undefined;this._gltfUpAxis=undefined;this._processingQueue=[];this._selectedTiles=[];this._selectedTilesToStyle=[];this._loadTimestamp=undefined;this._timeSinceLoad=0;var o=new l;this._replacementList=o;this._replacementSentinel=o.add();this._trimTiles=false;this._refineToVisible=n(e.refineToVisible,false);this._cullWithChildrenBounds=n(e.cullWithChildrenBounds,true);this.dynamicScreenSpaceError=n(e.dynamicScreenSpaceError,false);this.dynamicScreenSpaceErrorDensity=.00278;this.dynamicScreenSpaceErrorFactor=4;this.dynamicScreenSpaceErrorHeightFalloff=.25;this._dynamicScreenSpaceErrorComputedDensity=0;this.shadows=n(e.shadows,k.ENABLED);this.show=n(e.show,true);this._maximumScreenSpaceError=n(e.maximumScreenSpaceError,16);this._maximumNumberOfLoadedTiles=n(e.maximumNumberOfLoadedTiles,256);this._styleEngine=new O;this.colorBlendMode=P.HIGHLIGHT;this.colorBlendAmount=.5;this._modelMatrix=a(e.modelMatrix)?y.clone(e.modelMatrix):y.clone(y.IDENTITY);this._statistics={visited:0,numberOfCommands:0,numberOfAttemptedRequests:0,numberOfPendingRequests:0,numberProcessing:0,numberContentReady:0,numberTotal:0,numberOfFeaturesSelected:0,numberOfFeaturesLoaded:0,numberOfPointsSelected:0,numberOfPointsLoaded:0,numberOfTilesStyled:0,numberOfFeaturesStyled:0,numberOfTilesCulledWithChildrenUnion:0,vertexMemorySizeInBytes:0,textureMemorySizeInBytes:0,batchTableMemorySizeInBytes:0,lastColor:new G,lastPick:new G};this._tilesLoaded=false;this.debugFreezeFrame=n(e.debugFreezeFrame,false);this.debugColorizeTiles=n(e.debugColorizeTiles,false);this.debugWireframe=n(e.debugWireframe,false);this.debugShowBoundingVolume=n(e.debugShowBoundingVolume,false);this.debugShowContentBoundingVolume=n(e.debugShowContentBoundingVolume,false);this.debugShowViewerRequestVolume=n(e.debugShowViewerRequestVolume,false);this.debugShowGeometricError=n(e.debugShowGeometricError,false);this._geometricErrorLabels=undefined;this.loadProgress=new c;this.allTilesLoaded=new c;this.tileUnload=new c;this.tileVisible=new c;this._readyPromise=E.defer();var s=this;this.loadTileset(r).then(function(e){var t=e.tilesetJson;var r=a(t.asset.gltfUpAxis)?T.fromName(t.asset.gltfUpAxis):T.Y;s._asset=t.asset;s._properties=t.properties;s._geometricError=t.geometricError;s._gltfUpAxis=r;s._root=e.root;s._readyPromise.resolve(s)}).otherwise(function(e){s._readyPromise.reject(e)})}function G(){this.selected=0;this.visited=0;this.numberOfCommands=0;this.numberOfAttemptedRequests=0;this.numberOfPendingRequests=0;this.numberProcessing=0;this.numberContentReady=0;this.numberTotal=0;this.numberOfFeaturesSelected=0;this.numberOfFeaturesLoaded=0;this.numberOfPointsSelected=0;this.numberOfPointsLoaded=0;this.numberOfTilesStyled=0;this.numberOfFeaturesStyled=0;this.numberOfTilesCulledWithChildrenUnion=0;this.vertexMemorySizeInBytes=0;this.textureMemorySizeInBytes=0;this.batchTableMemorySizeInBytes=0}o(q.prototype,{
asset:{get:function(){if(!this.ready){throw new u("The tileset is not loaded.  Use Cesium3DTileset.readyPromise or wait for Cesium3DTileset.ready to be true.")}return this._asset}},properties:{get:function(){if(!this.ready){throw new u("The tileset is not loaded.  Use Cesium3DTileset.readyPromise or wait for Cesium3DTileset.ready to be true.")}return this._properties}},ready:{get:function(){return a(this._root)}},readyPromise:{get:function(){return this._readyPromise.promise}},tilesLoaded:{get:function(){return this._tilesLoaded}},url:{get:function(){return this._url}},baseUrl:{get:function(){return this._baseUrl}},style:{get:function(){return this._styleEngine.style},set:function(e){this._styleEngine.style=e}},maximumScreenSpaceError:{get:function(){return this._maximumScreenSpaceError},set:function(e){if(e<0){throw new u("maximumScreenSpaceError must be greater than or equal to zero")}this._maximumScreenSpaceError=e}},maximumNumberOfLoadedTiles:{get:function(){return this._maximumNumberOfLoadedTiles},set:function(e){if(e<0){throw new u("maximumNumberOfLoadedTiles must be greater than or equal to zero")}this._maximumNumberOfLoadedTiles=e}},boundingVolume:{get:function(){if(!this.ready){throw new u("The tileset is not loaded.  Use Cesium3DTileset.readyPromise or wait for Cesium3DTileset.ready to be true.")}return this._root._boundingVolume}},boundingSphere:{get:function(){if(!this.ready){throw new u("The tileset is not loaded.  Use Cesium3DTileset.readyPromise or wait for Cesium3DTileset.ready to be true.")}return this._root.boundingSphere}},modelMatrix:{get:function(){return this._modelMatrix},set:function(e){this._modelMatrix=y.clone(e,this._modelMatrix);if(a(this._root)){this._root.updateTransform(this._modelMatrix)}}},timeSinceLoad:{get:function(){return this._timeSinceLoad}},styleEngine:{get:function(){return this._styleEngine}},statistics:{get:function(){return this._statistics}}});q.prototype.makeStyleDirty=function(){this._styleEngine.makeDirty()};q.prototype.loadTileset=function(e,t){var r=this;return C.request(e,_,undefined,b.TILES3D).then(function(i){if(r.isDestroyed()){return E.reject("tileset is destroyed")}if(!a(i.asset)||i.asset.version!=="0.0"){throw new u("The tileset must be 3D Tiles version 0.0.  See https://github.com/AnalyticalGraphicsInc/3d-tiles#spec-status")}var o=r._statistics;var s=/[?&]v=/.test(e);if(!s){var l="?v="+n(i.asset.tilesetVersion,"0.0");r._baseUrl=m(r._baseUrl,l);e=m(e,l,false)}var c=d(e,true);var f=new x(r,c,i.root,t);var h=[];if(a(t)){t.children.push(f);++t.numberOfChildrenWithoutContent;var p=H(t);if(a(p)&&p.refine===I.REPLACE){h.push(p)}}++o.numberTotal;var v=[];v.push({header:i.root,cesium3DTile:f});while(v.length>0){var _=v.pop();var g=_.cesium3DTile;var y=_.header.children;var w=false;if(a(y)){var C=y.length;for(var b=0;b<C;++b){var S=y[b];var T=new x(r,c,S,g);g.children.push(T);++o.numberTotal;v.push({header:S,cesium3DTile:T});if(!T.hasContent){w=true}}}D.checkChildrenWithinParent(g,true);if(g.hasContent&&w&&g.refine===I.REPLACE){h.push(g)}}W(h);return{tilesetJson:i,root:f}})};function H(e){while(a(e)&&!e.hasContent){e=e.parent}return e}function W(e){var t=[];var r=e.length;for(var i=0;i<r;++i){var n=e[i];n.descendantsWithContent=[];t.push(n);while(t.length>0){var a=t.pop();var o=a.children;var s=o.length;for(var u=0;u<s;++u){var l=o[u];if(l.hasContent){n.descendantsWithContent.push(l)}else{t.push(l)}}}}}var j=new e;var Y=new t;var X=new y;var Z=new e;var K=new e;var Q=new e;function J(r,i){var n;var a;var o;var s;var u;var l=i.camera;var c=r._root;var d=c.contentBoundingVolume;if(d instanceof V){n=e.normalize(l.positionWC,j);a=l.directionWC;o=l.positionCartographic.height;s=d.minimumHeight;u=d.maximumHeight}else{var f=y.inverseTransformation(c.computedTransform,X);var h=i.mapProjection.ellipsoid;var p=d.boundingVolume;var m=y.multiplyByPoint(f,p.center,Z);if(e.magnitude(m)>h.minimumRadius){var v=t.fromCartesian(m,h,Y);n=e.normalize(l.positionWC,j);a=l.directionWC;o=l.positionCartographic.height;s=0;u=v.height*2}else{var _=y.multiplyByPoint(f,l.positionWC,K);n=e.UNIT_Z;a=y.multiplyByPointAsVector(f,l.directionWC,Q);a=e.normalize(a,a);o=_.z;if(d instanceof U){var w=c._header.boundingVolume.box[11];s=m.z-w;u=m.z+w}else if(d instanceof z){var C=p.radius;s=m.z-C;u=m.z+C}}}var b=r.dynamicScreenSpaceErrorHeightFalloff;var S=s+(u-s)*b;var E=u;var T=g.clamp((o-S)/(E-S),0,1);var x=Math.abs(e.dot(a,n));var A=1-x;A=A*(1-T);var P=r.dynamicScreenSpaceErrorDensity;P*=A;r._dynamicScreenSpaceErrorComputedDensity=P}function $(e,t,r,i){if(t===0){return 0}var n=i.camera;var o=n.frustum;var s=i.context;var u=s.drawingBufferHeight;var l;if(i.mode===F.SCENE2D||o instanceof B){if(a(o._offCenterFrustum)){o=o._offCenterFrustum}var c=s.drawingBufferWidth;var d=Math.max(o.top-o.bottom,o.right-o.left)/Math.max(c,u);l=t/d}else{var f=Math.max(r.distanceToCamera,g.EPSILON7);var h=n.frustum.sseDenominator;l=t*u/(f*h);if(e.dynamicScreenSpaceError){var p=e._dynamicScreenSpaceErrorComputedDensity;var m=e.dynamicScreenSpaceErrorFactor;var v=g.fog(f,p)*m;l-=v}}return l}function ee(e,t){var r=e.length;for(var i=0;i<r;++i){var n=e[i];n.distanceToCamera=n.distanceToTile(t)}}function te(e,t){var r=e.length;for(var i=0;i<r;++i){var n=e[i];n.updateTransform(t)}}function re(e,t){return t.distanceToCamera-e.distanceToCamera}function ie(e){return e!==R.MASK_OUTSIDE}function ne(e,t,r){if(!r){return}if(!t.canRequestContent()){return}t.requestContent();var i=e._statistics;if(!t.contentUnloaded){++i.numberOfPendingRequests;var n=he(e,t);t.content.contentReadyToProcessPromise.then(fe(e,t)).otherwise(n);t.content.readyPromise.then(n).otherwise(n)}else{++i.numberOfAttemptedRequests}}function ae(e,t,r,i){if(t.contentReady&&(r||t.contentsVisibility(i)!==h.OUTSIDE)){e._selectedTiles.push(t);t.selected=true;var n=t.content;if(n.featurePropertiesDirty){n.featurePropertiesDirty=false;t.lastStyleTime=0;e._selectedTilesToStyle.push(t)}else if(t.lastSelectedFrameNumber!==i.frameNumber-1){e._selectedTilesToStyle.push(t)}t.lastSelectedFrameNumber=i.frameNumber}}function oe(e,t,r){if(!r){return}var i=t.replacementNode;if(a(i)){e._replacementList.splice(e._replacementSentinel,i)}}var se=[];var ue=[];function le(e,t,r){var i=A.NONE;var n=e.children;var a=n.length;var o=e.visibilityPlaneMask;for(var s=0;s<a;++s){var u=n[s];var l=u.visibility(t,o);if(ie(l)){i|=A.VISIBLE}if(r){if(!u.insideViewerRequestVolume(t)){l=R.MASK_OUTSIDE}else{i|=A.IN_REQUEST_VOLUME;if(ie(l)){i|=A.VISIBLE_IN_REQUEST_VOLUME}}}u.visibilityPlaneMask=l}e.childrenVisibility=i;return i}function ce(e,t,r){if(e.debugFreezeFrame){return}var i=e._maximumScreenSpaceError;e._selectedTiles.length=0;e._selectedTilesToStyle.length=0;ue.length=0;var n=e._replacementList;n.splice(n.tail,e._replacementSentinel);var o=e._root;o.updateTransform(e._modelMatrix);if(!o.insideViewerRequestVolume(t)){return}o.distanceToCamera=o.distanceToTile(t);if($(e,e._geometricError,o,t)<=i){return}o.visibilityPlaneMask=o.visibility(t,R.MASK_INDETERMINATE);if(o.visibilityPlaneMask===R.MASK_OUTSIDE){return}if(o.contentUnloaded){ne(e,o,r);return}var s=e._statistics;var u=se;u.push(o);while(u.length>0){var l=u.pop();l.selected=false;l.replaced=false;++s.visited;var c=l.visibilityPlaneMask;var d=c===R.MASK_INSIDE;oe(e,l,r);var f=$(e,l.geometricError,l,t);var h=l.children;var p=h.length;var m;var v;var _=l.refine===I.ADD;if(l.hasTilesetContent){if(l.contentReady){m=l.children[0];m.visibilityPlaneMask=l.visibilityPlaneMask;m.distanceToCamera=l.distanceToCamera;m.updateTransform(l.computedTransform);if(m.contentUnloaded){ne(e,m,r)}else{u.push(m)}}continue}if(_){ae(e,l,d,t);if(f>i){var g=l.numberOfChildrenWithoutContent<p;if(g||l.canRequestContent()){te(h,l.computedTransform);ee(h,t);h.sort(re);for(v=0;v<p;++v){m=h[v];if(m.insideViewerRequestVolume(t)){if($(e,l.geometricError,m,t)>i){m.visibilityPlaneMask=m.visibility(t,c);if(ie(m.visibilityPlaneMask)){if(m.contentUnloaded){ne(e,m,r)}else{u.push(m)}}}}}}}}else{var y=e._cullWithChildrenBounds&&l._optimChildrenWithinParent===M.USE_OPTIMIZATION;var w;if(p===0){ae(e,l,d,t)}else if(f<=i){if(y){w=le(l,t,false);if(w&A.VISIBLE){ae(e,l,d,t)}else{++s.numberOfTilesCulledWithChildrenUnion}}else{ae(e,l,d,t)}}else if(!e._refineToVisible){var C=l.numberOfChildrenWithoutContent===0;if(C||l.canRequestContent()){te(h,l.computedTransform);ee(h,t);h.sort(re)}if(!C){if(y){w=le(l,t,false)}if(!y||w&A.VISIBLE){ae(e,l,d,t);if(r){for(v=0;v<p;++v){m=h[v];if(m.contentUnloaded){ne(e,m,r)}else{oe(e,m,r)}}}}else if(y){++s.numberOfTilesCulledWithChildrenUnion}}else{w=le(l,t,true);for(v=0;v<p;++v){m=h[v];if(ie(m.visibilityPlaneMask)){u.push(m)}else{oe(e,m,r)}}if(w&A.VISIBLE_IN_REQUEST_VOLUME){l.replaced=true;if(a(l.descendantsWithContent)){ue.push(l)}}else if(!y||w&A.VISIBLE){ae(e,l,d,t)}else if(y){++s.numberOfTilesCulledWithChildrenUnion}}}else{te(h,l.computedTransform);w=le(l,t,true);var b=true;var S=false;for(v=0;v<p;++v){m=h[v];if(ie(m.visibilityPlaneMask)){if(m.contentReady){S=true}else{b=false}}}if(y&&w===A.NONE){if(b&&!S){++s.numberOfTilesCulledWithChildrenUnion}continue}if(b&&!S){ae(e,l,d,t);continue}if(S||l.canRequestContent()){ee(h,t);h.sort(re)}if(!b){ae(e,l,d,t);for(v=0;v<p;++v){m=h[v];if(ie(m.visibilityPlaneMask)){if(m.contentUnloaded){ne(e,m,r)}else{u.push(m)}}}}else{for(v=0;v<p;++v){m=h[v];if(ie(m.visibilityPlaneMask)){u.push(m)}}l.replaced=true;if(a(l.descendantsWithContent)){ue.push(l)}}}}}de(ue,e,t)}function de(e,t,r){var i;var n=e.length;for(var a=0;a<n;++a){var o;var s=true;var u=e[a];var l=u.descendantsWithContent.length;for(o=0;o<l;++o){i=u.descendantsWithContent[o];if(!i.selected&&!i.replaced&&(i.childrenVisibility&A.VISIBLE||i.children.length===0)&&r.cullingVolume.computeVisibility(i.contentBoundingVolume)!==h.OUTSIDE){s=false;break}}if(!s){ae(t,u,true,r);for(o=0;o<l;++o){i=u.descendantsWithContent[o];i.selected=false}}}}function fe(e,t){return function(){e._processingQueue.push(t);--e._statistics.numberOfPendingRequests;++e._statistics.numberProcessing}}function he(e,t){return function(){var r=e._processingQueue.indexOf(t);if(r>=0){e._processingQueue.splice(r,1);--e._statistics.numberProcessing;if(t.hasContent){++e._statistics.numberContentReady;ye(e,t.content);t.replacementNode=e._replacementList.add(t)}}else{--e._statistics.numberOfPendingRequests}}}function pe(e,t){var r=e._processingQueue;var i=r.length;for(var n=i-1;n>=0;--n){r[n].process(e,t)}}function me(e){var t=e._statistics;t.visited=0;t.numberOfCommands=0;t.numberOfAttemptedRequests=0;t.numberOfTilesStyled=0;t.numberOfFeaturesStyled=0;t.numberOfTilesCulledWithChildrenUnion=0;t.numberOfFeaturesSelected=0;t.numberOfPointsSelected=0}function ve(e,t){var r=e._statistics;var i=t?r.lastPick:r.lastColor;i.visited=r.visited;i.numberOfCommands=r.numberOfCommands;i.selected=e._selectedTiles.length;i.numberOfAttemptedRequests=r.numberOfAttemptedRequests;i.numberOfPendingRequests=r.numberOfPendingRequests;i.numberProcessing=r.numberProcessing;i.numberContentReady=r.numberContentReady;i.numberTotal=r.numberTotal;i.numberOfFeaturesSelected=r.numberOfFeaturesSelected;i.numberOfFeaturesLoaded=r.numberOfFeaturesLoaded;i.numberOfPointsSelected=r.numberOfPointsSelected;i.numberOfPointsLoaded=r.numberOfPointsLoaded;i.numberOfTilesStyled=r.numberOfTilesStyled;i.numberOfFeaturesStyled=r.numberOfFeaturesStyled;i.numberOfTilesCulledWithChildrenUnion=r.numberOfTilesCulledWithChildrenUnion;i.vertexMemorySizeInBytes=r.vertexMemorySizeInBytes;i.textureMemorySizeInBytes=r.textureMemorySizeInBytes;i.batchTableMemorySizeInBytes=r.batchTableMemorySizeInBytes}function _e(e,t,r,i){var n=e._statistics;var o=t.innerContents;var s=t.pointsLength;var u=t.featuresLength;var l=t.vertexMemorySizeInBytes;var c=t.textureMemorySizeInBytes;var d=t.batchTableMemorySizeInBytes;if(i){n.numberOfFeaturesLoaded+=r?-u:u;n.numberOfPointsLoaded+=r?-s:s;n.vertexMemorySizeInBytes+=r?-l:l;n.textureMemorySizeInBytes+=r?-c:c;n.batchTableMemorySizeInBytes+=r?-d:d}else{n.numberOfFeaturesSelected+=r?-u:u;n.numberOfPointsSelected+=r?-s:s}if(a(o)){var f=o.length;for(var h=0;h<f;++h){_e(e,o[h],r,i)}}}function ge(e,t){_e(e,t,false,false)}function ye(e,t){_e(e,t,false,true)}function we(e,t){_e(e,t,true,true)}var Ce=new e;function be(t,r){var i=t._selectedTiles;var n=i.length;t._geometricErrorLabels.removeAll();for(var o=0;o<n;++o){var s=i[o];if(s.selected){var u=s._boundingVolume.boundingVolume;var l=u.halfAxes;var c=u.radius;var d=e.clone(u.center,Ce);if(a(l)){d.x+=.75*(l[0]+l[3]+l[6]);d.y+=.75*(l[1]+l[4]+l[7]);d.z+=.75*(l[2]+l[5]+l[8])}else if(a(c)){var f=e.normalize(u.center,Ce);f=e.multiplyByScalar(f,.75*c,Ce);d=e.add(f,u.center,Ce)}t._geometricErrorLabels.add({text:s.geometricError.toString(),position:d})}}t._geometricErrorLabels.update(r)}function Se(e,t){e._styleEngine.applyStyle(e,t);var r=t.commandList;var i=r.length;var n=e._selectedTiles;var o=n.length;var s=e.tileVisible;for(var u=0;u<o;++u){var l=n[u];if(l.selected){s.raiseEvent(l);l.update(e,t);ge(e,l.content)}}e._statistics.numberOfCommands=r.length-i;if(e.debugShowGeometricError){if(!a(e._geometricErrorLabels)){e._geometricErrorLabels=new L}be(e,t)}else{e._geometricErrorLabels=e._geometricErrorLabels&&e._geometricErrorLabels.destroy()}}function Ee(e,t){var r=e._trimTiles;e._trimTiles=false;var i=e._statistics;var n=e._maximumNumberOfLoadedTiles+1;var a=e._replacementList;var o=e.tileUnload;var s=e._replacementSentinel;var u=a.head;while(u!==s&&(a.length>n||r)){var l=u.item;we(e,l.content);o.raiseEvent(l);l.unloadContent();var c=u;u=u.next;a.remove(c);--i.numberContentReady}}q.prototype.trimLoadedTiles=function(){this._trimTiles=true};function Te(e,t){var r=e._statistics;var i=r.numberOfPendingRequests;var n=r.numberProcessing;var a=r.lastColor.numberOfPendingRequests;var o=r.lastColor.numberProcessing;var s=i!==a||n!==o;if(s){t.afterRender.push(function(){e.loadProgress.raiseEvent(i,n)})}e._tilesLoaded=r.numberOfPendingRequests===0&&r.numberProcessing===0&&r.numberOfAttemptedRequests===0;if(s&&e._tilesLoaded){t.afterRender.push(function(){e.allTilesLoaded.raiseEvent()})}}q.prototype.update=function(e){if(!this.show||!this.ready){return}if(!a(this._loadTimestamp)){this._loadTimestamp=v.clone(e.time)}this._timeSinceLoad=Math.max(v.secondsDifference(e.time,this._loadTimestamp),0);var t=e.passes;var r=t.pick&&!t.render;var i=!r;me(this);if(i){pe(this,e)}if(this.dynamicScreenSpaceError){J(this,e)}ce(this,e,i);Se(this,e);if(i){Ee(this,e)}Te(this,e);ve(this,r)};q.prototype.isDestroyed=function(){return false};q.prototype.destroy=function(){if(a(this._root)){var e=se;e.push(this._root);while(e.length>0){var t=e.pop();t.destroy();var r=t.children;var i=r.length;for(var n=0;n<i;++n){e.push(r[n])}}}this._root=undefined;return s(this)};return q});define("ThirdParty/jsep",[],function(){"use strict";var e="Compound",t="Identifier",r="MemberExpression",i="Literal",n="ThisExpression",a="CallExpression",o="UnaryExpression",s="BinaryExpression",u="LogicalExpression",l="ConditionalExpression",c="ArrayExpression",d=46,f=44,h=39,p=34,m=40,v=41,_=91,g=93,y=63,w=59,C=58,b=function(e,t){var r=new Error(e+" at character "+t);r.index=t;r.description=e;throw r},S=true,E={"-":S,"!":S,"~":S,"+":S},T={"||":1,"&&":2,"|":3,"^":4,"&":5,"==":6,"!=":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":10,"/":10,"%":10},x=function(e){var t=0,r;for(var i in e){if((r=i.length)>t&&e.hasOwnProperty(i)){t=r}}return t},A=x(E),P=x(T),D={true:true,false:false,null:null},M="this",I=function(e){return T[e]||0},O=function(e,t,r){var i=e==="||"||e==="&&"?u:s;return{type:i,operator:e,left:t,right:r}},R=function(e){return e>=48&&e<=57},N=function(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122},L=function(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57},B=function(s){var u=0,S=s.charAt,x=s.charCodeAt,B=function(e){return S.call(s,e)},F=function(e){return x.call(s,e)},k=s.length,V=function(){var e=F(u);while(e===32||e===9){e=F(++u)}},z=function(){var e=q(),t,r;V();if(F(u)===y){u++;t=z();if(!t){b("Expected expression",u)}V();if(F(u)===C){u++;r=z();if(!r){b("Expected expression",u)}return{type:l,test:e,consequent:t,alternate:r}}else{b("Expected :",u)}}else{return e}},U=function(){V();var e,t=s.substr(u,P),r=t.length;while(r>0){if(T.hasOwnProperty(t)){u+=r;return t}t=t.substr(0,--r)}return false},q=function(){var e,t,r,i,n,a,o,s,l;o=G();r=U();if(!r){return o}a={value:r,prec:I(r)};s=G();if(!s){b("Expected expression after "+r,u)}n=[o,a,s];while(r=U()){i=I(r);if(i===0){break}a={value:r,prec:i};while(n.length>2&&i<=n[n.length-2].prec){s=n.pop();r=n.pop().value;o=n.pop();t=O(r,o,s);n.push(t)}t=G();if(!t){b("Expected expression after "+r,u)}n.push(a,t)}l=n.length-1;t=n[l];while(l>1){t=O(n[l-1].value,n[l-2],t);l-=2}return t},G=function(){var e,t,r;V();e=F(u);if(R(e)||e===d){return H()}else if(e===h||e===p){return W()}else if(N(e)||e===m){return X()}else if(e===_){return K()}else{t=s.substr(u,A);r=t.length;while(r>0){if(E.hasOwnProperty(t)){u+=r;return{type:o,operator:t,argument:G(),prefix:true}}t=t.substr(0,--r)}return false}},H=function(){var e="",t,r;while(R(F(u))){e+=B(u++)}if(F(u)===d){e+=B(u++);while(R(F(u))){e+=B(u++)}}t=B(u);if(t==="e"||t==="E"){e+=B(u++);t=B(u);if(t==="+"||t==="-"){e+=B(u++)}while(R(F(u))){e+=B(u++)}if(!R(F(u-1))){b("Expected exponent ("+e+B(u)+")",u)}}r=F(u);if(N(r)){b("Variable names cannot start with a number ("+e+B(u)+")",u)}else if(r===d){b("Unexpected period",u)}return{type:i,value:parseFloat(e),raw:e}},W=function(){var e="",t=B(u++),r=false,n;while(u<k){n=B(u++);if(n===t){r=true;break}else if(n==="\\"){n=B(u++);switch(n){case"n":e+="\n";break;case"r":e+="\r";break;case"t":e+="\t";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break}}else{e+=n}}if(!r){b('Unclosed quote after "'+e+'"',u)}return{type:i,value:e,raw:t+e+t}},j=function(){var e=F(u),r=u,a;if(N(e)){u++}else{b("Unexpected "+B(u),u)}while(u<k){e=F(u);if(L(e)){u++}else{break}}a=s.slice(r,u);if(D.hasOwnProperty(a)){return{type:i,value:D[a],raw:a}}else if(a===M){return{type:n}}else{return{type:t,name:a}}},Y=function(t){var r,i=[],n;while(u<k){V();r=F(u);if(r===t){u++;break}else if(r===f){u++}else{n=z();if(!n||n.type===e){b("Expected comma",u)}i.push(n)}}return i},X=function(){var e,t;e=F(u);if(e===m){t=Z()}else{t=j()}V();e=F(u);while(e===d||e===_||e===m){u++;if(e===d){V();t={type:r,computed:false,object:t,property:j()}}else if(e===_){t={type:r,computed:true,object:t,property:z()};V();e=F(u);if(e!==g){b("Unclosed [",u)}u++}else if(e===m){t={type:a,arguments:Y(v),callee:t}}V();e=F(u)}return t},Z=function(){u++;var e=z();V();if(F(u)===v){u++;return e}else{b("Unclosed (",u)}},K=function(){u++;return{type:c,elements:Y(g)}},Q=[],J,$;while(u<k){J=F(u);if(J===w||J===f){u++}else{if($=z()){Q.push($)}else if(u<k){b('Unexpected "'+B(u)+'"',u)}}}if(Q.length===1){return Q[0]}else{return{type:e,body:Q}}};B.version="0.3.0";B.toString=function(){return"JavaScript Expression Parser (JSEP) v"+B.version};B.addUnaryOp=function(e){E[e]=S;return this};B.addBinaryOp=function(e,t){P=Math.max(e.length,P);T[e]=t;return this};B.removeUnaryOp=function(e){delete E[e];if(e.length===A){A=x(E)}return this};B.removeBinaryOp=function(e){delete T[e];if(e.length===P){P=x(T)}return this};return B});define("Scene/ExpressionNodeType",["../Core/freezeObject"],function(e){"use strict";var t={VARIABLE:0,UNARY:1,BINARY:2,TERNARY:3,CONDITIONAL:4,MEMBER:5,FUNCTION_CALL:6,ARRAY:7,REGEX:8,VARIABLE_IN_STRING:9,LITERAL_NULL:10,LITERAL_BOOLEAN:11,LITERAL_NUMBER:12,LITERAL_STRING:13,LITERAL_COLOR:14,LITERAL_VECTOR:15,LITERAL_REGEX:16,LITERAL_UNDEFINED:17,BUILTIN_VARIABLE:18};return e(t)});define("Scene/Expression",["../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Color","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/isArray","../Core/Math","../ThirdParty/jsep","./ExpressionNodeType"],function(e,t,r,i,n,a,o,s,u,l,c){"use strict";var d=["!","-","+"];var f=["+","-","*","/","%","===","!==",">",">=","<","<=","&&","||","!~","=~"];var h=/\${(.*?)}/g;var p=/\\/g;var m="@#%";var v=/@#%/g;var _=new i;var g={scratchArrayIndex:0,scratchArrayArray:[[]],scratchCartesian2Index:0,scratchCartesian3Index:0,scratchCartesian4Index:0,scratchCartesian2Array:[new e],scratchCartesian3Array:[new t],scratchCartesian4Array:[new r],reset:function(){this.scratchArrayIndex=0;this.scratchCartesian2Index=0;this.scratchCartesian3Index=0;this.scratchCartesian4Index=0},getArray:function(){if(this.scratchArrayIndex>=this.scratchArrayArray.length){this.scratchArrayArray.push([])}var e=this.scratchArrayArray[this.scratchArrayIndex++];e.length=0;return e},getCartesian2:function(){if(this.scratchCartesian2Index>=this.scratchCartesian2Array.length){this.scratchCartesian2Array.push(new e)}return this.scratchCartesian2Array[this.scratchCartesian2Index++]},getCartesian3:function(){if(this.scratchCartesian3Index>=this.scratchCartesian3Array.length){this.scratchCartesian3Array.push(new t)}return this.scratchCartesian3Array[this.scratchCartesian3Index++]},getCartesian4:function(){if(this.scratchCartesian4Index>=this.scratchCartesian4Array.length){this.scratchCartesian4Array.push(new r)}return this.scratchCartesian4Array[this.scratchCartesian4Index++]}};var y={atan2:Math.atan2,pow:Math.pow,min:Math.min,max:Math.max};var w={abs:Math.abs,sqrt:Math.sqrt,cos:Math.cos,sin:Math.sin,tan:Math.tan,acos:Math.acos,asin:Math.asin,atan:Math.atan,radians:u.toRadians,degrees:u.toDegrees,sign:u.sign,floor:Math.floor,ceil:Math.ceil,round:Math.round,exp:Math.exp,exp2:S,log:Math.log,log2:E,fract:b};var C={clamp:u.clamp,mix:u.lerp};function b(e){return e-Math.floor(e)}function S(e){return Math.pow(2,e)}function E(e){return u.logBase(e,2)}function T(e){if(typeof e!=="string"){throw new o("expression must be a string.")}this._expression=e;e=D(A(e));l.addBinaryOp("=~",0);l.addBinaryOp("!~",0);var t;try{t=l(e)}catch(e){throw new o(e)}this._runtimeAst=V(this,t)}a(T.prototype,{expression:{get:function(){return this._expression}}});T.prototype.evaluate=function(i,n){g.reset();var a=this._runtimeAst.evaluate(i,n);if(a instanceof e||a instanceof t||a instanceof r){return a.clone()}return a};T.prototype.evaluateColor=function(e,t,r){g.reset();var n=this._runtimeAst.evaluate(e,t);return i.fromCartesian4(n,r)};T.prototype.getShaderFunction=function(e,t,r,i){var a=this.getShaderExpression(t,r);if(!n(a)){return undefined}a=i+" "+e+"() \n"+"{ \n"+"    return "+a+"; \n"+"} \n";return a};T.prototype.getShaderExpression=function(e,t){return this._runtimeAst.getShaderExpression(e,t)};function x(e,t,r,i,n){this._type=e;this._value=t;this._left=r;this._right=i;this._test=n;this.evaluate=undefined;z(this)}function A(e){return e.replace(p,m)}function P(e){return e.replace(v,"\\")}function D(e){var t=e;var r="";var i=t.indexOf("${");while(i>=0){var n=t.indexOf("'");var a=t.indexOf('"');var s;if(n>=0&&n<i){s=t.indexOf("'",n+1);r+=t.substr(0,s+1);t=t.substr(s+1);i=t.indexOf("${")}else if(a>=0&&a<i){s=t.indexOf('"',a+1);r+=t.substr(0,s+1);t=t.substr(s+1);i=t.indexOf("${")}else{r+=t.substr(0,i);var u=t.indexOf("}");if(u<0){throw new o("Unmatched {.")}r+="czm_"+t.substr(i+2,u-(i+2));t=t.substr(u+1);i=t.indexOf("${")}}r+=t;return r}function M(e){var t=typeof e.value;if(e.value===null){return new x(c.LITERAL_NULL,null)}else if(t==="boolean"){return new x(c.LITERAL_BOOLEAN,e.value)}else if(t==="number"){return new x(c.LITERAL_NUMBER,e.value)}else if(t==="string"){if(e.value.indexOf("${")>=0){return new x(c.VARIABLE_IN_STRING,e.value)}return new x(c.LITERAL_STRING,P(e.value))}}function I(e,t){var r=t.arguments;var i=r.length;var a;var s,u,l;if(t.callee.type==="MemberExpression"){a=t.callee.property.name;var d=t.callee.object;if(a==="test"||a==="exec"){if(d.callee.name!=="regExp"){throw new o(a+" is not a function.")}if(i===0){if(a==="test"){return new x(c.LITERAL_BOOLEAN,false)}else{return new x(c.LITERAL_NULL,null)}}u=V(e,d);l=V(e,r[0]);return new x(c.FUNCTION_CALL,a,u,l)}else if(a==="toString"){s=V(e,d);return new x(c.FUNCTION_CALL,a,s)}throw new o('Unexpected function call "'+a+'".')}a=t.callee.name;if(a==="color"){if(i===0){return new x(c.LITERAL_COLOR,a)}s=V(e,r[0]);if(n(r[1])){var f=V(e,r[1]);return new x(c.LITERAL_COLOR,a,[s,f])}return new x(c.LITERAL_COLOR,a,[s])}else if(a==="rgb"||a==="hsl"){if(i<3){throw new o(a+" requires three arguments.")}s=[V(e,r[0]),V(e,r[1]),V(e,r[2])];return new x(c.LITERAL_COLOR,a,s)}else if(a==="rgba"||a==="hsla"){if(i<4){throw new o(a+" requires four arguments.")}s=[V(e,r[0]),V(e,r[1]),V(e,r[2]),V(e,r[3])];return new x(c.LITERAL_COLOR,a,s)}else if(a==="vec2"||a==="vec3"||a==="vec4"){s=new Array(i);for(var h=0;h<i;++h){s[h]=V(e,r[h])}return new x(c.LITERAL_VECTOR,a,s)}else if(a==="isNaN"||a==="isFinite"){if(i===0){if(a==="isNaN"){return new x(c.LITERAL_BOOLEAN,true)}else{return new x(c.LITERAL_BOOLEAN,false)}}s=V(e,r[0]);return new x(c.UNARY,a,s)}else if(a==="isExactClass"||a==="isClass"){if(i<1||i>1){throw new o(a+" requires exactly one argument.")}s=V(e,r[0]);return new x(c.UNARY,a,s)}else if(a==="getExactClassName"){if(i>0){throw new o(a+" does not take any argument.")}return new x(c.UNARY,a)}else if(n(w[a])){if(i!==1){throw new o(a+" requires exactly one argument.")}s=V(e,r[0]);return new x(c.UNARY,a,s)}else if(n(y[a])){if(i!==2){throw new o(a+" requires exactly two arguments.")}u=V(e,r[0]);l=V(e,r[1]);return new x(c.BINARY,a,u,l)}else if(n(C[a])){if(i!==3){throw new o(a+" requires exactly three arguments.")}u=V(e,r[0]);l=V(e,r[1]);var p=V(e,r[2]);return new x(c.TERNARY,a,u,l,p)}else if(a==="Boolean"){if(i===0){return new x(c.LITERAL_BOOLEAN,false)}s=V(e,r[0]);return new x(c.UNARY,a,s)}else if(a==="Number"){if(i===0){return new x(c.LITERAL_NUMBER,0)}s=V(e,r[0]);return new x(c.UNARY,a,s)}else if(a==="String"){if(i===0){return new x(c.LITERAL_STRING,"")}s=V(e,r[0]);return new x(c.UNARY,a,s)}else if(a==="regExp"){return O(e,t)}throw new o('Unexpected function call "'+a+'".')}function O(e,t){var r=t.arguments;if(r.length===0){return new x(c.LITERAL_REGEX,new RegExp)}var i=V(e,r[0]);var n;if(r.length>1){var a=V(e,r[1]);if(B(i)&&B(a)){try{n=new RegExp(P(String(i._value)),a._value)}catch(e){throw new o(e)}return new x(c.LITERAL_REGEX,n)}return new x(c.REGEX,i,a)}if(B(i)){try{n=new RegExp(P(String(i._value)))}catch(e){throw new o(e)}return new x(c.LITERAL_REGEX,n)}return new x(c.REGEX,i)}function R(e){if(F(e.name)){var t=k(e.name);if(t.substr(0,8)==="tiles3d_"){return new x(c.BUILTIN_VARIABLE,t)}else{return new x(c.VARIABLE,t)}}else if(e.name==="NaN"){return new x(c.LITERAL_NUMBER,NaN)}else if(e.name==="Infinity"){return new x(c.LITERAL_NUMBER,Infinity)}else if(e.name==="undefined"){return new x(c.LITERAL_UNDEFINED,undefined)}throw new o(e.name+" is not defined.")}function N(e){var t=e.property.name;if(t==="PI"){return new x(c.LITERAL_NUMBER,Math.PI)}else if(t==="E"){return new x(c.LITERAL_NUMBER,Math.E)}}function L(e,t){if(t.object.name==="Math"){return N(t)}var r;var i=V(e,t.object);if(t.computed){r=V(e,t.property);return new x(c.MEMBER,"brackets",i,r)}else{r=new x(c.LITERAL_STRING,t.property.name);return new x(c.MEMBER,"dot",i,r)}}function B(e){return e._type>=c.LITERAL_NULL}function F(e){return e.substr(0,4)==="czm_"}function k(e){return e.substr(4)}function V(e,t){var r;var i;var n;var a;if(t.type==="Literal"){r=M(t)}else if(t.type==="CallExpression"){r=I(e,t)}else if(t.type==="Identifier"){r=R(t)}else if(t.type==="UnaryExpression"){i=t.operator;var s=V(e,t.argument);if(d.indexOf(i)>-1){r=new x(c.UNARY,i,s)}else{throw new o('Unexpected operator "'+i+'".')}}else if(t.type==="BinaryExpression"){i=t.operator;n=V(e,t.left);a=V(e,t.right);if(f.indexOf(i)>-1){r=new x(c.BINARY,i,n,a)}else{throw new o('Unexpected operator "'+i+'".')}}else if(t.type==="LogicalExpression"){i=t.operator;n=V(e,t.left);a=V(e,t.right);if(f.indexOf(i)>-1){r=new x(c.BINARY,i,n,a)}}else if(t.type==="ConditionalExpression"){var u=V(e,t.test);n=V(e,t.consequent);a=V(e,t.alternate);r=new x(c.CONDITIONAL,"?",n,a,u)}else if(t.type==="MemberExpression"){r=L(e,t)}else if(t.type==="ArrayExpression"){var l=[];for(var h=0;h<t.elements.length;h++){l[h]=V(e,t.elements[h])}r=new x(c.ARRAY,l)}else if(t.type==="Compound"){throw new o("Provide exactly one expression.")}else{throw new o("Cannot parse expression.")}return r}function z(e){if(e._type===c.CONDITIONAL){e.evaluate=e._evaluateConditional}else if(e._type===c.FUNCTION_CALL){if(e._value==="test"){e.evaluate=e._evaluateRegExpTest}else if(e._value==="exec"){e.evaluate=e._evaluateRegExpExec}else if(e._value==="toString"){e.evaluate=e._evaluateToString}}else if(e._type===c.UNARY){if(e._value==="!"){e.evaluate=e._evaluateNot}else if(e._value==="-"){e.evaluate=e._evaluateNegative}else if(e._value==="+"){e.evaluate=e._evaluatePositive}else if(e._value==="isNaN"){e.evaluate=e._evaluateNaN}else if(e._value==="isFinite"){e.evaluate=e._evaluateIsFinite}else if(e._value==="isExactClass"){e.evaluate=e._evaluateIsExactClass}else if(e._value==="isClass"){e.evaluate=e._evaluateIsClass}else if(e._value==="getExactClassName"){e.evaluate=e._evaluategetExactClassName}else if(e._value==="Boolean"){e.evaluate=e._evaluateBooleanConversion}else if(e._value==="Number"){e.evaluate=e._evaluateNumberConversion}else if(e._value==="String"){e.evaluate=e._evaluateStringConversion}else if(n(w[e._value])){e.evaluate=q(e._value)}}else if(e._type===c.BINARY){if(e._value==="+"){e.evaluate=e._evaluatePlus}else if(e._value==="-"){e.evaluate=e._evaluateMinus}else if(e._value==="*"){e.evaluate=e._evaluateTimes}else if(e._value==="/"){e.evaluate=e._evaluateDivide}else if(e._value==="%"){e.evaluate=e._evaluateMod}else if(e._value==="==="){e.evaluate=e._evaluateEqualsStrict}else if(e._value==="!=="){e.evaluate=e._evaluateNotEqualsStrict}else if(e._value==="<"){e.evaluate=e._evaluateLessThan}else if(e._value==="<="){e.evaluate=e._evaluateLessThanOrEquals}else if(e._value===">"){e.evaluate=e._evaluateGreaterThan}else if(e._value===">="){e.evaluate=e._evaluateGreaterThanOrEquals}else if(e._value==="&&"){e.evaluate=e._evaluateAnd}else if(e._value==="||"){e.evaluate=e._evaluateOr}else if(e._value==="=~"){e.evaluate=e._evaluateRegExpMatch}else if(e._value==="!~"){e.evaluate=e._evaluateRegExpNotMatch}else if(n(y[e._value])){e.evaluate=G(e._value)}}else if(e._type===c.TERNARY){e.evaluate=H(e._value)}else if(e._type===c.MEMBER){if(e._value==="brackets"){e.evaluate=e._evaluateMemberBrackets}else{e.evaluate=e._evaluateMemberDot}}else if(e._type===c.ARRAY){e.evaluate=e._evaluateArray}else if(e._type===c.VARIABLE){e.evaluate=e._evaluateVariable}else if(e._type===c.VARIABLE_IN_STRING){e.evaluate=e._evaluateVariableString}else if(e._type===c.LITERAL_COLOR){e.evaluate=e._evaluateLiteralColor}else if(e._type===c.LITERAL_VECTOR){e.evaluate=e._evaluateLiteralVector}else if(e._type===c.LITERAL_STRING){e.evaluate=e._evaluateLiteralString}else if(e._type===c.REGEX){e.evaluate=e._evaluateRegExp}else if(e._type===c.BUILTIN_VARIABLE){if(e._value==="tiles3d_tileset_time"){e.evaluate=U}}else{e.evaluate=e._evaluateLiteral}}function U(e,t){return t._content._tileset.timeSinceLoad}function q(i){var n=w[i];return function(a){var s=this._left.evaluate(a);if(typeof s==="number"){return n(s)}else if(s instanceof e){return e.fromElements(n(s.x),n(s.y),g.getCartesian2())}else if(s instanceof t){return t.fromElements(n(s.x),n(s.y),n(s.z),g.getCartesian3())}else if(s instanceof r){return r.fromElements(n(s.x),n(s.y),n(s.z),n(s.w),g.getCartesian4())}throw new o('Function "'+i+'" requires a vector or number argument. Argument is '+s+".");return n(s)}}function G(e){var t=y[e];return function(e){return t(this._left.evaluate(e),this._right.evaluate(e))}}function H(e){var t=C[e];return function(e){return t(this._left.evaluate(e),this._right.evaluate(e),this._test.evaluate(e))}}x.prototype._evaluateLiteral=function(e,t){return this._value};x.prototype._evaluateLiteralColor=function(e,t){var a=_;var o=this._left;if(this._value==="color"){if(!n(o)){i.fromBytes(255,255,255,255,a)}else if(o.length>1){
i.fromCssColorString(o[0].evaluate(e,t),a);a.alpha=o[1].evaluate(e,t)}else{i.fromCssColorString(o[0].evaluate(e,t),a)}}else if(this._value==="rgb"){i.fromBytes(o[0].evaluate(e,t),o[1].evaluate(e,t),o[2].evaluate(e,t),255,a)}else if(this._value==="rgba"){var s=o[3].evaluate(e,t)*255;i.fromBytes(o[0].evaluate(e,t),o[1].evaluate(e,t),o[2].evaluate(e,t),s,a)}else if(this._value==="hsl"){i.fromHsl(o[0].evaluate(e,t),o[1].evaluate(e,t),o[2].evaluate(e,t),1,a)}else if(this._value==="hsla"){i.fromHsl(o[0].evaluate(e,t),o[1].evaluate(e,t),o[2].evaluate(e,t),o[3].evaluate(e,t),a)}return r.fromColor(a,g.getCartesian4())};x.prototype._evaluateLiteralVector=function(i,n){var a=g.getArray();var s=this._value;var u=this._left;var l=u.length;for(var c=0;c<l;++c){var d=u[c].evaluate(i,n);if(typeof d==="number"){a.push(d)}else if(d instanceof e){a.push(d.x,d.y)}else if(d instanceof t){a.push(d.x,d.y,d.z)}else if(d instanceof r){a.push(d.x,d.y,d.z,d.w)}else{throw new o(s+" argument must be a vector or number. Argument is "+d+".")}}var f=a.length;var h=parseInt(s.charAt(3));if(f===0){throw new o("Invalid "+s+" constructor. No valid arguments.")}else if(f<h&&f>1){throw new o("Invalid "+s+" constructor. Not enough arguments.")}else if(f>h&&l>1){throw new o("Invalid "+s+" constructor. Too many arguments.")}if(f===1){var p=a[0];a.push(p,p,p)}if(s==="vec2"){return e.fromArray(a,0,g.getCartesian2())}else if(s==="vec3"){return t.fromArray(a,0,g.getCartesian3())}else if(s==="vec4"){return r.fromArray(a,0,g.getCartesian4())}};x.prototype._evaluateLiteralString=function(e,t){return this._value};x.prototype._evaluateVariableString=function(e,t){var r=this._value;var i=h.exec(r);while(i!==null){var a=i[0];var o=i[1];var s=t.getProperty(o);if(!n(s)){s=""}r=r.replace(a,s);i=h.exec(r)}return r};x.prototype._evaluateVariable=function(e,t){return t.getProperty(this._value)};function W(e){return e._value==="feature"}x.prototype._evaluateMemberDot=function(i,a){if(W(this._left)){return a.getProperty(this._right.evaluate(i,a))}var o=this._left.evaluate(i,a);if(!n(o)){return undefined}var s=this._right.evaluate(i,a);if(o instanceof e||o instanceof t||o instanceof r){if(s==="r"){return o.x}else if(s==="g"){return o.y}else if(s==="b"){return o.z}else if(s==="a"){return o.w}}return o[s]};x.prototype._evaluateMemberBrackets=function(i,a){if(W(this._left)){return a.getProperty(this._right.evaluate(i,a))}var o=this._left.evaluate(i,a);if(!n(o)){return undefined}var s=this._right.evaluate(i,a);if(o instanceof e||o instanceof t||o instanceof r){if(s===0||s==="r"){return o.x}else if(s===1||s==="g"){return o.y}else if(s===2||s==="b"){return o.z}else if(s===3||s==="a"){return o.w}}return o[s]};x.prototype._evaluateArray=function(e,t){var r=[];for(var i=0;i<this._value.length;i++){r[i]=this._value[i].evaluate(e,t)}return r};x.prototype._evaluateNot=function(e,t){var r=this._left.evaluate(e,t);if(typeof r!=="boolean"){throw new o('Operator "!" requires a boolean argument. Argument is '+r+".")}return!r};x.prototype._evaluateNegative=function(i,n){var a=this._left.evaluate(i,n);if(a instanceof e){return e.negate(a,g.getCartesian2())}else if(a instanceof t){return t.negate(a,g.getCartesian3())}else if(a instanceof r){return r.negate(a,g.getCartesian4())}else if(typeof a==="number"){return-a}throw new o('Operator "-" requires a vector or number argument. Argument is '+a+".");return-a};x.prototype._evaluatePositive=function(i,n){var a=this._left.evaluate(i,n);if(!(a instanceof e||a instanceof t||a instanceof r||typeof a==="number")){throw new o('Operator "+" requires a vector or number argument. Argument is '+a+".")}return a};x.prototype._evaluateLessThan=function(e,t){var r=this._left.evaluate(e,t);var i=this._right.evaluate(e,t);if(typeof r!=="number"||typeof i!=="number"){throw new o('Operator "<" requires number arguments. Arguments are '+r+" and "+i+".")}return r<i};x.prototype._evaluateLessThanOrEquals=function(e,t){var r=this._left.evaluate(e,t);var i=this._right.evaluate(e,t);if(typeof r!=="number"||typeof i!=="number"){throw new o('Operator "<=" requires number arguments. Arguments are '+r+" and "+i+".")}return r<=i};x.prototype._evaluateGreaterThan=function(e,t){var r=this._left.evaluate(e,t);var i=this._right.evaluate(e,t);if(typeof r!=="number"||typeof i!=="number"){throw new o('Operator ">" requires number arguments. Arguments are '+r+" and "+i+".")}return r>i};x.prototype._evaluateGreaterThanOrEquals=function(e,t){var r=this._left.evaluate(e,t);var i=this._right.evaluate(e,t);if(typeof r!=="number"||typeof i!=="number"){throw new o('Operator ">=" requires number arguments. Arguments are '+r+" and "+i+".")}return r>=i};x.prototype._evaluateOr=function(e,t){var r=this._left.evaluate(e,t);if(typeof r!=="boolean"){throw new o('Operator "||" requires boolean arguments. First argument is '+r+".")}if(r){return true}var i=this._right.evaluate(e,t);if(typeof i!=="boolean"){throw new o('Operator "||" requires boolean arguments. Second argument is '+i+".")}return r||i};x.prototype._evaluateAnd=function(e,t){var r=this._left.evaluate(e,t);if(typeof r!=="boolean"){throw new o('Operator "&&" requires boolean arguments. First argument is '+r+".")}if(!r){return false}var i=this._right.evaluate(e,t);if(typeof i!=="boolean"){throw new o('Operator "&&" requires boolean arguments. Second argument is '+i+".")}return r&&i};x.prototype._evaluatePlus=function(i,n){var a=this._left.evaluate(i,n);var s=this._right.evaluate(i,n);if(s instanceof e&&a instanceof e){return e.add(a,s,g.getCartesian2())}else if(s instanceof t&&a instanceof t){return t.add(a,s,g.getCartesian3())}else if(s instanceof r&&a instanceof r){return r.add(a,s,g.getCartesian4())}else if(typeof a==="string"||typeof s==="string"){return a+s}else if(typeof a==="number"&&typeof s==="number"){return a+s}throw new o('Operator "+" requires vector or number arguments of matching types, or at least one string argument. Arguments are '+a+" and "+s+".");return a+s};x.prototype._evaluateMinus=function(i,n){var a=this._left.evaluate(i,n);var s=this._right.evaluate(i,n);if(s instanceof e&&a instanceof e){return e.subtract(a,s,g.getCartesian2())}else if(s instanceof t&&a instanceof t){return t.subtract(a,s,g.getCartesian3())}else if(s instanceof r&&a instanceof r){return r.subtract(a,s,g.getCartesian4())}else if(typeof a==="number"&&typeof s==="number"){return a-s}throw new o('Operator "-" requires vector or number arguments of matching types. Arguments are '+a+" and "+s+".");return a-s};x.prototype._evaluateTimes=function(i,n){var a=this._left.evaluate(i,n);var s=this._right.evaluate(i,n);if(s instanceof e&&a instanceof e){return e.multiplyComponents(a,s,g.getCartesian2())}else if(s instanceof e&&typeof a==="number"){return e.multiplyByScalar(s,a,g.getCartesian2())}else if(a instanceof e&&typeof s==="number"){return e.multiplyByScalar(a,s,g.getCartesian2())}else if(s instanceof t&&a instanceof t){return t.multiplyComponents(a,s,g.getCartesian3())}else if(s instanceof t&&typeof a==="number"){return t.multiplyByScalar(s,a,g.getCartesian3())}else if(a instanceof t&&typeof s==="number"){return t.multiplyByScalar(a,s,g.getCartesian3())}else if(s instanceof r&&a instanceof r){return r.multiplyComponents(a,s,g.getCartesian4())}else if(s instanceof r&&typeof a==="number"){return r.multiplyByScalar(s,a,g.getCartesian4())}else if(a instanceof r&&typeof s==="number"){return r.multiplyByScalar(a,s,g.getCartesian4())}else if(typeof a==="number"&&typeof s==="number"){return a*s}throw new o('Operator "*" requires vector or number arguments. If both arguments are vectors they must be matching types. Arguments are '+a+" and "+s+".");return a*s};x.prototype._evaluateDivide=function(i,n){var a=this._left.evaluate(i,n);var s=this._right.evaluate(i,n);if(s instanceof e&&a instanceof e){return e.divideComponents(a,s,g.getCartesian2())}else if(a instanceof e&&typeof s==="number"){return e.divideByScalar(a,s,g.getCartesian2())}else if(s instanceof t&&a instanceof t){return t.divideComponents(a,s,g.getCartesian3())}else if(a instanceof t&&typeof s==="number"){return t.divideByScalar(a,s,g.getCartesian3())}else if(s instanceof r&&a instanceof r){return r.divideComponents(a,s,g.getCartesian4())}else if(a instanceof r&&typeof s==="number"){return r.divideByScalar(a,s,g.getCartesian4())}else if(typeof a==="number"&&typeof s==="number"){return a/s}throw new o('Operator "/" requires vector or number arguments of matching types, or a number as the second argument. Arguments are '+a+" and "+s+".");return a/s};x.prototype._evaluateMod=function(i,n){var a=this._left.evaluate(i,n);var s=this._right.evaluate(i,n);if(s instanceof e&&a instanceof e){return e.fromElements(a.x%s.x,a.y%s.y,g.getCartesian2())}else if(s instanceof t&&a instanceof t){return t.fromElements(a.x%s.x,a.y%s.y,a.z%s.z,g.getCartesian3())}else if(s instanceof r&&a instanceof r){return r.fromElements(a.x%s.x,a.y%s.y,a.z%s.z,a.w%s.w,g.getCartesian4())}else if(typeof a==="number"&&typeof s==="number"){return a%s}throw new o('Operator "%" requires vector or number arguments of matching types. Arguments are '+a+" and "+s+".");return a%s};x.prototype._evaluateEqualsStrict=function(i,n){var a=this._left.evaluate(i,n);var o=this._right.evaluate(i,n);if(o instanceof e&&a instanceof e||o instanceof t&&a instanceof t||o instanceof r&&a instanceof r){return a.equals(o)}return a===o};x.prototype._evaluateNotEqualsStrict=function(i,n){var a=this._left.evaluate(i,n);var o=this._right.evaluate(i,n);if(o instanceof e&&a instanceof e||o instanceof t&&a instanceof t||o instanceof r&&a instanceof r){return!a.equals(o)}return a!==o};x.prototype._evaluateConditional=function(e,t){var r=this._test.evaluate(e,t);if(typeof r!=="boolean"){throw new o("Conditional argument of conditional expression must be a boolean. Argument is "+r+".")}if(r){return this._left.evaluate(e,t)}return this._right.evaluate(e,t)};x.prototype._evaluateNaN=function(e,t){return isNaN(this._left.evaluate(e,t))};x.prototype._evaluateIsFinite=function(e,t){return isFinite(this._left.evaluate(e,t))};x.prototype._evaluateIsExactClass=function(e,t){return t.isExactClass(this._left.evaluate(e,t))};x.prototype._evaluateIsClass=function(e,t){return t.isClass(this._left.evaluate(e,t))};x.prototype._evaluategetExactClassName=function(e,t){return t.getExactClassName()};x.prototype._evaluateBooleanConversion=function(e,t){return Boolean(this._left.evaluate(e,t))};x.prototype._evaluateNumberConversion=function(e,t){return Number(this._left.evaluate(e,t))};x.prototype._evaluateStringConversion=function(e,t){return String(this._left.evaluate(e,t))};x.prototype._evaluateRegExp=function(e,t){var r=this._value.evaluate(e,t);var i="";if(n(this._left)){i=this._left.evaluate(e,t)}var a;try{a=new RegExp(r,i)}catch(e){throw new o(e)}return a};x.prototype._evaluateRegExpTest=function(e,t){var r=this._left.evaluate(e,t);var i=this._right.evaluate(e,t);if(!(r instanceof RegExp&&typeof i==="string")){throw new o("RegExp.test requires the first argument to be a RegExp and the second argument to be a string. Arguments are "+r+" and "+i+".")}return r.test(i)};x.prototype._evaluateRegExpMatch=function(e,t){var r=this._left.evaluate(e,t);var i=this._right.evaluate(e,t);if(r instanceof RegExp&&typeof i==="string"){return r.test(i)}else if(i instanceof RegExp&&typeof r==="string"){return i.test(r)}throw new o('Operator "=~" requires one RegExp argument and one string argument. Arguments are '+r+" and "+i+".");return false};x.prototype._evaluateRegExpNotMatch=function(e,t){var r=this._left.evaluate(e,t);var i=this._right.evaluate(e,t);if(r instanceof RegExp&&typeof i==="string"){return!r.test(i)}else if(i instanceof RegExp&&typeof r==="string"){return!i.test(r)}throw new o('Operator "!~" requires one RegExp argument and one string argument. Arguments are '+r+" and "+i+".");return false};x.prototype._evaluateRegExpExec=function(e,t){var r=this._left.evaluate(e,t);var i=this._right.evaluate(e,t);if(!(r instanceof RegExp&&typeof i==="string")){throw new o("RegExp.exec requires the first argument to be a RegExp and the second argument to be a string. Arguments are "+r+" and "+i+".")}var a=r.exec(i);if(!n(a)){return null}return a[1]};x.prototype._evaluateToString=function(i,n){var a=this._left.evaluate(i,n);if(a instanceof RegExp||a instanceof e||a instanceof t||a instanceof r){return String(a)}else{throw new o('Unexpected function call "'+this._value+'".')}};function j(e){var t=e._left;var r=t.length;for(var n=0;n<r;++n){if(t[n]._type!==c.LITERAL_NUMBER){return undefined}}var a=t[0]._value;var o=t[1]._value;var s=t[2]._value;var u=r===4?t[3]._value:1;return i.fromHsl(a,o,s,u,_)}function Y(e){var t=e._left;var r=t.length;for(var i=0;i<r;++i){if(t[i]._type!==c.LITERAL_NUMBER){return undefined}}var n=_;n.red=t[0]._value/255;n.green=t[1]._value/255;n.blue=t[2]._value/255;n.alpha=r===4?t[3]._value:1;return n}function X(e){if(e%1===0){return e.toFixed(1)}else{return e.toString()}}function Z(e){var t=X(e.red);var r=X(e.green);var i=X(e.blue);return"vec3("+t+", "+r+", "+i+")"}function K(e){var t=X(e.red);var r=X(e.green);var i=X(e.blue);var n=X(e.alpha);return"vec4("+t+", "+r+", "+i+", "+n+")"}function Q(e,t,r,i){var a=e.length;var o=new Array(a);for(var s=0;s<a;++s){var u=e[s].getShaderExpression(t,r,i);if(!n(u)){return undefined}o[s]=u}return o}x.prototype.getShaderExpression=function(e,t,r){var a;var u;var l;var d;var f=this._type;var h=this._value;if(n(this._left)){if(s(this._left)){u=Q(this._left,e,t,this)}else{u=this._left.getShaderExpression(e,t,this)}if(!n(u)){return undefined}}if(n(this._right)){l=this._right.getShaderExpression(e,t,this);if(!n(l)){return undefined}}if(n(this._test)){d=this._test.getShaderExpression(e,t,this);if(!n(d)){return undefined}}if(s(this._value)){h=Q(this._value,e,t,this);if(!n(h)){return undefined}}switch(f){case c.VARIABLE:return e+h;case c.UNARY:if(h==="Boolean"){return"bool("+u+")"}else if(h==="Number"){return"float("+u+")"}else if(h==="round"){return"floor("+u+" + 0.5)"}else if(n(w[h])){return h+"("+u+")"}else if(h==="isNaN"||h==="isFinite"||h==="String"||h==="isExactClass"||h==="isClass"||h==="getExactClassName"){throw new o('Error generating style shader: "'+h+'" is not supported.');return undefined}else if(n(w[h])){return h+"("+u+")"}return h+u;case c.BINARY:if(h==="%"){return"mod("+u+", "+l+")"}else if(h==="==="){return"("+u+" == "+l+")"}else if(h==="!=="){return"("+u+" != "+l+")"}else if(h==="atan2"){return"atan("+u+", "+l+")"}else if(n(y[h])){return h+"("+u+", "+l+")"}return"("+u+" "+h+" "+l+")";case c.TERNARY:if(n(C[h])){return h+"("+u+", "+l+", "+d+")"}break;case c.CONDITIONAL:return"("+d+" ? "+u+" : "+l+")";case c.MEMBER:if(l==="r"||l==="x"||l==="0.0"){return u+"[0]"}else if(l==="g"||l==="y"||l==="1.0"){return u+"[1]"}else if(l==="b"||l==="z"||l==="2.0"){return u+"[2]"}else if(l==="a"||l==="w"||l==="3.0"){return u+"[3]"}return u+"[int("+l+")]";case c.FUNCTION_CALL:throw new o('Error generating style shader: "'+h+'" is not supported.');case c.ARRAY:if(h.length===4){return"vec4("+h[0]+", "+h[1]+", "+h[2]+", "+h[3]+")"}else if(h.length===3){return"vec3("+h[0]+", "+h[1]+", "+h[2]+")"}else if(h.length===2){return"vec2("+h[0]+", "+h[1]+")"}else{throw new o("Error generating style shader: Invalid array length. Array length should be 2, 3, or 4.")}break;case c.REGEX:throw new o("Error generating style shader: Regular expressions are not supported.");case c.VARIABLE_IN_STRING:throw new o("Error generating style shader: Converting a variable to a string is not supported.");case c.LITERAL_NULL:throw new o("Error generating style shader: null is not supported.");case c.LITERAL_BOOLEAN:return h?"true":"false";case c.LITERAL_NUMBER:return X(h);case c.LITERAL_STRING:if(n(r)&&r._type===c.MEMBER){if(h==="r"||h==="g"||h==="b"||h==="a"||h==="x"||h==="y"||h==="z"||h==="w"){return h}}a=i.fromCssColorString(h,_);if(n(a)){return Z(a)}throw new o("Error generating style shader: String literals are not supported.");case c.LITERAL_COLOR:var p=u;if(h==="color"){if(!n(p)){return"vec4(1.0)"}else if(p.length>1){var m=p[0];var v=p[1];if(v!=="1.0"){t.translucent=true}return"vec4("+m+", "+v+")"}else{return"vec4("+p[0]+", 1.0)"}}else if(h==="rgb"){a=Y(this);if(n(a)){return K(a)}else{return"vec4("+p[0]+" / 255.0, "+p[1]+" / 255.0, "+p[2]+" / 255.0, 1.0)"}}else if(h==="rgba"){if(p[3]!=="1.0"){t.translucent=true}a=Y(this);if(n(a)){return K(a)}else{return"vec4("+p[0]+" / 255.0, "+p[1]+" / 255.0, "+p[2]+" / 255.0, "+p[3]+")"}}else if(h==="hsl"){a=j(this);if(n(a)){return K(a)}else{return"vec4(czm_HSLToRGB(vec3("+p[0]+", "+p[1]+", "+p[2]+")), 1.0)"}}else if(h==="hsla"){a=j(this);if(n(a)){if(a.alpha!==1){t.translucent=true}return K(a)}else{if(p[3]!=="1.0"){t.translucent=true}return"vec4(czm_HSLToRGB(vec3("+p[0]+", "+p[1]+", "+p[2]+")), "+p[3]+")"}}break;case c.LITERAL_VECTOR:var g=u.length;var b=h+"(";for(var S=0;S<g;++S){b+=u[S];if(S<g-1){b+=", "}}b+=")";return b;case c.LITERAL_REGEX:throw new o("Error generating style shader: Regular expressions are not supported.");case c.LITERAL_UNDEFINED:throw new o("Error generating style shader: undefined is not supported.");case c.BUILTIN_VARIABLE:if(h==="tiles3d_tileset_time"){return"u_tilesetTime"}}};return T});define("Scene/ConditionsExpression",["../Core/clone","../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","./Expression"],function(e,t,r,i,n,a){"use strict";var o=/\$\{expression}/g;function s(t){this._conditionsExpression=e(t,true);this._conditions=t.conditions;this._expression=t.expression;this._runtimeConditions=undefined;l(this)}n(s.prototype,{conditionsExpression:{get:function(){return this._conditionsExpression}}});function u(e,t){this.condition=e;this.expression=t}function l(e){var t=[];var r=e._conditions;if(i(r)){var n=e._expression;var s=r.length;for(var l=0;l<s;++l){var c=r[l];var d=String(c[0]);var f=String(c[1]);if(i(n)){d=d.replace(o,n);f=f.replace(o,n)}else{d=d.replace(o,"undefined");f=f.replace(o,"undefined")}t.push(new u(new a(d),new a(f)))}}e._runtimeConditions=t}s.prototype.evaluate=function(e,t){var r=this._runtimeConditions;if(i(r)){var n=r.length;for(var a=0;a<n;++a){var o=r[a];if(o.condition.evaluate(e,t)){return o.expression.evaluate(e,t)}}}};s.prototype.evaluateColor=function(e,t,r){var n=this._runtimeConditions;if(i(n)){var a=n.length;for(var o=0;o<a;++o){var s=n[o];if(s.condition.evaluate(e,t)){return s.expression.evaluateColor(e,t,r)}}}};s.prototype.getShaderFunction=function(e,t,r,n){var a=this._runtimeConditions;if(!i(a)||a.length===0){return undefined}var o="";var s=a.length;for(var u=0;u<s;++u){var l=a[u];var c=l.condition.getShaderExpression(t,r);var d=l.expression.getShaderExpression(t,r);if(!i(c)||!i(d)){return undefined}o+="    "+(u===0?"if":"else if")+" ("+c+") \n"+"    { \n"+"        return "+d+"; \n"+"    } \n"}o=n+" "+e+"() \n"+"{ \n"+o+"    return "+n+"(1.0); \n"+"} \n";return o};return s});define("Scene/Cesium3DTileStyle",["../Core/clone","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/isArray","../Core/loadJson","../Core/RequestScheduler","../ThirdParty/when","./ConditionsExpression","./Expression"],function(e,t,r,i,n,a,o,s,u,l,c){"use strict";var d='color("#ffffff")';var f=true;var h=1;function p(e){this._style=undefined;this._ready=false;this._readyPromise=u.defer();this._color=undefined;this._show=undefined;this._pointSize=undefined;this._meta=undefined;this._colorShaderFunction=undefined;this._showShaderFunction=undefined;this._pointSizeShaderFunction=undefined;this._colorShaderFunctionReady=false;this._showShaderFunctionReady=false;this._pointSizeShaderFunctionReady=false;var t=this;if(typeof e==="string"){s.request(e,o).then(function(e){m(t,e);t._readyPromise.resolve(t)}).otherwise(function(e){t._readyPromise.reject(e)})}else{m(t,e);t._readyPromise.resolve(t)}}function m(i,n){i._style=e(n,true);n=t(n,t.EMPTY_OBJECT);if(!r(n.color)){i._colorShaderFunctionReady=true}if(!r(n.show)){i._showShaderFunctionReady=true}if(!r(n.pointSize)){i._pointSizeShaderFunctionReady=true}var a=t(n.color,d);var o=t(n.show,f);var s=t(n.pointSize,h);var u;if(typeof a==="string"){u=new c(a)}else if(r(a.conditions)){u=new l(a)}i._color=u;var p;if(typeof o==="boolean"){p=new c(String(o))}else if(typeof o==="string"){p=new c(o)}else if(r(o.conditions)){p=new l(o)}i._show=p;var m;if(typeof s==="number"){m=new c(String(s))}else if(typeof s==="string"){m=new c(s)}else if(r(s.conditions)){m=new l(s)}i._pointSize=m;var v={};if(r(n.meta)){var _=t(n.meta,t.EMPTY_OBJECT);for(var g in _){if(_.hasOwnProperty(g)){v[g]=new c(_[g])}}}i._meta=v;i._ready=true}i(p.prototype,{style:{get:function(){if(!this._ready){throw new n("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.")}return this._style}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise}},show:{get:function(){if(!this._ready){throw new n("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.")}return this._show},set:function(e){this._showShaderFunctionReady=false;this._show=e}},color:{get:function(){if(!this._ready){throw new n("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.")}return this._color},set:function(e){this._colorShaderFunctionReady=false;this._color=e}},pointSize:{get:function(){if(!this._ready){throw new n("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.")}return this._pointSize},set:function(e){this._pointSizeShaderFunctionReady=false;this._pointSize=e}},meta:{get:function(){if(!this._ready){throw new n("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.")}return this._meta},set:function(e){this._meta=e}}});p.prototype.getColorShaderFunction=function(e,t,r){if(this._colorShaderFunctionReady){return this._colorShaderFunction}this._colorShaderFunctionReady=true;this._colorShaderFunction=this.color.getShaderFunction(e,t,r,"vec4");return this._colorShaderFunction};p.prototype.getShowShaderFunction=function(e,t,r){if(this._showShaderFunctionReady){return this._showShaderFunction}this._showShaderFunctionReady=true;this._showShaderFunction=this.show.getShaderFunction(e,t,r,"bool");return this._showShaderFunction};p.prototype.getPointSizeShaderFunction=function(e,t,r){if(this._pointSizeShaderFunctionReady){return this._pointSizeShaderFunction}this._pointSizeShaderFunctionReady=true;this._pointSizeShaderFunction=this.pointSize.getShaderFunction(e,t,r,"float");return this._pointSizeShaderFunction};return p});define("Scene/UrlTemplateImageryProvider",["../Core/Cartesian2","../Core/Cartesian3","../Core/Cartographic","../Core/combine","../Core/Credit","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/GeographicTilingScheme","../Core/isArray","../Core/loadJson","../Core/loadText","../Core/loadWithXhr","../Core/loadXML","../Core/Math","../Core/Rectangle","../Core/RequestScheduler","../Core/WebMercatorTilingScheme","../ThirdParty/when","./ImageryProvider"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w,C){"use strict";function b(e){if(!o(e)){throw new u("options is required.")}if(!w.isPromise(e)&&!o(e.url)){throw new u("options is required.")}this._errorEvent=new l;this._url=undefined;this._urlSchemeZeroPadding=undefined;this._pickFeaturesUrl=undefined;this._proxy=undefined;this._tileWidth=undefined;this._tileHeight=undefined;this._maximumLevel=undefined;this._minimumLevel=undefined;this._tilingScheme=undefined;this._rectangle=undefined;this._tileDiscardPolicy=undefined;this._credit=undefined;this._hasAlphaChannel=undefined;this._readyPromise=undefined;this.enablePickFeatures=true;this.reinitialize(e)}s(b.prototype,{url:{get:function(){return this._url}},urlSchemeZeroPadding:{get:function(){return this._urlSchemeZeroPadding}},pickFeaturesUrl:{get:function(){return this._pickFeaturesUrl}},proxy:{get:function(){return this._proxy}},tileWidth:{get:function(){if(!this.ready){throw new u("tileWidth must not be called before the imagery provider is ready.")}return this._tileWidth}},tileHeight:{get:function(){if(!this.ready){throw new u("tileHeight must not be called before the imagery provider is ready.")}return this._tileHeight}},maximumLevel:{get:function(){if(!this.ready){throw new u("maximumLevel must not be called before the imagery provider is ready.")}return this._maximumLevel}},minimumLevel:{get:function(){if(!this.ready){throw new u("minimumLevel must not be called before the imagery provider is ready.")}return this._minimumLevel}},tilingScheme:{get:function(){if(!this.ready){throw new u("tilingScheme must not be called before the imagery provider is ready.")}return this._tilingScheme}},rectangle:{get:function(){if(!this.ready){throw new u("rectangle must not be called before the imagery provider is ready.")}return this._rectangle}},tileDiscardPolicy:{get:function(){if(!this.ready){throw new u("tileDiscardPolicy must not be called before the imagery provider is ready.")}return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return o(this._urlParts)}},readyPromise:{get:function(){return this._readyPromise}},credit:{get:function(){if(!this.ready){throw new u("credit must not be called before the imagery provider is ready.")}return this._credit}},hasAlphaChannel:{get:function(){if(!this.ready){throw new u("hasAlphaChannel must not be called before the imagery provider is ready.")}return this._hasAlphaChannel}}});b.prototype.reinitialize=function(e){var t=this;t._readyPromise=w(e).then(function(e){if(!o(e)){throw new u("options is required.")}if(!o(e.url)){throw new u("options.url is required.")}t.enablePickFeatures=a(e.enablePickFeatures,t.enablePickFeatures);t._url=e.url;t._urlSchemeZeroPadding=a(e.urlSchemeZeroPadding,t.urlSchemeZeroPadding);t._pickFeaturesUrl=e.pickFeaturesUrl;t._proxy=e.proxy;t._tileDiscardPolicy=e.tileDiscardPolicy;t._getFeatureInfoFormats=e.getFeatureInfoFormats;t._subdomains=e.subdomains;if(d(t._subdomains)){t._subdomains=t._subdomains.slice()}else if(o(t._subdomains)&&t._subdomains.length>0){t._subdomains=t._subdomains.split("")}else{t._subdomains=["a","b","c"]}t._tileWidth=a(e.tileWidth,256);t._tileHeight=a(e.tileHeight,256);t._minimumLevel=a(e.minimumLevel,0);t._maximumLevel=e.maximumLevel;t._tilingScheme=a(e.tilingScheme,new y({ellipsoid:e.ellipsoid}));t._rectangle=a(e.rectangle,t._tilingScheme.rectangle);t._rectangle=_.intersection(t._rectangle,t._tilingScheme.rectangle);t._hasAlphaChannel=a(e.hasAlphaChannel,true);var r=e.credit;if(typeof r==="string"){r=new n(r)}t._credit=r;t._urlParts=x(t._url,pe);t._pickFeaturesUrlParts=x(t._pickFeaturesUrl,me);return true})};b.prototype.getTileCredits=function(e,t,r){if(!this.ready){throw new u("getTileCredits must not be called before the imagery provider is ready.")}return undefined};b.prototype.requestImage=function(e,t,r,i){if(!this.ready){throw new u("requestImage must not be called before the imagery provider is ready.")}var n=S(this,e,t,r);return C.loadImage(this,n,i)};b.prototype.pickFeatures=function(e,t,r,i,n){if(!this.ready){throw new u("pickFeatures must not be called before the imagery provider is ready.")}if(!this.enablePickFeatures||!o(this._pickFeaturesUrl)||this._getFeatureInfoFormats.length===0){return undefined}var a=0;var s=this;function l(e,t){return e.callback(t)}function c(){if(a>=s._getFeatureInfoFormats.length){return w([])}var o=s._getFeatureInfoFormats[a];var u=E(s,e,t,r,i,n,o.format);++a;function d(e){return p({url:e,responseType:o.format}).then(l.bind(undefined,o)).otherwise(c)}if(o.type==="json"){return g.request(u,f).then(o.callback).otherwise(c)}else if(o.type==="xml"){return g.request(u,m).then(o.callback).otherwise(c)}else if(o.type==="text"||o.type==="html"){return g.request(u,h).then(o.callback).otherwise(c)}else{return g.request(u,d)}}return c()};function S(e,t,r,i){L=false;q=false;return T(e,e._urlParts,function(n){return n(e,t,r,i)})}function E(e,t,r,i,n,a,o){L=false;q=false;Q=false;se=false;return T(e,e._pickFeaturesUrlParts,function(s){return s(e,t,r,i,n,a,o)})}function T(e,t,r){var i="";for(var n=0;n<t.length;++n){var a=t[n];if(typeof a==="string"){i+=a}else{i+=encodeURIComponent(r(a))}}var s=e._proxy;if(o(s)){i=s.getURL(i)}return i}function x(e,t){if(!o(e)){return undefined}var r=[];var i=0;var n;var a;var s=Object.keys(t);while(i<e.length){n=Number.MAX_VALUE;a=undefined;for(var u=0;u<s.length;++u){var l=e.indexOf(s[u],i);if(l>=0&&l<n){n=l;a=s[u]}}if(!o(a)){r.push(e.substring(i));i=e.length}else{if(i<n){r.push(e.substring(i,n))}r.push(t[a]);i=n+a.length}}return r}function A(e,t,r){if(e&&e.urlSchemeZeroPadding&&e.urlSchemeZeroPadding.hasOwnProperty(t)){var i=e.urlSchemeZeroPadding[t];if(typeof i==="string"){var n=i.length;if(n>1){r=r.length>=n?r:new Array(n-r.toString().length+1).join("0")+r}}}return r}function P(e,t,r,i){return A(e,"{x}",t)}function D(e,t,r,i){var n=e.tilingScheme.getNumberOfXTilesAtLevel(i)-t-1;return A(e,"{reverseX}",n)}function M(e,t,r,i){return A(e,"{y}",r)}function I(e,t,r,i){var n=e.tilingScheme.getNumberOfYTilesAtLevel(i)-r-1;return A(e,"{reverseY}",n)}function O(e,t,r,i){var n=e.maximumLevel;var a=o(n)&&i<n?n-i-1:i;return A(e,"{reverseZ}",a)}function R(e,t,r,i){return A(e,"{z}",i)}function N(e,t,r,i){var n=(t+r+i)%e._subdomains.length;return e._subdomains[n]}var L=false;var B=new _;function F(e,t,r,i){if(L){return}e.tilingScheme.tileXYToRectangle(t,r,i,B);B.west=v.toDegrees(B.west);B.south=v.toDegrees(B.south);B.east=v.toDegrees(B.east);B.north=v.toDegrees(B.north);L=true}function k(e,t,r,i){F(e,t,r,i);return B.west}function V(e,t,r,i){F(e,t,r,i);return B.south}function z(e,t,r,i){F(e,t,r,i);return B.east}function U(e,t,r,i){F(e,t,r,i);return B.north}var q=false;var G=new _;function H(e,t,r,i){if(q){return}e.tilingScheme.tileXYToNativeRectangle(t,r,i,G);q=true}function W(e,t,r,i){H(e,t,r,i);return G.west}function j(e,t,r,i){H(e,t,r,i);return G.south}function Y(e,t,r,i){H(e,t,r,i);return G.east}function X(e,t,r,i){H(e,t,r,i);return G.north}function Z(e,t,r,i){return e.tileWidth}function K(e,t,r,i){return e.tileHeight}var Q=false;var J=new e;function $(e,t,r,i,n,a,o){ne(e,t,r,i,n,a);return J.x}function ee(e,t,r,i,n,a,o){ne(e,t,r,i,n,a);return J.y}function te(e,t,r,i,n,a,o){ne(e,t,r,i,n,a);return e.tileWidth-J.x-1}function re(e,t,r,i,n,a,o){ne(e,t,r,i,n,a);return e.tileHeight-J.y-1}var ie=new _;function ne(e,t,r,i,n,a,o){if(Q){return}fe(e,t,r,i,n,a);var s=ue;var u=e.tilingScheme.tileXYToNativeRectangle(t,r,i,ie);J.x=e.tileWidth*(s.x-u.west)/u.width|0;J.y=e.tileHeight*(u.north-s.y)/u.height|0;Q=true}function ae(e,t,r,i,n,a,o){return v.toDegrees(n)}function oe(e,t,r,i,n,a,o){return v.toDegrees(a)}var se=false;var ue=new t;function le(e,t,r,i,n,a,o){fe(e,t,r,i,n,a);return ue.x}function ce(e,t,r,i,n,a,o){fe(e,t,r,i,n,a);return ue.y}var de=new r;function fe(e,t,r,i,n,a,o){if(se){return}var s;if(e.tilingScheme instanceof c){ue.x=v.toDegrees(n);ue.y=v.toDegrees(a)}else{var u=de;u.longitude=n;u.latitude=a;s=e.tilingScheme.projection.project(u,ue)}se=true}function he(e,t,r,i,n,a,o){return o}var pe={"{x}":P,"{y}":M,"{z}":R,"{s}":N,"{reverseX}":D,"{reverseY}":I,"{reverseZ}":O,"{westDegrees}":k,"{southDegrees}":V,"{eastDegrees}":z,"{northDegrees}":U,"{westProjected}":W,"{southProjected}":j,"{eastProjected}":Y,"{northProjected}":X,"{width}":Z,"{height}":K};var me=i(pe,{"{i}":$,"{j}":ee,"{reverseI}":te,"{reverseJ}":re,"{longitudeDegrees}":ae,"{latitudeDegrees}":oe,"{longitudeProjected}":le,"{latitudeProjected}":ce,"{format}":he});return b});define("Scene/createOpenStreetMapImageryProvider",["../Core/Credit","../Core/defaultValue","../Core/DeveloperError","../Core/Rectangle","../Core/WebMercatorTilingScheme","./UrlTemplateImageryProvider"],function(e,t,r,i,n,a){"use strict"
;var o=/\/$/;var s=new e("MapQuest, Open Street Map and contributors, CC-BY-SA");function u(u){u=t(u,{});var l=t(u.url,"https://a.tile.openstreetmap.org/");if(!o.test(l)){l=l+"/"}var c=t(u.fileExtension,"png");var d=new n({ellipsoid:u.ellipsoid});var f=256;var h=256;var p=t(u.minimumLevel,0);var m=u.maximumLevel;var v=t(u.rectangle,d.rectangle);var _=d.positionToTileXY(i.southwest(v),p);var g=d.positionToTileXY(i.northeast(v),p);var y=(Math.abs(g.x-_.x)+1)*(Math.abs(g.y-_.y)+1);if(y>4){throw new r("The rectangle and minimumLevel indicate that there are "+y+" tiles at the minimum level. Imagery providers with more than four tiles at the minimum level are not supported.")}var w=t(u.credit,s);if(typeof w==="string"){w=new e(w)}var C=l+"{z}/{x}/{y}."+c;return new a({url:C,proxy:u.proxy,credit:w,tilingScheme:d,tileWidth:f,tileHeight:h,minimumLevel:p,maximumLevel:m,rectangle:v})}return u});define("Scene/createTangentSpaceDebugPrimitive",["../Core/ColorGeometryInstanceAttribute","../Core/defaultValue","../Core/defined","../Core/DeveloperError","../Core/GeometryInstance","../Core/GeometryPipeline","../Core/Matrix4","./PerInstanceColorAppearance","./Primitive"],function(e,t,r,i,n,a,o,s,u){"use strict";function l(l){l=t(l,t.EMPTY_OBJECT);var c=[];var d=l.geometry;if(!r(d)){throw new i("options.geometry is required.")}if(!r(d.attributes)||!r(d.primitiveType)){d=d.constructor.createGeometry(d)}var f=d.attributes;var h=o.clone(t(l.modelMatrix,o.IDENTITY));var p=t(l.length,1e4);if(r(f.normal)){c.push(new n({geometry:a.createLineSegmentsForVectors(d,"normal",p),attributes:{color:new e(1,0,0,1)},modelMatrix:h}))}if(r(f.tangent)){c.push(new n({geometry:a.createLineSegmentsForVectors(d,"tangent",p),attributes:{color:new e(0,1,0,1)},modelMatrix:h}))}if(r(f.bitangent)){c.push(new n({geometry:a.createLineSegmentsForVectors(d,"bitangent",p),attributes:{color:new e(0,0,1,1)},modelMatrix:h}))}if(c.length>0){return new u({asynchronous:false,geometryInstances:c,appearance:new s({flat:true,translucent:false})})}return undefined}return l});define("Scene/createTileMapServiceImageryProvider",["../Core/Cartesian2","../Core/Cartographic","../Core/defaultValue","../Core/defined","../Core/DeveloperError","../Core/GeographicTilingScheme","../Core/joinUrls","../Core/loadXML","../Core/Rectangle","../Core/RuntimeError","../Core/TileProviderError","../Core/WebMercatorTilingScheme","../ThirdParty/when","./UrlTemplateImageryProvider"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h){"use strict";function p(p){p=r(p,{});if(!i(p.url)){throw new n("options.url is required.")}var m=p.url;var v=f.defer();var _=new h(v.promise);var g;function y(n){var s=/tileformat/i;var f=/tileset/i;var h=/tilesets/i;var y=/boundingbox/i;var w=/srs/i;var b,S,E,T;var x=[];var A=n.childNodes[0].childNodes;for(var P=0;P<A.length;P++){if(s.test(A.item(P).nodeName)){b=A.item(P)}else if(h.test(A.item(P).nodeName)){E=A.item(P);var D=A.item(P).childNodes;for(var M=0;M<D.length;M++){if(f.test(D.item(M).nodeName)){x.push(D.item(M))}}}else if(y.test(A.item(P).nodeName)){S=A.item(P)}else if(w.test(A.item(P).nodeName)){T=A.item(P).textContent}}var I=r(p.fileExtension,b.getAttribute("extension"));var O=r(p.tileWidth,parseInt(b.getAttribute("width"),10));var R=r(p.tileHeight,parseInt(b.getAttribute("height"),10));var N=r(p.minimumLevel,parseInt(x[0].getAttribute("order"),10));var L=r(p.maximumLevel,parseInt(x[x.length-1].getAttribute("order"),10));var B=E.getAttribute("profile");var F=p.tilingScheme;if(!i(F)){if(B==="geodetic"||B==="global-geodetic"){F=new a({ellipsoid:p.ellipsoid})}else if(B==="mercator"||B==="global-mercator"){F=new d({ellipsoid:p.ellipsoid})}else{var k=o(m,"tilemapresource.xml")+"specifies an unsupported profile attribute, "+B+".";g=c.handleError(g,_,_.errorEvent,k,undefined,undefined,undefined,C);if(!g.retry){v.reject(new l(k))}return}}var V=u.clone(p.rectangle);if(!i(V)){var z;var U;var q;var G;var H=r(p.flipXY,false);if(H){q=new e(parseFloat(S.getAttribute("miny")),parseFloat(S.getAttribute("minx")));G=new e(parseFloat(S.getAttribute("maxy")),parseFloat(S.getAttribute("maxx")))}else{q=new e(parseFloat(S.getAttribute("minx")),parseFloat(S.getAttribute("miny")));G=new e(parseFloat(S.getAttribute("maxx")),parseFloat(S.getAttribute("maxy")))}var W=B==="geodetic"||B==="mercator";if(F instanceof a||W){z=t.fromDegrees(q.x,q.y);U=t.fromDegrees(G.x,G.y)}else{var j=F.projection;z=j.unproject(q);U=j.unproject(G)}V=new u(z.longitude,z.latitude,U.longitude,U.latitude)}if(V.west<F.rectangle.west){V.west=F.rectangle.west}if(V.east>F.rectangle.east){V.east=F.rectangle.east}if(V.south<F.rectangle.south){V.south=F.rectangle.south}if(V.north>F.rectangle.north){V.north=F.rectangle.north}var Y=F.positionToTileXY(u.southwest(V),N);var X=F.positionToTileXY(u.northeast(V),N);var Z=(Math.abs(X.x-Y.x)+1)*(Math.abs(X.y-Y.y)+1);if(Z>4){N=0}var K=o(m,"{z}/{x}/{reverseY}."+I);v.resolve({url:K,tilingScheme:F,rectangle:V,tileWidth:O,tileHeight:R,minimumLevel:N,maximumLevel:L,proxy:p.proxy,tileDiscardPolicy:p.tileDiscardPolicy,credit:p.credit})}function w(e){var t=r(p.fileExtension,"png");var n=r(p.tileWidth,256);var a=r(p.tileHeight,256);var s=r(p.minimumLevel,0);var u=p.maximumLevel;var l=i(p.tilingScheme)?p.tilingScheme:new d({ellipsoid:p.ellipsoid});var c=r(p.rectangle,l.rectangle);var f=o(m,"{z}/{x}/{reverseY}."+t);v.resolve({url:f,tilingScheme:l,rectangle:c,tileWidth:n,tileHeight:a,minimumLevel:s,maximumLevel:u,proxy:p.proxy,tileDiscardPolicy:p.tileDiscardPolicy,credit:p.credit})}function C(){var e=o(m,"tilemapresource.xml");var t=p.proxy;if(i(t)){e=t.getURL(e)}s(e).then(y).otherwise(w)}C();return _}return p});define("Scene/CreditDisplay",["../Core/Credit","../Core/defaultValue","../Core/defined","../Core/destroyObject","../Core/DeveloperError"],function(e,t,r,i,n){"use strict";function a(e,t,i){if(!r(e.element)){var n=e.text;var a=e.link;var o=document.createElement("span");if(e.hasLink()){var s=document.createElement("a");s.textContent=n;s.href=a;s.target="_blank";o.appendChild(s)}else{o.textContent=n}o.className="cesium-credit-text";e.element=o}if(t.hasChildNodes()){var u=document.createElement("span");u.textContent=i;u.className="cesium-credit-delimiter";t.appendChild(u)}t.appendChild(e.element)}function o(e,t){if(!r(e.element)){var i=e.text;var n=e.link;var a=document.createElement("span");var o=document.createElement("img");o.src=e.imageUrl;o.style["vertical-align"]="bottom";if(r(i)){o.alt=i;o.title=i}if(e.hasLink()){var s=document.createElement("a");s.appendChild(o);s.href=n;s.target="_blank";a.appendChild(s)}else{a.appendChild(o)}a.className="cesium-credit-image";e.element=a}t.appendChild(e.element)}function s(t,r){var i=t.length;for(var n=0;n<i;n++){var a=t[n];if(e.equals(a,r)){return true}}return false}function u(e){var t=e.element;if(r(t)){var i=t.parentNode;if(!e.hasImage()){var n=t.previousSibling;if(n===null){n=t.nextSibling}if(n!==null){i.removeChild(n)}}i.removeChild(t)}}function l(e,t){var i;var n;var o;var s=e._displayedCredits.textCredits;for(i=0;i<t.length;i++){o=t[i];if(r(o)){n=s.indexOf(o);if(n===-1){a(o,e._textContainer,e._delimiter)}else{s.splice(n,1)}}}for(i=0;i<s.length;i++){o=s[i];if(r(o)){u(o)}}}function c(e,t){var i;var n;var a;var s=e._displayedCredits.imageCredits;for(i=0;i<t.length;i++){a=t[i];if(r(a)){n=s.indexOf(a);if(n===-1){o(a,e._imageContainer)}else{s.splice(n,1)}}}for(i=0;i<s.length;i++){a=s[i];if(r(a)){u(a)}}}function d(e,i){if(!r(e)){throw new n("credit container is required")}var a=document.createElement("span");a.className="cesium-credit-imageContainer";var o=document.createElement("span");o.className="cesium-credit-textContainer";e.appendChild(a);e.appendChild(o);this._delimiter=t(i,"  ");this._textContainer=o;this._imageContainer=a;this._defaultImageCredits=[];this._defaultTextCredits=[];this._displayedCredits={imageCredits:[],textCredits:[]};this._currentFrameCredits={imageCredits:[],textCredits:[]};this.container=e}d.prototype.addCredit=function(e){if(!r(e)){throw new n("credit must be defined")}if(e.hasImage()){var t=this._currentFrameCredits.imageCredits;if(!s(this._defaultImageCredits,e)){t[e.id]=e}}else{var i=this._currentFrameCredits.textCredits;if(!s(this._defaultTextCredits,e)){i[e.id]=e}}};d.prototype.addDefaultCredit=function(e){if(!r(e)){throw new n("credit must be defined")}if(e.hasImage()){var t=this._defaultImageCredits;if(!s(t,e)){t.push(e)}}else{var i=this._defaultTextCredits;if(!s(i,e)){i.push(e)}}};d.prototype.removeDefaultCredit=function(e){if(!r(e)){throw new n("credit must be defined")}var t;if(e.hasImage()){t=this._defaultImageCredits.indexOf(e);if(t!==-1){this._defaultImageCredits.splice(t,1)}}else{t=this._defaultTextCredits.indexOf(e);if(t!==-1){this._defaultTextCredits.splice(t,1)}}};d.prototype.beginFrame=function(){this._currentFrameCredits.imageCredits.length=0;this._currentFrameCredits.textCredits.length=0};d.prototype.endFrame=function(){var e=this._defaultTextCredits.concat(this._currentFrameCredits.textCredits);var t=this._defaultImageCredits.concat(this._currentFrameCredits.imageCredits);l(this,e);c(this,t);this._displayedCredits.textCredits=e;this._displayedCredits.imageCredits=t};d.prototype.destroy=function(){this.container.removeChild(this._textContainer);this.container.removeChild(this._imageContainer);return i(this)};d.prototype.isDestroyed=function(){return false};return d});define("Scene/DebugAppearance",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","./Appearance"],function(e,t,r,i,n){"use strict";function a(r){r=e(r,e.EMPTY_OBJECT);var a=r.attributeName;var o=r.perInstanceAttribute;if(!t(a)){throw new i("options.attributeName is required.")}if(!t(o)){o=false}var s=e(r.glslDatatype,"vec3");var u="v_"+a;var l;if(a==="normal"||a==="tangent"||a==="bitangent"){l="vec4 getColor() { return vec4(("+u+" + vec3(1.0)) * 0.5, 1.0); }\n"}else{if(a==="st"){s="vec2"}switch(s){case"float":l="vec4 getColor() { return vec4(vec3("+u+"), 1.0); }\n";break;case"vec2":l="vec4 getColor() { return vec4("+u+", 0.0, 1.0); }\n";break;case"vec3":l="vec4 getColor() { return vec4("+u+", 1.0); }\n";break;case"vec4":l="vec4 getColor() { return "+u+"; }\n";break;default:throw new i("options.glslDatatype must be float, vec2, vec3, or vec4.")}}var c="attribute vec3 position3DHigh;\n"+"attribute vec3 position3DLow;\n"+"attribute float batchId;\n"+(o?"":"attribute "+s+" "+a+";\n")+"varying "+s+" "+u+";\n"+"void main()\n"+"{\n"+"vec4 p = czm_translateRelativeToEye(position3DHigh, position3DLow);\n"+(o?u+" = czm_batchTable_"+a+"(batchId);\n":u+" = "+a+";\n")+"gl_Position = czm_modelViewProjectionRelativeToEye * p;\n"+"}";var d="varying "+s+" "+u+";\n"+l+"\n"+"void main()\n"+"{\n"+"gl_FragColor = getColor();\n"+"}";this.material=undefined;this.translucent=e(r.translucent,false);this._vertexShaderSource=e(r.vertexShaderSource,c);this._fragmentShaderSource=e(r.fragmentShaderSource,d);this._renderState=n.getDefaultRenderState(false,false,r.renderState);this._closed=e(r.closed,false);this._attributeName=a;this._glslDatatype=s}r(a.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},attributeName:{get:function(){return this._attributeName}},glslDatatype:{get:function(){return this._glslDatatype}}});a.prototype.getFragmentShaderSource=n.prototype.getFragmentShaderSource;a.prototype.isTranslucent=n.prototype.isTranslucent;a.prototype.getRenderState=n.prototype.getRenderState;return a});define("Scene/DebugModelMatrixPrimitive",["../Core/Cartesian3","../Core/Color","../Core/defaultValue","../Core/defined","../Core/destroyObject","../Core/GeometryInstance","../Core/Matrix4","../Core/PolylineGeometry","./PolylineColorAppearance","./Primitive"],function(e,t,r,i,n,a,o,s,u,l){"use strict";function c(e){e=r(e,r.EMPTY_OBJECT);this.length=r(e.length,1e7);this._length=undefined;this.width=r(e.width,2);this._width=undefined;this.show=r(e.show,true);this.modelMatrix=o.clone(r(e.modelMatrix,o.IDENTITY));this._modelMatrix=new o;this.id=e.id;this._id=undefined;this._primitive=undefined}c.prototype.update=function(r){if(!this.show){return}if(!i(this._primitive)||!o.equals(this._modelMatrix,this.modelMatrix)||this._length!==this.length||this._width!==this.width||this._id!==this.id){this._modelMatrix=o.clone(this.modelMatrix,this._modelMatrix);this._length=this.length;this._width=this.width;this._id=this.id;if(i(this._primitive)){this._primitive.destroy()}if(this.modelMatrix[12]===0&&this.modelMatrix[13]===0&&this.modelMatrix[14]===0){this.modelMatrix[14]=.01}var n=new a({geometry:new s({positions:[e.ZERO,e.UNIT_X],width:this.width,vertexFormat:u.VERTEX_FORMAT,colors:[t.RED,t.RED],followSurface:false}),modelMatrix:o.multiplyByUniformScale(this.modelMatrix,this.length,new o),id:this.id,pickPrimitive:this});var c=new a({geometry:new s({positions:[e.ZERO,e.UNIT_Y],width:this.width,vertexFormat:u.VERTEX_FORMAT,colors:[t.GREEN,t.GREEN],followSurface:false}),modelMatrix:o.multiplyByUniformScale(this.modelMatrix,this.length,new o),id:this.id,pickPrimitive:this});var d=new a({geometry:new s({positions:[e.ZERO,e.UNIT_Z],width:this.width,vertexFormat:u.VERTEX_FORMAT,colors:[t.BLUE,t.BLUE],followSurface:false}),modelMatrix:o.multiplyByUniformScale(this.modelMatrix,this.length,new o),id:this.id,pickPrimitive:this});this._primitive=new l({geometryInstances:[n,c,d],appearance:new u,asynchronous:false})}this._primitive.update(r)};c.prototype.isDestroyed=function(){return false};c.prototype.destroy=function(){this._primitive=this._primitive&&this._primitive.destroy();return n(this)};return c});define("Shaders/DepthPlaneFS",[],function(){"use strict";return"varying vec4 positionEC;\nvoid main()\n{\nczm_ellipsoid ellipsoid = czm_getWgs84EllipsoidEC();\nvec3 direction = normalize(positionEC.xyz);\nczm_ray ray = czm_ray(vec3(0.0), direction);\nczm_raySegment intersection = czm_rayEllipsoidIntersectionInterval(ray, ellipsoid);\nif (!czm_isEmpty(intersection))\n{\ngl_FragColor = vec4(1.0, 1.0, 0.0, 1.0);\n}\nelse\n{\ndiscard;\n}\n}\n"});define("Shaders/DepthPlaneVS",[],function(){"use strict";return"attribute vec4 position;\nvarying vec4 positionEC;\nvoid main()\n{\npositionEC = czm_modelView * position;\ngl_Position = czm_projection * positionEC;\n}\n"});define("Scene/DepthPlane",["../Core/BoundingSphere","../Core/Cartesian3","../Core/ComponentDatatype","../Core/defined","../Core/FeatureDetection","../Core/Geometry","../Core/GeometryAttribute","../Core/PrimitiveType","../Renderer/BufferUsage","../Renderer/DrawCommand","../Renderer/Pass","../Renderer/RenderState","../Renderer/ShaderProgram","../Renderer/VertexArray","../Shaders/DepthPlaneFS","../Shaders/DepthPlaneVS","./DepthFunction","./SceneMode"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_){"use strict";function g(){this._rs=undefined;this._sp=undefined;this._va=undefined;this._command=undefined;this._mode=undefined}var y=n.supportsTypedArrays()?new Float32Array(12):[];var w=new t;var C=new t;var b=new t;var S=new t;function E(e,r){var i=e.radii;var n=r.camera.positionWC;var a=t.multiplyComponents(e.oneOverRadii,n,w);var o=t.magnitude(a);var s=t.normalize(a,C);var u=t.normalize(t.cross(t.UNIT_Z,a,b),b);var l=t.normalize(t.cross(s,u,S),S);var c=Math.sqrt(t.magnitudeSquared(a)-1);var d=t.multiplyByScalar(s,1/o,w);var f=c/o;var h=t.multiplyByScalar(u,f,C);var p=t.multiplyByScalar(l,f,b);var m=t.add(d,p,S);t.subtract(m,h,m);t.multiplyComponents(i,m,m);t.pack(m,y,0);var v=t.subtract(d,p,S);t.subtract(v,h,v);t.multiplyComponents(i,v,v);t.pack(v,y,3);var _=t.add(d,p,S);t.add(_,h,_);t.multiplyComponents(i,_,_);t.pack(_,y,6);var g=t.subtract(d,p,S);t.add(g,h,g);t.multiplyComponents(i,g,g);t.pack(g,y,9);return y}g.prototype.update=function(n){this._mode=n.mode;if(n.mode!==_.SCENE3D){return}var g=n.context;var y=n.mapProjection.ellipsoid;if(!i(this._command)){this._rs=d.fromCache({cull:{enabled:true},depthTest:{enabled:true,func:v.ALWAYS},colorMask:{red:false,green:false,blue:false,alpha:false}});this._sp=f.fromCache({context:g,vertexShaderSource:m,fragmentShaderSource:p,attributeLocations:{position:0}});this._command=new l({renderState:this._rs,shaderProgram:this._sp,boundingVolume:new e(t.ZERO,y.maximumRadius),pass:c.OPAQUE,owner:this})}var w=E(y,n);if(!i(this._va)){var C=new a({attributes:{position:new o({componentDatatype:r.FLOAT,componentsPerAttribute:3,values:w})},indices:[0,1,2,2,1,3],primitiveType:s.TRIANGLES});this._va=h.fromGeometry({context:g,geometry:C,attributeLocations:{position:0},bufferUsage:u.DYNAMIC_DRAW});this._command.vertexArray=this._va}else{this._va.getAttribute(0).vertexBuffer.copyFromArrayView(w)}};g.prototype.execute=function(e,t){if(this._mode===_.SCENE3D){this._command.execute(e,t)}};g.prototype.isDestroyed=function(){return false};g.prototype.destroy=function(){this._sp=this._sp&&this._sp.destroy();this._va=this._va&&this._va.destroy()};return g});define("Scene/DeviceOrientationCameraController",["../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Core/Math","../Core/Matrix3","../Core/Quaternion"],function(e,t,r,i,n,a){"use strict";function o(t){if(!e(t)){throw new r("scene is required.")}this._scene=t;this._lastAlpha=undefined;this._lastBeta=undefined;this._lastGamma=undefined;this._alpha=undefined;this._beta=undefined;this._gamma=undefined;var n=this;function a(t){var r=t.alpha;if(!e(r)){n._alpha=undefined;n._beta=undefined;n._gamma=undefined;return}n._alpha=i.toRadians(r);n._beta=i.toRadians(t.beta);n._gamma=i.toRadians(t.gamma)}window.addEventListener("deviceorientation",a,false);this._removeListener=function(){window.removeEventListener("deviceorientation",a,false)}}var s=new a;var u=new a;var l=new n;function c(e,t,r,i){var o=e.direction;var c=e.right;var d=e.up;var f=a.fromAxisAngle(o,r,u);var h=a.fromAxisAngle(c,i,s);var p=a.multiply(h,f,h);var m=a.fromAxisAngle(d,t,u);a.multiply(m,p,p);var v=n.fromQuaternion(p,l);n.multiplyByVector(v,c,c);n.multiplyByVector(v,d,d);n.multiplyByVector(v,o,o)}o.prototype.update=function(){if(!e(this._alpha)){return}if(!e(this._lastAlpha)){this._lastAlpha=this._alpha;this._lastBeta=this._beta;this._lastGamma=this._gamma}var t=this._lastAlpha-this._alpha;var r=this._lastBeta-this._beta;var i=this._lastGamma-this._gamma;c(this._scene.camera,-t,r,i);this._lastAlpha=this._alpha;this._lastBeta=this._beta;this._lastGamma=this._gamma};o.prototype.isDestroyed=function(){return false};o.prototype.destroy=function(){this._removeListener();return t(this)};return o});define("Shaders/EllipsoidFS",[],function(){"use strict";return"#ifdef WRITE_DEPTH\n#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n#endif\n#endif\nuniform vec3 u_radii;\nuniform vec3 u_oneOverEllipsoidRadiiSquared;\nvarying vec3 v_positionEC;\nvec4 computeEllipsoidColor(czm_ray ray, float intersection, float side)\n{\nvec3 positionEC = czm_pointAlongRay(ray, intersection);\nvec3 positionMC = (czm_inverseModelView * vec4(positionEC, 1.0)).xyz;\nvec3 geodeticNormal = normalize(czm_geodeticSurfaceNormal(positionMC, vec3(0.0), u_oneOverEllipsoidRadiiSquared));\nvec3 sphericalNormal = normalize(positionMC / u_radii);\nvec3 normalMC = geodeticNormal * side;\nvec3 normalEC = normalize(czm_normal * normalMC);\nvec2 st = czm_ellipsoidWgs84TextureCoordinates(sphericalNormal);\nvec3 positionToEyeEC = -positionEC;\nczm_materialInput materialInput;\nmaterialInput.s = st.s;\nmaterialInput.st = st;\nmaterialInput.str = (positionMC + u_radii) / u_radii;\nmaterialInput.normalEC = normalEC;\nmaterialInput.tangentToEyeMatrix = czm_eastNorthUpToEyeCoordinates(positionMC, normalEC);\nmaterialInput.positionToEyeEC = positionToEyeEC;\nczm_material material = czm_getMaterial(materialInput);\n#ifdef ONLY_SUN_LIGHTING\nreturn czm_private_phong(normalize(positionToEyeEC), material);\n#else\nreturn czm_phong(normalize(positionToEyeEC), material);\n#endif\n}\nvoid main()\n{\nfloat maxRadius = max(u_radii.x, max(u_radii.y, u_radii.z)) * 1.5;\nvec3 direction = normalize(v_positionEC);\nvec3 ellipsoidCenter = czm_modelView[3].xyz;\nfloat t1 = -1.0;\nfloat t2 = -1.0;\nfloat b = -2.0 * dot(direction, ellipsoidCenter);\nfloat c = dot(ellipsoidCenter, ellipsoidCenter) - maxRadius * maxRadius;\nfloat discriminant = b * b - 4.0 * c;\nif (discriminant >= 0.0) {\nt1 = (-b - sqrt(discriminant)) * 0.5;\nt2 = (-b + sqrt(discriminant)) * 0.5;\n}\nif (t1 < 0.0 && t2 < 0.0) {\ndiscard;\n}\nfloat t = min(t1, t2);\nif (t < 0.0) {\nt = 0.0;\n}\nczm_ellipsoid ellipsoid = czm_ellipsoidNew(ellipsoidCenter, u_radii);\nczm_ray ray = czm_ray(t * direction, direction);\nczm_raySegment intersection = czm_rayEllipsoidIntersectionInterval(ray, ellipsoid);\nif (czm_isEmpty(intersection))\n{\ndiscard;\n}\nvec4 outsideFaceColor = (intersection.start != 0.0) ? computeEllipsoidColor(ray, intersection.start, 1.0) : vec4(0.0);\nvec4 insideFaceColor = (outsideFaceColor.a < 1.0) ? computeEllipsoidColor(ray, intersection.stop, -1.0) : vec4(0.0);\ngl_FragColor = mix(insideFaceColor, outsideFaceColor, outsideFaceColor.a);\ngl_FragColor.a = 1.0 - (1.0 - insideFaceColor.a) * (1.0 - outsideFaceColor.a);\n#ifdef WRITE_DEPTH\n#ifdef GL_EXT_frag_depth\nt = (intersection.start != 0.0) ? intersection.start : intersection.stop;\nvec3 positionEC = czm_pointAlongRay(ray, t);\nvec4 positionCC = czm_projection * vec4(positionEC, 1.0);\nfloat z = positionCC.z / positionCC.w;\nfloat n = czm_depthRange.near;\nfloat f = czm_depthRange.far;\ngl_FragDepthEXT = (z * (f - n) + f + n) * 0.5;\n#endif\n#endif\n}\n"});define("Shaders/EllipsoidVS",[],function(){"use strict";return"attribute vec3 position;\nuniform vec3 u_radii;\nvarying vec3 v_positionEC;\nvoid main()\n{\nvec4 p = vec4(u_radii * position, 1.0);\nv_positionEC = (czm_modelView * p).xyz;\ngl_Position = czm_modelViewProjection * p;\ngl_Position.z = clamp(gl_Position.z, czm_depthRange.near, czm_depthRange.far);\n}\n"});define("Scene/EllipsoidPrimitive",["../Core/BoundingSphere","../Core/BoxGeometry","../Core/Cartesian3","../Core/combine","../Core/defaultValue","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Core/Matrix4","../Core/VertexFormat","../Renderer/BufferUsage","../Renderer/DrawCommand","../Renderer/Pass","../Renderer/RenderState","../Renderer/ShaderProgram","../Renderer/ShaderSource","../Renderer/VertexArray","../Shaders/EllipsoidFS","../Shaders/EllipsoidVS","./BlendingState","./CullFace","./Material","./SceneMode"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w,C,b){"use strict";var S={position:0};function E(t){t=n(t,n.EMPTY_OBJECT);this.center=r.clone(n(t.center,r.ZERO));this._center=new r;this.radii=r.clone(t.radii);this._radii=new r;this._oneOverEllipsoidRadiiSquared=new r;this._boundingSphere=new e;this.modelMatrix=u.clone(n(t.modelMatrix,u.IDENTITY));this._modelMatrix=new u;this._computedModelMatrix=new u;this.show=n(t.show,true);this.material=n(t.material,C.fromType(C.ColorType));this._material=undefined;this._translucent=undefined;this.id=t.id;this._id=undefined;this.debugShowBoundingVolume=n(t.debugShowBoundingVolume,false);this.onlySunLighting=n(t.onlySunLighting,false);this._onlySunLighting=false;this._depthTestEnabled=n(t.depthTestEnabled,true);this._sp=undefined;this._rs=undefined;this._va=undefined;this._pickSP=undefined;this._pickId=undefined;this._colorCommand=new d({owner:n(t._owner,this)});this._pickCommand=new d({owner:n(t._owner,this)});var i=this;this._uniforms={u_radii:function(){return i.radii},u_oneOverEllipsoidRadiiSquared:function(){return i._oneOverEllipsoidRadiiSquared}};this._pickUniforms={czm_pickColor:function(){return i._pickId.color}}}function T(e){var i=e.cache.ellipsoidPrimitive_vertexArray;if(a(i)){return i}var n=t.createGeometry(t.fromDimensions({dimensions:new r(2,2,2),vertexFormat:l.POSITION_ONLY}));i=v.fromGeometry({context:e,geometry:n,attributeLocations:S,bufferUsage:c.STATIC_DRAW,interleave:true});e.cache.ellipsoidPrimitive_vertexArray=i;return i}E.prototype.update=function(t){if(!this.show||t.mode!==b.SCENE3D||!a(this.center)||!a(this.radii)){return}if(!a(this.material)){throw new s("this.material must be defined.")}var n=t.context;var o=this.material.isTranslucent();var l=this._translucent!==o;if(!a(this._rs)||l){this._translucent=o;this._rs=h.fromCache({cull:{enabled:true,face:w.FRONT},depthTest:{enabled:this._depthTestEnabled},depthMask:!o&&n.fragmentDepth,blending:o?y.ALPHA_BLEND:undefined})}if(!a(this._va)){this._va=T(n)}var c=false;var d=this.radii;if(!r.equals(this._radii,d)){r.clone(d,this._radii);var v=this._oneOverEllipsoidRadiiSquared;v.x=1/(d.x*d.x);v.y=1/(d.y*d.y);v.z=1/(d.z*d.z);c=true}if(!u.equals(this.modelMatrix,this._modelMatrix)||!r.equals(this.center,this._center)){u.clone(this.modelMatrix,this._modelMatrix);r.clone(this.center,this._center);u.multiplyByTranslation(this.modelMatrix,this.center,this._computedModelMatrix);c=true}if(c){r.clone(r.ZERO,this._boundingSphere.center);this._boundingSphere.radius=r.maximumComponent(d);e.transform(this._boundingSphere,this._computedModelMatrix,this._boundingSphere)}var C=this._material!==this.material;this._material=this.material;this._material.update(n);var E=this.onlySunLighting!==this._onlySunLighting;this._onlySunLighting=this.onlySunLighting;var x=this._colorCommand;var A;if(C||E||l){A=new m({sources:[this.material.shaderSource,_]});if(this.onlySunLighting){A.defines.push("ONLY_SUN_LIGHTING")}if(!o&&n.fragmentDepth){A.defines.push("WRITE_DEPTH")}this._sp=p.replaceCache({context:n,shaderProgram:this._sp,vertexShaderSource:g,fragmentShaderSource:A,attributeLocations:S});x.vertexArray=this._va;x.renderState=this._rs;x.shaderProgram=this._sp;x.uniformMap=i(this._uniforms,this.material._uniforms);x.executeInClosestFrustum=o}var P=t.commandList;var D=t.passes;if(D.render){x.boundingVolume=this._boundingSphere;x.debugShowBoundingVolume=this.debugShowBoundingVolume;x.modelMatrix=this._computedModelMatrix;x.pass=o?f.TRANSLUCENT:f.OPAQUE;P.push(x)}if(D.pick){var M=this._pickCommand;if(!a(this._pickId)||this._id!==this.id){this._id=this.id;this._pickId=this._pickId&&this._pickId.destroy();this._pickId=n.createPickId({primitive:this,id:this.id})}if(C||E||!a(this._pickSP)){A=new m({sources:[this.material.shaderSource,_],pickColorQualifier:"uniform"});if(this.onlySunLighting){A.defines.push("ONLY_SUN_LIGHTING")}if(!o&&n.fragmentDepth){A.defines.push("WRITE_DEPTH")}this._pickSP=p.replaceCache({context:n,shaderProgram:this._pickSP,vertexShaderSource:g,fragmentShaderSource:A,attributeLocations:S});M.vertexArray=this._va;M.renderState=this._rs;M.shaderProgram=this._pickSP;M.uniformMap=i(i(this._uniforms,this._pickUniforms),this.material._uniforms);M.executeInClosestFrustum=o}M.boundingVolume=this._boundingSphere;M.modelMatrix=this._computedModelMatrix;M.pass=o?f.TRANSLUCENT:f.OPAQUE;P.push(M)}};E.prototype.isDestroyed=function(){return false};E.prototype.destroy=function(){this._sp=this._sp&&this._sp.destroy();this._pickSP=this._pickSP&&this._pickSP.destroy();this._pickId=this._pickId&&this._pickId.destroy();return o(this)};return E});define("Shaders/Appearances/EllipsoidSurfaceAppearanceFS",[],function(){"use strict";return"varying vec3 v_positionMC;\nvarying vec3 v_positionEC;\nvarying vec2 v_st;\nvoid main()\n{\nczm_materialInput materialInput;\nvec3 normalEC = normalize(czm_normal3D * czm_geodeticSurfaceNormal(v_positionMC, vec3(0.0), vec3(1.0)));\n#ifdef FACE_FORWARD\nnormalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);\n#endif\nmaterialInput.s = v_st.s;\nmaterialInput.st = v_st;\nmaterialInput.str = vec3(v_st, 0.0);\nmaterialInput.normalEC = normalEC;\nmaterialInput.tangentToEyeMatrix = czm_eastNorthUpToEyeCoordinates(v_positionMC, materialInput.normalEC);\nvec3 positionToEyeEC = -v_positionEC;\nmaterialInput.positionToEyeEC = positionToEyeEC;\nczm_material material = czm_getMaterial(materialInput);\n#ifdef FLAT\ngl_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n#else\ngl_FragColor = czm_phong(normalize(positionToEyeEC), material);\n#endif\n}\n"});define("Shaders/Appearances/EllipsoidSurfaceAppearanceVS",[],function(){"use strict";return"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec2 st;\nattribute float batchId;\nvarying vec3 v_positionMC;\nvarying vec3 v_positionEC;\nvarying vec2 v_st;\nvoid main()\n{\nvec4 p = czm_computePosition();\nv_positionMC = position3DHigh + position3DLow;\nv_positionEC = (czm_modelViewRelativeToEye * p).xyz;\nv_st = st;\ngl_Position = czm_modelViewProjectionRelativeToEye * p;\n}\n"});define("Scene/EllipsoidSurfaceAppearance",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/VertexFormat","../Shaders/Appearances/EllipsoidSurfaceAppearanceFS","../Shaders/Appearances/EllipsoidSurfaceAppearanceVS","./Appearance","./Material"],function(e,t,r,i,n,a,o,s){"use strict";function u(r){r=e(r,e.EMPTY_OBJECT);var i=e(r.translucent,true);var u=e(r.aboveGround,false);this.material=t(r.material)?r.material:s.fromType(s.ColorType);this.translucent=e(r.translucent,true);this._vertexShaderSource=e(r.vertexShaderSource,a);this._fragmentShaderSource=e(r.fragmentShaderSource,n);this._renderState=o.getDefaultRenderState(i,!u,r.renderState);this._closed=false;this._flat=e(r.flat,false);this._faceForward=e(r.faceForward,u);this._aboveGround=u}r(u.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},vertexFormat:{get:function(){return u.VERTEX_FORMAT}},flat:{get:function(){return this._flat}},faceForward:{get:function(){return this._faceForward}},aboveGround:{get:function(){return this._aboveGround}}});u.VERTEX_FORMAT=i.POSITION_AND_ST;u.prototype.getFragmentShaderSource=o.prototype.getFragmentShaderSource;u.prototype.isTranslucent=o.prototype.isTranslucent;u.prototype.getRenderState=o.prototype.getRenderState;return u});define("Scene/Fog",["../Core/Cartesian3","../Core/defined","../Core/Math","./SceneMode"],function(e,t,r,i){"use strict";function n(){this.enabled=true;this.density=2e-4;this.screenSpaceErrorFactor=2}var a=[359.393,800.749,1275.6501,2151.1192,3141.7763,4777.5198,6281.2493,12364.307,15900.765,49889.0549,78026.8259,99260.7344,120036.3873,151011.0158,156091.1953,203849.3112,274866.9803,319916.3149,493552.0528,628733.5874];var o=[2e-5,2e-4,1e-4,7e-5,5e-5,4e-5,3e-5,19e-6,1e-5,85e-7,62e-7,58e-7,53e-7,52e-7,51e-7,42e-7,4e-6,34e-7,26e-7,22e-7];for(var s=0;s<o.length;++s){o[s]*=1e6}var u=o[1];var l=o[o.length-1];for(var c=0;c<o.length;++c){o[c]=(o[c]-l)/(u-l)}var d=0;function f(e){var t=a;var r=t.length;if(e<t[0]){d=0;return d}else if(e>t[r-1]){d=r-2;return d}if(e>=t[d]){if(d+1<r&&e<t[d+1]){return d}else if(d+2<r&&e<t[d+2]){++d;return d}}else if(d-1>=0&&e>=t[d-1]){--d;return d}var i;for(i=0;i<r-2;++i){if(e>=t[i]&&e<t[i+1]){break}}d=i;return d}var h=new e;n.prototype.update=function(n){var s=n.fog.enabled=this.enabled;if(!s){return}var c=n.camera;var d=c.positionCartographic;if(!t(d)||d.height>8e5||n.mode!==i.SCENE3D){n.fog.enabled=false;return}var p=d.height;var m=f(p);var v=r.clamp((p-a[m])/(a[m+1]-a[m]),0,1);var _=r.lerp(o[m],o[m+1],v);var g=this.density*1e6;var y=g/u*l;_=_*(g-y)*1e-6;var w=e.normalize(c.positionWC,h);var C=Math.abs(e.dot(c.directionWC,w));_*=1-C;n.fog.density=_;n.fog.sse=this.screenSpaceErrorFactor};return n});define("Scene/FrameRateMonitor",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/Event","../Core/getTimestamp","../Core/TimeConstants"],function(e,t,r,i,n,a,o,s){"use strict";function u(r){if(!t(r)||!t(r.scene)){throw new n("options.scene is required.")}this._scene=r.scene;this.samplingWindow=e(r.samplingWindow,u.defaultSettings.samplingWindow);this.quietPeriod=e(r.quietPeriod,u.defaultSettings.quietPeriod)
;this.warmupPeriod=e(r.warmupPeriod,u.defaultSettings.warmupPeriod);this.minimumFrameRateDuringWarmup=e(r.minimumFrameRateDuringWarmup,u.defaultSettings.minimumFrameRateDuringWarmup);this.minimumFrameRateAfterWarmup=e(r.minimumFrameRateAfterWarmup,u.defaultSettings.minimumFrameRateAfterWarmup);this._lowFrameRate=new a;this._nominalFrameRate=new a;this._frameTimes=[];this._needsQuietPeriod=true;this._quietPeriodEndTime=0;this._warmupPeriodEndTime=0;this._frameRateIsLow=false;this._lastFramesPerSecond=undefined;this._pauseCount=0;var i=this;this._preRenderRemoveListener=this._scene.preRender.addEventListener(function(e,t){l(i,t)});this._hiddenPropertyName=document.hidden!==undefined?"hidden":document.mozHidden!==undefined?"mozHidden":document.msHidden!==undefined?"msHidden":document.webkitHidden!==undefined?"webkitHidden":undefined;var o=document.hidden!==undefined?"visibilitychange":document.mozHidden!==undefined?"mozvisibilitychange":document.msHidden!==undefined?"msvisibilitychange":document.webkitHidden!==undefined?"webkitvisibilitychange":undefined;function s(){c(i)}this._visibilityChangeRemoveListener=undefined;if(t(o)){document.addEventListener(o,s,false);this._visibilityChangeRemoveListener=function(){document.removeEventListener(o,s,false)}}}u.defaultSettings={samplingWindow:5,quietPeriod:2,warmupPeriod:5,minimumFrameRateDuringWarmup:4,minimumFrameRateAfterWarmup:8};u.fromScene=function(e){if(!t(e)){throw new n("scene is required.")}if(!t(e._frameRateMonitor)||e._frameRateMonitor.isDestroyed()){e._frameRateMonitor=new u({scene:e})}return e._frameRateMonitor};r(u.prototype,{scene:{get:function(){return this._scene}},lowFrameRate:{get:function(){return this._lowFrameRate}},nominalFrameRate:{get:function(){return this._nominalFrameRate}},lastFramesPerSecond:{get:function(){return this._lastFramesPerSecond}}});u.prototype.pause=function(){++this._pauseCount;if(this._pauseCount===1){this._frameTimes.length=0;this._lastFramesPerSecond=undefined}};u.prototype.unpause=function(){--this._pauseCount;if(this._pauseCount<=0){this._pauseCount=0;this._needsQuietPeriod=true}};u.prototype.isDestroyed=function(){return false};u.prototype.destroy=function(){this._preRenderRemoveListener();if(t(this._visibilityChangeRemoveListener)){this._visibilityChangeRemoveListener()}return i(this)};function l(e,t){if(e._pauseCount>0){return}var r=o();if(e._needsQuietPeriod){e._needsQuietPeriod=false;e._frameTimes.length=0;e._quietPeriodEndTime=r+e.quietPeriod/s.SECONDS_PER_MILLISECOND;e._warmupPeriodEndTime=e._quietPeriodEndTime+(e.warmupPeriod+e.samplingWindow)/s.SECONDS_PER_MILLISECOND}else if(r>=e._quietPeriodEndTime){e._frameTimes.push(r);var i=r-e.samplingWindow/s.SECONDS_PER_MILLISECOND;if(e._frameTimes.length>=2&&e._frameTimes[0]<=i){while(e._frameTimes.length>=2&&e._frameTimes[1]<i){e._frameTimes.shift()}var n=(r-e._frameTimes[0])/(e._frameTimes.length-1);e._lastFramesPerSecond=1e3/n;var a=1e3/(r>e._warmupPeriodEndTime?e.minimumFrameRateAfterWarmup:e.minimumFrameRateDuringWarmup);if(n>a){if(!e._frameRateIsLow){e._frameRateIsLow=true;e._needsQuietPeriod=true;e.lowFrameRate.raiseEvent(e.scene,e._lastFramesPerSecond)}}else if(e._frameRateIsLow){e._frameRateIsLow=false;e._needsQuietPeriod=true;e.nominalFrameRate.raiseEvent(e.scene,e._lastFramesPerSecond)}}}}function c(e){if(document[e._hiddenPropertyName]){e.pause()}else{e.unpause()}}return u});define("Scene/FrameState",["./SceneMode"],function(e){"use strict";function t(t,r,i){this.context=t;this.commandList=[];this.shadowMaps=[];this.mode=e.SCENE3D;this.morphTime=e.getMorphTime(e.SCENE3D);this.frameNumber=0;this.time=undefined;this.jobScheduler=i;this.mapProjection=undefined;this.camera=undefined;this.cullingVolume=undefined;this.occluder=undefined;this.maximumScreenSpaceError=undefined;this.passes={render:false,pick:false,depth:false};this.creditDisplay=r;this.afterRender=[];this.scene3DOnly=false;this.fog={enabled:false,density:undefined,sse:undefined};this.terrainExaggeration=1;this.shadowHints={shadowsEnabled:true,shadowMaps:[],lightShadowMaps:[],nearPlane:1,farPlane:5e3,closestObjectSize:1e3,lastDirtyTime:0,outOfView:true};this.imagerySplitPosition=0;this.frustumSplits=[]}t.prototype.addCommand=function(e){this.commandList.push(e)};return t});define("Scene/FrustumCommands",["../Core/defaultValue","../Renderer/Pass"],function(e,t){"use strict";function r(r,i){this.near=e(r,0);this.far=e(i,0);var n=t.NUMBER_OF_PASSES;var a=new Array(n);var o=new Array(n);for(var s=0;s<n;++s){a[s]=[];o[s]=0}this.commands=a;this.indices=o}return r});define("Shaders/PostProcessFilters/FXAA",[],function(){"use strict";return"#ifndef FXAA_PRESET\n#define FXAA_PRESET 3\n#endif\n#if (FXAA_PRESET == 3)\n#define FXAA_EDGE_THRESHOLD      (1.0/8.0)\n#define FXAA_EDGE_THRESHOLD_MIN  (1.0/24.0)\n#define FXAA_SEARCH_STEPS        16\n#define FXAA_SEARCH_THRESHOLD    (1.0/4.0)\n#define FXAA_SUBPIX_CAP          (3.0/4.0)\n#define FXAA_SUBPIX_TRIM         (1.0/4.0)\n#endif\n#if (FXAA_PRESET == 4)\n#define FXAA_EDGE_THRESHOLD      (1.0/8.0)\n#define FXAA_EDGE_THRESHOLD_MIN  (1.0/24.0)\n#define FXAA_SEARCH_STEPS        24\n#define FXAA_SEARCH_THRESHOLD    (1.0/4.0)\n#define FXAA_SUBPIX_CAP          (3.0/4.0)\n#define FXAA_SUBPIX_TRIM         (1.0/4.0)\n#endif\n#if (FXAA_PRESET == 5)\n#define FXAA_EDGE_THRESHOLD      (1.0/8.0)\n#define FXAA_EDGE_THRESHOLD_MIN  (1.0/24.0)\n#define FXAA_SEARCH_STEPS        32\n#define FXAA_SEARCH_THRESHOLD    (1.0/4.0)\n#define FXAA_SUBPIX_CAP          (3.0/4.0)\n#define FXAA_SUBPIX_TRIM         (1.0/4.0)\n#endif\n#define FXAA_SUBPIX_TRIM_SCALE (1.0/(1.0 - FXAA_SUBPIX_TRIM))\nfloat FxaaLuma(vec3 rgb) {\nreturn rgb.y * (0.587/0.299) + rgb.x;\n}\nvec3 FxaaLerp3(vec3 a, vec3 b, float amountOfA) {\nreturn (vec3(-amountOfA) * b) + ((a * vec3(amountOfA)) + b);\n}\nvec4 FxaaTexOff(sampler2D tex, vec2 pos, ivec2 off, vec2 rcpFrame) {\nfloat x = pos.x + float(off.x) * rcpFrame.x;\nfloat y = pos.y + float(off.y) * rcpFrame.y;\nreturn texture2D(tex, vec2(x, y));\n}\nvec3 FxaaPixelShader(vec2 pos, sampler2D tex, vec2 rcpFrame)\n{\nvec3 rgbN = FxaaTexOff(tex, pos.xy, ivec2( 0,-1), rcpFrame).xyz;\nvec3 rgbW = FxaaTexOff(tex, pos.xy, ivec2(-1, 0), rcpFrame).xyz;\nvec3 rgbM = FxaaTexOff(tex, pos.xy, ivec2( 0, 0), rcpFrame).xyz;\nvec3 rgbE = FxaaTexOff(tex, pos.xy, ivec2( 1, 0), rcpFrame).xyz;\nvec3 rgbS = FxaaTexOff(tex, pos.xy, ivec2( 0, 1), rcpFrame).xyz;\nfloat lumaN = FxaaLuma(rgbN);\nfloat lumaW = FxaaLuma(rgbW);\nfloat lumaM = FxaaLuma(rgbM);\nfloat lumaE = FxaaLuma(rgbE);\nfloat lumaS = FxaaLuma(rgbS);\nfloat rangeMin = min(lumaM, min(min(lumaN, lumaW), min(lumaS, lumaE)));\nfloat rangeMax = max(lumaM, max(max(lumaN, lumaW), max(lumaS, lumaE)));\nfloat range = rangeMax - rangeMin;\nif(range < max(FXAA_EDGE_THRESHOLD_MIN, rangeMax * FXAA_EDGE_THRESHOLD))\n{\nreturn rgbM;\n}\nvec3 rgbL = rgbN + rgbW + rgbM + rgbE + rgbS;\nfloat lumaL = (lumaN + lumaW + lumaE + lumaS) * 0.25;\nfloat rangeL = abs(lumaL - lumaM);\nfloat blendL = max(0.0, (rangeL / range) - FXAA_SUBPIX_TRIM) * FXAA_SUBPIX_TRIM_SCALE;\nblendL = min(FXAA_SUBPIX_CAP, blendL);\nvec3 rgbNW = FxaaTexOff(tex, pos.xy, ivec2(-1,-1), rcpFrame).xyz;\nvec3 rgbNE = FxaaTexOff(tex, pos.xy, ivec2( 1,-1), rcpFrame).xyz;\nvec3 rgbSW = FxaaTexOff(tex, pos.xy, ivec2(-1, 1), rcpFrame).xyz;\nvec3 rgbSE = FxaaTexOff(tex, pos.xy, ivec2( 1, 1), rcpFrame).xyz;\nrgbL += (rgbNW + rgbNE + rgbSW + rgbSE);\nrgbL *= vec3(1.0/9.0);\nfloat lumaNW = FxaaLuma(rgbNW);\nfloat lumaNE = FxaaLuma(rgbNE);\nfloat lumaSW = FxaaLuma(rgbSW);\nfloat lumaSE = FxaaLuma(rgbSE);\nfloat edgeVert =\nabs((0.25 * lumaNW) + (-0.5 * lumaN) + (0.25 * lumaNE)) +\nabs((0.50 * lumaW ) + (-1.0 * lumaM) + (0.50 * lumaE )) +\nabs((0.25 * lumaSW) + (-0.5 * lumaS) + (0.25 * lumaSE));\nfloat edgeHorz =\nabs((0.25 * lumaNW) + (-0.5 * lumaW) + (0.25 * lumaSW)) +\nabs((0.50 * lumaN ) + (-1.0 * lumaM) + (0.50 * lumaS )) +\nabs((0.25 * lumaNE) + (-0.5 * lumaE) + (0.25 * lumaSE));\nbool horzSpan = edgeHorz >= edgeVert;\nfloat lengthSign = horzSpan ? -rcpFrame.y : -rcpFrame.x;\nif(!horzSpan)\n{\nlumaN = lumaW;\nlumaS = lumaE;\n}\nfloat gradientN = abs(lumaN - lumaM);\nfloat gradientS = abs(lumaS - lumaM);\nlumaN = (lumaN + lumaM) * 0.5;\nlumaS = (lumaS + lumaM) * 0.5;\nif (gradientN < gradientS)\n{\nlumaN = lumaS;\nlumaN = lumaS;\ngradientN = gradientS;\nlengthSign *= -1.0;\n}\nvec2 posN;\nposN.x = pos.x + (horzSpan ? 0.0 : lengthSign * 0.5);\nposN.y = pos.y + (horzSpan ? lengthSign * 0.5 : 0.0);\ngradientN *= FXAA_SEARCH_THRESHOLD;\nvec2 posP = posN;\nvec2 offNP = horzSpan ? vec2(rcpFrame.x, 0.0) : vec2(0.0, rcpFrame.y);\nfloat lumaEndN = lumaN;\nfloat lumaEndP = lumaN;\nbool doneN = false;\nbool doneP = false;\nposN += offNP * vec2(-1.0, -1.0);\nposP += offNP * vec2( 1.0,  1.0);\nfor(int i = 0; i < FXAA_SEARCH_STEPS; i++) {\nif(!doneN)\n{\nlumaEndN = FxaaLuma(texture2D(tex, posN.xy).xyz);\n}\nif(!doneP)\n{\nlumaEndP = FxaaLuma(texture2D(tex, posP.xy).xyz);\n}\ndoneN = doneN || (abs(lumaEndN - lumaN) >= gradientN);\ndoneP = doneP || (abs(lumaEndP - lumaN) >= gradientN);\nif(doneN && doneP)\n{\nbreak;\n}\nif(!doneN)\n{\nposN -= offNP;\n}\nif(!doneP)\n{\nposP += offNP;\n}\n}\nfloat dstN = horzSpan ? pos.x - posN.x : pos.y - posN.y;\nfloat dstP = horzSpan ? posP.x - pos.x : posP.y - pos.y;\nbool directionN = dstN < dstP;\nlumaEndN = directionN ? lumaEndN : lumaEndP;\nif(((lumaM - lumaN) < 0.0) == ((lumaEndN - lumaN) < 0.0))\n{\nlengthSign = 0.0;\n}\nfloat spanLength = (dstP + dstN);\ndstN = directionN ? dstN : dstP;\nfloat subPixelOffset = (0.5 + (dstN * (-1.0/spanLength))) * lengthSign;\nvec3 rgbF = texture2D(tex, vec2(\npos.x + (horzSpan ? 0.0 : subPixelOffset),\npos.y + (horzSpan ? subPixelOffset : 0.0))).xyz;\nreturn FxaaLerp3(rgbL, rgbF, blendL);\n}\nuniform sampler2D u_texture;\nuniform vec2 u_step;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\ngl_FragColor = vec4(FxaaPixelShader(v_textureCoordinates, u_texture, u_step), 1.0);\n}\n"});define("Scene/FXAA",["../Core/BoundingRectangle","../Core/Cartesian2","../Core/Color","../Core/defined","../Core/destroyObject","../Core/PixelFormat","../Renderer/ClearCommand","../Renderer/Framebuffer","../Renderer/PixelDatatype","../Renderer/Renderbuffer","../Renderer/RenderbufferFormat","../Renderer/RenderState","../Renderer/Texture","../Shaders/PostProcessFilters/FXAA"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h){"use strict";function p(t){this._texture=undefined;this._depthStencilTexture=undefined;this._depthStencilRenderbuffer=undefined;this._fbo=undefined;this._command=undefined;this._viewport=new e;this._rs=undefined;var i=new o({color:new r(0,0,0,0),depth:1,owner:this});this._clearCommand=i}function m(e){e._fbo=e._fbo&&e._fbo.destroy();e._texture=e._texture&&e._texture.destroy();e._depthStencilTexture=e._depthStencilTexture&&e._depthStencilTexture.destroy();e._depthStencilRenderbuffer=e._depthStencilRenderbuffer&&e._depthStencilRenderbuffer.destroy();e._fbo=undefined;e._texture=undefined;e._depthStencilTexture=undefined;e._depthStencilRenderbuffer=undefined;if(i(e._command)){e._command.shaderProgram=e._command.shaderProgram&&e._command.shaderProgram.destroy();e._command=undefined}}p.prototype.update=function(r){var n=r.drawingBufferWidth;var o=r.drawingBufferHeight;var p=this._texture;var m=!i(p)||p.width!==n||p.height!==o;if(m){this._texture=this._texture&&this._texture.destroy();this._depthStencilTexture=this._depthStencilTexture&&this._depthStencilTexture.destroy();this._depthStencilRenderbuffer=this._depthStencilRenderbuffer&&this._depthStencilRenderbuffer.destroy();this._texture=new f({context:r,width:n,height:o,pixelFormat:a.RGBA,pixelDatatype:u.UNSIGNED_BYTE});if(r.depthTexture){this._depthStencilTexture=new f({context:r,width:n,height:o,pixelFormat:a.DEPTH_STENCIL,pixelDatatype:u.UNSIGNED_INT_24_8})}else{this._depthStencilRenderbuffer=new l({context:r,width:n,height:o,format:c.DEPTH_STENCIL})}}if(!i(this._fbo)||m){this._fbo=this._fbo&&this._fbo.destroy();this._fbo=new s({context:r,colorTextures:[this._texture],depthStencilTexture:this._depthStencilTexture,depthStencilRenderbuffer:this._depthStencilRenderbuffer,destroyAttachments:false})}if(!i(this._command)){this._command=r.createViewportQuadCommand(h,{owner:this})}this._viewport.width=n;this._viewport.height=o;if(!i(this._rs)||!e.equals(this._rs.viewport,this._viewport)){this._rs=d.fromCache({viewport:this._viewport})}this._command.renderState=this._rs;if(m){var v=this;var _=new t(1/this._texture.width,1/this._texture.height);this._command.uniformMap={u_texture:function(){return v._texture},u_step:function(){return _}}}};p.prototype.execute=function(e,t){this._command.execute(e,t)};p.prototype.clear=function(e,t,i){var n=t.framebuffer;t.framebuffer=this._fbo;r.clone(i,this._clearCommand.color);this._clearCommand.execute(e,t);t.framebuffer=n};p.prototype.getColorFramebuffer=function(){return this._fbo};p.prototype.isDestroyed=function(){return false};p.prototype.destroy=function(){m(this);return n(this)};return p});define("Scene/GetFeatureInfoFormat",["../Core/Cartographic","../Core/defined","../Core/DeveloperError","../Core/RuntimeError","./ImageryLayerFeatureInfo"],function(e,t,r,i,n){"use strict";function a(e,i,n){if(!t(e)){throw new r("type is required.")}this.type=e;if(!t(i)){if(e==="json"){i="application/json"}else if(e==="xml"){i="text/xml"}else if(e==="html"){i="text/html"}else if(e==="text"){i="text/plain"}else{throw new r('format is required when type is not "json", "xml", "html", or "text".')}}this.format=i;if(!t(n)){if(e==="json"){n=o}else if(e==="xml"){n=d}else if(e==="html"){n=b}else if(e==="text"){n=b}else{throw new r('callback is required when type is not "json", "xml", "html", or "text".')}}this.callback=n}function o(r){var i=[];var a=r.features;for(var o=0;o<a.length;++o){var s=a[o];var u=new n;u.data=s;u.properties=s.properties;u.configureNameFromProperties(s.properties);u.configureDescriptionFromProperties(s.properties);if(t(s.geometry)&&s.geometry.type==="Point"){var l=s.geometry.coordinates[0];var c=s.geometry.coordinates[1];u.position=e.fromDegrees(l,c)}i.push(u)}return i}var s="http://www.mapinfo.com/mxp";var u="http://www.esri.com/wms";var l="http://www.opengis.net/wfs";var c="http://www.opengis.net/gml";function d(e){var t=e.documentElement;if(t.localName==="MultiFeatureCollection"&&t.namespaceURI===s){return f(e)}else if(t.localName==="FeatureInfoResponse"&&t.namespaceURI===u){return h(e)}else if(t.localName==="FeatureCollection"&&t.namespaceURI===l){return p(e)}else if(t.localName==="ServiceExceptionReport"){throw new i((new XMLSerializer).serializeToString(t))}else if(t.localName==="msGMLOutput"){return m(e)}else{return g(e)}}function f(e){var t=[];var r=e.documentElement;var i=r.getElementsByTagNameNS(s,"Feature");for(var a=0;a<i.length;++a){var o=i[a];var u={};var l=o.getElementsByTagNameNS(s,"Val");for(var c=0;c<l.length;++c){var d=l[c];if(d.hasAttribute("ref")){var f=d.getAttribute("ref");var h=d.textContent.trim();u[f]=h}}var p=new n;p.data=o;p.properties=u;p.configureNameFromProperties(u);p.configureDescriptionFromProperties(u);t.push(p)}return t}function h(e){var t=e.documentElement;var r=[];var i;var n=t.getElementsByTagNameNS("*","FIELDS");if(n.length>0){for(var a=0;a<n.length;++a){var o=n[a];i={};var s=o.attributes;for(var u=0;u<s.length;++u){var l=s[u];i[l.name]=l.value}r.push(_(o,i))}}else{var c=t.getElementsByTagNameNS("*","FeatureInfo");for(var d=0;d<c.length;++d){var f=c[d];i={};var h=f.childNodes;for(var p=0;p<h.length;++p){var m=h[p];if(m.nodeType===Node.ELEMENT_NODE){i[m.localName]=m.textContent}}r.push(_(f,i))}}return r}function p(e){var t=[];var r=e.documentElement;var i=r.getElementsByTagNameNS(c,"featureMember");for(var n=0;n<i.length;++n){var a=i[n];var o={};v(a,o);t.push(_(a,o))}return t}function m(e){var t=[];var r;var i=e.documentElement.childNodes;for(var n=0;n<i.length;n++){if(i[n].nodeType===Node.ELEMENT_NODE){r=i[n];break}}var a=r.childNodes;for(var o=0;o<a.length;++o){var s=a[o];if(s.nodeType===Node.ELEMENT_NODE){var u={};v(s,u);t.push(_(s,u))}}return t}function v(e,t){var r=true;for(var i=0;i<e.childNodes.length;++i){var n=e.childNodes[i];if(n.nodeType===Node.ELEMENT_NODE){r=false}if(n.localName==="Point"||n.localName==="LineString"||n.localName==="Polygon"||n.localName==="boundedBy"){continue}if(n.hasChildNodes()&&v(n,t)){t[n.localName]=n.textContent}}return r}function _(e,t){var r=new n;r.data=e;r.properties=t;r.configureNameFromProperties(t);r.configureDescriptionFromProperties(t);return r}function g(e){var t=(new XMLSerializer).serializeToString(e);var r=document.createElement("div");var i=document.createElement("pre");i.textContent=t;r.appendChild(i);var a=new n;a.data=e;a.description=r.innerHTML;return[a]}var y=/<body>\s*<\/body>/im;var w=/<ServiceExceptionReport([\s\S]*)<\/ServiceExceptionReport>/im;var C=/<title>([\s\S]*)<\/title>/im;function b(e){if(y.test(e)){return undefined}if(w.test(e)){return undefined}var t;var r=C.exec(e);if(r&&r.length>1){t=r[1]}var i=new n;i.name=t;i.description=e;i.data=e;return[i]}return a});define("Shaders/GlobeFS",[],function(){"use strict";return"uniform vec4 u_initialColor;\n#if TEXTURE_UNITS > 0\nuniform sampler2D u_dayTextures[TEXTURE_UNITS];\nuniform vec4 u_dayTextureTranslationAndScale[TEXTURE_UNITS];\nuniform bool u_dayTextureUseWebMercatorT[TEXTURE_UNITS];\n#ifdef APPLY_ALPHA\nuniform float u_dayTextureAlpha[TEXTURE_UNITS];\n#endif\n#ifdef APPLY_SPLIT\nuniform float u_dayTextureSplit[TEXTURE_UNITS];\n#endif\n#ifdef APPLY_BRIGHTNESS\nuniform float u_dayTextureBrightness[TEXTURE_UNITS];\n#endif\n#ifdef APPLY_CONTRAST\nuniform float u_dayTextureContrast[TEXTURE_UNITS];\n#endif\n#ifdef APPLY_HUE\nuniform float u_dayTextureHue[TEXTURE_UNITS];\n#endif\n#ifdef APPLY_SATURATION\nuniform float u_dayTextureSaturation[TEXTURE_UNITS];\n#endif\n#ifdef APPLY_GAMMA\nuniform float u_dayTextureOneOverGamma[TEXTURE_UNITS];\n#endif\nuniform vec4 u_dayTextureTexCoordsRectangle[TEXTURE_UNITS];\n#endif\n#ifdef SHOW_REFLECTIVE_OCEAN\nuniform sampler2D u_waterMask;\nuniform vec4 u_waterMaskTranslationAndScale;\nuniform float u_zoomedOutOceanSpecularIntensity;\n#endif\n#ifdef SHOW_OCEAN_WAVES\nuniform sampler2D u_oceanNormalMap;\n#endif\n#ifdef ENABLE_DAYNIGHT_SHADING\nuniform vec2 u_lightingFadeDistance;\n#endif\nvarying vec3 v_positionMC;\nvarying vec3 v_positionEC;\nvarying vec3 v_textureCoordinates;\nvarying vec3 v_normalMC;\nvarying vec3 v_normalEC;\n#ifdef FOG\nvarying float v_distance;\nvarying vec3 v_rayleighColor;\nvarying vec3 v_mieColor;\n#endif\nvec4 sampleAndBlend(\nvec4 previousColor,\nsampler2D texture,\nvec2 tileTextureCoordinates,\nvec4 textureCoordinateRectangle,\nvec4 textureCoordinateTranslationAndScale,\nfloat textureAlpha,\nfloat textureBrightness,\nfloat textureContrast,\nfloat textureHue,\nfloat textureSaturation,\nfloat textureOneOverGamma,\nfloat split)\n{\nvec2 alphaMultiplier = step(textureCoordinateRectangle.st, tileTextureCoordinates);\ntextureAlpha = textureAlpha * alphaMultiplier.x * alphaMultiplier.y;\nalphaMultiplier = step(vec2(0.0), textureCoordinateRectangle.pq - tileTextureCoordinates);\ntextureAlpha = textureAlpha * alphaMultiplier.x * alphaMultiplier.y;\nvec2 translation = textureCoordinateTranslationAndScale.xy;\nvec2 scale = textureCoordinateTranslationAndScale.zw;\nvec2 textureCoordinates = tileTextureCoordinates * scale + translation;\nvec4 value = texture2D(texture, textureCoordinates);\nvec3 color = value.rgb;\nfloat alpha = value.a;\n#ifdef APPLY_SPLIT\nfloat splitPosition = czm_imagerySplitPosition * czm_viewport.z;\nif (split < 0.0 && gl_FragCoord.x > splitPosition) {\nalpha = 0.0;\n}\nelse if (split > 0.0 && gl_FragCoord.x < splitPosition) {\nalpha = 0.0;\n}\n#endif\n#ifdef APPLY_BRIGHTNESS\ncolor = mix(vec3(0.0), color, textureBrightness);\n#endif\n#ifdef APPLY_CONTRAST\ncolor = mix(vec3(0.5), color, textureContrast);\n#endif\n#ifdef APPLY_HUE\ncolor = czm_hue(color, textureHue);\n#endif\n#ifdef APPLY_SATURATION\ncolor = czm_saturation(color, textureSaturation);\n#endif\n#ifdef APPLY_GAMMA\ncolor = pow(color, vec3(textureOneOverGamma));\n#endif\nfloat sourceAlpha = alpha * textureAlpha;\nfloat outAlpha = mix(previousColor.a, 1.0, sourceAlpha);\nvec3 outColor = mix(previousColor.rgb * previousColor.a, color, sourceAlpha) / outAlpha;\nreturn vec4(outColor, outAlpha);\n}\nvec4 computeDayColor(vec4 initialColor, vec3 textureCoordinates);\nvec4 computeWaterColor(vec3 positionEyeCoordinates, vec2 textureCoordinates, mat3 enuToEye, vec4 imageryColor, float specularMapValue);\nvoid main()\n{\nvec4 color = computeDayColor(u_initialColor, clamp(v_textureCoordinates, 0.0, 1.0));\n#ifdef SHOW_TILE_BOUNDARIES\nif (v_textureCoordinates.x < (1.0/256.0) || v_textureCoordinates.x > (255.0/256.0) ||\nv_textureCoordinates.y < (1.0/256.0) || v_textureCoordinates.y > (255.0/256.0))\n{\ncolor = vec4(1.0, 0.0, 0.0, 1.0);\n}\n#endif\n#if defined(SHOW_REFLECTIVE_OCEAN) || defined(ENABLE_DAYNIGHT_SHADING)\nvec3 normalMC = czm_geodeticSurfaceNormal(v_positionMC, vec3(0.0), vec3(1.0));\nvec3 normalEC = czm_normal3D * normalMC;\n#endif\n#ifdef SHOW_REFLECTIVE_OCEAN\nvec2 waterMaskTranslation = u_waterMaskTranslationAndScale.xy;\nvec2 waterMaskScale = u_waterMaskTranslationAndScale.zw;\nvec2 waterMaskTextureCoordinates = v_textureCoordinates.xy * waterMaskScale + waterMaskTranslation;\nfloat mask = texture2D(u_waterMask, waterMaskTextureCoordinates).r;\nif (mask > 0.0)\n{\nmat3 enuToEye = czm_eastNorthUpToEyeCoordinates(v_positionMC, normalEC);\nvec2 ellipsoidTextureCoordinates = czm_ellipsoidWgs84TextureCoordinates(normalMC);\nvec2 ellipsoidFlippedTextureCoordinates = czm_ellipsoidWgs84TextureCoordinates(normalMC.zyx);\nvec2 textureCoordinates = mix(ellipsoidTextureCoordinates, ellipsoidFlippedTextureCoordinates, czm_morphTime * smoothstep(0.9, 0.95, normalMC.z));\ncolor = computeWaterColor(v_positionEC, textureCoordinates, enuToEye, color, mask);\n}\n#endif\n#ifdef ENABLE_VERTEX_LIGHTING\nfloat diffuseIntensity = clamp(czm_getLambertDiffuse(czm_sunDirectionEC, normalize(v_normalEC)) * 0.9 + 0.3, 0.0, 1.0);\nvec4 finalColor = vec4(color.rgb * diffuseIntensity, color.a);\n#elif defined(ENABLE_DAYNIGHT_SHADING)\nfloat diffuseIntensity = clamp(czm_getLambertDiffuse(czm_sunDirectionEC, normalEC) * 5.0 + 0.3, 0.0, 1.0);\nfloat cameraDist = length(czm_view[3]);\nfloat fadeOutDist = u_lightingFadeDistance.x;\nfloat fadeInDist = u_lightingFadeDistance.y;\nfloat t = clamp((cameraDist - fadeOutDist) / (fadeInDist - fadeOutDist), 0.0, 1.0);\ndiffuseIntensity = mix(1.0, diffuseIntensity, t);\nvec4 finalColor = vec4(color.rgb * diffuseIntensity, color.a);\n#else\nvec4 finalColor = color;\n#endif\n#ifdef FOG\nconst float fExposure = 2.0;\nvec3 fogColor = v_mieColor + finalColor.rgb * v_rayleighColor;\nfogColor = vec3(1.0) - exp(-fExposure * fogColor);\ngl_FragColor = vec4(czm_fog(v_distance, finalColor.rgb, fogColor), finalColor.a);\n#else\ngl_FragColor = finalColor;\n#endif\n}\n#ifdef SHOW_REFLECTIVE_OCEAN\nfloat waveFade(float edge0, float edge1, float x)\n{\nfloat y = clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);\nreturn pow(1.0 - y, 5.0);\n}\nfloat linearFade(float edge0, float edge1, float x)\n{\nreturn clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);\n}\nconst float oceanFrequencyLowAltitude = 825000.0;\nconst float oceanAnimationSpeedLowAltitude = 0.004;\nconst float oceanOneOverAmplitudeLowAltitude = 1.0 / 2.0;\nconst float oceanSpecularIntensity = 0.5;\nconst float oceanFrequencyHighAltitude = 125000.0;\nconst float oceanAnimationSpeedHighAltitude = 0.008;\nconst float oceanOneOverAmplitudeHighAltitude = 1.0 / 2.0;\nvec4 computeWaterColor(vec3 positionEyeCoordinates, vec2 textureCoordinates, mat3 enuToEye, vec4 imageryColor, float maskValue)\n{\nvec3 positionToEyeEC = -positionEyeCoordinates;\nfloat positionToEyeECLength = length(positionToEyeEC);\nvec3 normalizedpositionToEyeEC = normalize(normalize(positionToEyeEC));\nfloat waveIntensity = waveFade(70000.0, 1000000.0, positionToEyeECLength);\n#ifdef SHOW_OCEAN_WAVES\nfloat time = czm_frameNumber * oceanAnimationSpeedHighAltitude;\nvec4 noise = czm_getWaterNoise(u_oceanNormalMap, textureCoordinates * oceanFrequencyHighAltitude, time, 0.0);\nvec3 normalTangentSpaceHighAltitude = vec3(noise.xy, noise.z * oceanOneOverAmplitudeHighAltitude);\ntime = czm_frameNumber * oceanAnimationSpeedLowAltitude;\nnoise = czm_getWaterNoise(u_oceanNormalMap, textureCoordinates * oceanFrequencyLowAltitude, time, 0.0);\nvec3 normalTangentSpaceLowAltitude = vec3(noise.xy, noise.z * oceanOneOverAmplitudeLowAltitude);\nfloat highAltitudeFade = linearFade(0.0, 60000.0, positionToEyeECLength);\nfloat lowAltitudeFade = 1.0 - linearFade(20000.0, 60000.0, positionToEyeECLength);\nvec3 normalTangentSpace =\n(highAltitudeFade * normalTangentSpaceHighAltitude) +\n(lowAltitudeFade * normalTangentSpaceLowAltitude);\nnormalTangentSpace = normalize(normalTangentSpace);\nnormalTangentSpace.xy *= waveIntensity;\nnormalTangentSpace = normalize(normalTangentSpace);\n#else\nvec3 normalTangentSpace = vec3(0.0, 0.0, 1.0);\n#endif\nvec3 normalEC = enuToEye * normalTangentSpace;\nconst vec3 waveHighlightColor = vec3(0.3, 0.45, 0.6);\nfloat diffuseIntensity = czm_getLambertDiffuse(czm_sunDirectionEC, normalEC) * maskValue;\nvec3 diffuseHighlight = waveHighlightColor * diffuseIntensity;\n#ifdef SHOW_OCEAN_WAVES\nfloat tsPerturbationRatio = normalTangentSpace.z;\nvec3 nonDiffuseHighlight = mix(waveHighlightColor * 5.0 * (1.0 - tsPerturbationRatio), vec3(0.0), diffuseIntensity);\n#else\nvec3 nonDiffuseHighlight = vec3(0.0);\n#endif\nfloat specularIntensity = czm_getSpecular(czm_sunDirectionEC, normalizedpositionToEyeEC, normalEC, 10.0) + 0.25 * czm_getSpecular(czm_moonDirectionEC, normalizedpositionToEyeEC, normalEC, 10.0);\nfloat surfaceReflectance = mix(0.0, mix(u_zoomedOutOceanSpecularIntensity, oceanSpecularIntensity, waveIntensity), maskValue);\nfloat specular = specularIntensity * surfaceReflectance;\nreturn vec4(imageryColor.rgb + diffuseHighlight + nonDiffuseHighlight + specular, imageryColor.a);\n}\n#endif // #ifdef SHOW_REFLECTIVE_OCEAN\n"});define("Shaders/GlobeVS",[],function(){"use strict";return"#ifdef QUANTIZATION_BITS12\nattribute vec4 compressed0;\nattribute float compressed1;\n#else\nattribute vec4 position3DAndHeight;\nattribute vec4 textureCoordAndEncodedNormals;\n#endif\nuniform vec3 u_center3D;\nuniform mat4 u_modifiedModelView;\nuniform mat4 u_modifiedModelViewProjection;\nuniform vec4 u_tileRectangle;\nuniform vec2 u_southAndNorthLatitude;\nuniform vec2 u_southMercatorYAndOneOverHeight;\nvarying vec3 v_positionMC;\nvarying vec3 v_positionEC;\nvarying vec3 v_textureCoordinates;\nvarying vec3 v_normalMC;\nvarying vec3 v_normalEC;\n#ifdef FOG\nvarying float v_distance;\nvarying vec3 v_mieColor;\nvarying vec3 v_rayleighColor;\n#endif\nvec4 getPosition(vec3 position, float height, vec2 textureCoordinates);\nfloat get2DYPositionFraction(vec2 textureCoordinates);\nvec4 getPosition3DMode(vec3 position, float height, vec2 textureCoordinates)\n{\nreturn u_modifiedModelViewProjection * vec4(position, 1.0);\n}\nfloat get2DMercatorYPositionFraction(vec2 textureCoordinates)\n{\nconst float maxTileWidth = 0.003068;\nfloat positionFraction = textureCoordinates.y;\nfloat southLatitude = u_southAndNorthLatitude.x;\nfloat northLatitude = u_southAndNorthLatitude.y;\nif (northLatitude - southLatitude > maxTileWidth)\n{\nfloat southMercatorY = u_southMercatorYAndOneOverHeight.x;\nfloat oneOverMercatorHeight = u_southMercatorYAndOneOverHeight.y;\nfloat currentLatitude = mix(southLatitude, northLatitude, textureCoordinates.y);\ncurrentLatitude = clamp(currentLatitude, -czm_webMercatorMaxLatitude, czm_webMercatorMaxLatitude);\npositionFraction = czm_latitudeToWebMercatorFraction(currentLatitude, southMercatorY, oneOverMercatorHeight);\n}\nreturn positionFraction;\n}\nfloat get2DGeographicYPositionFraction(vec2 textureCoordinates)\n{\nreturn textureCoordinates.y;\n}\nvec4 getPositionPlanarEarth(vec3 position, float height, vec2 textureCoordinates)\n{\nfloat yPositionFraction = get2DYPositionFraction(textureCoordinates);\nvec4 rtcPosition2D = vec4(height, mix(u_tileRectangle.st, u_tileRectangle.pq, vec2(textureCoordinates.x, yPositionFraction)), 1.0);\nreturn u_modifiedModelViewProjection * rtcPosition2D;\n}\nvec4 getPosition2DMode(vec3 position, float height, vec2 textureCoordinates)\n{\nreturn getPositionPlanarEarth(position, 0.0, textureCoordinates);\n}\nvec4 getPositionColumbusViewMode(vec3 position, float height, vec2 textureCoordinates)\n{\nreturn getPositionPlanarEarth(position, height, textureCoordinates);\n}\nvec4 getPositionMorphingMode(vec3 position, float height, vec2 textureCoordinates)\n{\nvec3 position3DWC = position + u_center3D;\nfloat yPositionFraction = get2DYPositionFraction(textureCoordinates);\nvec4 position2DWC = vec4(height, mix(u_tileRectangle.st, u_tileRectangle.pq, vec2(textureCoordinates.x, yPositionFraction)), 1.0);\nvec4 morphPosition = czm_columbusViewMorph(position2DWC, vec4(position3DWC, 1.0), czm_morphTime);\nreturn czm_modelViewProjection * morphPosition;\n}\n#ifdef QUANTIZATION_BITS12\nuniform vec2 u_minMaxHeight;\nuniform mat4 u_scaleAndBias;\n#endif\nvoid main()\n{\n#ifdef QUANTIZATION_BITS12\nvec2 xy = czm_decompressTextureCoordinates(compressed0.x);\nvec2 zh = czm_decompressTextureCoordinates(compressed0.y);\nvec3 position = vec3(xy, zh.x);\nfloat height = zh.y;\nvec2 textureCoordinates = czm_decompressTextureCoordinates(compressed0.z);\nheight = height * (u_minMaxHeight.y - u_minMaxHeight.x) + u_minMaxHeight.x;\nposition = (u_scaleAndBias * vec4(position, 1.0)).xyz;\n#if (defined(ENABLE_VERTEX_LIGHTING) || defined(GENERATE_POSITION_AND_NORMAL)) && defined(INCLUDE_WEB_MERCATOR_Y)\nfloat webMercatorT = czm_decompressTextureCoordinates(compressed0.w).x;\nfloat encodedNormal = compressed1;\n#elif defined(INCLUDE_WEB_MERCATOR_Y)\nfloat webMercatorT = czm_decompressTextureCoordinates(compressed0.w).x;\nfloat encodedNormal = 0.0;\n#elif defined(ENABLE_VERTEX_LIGHTING) || defined(GENERATE_POSITION_AND_NORMAL)\nfloat webMercatorT = textureCoordinates.y;\nfloat encodedNormal = compressed0.w;\n#else\nfloat webMercatorT = textureCoordinates.y;\nfloat encodedNormal = 0.0;\n#endif\n#else\nvec3 position = position3DAndHeight.xyz;\nfloat height = position3DAndHeight.w;\nvec2 textureCoordinates = textureCoordAndEncodedNormals.xy;\n#if (defined(ENABLE_VERTEX_LIGHTING) || defined(GENERATE_POSITION_AND_NORMAL)) && defined(INCLUDE_WEB_MERCATOR_Y)\nfloat webMercatorT = textureCoordAndEncodedNormals.z;\nfloat encodedNormal = textureCoordAndEncodedNormals.w;\n#elif defined(ENABLE_VERTEX_LIGHTING) || defined(GENERATE_POSITION_AND_NORMAL)\nfloat webMercatorT = textureCoordinates.y;\nfloat encodedNormal = textureCoordAndEncodedNormals.z;\n#elif defined(INCLUDE_WEB_MERCATOR_Y)\nfloat webMercatorT = textureCoordAndEncodedNormals.z;\nfloat encodedNormal = 0.0;\n#else\nfloat webMercatorT = textureCoordinates.y;\nfloat encodedNormal = 0.0;\n#endif\n#endif\nvec3 position3DWC = position + u_center3D;\ngl_Position = getPosition(position, height, textureCoordinates);\nv_textureCoordinates = vec3(textureCoordinates, webMercatorT);\n#if defined(ENABLE_VERTEX_LIGHTING) || defined(GENERATE_POSITION_AND_NORMAL)\nv_positionEC = (u_modifiedModelView * vec4(position, 1.0)).xyz;\nv_positionMC = position3DWC;\nv_normalMC = czm_octDecode(encodedNormal);\nv_normalEC = czm_normal3D * v_normalMC;\n#elif defined(SHOW_REFLECTIVE_OCEAN) || defined(ENABLE_DAYNIGHT_SHADING) || defined(GENERATE_POSITION)\nv_positionEC = (u_modifiedModelView * vec4(position, 1.0)).xyz;\nv_positionMC = position3DWC;\n#endif\n#ifdef FOG\nAtmosphereColor atmosColor = computeGroundAtmosphereFromSpace(position3DWC);\nv_mieColor = atmosColor.mie;\nv_rayleighColor = atmosColor.rayleigh;\nv_distance = length((czm_modelView3D * vec4(position3DWC, 1.0)).xyz);\n#endif\n}\n"});define("Shaders/GroundAtmosphere",[],function(){"use strict"
;return"const float fInnerRadius = 6378137.0;\nconst float fOuterRadius = 6378137.0 * 1.025;\nconst float fOuterRadius2 = fOuterRadius * fOuterRadius;\nconst float Kr = 0.0025;\nconst float Km = 0.0015;\nconst float ESun = 15.0;\nconst float fKrESun = Kr * ESun;\nconst float fKmESun = Km * ESun;\nconst float fKr4PI = Kr * 4.0 * czm_pi;\nconst float fKm4PI = Km * 4.0 * czm_pi;\nconst float fScale = 1.0 / (fOuterRadius - fInnerRadius);\nconst float fScaleDepth = 0.25;\nconst float fScaleOverScaleDepth = fScale / fScaleDepth;\nstruct AtmosphereColor\n{\nvec3 mie;\nvec3 rayleigh;\n};\nconst int nSamples = 2;\nconst float fSamples = 2.0;\nfloat scale(float fCos)\n{\nfloat x = 1.0 - fCos;\nreturn fScaleDepth * exp(-0.00287 + x*(0.459 + x*(3.83 + x*(-6.80 + x*5.25))));\n}\nAtmosphereColor computeGroundAtmosphereFromSpace(vec3 v3Pos)\n{\nvec3 v3InvWavelength = vec3(1.0 / pow(0.650, 4.0), 1.0 / pow(0.570, 4.0), 1.0 / pow(0.475, 4.0));\nvec3 v3Ray = v3Pos - czm_viewerPositionWC;\nfloat fFar = length(v3Ray);\nv3Ray /= fFar;\nfloat fCameraHeight = length(czm_viewerPositionWC);\nfloat fCameraHeight2 = fCameraHeight * fCameraHeight;\nfloat B = 2.0 * length(czm_viewerPositionWC) * dot(normalize(czm_viewerPositionWC), v3Ray);\nfloat C = fCameraHeight2 - fOuterRadius2;\nfloat fDet = max(0.0, B*B - 4.0 * C);\nfloat fNear = 0.5 * (-B - sqrt(fDet));\nvec3 v3Start = czm_viewerPositionWC + v3Ray * fNear;\nfFar -= fNear;\nfloat fDepth = exp((fInnerRadius - fOuterRadius) / fScaleDepth);\nfloat fLightAngle = 1.0;\nfloat fCameraAngle = dot(-v3Ray, v3Pos) / length(v3Pos);\nfloat fCameraScale = scale(fCameraAngle);\nfloat fLightScale = scale(fLightAngle);\nfloat fCameraOffset = fDepth*fCameraScale;\nfloat fTemp = (fLightScale + fCameraScale);\nfloat fSampleLength = fFar / fSamples;\nfloat fScaledLength = fSampleLength * fScale;\nvec3 v3SampleRay = v3Ray * fSampleLength;\nvec3 v3SamplePoint = v3Start + v3SampleRay * 0.5;\nvec3 v3FrontColor = vec3(0.0);\nvec3 v3Attenuate = vec3(0.0);\nfor(int i=0; i<nSamples; i++)\n{\nfloat fHeight = length(v3SamplePoint);\nfloat fDepth = exp(fScaleOverScaleDepth * (fInnerRadius - fHeight));\nfloat fScatter = fDepth*fTemp - fCameraOffset;\nv3Attenuate = exp(-fScatter * (v3InvWavelength * fKr4PI + fKm4PI));\nv3FrontColor += v3Attenuate * (fDepth * fScaledLength);\nv3SamplePoint += v3SampleRay;\n}\nAtmosphereColor color;\ncolor.mie = v3FrontColor * (v3InvWavelength * fKrESun + fKmESun);\ncolor.rayleigh = v3Attenuate;\nreturn color;\n}\n"});define("Scene/GlobeSurfaceShaderSet",["../Core/defined","../Core/destroyObject","../Core/TerrainQuantization","../Renderer/ShaderProgram","../Scene/SceneMode"],function(e,t,r,i,n){"use strict";function a(e,t,r){this.numberOfDayTextures=e;this.flags=t;this.shaderProgram=r}function o(){this.baseVertexShaderSource=undefined;this.baseFragmentShaderSource=undefined;this._shadersByTexturesFlags=[];this._pickShaderPrograms=[]}function s(e){var t="vec4 getPosition(vec3 position, float height, vec2 textureCoordinates) { return getPosition3DMode(position, height, textureCoordinates); }";var r="vec4 getPosition(vec3 position, float height, vec2 textureCoordinates) { return getPositionColumbusViewMode(position, height, textureCoordinates); }";var i="vec4 getPosition(vec3 position, float height, vec2 textureCoordinates) { return getPositionMorphingMode(position, height, textureCoordinates); }";var a;switch(e){case n.SCENE3D:a=t;break;case n.SCENE2D:case n.COLUMBUS_VIEW:a=r;break;case n.MORPHING:a=i;break}return a}function u(e){var t="float get2DYPositionFraction(vec2 textureCoordinates) { return get2DGeographicYPositionFraction(textureCoordinates); }";var r="float get2DYPositionFraction(vec2 textureCoordinates) { return get2DMercatorYPositionFraction(textureCoordinates); }";return e?r:t}o.prototype.getShaderProgram=function(t,n,o,l,c,d,f,h,p,m,v,_,g,y,w,C){var b=0;var S="";var E=n.pickTerrain.mesh.encoding;var T=E.quantization;if(T===r.BITS12){b=1;S="QUANTIZATION_BITS12"}var x=t.mode;var A=x|l<<2|c<<3|d<<4|f<<5|h<<6|p<<7|v<<8|_<<9|g<<10|y<<11|w<<12|C<<13|b<<14|m<<15;var P=n.surfaceShader;if(e(P)&&P.numberOfDayTextures===o&&P.flags===A){return P.shaderProgram}var D=this._shadersByTexturesFlags[o];if(!e(D)){D=this._shadersByTexturesFlags[o]=[]}P=D[A];if(!e(P)){var M=this.baseVertexShaderSource.clone();var I=this.baseFragmentShaderSource.clone();M.defines.push(S);I.defines.push("TEXTURE_UNITS "+o);if(l){I.defines.push("APPLY_BRIGHTNESS")}if(c){I.defines.push("APPLY_CONTRAST")}if(d){I.defines.push("APPLY_HUE")}if(f){I.defines.push("APPLY_SATURATION")}if(h){I.defines.push("APPLY_GAMMA")}if(p){I.defines.push("APPLY_ALPHA")}if(v){I.defines.push("SHOW_REFLECTIVE_OCEAN");M.defines.push("SHOW_REFLECTIVE_OCEAN")}if(_){I.defines.push("SHOW_OCEAN_WAVES")}if(g){if(y){M.defines.push("ENABLE_VERTEX_LIGHTING");I.defines.push("ENABLE_VERTEX_LIGHTING")}else{M.defines.push("ENABLE_DAYNIGHT_SHADING");I.defines.push("ENABLE_DAYNIGHT_SHADING")}}M.defines.push("INCLUDE_WEB_MERCATOR_Y");I.defines.push("INCLUDE_WEB_MERCATOR_Y");if(C){M.defines.push("FOG");I.defines.push("FOG")}if(m){I.defines.push("APPLY_SPLIT")}var O="    vec4 computeDayColor(vec4 initialColor, vec3 textureCoordinates)\n    {\n        vec4 color = initialColor;\n";for(var R=0;R<o;++R){O+="    color = sampleAndBlend(\n        color,\n        u_dayTextures["+R+"],\n        u_dayTextureUseWebMercatorT["+R+"] ? textureCoordinates.xz : textureCoordinates.xy,\n        u_dayTextureTexCoordsRectangle["+R+"],\n        u_dayTextureTranslationAndScale["+R+"],\n        "+(p?"u_dayTextureAlpha["+R+"]":"1.0")+",\n        "+(l?"u_dayTextureBrightness["+R+"]":"0.0")+",\n        "+(c?"u_dayTextureContrast["+R+"]":"0.0")+",\n        "+(d?"u_dayTextureHue["+R+"]":"0.0")+",\n        "+(f?"u_dayTextureSaturation["+R+"]":"0.0")+",\n        "+(h?"u_dayTextureOneOverGamma["+R+"]":"0.0")+",\n        "+(m?"u_dayTextureSplit["+R+"]":"0.0")+"\n    );\n"}O+="        return color;\n    }";I.sources.push(O);M.sources.push(s(x));M.sources.push(u(w));var N=i.fromCache({context:t.context,vertexShaderSource:M,fragmentShaderSource:I,attributeLocations:E.getAttributeLocations()});P=D[A]=new a(o,A,N)}n.surfaceShader=P;return P.shaderProgram};o.prototype.getPickShaderProgram=function(t,n,a){var o=0;var l="";var c=n.pickTerrain.mesh.encoding;var d=c.quantization;if(d===r.BITS12){o=1;l="QUANTIZATION_BITS12"}var f=t.mode;var h=f|a<<2|o<<3;var p=this._pickShaderPrograms[h];if(!e(p)){var m=this.baseVertexShaderSource.clone();m.defines.push(l);m.sources.push(s(f));m.sources.push(u(a));var v="void main()\n"+"{\n"+"    gl_FragColor = vec4(1.0, 1.0, 0.0, 1.0);\n"+"}\n";p=this._pickShaderPrograms[h]=i.fromCache({context:t.context,vertexShaderSource:m,fragmentShaderSource:v,attributeLocations:c.getAttributeLocations()})}return p};o.prototype.destroy=function(){var r;var i;var n=this._shadersByTexturesFlags;for(var a in n){if(n.hasOwnProperty(a)){var o=n[a];if(!e(o)){continue}for(r in o){if(o.hasOwnProperty(r)){i=o[r];if(e(i)){i.shaderProgram.destroy()}}}}}var s=this._pickShaderPrograms;for(r in s){if(s.hasOwnProperty(r)){i=s[r];i.destroy()}}return t(this)};return o});define("Scene/ImageryState",["../Core/freezeObject"],function(e){"use strict";var t={UNLOADED:0,TRANSITIONING:1,RECEIVED:2,TEXTURE_LOADED:3,READY:4,FAILED:5,INVALID:6,PLACEHOLDER:7};return e(t)});define("Scene/QuadtreeTileLoadState",["../Core/freezeObject"],function(e){"use strict";var t={START:0,LOADING:1,DONE:2,FAILED:3};return e(t)});define("Scene/TerrainState",["../Core/freezeObject"],function(e){"use strict";var t={FAILED:0,UNLOADED:1,RECEIVING:2,RECEIVED:3,TRANSFORMING:4,TRANSFORMED:5,READY:6};return e(t)});define("Scene/TileTerrain",["../Core/BoundingSphere","../Core/Cartesian3","../Core/defined","../Core/DeveloperError","../Core/IndexDatatype","../Core/OrientedBoundingBox","../Core/Request","../Core/TileProviderError","../Renderer/Buffer","../Renderer/BufferUsage","../Renderer/VertexArray","../ThirdParty/when","./TerrainState","./TileBoundingRegion"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h){"use strict";function p(e){this.state=f.UNLOADED;this.data=undefined;this.mesh=undefined;this.vertexArray=undefined;this.upsampleDetails=e}p.prototype.freeResources=function(){this.state=f.UNLOADED;this.data=undefined;this.mesh=undefined;if(r(this.vertexArray)){var e=this.vertexArray.indexBuffer;this.vertexArray.destroy();this.vertexArray=undefined;if(!e.isDestroyed()&&r(e.referenceCount)){--e.referenceCount;if(e.referenceCount===0){e.destroy()}}}};p.prototype.publishToTile=function(r){var i=r.data;var n=this.mesh;t.clone(n.center,i.center);i.minimumHeight=n.minimumHeight;i.maximumHeight=n.maximumHeight;i.boundingSphere3D=e.clone(n.boundingSphere3D,i.boundingSphere3D);i.orientedBoundingBox=a.clone(n.orientedBoundingBox,i.orientedBoundingBox);i.tileBoundingRegion.minimumHeight=n.minimumHeight;i.tileBoundingRegion.maximumHeight=n.maximumHeight;r.data.occludeePointInScaledSpace=t.clone(n.occludeePointInScaledSpace,i.occludeePointInScaledSpace)};p.prototype.processLoadStateMachine=function(e,t,r,i,n,a){if(this.state===f.UNLOADED){m(this,t,r,i,n,a)}if(this.state===f.RECEIVED){v(this,e,t,r,i,n)}if(this.state===f.TRANSFORMED){_(this,e.context,t,r,i,n)}};function m(e,t,i,n,a,u){function l(t){e.data=t;e.state=f.RECEIVED}function c(){e.state=f.FAILED;var r="Failed to obtain terrain tile X: "+i+" Y: "+n+" Level: "+a+".";t._requestError=s.handleError(t._requestError,t,t.errorEvent,r,i,n,a,h)}function h(){var s=new o({distance:u});e.data=t.requestTileGeometry(i,n,a,s);if(r(e.data)){e.state=f.RECEIVING;d(e.data,l,c)}else{e.state=f.UNLOADED}}h()}p.prototype.processUpsampleStateMachine=function(e,t,n,a,o){if(this.state===f.UNLOADED){var s=this.upsampleDetails;if(!r(s)){throw new i("TileTerrain cannot upsample unless provided upsampleDetails.")}var u=s.data;var l=s.x;var c=s.y;var h=s.level;this.data=u.upsample(t.tilingScheme,l,c,h,n,a,o);if(!r(this.data)){return}this.state=f.RECEIVING;var p=this;d(this.data,function(e){p.data=e;p.state=f.RECEIVED},function(){p.state=f.FAILED})}if(this.state===f.RECEIVED){v(this,e,t,n,a,o)}if(this.state===f.TRANSFORMED){_(this,e.context,t,n,a,o)}};function v(e,t,i,n,a,o){var s=i.tilingScheme;var u=e.data;var l=u.createMesh(s,n,a,o,t.terrainExaggeration);if(!r(l)){return}e.state=f.TRANSFORMING;d(l,function(t){e.mesh=t;e.state=f.TRANSFORMED},function(){e.state=f.FAILED})}function _(e,t,i,a,o,s){var d=e.mesh.vertices;var h=u.createVertexBuffer({context:t,typedArray:d,usage:l.STATIC_DRAW});var p=e.mesh.encoding.getAttributes(h);var m=e.mesh.indices.indexBuffers||{};var v=m[t.id];if(!r(v)||v.isDestroyed()){var _=e.mesh.indices;var g=_.BYTES_PER_ELEMENT===2?n.UNSIGNED_SHORT:n.UNSIGNED_INT;v=u.createIndexBuffer({context:t,typedArray:_,usage:l.STATIC_DRAW,indexDatatype:g});v.vertexArrayDestroyable=false;v.referenceCount=1;m[t.id]=v;e.mesh.indices.indexBuffers=m}else{++v.referenceCount}e.vertexArray=new c({context:t,attributes:p,indexBuffer:v});e.state=f.READY}return p});define("Scene/GlobeSurfaceTile",["../Core/BoundingSphere","../Core/Cartesian3","../Core/Cartesian4","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/IntersectionTests","../Core/PixelFormat","../Renderer/PixelDatatype","../Renderer/Sampler","../Renderer/Texture","../Renderer/TextureMagnificationFilter","../Renderer/TextureMinificationFilter","../Renderer/TextureWrap","./ImageryState","./QuadtreeTileLoadState","./SceneMode","./TerrainState","./TileBoundingRegion","./TileTerrain"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y){"use strict";function w(){this.imagery=[];this.waterMaskTexture=undefined;this.waterMaskTranslationAndScale=new r(0,0,1,1);this.terrainData=undefined;this.center=new t;this.vertexArray=undefined;this.minimumHeight=0;this.maximumHeight=0;this.boundingSphere3D=new e;this.boundingSphere2D=new e;this.orientedBoundingBox=undefined;this.tileBoundingRegion=undefined;this.occludeePointInScaledSpace=new t;this.loadedTerrain=undefined;this.upsampledTerrain=undefined;this.pickBoundingSphere=new e;this.pickTerrain=undefined;this.surfaceShader=undefined}a(w.prototype,{eligibleForUnloading:{get:function(){var e=this.loadedTerrain;var t=n(e)&&(e.state===_.RECEIVING||e.state===_.TRANSFORMING);var r=this.upsampledTerrain;var i=n(r)&&(r.state===_.RECEIVING||r.state===_.TRANSFORMING);var a=!t&&!i;var o=this.imagery;for(var s=0,u=o.length;a&&s<u;++s){var l=o[s];a=!n(l.loadingImagery)||l.loadingImagery.state!==p.TRANSITIONING}return a}}});function C(e,r,i,a,o,s){e.decodePosition(a,o,s);if(n(r)&&r!==v.SCENE3D){var u=i.ellipsoid;var l=u.cartesianToCartographic(s);i.project(l,s);t.fromElements(s.z,s.x,s.y,s)}return s}var b=new t;var S=new t;var E=new t;var T=new t;w.prototype.pick=function(e,r,i,a,s){var u=this.pickTerrain;if(!n(u)){return undefined}var l=u.mesh;if(!n(l)){return undefined}var c=l.vertices;var d=l.indices;var f=l.encoding;var h=d.length;for(var p=0;p<h;p+=3){var m=d[p];var v=d[p+1];var _=d[p+2];var g=C(f,r,i,c,m,b);var y=C(f,r,i,c,v,S);var w=C(f,r,i,c,_,E);var x=o.rayTriangle(e,g,y,w,a,T);if(n(x)){return t.clone(x,s)}}return undefined};w.prototype.freeResources=function(){if(n(this.waterMaskTexture)){--this.waterMaskTexture.referenceCount;if(this.waterMaskTexture.referenceCount===0){this.waterMaskTexture.destroy()}this.waterMaskTexture=undefined}this.terrainData=undefined;if(n(this.loadedTerrain)){this.loadedTerrain.freeResources();this.loadedTerrain=undefined}if(n(this.upsampledTerrain)){this.upsampledTerrain.freeResources();this.upsampledTerrain=undefined}if(n(this.pickTerrain)){this.pickTerrain.freeResources();this.pickTerrain=undefined}var e,t;var r=this.imagery;for(e=0,t=r.length;e<t;++e){r[e].freeResources()}this.imagery.length=0;this.freeVertexArray()};w.prototype.freeVertexArray=function(){var e;if(n(this.vertexArray)){e=this.vertexArray.indexBuffer;this.vertexArray=this.vertexArray.destroy();if(!e.isDestroyed()&&n(e.referenceCount)){--e.referenceCount;if(e.referenceCount===0){e.destroy()}}}if(n(this.wireframeVertexArray)){e=this.wireframeVertexArray.indexBuffer;this.wireframeVertexArray=this.wireframeVertexArray.destroy();if(!e.isDestroyed()&&n(e.referenceCount)){--e.referenceCount;if(e.referenceCount===0){e.destroy()}}}};function x(e){var t;var r;if(n(e.parent)&&n(e.parent.data)){t=e.parent.data.minimumHeight;r=e.parent.data.maximumHeight}return new g({rectangle:e.rectangle,ellipsoid:e.tilingScheme.ellipsoid,minimumHeight:t,maximumHeight:r})}w.processStateMachine=function(e,t,r,i,a){var o=e.data;if(!n(o)){o=e.data=new w;o.tileBoundingRegion=x(e,t);e._distance=o.tileBoundingRegion.distanceToCamera(t)}if(e.state===m.START){A(e,r,i);e.state=m.LOADING}if(e.state===m.LOADING){P(e,t,r,a)}var s=n(o.vertexArray);var u=!n(o.loadedTerrain)&&!n(o.upsampledTerrain);var l=n(o.terrainData)&&o.terrainData.wasCreatedByUpsampling();var c=o.imagery;for(var d=0,f=c.length;d<f;++d){var h=c[d];if(!n(h.loadingImagery)){l=false;continue}if(h.loadingImagery.state===p.PLACEHOLDER){var v=h.loadingImagery.imageryLayer;if(v.imageryProvider.ready){h.freeResources();c.splice(d,1);v._createTileImagerySkeletons(e,r,d);--d;f=c.length;continue}else{l=false}}var _=h.processStateMachine(e,t);u=u&&_;s=s&&(_||n(h.readyImagery));l=l&&n(h.loadingImagery)&&(h.loadingImagery.state===p.FAILED||h.loadingImagery.state===p.INVALID)}e.upsampledFromParent=l;if(d===f){if(s){e.renderable=true}if(u){e.state=m.DONE}}};function A(e,t,r){var i=e.data;var a=D(e);if(n(a)){i.upsampledTerrain=new y(a)}if(N(e,t)){i.loadedTerrain=new y}for(var o=0,s=r.length;o<s;++o){var u=r.get(o);if(u.show){u._createTileImagerySkeletons(e,t)}}}function P(e,t,r,a){var o=e.data;var s=o.loadedTerrain;var u=o.upsampledTerrain;var l=false;if(n(s)){s.processLoadStateMachine(t,r,e.x,e.y,e.level,e._distance);if(s.state>=_.RECEIVED){if(o.terrainData!==s.data){o.terrainData=s.data;B(t.context,o);O(e)}l=true}if(s.state===_.READY){s.publishToTile(e);if(n(e.data.vertexArray)){a.push(e.data.vertexArray)}e.data.vertexArray=s.vertexArray;s.vertexArray=undefined;o.pickTerrain=i(o.loadedTerrain,o.upsampledTerrain);o.loadedTerrain=undefined;o.upsampledTerrain=undefined}else if(s.state===_.FAILED){o.loadedTerrain=undefined}}if(!l&&n(u)){u.processUpsampleStateMachine(t,r,e.x,e.y,e.level);if(u.state>=_.RECEIVED){if(o.terrainData!==u.data){o.terrainData=u.data;if(r.hasWaterMask){F(e)}M(e)}}if(u.state===_.READY){u.publishToTile(e);if(n(e.data.vertexArray)){a.push(e.data.vertexArray)}e.data.vertexArray=u.vertexArray;u.vertexArray=undefined;o.pickTerrain=o.upsampledTerrain;o.upsampledTerrain=undefined}else if(u.state===_.FAILED){o.upsampledTerrain=undefined}}}function D(e){var t=e.parent;while(n(t)&&n(t.data)&&!n(t.data.terrainData)){t=t.parent}if(!n(t)||!n(t.data)){return undefined}return{data:t.data.terrainData,x:t.x,y:t.y,level:t.level}}function M(e){I(e,e._southwestChild);I(e,e._southeastChild);I(e,e._northwestChild);I(e,e._northeastChild)}function I(e,t){if(n(t)&&t.state!==m.START){var r=t.data;if(n(r.terrainData)&&!r.terrainData.wasCreatedByUpsampling()){return}if(n(r.upsampledTerrain)){r.upsampledTerrain.freeResources()}r.upsampledTerrain=new y({data:e.data.terrainData,x:e.x,y:e.y,level:e.level});t.state=m.LOADING}}function O(e){var t=e.data;R(e,t,e.southwestChild);R(e,t,e.southeastChild);R(e,t,e.northwestChild);R(e,t,e.northeastChild)}function R(e,t,r){if(r.state!==m.START){var i=r.data;if(n(i.terrainData)&&!i.terrainData.wasCreatedByUpsampling()){return}if(n(i.upsampledTerrain)){i.upsampledTerrain.freeResources()}i.upsampledTerrain=new y({data:t.terrainData,x:e.x,y:e.y,level:e.level});if(t.terrainData.isChildAvailable(e.x,e.y,r.x,r.y)){if(!n(i.loadedTerrain)){i.loadedTerrain=new y}}r.state=m.LOADING}}function N(e,t){var r=t.getTileDataAvailable(e.x,e.y,e.level);if(n(r)){return r}var i=e.parent;if(!n(i)){return true}if(!n(i.data)||!n(i.data.terrainData)){return false}return i.data.terrainData.isChildAvailable(i.x,i.y,e.x,e.y)}function L(e){var t=e.cache.tile_waterMaskData;if(!n(t)){var r=new c({context:e,pixelFormat:s.LUMINANCE,pixelDatatype:u.UNSIGNED_BYTE,source:{arrayBufferView:new Uint8Array([255]),width:1,height:1}});r.referenceCount=1;var i=new l({wrapS:h.CLAMP_TO_EDGE,wrapT:h.CLAMP_TO_EDGE,minificationFilter:f.LINEAR,magnificationFilter:d.LINEAR});t={allWaterTexture:r,sampler:i,destroy:function(){this.allWaterTexture.destroy()}};e.cache.tile_waterMaskData=t}return t}function B(e,t){var i=t.waterMaskTexture;if(n(i)){--i.referenceCount;if(i.referenceCount===0){i.destroy()}t.waterMaskTexture=undefined}var a=t.terrainData.waterMask;if(!n(a)){return}var o=L(e);var l;var d=a.length;if(d===1){if(a[0]!==0){l=o.allWaterTexture}else{return}}else{var f=Math.sqrt(d);l=new c({context:e,pixelFormat:s.LUMINANCE,pixelDatatype:u.UNSIGNED_BYTE,source:{width:f,height:f,arrayBufferView:a},sampler:o.sampler});l.referenceCount=0}++l.referenceCount;t.waterMaskTexture=l;r.fromElements(0,0,1,1,t.waterMaskTranslationAndScale)}function F(e){var t=e.data;var r=e.parent;while(n(r)&&!n(r.data.terrainData)||r.data.terrainData.wasCreatedByUpsampling()){r=r.parent}if(!n(r)||!n(r.data.waterMaskTexture)){return}t.waterMaskTexture=r.data.waterMaskTexture;++t.waterMaskTexture.referenceCount;var i=r.rectangle;var a=e.rectangle;var o=a.width;var s=a.height;var u=o/i.width;var l=s/i.height;t.waterMaskTranslationAndScale.x=u*(a.west-i.west)/o;t.waterMaskTranslationAndScale.y=l*(a.south-i.south)/s;t.waterMaskTranslationAndScale.z=u;t.waterMaskTranslationAndScale.w=l}return w});define("Shaders/ReprojectWebMercatorFS",[],function(){"use strict";return"uniform sampler2D u_texture;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\ngl_FragColor = texture2D(u_texture, v_textureCoordinates);\n}\n"});define("Shaders/ReprojectWebMercatorVS",[],function(){"use strict";return"attribute vec4 position;\nattribute float webMercatorT;\nuniform vec2 u_textureDimensions;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\nv_textureCoordinates = vec2(position.x, webMercatorT);\ngl_Position = czm_viewportOrthographic * (position * vec4(u_textureDimensions, 1.0, 1.0));\n}\n"});define("Scene/Imagery",["../Core/defined","../Core/destroyObject","./ImageryState"],function(e,t,r){"use strict";function i(t,i,n,a,o){this.imageryLayer=t;this.x=i;this.y=n;this.level=a;if(a!==0){var s=i/2|0;var u=n/2|0;var l=a-1;this.parent=t.getImageryFromCache(s,u,l)}this.state=r.UNLOADED;this.imageUrl=undefined;this.image=undefined;this.texture=undefined;this.textureWebMercator=undefined;this.credits=undefined;this.referenceCount=0;if(!e(o)&&t.imageryProvider.ready){var c=t.imageryProvider.tilingScheme;o=c.tileXYToRectangle(i,n,a)}this.rectangle=o}i.createPlaceholder=function(e){var t=new i(e,0,0,0);t.addReference();t.state=r.PLACEHOLDER;return t};i.prototype.addReference=function(){++this.referenceCount};i.prototype.releaseReference=function(){--this.referenceCount;if(this.referenceCount===0){this.imageryLayer.removeImageryFromCache(this);if(e(this.parent)){this.parent.releaseReference()}if(e(this.image)&&e(this.image.destroy)){this.image.destroy()}if(e(this.texture)){this.texture.destroy()}if(e(this.textureWebMercator)&&this.texture!==this.textureWebMercator){this.textureWebMercator.destroy()}t(this);return 0}return this.referenceCount};i.prototype.processStateMachine=function(e,t,i){if(this.state===r.UNLOADED){this.state=r.TRANSITIONING;this.imageryLayer._requestImagery(this,i)}if(this.state===r.RECEIVED){this.state=r.TRANSITIONING;this.imageryLayer._createTexture(e.context,this)}var n=this.state===r.READY&&t&&!this.texture;if(this.state===r.TEXTURE_LOADED||n){this.state=r.TRANSITIONING;this.imageryLayer._reprojectTexture(e,this,t)}};return i});define("Scene/ImagerySplitDirection",["../Core/freezeObject"],function(e){"use strict";var t={LEFT:-1,NONE:0,RIGHT:1};return e(t)});define("Scene/TileImagery",["../Core/defined","./ImageryState"],function(e,t){"use strict";function r(e,t,r){this.readyImagery=undefined;this.loadingImagery=e;this.textureCoordinateRectangle=t;this.textureTranslationAndScale=undefined;this.useWebMercatorT=r}r.prototype.freeResources=function(){if(e(this.readyImagery)){this.readyImagery.releaseReference()}if(e(this.loadingImagery)){this.loadingImagery.releaseReference()}};r.prototype.processStateMachine=function(r,i){var n=this.loadingImagery;var a=n.imageryLayer;n.processStateMachine(i,!this.useWebMercatorT,r._distance);if(n.state===t.READY){if(e(this.readyImagery)){this.readyImagery.releaseReference()}this.readyImagery=this.loadingImagery;this.loadingImagery=undefined;this.textureTranslationAndScale=a._calculateTextureTranslationAndScale(r,this);return true}var o=n.parent;var s;while(e(o)&&(o.state!==t.READY||!this.useWebMercatorT&&!e(o.texture))){if(o.state!==t.FAILED&&o.state!==t.INVALID){s=s||o}o=o.parent}if(this.readyImagery!==o){if(e(this.readyImagery)){this.readyImagery.releaseReference()}this.readyImagery=o;if(e(o)){o.addReference();this.textureTranslationAndScale=a._calculateTextureTranslationAndScale(r,this)}}if(n.state===t.FAILED||n.state===t.INVALID){if(e(s)){s.processStateMachine(i,!this.useWebMercatorT,r._distance);return false}else{return true}}return false};return r});define("Scene/ImageryLayer",["../Core/Cartesian2","../Core/Cartesian4","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/FeatureDetection","../Core/GeographicTilingScheme","../Core/IndexDatatype","../Core/Math","../Core/PixelFormat","../Core/Rectangle","../Core/TerrainProvider","../Core/TileProviderError","../Core/WebMercatorProjection","../Core/WebMercatorTilingScheme","../Renderer/Buffer","../Renderer/BufferUsage","../Renderer/ComputeCommand","../Renderer/ContextLimits","../Renderer/MipmapHint","../Renderer/Sampler","../Renderer/ShaderProgram","../Renderer/ShaderSource","../Renderer/Texture","../Renderer/TextureMagnificationFilter","../Renderer/TextureMinificationFilter","../Renderer/TextureWrap","../Renderer/VertexArray","../Shaders/ReprojectWebMercatorFS","../Shaders/ReprojectWebMercatorVS","../ThirdParty/when","./Imagery","./ImagerySplitDirection","./ImageryState","./TileImagery"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w,C,b,S,E,T,x,A,P,D,M,I,O,R,N,L){"use strict";function B(e,t){this._imageryProvider=e;t=r(t,{});this.alpha=r(t.alpha,r(e.defaultAlpha,1));this.brightness=r(t.brightness,r(e.defaultBrightness,B.DEFAULT_BRIGHTNESS));this.contrast=r(t.contrast,r(e.defaultContrast,B.DEFAULT_CONTRAST));this.hue=r(t.hue,r(e.defaultHue,B.DEFAULT_HUE));this.saturation=r(t.saturation,r(e.defaultSaturation,B.DEFAULT_SATURATION));this.gamma=r(t.gamma,r(e.defaultGamma,B.DEFAULT_GAMMA));this.splitDirection=r(t.splitDirection,r(e.defaultSplit,B.DEFAULT_SPLIT));this.show=r(t.show,true);this._minimumTerrainLevel=t.minimumTerrainLevel;this._maximumTerrainLevel=t.maximumTerrainLevel;this._rectangle=r(t.rectangle,d.MAX_VALUE);this._maximumAnisotropy=t.maximumAnisotropy;this._imageryCache={};this._skeletonPlaceholder=new L(O.createPlaceholder(this));this._show=true;this._layerIndex=-1;this._isBaseLayer=false;this._requestImageError=undefined;this._reprojectComputeCommands=[]}n(B.prototype,{imageryProvider:{get:function(){return this._imageryProvider}},rectangle:{get:function(){return this._rectangle}}});B.DEFAULT_BRIGHTNESS=1;B.DEFAULT_CONTRAST=1;B.DEFAULT_HUE=0;B.DEFAULT_SATURATION=1;B.DEFAULT_GAMMA=1;B.DEFAULT_SPLIT=R.NONE;B.prototype.isBaseLayer=function(){return this._isBaseLayer};B.prototype.isDestroyed=function(){return false};B.prototype.destroy=function(){return a(this)};var F=new d;var k=new d;var V=new d;var z=new d;B.prototype.getViewableRectangle=function(){var e=this._imageryProvider;var t=this._rectangle;return e.readyPromise.then(function(){return d.intersection(e.rectangle,t)})};B.prototype._createTileImagerySkeletons=function(e,r,n){var a=e.data;if(i(this._minimumTerrainLevel)&&e.level<this._minimumTerrainLevel){return false}if(i(this._maximumTerrainLevel)&&e.level>this._maximumTerrainLevel){return false}var o=this._imageryProvider;if(!i(n)){n=a.imagery.length}if(!o.ready){this._skeletonPlaceholder.loadingImagery.addReference();a.imagery.splice(n,0,this._skeletonPlaceholder);return true}var s=o.tilingScheme instanceof m&&e.rectangle.north<p.MaximumLatitude&&e.rectangle.south>-p.MaximumLatitude;var u=d.intersection(o.rectangle,this._rectangle,F);var l=d.intersection(e.rectangle,u,k);if(!i(l)){if(!this.isBaseLayer()){return false}var c=u;var f=e.rectangle;l=k;if(f.south>=c.north){l.north=l.south=c.north}else if(f.north<=c.south){l.north=l.south=c.south}else{l.south=Math.max(f.south,c.south);l.north=Math.min(f.north,c.north)}if(f.west>=c.east){l.west=l.east=c.east}else if(f.east<=c.west){l.west=l.east=c.west}else{l.west=Math.max(f.west,c.west);l.east=Math.min(f.east,c.east)}}var h=0;if(l.south>0){h=l.south}else if(l.north<0){h=l.north}var v=1;var _=v*r.getLevelMaximumGeometricError(e.level);var g=j(this,_,h);g=Math.max(0,g);var y=o.maximumLevel;if(g>y){g=y}if(i(o.minimumLevel)){var w=o.minimumLevel;if(g<w){g=w}}var C=o.tilingScheme;var b=C.positionToTileXY(d.northwest(l),g);var S=C.positionToTileXY(d.southeast(l),g);var E=e.rectangle.width/512;var T=e.rectangle.height/512;var x=C.tileXYToRectangle(b.x,b.y,g);if(Math.abs(x.south-e.rectangle.north)<T&&b.y<S.y){++b.y}if(Math.abs(x.east-e.rectangle.west)<E&&b.x<S.x){++b.x}var A=C.tileXYToRectangle(S.x,S.y,g);if(Math.abs(A.north-e.rectangle.south)<T&&S.y>b.y){--S.y}if(Math.abs(A.west-e.rectangle.east)<E&&S.x>b.x){--S.x}var P=d.clone(e.rectangle,z);var D=C.tileXYToRectangle(b.x,b.y,g);var M=d.intersection(D,u,V);var I;if(s){C.rectangleToNativeRectangle(P,P);C.rectangleToNativeRectangle(D,D);C.rectangleToNativeRectangle(M,M);C.rectangleToNativeRectangle(u,u);I=C.tileXYToNativeRectangle.bind(C);E=P.width/512;T=P.height/512}else{I=C.tileXYToRectangle.bind(C)}var O;var R=0;var N=1;var B;if(!this.isBaseLayer()&&Math.abs(M.west-P.west)>=E){R=Math.min(1,(M.west-P.west)/P.width)}if(!this.isBaseLayer()&&Math.abs(M.north-P.north)>=T){N=Math.max(0,(M.north-P.south)/P.height)}var U=N;for(var q=b.x;q<=S.x;q++){O=R;D=I(q,b.y,g);M=d.simpleIntersection(D,u,V);if(!i(M)){continue}R=Math.min(1,(M.east-P.west)/P.width);if(q===S.x&&(this.isBaseLayer()||Math.abs(M.east-P.east)<E)){R=1}N=U;for(var G=b.y;G<=S.y;G++){B=N;D=I(q,G,g);M=d.simpleIntersection(D,u,V);if(!i(M)){continue}N=Math.max(0,(M.south-P.south)/P.height);if(G===S.y&&(this.isBaseLayer()||Math.abs(M.south-P.south)<T)){N=0}var H=new t(O,N,R,B);var W=this.getImageryFromCache(q,G,g);a.imagery.splice(n,0,new L(W,H,s));++n}}return true};B.prototype._calculateTextureTranslationAndScale=function(e,r){var i=r.readyImagery.rectangle;var n=e.rectangle;if(r.useWebMercatorT){var a=r.readyImagery.imageryLayer.imageryProvider.tilingScheme;i=a.rectangleToNativeRectangle(i,F);n=a.rectangleToNativeRectangle(n,z)}var o=n.width;var s=n.height;var u=o/i.width;var l=s/i.height;return new t(u*(n.west-i.west)/o,l*(n.south-i.south)/s,u,l)};B.prototype._requestImagery=function(e,t){var r=this._imageryProvider;var n=this;function a(t){if(!i(t)){return o()}e.image=t;e.state=N.RECEIVED;h.handleSuccess(n._requestImageError)}function o(t){e.state=N.FAILED;var i="Failed to obtain image tile X: "+e.x+" Y: "+e.y+" Level: "+e.level+".";n._requestImageError=h.handleError(n._requestImageError,r,r.errorEvent,i,e.x,e.y,e.level,s,t)}function s(){e.state=N.TRANSITIONING;var n=r.requestImage(e.x,e.y,e.level,t);if(!i(n)){e.state=N.UNLOADED;return}if(i(r.getTileCredits)){e.credits=r.getTileCredits(e.x,e.y,e.level)}I(n,a,o)}s()};B.prototype._createTexture=function(e,t){var r=this._imageryProvider;var n=t.image;if(i(r.tileDiscardPolicy)){var a=r.tileDiscardPolicy;if(i(a)){if(!a.isReady()){t.state=N.RECEIVED;return}if(a.shouldDiscardImage(n)){t.state=N.INVALID;return}}}var o;if(i(n.internalFormat)){o=new E({context:e,pixelFormat:n.internalFormat,width:n.width,height:n.height,source:{arrayBufferView:n.bufferView}})}else{o=new E({context:e,source:n,pixelFormat:r.hasAlphaChannel?c.RGBA:c.RGB})}if(r.tilingScheme instanceof m){t.textureWebMercator=o}else{t.texture=o}t.image=undefined;t.state=N.TEXTURE_LOADED};function U(e,t,n,a){if(!c.isCompressedFormat(a.pixelFormat)&&l.isPowerOfTwo(a.width)&&l.isPowerOfTwo(a.height)){var o=t.cache.imageryLayer_mipmapSampler;if(!i(o)){var s=y.maximumTextureFilterAnisotropy;o=t.cache.imageryLayer_mipmapSampler=new C({wrapS:A.CLAMP_TO_EDGE,wrapT:A.CLAMP_TO_EDGE,minificationFilter:x.LINEAR_MIPMAP_LINEAR,magnificationFilter:T.LINEAR,maximumAnisotropy:Math.min(s,r(e._maximumAnisotropy,s))})}a.generateMipmap(w.NICEST);a.sampler=o}else{var u=t.cache.imageryLayer_nonMipmapSampler;if(!i(u)){u=t.cache.imageryLayer_nonMipmapSampler=new C({wrapS:A.CLAMP_TO_EDGE,wrapT:A.CLAMP_TO_EDGE,minificationFilter:x.LINEAR,magnificationFilter:T.LINEAR})}a.sampler=u}n.state=N.READY}B.prototype._reprojectTexture=function(e,t,i){var n=t.textureWebMercator||t.texture;var a=t.rectangle;var o=e.context;i=r(i,true);if(i&&!(this._imageryProvider.tilingScheme instanceof s)&&a.width/n.width>1e-5){var u=this;t.addReference();var l=new g({persists:true,owner:this,preExecute:function(e){W(e,o,n,t.rectangle)},postExecute:function(e){t.texture=e;U(u,o,t,e);t.releaseReference()}});this._reprojectComputeCommands.push(l)}else{if(i){t.texture=n}U(this,o,t,n)}};B.prototype.queueReprojectionCommands=function(e){var t=this._reprojectComputeCommands;var r=t.length;for(var i=0;i<r;++i){e.commandList.push(t[i])}t.length=0};B.prototype.cancelReprojections=function(){this._reprojectComputeCommands.length=0};B.prototype.getImageryFromCache=function(e,t,r,n){var a=q(e,t,r);var o=this._imageryCache[a];if(!i(o)){o=new O(this,e,t,r,n);this._imageryCache[a]=o}o.addReference();return o};B.prototype.removeImageryFromCache=function(e){var t=q(e.x,e.y,e.level);delete this._imageryCache[t]};function q(e,t,r){return JSON.stringify([e,t,r])}var G={u_textureDimensions:function(){return this.textureDimensions},u_texture:function(){return this.texture},textureDimensions:new e,texture:undefined};var H=o.supportsTypedArrays()?new Float32Array(2*64):undefined;function W(e,t,r,n){
var a=t.cache.imageryLayer_reproject;if(!i(a)){a=t.cache.imageryLayer_reproject={vertexArray:undefined,shaderProgram:undefined,sampler:undefined,destroy:function(){if(i(this.framebuffer)){this.framebuffer.destroy()}if(i(this.vertexArray)){this.vertexArray.destroy()}if(i(this.shaderProgram)){this.shaderProgram.destroy()}}};var o=new Float32Array(2*64*2);var s=0;for(var c=0;c<64;++c){var d=c/63;o[s++]=0;o[s++]=d;o[s++]=1;o[s++]=d}var h={position:0,webMercatorT:1};var p=f.getRegularGridIndices(2,64);var m=v.createIndexBuffer({context:t,typedArray:p,usage:_.STATIC_DRAW,indexDatatype:u.UNSIGNED_SHORT});a.vertexArray=new P({context:t,attributes:[{index:h.position,vertexBuffer:v.createVertexBuffer({context:t,typedArray:o,usage:_.STATIC_DRAW}),componentsPerAttribute:2},{index:h.webMercatorT,vertexBuffer:v.createVertexBuffer({context:t,sizeInBytes:64*2*4,usage:_.STREAM_DRAW}),componentsPerAttribute:1}],indexBuffer:m});var g=new S({sources:[M]});a.shaderProgram=b.fromCache({context:t,vertexShaderSource:g,fragmentShaderSource:D,attributeLocations:h});a.sampler=new C({wrapS:A.CLAMP_TO_EDGE,wrapT:A.CLAMP_TO_EDGE,minificationFilter:x.LINEAR,magnificationFilter:T.LINEAR})}r.sampler=a.sampler;var y=r.width;var I=r.height;G.textureDimensions.x=y;G.textureDimensions.y=I;G.texture=r;var O=Math.sin(n.south);var R=.5*Math.log((1+O)/(1-O));O=Math.sin(n.north);var N=.5*Math.log((1+O)/(1-O));var L=1/(N-R);var B=new E({context:t,width:y,height:I,pixelFormat:r.pixelFormat,pixelDatatype:r.pixelDatatype,preMultiplyAlpha:r.preMultiplyAlpha});if(l.isPowerOfTwo(y)&&l.isPowerOfTwo(I)){B.generateMipmap(w.NICEST)}var F=n.south;var k=n.north;var V=H;var z=0;for(var U=0;U<64;++U){var q=U/63;var W=l.lerp(F,k,q);O=Math.sin(W);var j=.5*Math.log((1+O)/(1-O));var Y=(j-R)*L;V[z++]=Y;V[z++]=Y}a.vertexArray.getAttribute(1).vertexBuffer.copyFromArrayView(V);e.shaderProgram=a.shaderProgram;e.outputTexture=B;e.uniformMap=G;e.vertexArray=a.vertexArray}function j(e,t,r){var i=e._imageryProvider;var n=i.tilingScheme;var a=n.ellipsoid;var o=!(e._imageryProvider.tilingScheme instanceof s)?Math.cos(r):1;var u=n.rectangle;var l=a.maximumRadius*u.width*o/(i.tileWidth*n.getNumberOfXTilesAtLevel(0));var c=l/t;var d=Math.log(c)/Math.log(2);var f=Math.round(d);return f|0}return B});define("Scene/GlobeSurfaceTileProvider",["../Core/BoundingSphere","../Core/BoxOutlineGeometry","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/Event","../Core/GeometryInstance","../Core/GeometryPipeline","../Core/IndexDatatype","../Core/Intersect","../Core/Math","../Core/Matrix4","../Core/OrientedBoundingBox","../Core/PrimitiveType","../Core/Rectangle","../Core/SphereOutlineGeometry","../Core/TerrainQuantization","../Core/Visibility","../Core/WebMercatorProjection","../Renderer/Buffer","../Renderer/BufferUsage","../Renderer/ContextLimits","../Renderer/DrawCommand","../Renderer/Pass","../Renderer/RenderState","../Renderer/VertexArray","../Scene/BlendingState","../Scene/DepthFunction","../Scene/PerInstanceColorAppearance","../Scene/Primitive","./GlobeSurfaceTile","./ImageryLayer","./OrthographicFrustum","./QuadtreeTileLoadState","./SceneMode","./ShadowMode"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w,C,b,S,E,T,x,A,P,D,M,I,O,R,N,L,B,F,k,V,z,U,q){"use strict";function G(e){if(!u(e)){throw new d("options is required.")}if(!u(e.terrainProvider)){throw new d("options.terrainProvider is required.")}else if(!u(e.imageryLayers)){throw new d("options.imageryLayers is required.")}else if(!u(e.surfaceShaderSet)){throw new d("options.surfaceShaderSet is required.")}this.lightingFadeOutDistance=65e5;this.lightingFadeInDistance=9e6;this.hasWaterMask=false;this.oceanNormalMap=undefined;this.zoomedOutOceanSpecularIntensity=.5;this.enableLighting=false;this.shadows=q.RECEIVE_ONLY;this._quadtree=undefined;this._terrainProvider=e.terrainProvider;this._imageryLayers=e.imageryLayers;this._surfaceShaderSet=e.surfaceShaderSet;this._renderState=undefined;this._blendRenderState=undefined;this._pickRenderState=undefined;this._errorEvent=new f;this._imageryLayers.layerAdded.addEventListener(G.prototype._onLayerAdded,this);this._imageryLayers.layerRemoved.addEventListener(G.prototype._onLayerRemoved,this);this._imageryLayers.layerMoved.addEventListener(G.prototype._onLayerMoved,this);this._imageryLayers.layerShownOrHidden.addEventListener(G.prototype._onLayerShownOrHidden,this);this._layerOrderChanged=false;this._tilesToRenderByTextureCount=[];this._drawCommands=[];this._uniformMaps=[];this._pickCommands=[];this._usedDrawCommands=0;this._usedPickCommands=0;this._vertexArraysToDestroy=[];this._debug={wireframe:false,boundingSphereTile:undefined};this._baseColor=undefined;this._firstPassInitialColor=undefined;this.baseColor=new a(0,0,.5,1)}l(G.prototype,{baseColor:{get:function(){return this._baseColor},set:function(e){if(!u(e)){throw new d("value is required.")}this._baseColor=e;this._firstPassInitialColor=n.fromColor(e,this._firstPassInitialColor)}},quadtree:{get:function(){return this._quadtree},set:function(e){if(!u(e)){throw new d("value is required.")}this._quadtree=e}},ready:{get:function(){return this._terrainProvider.ready&&(this._imageryLayers.length===0||this._imageryLayers.get(0).imageryProvider.ready)}},tilingScheme:{get:function(){return this._terrainProvider.tilingScheme}},errorEvent:{get:function(){return this._errorEvent}},terrainProvider:{get:function(){return this._terrainProvider},set:function(e){if(this._terrainProvider===e){return}if(!u(e)){throw new d("terrainProvider is required.")}this._terrainProvider=e;if(u(this._quadtree)){this._quadtree.invalidateAllTiles()}}}});function H(e,t){var r=e.loadingImagery;if(!u(r)){r=e.readyImagery}var i=t.loadingImagery;if(!u(i)){i=t.readyImagery}return r.imageryLayer._layerIndex-i.imageryLayer._layerIndex}function W(e){var t=e.indexBuffer;e.destroy();if(!t.isDestroyed()&&u(t.referenceCount)){--t.referenceCount;if(t.referenceCount===0){t.destroy()}}}G.prototype.initialize=function(e){var t=this._imageryLayers;t._update();t.queueReprojectionCommands(e);if(this._layerOrderChanged){this._layerOrderChanged=false;this._quadtree.forEachLoadedTile(function(e){e.data.imagery.sort(H)})}var r=e.creditDisplay;if(this._terrainProvider.ready&&u(this._terrainProvider.credit)){r.addCredit(this._terrainProvider.credit)}for(var i=0,n=t.length;i<n;++i){var a=t.get(i).imageryProvider;if(a.ready&&u(a.credit)){r.addCredit(a.credit)}}var o=this._vertexArraysToDestroy;var s=o.length;for(var l=0;l<s;++l){W(o[l])}o.length=0};G.prototype.beginUpdate=function(e){var t=this._tilesToRenderByTextureCount;for(var r=0,i=t.length;r<i;++r){var n=t[r];if(u(n)){n.length=0}}this._usedDrawCommands=0};G.prototype.endUpdate=function(e){if(!u(this._renderState)){this._renderState=I.fromCache({cull:{enabled:true},depthTest:{enabled:true,func:N.LESS}});this._blendRenderState=I.fromCache({cull:{enabled:true},depthTest:{enabled:true,func:N.LESS_OR_EQUAL},blending:R.ALPHA_BLEND})}var t=this._tilesToRenderByTextureCount;for(var r=0,i=t.length;r<i;++r){var n=t[r];if(!u(n)){continue}for(var a=0,o=n.length;a<o;++a){se(this,n[a],e)}}};G.prototype.updateForPick=function(e){if(!u(this._pickRenderState)){this._pickRenderState=I.fromCache({colorMask:{red:false,green:false,blue:false,alpha:false},depthTest:{enabled:true}})}this._usedPickCommands=0;var t=this._drawCommands;for(var r=0,i=this._usedDrawCommands;r<i;++r){ue(this,t[r],e)}};G.prototype.cancelReprojections=function(){this._imageryLayers.cancelReprojections()};G.prototype.getLevelMaximumGeometricError=function(e){return this._terrainProvider.getLevelMaximumGeometricError(e)};G.prototype.loadTile=function(e,t){F.processStateMachine(t,e,this._terrainProvider,this._imageryLayers,this._vertexArraysToDestroy)};var j=new e;G.prototype.computeTileVisibility=function(t,r,n){var a=this.computeDistanceToTile(t,r);t._distance=a;if(r.fog.enabled){if(_.fog(a,r.fog.density)>=1){return E.NONE}}var o=t.data;var l=r.cullingVolume;var c=s(o.orientedBoundingBox,o.boundingSphere3D);if(r.mode!==U.SCENE3D){c=j;e.fromRectangleWithHeights2D(t.rectangle,r.mapProjection,o.minimumHeight,o.maximumHeight,c);i.fromElements(c.center.z,c.center.x,c.center.y,c.center);if(r.mode===U.MORPHING){c=e.union(o.boundingSphere3D,c,c)}}var d=l.computeVisibility(c);if(d===v.OUTSIDE){return E.NONE}var f=r.mode===U.SCENE3D&&r.camera.frustum instanceof V;if(r.mode===U.SCENE3D&&!f){var h=o.occludeePointInScaledSpace;if(!u(h)){return d}if(n.ellipsoid.isScaledSpacePointVisible(h)){return d}return E.NONE}return d};var Y=new g;var X=new g;var Z=new n;var K=new i;var Q=new i;var J=new i;var $=new i;G.prototype.showTileThisFrame=function(e,t){var r=0;var i=e.data.imagery;for(var n=0,a=i.length;n<a;++n){var o=i[n];if(u(o.readyImagery)&&o.readyImagery.imageryLayer.alpha!==0){++r}}var s=this._tilesToRenderByTextureCount[r];if(!u(s)){s=[];this._tilesToRenderByTextureCount[r]=s}s.push(e);var l=this._debug;++l.tilesRendered;l.texturesRendered+=r};G.prototype.computeDistanceToTile=function(e,t){var r=e.data;var i=r.tileBoundingRegion;return i.distanceToCamera(t)};G.prototype.isDestroyed=function(){return false};G.prototype.destroy=function(){this._tileProvider=this._tileProvider&&this._tileProvider.destroy();return c(this)};G.prototype._onLayerAdded=function(e,t){if(e.show){var r=this._terrainProvider;this._quadtree.forEachLoadedTile(function(t){if(e._createTileImagerySkeletons(t,r)){t.state=z.LOADING}});this._layerOrderChanged=true}};G.prototype._onLayerRemoved=function(e,t){this._quadtree.forEachLoadedTile(function(t){var r=t.data.imagery;var i=-1;var n=0;for(var a=0,o=r.length;a<o;++a){var s=r[a];var l=s.loadingImagery;if(!u(l)){l=s.readyImagery}if(l.imageryLayer===e){if(i===-1){i=a}s.freeResources();++n}else if(i!==-1){break}}if(i!==-1){r.splice(i,n)}})};G.prototype._onLayerMoved=function(e,t,r){this._layerOrderChanged=true};G.prototype._onLayerShownOrHidden=function(e,t,r){if(r){this._onLayerAdded(e,t)}else{this._onLayerRemoved(e,t)}};function ee(e){var t={u_initialColor:function(){return this.properties.initialColor},u_zoomedOutOceanSpecularIntensity:function(){return this.properties.zoomedOutOceanSpecularIntensity},u_oceanNormalMap:function(){return this.properties.oceanNormalMap},u_lightingFadeDistance:function(){return this.properties.lightingFadeDistance},u_center3D:function(){return this.properties.center3D},u_tileRectangle:function(){return this.properties.tileRectangle},u_modifiedModelView:function(){var t=e.context.uniformState.view;var r=g.multiplyByPoint(t,this.properties.rtc,Q);g.setTranslation(t,r,Y);return Y},u_modifiedModelViewProjection:function(){var t=e.context.uniformState.view;var r=e.context.uniformState.projection;var i=g.multiplyByPoint(t,this.properties.rtc,Q);g.setTranslation(t,i,X);g.multiply(r,X,X);return X},u_dayTextures:function(){return this.properties.dayTextures},u_dayTextureTranslationAndScale:function(){return this.properties.dayTextureTranslationAndScale},u_dayTextureTexCoordsRectangle:function(){return this.properties.dayTextureTexCoordsRectangle},u_dayTextureUseWebMercatorT:function(){return this.properties.dayTextureUseWebMercatorT},u_dayTextureAlpha:function(){return this.properties.dayTextureAlpha},u_dayTextureBrightness:function(){return this.properties.dayTextureBrightness},u_dayTextureContrast:function(){return this.properties.dayTextureContrast},u_dayTextureHue:function(){return this.properties.dayTextureHue},u_dayTextureSaturation:function(){return this.properties.dayTextureSaturation},u_dayTextureOneOverGamma:function(){return this.properties.dayTextureOneOverGamma},u_dayIntensity:function(){return this.properties.dayIntensity},u_southAndNorthLatitude:function(){return this.properties.southAndNorthLatitude},u_southMercatorYAndOneOverHeight:function(){return this.properties.southMercatorYAndOneOverHeight},u_waterMask:function(){return this.properties.waterMask},u_waterMaskTranslationAndScale:function(){return this.properties.waterMaskTranslationAndScale},u_minMaxHeight:function(){return this.properties.minMaxHeight},u_scaleAndBias:function(){return this.properties.scaleAndBias},u_dayTextureSplit:function(){return this.properties.dayTextureSplit},properties:{initialColor:new n(0,0,.5,1),zoomedOutOceanSpecularIntensity:.5,oceanNormalMap:undefined,lightingFadeDistance:new r(65e5,9e6),center3D:undefined,rtc:new i,modifiedModelView:new g,tileRectangle:new n,dayTextures:[],dayTextureTranslationAndScale:[],dayTextureTexCoordsRectangle:[],dayTextureUseWebMercatorT:[],dayTextureAlpha:[],dayTextureBrightness:[],dayTextureContrast:[],dayTextureHue:[],dayTextureSaturation:[],dayTextureOneOverGamma:[],dayTextureSplit:[],dayIntensity:0,southAndNorthLatitude:new r,southMercatorYAndOneOverHeight:new r,waterMask:undefined,waterMaskTranslationAndScale:new n,minMaxHeight:new r,scaleAndBias:new g}};return t}function te(e,t,r){var i=r.data;if(u(i.wireframeVertexArray)){return}if(!u(i.terrainData)||!u(i.terrainData._mesh)){return}i.wireframeVertexArray=re(e,i.vertexArray,i.terrainData._mesh)}function re(e,t,r){var i={indices:r.indices,primitiveType:w.TRIANGLES};p.toWireframe(i);var n=i.indices;var a=x.createIndexBuffer({context:e,typedArray:n,usage:A.STATIC_DRAW,indexDatatype:m.UNSIGNED_SHORT});return new O({context:e,attributes:t._attributes,indexBuffer:a})}var ie;var ne;var ae;(function(){var e=new h({geometry:t.fromDimensions({dimensions:new i(2,2,2)})});var r=new h({geometry:new b({radius:1})});var n=new g;var a;var s;function l(e){return new B({geometryInstances:e,appearance:new L({translucent:false,flat:true}),asynchronous:false})}ie=function(t,r){if(t===a){return s}ae();a=t;n=g.fromRotationTranslation(t.halfAxes,t.center,n);e.modelMatrix=n;e.attributes.color=o.fromColor(r);s=l(e);return s};ne=function(e,t){if(e===a){return s}ae();a=e;n=g.fromTranslation(e.center,n);n=g.multiplyByUniformScale(n,e.radius,n);r.modelMatrix=n;r.attributes.color=o.fromColor(t);s=l(r);return s};ae=function(){if(u(s)){s.destroy();s=undefined;a=undefined}}})();var oe=new n(0,0,0,0);function se(t,r,o){var s=r.data;var l=P.maximumTextureImageUnits;var c=s.waterMaskTexture;var f=t.hasWaterMask&&u(c);var h=t.oceanNormalMap;var p=f&&u(h);var m=t.terrainProvider.ready&&t.terrainProvider.hasVertexNormals;var v=o.fog.enabled;var b=q.castShadows(t.shadows);var E=q.receiveShadows(t.shadows);if(f){--l}if(p){--l}var x=s.center;var A=s.pickTerrain.mesh.encoding;var I=Z;var O=0;var R=0;var N=0;var L=0;var B=false;if(o.mode!==U.SCENE3D){var F=o.mapProjection;var V=F.project(C.southwest(r.rectangle),J);var z=F.project(C.northeast(r.rectangle),$);I.x=V.x;I.y=V.y;I.z=z.x;I.w=z.y;if(o.mode!==U.MORPHING){x=K;x.x=0;x.y=(I.z+I.x)*.5;x.z=(I.w+I.y)*.5;I.x-=x.y;I.y-=x.z;I.z-=x.y;I.w-=x.z}if(o.mode===U.SCENE2D&&A.quantization===S.BITS12){var G=1/(Math.pow(2,12)-1)*.5;var H=(I.z-I.x)*G;var W=(I.w-I.y)*G;I.x-=H;I.y-=W;I.z+=H;I.w+=W}if(F instanceof T){O=r.rectangle.south;R=r.rectangle.north;N=T.geodeticLatitudeToMercatorAngle(O);L=1/(T.geodeticLatitudeToMercatorAngle(R)-N);B=true}}var j=s.imagery;var Y=0;var X=j.length;var Q=t._renderState;var re=t._blendRenderState;var se=Q;var ue=t._firstPassInitialColor;var le=o.context;if(!u(t._debug.boundingSphereTile)){ae()}do{var ce=0;var de;var fe;if(t._drawCommands.length<=t._usedDrawCommands){de=new D;de.owner=r;de.cull=false;de.boundingVolume=new e;de.orientedBoundingBox=undefined;fe=ee(o);t._drawCommands.push(de);t._uniformMaps.push(fe)}else{de=t._drawCommands[t._usedDrawCommands];fe=t._uniformMaps[t._usedDrawCommands]}de.owner=r;++t._usedDrawCommands;if(r===t._debug.boundingSphereTile){if(u(s.orientedBoundingBox)){ie(s.orientedBoundingBox,a.RED).update(o)}else if(u(s.boundingSphere3D)){ne(s.boundingSphere3D,a.RED).update(o)}}var he=fe.properties;n.clone(ue,he.initialColor);he.oceanNormalMap=h;he.lightingFadeDistance.x=t.lightingFadeOutDistance;he.lightingFadeDistance.y=t.lightingFadeInDistance;he.zoomedOutOceanSpecularIntensity=t.zoomedOutOceanSpecularIntensity;he.center3D=s.center;i.clone(x,he.rtc);n.clone(I,he.tileRectangle);he.southAndNorthLatitude.x=O;he.southAndNorthLatitude.y=R;he.southMercatorYAndOneOverHeight.x=N;he.southMercatorYAndOneOverHeight.y=L;var pe=v&&_.fog(r._distance,o.fog.density)>_.EPSILON3;var me=false;var ve=false;var _e=false;var ge=false;var ye=false;var we=false;var Ce=false;while(ce<l&&Y<X){var be=j[Y];var Se=be.readyImagery;++Y;if(!u(Se)||Se.imageryLayer.alpha===0){continue}var Ee=be.useWebMercatorT?Se.textureWebMercator:Se.texture;if(!u(Ee)){throw new d("readyImagery is not actually ready!")}var Te=Se.imageryLayer;if(!u(be.textureTranslationAndScale)){be.textureTranslationAndScale=Te._calculateTextureTranslationAndScale(r,be)}he.dayTextures[ce]=Ee;he.dayTextureTranslationAndScale[ce]=be.textureTranslationAndScale;he.dayTextureTexCoordsRectangle[ce]=be.textureCoordinateRectangle;he.dayTextureUseWebMercatorT[ce]=be.useWebMercatorT;he.dayTextureAlpha[ce]=Te.alpha;we=we||he.dayTextureAlpha[ce]!==1;he.dayTextureBrightness[ce]=Te.brightness;me=me||he.dayTextureBrightness[ce]!==k.DEFAULT_BRIGHTNESS;he.dayTextureContrast[ce]=Te.contrast;ve=ve||he.dayTextureContrast[ce]!==k.DEFAULT_CONTRAST;he.dayTextureHue[ce]=Te.hue;_e=_e||he.dayTextureHue[ce]!==k.DEFAULT_HUE;he.dayTextureSaturation[ce]=Te.saturation;ge=ge||he.dayTextureSaturation[ce]!==k.DEFAULT_SATURATION;he.dayTextureOneOverGamma[ce]=1/Te.gamma;ye=ye||he.dayTextureOneOverGamma[ce]!==1/k.DEFAULT_GAMMA;he.dayTextureSplit[ce]=Te.splitDirection;Ce=Ce||he.dayTextureSplit[ce]!==0;if(u(Se.credits)){var xe=o.creditDisplay;var Ae=Se.credits;for(var Pe=0,De=Ae.length;Pe<De;++Pe){xe.addCredit(Ae[Pe])}}++ce}he.dayTextures.length=ce;he.waterMask=c;n.clone(s.waterMaskTranslationAndScale,he.waterMaskTranslationAndScale);he.minMaxHeight.x=A.minimumHeight;he.minMaxHeight.y=A.maximumHeight;g.clone(A.matrix,he.scaleAndBias);de.shaderProgram=t._surfaceShaderSet.getShaderProgram(o,s,ce,me,ve,_e,ge,ye,we,Ce,f,p,t.enableLighting,m,B,pe);de.castShadows=b;de.receiveShadows=E;de.renderState=se;de.primitiveType=w.TRIANGLES;de.vertexArray=s.vertexArray;de.uniformMap=fe;de.pass=M.GLOBE;if(t._debug.wireframe){te(le,t,r);if(u(s.wireframeVertexArray)){de.vertexArray=s.wireframeVertexArray;de.primitiveType=w.LINES}}var Me=de.boundingVolume;var Ie=de.orientedBoundingBox;if(o.mode!==U.SCENE3D){e.fromRectangleWithHeights2D(r.rectangle,o.mapProjection,s.minimumHeight,s.maximumHeight,Me);i.fromElements(Me.center.z,Me.center.x,Me.center.y,Me.center);if(o.mode===U.MORPHING){Me=e.union(s.boundingSphere3D,Me,Me)}}else{de.boundingVolume=e.clone(s.boundingSphere3D,Me);de.orientedBoundingBox=y.clone(s.orientedBoundingBox,Ie)}o.commandList.push(de);se=re;ue=oe}while(Y<X)}function ue(e,t,r){var i;if(e._pickCommands.length<=e._usedPickCommands){i=new D;i.cull=false;e._pickCommands.push(i)}else{i=e._pickCommands[e._usedPickCommands]}++e._usedPickCommands;var n=t.owner.data;var a=r.projection instanceof T;i.shaderProgram=e._surfaceShaderSet.getPickShaderProgram(r,n,a);i.renderState=e._pickRenderState;i.owner=t.owner;i.primitiveType=t.primitiveType;i.vertexArray=t.vertexArray;i.uniformMap=t.uniformMap;i.boundingVolume=t.boundingVolume;i.orientedBoundingBox=t.orientedBoundingBox;i.pass=t.pass;r.commandList.push(i)}return G});define("Scene/ImageryLayerCollection",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/Event","../Core/Math","../Core/Rectangle","../ThirdParty/when","./ImageryLayer"],function(e,t,r,i,n,a,o,s,u,l){"use strict";function c(){this._layers=[];this.layerAdded=new a;this.layerRemoved=new a;this.layerMoved=new a;this.layerShownOrHidden=new a}r(c.prototype,{length:{get:function(){return this._layers.length}}});c.prototype.add=function(e,r){var i=t(r);if(!t(e)){throw new n("layer is required.")}if(i){if(r<0){throw new n("index must be greater than or equal to zero.")}else if(r>this._layers.length){throw new n("index must be less than or equal to the number of layers.")}}if(!i){r=this._layers.length;this._layers.push(e)}else{this._layers.splice(r,0,e)}this._update();this.layerAdded.raiseEvent(e,r)};c.prototype.addImageryProvider=function(e,r){if(!t(e)){throw new n("imageryProvider is required.")}var i=new l(e);this.add(i,r);return i};c.prototype.remove=function(t,r){r=e(r,true);var i=this._layers.indexOf(t);if(i!==-1){this._layers.splice(i,1);this._update();this.layerRemoved.raiseEvent(t,i);if(r){t.destroy()}return true}return false};c.prototype.removeAll=function(t){t=e(t,true);var r=this._layers;for(var i=0,n=r.length;i<n;i++){var a=r[i];this.layerRemoved.raiseEvent(a,i);if(t){a.destroy()}}this._layers=[]};c.prototype.contains=function(e){return this.indexOf(e)!==-1};c.prototype.indexOf=function(e){return this._layers.indexOf(e)};c.prototype.get=function(e){if(!t(e)){throw new n("index is required.","index")}return this._layers[e]};function d(e,r){if(!t(r)){throw new n("layer is required.")}var i=e.indexOf(r);if(i===-1){throw new n("layer is not in this collection.")}return i}function f(e,t,r){var i=e._layers;t=o.clamp(t,0,i.length-1);r=o.clamp(r,0,i.length-1);if(t===r){return}var n=i[t];i[t]=i[r];i[r]=n;e._update();e.layerMoved.raiseEvent(n,r,t)}c.prototype.raise=function(e){var t=d(this._layers,e);f(this,t,t+1)};c.prototype.lower=function(e){var t=d(this._layers,e);f(this,t,t-1)};c.prototype.raiseToTop=function(e){var t=d(this._layers,e);if(t===this._layers.length-1){return}this._layers.splice(t,1);this._layers.push(e);this._update();this.layerMoved.raiseEvent(e,this._layers.length-1,t)};c.prototype.lowerToBottom=function(e){var t=d(this._layers,e);if(t===0){return}this._layers.splice(t,1);this._layers.splice(0,0,e);this._update();this.layerMoved.raiseEvent(e,0,t)};var h=new s;c.prototype.pickImageryLayerFeatures=function(e,r){var i=r.globe.pick(e,r);if(!t(i)){return undefined}var n=r.globe.ellipsoid.cartesianToCartographic(i);var a=r.globe._surface._tilesToRender;var l;for(var c=0;!t(l)&&c<a.length;++c){var d=a[c];if(s.contains(d.rectangle,n)){l=d}}if(!t(l)){return undefined}var f=l.data.imagery;var p=[];var m=[];for(var v=f.length-1;v>=0;--v){var _=f[v];var g=_.readyImagery;if(!t(g)){continue}var y=g.imageryLayer.imageryProvider;if(!t(y.pickFeatures)){continue}if(!s.contains(g.rectangle,n)){continue}var w=h;var C=1/1024;w.west=o.lerp(l.rectangle.west,l.rectangle.east,_.textureCoordinateRectangle.x-C);w.east=o.lerp(l.rectangle.west,l.rectangle.east,_.textureCoordinateRectangle.z+C);w.south=o.lerp(l.rectangle.south,l.rectangle.north,_.textureCoordinateRectangle.y-C);w.north=o.lerp(l.rectangle.south,l.rectangle.north,_.textureCoordinateRectangle.w+C);if(!s.contains(w,n)){continue}var b=y.pickFeatures(g.x,g.y,g.level,n.longitude,n.latitude);if(!t(b)){continue}p.push(b);m.push(g.imageryLayer)}if(p.length===0){return undefined}return u.all(p,function(e){var r=[];for(var i=0;i<e.length;++i){var a=e[i];var o=m[i];if(t(a)&&a.length>0){for(var s=0;s<a.length;++s){var u=a[s];u.imageryLayer=o;if(!t(u.position)){u.position=n}r.push(u)}}}return r})};c.prototype.queueReprojectionCommands=function(e){var t=this._layers;for(var r=0,i=t.length;r<i;++r){t[r].queueReprojectionCommands(e)}};c.prototype.cancelReprojections=function(){var e=this._layers;for(var t=0,r=e.length;t<r;++t){e[t].cancelReprojections()}};c.prototype.isDestroyed=function(){return false};c.prototype.destroy=function(){this.removeAll(true);return i(this)};c.prototype._update=function(){var e=true;var r=this._layers;var i;var n;for(var a=0,o=r.length;a<o;++a){n=r[a];n._layerIndex=a;if(n.show){n._isBaseLayer=e;e=false}else{n._isBaseLayer=false}if(n.show!==n._show){if(t(n._show)){if(!t(i)){i=[]}i.push(n)}n._show=n.show}}if(t(i)){for(a=0,o=i.length;a<o;++a){n=i[a];this.layerShownOrHidden.raiseEvent(n,n._layerIndex,n.show)}}};return c});define("Scene/QuadtreeOccluders",["../Core/Cartesian3","../Core/defineProperties","../Core/EllipsoidalOccluder"],function(e,t,r){"use strict";function i(t){this._ellipsoid=new r(t.ellipsoid,e.ZERO)}t(i.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}});return i});define("Scene/QuadtreeTile",["../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Rectangle","./QuadtreeTileLoadState"],function(e,t,r,i,n){"use strict";function a(t){if(!e(t)){throw new r("options is required.")}if(!e(t.x)){throw new r("options.x is required.")}else if(!e(t.y)){throw new r("options.y is required.")}else if(t.x<0||t.y<0){throw new r("options.x and options.y must be greater than or equal to zero.")}if(!e(t.level)){throw new r("options.level is required and must be greater than or equal to zero.")}if(!e(t.tilingScheme)){throw new r("options.tilingScheme is required.")}this._tilingScheme=t.tilingScheme;this._x=t.x;this._y=t.y;this._level=t.level;this._parent=t.parent;this._rectangle=this._tilingScheme.tileXYToRectangle(this._x,this._y,this._level);this._southwestChild=undefined;this._southeastChild=undefined;this._northwestChild=undefined;this._northeastChild=undefined;this._replacementPrevious=undefined;this._replacementNext=undefined;this._distance=0;this._customData=[];this._frameUpdated=undefined;this._frameRendered=undefined;this.state=n.START;this.renderable=false;this.upsampledFromParent=false;this.data=undefined}a.createLevelZeroTiles=function(t){if(!e(t)){throw new r("tilingScheme is required.")}var i=t.getNumberOfXTilesAtLevel(0);var n=t.getNumberOfYTilesAtLevel(0);var o=new Array(i*n);var s=0;for(var u=0;u<n;++u){for(var l=0;l<i;++l){o[s++]=new a({tilingScheme:t,x:l,y:u,level:0})}}return o};a.prototype._updateCustomData=function(t,r,n){var a=this.customData;var o;var s;var u;if(e(r)&&e(n)){a=a.filter(function(e){return n.indexOf(e)===-1});this._customData=a;u=this._rectangle;for(o=0;o<r.length;++o){s=r[o];if(i.contains(u,s.positionCartographic)){a.push(s)}}this._frameUpdated=t}else{var l=this._parent;if(e(l)&&this._frameUpdated!==l._frameUpdated){a.length=0;u=this._rectangle;var c=l.customData;for(o=0;o<c.length;++o){s=c[o];if(i.contains(u,s.positionCartographic)){a.push(s)}}this._frameUpdated=l._frameUpdated}}};t(a.prototype,{tilingScheme:{get:function(){return this._tilingScheme}},x:{get:function(){return this._x}},y:{get:function(){return this._y}},level:{get:function(){return this._level}},parent:{get:function(){return this._parent}},rectangle:{get:function(){return this._rectangle}},children:{get:function(){return[this.northwestChild,this.northeastChild,this.southwestChild,this.southeastChild]}},southwestChild:{get:function(){if(!e(this._southwestChild)){this._southwestChild=new a({tilingScheme:this.tilingScheme,x:this.x*2,y:this.y*2+1,level:this.level+1,parent:this})}return this._southwestChild}},southeastChild:{get:function(){if(!e(this._southeastChild)){this._southeastChild=new a({tilingScheme:this.tilingScheme,x:this.x*2+1,y:this.y*2+1,level:this.level+1,parent:this})}return this._southeastChild}},northwestChild:{get:function(){if(!e(this._northwestChild)){this._northwestChild=new a({tilingScheme:this.tilingScheme,x:this.x*2,y:this.y*2,level:this.level+1,parent:this})}return this._northwestChild}},northeastChild:{get:function(){if(!e(this._northeastChild)){this._northeastChild=new a({tilingScheme:this.tilingScheme,x:this.x*2+1,y:this.y*2,level:this.level+1,parent:this})}return this._northeastChild}},customData:{get:function(){return this._customData}},needsLoading:{get:function(){return this.state<n.DONE}},eligibleForUnloading:{get:function(){var t=true;if(e(this.data)){t=this.data.eligibleForUnloading;if(!e(t)){t=true}}return t}}});a.prototype.freeResources=function(){this.state=n.START;this.renderable=false;this.upsampledFromParent=false;if(e(this.data)&&e(this.data.freeResources)){this.data.freeResources()}o(this._southwestChild);this._southwestChild=undefined;o(this._southeastChild);this._southeastChild=undefined;o(this._northwestChild);this._northwestChild=undefined;o(this._northeastChild);this._northeastChild=undefined};function o(t){if(e(t)){t.freeResources()}}return a});define("Scene/TileReplacementQueue",["../Core/defined"],function(e){"use strict";function t(){this.head=undefined;this.tail=undefined;this.count=0;this._lastBeforeStartOfFrame=undefined}t.prototype.markStartOfRenderFrame=function(){this._lastBeforeStartOfFrame=this.head};t.prototype.trimTiles=function(t){var i=this.tail;var n=true;while(n&&e(this._lastBeforeStartOfFrame)&&this.count>t&&e(i)){n=i!==this._lastBeforeStartOfFrame;var a=i.replacementPrevious;if(i.eligibleForUnloading){i.freeResources();r(this,i)}i=a}};function r(e,t){var r=t.replacementPrevious;var i=t.replacementNext;if(t===e._lastBeforeStartOfFrame){e._lastBeforeStartOfFrame=i}if(t===e.head){e.head=i}else{r.replacementNext=i}if(t===e.tail){e.tail=r}else{i.replacementPrevious=r}t.replacementPrevious=undefined;t.replacementNext=undefined;--e.count}t.prototype.markTileRendered=function(t){var i=this.head;if(i===t){if(t===this._lastBeforeStartOfFrame){this._lastBeforeStartOfFrame=t.replacementNext}return}++this.count;if(!e(i)){t.replacementPrevious=undefined;t.replacementNext=undefined;this.head=t;this.tail=t;return}if(e(t.replacementPrevious)||e(t.replacementNext)){r(this,t)}t.replacementPrevious=undefined;t.replacementNext=i;i.replacementPrevious=t;this.head=t};return t});define("Scene/QuadtreePrimitive",["../Core/Cartesian3","../Core/Cartographic","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/getTimestamp","../Core/Math","../Core/Ray","../Core/Rectangle","../Core/Visibility","./OrthographicFrustum","./QuadtreeOccluders","./QuadtreeTile","./QuadtreeTileLoadState","./SceneMode","./TileReplacementQueue"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_){"use strict";function g(e){if(!i(e)||!i(e.tileProvider)){throw new a("options.tileProvider is required.")}if(i(e.tileProvider.quadtree)){throw new a("A QuadtreeTileProvider can only be used with a single QuadtreePrimitive")}this._tileProvider=e.tileProvider;this._tileProvider.quadtree=this;this._debug={enableDebugOutput:false,maxDepth:0,tilesVisited:0,tilesCulled:0,tilesRendered:0,tilesWaitingForChildren:0,lastMaxDepth:-1,lastTilesVisited:-1,lastTilesCulled:-1,lastTilesRendered:-1,lastTilesWaitingForChildren:-1,suspendLodUpdate:false};var t=this._tileProvider.tilingScheme;var n=t.ellipsoid;this._tilesToRender=[];this._tileLoadQueueHigh=[];this._tileLoadQueueMedium=[];this._tileLoadQueueLow=[];this._tileReplacementQueue=new _;this._levelZeroTiles=undefined;this._levelZeroTilesReady=false;this._loadQueueTimeSlice=5;this._addHeightCallbacks=[];this._removeHeightCallbacks=[];this._tileToUpdateHeights=[];this._lastTileIndex=0;this._updateHeightsTimeSlice=2;this.maximumScreenSpaceError=r(e.maximumScreenSpaceError,2);this.tileCacheSize=r(e.tileCacheSize,100);this._occluders=new h({ellipsoid:n});this._tileLoadProgressEvent=new o;this._lastTileLoadQueueLength=0}n(g.prototype,{tileProvider:{get:function(){return this._tileProvider}},tileLoadProgressEvent:{get:function(){return this._tileLoadProgressEvent}}});g.prototype.invalidateAllTiles=function(){var e=this._tileReplacementQueue;e.head=undefined;e.tail=undefined;e.count=0;var t=this._levelZeroTiles;if(i(t)){for(var r=0;r<t.length;++r){var n=t[r];var a=n.customData;var o=a.length;for(var s=0;s<o;++s){var u=a[s];u.level=0;this._addHeightCallbacks.push(u)}t[r].freeResources()}}this._levelZeroTiles=undefined;this._tileProvider.cancelReprojections()};g.prototype.forEachLoadedTile=function(e){var t=this._tileReplacementQueue.head;while(i(t)){if(t.state!==m.START){e(t)}t=t.replacementNext}};g.prototype.forEachRenderedTile=function(e){var t=this._tilesToRender;for(var r=0,i=t.length;r<i;++r){e(t[r])}};g.prototype.updateHeight=function(e,t){var r=this;var i={positionOnEllipsoidSurface:undefined,positionCartographic:e,level:-1,callback:t};i.removeFunc=function(){var e=r._addHeightCallbacks;var t=e.length;for(var n=0;n<t;++n){if(e[n]===i){e.splice(n,1)
;break}}r._removeHeightCallbacks.push(i)};r._addHeightCallbacks.push(i);return i.removeFunc};g.prototype.beginFrame=function(e){var t=e.passes;if(!t.render){return}this._tileProvider.initialize(e);var r=this._debug;if(r.suspendLodUpdate){return}r.maxDepth=0;r.tilesVisited=0;r.tilesCulled=0;r.tilesRendered=0;r.tilesWaitingForChildren=0;this._tileLoadQueueHigh.length=0;this._tileLoadQueueMedium.length=0;this._tileLoadQueueLow.length=0;this._tileReplacementQueue.markStartOfRenderFrame()};g.prototype.update=function(e){var t=e.passes;if(t.render){this._tileProvider.beginUpdate(e);b(this,e);k(this,e);this._tileProvider.endUpdate(e)}if(t.pick&&this._tilesToRender.length>0){this._tileProvider.updateForPick(e)}};g.prototype.endFrame=function(e){var t=e.passes;if(!t.render||e.mode===v.MORPHING){return}O(this,e);F(this,e);var r=this._debug;if(r.suspendLodUpdate){return}if(r.enableDebugOutput){if(r.tilesVisited!==r.lastTilesVisited||r.tilesRendered!==r.lastTilesRendered||r.tilesCulled!==r.lastTilesCulled||r.maxDepth!==r.lastMaxDepth||r.tilesWaitingForChildren!==r.lastTilesWaitingForChildren){console.log("Visited "+r.tilesVisited+", Rendered: "+r.tilesRendered+", Culled: "+r.tilesCulled+", Max Depth: "+r.maxDepth+", Waiting for children: "+r.tilesWaitingForChildren);r.lastTilesVisited=r.tilesVisited;r.lastTilesRendered=r.tilesRendered;r.lastTilesCulled=r.tilesCulled;r.lastMaxDepth=r.maxDepth;r.lastTilesWaitingForChildren=r.tilesWaitingForChildren}}};g.prototype.isDestroyed=function(){return false};g.prototype.destroy=function(){this._tileProvider=this._tileProvider&&this._tileProvider.destroy()};var y;var w=new t;function C(e,t){var r=c.center(e.rectangle,w);var i=r.longitude-y.longitude;var n=r.latitude-y.latitude;r=c.center(t.rectangle,w);var a=r.longitude-y.longitude;var o=r.latitude-y.latitude;return i*i+n*n-(a*a+o*o)}function b(e,t){var r=e._debug;if(r.suspendLodUpdate){return}var n;var a;var o=e._tilesToRender;o.length=0;if(!i(e._levelZeroTiles)){if(e._tileProvider.ready){var s=e._tileProvider.tilingScheme;e._levelZeroTiles=p.createLevelZeroTiles(s)}else{return}}e._occluders.ellipsoid.cameraPosition=t.camera.positionWC;var u=e._tileProvider;var l=e._occluders;var c;var f=e._levelZeroTiles;y=t.camera.positionCartographic;f.sort(C);var h=e._addHeightCallbacks;var m=e._removeHeightCallbacks;var v=t.frameNumber;if(h.length>0||m.length>0){for(n=0,a=f.length;n<a;++n){c=f[n];c._updateCustomData(v,h,m)}h.length=0;m.length=0}for(n=0,a=f.length;n<a;++n){c=f[n];e._tileReplacementQueue.markTileRendered(c);if(!c.renderable){if(c.needsLoading){e._tileLoadQueueHigh.push(c)}++r.tilesWaitingForChildren}else if(u.computeTileVisibility(c,t,l)!==d.NONE){S(e,t,c)}else{if(c.needsLoading){e._tileLoadQueueLow.push(c)}++r.tilesCulled}}P(e)}function S(e,t,r){var i=e._debug;++i.tilesVisited;e._tileReplacementQueue.markTileRendered(r);r._updateCustomData(t.frameNumber);if(r.level>i.maxDepth){i.maxDepth=r.level}if(D(e,t,r)<e.maximumScreenSpaceError){if(r.needsLoading){e._tileLoadQueueMedium.push(r)}I(e,r);return}var n=r.southwestChild;var a=r.southeastChild;var o=r.northwestChild;var s=r.northeastChild;var u=n.renderable&&a.renderable&&o.renderable&&s.renderable;var l=n.upsampledFromParent&&a.upsampledFromParent&&o.upsampledFromParent&&s.upsampledFromParent;if(u){if(l){I(e,r);E(e,t.camera.positionCartographic,n,a,o,s);if(r.needsLoading){e._tileLoadQueueMedium.push(r)}}else{x(e,n,a,o,s,t);if(r.needsLoading){e._tileLoadQueueLow.push(r)}}}else{E(e,t.camera.positionCartographic,n,a,o,s);I(e,r);if(r.needsLoading){e._tileLoadQueueLow.push(r)}}}function E(e,t,r,i,n,a){if(t.longitude<r.east){if(t.latitude<r.north){T(e,r);T(e,i);T(e,n);T(e,a)}else{T(e,n);T(e,r);T(e,a);T(e,i)}}else{if(t.latitude<r.north){T(e,i);T(e,r);T(e,a);T(e,n)}else{T(e,a);T(e,n);T(e,i);T(e,r)}}}function T(e,t){e._tileReplacementQueue.markTileRendered(t);if(t.needsLoading){if(t.renderable){e._tileLoadQueueLow.push(t)}else{e._tileLoadQueueHigh.push(t)}}}function x(e,t,r,i,n,a){var o=a.camera.positionCartographic;var s=e._tileProvider;var u=e._occluders;if(o.longitude<t.rectangle.east){if(o.latitude<t.rectangle.north){A(e,t,s,a,u);A(e,r,s,a,u);A(e,i,s,a,u);A(e,n,s,a,u)}else{A(e,i,s,a,u);A(e,t,s,a,u);A(e,n,s,a,u);A(e,r,s,a,u)}}else{if(o.latitude<t.rectangle.north){A(e,r,s,a,u);A(e,t,s,a,u);A(e,n,s,a,u);A(e,i,s,a,u)}else{A(e,n,s,a,u);A(e,i,s,a,u);A(e,r,s,a,u);A(e,t,s,a,u)}}}function A(e,t,r,i,n){if(r.computeTileVisibility(t,i,n)!==d.NONE){S(e,i,t)}else{++e._debug.tilesCulled;e._tileReplacementQueue.markTileRendered(t)}}function P(e){var t=e._tileLoadQueueHigh.length+e._tileLoadQueueMedium.length+e._tileLoadQueueLow.length;if(t!==e._lastTileLoadQueueLength){e._tileLoadProgressEvent.raiseEvent(t);e._lastTileLoadQueueLength=t}}function D(e,t,r){if(t.mode===v.SCENE2D||t.camera.frustum instanceof f){return M(e,t,r)}var i=e._tileProvider.getLevelMaximumGeometricError(r.level);var n=r._distance;var a=t.context.drawingBufferHeight;var o=t.camera.frustum.sseDenominator;var s=i*a/(n*o);if(t.fog.enabled){s=s-u.fog(n,t.fog.density)*t.fog.sse}return s}function M(e,t,r){var n=t.camera;var a=n.frustum;if(i(a._offCenterFrustum)){a=a._offCenterFrustum}var o=t.context;var s=o.drawingBufferWidth;var l=o.drawingBufferHeight;var c=e._tileProvider.getLevelMaximumGeometricError(r.level);var d=Math.max(a.top-a.bottom,a.right-a.left)/Math.max(s,l);var f=c/d;if(t.fog.enabled&&t.mode!==v.SCENE2D){f=f-u.fog(r._distance,t.fog.density)*t.fog.sse}return f}function I(e,t){e._tilesToRender.push(t);++e._debug.tilesRendered}function O(e,t){var r=e._tileLoadQueueHigh;var i=e._tileLoadQueueMedium;var n=e._tileLoadQueueLow;var a=e._tileProvider;if(r.length===0&&i.length===0&&n.length===0){return}e._tileReplacementQueue.trimTiles(e.tileCacheSize);var o=s()+e._loadQueueTimeSlice;R(e,t,a,o,r);R(e,t,a,o,i);R(e,t,a,o,n)}function R(e,t,r,i,n){for(var a=0,o=n.length;a<o&&s()<i;++a){var u=n[a];e._tileReplacementQueue.markTileRendered(u);r.loadTile(t,u)}}var N=new l;var L=new t;var B=new e;function F(n,a){var o=n._tileToUpdateHeights;var u=n._tileProvider.terrainProvider;var l=s();var d=n._updateHeightsTimeSlice;var f=l+d;var h=a.mode;var p=a.mapProjection;var m=p.ellipsoid;while(o.length>0){var _=o[0];var g=_.customData;var y=g.length;var w=false;for(var C=n._lastTileIndex;C<y;++C){var b=g[C];if(_.level>b.level){if(!i(b.positionOnEllipsoidSurface)){b.positionOnEllipsoidSurface=e.fromRadians(b.positionCartographic.longitude,b.positionCartographic.latitude,0,m)}if(h===v.SCENE3D){var S=m.geodeticSurfaceNormal(b.positionOnEllipsoidSurface,N.direction);var E=m.getSurfaceNormalIntersectionWithZAxis(b.positionOnEllipsoidSurface,11500,N.origin);if(!i(E)){var T=Math.min(r(_.data.minimumHeight,0),-11500);var x=e.multiplyByScalar(S,Math.abs(T)+1,B);e.subtract(b.positionOnEllipsoidSurface,x,N.origin)}}else{t.clone(b.positionCartographic,L);L.height=-11500;p.project(L,B);e.fromElements(B.z,B.x,B.y,B);e.clone(B,N.origin);e.clone(e.UNIT_X,N.direction)}var A=_.data.pick(N,h,p,false,B);if(i(A)){b.callback(A)}b.level=_.level}else if(_.level===b.level){var P=_.children;var D=P.length;var M;for(var I=0;I<D;++I){M=P[I];if(c.contains(M.rectangle,b.positionCartographic)){break}}var O=u.getTileDataAvailable(M.x,M.y,M.level);var R=_.parent;if(i(O)&&!O||i(R)&&i(R.data)&&i(R.data.terrainData)&&!R.data.terrainData.isChildAvailable(R.x,R.y,M.x,M.y)){b.removeFunc()}}if(s()>=f){w=true;break}}if(w){n._lastTileIndex=C;break}else{n._lastTileIndex=0;o.shift()}}}function k(e,t){var r=e._tileProvider;var i=e._tilesToRender;var n=e._tileToUpdateHeights;for(var a=0,o=i.length;a<o;++a){var s=i[a];r.showTileThisFrame(s,t);if(s._frameRendered!==t.frameNumber-1){n.push(s)}s._frameRendered=t.frameNumber}}return g});define("Scene/Globe",["../Core/BoundingSphere","../Core/buildModuleUrl","../Core/Cartesian3","../Core/Cartographic","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/Ellipsoid","../Core/EllipsoidTerrainProvider","../Core/Event","../Core/IntersectionTests","../Core/loadImage","../Core/Ray","../Core/Rectangle","../Renderer/ShaderSource","../Renderer/Texture","../Shaders/GlobeFS","../Shaders/GlobeVS","../Shaders/GroundAtmosphere","../ThirdParty/when","./GlobeSurfaceShaderSet","./GlobeSurfaceTileProvider","./ImageryLayerCollection","./QuadtreePrimitive","./SceneMode","./ShadowMode"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w,C,b,S,E,T,x,A){"use strict";function P(e){e=n(e,l.WGS84);var r=new c({ellipsoid:e});var i=new E;this._ellipsoid=e;this._imageryLayerCollection=i;this._surfaceShaderSet=new b;this._surfaceShaderSet.baseVertexShaderSource=new v({sources:[w,y]});this._surfaceShaderSet.baseFragmentShaderSource=new v({sources:[g]});this._surface=new T({tileProvider:new S({terrainProvider:r,imageryLayers:i,surfaceShaderSet:this._surfaceShaderSet})});this._terrainProvider=r;this._terrainProviderChanged=new d;this.show=true;this.oceanNormalMapUrl=t("Assets/Textures/waterNormalsSmall.jpg");this._oceanNormalMapUrl=undefined;this.maximumScreenSpaceError=2;this.tileCacheSize=100;this.enableLighting=false;this.lightingFadeOutDistance=65e5;this.lightingFadeInDistance=9e6;this.showWaterEffect=true;this.depthTestAgainstTerrain=false;this.shadows=A.RECEIVE_ONLY;this._oceanNormalMap=undefined;this._zoomedOutOceanSpecularIntensity=.5}o(P.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},imageryLayers:{get:function(){return this._imageryLayerCollection}},baseColor:{get:function(){return this._surface.tileProvider.baseColor},set:function(e){this._surface.tileProvider.baseColor=e}},terrainProvider:{get:function(){return this._terrainProvider},set:function(e){if(e!==this._terrainProvider){this._terrainProvider=e;this._terrainProviderChanged.raiseEvent(e)}}},terrainProviderChanged:{get:function(){return this._terrainProviderChanged}},tileLoadProgressEvent:{get:function(){return this._surface.tileLoadProgressEvent}}});function D(t){return function(r,i){var n=e.distanceSquaredTo(r.pickBoundingSphere,t);var a=e.distanceSquaredTo(i.pickBoundingSphere,t);return n-a}}var M=[];var I={start:0,stop:0};P.prototype.pick=function(t,i,n){if(!a(t)){throw new u("ray is required")}if(!a(i)){throw new u("scene is required")}var o=i.mode;var s=i.mapProjection;var l=M;l.length=0;var c=this._surface._tilesToRender;var d=c.length;var h;var p;for(p=0;p<d;++p){h=c[p];var m=h.data;if(!a(m)){continue}var v=m.pickBoundingSphere;if(o!==x.SCENE3D){e.fromRectangleWithHeights2D(h.rectangle,s,m.minimumHeight,m.maximumHeight,v);r.fromElements(v.center.z,v.center.x,v.center.y,v.center)}else{e.clone(m.boundingSphere3D,v)}var _=f.raySphere(t,v,I);if(a(_)){l.push(m)}}l.sort(D(t.origin));var g;d=l.length;for(p=0;p<d;++p){g=l[p].pick(t,i.mode,i.mapProjection,true,n);if(a(g)){break}}return g};var O=new r;var R=new r;var N=new i;var L=new p;function B(e,t){return m.contains(e.rectangle,t)?e:undefined}P.prototype.getHeight=function(e){if(!a(e)){throw new u("cartographic is required")}var t=this._surface._levelZeroTiles;if(!a(t)){return}var i;var o;var s=t.length;for(o=0;o<s;++o){i=t[o];if(m.contains(i.rectangle,e)){break}}if(!a(i)||!m.contains(i.rectangle,e)){return undefined}while(i.renderable){i=B(i.southwestChild,e)||B(i.southeastChild,e)||B(i.northwestChild,e)||i.northeastChild}while(a(i)&&(!a(i.data)||!a(i.data.pickTerrain))){i=i.parent}if(!a(i)){return undefined}var l=this._surface._tileProvider.tilingScheme.ellipsoid;var c=r.fromRadians(e.longitude,e.latitude,0,l,O);var d=L;var f=l.geodeticSurfaceNormal(c,d.direction);var h=l.getSurfaceNormalIntersectionWithZAxis(c,11500,d.origin);if(!a(h)){var p=Math.min(n(i.data.minimumHeight,0),-11500);var v=r.multiplyByScalar(f,Math.abs(p)+1,R);r.subtract(c,v,d.origin)}var _=i.data.pick(d,undefined,undefined,false,R);if(!a(_)){return undefined}return l.cartesianToCartographic(_,N).height};P.prototype.beginFrame=function(e){if(!this.show){return}var t=this._surface;var r=t.tileProvider;var i=this.terrainProvider;var n=this.showWaterEffect&&i.ready&&i.hasWaterMask;if(n&&this.oceanNormalMapUrl!==this._oceanNormalMapUrl){var o=this.oceanNormalMapUrl;this._oceanNormalMapUrl=o;if(a(o)){var s=this;C(h(o),function(t){if(o!==s.oceanNormalMapUrl){return}s._oceanNormalMap=s._oceanNormalMap&&s._oceanNormalMap.destroy();s._oceanNormalMap=new _({context:e.context,source:t})})}else{this._oceanNormalMap=this._oceanNormalMap&&this._oceanNormalMap.destroy()}}var u=e.mode;var l=e.passes;if(l.render){if(u===x.SCENE3D){this._zoomedOutOceanSpecularIntensity=.5}else{this._zoomedOutOceanSpecularIntensity=0}t.maximumScreenSpaceError=this.maximumScreenSpaceError;t.tileCacheSize=this.tileCacheSize;r.terrainProvider=this.terrainProvider;r.lightingFadeOutDistance=this.lightingFadeOutDistance;r.lightingFadeInDistance=this.lightingFadeInDistance;r.zoomedOutOceanSpecularIntensity=this._zoomedOutOceanSpecularIntensity;r.hasWaterMask=n;r.oceanNormalMap=this._oceanNormalMap;r.enableLighting=this.enableLighting;r.shadows=this.shadows;t.beginFrame(e)}};P.prototype.update=function(e){if(!this.show){return}var t=this._surface;var r=e.passes;if(r.render){t.update(e)}if(r.pick){t.update(e)}};P.prototype.endFrame=function(e){if(!this.show){return}if(e.passes.render){this._surface.endFrame(e)}};P.prototype.isDestroyed=function(){return false};P.prototype.destroy=function(){this._surfaceShaderSet=this._surfaceShaderSet&&this._surfaceShaderSet.destroy();this._surface=this._surface&&this._surface.destroy();this._oceanNormalMap=this._oceanNormalMap&&this._oceanNormalMap.destroy();return s(this)};return P});define("Shaders/PostProcessFilters/PassThrough",[],function(){"use strict";return"uniform sampler2D u_texture;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\ngl_FragColor = texture2D(u_texture, v_textureCoordinates);\n}\n"});define("Scene/GlobeDepth",["../Core/BoundingRectangle","../Core/Color","../Core/defined","../Core/destroyObject","../Core/PixelFormat","../Renderer/ClearCommand","../Renderer/Framebuffer","../Renderer/PixelDatatype","../Renderer/RenderState","../Renderer/Texture","../Shaders/PostProcessFilters/PassThrough"],function(e,t,r,i,n,a,o,s,u,l,c){"use strict";function d(){this._colorTexture=undefined;this._depthStencilTexture=undefined;this._globeDepthTexture=undefined;this.framebuffer=undefined;this._copyDepthFramebuffer=undefined;this._clearColorCommand=undefined;this._copyColorCommand=undefined;this._copyDepthCommand=undefined;this._viewport=new e;this._rs=undefined;this._debugGlobeDepthViewportCommand=undefined}function f(e,t,i){if(!r(e._debugGlobeDepthViewportCommand)){var n="uniform sampler2D u_texture;\n"+"varying vec2 v_textureCoordinates;\n"+"void main()\n"+"{\n"+"    float z_window = czm_unpackDepth(texture2D(u_texture, v_textureCoordinates));\n"+"    float n_range = czm_depthRange.near;\n"+"    float f_range = czm_depthRange.far;\n"+"    float z_ndc = (2.0 * z_window - n_range - f_range) / (f_range - n_range);\n"+"    float scale = pow(z_ndc * 0.5 + 0.5, 8.0);\n"+"    gl_FragColor = vec4(mix(vec3(0.0), vec3(1.0), scale), 1.0);\n"+"}\n";e._debugGlobeDepthViewportCommand=t.createViewportQuadCommand(n,{uniformMap:{u_texture:function(){return e._globeDepthTexture}},owner:e})}e._debugGlobeDepthViewportCommand.execute(t,i)}function h(e){e._colorTexture=e._colorTexture&&!e._colorTexture.isDestroyed()&&e._colorTexture.destroy();e._depthStencilTexture=e._depthStencilTexture&&!e._depthStencilTexture.isDestroyed()&&e._depthStencilTexture.destroy();e._globeDepthTexture=e._globeDepthTexture&&!e._globeDepthTexture.isDestroyed()&&e._globeDepthTexture.destroy()}function p(e){e.framebuffer=e.framebuffer&&!e.framebuffer.isDestroyed()&&e.framebuffer.destroy();e._copyDepthFramebuffer=e._copyDepthFramebuffer&&!e._copyDepthFramebuffer.isDestroyed()&&e._copyDepthFramebuffer.destroy()}function m(e,t,r,i){e._colorTexture=new l({context:t,width:r,height:i,pixelFormat:n.RGBA,pixelDatatype:s.UNSIGNED_BYTE});e._depthStencilTexture=new l({context:t,width:r,height:i,pixelFormat:n.DEPTH_STENCIL,pixelDatatype:s.UNSIGNED_INT_24_8});e._globeDepthTexture=new l({context:t,width:r,height:i,pixelFormat:n.RGBA,pixelDatatype:s.UNSIGNED_BYTE})}function v(e,t,r,i){e.framebuffer=new o({context:t,colorTextures:[e._colorTexture],depthStencilTexture:e._depthStencilTexture,destroyAttachments:false});e._copyDepthFramebuffer=new o({context:t,colorTextures:[e._globeDepthTexture],destroyAttachments:false})}function _(e,t,i,n){var a=e._colorTexture;var o=!r(a)||a.width!==i||a.height!==n;if(!r(e.framebuffer)||o){h(e);p(e);m(e,t,i,n);v(e,t,i,n)}}function g(i,n,o,s){i._viewport.width=o;i._viewport.height=s;if(!r(i._rs)||!e.equals(i._viewport,i._rs.viewport)){i._rs=u.fromCache({viewport:i._viewport})}if(!r(i._copyDepthCommand)){var l="uniform sampler2D u_texture;\n"+"varying vec2 v_textureCoordinates;\n"+"void main()\n"+"{\n"+"    gl_FragColor = czm_packDepth(texture2D(u_texture, v_textureCoordinates).r);\n"+"}\n";i._copyDepthCommand=n.createViewportQuadCommand(l,{uniformMap:{u_texture:function(){return i._depthStencilTexture}},owner:i})}i._copyDepthCommand.framebuffer=i._copyDepthFramebuffer;if(!r(i._copyColorCommand)){i._copyColorCommand=n.createViewportQuadCommand(c,{uniformMap:{u_texture:function(){return i._colorTexture}},owner:i})}i._copyDepthCommand.renderState=i._rs;i._copyColorCommand.renderState=i._rs;if(!r(i._clearColorCommand)){i._clearColorCommand=new a({color:new t(0,0,0,0),stencil:0,owner:i})}i._clearColorCommand.framebuffer=i.framebuffer}d.prototype.executeDebugGlobeDepth=function(e,t){f(this,e,t)};d.prototype.update=function(e){var t=e.drawingBufferWidth;var r=e.drawingBufferHeight;_(this,e,t,r);g(this,e,t,r);e.uniformState.globeDepthTexture=undefined};d.prototype.executeCopyDepth=function(e,t){if(r(this._copyDepthCommand)){this._copyDepthCommand.execute(e,t);e.uniformState.globeDepthTexture=this._globeDepthTexture}};d.prototype.executeCopyColor=function(e,t){if(r(this._copyColorCommand)){this._copyColorCommand.execute(e,t)}};d.prototype.clear=function(e,i,n){var a=this._clearColorCommand;if(r(a)){t.clone(n,a.color);a.execute(e,i)}};d.prototype.isDestroyed=function(){return false};d.prototype.destroy=function(){h(this);p(this);if(r(this._copyColorCommand)){this._copyColorCommand.shaderProgram=this._copyColorCommand.shaderProgram.destroy()}if(r(this._copyDepthCommand)){this._copyDepthCommand.shaderProgram=this._copyDepthCommand.shaderProgram.destroy()}var e=this._debugGlobeDepthViewportCommand;if(r(e)){e.shaderProgram=e.shaderProgram.destroy()}return i(this)};return d});define("Scene/GoogleEarthImageryProvider",["../Core/Credit","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/GeographicTilingScheme","../Core/loadText","../Core/Rectangle","../Core/RequestScheduler","../Core/RuntimeError","../Core/TileProviderError","../Core/WebMercatorTilingScheme","../ThirdParty/when","./ImageryProvider"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p){"use strict";function m(i){i=t(i,{});if(!r(i.url)){throw new n("options.url is required.")}if(!r(i.channel)){throw new n("options.channel is required.")}this._url=i.url;this._path=t(i.path,"/default_map");this._tileDiscardPolicy=i.tileDiscardPolicy;this._proxy=i.proxy;this._channel=i.channel;this._requestType="ImageryMaps";this._credit=new e("Google Imagery",m._logoData,"http://www.google.com/enterprise/mapsearth/products/earthenterprise.html");this.defaultGamma=1.9;this._tilingScheme=undefined;this._version=undefined;this._tileWidth=256;this._tileHeight=256;this._maximumLevel=i.maximumLevel;this._imageUrlTemplate=this._url+this._path+"/query?request={request}&channel={channel}&version={version}&x={x}&y={y}&z={zoom}";this._errorEvent=new a;this._ready=false;this._readyPromise=h.defer();var p=this._url+this._path+"/query?request=Json&vars=geeServerDefs&is2d=t";var v=this;var _;function g(e){var t;try{t=JSON.parse(e)}catch(r){t=JSON.parse(e.replace(/([\[\{,])[\n\r ]*([A-Za-z0-9]+)[\n\r ]*:/g,'$1"$2":'))}var n;for(var a=0;a<t.layers.length;a++){if(t.layers[a].id===v._channel){n=t.layers[a];break}}var s;if(!r(n)){s="Could not find layer with channel (id) of "+v._channel+".";_=d.handleError(_,v,v._errorEvent,s,undefined,undefined,undefined,w);throw new c(s)}if(!r(n.version)){s="Could not find a version in channel (id) "+v._channel+".";_=d.handleError(_,v,v._errorEvent,s,undefined,undefined,undefined,w);throw new c(s)}v._version=n.version;if(r(t.projection)&&t.projection==="flat"){v._tilingScheme=new o({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:2,rectangle:new u(-Math.PI,-Math.PI,Math.PI,Math.PI),ellipsoid:i.ellipsoid})}else if(!r(t.projection)||t.projection==="mercator"){v._tilingScheme=new f({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:2,ellipsoid:i.ellipsoid})}else{s="Unsupported projection "+t.projection+".";_=d.handleError(_,v,v._errorEvent,s,undefined,undefined,undefined,w);throw new c(s)}v._imageUrlTemplate=v._imageUrlTemplate.replace("{request}",v._requestType).replace("{channel}",v._channel).replace("{version}",v._version);v._ready=true;v._readyPromise.resolve(true);d.handleSuccess(_)}function y(e){var t="An error occurred while accessing "+p+".";_=d.handleError(_,v,v._errorEvent,t,undefined,undefined,undefined,w);v._readyPromise.reject(new c(t))}function w(){var e=!r(v._proxy)?p:v._proxy.getURL(p);var t=l.request(e,s);h(t,g,y)}w()}i(m.prototype,{url:{get:function(){return this._url}},path:{get:function(){return this._path}},proxy:{get:function(){return this._proxy}},channel:{get:function(){return this._channel}},tileWidth:{get:function(){if(!this._ready){throw new n("tileWidth must not be called before the imagery provider is ready.")}return this._tileWidth}},tileHeight:{get:function(){if(!this._ready){throw new n("tileHeight must not be called before the imagery provider is ready.")}return this._tileHeight}},maximumLevel:{get:function(){if(!this._ready){throw new n("maximumLevel must not be called before the imagery provider is ready.")}return this._maximumLevel}},minimumLevel:{get:function(){if(!this._ready){throw new n("minimumLevel must not be called before the imagery provider is ready.")}return 0}},tilingScheme:{get:function(){if(!this._ready){throw new n("tilingScheme must not be called before the imagery provider is ready.")}return this._tilingScheme}},version:{get:function(){if(!this._ready){throw new n("version must not be called before the imagery provider is ready.")}return this._version}},requestType:{get:function(){if(!this._ready){throw new n("requestType must not be called before the imagery provider is ready.")}return this._requestType}},rectangle:{get:function(){if(!this._ready){throw new n("rectangle must not be called before the imagery provider is ready.")}return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){if(!this._ready){throw new n("tileDiscardPolicy must not be called before the imagery provider is ready.")}return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return true}}});m.prototype.getTileCredits=function(e,t,r){return undefined};m.prototype.requestImage=function(e,t,r,i){if(!this._ready){throw new n("requestImage must not be called before the imagery provider is ready.")}var a=v(this,e,t,r);return p.loadImage(this,a,i)};m.prototype.pickFeatures=function(e,t,r,i,n){return undefined}
;m._logoData="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALQAAAAnCAYAAACmP2LfAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsIAAA7CARUoSoAAAAAHdElNRQfcDB4TJDr1mp5kAAAAGnRFWHRTb2Z0d2FyZQBQYWludC5ORVQgdjMuNS4xMDD0cqEAAB1zSURBVHhe7ZwHeFTFFsf/u+l9N70npOxuSAKEFFIhCSH0qhEQUHkgKCgWUFGBB6IoCAoo0ntooaRvEkIIBBBpoYSa3nvvfd+5u4sQUigPfMX8v2/Y3Tkzs3fv/d0z58zcgF69Ql1SY+MM1wQJem44ZeiJk8beEOqPwG6uC7ZqyElb9eo/JZEIkH2nRQkBIlNMauuPCS3uGN/kjkmNDghoskBAgzrZ2NLmf1+JwIKQpYsoxdmIV9+N07onCegzBPM9bOdmYKnazF6g/1N6UySPqSJzvCaaiLHtP8G/Phq+FRfgU5ogKWUXMLT6Mvzqr2BE40mMadqO8c3zMabBC6PqDDC8SlY60t9HByCLVTKu+ERmHr5TWI9wjVxEaOZivWo1pil8D1tZeWnLXv1l8iZ3PF2kjymiWRgvCoJv5U243IyAXcQq8A9Mg9W+4bDe6wv+kVGwCZkL+4Sf4ZR+BZ5VGQR3EkbWn8Hopm3wq54Lz2JD6ah/P21XGopQ9Qoc16jGSqVyTJWbQbUsibFXf42mihTwZpsvAtp3k0dOhFOSEH1+ngaDefrgjFCgFkxY8fCisCBvKgODzxRh9qslBFGfYmDGLbiV5mBwRRo8KtPhVBgPu8teMP7u73chD6kMRYRGBY5xqrFKqQwz5SdTbS/Qf5mmUYw8rf01CjHC4VP7AHZxO6E3qy9ZZCQNnio2rE/4o9/tkxiQUYp+KRXgx8XC5FsXcLz/hkCrDUU4pxLHuDVYpdwL9F+qqSJZKlPwenskfOoI5tN7YPCJGVme7wKYr5EBXzgYfW+mwTI0Gjrznaj2WW+I/y8dVPdDGLcKRzXrsEqlHO8oTKHaXqAZWe9hQXCi63NhHWYI3ilfWIW/YLjqL2JRiOFBJRz+LffhcPs09D+0J8vzn3zXdBnYnp8Mi6NboTWzH9X8fVc+DhDQodxqAroe36lU9AJNWr4cEAjNwI8OAC9cT1rbUfzwGeCfKiL7dGnNc+q1NiO80b4BY1oT4V6WDcsdc6j2xbyq4wMWrA9rQmeWFn36ey/jBaoPQ4hmLYI0G/AtAf22fC/QDols8ITrIYi/Bl6knbS2o3gRbxHQxQQ0k0S/gCa2v4OJovPwacqAQ1ICjL40klr+UrWoQbFBETo18jCpZsOoFODkvuCNJYoHW3QKXFEM7ETRcKfiQe8d6NVIFImXvg4skhY40mxnQYVRIIeA1qrHEc1GrFSpxFtP99AiFbDbNKDZpAzzGkVYVcvBuBJQEo/9/6C+dyjPitwLwak74D8V6Bfw0P5VShjXFoTR7TfhUZkL29M/wfATJan1lauWC3aDOgyaVDCuTgbf1bFkfmtkye1ogsK2asivLYfCglIoD8qCknI2NHuG4QSVGMgQyMbt0fioRYh9VYcRU7QX55uDcaHtFOJEsThMtmWtQgxsDodsWaC0c3ea3MzGBJEqxrfbYmzr6xjfPAeTmt5HQPO7eK1xDibUz8eY+k8xtHYJPCtXwvHOu7AXMrMTsF/TH8HajTis1YwVqpWY0TXQDKy1OpBr5EJA52Fukxx+bmKxtjWx2DuaWawNlZD5qhzyo9KhpHAbKpJO/6t65UCPbPHA2PYrGNacgkElabCJJDev/MpDhUKKnuq44LRoYEK1IiswkS1zYCfk5y+F0qjvoTwqBOof34dGeAnUL1ZCLboEnJ9zoe0QD/Nuj00UBVXRabzVLETM3S0ICfwA8yc7Y6C3ANYbZsA7aQ1W1xzEfZEQ6dT2BkG9pP4ouo7jGE1u42JS20QMrzkCr4xwuN4+AM+cYII3EaNar2J86zmMrP8DHulCON4NhU3YWuhOYy6SZENpH9cfx7WacFC7BSvUqjBDsRPQIiugURvazeqYVaqAw6dYrJ9WQy7gayj4nYDy3HtQOVQGpYRqKEWXQf2HdGha/AFdae9Xr4czz0ubISRA75ECbSut7agegO75OLxpahze8j5GtifBpzEDLiV30Dd2mNT6StWiCbVmLt5rUkBQCEt2zWzIMSA8HgrIBkLD+Sp0jhHISYXQ/KMYukfvQ3fQxq68XCTBHId/tMTg7LV1CFs4BszJ6hBarBgHlcRv8H7tbuSKQpFPYGe0BmND+nZ0npECaPKf0r4UIxsuoF/IMpitsAVnrA4s15uh3x8fwLXkLobUZGJIXTqcUzbDaJE5FAVq0t4S7dEcjqMEc6B2K5arVWN6Z6AbdOmm5mJelQKOHWSxF44Cy4CqxW0s6RwchCovFRohdGNfLgX3WiZ0N4aD++y7jfwYJUrAPCle/ZjKV+BFTSegrGAZIm3QjXhBytTWB3zhByzryMUU986jz16wD+96ijCNUIAgmkc3tS6G7GERjCbgR82B4OTbEESqIiCIcqsIYzoGGyrBEMSmgh8xBoIIAR2fAHZhj8Z9DOhl9FHeKkSDvn809fuc+iyCddRYaiOZBTvIt1YJfs0b4N+WDO+GHPLQN2Ab7S61vjJV60C9SRPvNSqzTpxlyQfS1dGUmjppK7gW16B/LhN6abnQu5cDwzO3YNhhqqK4WJY887sEdGzWFpxfOxmDpKZOOvgWFB8sx9L6nShvP4FyUQjKGg5gScpGKEqbUE7RxiGYv6QQ4zIG/r4D2m88sjEy/EIW/a6+TQ4gHe5VhXCvy4JL7gLYnesI2i6t4Tii04r92u1YKt767gB0ozrkGzmY26zEOh7Hkt+kAKhLTX9qOVVdg9aoNOjcToR+wUVKLYKgN0Zq7l7884wn9CKgr4AfWw/B6SwqKQRKOdXVghe9CpbherASSjtIpGpxRIHFjwygNreoXy0lb+lU7lHJBP9kPcGXQnBNghUB/Lh44fbUp5JA+5Hs71LbPPLCVRDEJZDNGIJgeQI6mG6KegKzldq1U7tGKjQmHR8vwl86kgRoAQN0xBw6ztn0nQ/ocxEdQ7L4d/BjG6g+m8aZTL/xsXPuW82Fb8t+DG1Ox5D6XAwqvQ67OA+p9ZWoUQPsei78mjSwNU9GLmEzVGZJTd3qFPTn3YZhXgYMMjNhlHsDxms/hNWfoUdrNPgEc2h7BG5d/Bo7Blt0BuNxXf4MVmXrkdRyEHWiY6hr2oc7mevRX2wc18gioEeI1+N9a+/CNnImVAZ0mhEoNOPAJT8MHjUF8KTiWhqHgbfMpVaJdhLQh3XasU9bJAZ6ekeg6zQwgEKuLSWysmd3QGmatLqD8qDNug3dCX/AIPk4jGr2wDB/JXTmkan70IvmZTY/rB9BdZlKLkG0lG0d5klAObKsw1+jzyFiWPnRawiaDrMYwTyMwMwh220WP2IWFVfqN4CKO8E3n0C6R/ZUej9Y2kUiMdDRFTRePH3nA3q/m7xpAEtAXl0QrkTwscnmS/3eptdzNEYevZLnZ5booqk8tuYs9tAny+n1LL1mghezlcULH0VtHamOZhvhIvoNOXQsd2EZIbluYnlWaMO75TCFG9kYXJ8H14o76H/10Z3yClSrCm6jGtbWK7LC7kIlYRfUmY2XHnUa+mbXYRSfCuNCptyE6b1jMBD/EPKwchQPLxGdxOWWI8iKXYBPqLozgI8pfA5YBWvxbfMeNLUfRmPTLjRnr8YKsdGvRQ5j2zZTSSRQ78H+7GhxfScFAINypsG9ukDspZ0LKKE+O0pqlGi71ggcIqD3dga6RhFKjSqYT+VEFkvu/E9Q+HNWKaE2VVDgVkPFqwAaay5CN3En9M59BM2vfKDs7AvljjPGE5LlharQdL+LoCmhOHU0rIUyD+NgVTOa+q2iVQiIcAKpHtbhXuJOjPqeVCRYThNE6VTvKNs3hM3cHGIxntxKyCbP7Erj1lHZJbVIJAG6iiCroZCAPGukvOyASJbvCgoaAoKoAQ1kHcGC7nmZDkmhBR2PfSQLtkcl4zCSAE2eO6qExYuYxrE4KqdvelBiM4+ncYQy1IY8d0wbhUSLJAZGbsUceNYdwJCGPAyuy4NbZToG3JoO1Qk9AvHvqF4ejo0KCKlisyl04Jw+AE1ma71HRUJP+QqM1t2HcVEyTEoSYVYQCuN3HenCt4XDhGA+KorAnYZ9KIj5ELOl3XpU/k/wrt+OmraDaG7cjpacbxFvYAAZDG5Vw/DWCxjRdp+ATsWAS6+D69H1+XDNsoVb1T06b0VwzCmBIOYdqUWibTojcFBH1CXQctBtUcA6Oh/RmVC4sBmKA5j6erC1qqE4sRpqG25A43QIOHuXgvOmP5R4ZH6m5UY2L9SSLjZ5sKjjsI/o8olH8ngjCZoSgmw9DMIl3t42Up0g+pq89/sEjLK47knZhSkSuDepJP4JOyNJyEFAR8VQKMOR1nbWM69yxNJYwh+VLE90ffPyxLE3EwL9Jq0huWQqwL1iA7zq8+FVl0+epgBO6T+gb2TH+OglqgastxtZrNNlkLt8E5oJx6HZdab7mFZBk3UZRjMewCT7HkzLfodZxREYr5sBjiIBPYiAPt8ehvSGPSg5vwjzpd16VNkmmDTswp22QDTXbkJrxhJkzHGDFoUQmvBpvo2hrZl0TnLhlLIYfUO7nt7dSg3hURcP1/JiDEgphuXBqVKLRFsfA3oJAf3mI6Cr2OjTwGYdqWGzzmZD6WoYVCfehdqsZKjuuwS1oB1Q+5piHac3oaxBzZ9vLZ4nHEeesoXg6niDPSYWP9yUgD5PHu48eKE64krHcErchHIEuRysTpAXjObQWIYEHiV4EQYEojp5aEoyY+IIpOQugKYYOnIdJXrdJ63PtWwXMQM6m6SVT4gfZkbHV0XHsVtaQ3K8yoJr0YfwoHDDq5ZiQSqDik/B4Q9taYtn18gyNia1qGJsmTrGlUjK2FJ1jCjRwOASDnkxDvN95ZD/og5yl0qgfCMJ2leDoeksHaFHXYOJVyrMkm/DrPwMzGr2wmjnLGipthyHL0W7t9pDkduwF2U3lmGFtvbTdyirt0OreT+iWwPRUrUBbSkLkT/fCUZwKVYikBMwpDlPXNzLwuAQ2rWX8KzUh2dDDJyLSmB7/S5Mf3WRWiR6CPSezkCXQs6qBnLCKsheyoXqnTCoL9oOFd9/Qtl9KJT6UJMX3/zhCz8iuCjhiviSYtMx3ZTJBN8lCE7eIRgF0p6krRRaRBDskTTGySBKws5SuUjJHYUiMQdpzCUE0Q3y5MnSDhJJQg5JUvjSgO5hHZofaioGmvc40IycMgbRtJktjgOZ5Ma9irzSg46xYHcaVEZevkgBHqUWGFK+FENKQ+BdGAq/wiMYWbwHI6h4FwTDOes0BMKFMHxPNg9qn1dANakYanfuQSs5FJoTpaP1qBswsSGgb9+EeUU0Af0LDH4dBhXlmv3wajuOpPYQFDcEojxtNQ6sn9ZzUsiofjfUWg/iYOt+tJatRtvN95DqZgxNuKTKwLV4Jdyqc8Wz1uCGTLjmDIVDQqewQ8anwpJi6GsYkF4Ey2O/QvsfXKlJIgboAwT07s5AZ0G1TylUIsuhdKMI6vcuQ3PVAqg+9UZ8JvGEywiuNoIwD4IzaV2X+HSa1otgE3+NwJImVkycG0kx8snfyUZJW+QFApeSu+hN9BpIn6n+ZBp9bqDv+C8Fum+8IpzzJNOmR3UhTaGFcC07iAHXmamuZw28C/S/aIt+CcthF7+ToN0EQdhqOFzcBu/Sm/ApvAGX3DzYXIiF9jtWTJf74L6ZC83UfGg8SId2xnloSZKxp+gWjC0J6KSrMK8KhmnlSugtInpkCzaBV78Hl5oPoaLpECrLt+Bi4jfgS7t1q+YDUGsPwj5KDFsLlqD97JuIpmpZmP+TftM1ezjlxsOllM4H3eReDWHwKrOBW84jqMeK5OBTv4Bu6HxxgqU1s/N3MkAHSoH+ioCe+gjoJHB0s8ENLID6/UJo3E+GVlwoNEwY278tXhR50RhmeexzgmM8JXjdF36MHwEoiXn70Csv6gxBm8PiRc6gJFD1HDzFpq1cP0omo5QJZAfqQzH0f6uHZjQgeR4cC/IJZCnUtSkYVPAWBiX2/CdU/S7Ql+9TgtFCTaiP0qAEXA2yRsqwuzECziWZcM4tgv2DSljF7ID+l+JNh9+hY38HuvcYmLOhk5EEnVPfQOmpW+33YGaXhj53E2BWuxvGebOh5cPUX/sWSgXrsa9mB2qaDqCK4C7I2IA3jn8u7tat2g6D034MIbWb0fZgHlr2DscXUhNNuYdkYRPrg/7JiXDMLYBrZS6GNEZgVJM/JjWY4I16G4xr/BCDq2nKjjoAvY+Zpwo7eXBskQK9Swr0lEdAn4a2wk3o/DMNWmn54KYUQIuZsebGQuXFQ42H4kfNk4QckSOkNZ1lGkGAUoInOKkAm2jJsVtH+om9Nj9ytZxNcNdhljXByo+JJXj/i4G2u2xM02YInPJLxFB7VudTPH0ZHkWu0hbPpwHpfnAszoFDVgVsb1fDMmoL9L8S7wTFQE/1AvR33oB+QSp0czKgl34B2iO9uwJCKib5SGaZjbqLPlkhMG1YDr1gQyioSs24vQTDitagsnIL6loCUVu9C2EJK9FjYtsWBNP2Q7hb9A155zdwY5mTeGexo0w32hEcy2F7JQaOqZfgk38KY6rDMKFBiGHNt+iGPgCNYd0/s/sbAb2fgN5JQC9Wq8bkR0AzioOOx3Xo30mGbnY+tNMKoJOQCm03qfnFxRf6E1yUFAqZJcyuZRWuQmB+TWHJcgJfkjPxImcSSIUsXviMx/O9DvqfALrPDjb6nhuBAWkZ5JFKKTYuIqhz4FUdAo9CGwzO7Ra2LjUg0w9OxdlwyKxAXzHQm8lDi4HeAT1WMPSHnYXR7aswKE6Gfl4K9PdfgZ6+uG8XSmMbKyXD/LsEmFduglH2NHA7rA3Hvg+Ve1/gYO4KNFRvQUPLQVRU7MG4yn1dJ4eiULAo3JhW9xsa77+Hml8GY8FQ425uAM5wRRivNoPlTjs4XhoH35oLGFZ/S/wglyDkbWmrrsUAvY+A3kHlSwJ6ihKzCvLnuQyElmIs9LdfhmHxA+jn5kI3jcrRFOjxU6DTbTx9DybsOBh0f034EeYEVyaFD0IYhnQ9y1pTIsiPvU5AnKYkUBL78yKmQhDLgDRPSWtPp/HFkFtHqFCfRBr73wX67qsD+qFsEubCnqKBAZllcCkkT12RjSHVMfApH0bJXfcH+aQGZg6FU1EWeeoK2NwgoMM3Q++zP/fq/Smf2g392ZEwzk2Acfl9GBHURmuSYPyn132oHBizH8B8wjX0SadQI2cWtOZZQbHTdEgRn8XN93EiczFayn5GU3Mg7lJMPab5SEeoCWZZ0TF4Ne/A/ZSPUbXdDz9Qdddrrk/KtcwR7jX34VXDzGCFGFT0GzyLu922x069kdiv145tOu34jlOHBWoz4arUAZQt0LYOhmFcHJ2H6zAsYnZDc2FwKhv60+m9UQrLUJ4hSYQAVhpM1O6jj30EDD33Q6frZyoY8cMVaWZZR560kuB5V9H6iVUas+Py5L1/IHsT2ZldR4nEkMdkUd8Y8tYd43mLIMhYhenDWvgjQSQiGFOkiEv0rEAzK2u8yG10M2WwBWFdb6q9NKDNd6rCOuYD9L2VI/57QMfcEniU5cCnJgG+lR9haAnz4MzT5ZjmA4e8HBqnGtYXamF+nK7bpx0uwHxoqGyE3sKD5HHjYVJ1C6Z5qTD5Ph2G1hnQEV/0LBhxU2E+4yYsbgTCJGsuNBfYQrnjA0CPxDo2CRYJ0xGesgD1ZWvQ3LQbKeSJ54uC0UcUDVVRGExFR/FB2y7cSf4C+Zv9sXSUeQ9P2z2pQdnmBHQsPKqKqFCyWJsM75o1GMw8O/iEhFZs/KK9CD9wRfhCTYTP1dqwnBOHrQYz8IuuH5ZxxI/MLQZH5kfoeu6D4cVQGNecgXHFbRgXZsD4Xg5MjqfDeE0KTBbRDLXsLiwOR8HkxCJoOs+Eavdr08ZBBGdYP7rYzAZILsH3LYUYtgSsAXlYRwLqW0r8Ksl2id4/Onaz47IE+kayUfwddYhsgwkqXRrLgOpHEuyhVF9B7ytoTAL//qNjeFagGfGEi5nvYPEifqOx/ek4p1J/8aKBWC8N6Icy2+oL6zOhECTmw46SuoHZpXBn/pK7/DK8K1bCp3Q0vAv7wqfIBD55OuS9teFVYASPfAFccseThw+E4Ho5LOMqYB6ZCeOdK6H1bleJH2sOOPZradqlC3otDqY5F2GafQmmCZdgFnMBZteEML2yCnprh0CZWVp66gbDuD5Q2uSLUacm43jSB0gq+h55JeuRX7wRqUUbkJL8DS4GTcPqCdZgduZ6XiZjgvcp9fIY3aAH/yY+3KvcMDBjLSXQBXDML4VbaQG8a9PgUxcOzyIneKY/Or6FHDO8q7INY+RiMFJaJijE4i2VeEylej/FDs99TAPH8Dvofv8bDK/vhVHxMRhX0W+vOgXTijiY5UXANGkNnYeRUGN2VrsPNx6XVaQNgRNM03sBgUjeOKJJ/Cr+LNzFsg61YB5/elyKtic0qM031CaZAG0gqJnVEuYBIoI49gy9D6DXrQR3GoU2j3YE+WE2FI9TGBG1FLywnhNbPt1Y/OhY+o5iGqsGNmdLaVxfqZUB+g0Iztwi2AOkNZ3FCzOm30bHeHK9tKYHKfPZMFhlAtM9c2EpjALv93zY3qlE/8xyOOUVUTiSBrfy83CvDIdbRZC4uJSGwzHzd0qgkmEVfRnGW/dC79vPobtkFLRmm0HDpVt43MnrzoOm/dfQeeOf0P3wB+guJogXrIDuhHfAsdOFbKdQ5GkaYQbNNYNht2c8/AOnYNKB6Ri//Q14zRwIuohdPC76pCbWKGFCkx9GNC7B0NZD8CiJh8Odi7A59zud7EuwvU4hVUYZBhUXwqsqA56V0RiUM1Dam36UoiyFuprQhc6fRZuKKhV5+rcLKD2hrPQ+NPsvgNb0j6C9eCG0v/kU2l9/BK0ZM8EdRJQ833noG8Qib6lDkA0lYD6i8GIJlffZ/IhhbJtQjW4TP164EiWWztTnH9T+a4L/MxpjAn02hWWYDAQnefSZzm7Io7zDOpiSzGh3grwPwd3zDccPZdH4phBEkXcWBrD4wlE07qObw5pmBUGsK43T/YPfgmAFWEe5U2EeCXhGcV5nQ3u2KrTf6w+jdTNhtud7mB/ZC4vg43QAwbAMDYLF0e3os+8HGP80D7oLx0F9dD+oj9AGZ4Y85K0Yj/Vs3kQiFgeybFPIySiDzdwAz9O3JzHjPNtYk8gjv948FOOatlGodR0Dk07Bau9n0F8wFBp+luBO1CXeuDD51Q3830PRP7UIzgUlcC0vhHPRSdic6eI53ecT3W0sKyjI2EFRxhzyz3sOO8voBkEUTclYhAyshCwr642PR79diwlbBOEs8vLMFjgbbuelhpeoz5rEDxsNNl/+9ON5RWJOLsXCysQdh5IhWWbzhUmoel6v/l/RxGpZTKgbh3EtEZQMp5AX2ASd2f3AVu7695ky/7nOuc2U/BZSCFIGp+I82F/rfprsVa/+Mk0sZ2F0tTvGNZ+gRO8B7C/HQ92beWine+/IDWDBbJUmbBN/hUNOGRyyStH34vfQeP3ZV4R61atXIu9Kefg1rIB/XRJciwso9nymLXmxbP+wxcCsVAxIKwfv1AZoDH96jN6rXr1SuVeowKsuFINrs+BSXATbc59JLU/XwCwdDMw7B/vUEpgHfQYZ7v9HCNar/2E55ynDpSwYrhXF4uKUeQiY0/Oy3kM555nCITcJgmvp0F30Yo8L9KpXL1X9E2XhkPoVBuYWwbmolKDOhmv+WHiXyGNkgbTRE1pOublXkRycCz+AfUoRzPdsgKJN1w/19KpXf7n6xlnCPikE/SkWdswrozDkNoZUfIWhFTYYWaPy4a6NkgSR2XAZXSOLIWUWcCv7FP1T7sH8wFZwp7ycxz971auXIm4AG+b77MFLEKLv7ULJMy0FefCsPAOv0t0YUrIMg0s+gVfxYrgVbIJLUSzsrl2F2ZZl4L7J/Pdp/956ca969UrEna0O41/HwSJ4F3in42Fz5Trsbt5Bv3u30e9uImyvnoV15GGY/LIA6kOZP1966pZ8r3r1n5eqhwZ0F/aB4ToHGK9zh/FPHjD60RE6H1tDaaA2cdy7mvFfI+BffksPNrEksu0AAAAASUVORK5CYII=";function v(e,t,i,n){var a=e._imageUrlTemplate;a=a.replace("{x}",t);a=a.replace("{y}",i);a=a.replace("{zoom}",n+1);var o=e._proxy;if(r(o)){a=o.getURL(a)}return a}return m});define("Scene/GridImageryProvider",["../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/Event","../Core/GeographicTilingScheme","../ThirdParty/when"],function(e,t,r,i,n,a,o){"use strict";var s=new e(1,1,1,.4);var u=new e(0,1,0,.05);var l=new e(0,.5,0,.2);function c(e){e=t(e,t.EMPTY_OBJECT);this._tilingScheme=r(e.tilingScheme)?e.tilingScheme:new a({ellipsoid:e.ellipsoid});this._cells=t(e.cells,8);this._color=t(e.color,s);this._glowColor=t(e.glowColor,u);this._glowWidth=t(e.glowWidth,6);this._backgroundColor=t(e.backgroundColor,l);this._errorEvent=new n;this._tileWidth=t(e.tileWidth,256);this._tileHeight=t(e.tileHeight,256);this._canvasSize=t(e.canvasSize,256);this._canvas=this._createGridCanvas();this._readyPromise=o.resolve(true)}i(c.prototype,{proxy:{get:function(){return undefined}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return undefined}},minimumLevel:{get:function(){return undefined}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){return undefined}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return true}},readyPromise:{get:function(){return this._readyPromise}},credit:{get:function(){return undefined}},hasAlphaChannel:{get:function(){return true}}});c.prototype._drawGrid=function(e){var t=0;var r=this._canvasSize;for(var i=0;i<=this._cells;++i){var n=i/this._cells;var a=1+n*(r-1);e.moveTo(a,t);e.lineTo(a,r);e.moveTo(t,a);e.lineTo(r,a)}e.stroke()};c.prototype._createGridCanvas=function(){var e=document.createElement("canvas");e.width=this._canvasSize;e.height=this._canvasSize;var t=0;var r=this._canvasSize;var i=e.getContext("2d");var n=this._backgroundColor.toCssColorString();i.fillStyle=n;i.fillRect(t,t,r,r);var a=this._glowColor.toCssColorString();i.strokeStyle=a;i.lineWidth=this._glowWidth;i.strokeRect(t,t,r,r);this._drawGrid(i);i.lineWidth=this._glowWidth*.5;i.strokeRect(t,t,r,r);this._drawGrid(i);var o=this._color.toCssColorString();i.strokeStyle=o;i.lineWidth=2;i.strokeRect(t,t,r,r);i.lineWidth=1;this._drawGrid(i);return e};c.prototype.getTileCredits=function(e,t,r){return undefined};c.prototype.requestImage=function(e,t,r,i){return this._canvas};c.prototype.pickFeatures=function(e,t,r,i,n){return undefined};return c});define("Scene/JobScheduler",["../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/getTimestamp","./JobType"],function(e,t,r,i,n){"use strict";function a(e){this._total=e;this.usedThisFrame=0;this.stolenFromMeThisFrame=0;this.starvedThisFrame=false;this.starvedLastFrame=false}t(a.prototype,{total:{get:function(){return this._total}}});function o(t){if(e(t)&&t.length!==n.NUMBER_OF_JOB_TYPES){throw new r("A budget must be specified for each job type; budgets.length should equal JobType.NUMBER_OF_JOB_TYPES.")}var i=new Array(n.NUMBER_OF_JOB_TYPES);i[n.TEXTURE]=new a(e(t)?t[n.TEXTURE]:10);i[n.PROGRAM]=new a(e(t)?t[n.PROGRAM]:10);i[n.BUFFER]=new a(e(t)?t[n.BUFFER]:30);var o=i.length;var s;var u=0;for(s=0;s<o;++s){u+=i[s].total}var l=new Array(o);for(s=0;s<o;++s){l[s]=false}this._totalBudget=u;this._totalUsedThisFrame=0;this._budgets=i;this._executedThisFrame=l}o.getTimestamp=i;t(o.prototype,{totalBudget:{get:function(){return this._totalBudget}}});o.prototype.disableThisFrame=function(){this._totalUsedThisFrame=this._totalBudget};o.prototype.resetBudgets=function(){var e=this._budgets;var t=e.length;for(var r=0;r<t;++r){var i=e[r];i.starvedLastFrame=i.starvedThisFrame;i.starvedThisFrame=false;i.usedThisFrame=0;i.stolenFromMeThisFrame=0}this._totalUsedThisFrame=0};o.prototype.execute=function(e,t){var r=this._budgets;var i=r[t];var n=this._executedThisFrame[t];if(this._totalUsedThisFrame>=this._totalBudget&&n){i.starvedThisFrame=true;return false}var a;if(i.usedThisFrame+i.stolenFromMeThisFrame>=i.total){var s=r.length;for(var u=0;u<s;++u){a=r[u];if(a.usedThisFrame+a.stolenFromMeThisFrame<a.total&&!a.starvedLastFrame){break}}if(u===s&&n){return false}if(n){i.starvedThisFrame=true}}var l=o.getTimestamp();e.execute();var c=o.getTimestamp()-l;this._totalUsedThisFrame+=c;if(a){a.stolenFromMeThisFrame+=c}else{i.usedThisFrame+=c}this._executedThisFrame[t]=true;return true};return o});define("Scene/MapboxImageryProvider",["../Core/Credit","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/MapboxApi","./UrlTemplateImageryProvider"],function(e,t,r,i,n,a,o){"use strict";var s=/\/$/;var u=new e(" Mapbox  OpenStreetMap",undefined,"https://www.mapbox.com/about/maps/");var l=[new e("Improve this map",undefined,"https://www.mapbox.com/map-feedback/")];function c(i){i=t(i,t.EMPTY_OBJECT);var c=i.mapId;if(!r(c)){throw new n("options.mapId is required.")}var d=t(i.url,"https://api.mapbox.com/v4/");this._url=d;this._mapId=c;this._accessToken=a.getAccessToken(i.accessToken);this._accessTokenErrorCredit=a.getErrorCredit(i.key);var f=t(i.format,"png");if(!/\./.test(f)){f="."+f}this._format=f;var h=d;if(!s.test(d)){h+="/"}h+=c+"/{z}/{x}/{y}"+this._format;if(r(this._accessToken)){h+="?access_token="+this._accessToken}if(r(i.credit)){var p=i.credit;if(typeof p==="string"){p=new e(p)}u=p;l.length=0}this._imageryProvider=new o({url:h,proxy:i.proxy,credit:u,ellipsoid:i.ellipsoid,minimumLevel:i.minimumLevel,maximumLevel:i.maximumLevel,rectangle:i.rectangle})}i(c.prototype,{url:{get:function(){return this._url}},ready:{get:function(){return this._imageryProvider.ready}},readyPromise:{get:function(){return this._imageryProvider.readyPromise}},rectangle:{get:function(){return this._imageryProvider.rectangle}},tileWidth:{get:function(){return this._imageryProvider.tileWidth}},tileHeight:{get:function(){return this._imageryProvider.tileHeight}},maximumLevel:{get:function(){return this._imageryProvider.maximumLevel}},minimumLevel:{get:function(){return this._imageryProvider.minimumLevel}},tilingScheme:{get:function(){return this._imageryProvider.tilingScheme}},tileDiscardPolicy:{get:function(){return this._imageryProvider.tileDiscardPolicy}},errorEvent:{get:function(){return this._imageryProvider.errorEvent}},credit:{get:function(){return this._imageryProvider.credit}},proxy:{get:function(){return this._imageryProvider.proxy}},hasAlphaChannel:{get:function(){return this._imageryProvider.hasAlphaChannel}}});c.prototype.getTileCredits=function(e,t,i){var n=l.slice();if(r(this._accessTokenErrorCredit)){n.push(this._accessTokenErrorCredit)}return n};c.prototype.requestImage=function(e,t,r,i){return this._imageryProvider.requestImage(e,t,r,i)};c.prototype.pickFeatures=function(e,t,r,i,n){return this._imageryProvider.pickFeatures(e,t,r,i,n)};return c});define("Scene/Moon",["../Core/buildModuleUrl","../Core/Cartesian3","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/Ellipsoid","../Core/IauOrientationAxes","../Core/Matrix3","../Core/Matrix4","../Core/Simon1994PlanetaryPositions","../Core/Transforms","./EllipsoidPrimitive","./Material"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h){"use strict";function p(t){t=r(t,r.EMPTY_OBJECT);var n=t.textureUrl;if(!i(n)){n=e("Assets/Textures/moonSmall.jpg")}this.show=r(t.show,true);this.textureUrl=n;this._ellipsoid=r(t.ellipsoid,o.MOON);this.onlySunLighting=r(t.onlySunLighting,true);this._ellipsoidPrimitive=new f({radii:this.ellipsoid.radii,material:h.fromType(h.ImageType),depthTestEnabled:false,_owner:this});this._ellipsoidPrimitive.material.translucent=false;this._axes=new s}n(p.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}});var m=new u;var v=new u;var _=new t;var g=[];p.prototype.update=function(e){if(!this.show){return}var t=this._ellipsoidPrimitive;t.material.uniforms.image=this.textureUrl;t.onlySunLighting=this.onlySunLighting;var r=e.time;if(!i(d.computeIcrfToFixedMatrix(r,m))){d.computeTemeToPseudoFixedMatrix(r,m)}var n=this._axes.evaluate(r,v);u.transpose(n,n);u.multiply(m,n,n);var a=c.computeMoonPositionInEarthInertialFrame(r,_);u.multiplyByVector(m,a,a);l.fromRotationTranslation(n,a,t.modelMatrix);var o=e.commandList;e.commandList=g;g.length=0;t.update(e);e.commandList=o;return g.length===1?g[0]:undefined};p.prototype.isDestroyed=function(){return false};p.prototype.destroy=function(){this._ellipsoidPrimitive=this._ellipsoidPrimitive&&this._ellipsoidPrimitive.destroy();return a(this)};return p});define("Scene/NeverTileDiscardPolicy",[],function(){"use strict";function e(e){}e.prototype.isReady=function(){return true};e.prototype.shouldDiscardImage=function(e){return false};return e});define("Shaders/AdjustTranslucentFS",[],function(){"use strict";return"#ifdef MRT\n#extension GL_EXT_draw_buffers : enable\n#endif\nuniform vec4 u_bgColor;\nuniform sampler2D u_depthTexture;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\nif (texture2D(u_depthTexture, v_textureCoordinates).r < 1.0)\n{\n#ifdef MRT\ngl_FragData[0] = u_bgColor;\ngl_FragData[1] = vec4(u_bgColor.a);\n#else\ngl_FragColor = u_bgColor;\n#endif\nreturn;\n}\ndiscard;\n}\n"});define("Shaders/CompositeOITFS",[],function(){"use strict";return"uniform sampler2D u_opaque;\nuniform sampler2D u_accumulation;\nuniform sampler2D u_revealage;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\nvec4 opaque = texture2D(u_opaque, v_textureCoordinates);\nvec4 accum = texture2D(u_accumulation, v_textureCoordinates);\nfloat r = texture2D(u_revealage, v_textureCoordinates).r;\n#ifdef MRT\nvec4 transparent = vec4(accum.rgb / clamp(r, 1e-4, 5e4), accum.a);\n#else\nvec4 transparent = vec4(accum.rgb / clamp(accum.a, 1e-4, 5e4), r);\n#endif\ngl_FragColor = (1.0 - transparent.a) * transparent + transparent.a * opaque;\n}\n"});define("Scene/OIT",["../Core/BoundingRectangle","../Core/Color","../Core/defined","../Core/destroyObject","../Core/PixelFormat","../Core/WebGLConstants","../Renderer/ClearCommand","../Renderer/DrawCommand","../Renderer/Framebuffer","../Renderer/PixelDatatype","../Renderer/RenderState","../Renderer/ShaderSource","../Renderer/Texture","../Shaders/AdjustTranslucentFS","../Shaders/CompositeOITFS","./BlendEquation","./BlendFunction"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v){"use strict";function _(r){this._translucentMultipassSupport=false;this._translucentMRTSupport=false;var i=r.floatingPointTexture&&r.depthTexture;this._translucentMRTSupport=r.drawBuffers&&i;this._translucentMultipassSupport=!this._translucentMRTSupport&&i;this._opaqueFBO=undefined;this._opaqueTexture=undefined;this._depthStencilTexture=undefined;this._accumulationTexture=undefined;this._translucentFBO=undefined;this._alphaFBO=undefined;this._adjustTranslucentFBO=undefined;this._adjustAlphaFBO=undefined;this._opaqueClearCommand=new o({color:new t(0,0,0,0),owner:this});this._translucentMRTClearCommand=new o({color:new t(0,0,0,1),owner:this});this._translucentMultipassClearCommand=new o({color:new t(0,0,0,0),owner:this});this._alphaClearCommand=new o({color:new t(1,1,1,1),owner:this});this._translucentRenderStateCache={};this._alphaRenderStateCache={};this._compositeCommand=undefined;this._adjustTranslucentCommand=undefined;this._adjustAlphaCommand=undefined;this._viewport=new e;this._rs=undefined}function g(e){e._accumulationTexture=e._accumulationTexture&&!e._accumulationTexture.isDestroyed()&&e._accumulationTexture.destroy();e._revealageTexture=e._revealageTexture&&!e._revealageTexture.isDestroyed()&&e._revealageTexture.destroy()}function y(e){e._translucentFBO=e._translucentFBO&&!e._translucentFBO.isDestroyed()&&e._translucentFBO.destroy();e._alphaFBO=e._alphaFBO&&!e._alphaFBO.isDestroyed()&&e._alphaFBO.destroy();e._adjustTranslucentFBO=e._adjustTranslucentFBO&&!e._adjustTranslucentFBO.isDestroyed()&&e._adjustTranslucentFBO.destroy();e._adjustAlphaFBO=e._adjustAlphaFBO&&!e._adjustAlphaFBO.isDestroyed()&&e._adjustAlphaFBO.destroy()}function w(e){g(e);y(e)}function C(e,t,r,i){g(e);var a=new Float32Array(r*i*4);e._accumulationTexture=new f({context:t,pixelFormat:n.RGBA,pixelDatatype:l.FLOAT,source:{arrayBufferView:a,width:r,height:i}});e._revealageTexture=new f({context:t,pixelFormat:n.RGBA,pixelDatatype:l.FLOAT,source:{arrayBufferView:a,width:r,height:i}})}function b(e,t){y(e);var r=a.FRAMEBUFFER_COMPLETE;var i=true;if(e._translucentMRTSupport){e._translucentFBO=new u({context:t,colorTextures:[e._accumulationTexture,e._revealageTexture],depthStencilTexture:e._depthStencilTexture,destroyAttachments:false});e._adjustTranslucentFBO=new u({context:t,colorTextures:[e._accumulationTexture,e._revealageTexture],destroyAttachments:false});if(e._translucentFBO.status!==r||e._adjustTranslucentFBO.status!==r){y(e);e._translucentMRTSupport=false}}if(!e._translucentMRTSupport){e._translucentFBO=new u({context:t,colorTextures:[e._accumulationTexture],depthStencilTexture:e._depthStencilTexture,destroyAttachments:false});e._alphaFBO=new u({context:t,colorTextures:[e._revealageTexture],depthStencilTexture:e._depthStencilTexture,destroyAttachments:false});e._adjustTranslucentFBO=new u({context:t,colorTextures:[e._accumulationTexture],destroyAttachments:false});e._adjustAlphaFBO=new u({context:t,colorTextures:[e._revealageTexture],destroyAttachments:false});var n=e._translucentFBO.status===r;var o=e._alphaFBO.status===r;var s=e._adjustTranslucentFBO.status===r;var l=e._adjustAlphaFBO.status===r;if(!n||!o||!s||!l){w(e);e._translucentMultipassSupport=false;i=false}}return i}_.prototype.update=function(t,i){if(!this.isSupported()){return}this._opaqueFBO=i;this._opaqueTexture=i.getColorTexture(0);this._depthStencilTexture=i.depthStencilTexture;var n=this._opaqueTexture.width;var a=this._opaqueTexture.height;var o=this._accumulationTexture;var s=!r(o)||o.width!==n||o.height!==a;if(s){C(this,t,n,a)}if(!r(this._translucentFBO)||s){if(!b(this,t)){return}}var u=this;var l;var f;if(!r(this._compositeCommand)){l=new d({sources:[p]});if(this._translucentMRTSupport){l.defines.push("MRT")}f={u_opaque:function(){return u._opaqueTexture},u_accumulation:function(){return u._accumulationTexture},u_revealage:function(){return u._revealageTexture}};this._compositeCommand=t.createViewportQuadCommand(l,{uniformMap:f,owner:this})}if(!r(this._adjustTranslucentCommand)){if(this._translucentMRTSupport){l=new d({defines:["MRT"],sources:[h]});f={u_bgColor:function(){return u._translucentMRTClearCommand.color},u_depthTexture:function(){return u._depthStencilTexture}};this._adjustTranslucentCommand=t.createViewportQuadCommand(l,{uniformMap:f,owner:this})}else if(this._translucentMultipassSupport){l=new d({sources:[h]});f={u_bgColor:function(){return u._translucentMultipassClearCommand.color},u_depthTexture:function(){return u._depthStencilTexture}};this._adjustTranslucentCommand=t.createViewportQuadCommand(l,{uniformMap:f,owner:this});f={u_bgColor:function(){return u._alphaClearCommand.color},u_depthTexture:function(){return u._depthStencilTexture}};this._adjustAlphaCommand=t.createViewportQuadCommand(l,{uniformMap:f,owner:this})}}this._viewport.width=n;this._viewport.height=a;if(!r(this._rs)||!e.equals(this._viewport,this._rs.viewport)){this._rs=c.fromCache({viewport:this._viewport})}if(r(this._compositeCommand)){this._compositeCommand.renderState=this._rs}if(this._adjustTranslucentCommand){this._adjustTranslucentCommand.renderState=this._rs}if(r(this._adjustAlphaCommand)){this._adjustAlphaCommand.renderState=this._rs}};var S={enabled:true,color:new t(0,0,0,0),equationRgb:m.ADD,equationAlpha:m.ADD,functionSourceRgb:v.ONE,functionDestinationRgb:v.ONE,functionSourceAlpha:v.ZERO,functionDestinationAlpha:v.ONE_MINUS_SOURCE_ALPHA};var E={enabled:true,color:new t(0,0,0,0),equationRgb:m.ADD,equationAlpha:m.ADD,functionSourceRgb:v.ONE,functionDestinationRgb:v.ONE,functionSourceAlpha:v.ONE,functionDestinationAlpha:v.ONE};var T={enabled:true,color:new t(0,0,0,0),equationRgb:m.ADD,equationAlpha:m.ADD,functionSourceRgb:v.ZERO,functionDestinationRgb:v.ONE_MINUS_SOURCE_ALPHA,functionSourceAlpha:v.ZERO,functionDestinationAlpha:v.ONE_MINUS_SOURCE_ALPHA};function x(e,t,i,n){var a=i[n.id];if(!r(a)){var o=c.getState(n);o.depthMask=false;o.blending=t;a=c.fromCache(o);i[n.id]=a}return a}function A(e,t,r){return x(t,S,e._translucentRenderStateCache,r)}function P(e,t,r){return x(t,E,e._translucentRenderStateCache,r)}function D(e,t,r){return x(t,T,e._alphaRenderStateCache,r)}var M="    vec3 Ci = czm_gl_FragColor.rgb * czm_gl_FragColor.a;\n"+"    float ai = czm_gl_FragColor.a;\n"+"    float wzi = czm_alphaWeight(ai);\n"+"    gl_FragData[0] = vec4(Ci * wzi, ai);\n"+"    gl_FragData[1] = vec4(ai * wzi);\n";var I="    vec3 Ci = czm_gl_FragColor.rgb * czm_gl_FragColor.a;\n"+"    float ai = czm_gl_FragColor.a;\n"+"    float wzi = czm_alphaWeight(ai);\n"+"    gl_FragColor = vec4(Ci, ai) * wzi;\n";var O="    float ai = czm_gl_FragColor.a;\n"+"    gl_FragColor = vec4(ai);\n";function R(e,t,i,n){var a=e.shaderCache.getDerivedShaderProgram(t,i);if(!r(a)){var o=t._attributeLocations;var s=t.fragmentShaderSource.clone();s.sources=s.sources.map(function(e){e=d.replaceMain(e,"czm_translucent_main");e=e.replace(/gl_FragColor/g,"czm_gl_FragColor");e=e.replace(/\bdiscard\b/g,"czm_discard = true");e=e.replace(/czm_phong/g,"czm_translucentPhong");return e});s.sources.splice(0,0,(n.indexOf("gl_FragData")!==-1?"#extension GL_EXT_draw_buffers : enable \n":"")+"vec4 czm_gl_FragColor;\n"+"bool czm_discard = false;\n");s.sources.push("void main()\n"+"{\n"+"    czm_translucent_main();\n"+"    if (czm_discard)\n"+"    {\n"+"        discard;\n"+"    }\n"+n+"}\n");a=e.shaderCache.createDerivedShaderProgram(t,i,{vertexShaderSource:t.vertexShaderSource,fragmentShaderSource:s,attributeLocations:o})}return a}function N(e,t){return R(e,t,"translucentMRT",M)}function L(e,t){return R(e,t,"translucentMultipass",I)}function B(e,t){return R(e,t,"alphaMultipass",O)}_.prototype.createDerivedCommands=function(e,t,i){if(!r(i)){i={}}if(this._translucentMRTSupport){var n;var a;if(r(i.translucentCommand)){n=i.translucentCommand.shaderProgram;a=i.translucentCommand.renderState}i.translucentCommand=s.shallowClone(e,i.translucentCommand);if(!r(n)||i.shaderProgramId!==e.shaderProgram.id){i.translucentCommand.shaderProgram=N(t,e.shaderProgram);i.translucentCommand.renderState=A(this,t,e.renderState);i.shaderProgramId=e.shaderProgram.id}else{i.translucentCommand.shaderProgram=n;i.translucentCommand.renderState=a}}else{var o;var u;var l;var c;if(r(i.translucentCommand)){o=i.translucentCommand.shaderProgram;u=i.translucentCommand.renderState;l=i.alphaCommand.shaderProgram;c=i.alphaCommand.renderState}i.translucentCommand=s.shallowClone(e,i.translucentCommand);i.alphaCommand=s.shallowClone(e,i.alphaCommand);if(!r(o)||i.shaderProgramId!==e.shaderProgram.id){i.translucentCommand.shaderProgram=L(t,e.shaderProgram);i.translucentCommand.renderState=P(this,t,e.renderState);i.alphaCommand.shaderProgram=B(t,e.shaderProgram);i.alphaCommand.renderState=D(this,t,e.renderState);i.shaderProgramId=e.shaderProgram.id}else{i.translucentCommand.shaderProgram=o;i.translucentCommand.renderState=u;i.alphaCommand.shaderProgram=l;i.alphaCommand.renderState=c}}return i};function F(e,t,r,i,n){var a;var o;var s;var u=t.context;var l=i.framebuffer;var c=n.length;var d=t.frameState.shadowHints.shadowsEnabled;i.framebuffer=e._adjustTranslucentFBO;e._adjustTranslucentCommand.execute(u,i);i.framebuffer=e._adjustAlphaFBO;e._adjustAlphaCommand.execute(u,i);var f=e._opaqueFBO;i.framebuffer=e._translucentFBO;for(s=0;s<c;++s){a=n[s];o=d&&a.receiveShadows?a.derivedCommands.oit.shadows.translucentCommand:a.derivedCommands.oit.translucentCommand;r(o,t,u,i,f)}i.framebuffer=e._alphaFBO;for(s=0;s<c;++s){a=n[s];o=d&&a.receiveShadows?a.derivedCommands.oit.shadows.alphaCommand:a.derivedCommands.oit.alphaCommand;r(o,t,u,i,f)}i.framebuffer=l}function k(e,t,r,i,n){var a=t.context;var o=i.framebuffer;var s=n.length;var u=t.frameState.shadowHints.shadowsEnabled;i.framebuffer=e._adjustTranslucentFBO;e._adjustTranslucentCommand.execute(a,i);var l=e._opaqueFBO;i.framebuffer=e._translucentFBO;for(var c=0;c<s;++c){var d=n[c];var f=u&&d.receiveShadows?d.derivedCommands.oit.shadows.translucentCommand:d.derivedCommands.oit.translucentCommand;r(f,t,a,i,l)}i.framebuffer=o}_.prototype.executeCommands=function(e,t,r,i){if(this._translucentMRTSupport){k(this,e,t,r,i);return}F(this,e,t,r,i)};_.prototype.execute=function(e,t){this._compositeCommand.execute(e,t)};_.prototype.clear=function(e,r,i){var n=r.framebuffer;r.framebuffer=this._opaqueFBO;t.clone(i,this._opaqueClearCommand.color);this._opaqueClearCommand.execute(e,r);r.framebuffer=this._translucentFBO;var a=this._translucentMRTSupport?this._translucentMRTClearCommand:this._translucentMultipassClearCommand;a.execute(e,r);if(this._translucentMultipassSupport){r.framebuffer=this._alphaFBO;this._alphaClearCommand.execute(e,r)}r.framebuffer=n};_.prototype.isSupported=function(){return this._translucentMRTSupport||this._translucentMultipassSupport};_.prototype.isDestroyed=function(){return false};_.prototype.destroy=function(){w(this);if(r(this._compositeCommand)){this._compositeCommand.shaderProgram=this._compositeCommand.shaderProgram&&this._compositeCommand.shaderProgram.destroy()}if(r(this._adjustTranslucentCommand)){this._adjustTranslucentCommand.shaderProgram=this._adjustTranslucentCommand.shaderProgram&&this._adjustTranslucentCommand.shaderProgram.destroy()}if(r(this._adjustAlphaCommand)){
this._adjustAlphaCommand.shaderProgram=this._adjustAlphaCommand.shaderProgram&&this._adjustAlphaCommand.shaderProgram.destroy()}return i(this)};return _});define("Widgets/getElement",["../Core/DeveloperError"],function(e){"use strict";function t(t){if(typeof t==="string"){var r=document.getElementById(t);if(r===null){throw new e('Element with id "'+t+'" does not exist in the document.')}t=r}return t}return t});define("Scene/PerformanceDisplay",["../Core/defaultValue","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Core/getTimestamp","../Widgets/getElement"],function(e,t,r,i,n,a){"use strict";function o(r){r=e(r,e.EMPTY_OBJECT);var n=a(r.container);if(!t(n)){throw new i("container is required")}this._container=n;var o=document.createElement("div");o.className="cesium-performanceDisplay";var s=document.createElement("div");s.className="cesium-performanceDisplay-fps";this._fpsText=document.createTextNode("");s.appendChild(this._fpsText);var u=document.createElement("div");u.className="cesium-performanceDisplay-ms";this._msText=document.createTextNode("");u.appendChild(this._msText);o.appendChild(u);o.appendChild(s);this._container.appendChild(o);this._lastFpsSampleTime=undefined;this._frameCount=0;this._time=undefined;this._fps=0;this._frameTime=0}o.prototype.update=function(){if(!t(this._time)){this._lastFpsSampleTime=n();this._time=n();return}var e=this._time;var r=n();this._time=r;var i=r-e;this._frameCount++;var a=this._fps;var o=r-this._lastFpsSampleTime;if(o>1e3){a=this._frameCount*1e3/o|0;this._lastFpsSampleTime=r;this._frameCount=0}if(a!==this._fps){this._fpsText.nodeValue=a+" FPS";this._fps=a}if(i!==this._frameTime){this._msText.nodeValue=i.toFixed(2)+" MS";this._frameTime=i}};o.prototype.destroy=function(){return r(this)};return o});define("Scene/PickDepth",["../Core/defined","../Core/destroyObject","../Core/PixelFormat","../Renderer/Framebuffer","../Renderer/PixelDatatype","../Renderer/RenderState","../Renderer/Texture"],function(e,t,r,i,n,a,o){"use strict";function s(){this.framebuffer=undefined;this._depthTexture=undefined;this._textureToCopy=undefined;this._copyDepthCommand=undefined;this._debugPickDepthViewportCommand=undefined}function u(t,r,i){if(!e(t._debugPickDepthViewportCommand)){var n="uniform sampler2D u_texture;\n"+"varying vec2 v_textureCoordinates;\n"+"void main()\n"+"{\n"+"    float z_window = czm_unpackDepth(texture2D(u_texture, v_textureCoordinates));\n"+"    float n_range = czm_depthRange.near;\n"+"    float f_range = czm_depthRange.far;\n"+"    float z_ndc = (2.0 * z_window - n_range - f_range) / (f_range - n_range);\n"+"    float scale = pow(z_ndc * 0.5 + 0.5, 8.0);\n"+"    gl_FragColor = vec4(mix(vec3(0.0), vec3(1.0), scale), 1.0);\n"+"}\n";t._debugPickDepthViewportCommand=r.createViewportQuadCommand(n,{uniformMap:{u_texture:function(){return t._depthTexture}},owner:t})}t._debugPickDepthViewportCommand.execute(r,i)}function l(e){e._depthTexture=e._depthTexture&&!e._depthTexture.isDestroyed()&&e._depthTexture.destroy()}function c(e){e.framebuffer=e.framebuffer&&!e.framebuffer.isDestroyed()&&e.framebuffer.destroy()}function d(e,t,i,a){e._depthTexture=new o({context:t,width:i,height:a,pixelFormat:r.RGBA,pixelDatatype:n.UNSIGNED_BYTE})}function f(e,t,r,n){l(e);c(e);d(e,t,r,n);e.framebuffer=new i({context:t,colorTextures:[e._depthTexture],destroyAttachments:false})}function h(t,r,i){var n=i.width;var a=i.height;var o=t._depthTexture;var s=!e(o)||o.width!==n||o.height!==a;if(!e(t.framebuffer)||s){f(t,r,n,a)}}function p(t,r,i){if(!e(t._copyDepthCommand)){var n="uniform sampler2D u_texture;\n"+"varying vec2 v_textureCoordinates;\n"+"void main()\n"+"{\n"+"    gl_FragColor = czm_packDepth(texture2D(u_texture, v_textureCoordinates).r);\n"+"}\n";t._copyDepthCommand=r.createViewportQuadCommand(n,{renderState:a.fromCache(),uniformMap:{u_texture:function(){return t._textureToCopy}},owner:t})}t._textureToCopy=i;t._copyDepthCommand.framebuffer=t.framebuffer}s.prototype.executeDebugPickDepth=function(e,t){u(this,e,t)};s.prototype.update=function(e,t){h(this,e,t);p(this,e,t)};s.prototype.executeCopyDepth=function(e,t){this._copyDepthCommand.execute(e,t)};s.prototype.isDestroyed=function(){return false};s.prototype.destroy=function(){l(this);c(this);this._copyDepthCommand.shaderProgram=e(this._copyDepthCommand.shaderProgram)&&this._copyDepthCommand.shaderProgram.destroy();return t(this)};return s});define("Shaders/Appearances/PointAppearanceFS",[],function(){"use strict";return"uniform vec4 highlightColor;\nvarying vec3 v_color;\nvoid main()\n{\ngl_FragColor = vec4(v_color * highlightColor.rgb, highlightColor.a);\n}\n"});define("Shaders/Appearances/PointAppearanceVS",[],function(){"use strict";return"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec3 color;\nattribute float batchId;\nuniform float pointSize;\nvarying vec3 v_positionEC;\nvarying vec3 v_color;\nvoid main()\n{\nv_color = color;\ngl_Position = czm_modelViewProjectionRelativeToEye * czm_computePosition();\ngl_PointSize = pointSize;\n}\n"});define("Scene/PointAppearance",["../Core/Color","../Core/combine","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/VertexFormat","../Shaders/Appearances/PointAppearanceFS","../Shaders/Appearances/PointAppearanceVS","./Appearance"],function(e,t,r,i,n,a,o,s,u){"use strict";function l(n){n=r(n,r.EMPTY_OBJECT);this._vertexShaderSource=r(n.vertexShaderSource,s);this._fragmentShaderSource=r(n.fragmentShaderSource,o);this._renderState=u.getDefaultRenderState(false,false,n.renderState);this._pointSize=r(n.pointSize,2);this._highlightColor=i(n.highlightColor)?n.highlightColor:new e;this.material=undefined;this.translucent=r(n.translucent,false);this.uniforms={highlightColor:this._highlightColor,pointSize:this._pointSize};var a=n.uniforms;this.uniforms=t(this.uniforms,a,true)}n(l.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return false}},vertexFormat:{get:function(){return l.VERTEX_FORMAT}},pixelSize:{get:function(){return this._pointSize}}});l.VERTEX_FORMAT=a.POSITION_AND_COLOR;l.prototype.getFragmentShaderSource=u.prototype.getFragmentShaderSource;l.prototype.isTranslucent=u.prototype.isTranslucent;l.prototype.getRenderState=u.prototype.getRenderState;return l});define("Scene/PrimitiveCollection",["../Core/createGuid","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError"],function(e,t,r,i,n,a){"use strict";function o(r){r=t(r,t.EMPTY_OBJECT);this._primitives=[];this._guid=e();this.show=t(r.show,true);this.destroyPrimitives=t(r.destroyPrimitives,true)}i(o.prototype,{length:{get:function(){return this._primitives.length}}});o.prototype.add=function(e){if(!r(e)){throw new a("primitive is required.")}var t=e._external=e._external||{};var i=t._composites=t._composites||{};i[this._guid]={collection:this};this._primitives.push(e);return e};o.prototype.remove=function(e){if(this.contains(e)){var t=this._primitives.indexOf(e);if(t!==-1){this._primitives.splice(t,1);delete e._external._composites[this._guid];if(this.destroyPrimitives){e.destroy()}return true}}return false};o.prototype.removeAndDestroy=function(e){var t=this.remove(e);if(t&&!this.destroyPrimitives){e.destroy()}return t};o.prototype.removeAll=function(){if(this.destroyPrimitives){var e=this._primitives;var t=e.length;for(var r=0;r<t;++r){e[r].destroy()}}this._primitives=[]};o.prototype.contains=function(e){return!!(r(e)&&e._external&&e._external._composites&&e._external._composites[this._guid])};function s(e,t){if(!e.contains(t)){throw new a("primitive is not in this collection.")}return e._primitives.indexOf(t)}o.prototype.raise=function(e){if(r(e)){var t=s(this,e);var i=this._primitives;if(t!==i.length-1){var n=i[t];i[t]=i[t+1];i[t+1]=n}}};o.prototype.raiseToTop=function(e){if(r(e)){var t=s(this,e);var i=this._primitives;if(t!==i.length-1){i.splice(t,1);i.push(e)}}};o.prototype.lower=function(e){if(r(e)){var t=s(this,e);var i=this._primitives;if(t!==0){var n=i[t];i[t]=i[t-1];i[t-1]=n}}};o.prototype.lowerToBottom=function(e){if(r(e)){var t=s(this,e);var i=this._primitives;if(t!==0){i.splice(t,1);i.unshift(e)}}};o.prototype.get=function(e){if(!r(e)){throw new a("index is required.")}return this._primitives[e]};o.prototype.update=function(e){if(!this.show){return}var t=this._primitives;for(var r=0;r<t.length;++r){t[r].update(e)}};o.prototype.isDestroyed=function(){return false};o.prototype.destroy=function(){this.removeAll();return n(this)};return o});define("Scene/QuadtreeTileProvider",["../Core/defineProperties","../Core/DeveloperError"],function(e,t){"use strict";function r(){t.throwInstantiationError()}r.computeDefaultLevelZeroMaximumGeometricError=function(e){return e.ellipsoid.maximumRadius*2*Math.PI*.25/(65*e.getNumberOfXTilesAtLevel(0))};e(r.prototype,{quadtree:{get:t.throwInstantiationError,set:t.throwInstantiationError},ready:{get:t.throwInstantiationError},tilingScheme:{get:t.throwInstantiationError},errorEvent:{get:t.throwInstantiationError}});r.prototype.beginUpdate=t.throwInstantiationError;r.prototype.endUpdate=t.throwInstantiationError;r.prototype.getLevelMaximumGeometricError=t.throwInstantiationError;r.prototype.loadTile=t.throwInstantiationError;r.prototype.computeTileVisibility=t.throwInstantiationError;r.prototype.showTileThisFrame=t.throwInstantiationError;r.prototype.computeDistanceToTile=t.throwInstantiationError;r.prototype.isDestroyed=t.throwInstantiationError;r.prototype.destroy=t.throwInstantiationError;return r});define("Scene/SceneTransitioner",["../Core/Cartesian3","../Core/Cartographic","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Core/EasingFunction","../Core/Math","../Core/Matrix4","../Core/Ray","../Core/ScreenSpaceEventHandler","../Core/ScreenSpaceEventType","../Core/Transforms","./Camera","./OrthographicFrustum","./OrthographicOffCenterFrustum","./PerspectiveFrustum","./SceneMode"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v){"use strict";function _(e){if(!r(e)){throw new n("scene is required.")}this._scene=e;this._currentTweens=[];this._morphHandler=undefined;this._morphCancelled=false;this._completeMorph=undefined;this._morphToOrthographic=false}_.prototype.completeMorph=function(){if(r(this._completeMorph)){this._completeMorph()}};_.prototype.morphTo2D=function(e,t){if(r(this._completeMorph)){this._completeMorph()}var i=this._scene;this._previousMode=i.mode;this._morphToOrthographic=i.camera.frustum instanceof h;if(this._previousMode===v.SCENE2D||this._previousMode===v.MORPHING){return}this._scene.morphStart.raiseEvent(this,this._previousMode,v.SCENE2D,true);i._mode=v.MORPHING;i.camera._setTransform(s.IDENTITY);if(this._previousMode===v.COLUMBUS_VIEW){ae(this,e)}else{he(this,e,t)}if(e===0&&r(this._completeMorph)){this._completeMorph()}};var g=new e;var y=new e;var w=new e;var C=new e;var b=new e;var S=new e;var E=new e;var T=new t;var x=new s;var A=new m;var P=new h;var D={position:undefined,direction:undefined,up:undefined,position2D:undefined,direction2D:undefined,up2D:undefined,frustum:undefined};_.prototype.morphToColumbusView=function(t,i){if(r(this._completeMorph)){this._completeMorph()}var n=this._scene;this._previousMode=n.mode;if(this._previousMode===v.COLUMBUS_VIEW||this._previousMode===v.MORPHING){return}this._scene.morphStart.raiseEvent(this,this._previousMode,v.COLUMBUS_VIEW,true);n.camera._setTransform(s.IDENTITY);var a=g;var u=y;var l=w;if(t>0){a.x=0;a.y=-1;a.z=1;a=e.multiplyByScalar(e.normalize(a,a),5*i.maximumRadius,a);e.negate(e.normalize(a,u),u);e.cross(e.UNIT_X,u,l)}else{var c=n.camera;if(this._previousMode===v.SCENE2D){e.clone(c.position,a);a.z=c.frustum.right-c.frustum.left;e.negate(e.UNIT_Z,u);e.clone(e.UNIT_Y,l)}else{e.clone(c.positionWC,a);e.clone(c.directionWC,u);e.clone(c.upWC,l);var h=i.scaleToGeodeticSurface(a,E);var p=d.eastNorthUpToFixedFrame(h,i,x);s.inverseTransformation(p,p);n.mapProjection.project(i.cartesianToCartographic(a,T),a);s.multiplyByPointAsVector(p,u,u);s.multiplyByPointAsVector(p,l,l)}}var m;if(this._morphToOrthographic){m=P;m.width=n.camera.frustum.right-n.camera.frustum.left;m.aspectRatio=n.drawingBufferWidth/n.drawingBufferHeight}else{m=A;m.aspectRatio=n.drawingBufferWidth/n.drawingBufferHeight;m.fov=o.toRadians(60)}var _=D;_.position=a;_.direction=u;_.up=l;_.frustum=m;var I=xe(_);M(this,I);if(this._previousMode===v.SCENE2D){me(this,t,_,I)}else{_.position2D=s.multiplyByPoint(f.TRANSFORM_2D,a,C);_.direction2D=s.multiplyByPointAsVector(f.TRANSFORM_2D,u,b);_.up2D=s.multiplyByPointAsVector(f.TRANSFORM_2D,l,S);n._mode=v.MORPHING;be(this,t,_,I)}if(t===0&&r(this._completeMorph)){this._completeMorph()}};_.prototype.morphTo3D=function(t,i){if(r(this._completeMorph)){this._completeMorph()}var n=this._scene;this._previousMode=n.mode;if(this._previousMode===v.SCENE3D||this._previousMode===v.MORPHING){return}this._scene.morphStart.raiseEvent(this,this._previousMode,v.SCENE3D,true);n._mode=v.MORPHING;n.camera._setTransform(s.IDENTITY);if(this._previousMode===v.SCENE2D){j(this,t,i)}else{var a;if(t>0){a=L;e.fromDegrees(0,0,5*i.maximumRadius,i,a.position);e.negate(a.position,a.direction);e.normalize(a.direction,a.direction);e.clone(e.UNIT_Z,a.up)}else{a=B(this,i)}var o=Ee(a);M(this,o);G(this,t,a,o)}if(t===0&&r(this._completeMorph)){this._completeMorph()}};_.prototype.isDestroyed=function(){return false};_.prototype.destroy=function(){I(this);return i(this)};function M(e,t){if(e._scene.completeMorphOnUserInput){e._morphHandler=new l(e._scene.canvas,false);var r=function(){e._morphCancelled=true;t(e)};e._completeMorph=r;e._morphHandler.setInputAction(r,c.LEFT_DOWN);e._morphHandler.setInputAction(r,c.MIDDLE_DOWN);e._morphHandler.setInputAction(r,c.RIGHT_DOWN);e._morphHandler.setInputAction(r,c.WHEEL)}}function I(e){var t=e._currentTweens;for(var r=0;r<t.length;++r){t[r].cancelTween()}e._currentTweens.length=0;e._morphHandler=e._morphHandler&&e._morphHandler.destroy()}var O=new t;var R=new e;var N=new s;var L={position:new e,direction:new e,up:new e,frustum:undefined};function B(e,t){var r=e._scene;var i=r.camera;var n=L;var a=n.position;var o=n.direction;var u=n.up;var l=r.mapProjection.unproject(i.position,O);t.cartographicToCartesian(l,a);var c=t.scaleToGeodeticSurface(a,R);var f=d.eastNorthUpToFixedFrame(c,t,N);s.multiplyByPointAsVector(f,i.direction,o);s.multiplyByPointAsVector(f,i.up,u);return n}var F=new e;var k=new e;var V=new e;var z=new e;var U=new e;var q=new e;function G(t,r,i,n){r*=.5;var o=t._scene;var u=o.camera;var l=e.clone(u.position,F);var c=e.clone(u.direction,k);var d=e.clone(u.up,V);var h=s.multiplyByPoint(f.TRANSFORM_2D_INVERSE,i.position,z);var p=s.multiplyByPointAsVector(f.TRANSFORM_2D_INVERSE,i.direction,U);var m=s.multiplyByPointAsVector(f.TRANSFORM_2D_INVERSE,i.up,q);function v(t){Y(l,h,t.time,u.position);Y(c,p,t.time,u.direction);Y(d,m,t.time,u.up);e.cross(u.direction,u.up,u.right);e.normalize(u.right,u.right)}var _=o.tweens.add({duration:r,easingFunction:a.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:v,complete:function(){Se(t,o,0,1,r,n)}});t._currentTweens.push(_)}var H=new m;var W=new h;function j(t,r,i){r/=3;var n=t._scene;var s=n.camera;var u;if(r>0){u=L;e.fromDegrees(0,0,5*i.maximumRadius,i,u.position);e.negate(u.position,u.direction);e.normalize(u.direction,u.direction);e.clone(e.UNIT_Z,u.up)}else{s.position.z=s.frustum.right-s.frustum.left;u=B(t,i)}var l=Ee(u);M(t,l);var c=e.clone(s.position,ve);var d=e.clone(s.direction,_e);var f=e.clone(s.up,ge);var h=e.fromElements(0,0,5*i.maximumRadius,ye);var p=e.negate(e.UNIT_Z,we);var m=e.clone(e.UNIT_Y,Ce);var _=s.frustum.right;var g=h.z*.5;function y(t){Y(c,h,t.time,s.position);Y(d,p,t.time,s.direction);Y(f,m,t.time,s.up);e.cross(s.direction,s.up,s.right);e.normalize(s.right,s.right);var r=s.frustum;r.right=o.lerp(_,g,t.time);r.left=-r.right;r.top=r.right*(n.drawingBufferHeight/n.drawingBufferWidth);r.bottom=-r.top;s.position.z=2*n.mapProjection.ellipsoid.maximumRadius}var w;var C;if(t._morphToOrthographic){w=function(){C=W;C.aspectRatio=n.drawingBufferWidth/n.drawingBufferHeight;C.width=s.frustum.right-s.frustum.left;s.frustum=C;G(t,r,u,l)}}else{w=function(){C=H;C.aspectRatio=n.drawingBufferWidth/n.drawingBufferHeight;C.fov=o.toRadians(60);u.frustum=C;pe(t,r,u,function(){G(t,r,u,l)})}}if(r>0){var b=n.tweens.add({duration:r,easingFunction:a.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:y,complete:function(){n._mode=v.MORPHING;w()}});t._currentTweens.push(b)}else{w()}}function Y(t,r,i,n){return e.lerp(t,r,i,n)}function X(e,t,r,i,n){var s=e._scene;var u=s.camera;if(u.frustum instanceof h){return}var l=u.frustum.fov;var c=o.RADIANS_PER_DEGREE*.5;var d=r.position.z*Math.tan(l*.5);u.frustum.far=d/Math.tan(c*.5)+1e7;function f(e){u.frustum.fov=o.lerp(l,c,e.time);var t=d/Math.tan(u.frustum.fov*.5);i(u,t)}var p=s.tweens.add({duration:t,easingFunction:a.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:f,complete:function(){u.frustum=r.frustum.clone();n(e)}});e._currentTweens.push(p)}var Z=new e;var K=new e;var Q=new e;var J=new e;var $=new e;var ee=new e;var te=new p;var re=new u;var ie=new e;var ne={position:undefined,direction:undefined,up:undefined,frustum:undefined};function ae(t,i){i*=.5;var n=t._scene;var o=n.camera;var u=e.clone(o.position,Z);var l=e.clone(o.direction,K);var c=e.clone(o.up,Q);var d=e.negate(e.UNIT_Z,$);var h=e.clone(e.UNIT_Y,ee);var p=J;if(i>0){e.clone(e.ZERO,J);p.z=5*n.mapProjection.ellipsoid.maximumRadius}else{e.clone(u,J);var m=re;s.multiplyByPoint(f.TRANSFORM_2D,u,m.origin);s.multiplyByPointAsVector(f.TRANSFORM_2D,l,m.direction);var v=n.globe;if(r(v)){var _=v.pick(m,n,ie);if(r(_)){s.multiplyByPoint(f.TRANSFORM_2D_INVERSE,_,p);p.z+=e.distance(u,p)}}}var g=te;g.right=p.z*.5;g.left=-g.right;g.top=g.right*(n.drawingBufferHeight/n.drawingBufferWidth);g.bottom=-g.top;var y=ne;y.position=p;y.direction=d;y.up=h;y.frustum=g;var w=Te(y);M(t,w);function C(t){Y(u,p,t.time,o.position);Y(l,d,t.time,o.direction);Y(c,h,t.time,o.up);e.cross(o.direction,o.up,o.right);e.normalize(o.right,o.right);o._adjustOrthographicFrustum(true)}function b(e,t){e.position.z=t}var S=n.tweens.add({duration:i,easingFunction:a.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:C,complete:function(){X(t,i,y,b,w)}});t._currentTweens.push(S)}var oe=new t;var se={position:new e,direction:new e,up:new e,position2D:new e,direction2D:new e,up2D:new e,frustum:new p};var ue={position:new e,direction:new e,up:new e,frustum:undefined};var le=new e;var ce=new u;var de=new s;var fe=new e;function he(t,i,n){i*=.5;var a=t._scene;var o=a.camera;var u=se;if(i>0){e.clone(e.ZERO,u.position);u.position.z=5*n.maximumRadius;e.negate(e.UNIT_Z,u.direction);e.clone(e.UNIT_Y,u.up)}else{n.cartesianToCartographic(o.positionWC,oe);a.mapProjection.project(oe,u.position);e.negate(e.UNIT_Z,u.direction);e.clone(e.UNIT_Y,u.up);var l=ce;e.clone(u.position2D,l.origin);var c=e.clone(o.directionWC,l.direction);var h=n.scaleToGeodeticSurface(o.positionWC,fe);var p=d.eastNorthUpToFixedFrame(h,n,de);s.inverseTransformation(p,p);s.multiplyByPointAsVector(p,c,c);s.multiplyByPointAsVector(f.TRANSFORM_2D,c,c);var m=a.globe;if(r(m)){var v=m.pick(l,a,le);if(r(v)){var _=e.distance(u.position2D,v);v.x+=_;e.clone(v,u.position2D)}}}function g(e,t){e.position.x=t}s.multiplyByPoint(f.TRANSFORM_2D,u.position,u.position2D);s.multiplyByPointAsVector(f.TRANSFORM_2D,u.direction,u.direction2D);s.multiplyByPointAsVector(f.TRANSFORM_2D,u.up,u.up2D);var y=u.frustum;y.right=u.position.z*.5;y.left=-y.right;y.top=y.right*(a.drawingBufferHeight/a.drawingBufferWidth);y.bottom=-y.top;var w=ue;s.multiplyByPoint(f.TRANSFORM_2D_INVERSE,u.position2D,w.position);e.clone(u.direction,w.direction);e.clone(u.up,w.up);w.frustum=y;var C=Te(w);M(t,C);function b(){X(t,i,u,g,C)}be(t,i,u,b)}function pe(e,t,r,i){var n=e._scene;var s=n.camera;var u=s.frustum.right-s.frustum.left;s.frustum=r.frustum.clone();var l=s.frustum.fov;var c=o.RADIANS_PER_DEGREE*.5;var d=u*Math.tan(l*.5);s.frustum.far=d/Math.tan(c*.5)+1e7;s.frustum.fov=c;function f(e){s.frustum.fov=o.lerp(c,l,e.time);s.position.z=d/Math.tan(s.frustum.fov*.5)}var h=n.tweens.add({duration:t,easingFunction:a.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:f,complete:function(){i(e)}});e._currentTweens.push(h)}function me(t,r,i,n){r*=.5;var o=t._scene;var s=o.camera;var u=e.clone(i.position,ye);var l=e.clone(i.direction,we);var c=e.clone(i.up,Ce);o._mode=v.MORPHING;function d(){s.frustum=i.frustum.clone();var d=e.clone(s.position,ve);var f=e.clone(s.direction,_e);var h=e.clone(s.up,ge);d.z=u.z;function p(t){Y(d,u,t.time,s.position);Y(f,l,t.time,s.direction);Y(h,c,t.time,s.up);e.cross(s.direction,s.up,s.right);e.normalize(s.right,s.right)}var m=o.tweens.add({duration:r,easingFunction:a.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:p,complete:function(){n(t)}});t._currentTweens.push(m)}if(t._morphToOrthographic){d()}else{pe(t,0,i,d)}}var ve=new e;var _e=new e;var ge=new e;var ye=new e;var we=new e;var Ce=new e;function be(t,r,i,n){var o=t._scene;var s=o.camera;var u=e.clone(s.position,ve);var l=e.clone(s.direction,_e);var c=e.clone(s.up,ge);var d=e.clone(i.position2D,ye);var f=e.clone(i.direction2D,we);var h=e.clone(i.up2D,Ce);function p(t){Y(u,d,t.time,s.position);Y(l,f,t.time,s.direction);Y(c,h,t.time,s.up);e.cross(s.direction,s.up,s.right);e.normalize(s.right,s.right);s._adjustOrthographicFrustum(true)}var m=o.tweens.add({duration:r,easingFunction:a.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:p,complete:function(){Se(t,o,1,0,r,n)}});t._currentTweens.push(m)}function Se(e,t,i,n,o,s){var u={object:t,property:"morphTime",startValue:i,stopValue:n,duration:o,easingFunction:a.QUARTIC_OUT};if(r(s)){u.complete=function(){s(e)}}var l=t.tweens.addProperty(u);e._currentTweens.push(l)}function Ee(t){return function(i){var n=i._scene;n._mode=v.SCENE3D;n.morphTime=v.getMorphTime(v.SCENE3D);I(i);if(i._previousMode!==v.MORPHING||i._morphCancelled){i._morphCancelled=false;var a=n.camera;e.clone(t.position,a.position);e.clone(t.direction,a.direction);e.clone(t.up,a.up);e.cross(a.direction,a.up,a.right);e.normalize(a.right,a.right)}var o=r(i._completeMorph);i._completeMorph=undefined;n.camera.update(n.mode);i._scene.morphComplete.raiseEvent(i,i._previousMode,v.SCENE3D,o)}}function Te(t){return function(i){var n=i._scene;n._mode=v.SCENE2D;n.morphTime=v.getMorphTime(v.SCENE2D);I(i);var a=n.camera;e.clone(t.position,a.position);a.position.z=n.mapProjection.ellipsoid.maximumRadius*2;e.clone(t.direction,a.direction);e.clone(t.up,a.up);e.cross(a.direction,a.up,a.right);e.normalize(a.right,a.right);a.frustum=t.frustum.clone();var o=r(i._completeMorph);i._completeMorph=undefined;n.camera.update(n.mode);i._scene.morphComplete.raiseEvent(i,i._previousMode,v.SCENE2D,o)}}function xe(t){return function(i){var n=i._scene;n._mode=v.COLUMBUS_VIEW;n.morphTime=v.getMorphTime(v.COLUMBUS_VIEW);I(i);if(i._previousModeMode!==v.MORPHING||i._morphCancelled){i._morphCancelled=false;var a=n.camera;e.clone(t.position,a.position);e.clone(t.direction,a.direction);e.clone(t.up,a.up);e.cross(a.direction,a.up,a.right);e.normalize(a.right,a.right)}var o=r(i._completeMorph);i._completeMorph=undefined;n.camera.update(n.mode);i._scene.morphComplete.raiseEvent(i,i._previousMode,v.COLUMBUS_VIEW,o)}}return _});define("Scene/TweenCollection",["../Core/clone","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/EasingFunction","../Core/getTimestamp","../Core/TimeConstants","../ThirdParty/Tween"],function(e,t,r,i,n,a,o,s,u){"use strict";function l(t,r,i,n,a,o,s,u,l,c){this._tweens=t;this._tweenjs=r;this._startObject=e(i);this._stopObject=e(n);this._duration=a;this._delay=o;this._easingFunction=s;this._update=u;this._complete=l;this.cancel=c;this.needsStart=true}i(l.prototype,{startObject:{get:function(){return this._startObject}},stopObject:{get:function(){return this._stopObject}},duration:{get:function(){return this._duration}},delay:{get:function(){return this._delay}},easingFunction:{get:function(){return this._easingFunction}},update:{get:function(){return this._update}},complete:{get:function(){return this._complete}},tweenjs:{get:function(){return this._tweenjs}}});l.prototype.cancelTween=function(){this._tweens.remove(this)};function c(){this._tweens=[]}i(c.prototype,{length:{get:function(){return this._tweens.length}}});c.prototype.add=function(i){i=t(i,t.EMPTY_OBJECT);if(!r(i.startObject)||!r(i.stopObject)){throw new n("options.startObject and options.stopObject are required.")}if(!r(i.duration)||i.duration<0){throw new n("options.duration is required and must be positive.")}if(i.duration===0){if(r(i.complete)){i.complete()}return new l(this)}var o=i.duration/s.SECONDS_PER_MILLISECOND;var c=t(i.delay,0);var d=c/s.SECONDS_PER_MILLISECOND;var f=t(i.easingFunction,a.LINEAR_NONE);var h=i.startObject;var p=new u.Tween(h);p.to(e(i.stopObject),o);p.delay(d);p.easing(f);if(r(i.update)){p.onUpdate(function(){i.update(h)})}p.onComplete(t(i.complete,null));p.repeat(t(i._repeat,0));var m=new l(this,p,i.startObject,i.stopObject,i.duration,c,f,i.update,i.complete,i.cancel);this._tweens.push(m);return m};c.prototype.addProperty=function(e){e=t(e,t.EMPTY_OBJECT);var i=e.object;var a=e.property;var o=e.startValue;var s=e.stopValue;if(!r(i)||!r(e.property)){throw new n("options.object and options.property are required.")}if(!r(i[a])){throw new n("options.object must have the specified property.")}if(!r(o)||!r(s)){throw new n("options.startValue and options.stopValue are required.")}function u(e){i[a]=e.value}return this.add({startObject:{value:o},stopObject:{value:s},duration:t(e.duration,3),delay:e.delay,easingFunction:e.easingFunction,update:u,complete:e.complete,cancel:e.cancel,_repeat:e._repeat})};c.prototype.addAlpha=function(e){e=t(e,t.EMPTY_OBJECT);var i=e.material;if(!r(i)){throw new n("options.material is required.")}var a=[];for(var o in i.uniforms){if(i.uniforms.hasOwnProperty(o)&&r(i.uniforms[o])&&r(i.uniforms[o].alpha)){a.push(o)}}if(a.length===0){throw new n("material has no properties with alpha components.")}function s(e){var t=a.length;for(var r=0;r<t;++r){i.uniforms[a[r]].alpha=e.alpha}}return this.add({startObject:{alpha:t(e.startValue,0)},stopObject:{alpha:t(e.stopValue,1)},duration:t(e.duration,3),delay:e.delay,easingFunction:e.easingFunction,update:s,complete:e.complete,cancel:e.cancel})};c.prototype.addOffsetIncrement=function(e){e=t(e,t.EMPTY_OBJECT);var i=e.material;if(!r(i)){throw new n("material is required.")}if(!r(i.uniforms.offset)){throw new n("material.uniforms must have an offset property.")}var a=i.uniforms;return this.addProperty({object:a,property:"offset",startValue:a.offset,stopValue:a.offset+1,duration:e.duration,delay:e.delay,easingFunction:e.easingFunction,update:e.update,cancel:e.cancel,_repeat:Infinity})};c.prototype.remove=function(e){if(!r(e)){return false}var t=this._tweens.indexOf(e);if(t!==-1){e.tweenjs.stop();if(r(e.cancel)){e.cancel()}this._tweens.splice(t,1);return true}return false};c.prototype.removeAll=function(){var e=this._tweens;for(var t=0;t<e.length;++t){var i=e[t];i.tweenjs.stop();if(r(i.cancel)){i.cancel()}}e.length=0};c.prototype.contains=function(e){return r(e)&&this._tweens.indexOf(e)!==-1};c.prototype.get=function(e){if(!r(e)){throw new n("index is required.")}return this._tweens[e]};c.prototype.update=function(e){var t=this._tweens;var i=0;e=r(e)?e/s.SECONDS_PER_MILLISECOND:o();while(i<t.length){var n=t[i];var a=n.tweenjs;if(n.needsStart){n.needsStart=false;a.start(e)}else{if(a.update(e)){i++}else{a.stop();t.splice(i,1)}}}};return c});define("Scene/ScreenSpaceCameraController",["../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Cartographic","../Core/defaultValue","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Core/Ellipsoid","../Core/IntersectionTests","../Core/isArray","../Core/KeyboardEventModifier","../Core/Math","../Core/Matrix3","../Core/Matrix4","../Core/Plane","../Core/Quaternion","../Core/Ray","../Core/Transforms","./CameraEventAggregator","./CameraEventType","./MapMode2D","./OrthographicFrustum","./SceneMode","./SceneTransforms","./TweenCollection"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w,C,b,S,E,T){"use strict";function x(r){if(!a(r)){throw new s("scene is required.")}this.enableInputs=true;this.enableTranslate=true;this.enableZoom=true;this.enableRotate=true;this.enableTilt=true;this.enableLook=true;this.inertiaSpin=.9;this.inertiaTranslate=.9;this.inertiaZoom=.8;this.maximumMovementRatio=.1;this.bounceAnimationTime=3;this.minimumZoomDistance=1;this.maximumZoomDistance=Number.POSITIVE_INFINITY;this.translateEventTypes=w.LEFT_DRAG;this.zoomEventTypes=[w.RIGHT_DRAG,w.WHEEL,w.PINCH];this.rotateEventTypes=w.LEFT_DRAG;this.tiltEventTypes=[w.MIDDLE_DRAG,w.PINCH,{eventType:w.LEFT_DRAG,modifier:d.CTRL},{eventType:w.RIGHT_DRAG,modifier:d.CTRL}];this.lookEventTypes={eventType:w.LEFT_DRAG,modifier:d.SHIFT};this.minimumPickingTerrainHeight=15e4;this._minimumPickingTerrainHeight=this.minimumPickingTerrainHeight;this.minimumCollisionTerrainHeight=15e3;this._minimumCollisionTerrainHeight=this.minimumCollisionTerrainHeight;this.minimumTrackBallHeight=75e5;this._minimumTrackBallHeight=this.minimumTrackBallHeight;this.enableCollisionDetection=true;this._scene=r;this._globe=undefined;this._ellipsoid=undefined;this._aggregator=new y(r.canvas);this._lastInertiaSpinMovement=undefined;this._lastInertiaZoomMovement=undefined;this._lastInertiaTranslateMovement=undefined;this._lastInertiaTiltMovement=undefined;this._tweens=new T;this._tween=undefined;this._horizontalRotationAxis=undefined;this._tiltCenterMousePosition=new e(-1,-1);this._tiltCenter=new t;this._rotateMousePosition=new e(-1,-1);this._rotateStartPosition=new t;this._strafeStartPosition=new t;this._zoomMouseStart=new e(-1,-1);this._zoomWorldPosition=new t;this._useZoomWorldPosition=false;this._tiltCVOffMap=false;this._looking=false;this._rotating=false;this._strafing=false;this._zoomingOnVector=false;this._rotatingZoom=false;var n=r.mapProjection;this._maxCoord=n.project(new i(Math.PI,f.PI_OVER_TWO));this._zoomFactor=5;this._rotateFactor=undefined;this._rotateRateRangeAdjustment=undefined;this._maximumRotateRate=1.77;this._minimumRotateRate=1/5e3;this._minimumZoomRate=20;this._maximumZoomRate=5906376272e3}function A(e,t){if(e<0){return 0}var r=(1-t)*25;return Math.exp(-r*e)}function P(t){return e.equalsEpsilon(t.startPosition,t.endPosition,f.EPSILON14)}var D=.4;function M(t,r,i,n,o,s,u){var l=s[u];if(!a(l)){l=s[u]={startPosition:new e,endPosition:new e,motion:new e,active:false}}var c=t.getButtonPressTime(r,i);var d=t.getButtonReleaseTime(r,i);var f=c&&d&&(d.getTime()-c.getTime())/1e3;var h=new Date;var p=d&&(h.getTime()-d.getTime())/1e3;if(c&&d&&f<D){var m=A(p,n);if(!l.active){var v=t.getLastMovement(r,i);if(!a(v)||P(v)){return}l.motion.x=(v.endPosition.x-v.startPosition.x)*.5;l.motion.y=(v.endPosition.y-v.startPosition.y)*.5;l.startPosition=e.clone(v.startPosition,l.startPosition);l.endPosition=e.multiplyByScalar(l.motion,m,l.endPosition);l.endPosition=e.add(l.startPosition,l.endPosition,l.endPosition);l.active=true}else{l.startPosition=e.clone(l.endPosition,l.startPosition);l.endPosition=e.multiplyByScalar(l.motion,m,l.endPosition);l.endPosition=e.add(l.startPosition,l.endPosition,l.endPosition);l.motion=e.clone(e.ZERO,l.motion)}if(isNaN(l.endPosition.x)||isNaN(l.endPosition.y)||e.distance(l.startPosition,l.endPosition)<.5){l.active=false;return}if(!t.isButtonDown(r,i)){var _=t.getStartMousePosition(r,i);o(s,_,l)}}else{l.active=false}}var I=[];function O(e,t,r,i,n,o){if(!a(r)){return}var s=e._aggregator;if(!c(r)){I[0]=r;r=I}var u=r.length;for(var l=0;l<u;++l){var d=r[l];var f=a(d.eventType)?d.eventType:d;var h=d.modifier
;var p=s.isMoving(f,h)&&s.getMovement(f,h);var m=s.getStartMousePosition(f,h);if(e.enableInputs&&t){if(p){i(e,m,p)}else if(n<1){M(s,f,h,n,i,e,o)}}}}var R=new _;var N=new t;var L=new e;var B=new t;var F=new e;var k=new t;var V=new t;var z=new t;var U=new t;var q=new t;var G=new t;var H=new t;var W=new t;var j=new t;var Y=new t;var X=new t;var Z=new t;var K=new t;var Q=new t;var J=new t;var $=new t;var ee=new t;var te=new t;function re(r,i,n,o,s,u){var l=1;if(a(u)){l=f.clamp(Math.abs(u),.25,1)}var c=r.minimumZoomDistance*l;var d=r.maximumZoomDistance;var h=s-c;var p=o*h;p=f.clamp(p,r._minimumZoomRate,r._maximumZoomRate);var m=n.endPosition.y-n.startPosition.y;var v=m/r._scene.canvas.clientHeight;v=Math.min(v,r.maximumMovementRatio);var _=p*v;if(_>0&&Math.abs(s-c)<1){return}if(_<0&&Math.abs(s-d)<1){return}if(s-_<c){_=s-c-1}else if(s-_>d){_=s-d}var g=r._scene;var y=g.camera;var w=g.mode;if(y.frustum instanceof b){if(Math.abs(_)>0){y.zoomIn(_);y._adjustOrthographicFrustum()}return}var C=e.equals(i,r._zoomMouseStart);var T=r._zoomingOnVector;var x=r._rotatingZoom;var A;if(!C){r._zoomMouseStart=e.clone(i,r._zoomMouseStart);if(a(r._globe)){A=w!==S.SCENE2D?ve(r,i,N):y.getPickRay(i,R).origin}if(a(A)){r._useZoomWorldPosition=true;r._zoomWorldPosition=t.clone(A,r._zoomWorldPosition)}else{r._useZoomWorldPosition=false}T=r._zoomingOnVector=false;x=r._rotatingZoom=false}if(!r._useZoomWorldPosition){y.zoomIn(_);return}var P=w===S.COLUMBUS_VIEW;if(y.positionCartographic.height<2e6){x=true}if(!C||x){if(w===S.SCENE2D){var D=r._zoomWorldPosition;var M=y.position;if(!t.equals(D,M)&&y.positionCartographic.height<r._maxCoord.x*2){var I=y.position.x;var O=t.subtract(D,M,B);t.normalize(O,O);var re=t.distance(D,M)*_/(y.getMagnitude()*.5);y.move(O,re*.5);if(y.position.x<0&&I>0||y.position.x>0&&I<0){A=y.getPickRay(i,R).origin;r._zoomWorldPosition=t.clone(A,r._zoomWorldPosition)}}}else if(w===S.SCENE3D){var ie=t.normalize(y.position,q);if(y.positionCartographic.height<3e3&&Math.abs(t.dot(y.direction,ie))<.6){P=true}else{var ne=g.canvas;var ae=F;ae.x=ne.clientWidth/2;ae.y=ne.clientHeight/2;var oe=ve(r,ae,k);if(a(oe)&&y.positionCartographic.height<1e6){var se=H;t.clone(y.position,se);var ue=r._zoomWorldPosition;var le=G;le=t.normalize(ue,le);if(t.dot(le,ie)<0){return}var ce=J;var de=Y;t.clone(y.direction,de);t.add(se,t.multiplyByScalar(de,1e3,$),ce);var fe=X;var he=Z;t.subtract(ue,se,fe);t.normalize(fe,he);var pe=t.dot(ie,he);if(pe>=0){r._zoomMouseStart.x=-1;return}var me=Math.acos(-pe);var _e=t.magnitude(se);var ge=t.magnitude(ue);var ye=_e-_;var we=t.magnitude(fe);var Ce=Math.asin(f.clamp(we/ge*Math.sin(me),-1,1));var be=Math.asin(f.clamp(ye/ge*Math.sin(me),-1,1));var Se=Ce-be+me;var Ee=W;t.normalize(se,Ee);var Te=j;Te=t.cross(he,Ee,Te);Te=t.normalize(Te,Te);t.normalize(t.cross(Ee,Te,$),de);t.multiplyByScalar(t.normalize(ce,$),t.magnitude(ce)-_,ce);t.normalize(se,se);t.multiplyByScalar(se,ye,se);var xe=K;t.multiplyByScalar(t.add(t.multiplyByScalar(Ee,Math.cos(Se)-1,ee),t.multiplyByScalar(de,Math.sin(Se),te),$),ye,xe);t.add(se,xe,se);t.normalize(ce,Ee);t.normalize(t.cross(Ee,Te,$),de);var Ae=Q;t.multiplyByScalar(t.add(t.multiplyByScalar(Ee,Math.cos(Se)-1,ee),t.multiplyByScalar(de,Math.sin(Se),te),$),t.magnitude(ce),Ae);t.add(ce,Ae,ce);t.clone(se,y.position);t.normalize(t.subtract(ce,se,$),y.direction);t.clone(y.direction,y.direction);t.cross(y.direction,y.up,y.right);t.cross(y.right,y.direction,y.up);return}if(a(oe)){var Pe=t.normalize(oe,V);var De=t.normalize(r._zoomWorldPosition,z);var Me=t.dot(De,Pe);if(Me>0&&Me<1){var Ie=f.acosClamped(Me);var Oe=t.cross(De,Pe,U);var Re=Math.abs(Ie)>f.toRadians(20)?y.positionCartographic.height*.75:y.positionCartographic.height-_;var Ne=_/Re;y.rotate(Oe,Ie*Ne)}}else{P=true}}}r._rotatingZoom=!P}if(!C&&P||T){var Le;var Be=E.wgs84ToWindowCoordinates(g,r._zoomWorldPosition,L);if(w!==S.COLUMBUS_VIEW&&e.equals(i,r._zoomMouseStart)&&a(Be)){Le=y.getPickRay(Be,R)}else{Le=y.getPickRay(i,R)}var Fe=Le.direction;if(w===S.COLUMBUS_VIEW){t.fromElements(Fe.y,Fe.z,Fe.x,Fe)}y.move(Fe,_);r._zoomingOnVector=true}else{y.zoomIn(_)}}var ie=new _;var ne=new _;var ae=new t;function oe(e,r,i){var n=e._scene;var a=n.camera;var o=a.getPickRay(i.startPosition,ie).origin;var s=a.getPickRay(i.endPosition,ne).origin;var u=t.subtract(o,s,ae);var l=t.magnitude(u);if(l>0){t.normalize(u,u);a.move(u,l)}}function se(e,t,r){if(a(r.distance)){r=r.distance}var i=e._scene;var n=i.camera;re(e,t,r,e._zoomFactor,n.getMagnitude())}var ue=new e;var le=new e;function ce(t,r,i){if(a(i.angleAndHeight)){de(t,r,i.angleAndHeight);return}var n=t._scene;var o=n.camera;var s=n.canvas;var u=s.clientWidth;var l=s.clientHeight;var c=ue;c.x=2/u*i.startPosition.x-1;c.y=2/l*(l-i.startPosition.y)-1;c=e.normalize(c,c);var d=le;d.x=2/u*i.endPosition.x-1;d.y=2/l*(l-i.endPosition.y)-1;d=e.normalize(d,d);var h=f.acosClamped(c.x);if(c.y<0){h=f.TWO_PI-h}var p=f.acosClamped(d.x);if(d.y<0){p=f.TWO_PI-p}var m=p-h;o.twistRight(m)}function de(e,t,r){var i=e._rotateFactor*e._rotateRateRangeAdjustment;if(i>e._maximumRotateRate){i=e._maximumRotateRate}if(i<e._minimumRotateRate){i=e._minimumRotateRate}var n=e._scene;var a=n.camera;var o=n.canvas;var s=(r.endPosition.x-r.startPosition.x)/o.clientWidth;s=Math.min(s,e.maximumMovementRatio);var u=i*s*Math.PI*4;a.twistRight(u)}function fe(e){var t=e._scene.mapMode2D===C.ROTATE;if(!p.equals(p.IDENTITY,e._scene.camera.transform)){O(e,e.enableZoom,e.zoomEventTypes,se,e.inertiaZoom,"_lastInertiaZoomMovement");if(t){O(e,e.enableRotate,e.translateEventTypes,ce,e.inertiaSpin,"_lastInertiaSpinMovement")}}else{O(e,e.enableTranslate,e.translateEventTypes,oe,e.inertiaTranslate,"_lastInertiaTranslateMovement");O(e,e.enableZoom,e.zoomEventTypes,se,e.inertiaZoom,"_lastInertiaZoomMovement");if(t){O(e,e.enableRotate,e.tiltEventTypes,ce,e.inertiaSpin,"_lastInertiaTiltMovement")}}}var he=new _;var pe=new t;var me=new t;function ve(e,r,i){var n=e._scene;var o=e._globe;var s=n.camera;if(!a(o)){return undefined}var u;if(n.pickPositionSupported){u=n.pickPositionWorldCoordinates(r,pe)}var l=s.getPickRay(r,he);var c=o.pick(l,n,me);var d=a(u)?t.distance(u,s.positionWC):Number.POSITIVE_INFINITY;var f=a(c)?t.distance(c,s.positionWC):Number.POSITIVE_INFINITY;if(d<f){return t.clone(u,i)}return t.clone(c,i)}var _e=new _;var ge=new _;var ye=new t;var we=new t;var Ce=new t;var be=new t;var Se=new m(t.ZERO,0);var Ee=new e;var Te=new e;function xe(r,i,n){if(!t.equals(i,r._translateMousePosition)){r._looking=false}if(!t.equals(i,r._strafeMousePosition)){r._strafing=false}if(r._looking){Ut(r,i,n);return}if(r._strafing){Je(r,i,n);return}var o=r._scene;var s=o.camera;var u=e.clone(n.startPosition,Ee);var c=e.clone(n.endPosition,Te);var d=s.getPickRay(u,_e);var h=t.clone(t.ZERO,be);var p=t.UNIT_X;var v;if(s.position.z<r._minimumPickingTerrainHeight){v=ve(r,u,ye);if(a(v)){h.x=v.x}}if(h.x>s.position.z&&a(v)){t.clone(v,r._strafeStartPosition);r._strafing=true;Je(r,i,n);r._strafeMousePosition=e.clone(i,r._strafeMousePosition);return}var _=m.fromPointNormal(h,p,Se);d=s.getPickRay(u,_e);var g=l.rayPlane(d,_,ye);var y=s.getPickRay(c,ge);var w=l.rayPlane(y,_,we);if(!a(g)||!a(w)){r._looking=true;Ut(r,i,n);e.clone(i,r._translateMousePosition);return}var C=t.subtract(g,w,Ce);var b=C.x;C.x=C.y;C.y=C.z;C.z=b;var S=t.magnitude(C);if(S>f.EPSILON6){t.normalize(C,C);s.move(C,S)}}var Ae=new e;var Pe=new _;var De=new t;var Me=new t;var Ie=new p;var Oe=new p;var Re=new t;var Ne=new m(t.ZERO,0);var Le=new t;var Be=new i;var Fe=new p;var ke=new v;var Ve=new h;function ze(t,r,i){if(a(i.angleAndHeight)){i=i.angleAndHeight}if(!e.equals(r,t._tiltCenterMousePosition)){t._tiltCVOffMap=false;t._looking=false}if(t._looking){Ut(t,r,i);return}var n=t._scene;var o=n.camera;var s=t._maxCoord;var u=Math.abs(o.position.x)-s.x<0&&Math.abs(o.position.y)-s.y<0;if(t._tiltCVOffMap||!u||o.position.z>t._minimumPickingTerrainHeight){t._tiltCVOffMap=true;Ue(t,r,i)}else{qe(t,r,i)}}function Ue(r,i,n){var o=r._scene;var s=o.camera;var l=o.canvas;var c=Ae;c.x=l.clientWidth/2;c.y=l.clientHeight/2;var d=s.getPickRay(c,Pe);var h=t.UNIT_X;var m=d.origin;var v=d.direction;var _;var y=t.dot(h,v);if(Math.abs(y)>f.EPSILON6){_=-t.dot(h,m)/y}if(!a(_)||_<=0){r._looking=true;Ut(r,i,n);e.clone(i,r._tiltCenterMousePosition);return}var w=t.multiplyByScalar(v,_,De);t.add(m,w,w);var C=o.mapProjection;var b=C.ellipsoid;t.fromElements(w.y,w.z,w.x,w);var S=C.unproject(w,Be);b.cartographicToCartesian(S,w);var E=g.eastNorthUpToFixedFrame(w,b,Ie);var T=r._globe;var x=r._ellipsoid;r._globe=undefined;r._ellipsoid=u.UNIT_SPHERE;r._rotateFactor=1;r._rotateRateRangeAdjustment=1;var A=p.clone(s.transform,Fe);s._setTransform(E);ot(r,i,n,t.UNIT_Z);s._setTransform(A);r._globe=T;r._ellipsoid=x;var P=x.maximumRadius;r._rotateFactor=1/P;r._rotateRateRangeAdjustment=P}function qe(r,i,n){var o=r._scene;var s=o.camera;var c;var d;var _=t.UNIT_X;if(e.equals(i,r._tiltCenterMousePosition)){c=t.clone(r._tiltCenter,De)}else{if(s.position.z<r._minimumPickingTerrainHeight){c=ve(r,i,De)}if(!a(c)){d=s.getPickRay(i,Pe);var y=d.origin;var w=d.direction;var C;var b=t.dot(_,w);if(Math.abs(b)>f.EPSILON6){C=-t.dot(_,y)/b}if(!a(C)||C<=0){r._looking=true;Ut(r,i,n);e.clone(i,r._tiltCenterMousePosition);return}c=t.multiplyByScalar(w,C,De);t.add(y,c,c)}e.clone(i,r._tiltCenterMousePosition);t.clone(c,r._tiltCenter)}var S=o.canvas;var E=Ae;E.x=S.clientWidth/2;E.y=r._tiltCenterMousePosition.y;d=s.getPickRay(E,Pe);var T=t.clone(t.ZERO,Re);T.x=c.x;var x=m.fromPointNormal(T,_,Ne);var A=l.rayPlane(d,x,Me);var P=s._projection;var D=P.ellipsoid;t.fromElements(c.y,c.z,c.x,c);var M=P.unproject(c,Be);D.cartographicToCartesian(M,c);var I=g.eastNorthUpToFixedFrame(c,D,Ie);var O;if(a(A)){t.fromElements(A.y,A.z,A.x,A);M=P.unproject(A,Be);D.cartographicToCartesian(M,A);O=g.eastNorthUpToFixedFrame(A,D,Oe)}else{O=I}var R=r._globe;var N=r._ellipsoid;r._globe=undefined;r._ellipsoid=u.UNIT_SPHERE;r._rotateFactor=1;r._rotateRateRangeAdjustment=1;var L=t.UNIT_Z;var B=p.clone(s.transform,Fe);s._setTransform(I);var F=t.cross(t.UNIT_Z,t.normalize(s.position,Le),Le);var k=t.dot(s.right,F);ot(r,i,n,L,false,true);s._setTransform(O);if(k<0){if(n.startPosition.y>n.endPosition.y){L=undefined}var V=s.constrainedAxis;s.constrainedAxis=undefined;ot(r,i,n,L,true,false);s.constrainedAxis=V}else{ot(r,i,n,L,true,false)}if(a(s.constrainedAxis)){var z=t.cross(s.direction,s.constrainedAxis,Tt);if(!t.equalsEpsilon(z,t.ZERO,f.EPSILON6)){if(t.dot(z,s.right)<0){t.negate(z,z)}t.cross(z,s.direction,s.up);t.cross(s.direction,s.up,s.right);t.normalize(s.up,s.up);t.normalize(s.right,s.right)}}s._setTransform(B);r._globe=R;r._ellipsoid=N;var U=N.maximumRadius;r._rotateFactor=1/U;r._rotateRateRangeAdjustment=U;var q=t.clone(s.positionWC,Le);s._adjustHeightForTerrain();if(!t.equals(s.positionWC,q)){s._setTransform(O);s.worldToCameraCoordinatesPoint(q,q);var G=t.magnitudeSquared(q);if(t.magnitudeSquared(s.position)>G){t.normalize(s.position,s.position);t.multiplyByScalar(s.position,Math.sqrt(G),s.position)}var H=t.angleBetween(q,s.position);var W=t.cross(q,s.position,q);t.normalize(W,W);var j=v.fromAxisAngle(W,H,ke);var Y=h.fromQuaternion(j,Ve);h.multiplyByVector(Y,s.direction,s.direction);h.multiplyByVector(Y,s.up,s.up);t.cross(s.direction,s.up,s.right);t.cross(s.right,s.direction,s.up);s._setTransform(B)}}var Ge=new e;var He=new _;var We=new t;function je(e,r,i){if(a(i.distance)){i=i.distance}var n=e._scene;var o=n.camera;var s=n.canvas;var u=Ge;u.x=s.clientWidth/2;u.y=s.clientHeight/2;var l=o.getPickRay(u,He);var c;if(o.position.z<e._minimumPickingTerrainHeight){c=ve(e,u,We)}var d;if(a(c)){d=t.distance(l.origin,c)}else{var f=t.UNIT_X;var h=l.origin;var p=l.direction;d=-t.dot(f,h)/t.dot(f,p)}re(e,r,i,e._zoomFactor,d)}function Ye(e){var t=e._scene;var r=t.camera;if(!p.equals(p.IDENTITY,r.transform)){O(e,e.enableRotate,e.rotateEventTypes,ot,e.inertiaSpin,"_lastInertiaSpinMovement");O(e,e.enableZoom,e.zoomEventTypes,gt,e.inertiaZoom,"_lastInertiaZoomMovement")}else{var i=e._tweens;if(e._aggregator.anyButtonDown){i.removeAll()}O(e,e.enableTilt,e.tiltEventTypes,ze,e.inertiaSpin,"_lastInertiaTiltMovement");O(e,e.enableTranslate,e.translateEventTypes,xe,e.inertiaTranslate,"_lastInertiaTranslateMovement");O(e,e.enableZoom,e.zoomEventTypes,je,e.inertiaZoom,"_lastInertiaZoomMovement");O(e,e.enableLook,e.lookEventTypes,Ut);if(!e._aggregator.anyButtonDown&&(!a(e._lastInertiaZoomMovement)||!e._lastInertiaZoomMovement.active)&&(!a(e._lastInertiaTranslateMovement)||!e._lastInertiaTranslateMovement.active)&&!i.contains(e._tween)){var n=r.createCorrectPositionTween(e.bounceAnimationTime);if(a(n)){e._tween=i.add(n)}}i.update()}}var Xe=new _;var Ze=new m(t.ZERO,0);var Ke=new t;var Qe=new t;function Je(e,r,i){var n=e._scene;var o=n.camera;var s=ve(e,i.startPosition,tt);if(!a(s)){return}var u=i.endPosition;var c=o.getPickRay(u,Xe);var d=t.clone(o.direction,Qe);if(n.mode===S.COLUMBUS_VIEW){t.fromElements(d.z,d.x,d.y,d)}var f=m.fromPointNormal(s,d,Ze);var h=l.rayPlane(c,f,Ke);if(!a(h)){return}d=t.subtract(s,h,d);if(n.mode===S.COLUMBUS_VIEW){t.fromElements(d.y,d.z,d.x,d)}t.add(o.position,d,o.position)}var $e=new t;var et=new i;var tt=new t;var rt=new t;var it=new u;var nt=new t;function at(r,i,n){var o=r._scene;var s=o.camera;if(!p.equals(s.transform,p.IDENTITY)){ot(r,i,n);return}var l;var c;var d;var f=r._ellipsoid.geodeticSurfaceNormal(s.position,nt);var h=r._ellipsoid.cartesianToCartographic(s.positionWC,et).height;var m=r._globe;var v;var _=false;if(a(m)&&h<r._minimumPickingTerrainHeight){v=ve(r,n.startPosition,tt);if(a(v)){var g=s.getPickRay(n.startPosition,he);var y=r._ellipsoid.geodeticSurfaceNormal(v);_=Math.abs(t.dot(g.direction,y))<.05;if(_&&!r._looking){r._rotating=false;r._strafing=true}}}if(e.equals(i,r._rotateMousePosition)){if(r._looking){Ut(r,i,n,f)}else if(r._rotating){ot(r,i,n)}else if(r._strafing){t.clone(v,r._strafeStartPosition);Je(r,i,n)}else{l=t.magnitude(r._rotateStartPosition);c=rt;c.x=c.y=c.z=l;d=u.fromCartesian3(c,it);mt(r,i,n,d)}return}else{r._looking=false;r._rotating=false;r._strafing=false}if(a(m)&&h<r._minimumPickingTerrainHeight){if(a(v)){if(t.magnitude(s.position)<t.magnitude(v)){t.clone(v,r._strafeStartPosition);r._strafing=true;Je(r,i,n)}else{l=t.magnitude(v);c=rt;c.x=c.y=c.z=l;d=u.fromCartesian3(c,it);mt(r,i,n,d);t.clone(v,r._rotateStartPosition)}}else{r._looking=true;Ut(r,i,n,f)}}else if(a(s.pickEllipsoid(n.startPosition,r._ellipsoid,$e))){mt(r,i,n,r._ellipsoid);t.clone($e,r._rotateStartPosition)}else if(h>r._minimumTrackBallHeight){r._rotating=true;ot(r,i,n)}else{r._looking=true;Ut(r,i,n,f)}e.clone(i,r._rotateMousePosition)}function ot(e,r,i,o,s,u){s=n(s,false);u=n(u,false);var l=e._scene;var c=l.camera;var d=l.canvas;var f=c.constrainedAxis;if(a(o)){c.constrainedAxis=o}var h=t.magnitude(c.position);var p=e._rotateFactor*(h-e._rotateRateRangeAdjustment);if(p>e._maximumRotateRate){p=e._maximumRotateRate}if(p<e._minimumRotateRate){p=e._minimumRotateRate}var m=(i.startPosition.x-i.endPosition.x)/d.clientWidth;var v=(i.startPosition.y-i.endPosition.y)/d.clientHeight;m=Math.min(m,e.maximumMovementRatio);v=Math.min(v,e.maximumMovementRatio);var _=p*m*Math.PI*2;var g=p*v*Math.PI;if(!s){c.rotateRight(_)}if(!u){c.rotateUp(g)}c.constrainedAxis=f}var st=r.clone(r.UNIT_W);var ut=r.clone(r.UNIT_W);var lt=new t;var ct=new t;var dt=new t;var ft=new t;var ht=new e;var pt=new e;function mt(r,i,n,o){var s=r._scene;var u=s.camera;var l=e.clone(n.startPosition,ht);var c=e.clone(n.endPosition,pt);var d=u.pickEllipsoid(l,o,st);var h=u.pickEllipsoid(c,o,ut);if(!a(d)||!a(h)){r._rotating=true;ot(r,i,n);return}d=u.worldToCameraCoordinates(d,d);h=u.worldToCameraCoordinates(h,h);if(!a(u.constrainedAxis)){t.normalize(d,d);t.normalize(h,h);var p=t.dot(d,h);var m=t.cross(d,h,lt);if(p<1&&!t.equalsEpsilon(m,t.ZERO,f.EPSILON14)){var v=Math.acos(p);u.rotate(m,v)}}else{var _=u.constrainedAxis;var g=t.mostOrthogonalAxis(_,lt);t.cross(g,_,g);t.normalize(g,g);var y=t.cross(_,g,ct);var w=t.magnitude(d);var C=t.dot(_,d);var b=Math.acos(C/w);var S=t.multiplyByScalar(_,C,dt);t.subtract(d,S,S);t.normalize(S,S);var E=t.magnitude(h);var T=t.dot(_,h);var x=Math.acos(T/E);var A=t.multiplyByScalar(_,T,ft);t.subtract(h,A,A);t.normalize(A,A);var P=Math.acos(t.dot(S,g));if(t.dot(S,y)<0){P=f.TWO_PI-P}var D=Math.acos(t.dot(A,g));if(t.dot(A,y)<0){D=f.TWO_PI-D}var M=P-D;var I;if(t.equalsEpsilon(_,u.position,f.EPSILON2)){I=u.right}else{I=t.cross(_,u.position,lt)}var O=t.cross(_,I,lt);var R=t.dot(O,t.subtract(d,_,ct));var N=t.dot(O,t.subtract(h,_,ct));var L;if(R>0&&N>0){L=x-b}else if(R>0&&N<=0){if(t.dot(u.position,_)>0){L=-b-x}else{L=b+x}}else{L=b-x}u.rotateRight(M);u.rotateUp(L)}}var vt=new t;var _t=new i;function gt(e,r,i){if(a(i.distance)){i=i.distance}var n=e._ellipsoid;var o=e._scene;var s=o.camera;var u=o.canvas;var l=Ge;l.x=u.clientWidth/2;l.y=u.clientHeight/2;var c=s.getPickRay(l,He);var d;var f=n.cartesianToCartographic(s.position,_t).height;if(f<e._minimumPickingTerrainHeight){d=ve(e,l,We)}var h;if(a(d)){h=t.distance(c.origin,d)}else{h=f}var p=t.normalize(s.position,vt);re(e,r,i,e._zoomFactor,h,t.dot(p,s.direction))}var yt=new e;var wt=new _;var Ct=new t;var bt=new t;var St=new p;var Et=new p;var Tt=new t;var xt=new p;var At=new v;var Pt=new h;var Dt=new i;var Mt=new t;function It(t,r,i){var n=t._scene;var o=n.camera;if(!p.equals(o.transform,p.IDENTITY)){return}if(a(i.angleAndHeight)){i=i.angleAndHeight}if(!e.equals(r,t._tiltCenterMousePosition)){t._tiltOnEllipsoid=false;t._looking=false}if(t._looking){var s=t._ellipsoid.geodeticSurfaceNormal(o.position,Mt);Ut(t,r,i,s);return}var u=t._ellipsoid;var l=u.cartesianToCartographic(o.position,Dt);if(t._tiltOnEllipsoid||l.height>t._minimumCollisionTerrainHeight){t._tiltOnEllipsoid=true;Rt(t,r,i)}else{Nt(t,r,i)}}var Ot=new i;function Rt(r,i,n){var o=r._ellipsoid;var s=r._scene;var c=s.camera;var d=r.minimumZoomDistance*.25;var h=o.cartesianToCartographic(c.positionWC,Ot).height;if(h-d-1<f.EPSILON3&&n.endPosition.y-n.startPosition.y<0){return}var m=s.canvas;var v=yt;v.x=m.clientWidth/2;v.y=m.clientHeight/2;var y=c.getPickRay(v,wt);var w;var C=l.rayEllipsoid(y,o);if(a(C)){w=_.getPoint(y,C.start,Ct)}else if(h>r._minimumTrackBallHeight){var b=l.grazingAltitudeLocation(y,o);if(!a(b)){return}var S=o.cartesianToCartographic(b,Dt);S.height=0;w=o.cartographicToCartesian(S,Ct)}else{r._looking=true;var E=r._ellipsoid.geodeticSurfaceNormal(c.position,Mt);Ut(r,i,n,E);e.clone(i,r._tiltCenterMousePosition);return}var T=g.eastNorthUpToFixedFrame(w,o,St);var x=r._globe;var A=r._ellipsoid;r._globe=undefined;r._ellipsoid=u.UNIT_SPHERE;r._rotateFactor=1;r._rotateRateRangeAdjustment=1;var P=p.clone(c.transform,xt);c._setTransform(T);ot(r,i,n,t.UNIT_Z);c._setTransform(P);r._globe=x;r._ellipsoid=A;var D=A.maximumRadius;r._rotateFactor=1/D;r._rotateRateRangeAdjustment=D}function Nt(r,i,n){var o=r._ellipsoid;var s=r._scene;var c=s.camera;var d;var m;var y;if(e.equals(i,r._tiltCenterMousePosition)){d=t.clone(r._tiltCenter,Ct)}else{d=ve(r,i,Ct);if(!a(d)){m=c.getPickRay(i,wt);y=l.rayEllipsoid(m,o);if(!a(y)){var w=o.cartesianToCartographic(c.position,Dt);if(w.height<=r._minimumTrackBallHeight){r._looking=true;var C=r._ellipsoid.geodeticSurfaceNormal(c.position,Mt);Ut(r,i,n,C);e.clone(i,r._tiltCenterMousePosition)}return}d=_.getPoint(m,y.start,Ct)}e.clone(i,r._tiltCenterMousePosition);t.clone(d,r._tiltCenter)}var b=s.canvas;var S=yt;S.x=b.clientWidth/2;S.y=r._tiltCenterMousePosition.y;m=c.getPickRay(S,wt);var E=t.magnitude(d);var T=t.fromElements(E,E,E,rt);var x=u.fromCartesian3(T,it);y=l.rayEllipsoid(m,x);if(!a(y)){return}var A=t.magnitude(m.origin)>E?y.start:y.stop;var P=_.getPoint(m,A,bt);var D=g.eastNorthUpToFixedFrame(d,o,St);var M=g.eastNorthUpToFixedFrame(P,x,Et);var I=r._globe;var O=r._ellipsoid;r._globe=undefined;r._ellipsoid=u.UNIT_SPHERE;r._rotateFactor=1;r._rotateRateRangeAdjustment=1;var R=t.UNIT_Z;var N=p.clone(c.transform,xt);c._setTransform(D);var L=t.cross(P,c.positionWC,Tt);var B=t.dot(c.rightWC,L);ot(r,i,n,R,false,true);c._setTransform(M);if(B<0){if(n.startPosition.y>n.endPosition.y){R=undefined}var F=c.constrainedAxis;c.constrainedAxis=undefined;ot(r,i,n,R,true,false);c.constrainedAxis=F}else{ot(r,i,n,R,true,false)}if(a(c.constrainedAxis)){var k=t.cross(c.direction,c.constrainedAxis,Tt);if(!t.equalsEpsilon(k,t.ZERO,f.EPSILON6)){if(t.dot(k,c.right)<0){t.negate(k,k)}t.cross(k,c.direction,c.up);t.cross(c.direction,c.up,c.right);t.normalize(c.up,c.up);t.normalize(c.right,c.right)}}c._setTransform(N);r._globe=I;r._ellipsoid=O;var V=O.maximumRadius;r._rotateFactor=1/V;r._rotateRateRangeAdjustment=V;var z=t.clone(c.positionWC,Tt);c._adjustHeightForTerrain();if(!t.equals(c.positionWC,z)){c._setTransform(M);c.worldToCameraCoordinatesPoint(z,z);var U=t.magnitudeSquared(z);if(t.magnitudeSquared(c.position)>U){t.normalize(c.position,c.position);t.multiplyByScalar(c.position,Math.sqrt(U),c.position)}var q=t.angleBetween(z,c.position);var G=t.cross(z,c.position,z);t.normalize(G,G);var H=v.fromAxisAngle(G,q,At);var W=h.fromQuaternion(H,Pt);h.multiplyByVector(W,c.direction,c.direction);h.multiplyByVector(W,c.up,c.up);t.cross(c.direction,c.up,c.right);t.cross(c.right,c.direction,c.up);c._setTransform(N)}}var Lt=new e;var Bt=new e;var Ft=new _;var kt=new _;var Vt=new t;var zt=new t;function Ut(e,r,i,o){var s=e._scene;var u=s.camera;var l=Lt;l.x=i.startPosition.x;l.y=0;var c=Bt;c.x=i.endPosition.x;c.y=0;var d=u.getPickRay(l,Ft);var h=u.getPickRay(c,kt);var p=0;var m;var v;if(u.frustum instanceof b){m=d.origin;v=h.origin;t.add(u.direction,m,m);t.add(u.direction,v,v);t.subtract(m,u.position,m);t.subtract(v,u.position,v);t.normalize(m,m);t.normalize(v,v)}else{m=d.direction;v=h.direction}var _=t.dot(m,v);if(_<1){p=Math.acos(_)}p=i.startPosition.x>i.endPosition.x?-p:p;var g=e._horizontalRotationAxis;if(a(o)){u.look(o,-p)}else if(a(g)){u.look(g,-p)}else{u.lookLeft(p)}l.x=0;l.y=i.startPosition.y;c.x=0;c.y=i.endPosition.y;d=u.getPickRay(l,Ft);h=u.getPickRay(c,kt);p=0;if(u.frustum instanceof b){m=d.origin;v=h.origin;t.add(u.direction,m,m);t.add(u.direction,v,v);t.subtract(m,u.position,m);t.subtract(v,u.position,v);t.normalize(m,m);t.normalize(v,v)}else{m=d.direction;v=h.direction}_=t.dot(m,v);if(_<1){p=Math.acos(_)}p=i.startPosition.y>i.endPosition.y?-p:p;o=n(o,g);if(a(o)){var y=u.direction;var w=t.negate(o,Vt);var C=t.equalsEpsilon(y,o,f.EPSILON2);var S=t.equalsEpsilon(y,w,f.EPSILON2);if(!C&&!S){_=t.dot(y,o);var E=f.acosClamped(_);if(p>0&&p>E){p=E-f.EPSILON4}_=t.dot(y,w);E=f.acosClamped(_);if(p<0&&-p>E){p=-E+f.EPSILON4}var T=t.cross(o,y,zt);u.look(T,p)}else if(C&&p<0||S&&p>0){u.look(u.right,-p)}}else{u.lookUp(p)}}function qt(e){O(e,e.enableRotate,e.rotateEventTypes,at,e.inertiaSpin,"_lastInertiaSpinMovement");O(e,e.enableZoom,e.zoomEventTypes,gt,e.inertiaZoom,"_lastInertiaZoomMovement");O(e,e.enableTilt,e.tiltEventTypes,It,e.inertiaSpin,"_lastInertiaTiltMovement");O(e,e.enableLook,e.lookEventTypes,Ut)}x.prototype.update=function(){if(!p.equals(this._scene.camera.transform,p.IDENTITY)){this._globe=undefined;this._ellipsoid=u.UNIT_SPHERE}else{this._globe=this._scene.globe;this._ellipsoid=a(this._globe)?this._globe.ellipsoid:this._scene.mapProjection.ellipsoid}this._minimumCollisionTerrainHeight=this.minimumCollisionTerrainHeight*this._scene.terrainExaggeration;this._minimumPickingTerrainHeight=this.minimumPickingTerrainHeight*this._scene.terrainExaggeration;this._minimumTrackBallHeight=this.minimumTrackBallHeight*this._scene.terrainExaggeration;var e=this._ellipsoid.maximumRadius;this._rotateFactor=1/e;this._rotateRateRangeAdjustment=e;var r=this._scene;var i=r.mode;if(i===S.SCENE2D){fe(this)}else if(i===S.COLUMBUS_VIEW){this._horizontalRotationAxis=t.UNIT_Z;Ye(this)}else if(i===S.SCENE3D){this._horizontalRotationAxis=undefined;qt(this)}this._aggregator.reset()};x.prototype.isDestroyed=function(){return false};x.prototype.destroy=function(){this._tweens.removeAll();this._aggregator=this._aggregator&&this._aggregator.destroy();return o(this)};return x});define("Scene/ShadowMapShader",["../Core/defined","../Renderer/ShaderSource"],function(e,t){"use strict";function r(){}r.getShadowCastShaderKeyword=function(e,t,r,i){return"castShadow "+e+" "+t+" "+r+" "+i};r.createShadowCastVertexShader=function(r,i,n){var a=r.defines.slice(0);var o=r.sources.slice(0);if(n){a.push("GENERATE_POSITION")}var s=t.findPositionVarying(r);var u=e(s);if(i&&!u){var l=o.length;for(var c=0;c<l;++c){o[c]=t.replaceMain(o[c],"czm_shadow_cast_main")}var d="varying vec3 v_positionEC; \n"+"void main() \n"+"{ \n"+"    czm_shadow_cast_main(); \n"+"    v_positionEC = (czm_inverseProjection * gl_Position).xyz; \n"+"}";o.push(d)}return new t({defines:a,sources:o})};r.createShadowCastFragmentShader=function(r,i,n,a){var o=r.defines.slice(0);var s=r.sources.slice(0);var u=t.findPositionVarying(r);var l=e(u);if(!l){u="v_positionEC"}var c=s.length;for(var d=0;d<c;++d){s[d]=t.replaceMain(s[d],"czm_shadow_cast_main")}var f="";if(i){if(!l){f+="varying vec3 v_positionEC; \n"}f+="uniform vec4 shadowMap_lightPositionEC; \n"}if(a){f+="void main() \n"+"{ \n"}else{f+="void main() \n"+"{ \n"+"    czm_shadow_cast_main(); \n"+"    if (gl_FragColor.a == 0.0) \n"+"    { \n"+"       discard; \n"+"    } \n"}if(i){f+="float distance = length("+u+"); \n"+"distance /= shadowMap_lightPositionEC.w; // radius \n"+"gl_FragColor = czm_packDepth(distance); \n"}else if(n){f+="gl_FragColor = vec4(1.0); \n"}else{f+="gl_FragColor = czm_packDepth(gl_FragCoord.z); \n"}f+="} \n";s.push(f);return new t({defines:o,sources:s})};r.getShadowReceiveShaderKeyword=function(e,t,r,i){var n=e._usesDepthTexture;var a=e._polygonOffsetSupported;var o=e._isPointLight;var s=e._isSpotLight;var u=e._numberOfCascades>1;var l=e.debugCascadeColors;var c=e.softShadows;return"receiveShadow "+n+a+o+s+u+l+c+t+r+i};r.createShadowReceiveVertexShader=function(e,r,i){var n=e.defines.slice(0);var a=e.sources.slice(0);if(r){if(i){n.push("GENERATE_POSITION_AND_NORMAL")}else{n.push("GENERATE_POSITION")}}return new t({defines:n,sources:a})};r.createShadowReceiveFragmentShader=function(r,i,n,a,o){var s=t.findNormalVarying(r);var u=!a&&e(s)||a&&o;var l=t.findPositionVarying(r);var c=e(l);var d=i._usesDepthTexture;var f=i._polygonOffsetSupported;var h=i._isPointLight;var p=i._isSpotLight;var m=i._numberOfCascades>1;var v=i.debugCascadeColors;var _=i.softShadows;var g=h?i._pointBias:a?i._terrainBias:i._primitiveBias;var y=r.defines.slice(0);var w=r.sources.slice(0);var C=w.length;for(var b=0;b<C;++b){w[b]=t.replaceMain(w[b],"czm_shadow_receive_main")}if(h){y.push("USE_CUBE_MAP_SHADOW")}else if(d){y.push("USE_SHADOW_DEPTH_TEXTURE")}if(_&&!h){y.push("USE_SOFT_SHADOWS")}if(m&&n&&a){if(u){y.push("ENABLE_VERTEX_LIGHTING")}else{y.push("ENABLE_DAYNIGHT_SHADING")}}if(n&&g.normalShading&&u){y.push("USE_NORMAL_SHADING");if(g.normalShadingSmooth>0){y.push("USE_NORMAL_SHADING_SMOOTH")}}var S="";if(h){S+="uniform samplerCube shadowMap_textureCube; \n"}else{S+="uniform sampler2D shadowMap_texture; \n"}S+="uniform mat4 shadowMap_matrix; \n"+"uniform vec3 shadowMap_lightDirectionEC; \n"+"uniform vec4 shadowMap_lightPositionEC; \n"+"uniform vec4 shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness; \n"+"uniform vec4 shadowMap_texelSizeDepthBiasAndNormalShadingSmooth; \n"+"vec4 getPositionEC() \n"+"{ \n"+(c?"    return vec4("+l+", 1.0); \n":"    return czm_windowToEyeCoordinates(gl_FragCoord); \n")+"} \n"+"vec3 getNormalEC() \n"+"{ \n"+(u?"    return normalize("+s+"); \n":"    return vec3(1.0); \n")+"} \n"+"void applyNormalOffset(inout vec4 positionEC, vec3 normalEC, float nDotL) \n"+"{ \n"+(g.normalOffset&&u?"    float normalOffset = shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness.x; \n"+"    float normalOffsetScale = 1.0 - nDotL; \n"+"    vec3 offset = normalOffset * normalOffsetScale * normalEC; \n"+"    positionEC.xyz += offset; \n":"")+"} \n";S+="void main() \n"+"{ \n"+"    czm_shadow_receive_main(); \n"+"    vec4 positionEC = getPositionEC(); \n"+"    vec3 normalEC = getNormalEC(); \n"+"    float depth = -positionEC.z; \n";S+="    czm_shadowParameters shadowParameters; \n"+"    shadowParameters.texelStepSize = shadowMap_texelSizeDepthBiasAndNormalShadingSmooth.xy; \n"+"    shadowParameters.depthBias = shadowMap_texelSizeDepthBiasAndNormalShadingSmooth.z; \n"+"    shadowParameters.normalShadingSmooth = shadowMap_texelSizeDepthBiasAndNormalShadingSmooth.w; \n"+"    shadowParameters.darkness = shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness.w; \n";if(a){S+="    shadowParameters.depthBias *= max(depth * 0.01, 1.0); \n"}else if(!f){S+="    shadowParameters.depthBias *= mix(1.0, 100.0, depth * 0.0015); \n"}if(h){S+="    vec3 directionEC = positionEC.xyz - shadowMap_lightPositionEC.xyz; \n"+"    float distance = length(directionEC); \n"+"    directionEC = normalize(directionEC); \n"+"    float radius = shadowMap_lightPositionEC.w; \n"+"    // Stop early if the fragment is beyond the point light radius \n"+"    if (distance > radius) \n"+"    { \n"+"        return; \n"+"    } \n"+"    vec3 directionWC  = czm_inverseViewRotation * directionEC; \n"+"    shadowParameters.depth = distance / radius; \n"+"    shadowParameters.nDotL = clamp(dot(normalEC, -directionEC), 0.0, 1.0); \n"+"    shadowParameters.texCoords = directionWC; \n"+"    float visibility = czm_shadowVisibility(shadowMap_textureCube, shadowParameters); \n"}else if(p){S+="    vec3 directionEC = normalize(positionEC.xyz - shadowMap_lightPositionEC.xyz); \n"+"    float nDotL = clamp(dot(normalEC, -directionEC), 0.0, 1.0); \n"+"    applyNormalOffset(positionEC, normalEC, nDotL); \n"+"    vec4 shadowPosition = shadowMap_matrix * positionEC; \n"+"    // Spot light uses a perspective projection, so perform the perspective divide \n"+"    shadowPosition /= shadowPosition.w; \n"+"    // Stop early if the fragment is not in the shadow bounds \n"+"    if (any(lessThan(shadowPosition.xyz, vec3(0.0))) || any(greaterThan(shadowPosition.xyz, vec3(1.0)))) \n"+"    { \n"+"        return; \n"+"    } \n"+"    shadowParameters.texCoords = shadowPosition.xy; \n"+"    shadowParameters.depth = shadowPosition.z; \n"+"    shadowParameters.nDotL = nDotL; \n"+"    float visibility = czm_shadowVisibility(shadowMap_texture, shadowParameters); \n"}else if(m){S+="    float maxDepth = shadowMap_cascadeSplits[1].w; \n"+"    // Stop early if the eye depth exceeds the last cascade \n"+"    if (depth > maxDepth) \n"+"    { \n"+"        return; \n"+"    } \n"+"    // Get the cascade based on the eye-space depth \n"+"    vec4 weights = czm_cascadeWeights(depth); \n"+"    // Apply normal offset \n"+"    float nDotL = clamp(dot(normalEC, shadowMap_lightDirectionEC), 0.0, 1.0); \n"+"    applyNormalOffset(positionEC, normalEC, nDotL); \n"+"    // Transform position into the cascade \n"+"    vec4 shadowPosition = czm_cascadeMatrix(weights) * positionEC; \n"+"    // Get visibility \n"+"    shadowParameters.texCoords = shadowPosition.xy; \n"+"    shadowParameters.depth = shadowPosition.z; \n"+"    shadowParameters.nDotL = nDotL; \n"+"    float visibility = czm_shadowVisibility(shadowMap_texture, shadowParameters); \n"+"    // Fade out shadows that are far away \n"+"    float shadowMapMaximumDistance = shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness.z; \n"+"    float fade = max((depth - shadowMapMaximumDistance * 0.8) / (shadowMapMaximumDistance * 0.2), 0.0); \n"+"    visibility = mix(visibility, 1.0, fade); \n"+(v?"    // Draw cascade colors for debugging \n"+"    gl_FragColor *= czm_cascadeColor(weights); \n":"")}else{
S+="    float nDotL = clamp(dot(normalEC, shadowMap_lightDirectionEC), 0.0, 1.0); \n"+"    applyNormalOffset(positionEC, normalEC, nDotL); \n"+"    vec4 shadowPosition = shadowMap_matrix * positionEC; \n"+"    // Stop early if the fragment is not in the shadow bounds \n"+"    if (any(lessThan(shadowPosition.xyz, vec3(0.0))) || any(greaterThan(shadowPosition.xyz, vec3(1.0)))) \n"+"    { \n"+"        return; \n"+"    } \n"+"    shadowParameters.texCoords = shadowPosition.xy; \n"+"    shadowParameters.depth = shadowPosition.z; \n"+"    shadowParameters.nDotL = nDotL; \n"+"    float visibility = czm_shadowVisibility(shadowMap_texture, shadowParameters); \n"}S+="    gl_FragColor.rgb *= visibility; \n"+"} \n";w.push(S);return new t({defines:y,sources:w})};return r});define("Scene/ShadowMap",["../Core/BoundingRectangle","../Core/BoundingSphere","../Core/BoxOutlineGeometry","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Cartographic","../Core/clone","../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/combine","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/FeatureDetection","../Core/GeometryInstance","../Core/Intersect","../Core/Math","../Core/Matrix4","../Core/PixelFormat","../Core/Quaternion","../Core/SphereOutlineGeometry","../Core/WebGLConstants","../Renderer/ClearCommand","../Renderer/ContextLimits","../Renderer/CubeMap","../Renderer/DrawCommand","../Renderer/Framebuffer","../Renderer/Pass","../Renderer/PassState","../Renderer/PixelDatatype","../Renderer/Renderbuffer","../Renderer/RenderbufferFormat","../Renderer/RenderState","../Renderer/Sampler","../Renderer/Texture","../Renderer/TextureMagnificationFilter","../Renderer/TextureMinificationFilter","../Renderer/TextureWrap","./Camera","./CullFace","./CullingVolume","./DebugCameraPrimitive","./OrthographicOffCenterFrustum","./PerInstanceColorAppearance","./PerspectiveFrustum","./Primitive","./ShadowMapShader"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w,C,b,S,E,T,x,A,P,D,M,I,O,R,N,L,B,F,k,V,z,U,q,G,H,W,j,Y,X,Z){"use strict";function K(e){e=d(e,d.EMPTY_OBJECT);var r=e.context;if(!f(r)){throw new m("context is required.")}if(!f(e.lightCamera)){throw new m("lightCamera is required.")}if(f(e.numberOfCascades)&&(e.numberOfCascades!==1&&e.numberOfCascades!==4)){throw new m("Only one or four cascades are supported.")}this._enabled=d(e.enabled,true);this._softShadows=d(e.softShadows,false);this._normalOffset=d(e.normalOffset,true);this.dirty=true;this.fromLightSource=d(e.fromLightSource,true);this.darkness=d(e.darkness,.3);this._darkness=this.darkness;this.maximumDistance=d(e.maximumDistance,5e3);this._outOfView=false;this._outOfViewPrevious=false;this._needsUpdate=true;var o=true;if(v.isInternetExplorer()||v.isEdge()||(v.isChrome()||v.isFirefox())&&v.isWindows()&&!r.depthTexture){o=false}this._polygonOffsetSupported=o;this._terrainBias={polygonOffset:o,polygonOffsetFactor:1.1,polygonOffsetUnits:4,normalOffset:this._normalOffset,normalOffsetScale:.5,normalShading:true,normalShadingSmooth:.3,depthBias:1e-4};this._primitiveBias={polygonOffset:o,polygonOffsetFactor:1.1,polygonOffsetUnits:4,normalOffset:this._normalOffset,normalOffsetScale:.1,normalShading:true,normalShadingSmooth:.05,depthBias:2e-5};this._pointBias={polygonOffset:false,polygonOffsetFactor:1.1,polygonOffsetUnits:4,normalOffset:this._normalOffset,normalOffsetScale:0,normalShading:true,normalShadingSmooth:.1,depthBias:5e-4};this._depthAttachment=undefined;this._colorAttachment=undefined;this._shadowMapMatrix=new w;this._shadowMapTexture=undefined;this._lightDirectionEC=new n;this._lightPositionEC=new a;this._distance=0;this._lightCamera=e.lightCamera;this._shadowMapCamera=new Ce;this._shadowMapCullingVolume=undefined;this._sceneCamera=undefined;this._boundingSphere=new t;this._isPointLight=d(e.isPointLight,false);this._pointLightRadius=d(e.pointLightRadius,100);this._cascadesEnabled=this._isPointLight?false:d(e.cascadesEnabled,true);this._numberOfCascades=!this._cascadesEnabled?0:d(e.numberOfCascades,4);this._fitNearFar=true;this._maximumCascadeDistances=[25,150,700,Number.MAX_VALUE];this._textureSize=new i;this._isSpotLight=false;if(this._cascadesEnabled){this._shadowMapCamera.frustum=new W}else if(f(this._lightCamera.frustum.fov)){this._isSpotLight=true}this._cascadeSplits=[new a,new a];this._cascadeMatrices=[new w,new w,new w,new w];this._cascadeDistances=new a;var s;if(this._isPointLight){s=6}else if(!this._cascadesEnabled){s=1}else{s=this._numberOfCascades}this._passes=new Array(s);for(var l=0;l<s;++l){this._passes[l]=new Q(r)}this.debugShow=false;this.debugFreezeFrame=false;this._debugFreezeFrame=false;this._debugCascadeColors=false;this._debugLightFrustum=undefined;this._debugCameraFrustum=undefined;this._debugCascadeFrustums=new Array(this._numberOfCascades);this._debugShadowViewCommand=undefined;this._usesDepthTexture=r.depthTexture;if(this._isPointLight){this._usesDepthTexture=false}this._primitiveRenderState=undefined;this._terrainRenderState=undefined;this._pointRenderState=undefined;$(this);this._clearCommand=new T({depth:1,color:new u});this._clearPassState=new I(r);this._size=d(e.size,2048);this.size=this._size}K.MAXIMUM_DISTANCE=2e4;function Q(e){this.camera=new Ce;this.passState=new I(e);this.framebuffer=undefined;this.textureOffsets=undefined;this.commandList=[];this.cullingVolume=undefined}function J(e,t){return L.fromCache({cull:{enabled:true,face:q.BACK},depthTest:{enabled:true},colorMask:{red:e,green:e,blue:e,alpha:e},depthMask:true,polygonOffset:{enabled:t.polygonOffset,factor:t.polygonOffsetFactor,units:t.polygonOffsetUnits}})}function $(e){var t=!e._usesDepthTexture;e._primitiveRenderState=J(t,e._primitiveBias);e._terrainRenderState=J(t,e._terrainBias);e._pointRenderState=J(t,e._pointBias)}K.prototype.debugCreateRenderStates=function(){$(this)};h(K.prototype,{enabled:{get:function(){return this._enabled},set:function(e){this.dirty=this._enabled!==e;this._enabled=e}},normalOffset:{get:function(){return this._normalOffset},set:function(e){this.dirty=this._normalOffset!==e;this._normalOffset=e;this._terrainBias.normalOffset=e;this._primitiveBias.normalOffset=e;this._pointBias.normalOffset=e}},softShadows:{get:function(){return this._softShadows},set:function(e){this.dirty=this._softShadows!==e;this._softShadows=e}},size:{get:function(){return this._size},set:function(e){le(this,e)}},outOfView:{get:function(){return this._outOfView}},shadowMapCullingVolume:{get:function(){return this._shadowMapCullingVolume}},passes:{get:function(){return this._passes}},isPointLight:{get:function(){return this._isPointLight}},debugCascadeColors:{get:function(){return this._debugCascadeColors},set:function(e){this.dirty=this._debugCascadeColors!==e;this._debugCascadeColors=e}}});function ee(e){var t=e._passes.length;for(var r=0;r<t;++r){var i=e._passes[r];var n=i.framebuffer;if(f(n)&&!n.isDestroyed()){n.destroy()}i.framebuffer=undefined}e._depthAttachment=e._depthAttachment&&e._depthAttachment.destroy();e._colorAttachment=e._colorAttachment&&e._colorAttachment.destroy()}function te(){return new B({wrapS:z.CLAMP_TO_EDGE,wrapT:z.CLAMP_TO_EDGE,minificationFilter:V.NEAREST,magnificationFilter:k.NEAREST})}function re(e,t){var r=new R({context:t,width:e._textureSize.x,height:e._textureSize.y,format:N.DEPTH_COMPONENT16});var i=new F({context:t,width:e._textureSize.x,height:e._textureSize.y,pixelFormat:C.RGBA,pixelDatatype:O.UNSIGNED_BYTE,sampler:te()});var n=new D({context:t,depthRenderbuffer:r,colorTextures:[i],destroyAttachments:false});var a=e._passes.length;for(var o=0;o<a;++o){var s=e._passes[o];s.framebuffer=n;s.passState.framebuffer=n}e._shadowMapTexture=i;e._depthAttachment=r;e._colorAttachment=i}function ie(e,t){var r=new F({context:t,width:e._textureSize.x,height:e._textureSize.y,pixelFormat:C.DEPTH_STENCIL,pixelDatatype:O.UNSIGNED_INT_24_8,sampler:te()});var i=new D({context:t,depthStencilTexture:r,destroyAttachments:false});var n=e._passes.length;for(var a=0;a<n;++a){var o=e._passes[a];o.framebuffer=i;o.passState.framebuffer=i}e._shadowMapTexture=r;e._depthAttachment=r}function ne(e,t){var r=new R({context:t,width:e._textureSize.x,height:e._textureSize.y,format:N.DEPTH_COMPONENT16});var i=new A({context:t,width:e._textureSize.x,height:e._textureSize.y,pixelFormat:C.RGBA,pixelDatatype:O.UNSIGNED_BYTE,sampler:te()});var n=[i.negativeX,i.negativeY,i.negativeZ,i.positiveX,i.positiveY,i.positiveZ];for(var a=0;a<6;++a){var o=new D({context:t,depthRenderbuffer:r,colorTextures:[n[a]],destroyAttachments:false});var s=e._passes[a];s.framebuffer=o;s.passState.framebuffer=o}e._shadowMapTexture=i;e._depthAttachment=r;e._colorAttachment=i}function ae(e,t){if(e._isPointLight){ne(e,t)}else if(e._usesDepthTexture){ie(e,t)}else{re(e,t)}}function oe(e,t){if(e._usesDepthTexture&&e._passes[0].framebuffer.status!==E.FRAMEBUFFER_COMPLETE){e._usesDepthTexture=false;$(e);ee(e);ae(e,t)}}function se(e,t){if(!f(e._passes[0].framebuffer)||e._shadowMapTexture.width!==e._textureSize.x){ee(e);ae(e,t);oe(e,t);ue(e,t)}}function ue(e,t,r){r=d(r,0);if(e._isPointLight||r===0){e._clearCommand.framebuffer=e._passes[r].framebuffer;e._clearCommand.execute(t,e._clearPassState)}}function le(t,r){t._size=r;var i=t._passes;var n=i.length;var a=t._textureSize;if(t._isPointLight){r=x.maximumCubeMapSize>=r?r:x.maximumCubeMapSize;a.x=r;a.y=r;var o=new e(0,0,r,r);i[0].passState.viewport=o;i[1].passState.viewport=o;i[2].passState.viewport=o;i[3].passState.viewport=o;i[4].passState.viewport=o;i[5].passState.viewport=o}else if(n===1){r=x.maximumTextureSize>=r?r:x.maximumTextureSize;a.x=r;a.y=r;i[0].passState.viewport=new e(0,0,r,r)}else if(n===4){r=x.maximumTextureSize>=r*2?r:x.maximumTextureSize/2;a.x=r*2;a.y=r*2;i[0].passState.viewport=new e(0,0,r,r);i[1].passState.viewport=new e(r,0,r,r);i[2].passState.viewport=new e(0,r,r,r);i[3].passState.viewport=new e(r,r,r,r)}t._clearPassState.viewport=new e(0,0,a.x,a.y);for(var s=0;s<n;++s){var u=i[s];var l=u.passState.viewport;var c=l.x/a.x;var d=l.y/a.y;var f=l.width/a.x;var h=l.height/a.y;u.textureOffsets=new w(f,0,0,c,0,h,0,d,0,0,1,0,0,0,0,1)}}var ce=new e;function de(e,t){var r;if(e._isPointLight){r="uniform samplerCube shadowMap_textureCube; \n"+"varying vec2 v_textureCoordinates; \n"+"void main() \n"+"{ \n"+"    vec2 uv = v_textureCoordinates; \n"+"    vec3 dir; \n"+" \n"+"    if (uv.y < 0.5) \n"+"    { \n"+"        if (uv.x < 0.333) \n"+"        { \n"+"            dir.x = -1.0; \n"+"            dir.y = uv.x * 6.0 - 1.0; \n"+"            dir.z = uv.y * 4.0 - 1.0; \n"+"        } \n"+"        else if (uv.x < 0.666) \n"+"        { \n"+"            dir.y = -1.0; \n"+"            dir.x = uv.x * 6.0 - 3.0; \n"+"            dir.z = uv.y * 4.0 - 1.0; \n"+"        } \n"+"        else \n"+"        { \n"+"            dir.z = -1.0; \n"+"            dir.x = uv.x * 6.0 - 5.0; \n"+"            dir.y = uv.y * 4.0 - 1.0; \n"+"        } \n"+"    } \n"+"    else \n"+"    { \n"+"        if (uv.x < 0.333) \n"+"        { \n"+"            dir.x = 1.0; \n"+"            dir.y = uv.x * 6.0 - 1.0; \n"+"            dir.z = uv.y * 4.0 - 3.0; \n"+"        } \n"+"        else if (uv.x < 0.666) \n"+"        { \n"+"            dir.y = 1.0; \n"+"            dir.x = uv.x * 6.0 - 3.0; \n"+"            dir.z = uv.y * 4.0 - 3.0; \n"+"        } \n"+"        else \n"+"        { \n"+"            dir.z = 1.0; \n"+"            dir.x = uv.x * 6.0 - 5.0; \n"+"            dir.y = uv.y * 4.0 - 3.0; \n"+"        } \n"+"    } \n"+" \n"+"    float shadow = czm_unpackDepth(textureCube(shadowMap_textureCube, dir)); \n"+"    gl_FragColor = vec4(vec3(shadow), 1.0); \n"+"} \n"}else{r="uniform sampler2D shadowMap_texture; \n"+"varying vec2 v_textureCoordinates; \n"+"void main() \n"+"{ \n"+(e._usesDepthTexture?"    float shadow = texture2D(shadowMap_texture, v_textureCoordinates).r; \n":"    float shadow = czm_unpackDepth(texture2D(shadowMap_texture, v_textureCoordinates)); \n")+"    gl_FragColor = vec4(vec3(shadow), 1.0); \n"+"} \n"}var i=t.createViewportQuadCommand(r,{uniformMap:{shadowMap_texture:function(){return e._shadowMapTexture},shadowMap_textureCube:function(){return e._shadowMapTexture}}});i.pass=M.OVERLAY;return i}function fe(t,r){var i=r.context;var n=r.context.drawingBufferWidth;var a=r.context.drawingBufferHeight;var o=Math.min(n,a)*.3;var s=ce;s.x=n-o;s.y=0;s.width=o;s.height=o;var u=t._debugShadowViewCommand;if(!f(u)){u=de(t,i);t._debugShadowViewCommand=u}if(!f(u.renderState)||!e.equals(u.renderState.viewport,s)){u.renderState=L.fromCache({viewport:e.clone(s)})}r.commandList.push(t._debugShadowViewCommand)}var he=new Array(8);he[0]=new a(-1,-1,-1,1);he[1]=new a(1,-1,-1,1);he[2]=new a(1,1,-1,1);he[3]=new a(-1,1,-1,1);he[4]=new a(-1,-1,1,1);he[5]=new a(1,-1,1,1);he[6]=new a(1,1,1,1);he[7]=new a(-1,1,1,1);var pe=new w;var me=new Array(8);for(var ve=0;ve<8;++ve){me[ve]=new a}function _e(e,t){var i=new _({geometry:new r({minimum:new n(-.5,-.5,-.5),maximum:new n(.5,.5,.5)}),attributes:{color:l.fromColor(t)}});var a=new _({geometry:new S({radius:.5}),attributes:{color:l.fromColor(t)}});return new X({geometryInstances:[i,a],appearance:new j({translucent:false,flat:true}),asynchronous:false,modelMatrix:e})}var ge=[u.RED,u.GREEN,u.BLUE,u.MAGENTA];var ye=new n;function we(e,t){fe(e,t);var r=e.debugFreezeFrame&&!e._debugFreezeFrame;e._debugFreezeFrame=e.debugFreezeFrame;if(e.debugFreezeFrame){if(r){e._debugCameraFrustum=e._debugCameraFrustum&&e._debugCameraFrustum.destroy();e._debugCameraFrustum=new H({camera:e._sceneCamera,color:u.CYAN,updateOnChange:false})}e._debugCameraFrustum.update(t)}if(e._cascadesEnabled){if(e.debugFreezeFrame){if(r){e._debugLightFrustum=e._debugLightFrustum&&e._debugLightFrustum.destroy();e._debugLightFrustum=new H({camera:e._shadowMapCamera,color:u.YELLOW,updateOnChange:false})}e._debugLightFrustum.update(t);for(var i=0;i<e._numberOfCascades;++i){if(r){e._debugCascadeFrustums[i]=e._debugCascadeFrustums[i]&&e._debugCascadeFrustums[i].destroy();e._debugCascadeFrustums[i]=new H({camera:e._passes[i].camera,color:ge[i],updateOnChange:false})}e._debugCascadeFrustums[i].update(t)}}}else if(e._isPointLight){if(!f(e._debugLightFrustum)||e._needsUpdate){var a=e._shadowMapCamera.positionWC;var o=b.IDENTITY;var s=e._pointLightRadius*2;var l=n.fromElements(s,s,s,ye);var c=w.fromTranslationQuaternionRotationScale(a,o,l,pe);e._debugLightFrustum=e._debugLightFrustum&&e._debugLightFrustum.destroy();e._debugLightFrustum=_e(c,u.YELLOW)}e._debugLightFrustum.update(t)}else{if(!f(e._debugLightFrustum)||e._needsUpdate){e._debugLightFrustum=new H({camera:e._shadowMapCamera,color:u.YELLOW,updateOnChange:false})}e._debugLightFrustum.update(t)}}function Ce(){this.viewMatrix=new w;this.inverseViewMatrix=new w;this.frustum=undefined;this.positionCartographic=new o;this.positionWC=new n;this.directionWC=n.clone(n.UNIT_Z);this.upWC=n.clone(n.UNIT_Y);this.rightWC=n.clone(n.UNIT_X);this.viewProjectionMatrix=new w}Ce.prototype.clone=function(e){w.clone(e.viewMatrix,this.viewMatrix);w.clone(e.inverseViewMatrix,this.inverseViewMatrix);this.frustum=e.frustum.clone(this.frustum);o.clone(e.positionCartographic,this.positionCartographic);n.clone(e.positionWC,this.positionWC);n.clone(e.directionWC,this.directionWC);n.clone(e.upWC,this.upWC);n.clone(e.rightWC,this.rightWC)};var be=new w(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1);Ce.prototype.getViewProjection=function(){var e=this.viewMatrix;var t=this.frustum.projectionMatrix;w.multiply(t,e,this.viewProjectionMatrix);w.multiply(be,this.viewProjectionMatrix,this.viewProjectionMatrix);return this.viewProjectionMatrix};var Se=new Array(5);var Ee=new Y;var Te=new Array(4);function xe(e,t){var r=e._shadowMapCamera;var i=e._sceneCamera;var o=i.frustum.near;var s=i.frustum.far;var u=e._numberOfCascades;var l;var c=s-o;var d=s/o;var f=.9;var h=false;if(t.shadowHints.closestObjectSize<200){h=true;f=.9}var p=Te;var m=Se;m[0]=o;m[u]=s;for(l=0;l<u;++l){var v=(l+1)/u;var _=o*Math.pow(d,v);var g=o+c*v;var C=y.lerp(g,_,f);m[l+1]=C;p[l]=C-m[l]}if(h){for(l=0;l<u;++l){p[l]=Math.min(p[l],e._maximumCascadeDistances[l])}var b=m[0];for(l=0;l<u-1;++l){b+=p[l];m[l+1]=b}}a.unpack(m,0,e._cascadeSplits[0]);a.unpack(m,1,e._cascadeSplits[1]);a.unpack(p,0,e._cascadeDistances);var S=r.frustum;var E=S.left;var T=S.right;var x=S.bottom;var A=S.top;var P=S.near;var D=S.far;var M=r.positionWC;var I=r.directionWC;var O=r.upWC;var R=i.frustum.clone(Ee);var N=r.getViewProjection();for(l=0;l<u;++l){R.near=m[l];R.far=m[l+1];var L=w.multiply(R.projectionMatrix,i.viewMatrix,pe);var B=w.inverse(L,pe);var F=w.multiply(N,B,pe);var k=n.fromElements(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Me);var V=n.fromElements(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE,Ie);for(var z=0;z<8;++z){var U=a.clone(he[z],me[z]);w.multiplyByVector(F,U,U);n.divideByScalar(U,U.w,U);n.minimumByComponent(U,k,k);n.maximumByComponent(U,V,V)}k.x=Math.max(k.x,0);k.y=Math.max(k.y,0);k.z=0;V.x=Math.min(V.x,1);V.y=Math.min(V.y,1);V.z=Math.min(V.z,1);var q=e._passes[l];var G=q.camera;G.clone(r);var H=G.frustum;H.left=E+k.x*(T-E);H.right=E+V.x*(T-E);H.bottom=x+k.y*(A-x);H.top=x+V.y*(A-x);H.near=P+k.z*(D-P);H.far=P+V.z*(D-P);q.cullingVolume=G.frustum.computeCullingVolume(M,I,O);var W=e._cascadeMatrices[l];w.multiply(G.getViewProjection(),i.inverseViewMatrix,W);w.multiply(q.textureOffsets,W,W)}}var Ae=new w;var Pe=new n;var De=new n;var Me=new n;var Ie=new n;var Oe=new n;function Re(e,t){var r=e._shadowMapCamera;var i=e._sceneCamera;var o=w.multiply(i.frustum.projectionMatrix,i.viewMatrix,pe);var s=w.inverse(o,pe);var u=r.directionWC;var l=i.directionWC;var c=n.cross(u,l,Pe);l=n.cross(c,u,De);n.normalize(l,l);n.normalize(c,c);var d=n.fromElements(0,0,0,Oe);var f=w.computeView(d,u,l,c,Ae);var h=w.multiply(f,s,pe);var p=n.fromElements(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Me);var m=n.fromElements(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE,Ie);for(var v=0;v<8;++v){var _=a.clone(he[v],me[v]);w.multiplyByVector(h,_,_);n.divideByScalar(_,_.w,_);n.minimumByComponent(_,p,p);n.maximumByComponent(_,m,m)}m.z+=1e3;p.z-=10;var g=Oe;g.x=-(.5*(p.x+m.x));g.y=-(.5*(p.y+m.y));g.z=-m.z;var y=w.fromTranslation(g,pe);f=w.multiply(y,f,f);var C=.5*(m.x-p.x);var b=.5*(m.y-p.y);var S=m.z-p.z;var E=r.frustum;E.left=-C;E.right=C;E.bottom=-b;E.top=b;E.near=.01;E.far=S;w.clone(f,r.viewMatrix);w.inverse(f,r.inverseViewMatrix);w.getTranslation(r.inverseViewMatrix,r.positionWC);t.mapProjection.ellipsoid.cartesianToCartographic(r.positionWC,r.positionCartographic);n.clone(u,r.directionWC);n.clone(l,r.upWC);n.clone(c,r.rightWC)}var Ne=[new n(-1,0,0),new n(0,-1,0),new n(0,0,-1),new n(1,0,0),new n(0,1,0),new n(0,0,1)];var Le=[new n(0,-1,0),new n(0,0,-1),new n(0,-1,0),new n(0,-1,0),new n(0,0,1),new n(0,-1,0)];var Be=[new n(0,0,1),new n(1,0,0),new n(-1,0,0),new n(0,0,-1),new n(1,0,0),new n(1,0,0)];function Fe(e,t){var r=new Y;r.fov=y.PI_OVER_TWO;r.near=1;r.far=e._pointLightRadius;r.aspectRatio=1;for(var i=0;i<6;++i){var n=e._passes[i].camera;n.positionWC=e._shadowMapCamera.positionWC;n.positionCartographic=t.mapProjection.ellipsoid.cartesianToCartographic(n.positionWC,n.positionCartographic);n.directionWC=Ne[i];n.upWC=Le[i];n.rightWC=Be[i];w.computeView(n.positionWC,n.directionWC,n.upWC,n.rightWC,n.viewMatrix);w.inverse(n.viewMatrix,n.inverseViewMatrix);n.frustum=r}}var ke=new n;var Ve=new n;var ze=new t;var Ue=ze.center;function qe(e,r){var i=e._sceneCamera;var a=e._shadowMapCamera;var o=ze;if(e._cascadesEnabled){if(i.frustum.near>=e.maximumDistance){e._outOfView=true;e._needsUpdate=false;return}var s=r.mapProjection.ellipsoid.geodeticSurfaceNormal(i.positionWC,ke);var u=n.negate(a.directionWC,Ve);var l=n.dot(s,u);var c=y.clamp(l/.1,0,1);e._darkness=y.lerp(1,e.darkness,c);if(l<0){e._outOfView=true;e._needsUpdate=false;return}e._needsUpdate=true;e._outOfView=false}else if(e._isPointLight){o.center=a.positionWC;o.radius=e._pointLightRadius;e._outOfView=r.cullingVolume.computeVisibility(o)===g.OUTSIDE;e._needsUpdate=!e._outOfView&&!e._boundingSphere.equals(o);t.clone(o,e._boundingSphere)}else{var d=a.frustum.far/2;var f=n.add(a.positionWC,n.multiplyByScalar(a.directionWC,d,Ue),Ue);o.center=f;o.radius=d;e._outOfView=r.cullingVolume.computeVisibility(o)===g.OUTSIDE;e._needsUpdate=!e._outOfView&&!e._boundingSphere.equals(o);t.clone(o,e._boundingSphere)}}function Ge(e,t){var r=t.camera;var i=e._lightCamera;var a=e._sceneCamera;var o=e._shadowMapCamera;if(e._cascadesEnabled){n.clone(i.directionWC,o.directionWC)}else if(e._isPointLight){n.clone(i.positionWC,o.positionWC)}else{o.clone(i)}var s=e._lightDirectionEC;w.multiplyByPointAsVector(r.viewMatrix,o.directionWC,s);n.normalize(s,s);n.negate(s,s);w.multiplyByPoint(r.viewMatrix,o.positionWC,e._lightPositionEC);e._lightPositionEC.w=e._pointLightRadius;var u;var l;if(e._fitNearFar){u=Math.min(t.shadowHints.nearPlane,e.maximumDistance);l=Math.min(t.shadowHints.farPlane,e.maximumDistance+1)}else{u=r.frustum.near;l=e.maximumDistance}e._sceneCamera=U.clone(r,a);r.frustum.clone(e._sceneCamera.frustum);e._sceneCamera.frustum.near=u;e._sceneCamera.frustum.far=l;e._distance=l-u;qe(e,t);if(!e._outOfViewPrevious&&e._outOfView){e._needsUpdate=true}e._outOfViewPrevious=e._outOfView}K.prototype.update=function(e){Ge(this,e);if(this._needsUpdate){se(this,e.context);if(this._isPointLight){Fe(this,e)}if(this._cascadesEnabled){Re(this,e);if(this._numberOfCascades>1){xe(this,e)}}if(!this._isPointLight){var t=this._shadowMapCamera;var r=t.positionWC;var i=t.directionWC;var n=t.upWC;this._shadowMapCullingVolume=t.frustum.computeCullingVolume(r,i,n);if(this._passes.length===1){this._passes[0].camera.clone(t)}}else{this._shadowMapCullingVolume=G.fromBoundingSphere(this._boundingSphere)}}if(this._passes.length===1){var a=this._sceneCamera.inverseViewMatrix;w.multiply(this._shadowMapCamera.getViewProjection(),a,this._shadowMapMatrix)}if(this.debugShow){we(this,e)}};K.prototype.updatePass=function(e,t){ue(this,e,t)};var He=new i;function We(e,t,r){var i=e._isPointLight?e._pointBias:r?e._terrainBias:e._primitiveBias;var n={shadowMap_texture:function(){return e._shadowMapTexture},shadowMap_textureCube:function(){return e._shadowMapTexture},shadowMap_matrix:function(){return e._shadowMapMatrix},shadowMap_cascadeSplits:function(){return e._cascadeSplits},shadowMap_cascadeMatrices:function(){return e._cascadeMatrices},shadowMap_lightDirectionEC:function(){return e._lightDirectionEC},shadowMap_lightPositionEC:function(){return e._lightPositionEC},shadowMap_cascadeDistances:function(){return e._cascadeDistances},shadowMap_texelSizeDepthBiasAndNormalShadingSmooth:function(){var t=He;t.x=1/e._textureSize.x;t.y=1/e._textureSize.y;return a.fromElements(t.x,t.y,i.depthBias,i.normalShadingSmooth,this.combinedUniforms1)},shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness:function(){return a.fromElements(i.normalOffsetScale,e._distance,e.maximumDistance,e._darkness,this.combinedUniforms2)},combinedUniforms1:new a,combinedUniforms2:new a};return c(t,n,false)}function je(e,t,r,i,n,a){var o;var u;var l;if(f(a)){o=a.shaderProgram;u=a.renderState;l=a.uniformMap}a=P.shallowClone(r,a);a.castShadows=true;a.receiveShadows=false;if(!f(o)||n!==r.shaderProgram.id||t){var c=r.shaderProgram;var d=r.pass===M.GLOBE;var h=r.pass!==M.TRANSLUCENT;var p=e._isPointLight;var m=e._usesDepthTexture;var v=Z.getShadowCastShaderKeyword(p,d,m,h);o=i.shaderCache.getDerivedShaderProgram(c,v);if(!f(o)){var _=c.vertexShaderSource;var g=c.fragmentShaderSource;var y=Z.createShadowCastVertexShader(_,p,d);var w=Z.createShadowCastFragmentShader(g,p,m,h);o=i.shaderCache.createDerivedShaderProgram(c,v,{vertexShaderSource:y,fragmentShaderSource:w,attributeLocations:c._attributeLocations})}u=e._primitiveRenderState;if(p){u=e._pointRenderState}else if(d){u=e._terrainRenderState}var C=r.renderState.cull.enabled;if(!C){u=s(u,false);u.cull.enabled=false;u=L.fromCache(u)}l=We(e,r.uniformMap,d)}a.shaderProgram=o;a.renderState=u;a.uniformMap=l;return a}K.createDerivedCommands=function(e,t,r,i,n,a){if(!f(a)){a={}}var o=t.length>0;var s=r.shaderProgram;var u=s.vertexShaderSource;var l=s.fragmentShaderSource;var c=r.pass===M.GLOBE;var d=false;if(c){d=r.owner.data.pickTerrain.mesh.encoding.hasVertexNormals}if(r.castShadows){var h=a.castCommands;if(!f(h)){h=a.castCommands=[]}var p=a.castShaderProgramId;var m=e.length;h.length=m;for(var v=0;v<m;++v){h[v]=je(e[v],i,r,n,p,h[v])}a.castShaderProgramId=r.shaderProgram.id}if(r.receiveShadows&&o){var _;var g;if(f(a.receiveCommand)){_=a.receiveCommand.shaderProgram;g=a.receiveCommand.uniformMap}a.receiveCommand=P.shallowClone(r,a.receiveCommand);a.castShadows=false;a.receiveShadows=true;var y=a.receiveShaderCastShadows!==r.castShadows;var w=a.receiveShaderProgramId!==r.shaderProgram.id;if(!f(_)||w||i||y){var C=Z.getShadowReceiveShaderKeyword(t[0],r.castShadows,c,d);_=n.shaderCache.getDerivedShaderProgram(s,C);if(!f(_)){var b=Z.createShadowReceiveVertexShader(u,c,d);var S=Z.createShadowReceiveFragmentShader(l,t[0],r.castShadows,c,d);_=n.shaderCache.createDerivedShaderProgram(s,C,{vertexShaderSource:b,fragmentShaderSource:S,attributeLocations:s._attributeLocations})}g=We(t[0],r.uniformMap,c)}a.receiveCommand.shaderProgram=_;a.receiveCommand.uniformMap=g;a.receiveShaderProgramId=r.shaderProgram.id;a.receiveShaderCastShadows=r.castShadows}return a};K.prototype.isDestroyed=function(){return false};K.prototype.destroy=function(){ee(this);this._debugLightFrustum=this._debugLightFrustum&&this._debugLightFrustum.destroy();this._debugCameraFrustum=this._debugCameraFrustum&&this._debugCameraFrustum.destroy();this._debugShadowViewCommand=this._debugShadowViewCommand&&this._debugShadowViewCommand.shaderProgram&&this._debugShadowViewCommand.shaderProgram.destroy();for(var e=0;e<this._numberOfCascades;++e){this._debugCascadeFrustums[e]=this._debugCascadeFrustums[e]&&this._debugCascadeFrustums[e].destroy()}return p(this)};return K});define("Shaders/PostProcessFilters/AdditiveBlend",[],function(){"use strict";return"uniform sampler2D u_texture0;\nuniform sampler2D u_texture1;\nuniform vec2 u_center;\nuniform float u_radius;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\nvec4 color0 = texture2D(u_texture0, v_textureCoordinates);\nvec4 color1 = texture2D(u_texture1, v_textureCoordinates);\nfloat x = length(gl_FragCoord.xy - u_center) / u_radius;\nfloat t = smoothstep(0.5, 0.8, x);\ngl_FragColor = mix(color0 + color1, color0, t);\n}\n"});define("Shaders/PostProcessFilters/BrightPass",[],function(){"use strict";return"uniform sampler2D u_texture;\nuniform float u_avgLuminance;\nuniform float u_threshold;\nuniform float u_offset;\nvarying vec2 v_textureCoordinates;\nfloat key(float avg)\n{\nfloat guess = 1.5 - (1.5 / (avg * 0.1 + 1.0));\nreturn max(0.0, guess) + 0.1;\n}\nvoid main()\n{\nvec4 color = texture2D(u_texture, v_textureCoordinates);\nvec3 xyz = czm_RGBToXYZ(color.rgb);\nfloat luminance = xyz.r;\nfloat scaledLum = key(u_avgLuminance) * luminance / u_avgLuminance;\nfloat brightLum = max(scaledLum - u_threshold, 0.0);\nfloat brightness = brightLum / (u_offset + brightLum);\nxyz.r = brightness;\ngl_FragColor = vec4(czm_XYZToRGB(xyz), 1.0);\n}\n"});define("Shaders/PostProcessFilters/GaussianBlur1D",[],function(){"use strict";return"#define SAMPLES 8\nuniform float delta;\nuniform float sigma;\nuniform float direction;\nuniform sampler2D u_texture;\nuniform vec2 u_step;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\nvec2 st = v_textureCoordinates;\nvec2 dir = vec2(1.0 - direction, direction);\nvec3 g;\ng.x = 1.0 / (sqrt(czm_twoPi) * sigma);\ng.y = exp((-0.5 * delta * delta) / (sigma * sigma));\ng.z = g.y * g.y;\nvec4 result = texture2D(u_texture, st) * g.x;\nfor (int i = 1; i < SAMPLES; ++i)\n{\ng.xy *= g.yz;\nvec2 offset = float(i) * dir * u_step;\nresult += texture2D(u_texture, st - offset) * g.x;\nresult += texture2D(u_texture, st + offset) * g.x;\n}\ngl_FragColor = result;\n}\n"});define("Scene/SunPostProcess",["../Core/BoundingRectangle","../Core/Cartesian2","../Core/Cartesian4","../Core/Color","../Core/defaultValue","../Core/defined","../Core/destroyObject","../Core/Math","../Core/Matrix4","../Core/PixelFormat","../Core/Transforms","../Renderer/ClearCommand","../Renderer/Framebuffer","../Renderer/PassState","../Renderer/PixelDatatype","../Renderer/Renderbuffer","../Renderer/RenderbufferFormat","../Renderer/RenderState","../Renderer/Texture","../Shaders/PostProcessFilters/AdditiveBlend","../Shaders/PostProcessFilters/BrightPass","../Shaders/PostProcessFilters/GaussianBlur1D","../Shaders/PostProcessFilters/PassThrough"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w,C,b){"use strict";function S(){this._fbo=undefined;this._downSampleFBO1=undefined;this._downSampleFBO2=undefined;this._clearFBO1Command=undefined;this._clearFBO2Command=undefined;this._downSampleCommand=undefined;this._brightPassCommand=undefined;this._blurXCommand=undefined;this._blurYCommand=undefined;this._blendCommand=undefined;this._fullScreenCommand=undefined;this._downSamplePassState=new h;this._downSamplePassState.scissorTest={enable:true,rectangle:new e};this._upSamplePassState=new h;this._upSamplePassState.scissorTest={enabled:true,rectangle:new e};this._uCenter=new t;this._uRadius=undefined;this._blurStep=new t}S.prototype.clear=function(e,t){var r=this._clearFBO1Command;i.clone(n(t,i.BLACK),r.color);r.execute(e);r=this._clearFBO2Command;i.clone(n(t,i.BLACK),r.color);r.execute(e)};S.prototype.execute=function(e,t){this._downSampleCommand.execute(e,this._downSamplePassState);this._brightPassCommand.execute(e,this._downSamplePassState);this._blurXCommand.execute(e,this._downSamplePassState);this._blurYCommand.execute(e,this._downSamplePassState);this._fullScreenCommand.framebuffer=t;this._blendCommand.framebuffer=t;this._fullScreenCommand.execute(e);this._blendCommand.execute(e,this._upSamplePassState)};var E=new e;var T=new e;var x=new r;var A=new t;var P=new t;var D=new u;S.prototype.update=function(e){var r=e.context;var n=e.viewport;var o=r.drawingBufferWidth;var h=r.drawingBufferHeight;var S=this;if(!a(this._downSampleCommand)){this._clearFBO1Command=new d({color:new i});this._clearFBO2Command=new d({color:new i});var M={};this._downSampleCommand=r.createViewportQuadCommand(b,{uniformMap:M,owner:this});M={u_avgLuminance:function(){return.5},u_threshold:function(){return.25},u_offset:function(){return.1}};this._brightPassCommand=r.createViewportQuadCommand(w,{uniformMap:M,owner:this});var I=1;var O=2;M={delta:function(){return I},sigma:function(){return O},direction:function(){return 0}};this._blurXCommand=r.createViewportQuadCommand(C,{uniformMap:M,owner:this});M={delta:function(){return I},sigma:function(){return O},direction:function(){return 1}};this._blurYCommand=r.createViewportQuadCommand(C,{uniformMap:M,owner:this});M={u_center:function(){return S._uCenter},u_radius:function(){return S._uRadius}};this._blendCommand=r.createViewportQuadCommand(y,{uniformMap:M,owner:this});M={};this._fullScreenCommand=r.createViewportQuadCommand(b,{uniformMap:M,owner:this})}var R=Math.pow(2,Math.ceil(Math.log(o)/Math.log(2))-2);var N=Math.pow(2,Math.ceil(Math.log(h)/Math.log(2))-2);var L=Math.max(1,R,N);var B=T;B.width=L;B.height=L;var F=this._fbo;var k=a(F)&&F.getColorTexture(0)||undefined;if(!a(k)||k.width!==o||k.height!==h){F=F&&F.destroy();this._downSampleFBO1=this._downSampleFBO1&&this._downSampleFBO1.destroy();this._downSampleFBO2=this._downSampleFBO2&&this._downSampleFBO2.destroy();this._blurStep.x=this._blurStep.y=1/L;var V=[new g({context:r,width:o,height:h})];if(r.depthTexture){F=this._fbo=new f({context:r,colorTextures:V,depthTexture:new g({context:r,width:o,height:h,pixelFormat:l.DEPTH_COMPONENT,pixelDatatype:p.UNSIGNED_SHORT})})}else{F=this._fbo=new f({context:r,colorTextures:V,depthRenderbuffer:new m({context:r,format:v.DEPTH_COMPONENT16})})}this._downSampleFBO1=new f({context:r,colorTextures:[new g({context:r,width:L,height:L})]});this._downSampleFBO2=new f({context:r,
colorTextures:[new g({context:r,width:L,height:L})]});this._clearFBO1Command.framebuffer=this._downSampleFBO1;this._clearFBO2Command.framebuffer=this._downSampleFBO2;this._downSampleCommand.framebuffer=this._downSampleFBO1;this._brightPassCommand.framebuffer=this._downSampleFBO2;this._blurXCommand.framebuffer=this._downSampleFBO1;this._blurYCommand.framebuffer=this._downSampleFBO2;var z=_.fromCache({viewport:B});this._downSampleCommand.uniformMap.u_texture=function(){return F.getColorTexture(0)};this._downSampleCommand.renderState=z;this._brightPassCommand.uniformMap.u_texture=function(){return S._downSampleFBO1.getColorTexture(0)};this._brightPassCommand.renderState=z;this._blurXCommand.uniformMap.u_texture=function(){return S._downSampleFBO2.getColorTexture(0)};this._blurXCommand.uniformMap.u_step=function(){return S._blurStep};this._blurXCommand.renderState=z;this._blurYCommand.uniformMap.u_texture=function(){return S._downSampleFBO1.getColorTexture(0)};this._blurYCommand.uniformMap.u_step=function(){return S._blurStep};this._blurYCommand.renderState=z;var U=E;U.width=o;U.height=h;var q=_.fromCache({viewport:U});this._blendCommand.uniformMap.u_texture0=function(){return F.getColorTexture(0)};this._blendCommand.uniformMap.u_texture1=function(){return S._downSampleFBO2.getColorTexture(0)};this._blendCommand.renderState=q;this._fullScreenCommand.uniformMap.u_texture=function(){return F.getColorTexture(0)};this._fullScreenCommand.renderState=q}var G=r.uniformState;var H=G.sunPositionWC;var W=G.view;var j=G.viewProjection;var Y=G.projection;var X=u.computeViewportTransformation(n,0,1,D);var Z=u.multiplyByPoint(W,H,x);var K=c.pointToGLWindowCoordinates(j,X,H,A);Z.x+=s.SOLAR_RADIUS;var Q=c.pointToGLWindowCoordinates(Y,X,Z,Z);var J=t.magnitude(t.subtract(Q,K,Q))*30*2;var $=P;$.x=J;$.y=J;var ee=this._upSamplePassState.scissorTest.rectangle;ee.x=Math.max(K.x-$.x*.5,0);ee.y=Math.max(K.y-$.y*.5,0);ee.width=Math.min($.x,o);ee.height=Math.min($.y,h);this._uCenter=t.clone(K,this._uCenter);this._uRadius=Math.max($.x,$.y)*.5;X=u.computeViewportTransformation(B,0,1,D);K=c.pointToGLWindowCoordinates(j,X,H,A);$.x*=R/o;$.y*=N/h;ee=this._downSamplePassState.scissorTest.rectangle;ee.x=Math.max(K.x-$.x*.5,0);ee.y=Math.max(K.y-$.y*.5,0);ee.width=Math.min($.x,o);ee.height=Math.min($.y,h);this._downSamplePassState.context=r;this._upSamplePassState.context=r;return this._fbo};S.prototype.isDestroyed=function(){return false};S.prototype.destroy=function(){this._fbo=this._fbo&&this._fbo.destroy();this._downSampleFBO1=this._downSampleFBO1&&this._downSampleFBO1.destroy();this._downSampleFBO2=this._downSampleFBO2&&this._downSampleFBO2.destroy();this._downSampleCommand=this._downSampleCommand&&this._downSampleCommand.shaderProgram&&this._downSampleCommand.shaderProgram.destroy();this._brightPassCommand=this._brightPassCommand&&this._brightPassCommand.shaderProgram&&this._brightPassCommand.shaderProgram.destroy();this._blurXCommand=this._blurXCommand&&this._blurXCommand.shaderProgram&&this._blurXCommand.shaderProgram.destroy();this._blurYCommand=this._blurYCommand&&this._blurYCommand.shaderProgram&&this._blurYCommand.shaderProgram.destroy();this._blendCommand=this._blendCommand&&this._blendCommand.shaderProgram&&this._blendCommand.shaderProgram.destroy();this._fullScreenCommand=this._fullScreenCommand&&this._fullScreenCommand.shaderProgram&&this._fullScreenCommand.shaderProgram.destroy();return o(this)};return S});define("Scene/Scene",["../Core/BoundingRectangle","../Core/BoundingSphere","../Core/BoxGeometry","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Cartographic","../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/createGuid","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/EllipsoidGeometry","../Core/Event","../Core/GeographicProjection","../Core/GeometryInstance","../Core/GeometryPipeline","../Core/getTimestamp","../Core/Intersect","../Core/Interval","../Core/JulianDate","../Core/Math","../Core/Matrix4","../Core/mergeSort","../Core/Occluder","../Core/PixelFormat","../Core/RequestScheduler","../Core/ShowGeometryInstanceAttribute","../Core/Transforms","../Renderer/ClearCommand","../Renderer/ComputeEngine","../Renderer/Context","../Renderer/ContextLimits","../Renderer/DrawCommand","../Renderer/Framebuffer","../Renderer/Pass","../Renderer/PassState","../Renderer/PixelDatatype","../Renderer/RenderState","../Renderer/ShaderProgram","../Renderer/ShaderSource","../Renderer/Texture","./Camera","./CreditDisplay","./CullingVolume","./DebugCameraPrimitive","./DepthPlane","./DeviceOrientationCameraController","./Fog","./FrameState","./FrustumCommands","./FXAA","./GlobeDepth","./JobScheduler","./MapMode2D","./OIT","./OrthographicFrustum","./OrthographicOffCenterFrustum","./PerformanceDisplay","./PerInstanceColorAppearance","./PerspectiveFrustum","./PerspectiveOffCenterFrustum","./PickDepth","./Primitive","./PrimitiveCollection","./SceneMode","./SceneTransforms","./SceneTransitioner","./ScreenSpaceCameraController","./ShadowMap","./SunPostProcess","./TweenCollection"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w,C,b,S,E,T,x,A,P,D,M,I,O,R,N,L,B,F,k,V,z,U,q,G,H,W,j,Y,X,Z,K,Q,J,$,ee,te,re,ie,ne,ae,oe,se,ue,le,ce,de,fe,he,pe,me,ve,_e,ge,ye,we){"use strict";function Ce(t){t=c(t,c.EMPTY_OBJECT);var r=t.canvas;var i=t.contextOptions;var n=t.creditContainer;if(!d(r)){throw new p("options and options.canvas are required.")}var a=new N(r,i);if(!d(n)){n=document.createElement("div");n.style.position="absolute";n.style.bottom="0";n.style["text-shadow"]="0 0 2px #000000";n.style.color="#ffffff";n.style["font-size"]="10px";n.style["padding-right"]="5px";r.parentNode.appendChild(n)}this._id=l();this._jobScheduler=new re;this._frameState=new J(a,new j(n),this._jobScheduler);this._frameState.scene3DOnly=c(t.scene3DOnly,false);var o=new V(a);o.viewport=new e;o.viewport.x=0;o.viewport.y=0;o.viewport.width=a.drawingBufferWidth;o.viewport.height=a.drawingBufferHeight;this._passState=o;this._canvas=r;this._context=a;this._computeEngine=new R(a);this._globe=undefined;this._primitives=new he;this._groundPrimitives=new he;this._tweens=new we;this._shaderFrameCount=0;this._sunPostProcess=undefined;this._computeCommandList=[];this._frustumCommandsList=[];this._overlayCommandList=[];this._pickFramebuffer=undefined;this._useOIT=c(t.orderIndependentTranslucency,true);this._executeOITFunction=undefined;var u;if(a.depthTexture){u=new te}var f;if(this._useOIT&&d(u)){f=new ne(a)}this._globeDepth=u;this._depthPlane=new Z;this._oit=f;this._fxaa=new ee;this._clearColorCommand=new O({color:new s,stencil:0,owner:this});this._depthClearCommand=new O({depth:1,owner:this});this._stencilClearCommand=new O({stencil:0});this._pickDepths=[];this._debugGlobeDepths=[];this._pickDepthPassState=undefined;this._pickDepthFramebuffer=undefined;this._pickDepthFramebufferWidth=undefined;this._pickDepthFramebufferHeight=undefined;this._depthOnlyRenderStateCache={};this._transitioner=new ve(this);this._renderError=new v;this._preRender=new v;this._postRender=new v;this._cameraStartFired=false;this._cameraMovedTime=undefined;this.rethrowRenderErrors=false;this.completeMorphOnUserInput=true;this.morphStart=new v;this.morphComplete=new v;this.skyBox=undefined;this.skyAtmosphere=undefined;this.sun=undefined;this.sunBloom=true;this._sunBloom=undefined;this.moon=undefined;this.backgroundColor=s.clone(s.BLACK);this._mode=pe.SCENE3D;this._mapProjection=d(t.mapProjection)?t.mapProjection:new _;this.morphTime=1;this.farToNearRatio=1e3;this.nearToFarDistance2D=175e4;this.debugCommandFilter=undefined;this.debugShowCommands=false;this.debugShowFrustums=false;this._debugFrustumStatistics=undefined;this.debugShowFramesPerSecond=false;this.debugShowGlobeDepth=false;this.debugShowDepthFrustum=1;this.debugShowFrustumPlanes=false;this._debugShowFrustumPlanes=false;this._debugFrustumPlanes=undefined;this.fxaa=true;this.useDepthPicking=true;this.pickTranslucentDepth=false;this.cameraEventWaitTime=500;this.copyGlobeDepth=false;this.fog=new Q;this._sunCamera=new W(this);this.shadowMap=new ge({context:a,lightCamera:this._sunCamera,enabled:c(t.shadows,false)});this._terrainExaggeration=c(t.terrainExaggeration,1);this._performanceDisplay=undefined;this._debugVolume=undefined;var h=new W(this);this._camera=h;this._cameraClone=W.clone(h);this._screenSpaceCameraController=new _e(this);this._mapMode2D=c(t.mapMode2D,ie.INFINITE_SCROLL);this._environmentState={skyBoxCommand:undefined,skyAtmosphereCommand:undefined,sunDrawCommand:undefined,sunComputeCommand:undefined,moonCommand:undefined,isSunVisible:false,isMoonVisible:false,isReadyForAtmosphere:false,isSkyAtmosphereVisible:false,clearGlobeDepth:false,useDepthPlane:false,originalFramebuffer:undefined,useGlobeDepthFramebuffer:false,useOIT:false,useFXAA:false};this._useWebVR=false;this._cameraVR=undefined;this._aspectRatioVR=undefined;var m=h.frustum.near;var g=h.frustum.far;var y=Math.ceil(Math.log(g/m)/Math.log(this.farToNearRatio));Re(m,g,this.farToNearRatio,y,this._frustumCommandsList,false,undefined);Oe(this,0,S.now());this.initializeFrame()}var be=.99;f(Ce.prototype,{canvas:{get:function(){return this._canvas}},drawingBufferHeight:{get:function(){return this._context.drawingBufferHeight}},drawingBufferWidth:{get:function(){return this._context.drawingBufferWidth}},maximumAliasedLineWidth:{get:function(){return L.maximumAliasedLineWidth}},maximumCubeMapSize:{get:function(){return L.maximumCubeMapSize}},pickPositionSupported:{get:function(){return this._context.depthTexture}},globe:{get:function(){return this._globe},set:function(e){this._globe=this._globe&&this._globe.destroy();this._globe=e}},primitives:{get:function(){return this._primitives}},groundPrimitives:{get:function(){return this._groundPrimitives}},camera:{get:function(){return this._camera}},screenSpaceCameraController:{get:function(){return this._screenSpaceCameraController}},mapProjection:{get:function(){return this._mapProjection}},frameState:{get:function(){return this._frameState}},tweens:{get:function(){return this._tweens}},imageryLayers:{get:function(){return this.globe.imageryLayers}},terrainProvider:{get:function(){return this.globe.terrainProvider},set:function(e){this.globe.terrainProvider=e}},terrainProviderChanged:{get:function(){return this.globe.terrainProviderChanged}},renderError:{get:function(){return this._renderError}},preRender:{get:function(){return this._preRender}},postRender:{get:function(){return this._postRender}},context:{get:function(){return this._context}},debugFrustumStatistics:{get:function(){return this._debugFrustumStatistics}},scene3DOnly:{get:function(){return this._frameState.scene3DOnly}},orderIndependentTranslucency:{get:function(){return d(this._oit)}},id:{get:function(){return this._id}},mode:{get:function(){return this._mode},set:function(e){if(this.scene3DOnly&&e!==pe.SCENE3D){throw new p("Only SceneMode.SCENE3D is valid when scene3DOnly is true.")}if(e===pe.SCENE2D){this.morphTo2D(0)}else if(e===pe.SCENE3D){this.morphTo3D(0)}else if(e===pe.COLUMBUS_VIEW){this.morphToColumbusView(0)}else{throw new p("value must be a valid SceneMode enumeration.")}this._mode=e}},numberOfFrustums:{get:function(){return this._frustumCommandsList.length}},terrainExaggeration:{get:function(){return this._terrainExaggeration}},useWebVR:{get:function(){return this._useWebVR},set:function(e){if(this.camera.frustum instanceof ae){throw new p("VR is unsupported with an orthographic projection.")}this._useWebVR=e;if(this._useWebVR){this._frameState.creditDisplay.container.style.visibility="hidden";this._cameraVR=new W(this);if(!d(this._deviceOrientationCameraController)){this._deviceOrientationCameraController=new K(this)}this._aspectRatioVR=this._camera.frustum.aspectRatio}else{this._frameState.creditDisplay.container.style.visibility="visible";this._cameraVR=undefined;this._deviceOrientationCameraController=this._deviceOrientationCameraController&&!this._deviceOrientationCameraController.isDestroyed()&&this._deviceOrientationCameraController.destroy();this._camera.frustum.aspectRatio=this._aspectRatioVR;this._camera.frustum.xOffset=0}}},mapMode2D:{get:function(){return this._mapMode2D}},imagerySplitPosition:{get:function(){return this._frameState.imagerySplitPosition},set:function(e){this._frameState.imagerySplitPosition=e}}});Ce.prototype.getCompressedTextureFormatSupported=function(e){var t=this.context;return(e==="WEBGL_compressed_texture_s3tc"||e==="s3tc")&&t.s3tc||(e==="WEBGL_compressed_texture_pvrtc"||e==="pvrtc")&&t.pvrtc||(e==="WEBGL_compressed_texture_etc1"||e==="etc1")&&t.etc1};var Se=new n;var Ee=new n;function Te(e,t){var r=Math.max(Math.abs(e.x),Math.abs(t.x));var i=Math.max(Math.abs(e.y),Math.abs(t.y));var n=Math.max(Math.abs(e.z),Math.abs(t.z));return Math.max(Math.max(r,i),n)}function xe(e,t,r){var i=1/Math.max(1,Te(e.position,t.position));n.multiplyByScalar(e.position,i,Se);n.multiplyByScalar(t.position,i,Ee);return n.equalsEpsilon(Se,Ee,r)&&n.equalsEpsilon(e.direction,t.direction,r)&&n.equalsEpsilon(e.up,t.up,r)&&n.equalsEpsilon(e.right,t.right,r)&&T.equalsEpsilon(e.transform,t.transform,r)}function Ae(e,t){var r=e.frameState;var i=e._context;var n=r.shadowHints.shadowsEnabled;var a=r.shadowHints.shadowMaps;var o=r.shadowHints.lightShadowMaps;var s=n&&o.length>0;var u=false;var l=r.shadowHints.lastDirtyTime;if(t.lastDirtyTime!==l){t.lastDirtyTime=l;t.dirty=true;u=true}var c=t.derivedCommands;if(t.dirty&&d(c)){t.dirty=false;if(n&&(t.receiveShadows||t.castShadows)){c.shadows=ge.createDerivedCommands(a,o,t,u,i,c.shadows)}var f=e._oit;if(t.pass===k.TRANSLUCENT&&d(f)&&f.isSupported()){if(s&&t.receiveShadows){c.oit=d(c.oit)?c.oit:{};c.oit.shadows=f.createDerivedCommands(t.derivedCommands.shadows.receiveCommand,i,c.oit.shadows)}else{c.oit=f.createDerivedCommands(t,i,c.oit)}}c.depth=zt(e,t,i,c.depth)}}var Pe=new t;var De;function Me(e){var t=e.globe;if(e._mode===pe.SCENE3D&&d(t)){var r=t.ellipsoid;Pe.radius=r.minimumRadius;De=A.fromBoundingSphere(Pe,e._camera.positionWC,De);return De}return undefined}function Ie(e){e.render=false;e.pick=false;e.depth=false}function Oe(e,t,r){var i=e._camera;var n=e._frameState;n.commandList.length=0;n.shadowMaps.length=0;n.mode=e._mode;n.morphTime=e.morphTime;n.mapProjection=e.mapProjection;n.frameNumber=t;n.time=S.clone(r,n.time);n.camera=i;n.cullingVolume=i.frustum.computeCullingVolume(i.positionWC,i.directionWC,i.upWC);n.occluder=Me(e);n.terrainExaggeration=e._terrainExaggeration;if(d(e.globe)){n.maximumScreenSpaceError=e.globe.maximumScreenSpaceError}else{n.maximumScreenSpaceError=2}Ie(n.passes)}function Re(e,t,r,i,n,a,o){n.length=i;for(var s=0;s<i;++s){var u;var l;if(!a){u=Math.max(e,Math.pow(r,s)*e);l=Math.min(t,r*u)}else{u=Math.min(t-o,e+s*o);l=Math.min(t,u+o)}var c=n[s];if(!d(c)){c=n[s]=new $(u,l)}else{c.near=u;c.far=l}}}function Ne(e,t,r){if(e.debugShowFrustums){t.debugOverlappingFrustums=0}if(!e.frameState.passes.pick){Ae(e,t)}var i=e._frustumCommandsList;var n=i.length;for(var a=0;a<n;++a){var o=i[a];var s=o.near;var u=o.far;if(r.start>u){continue}if(r.stop<s){break}var l=t instanceof O?k.OPAQUE:t.pass;var c=o.indices[l]++;o.commands[l][c]=t;if(e.debugShowFrustums){t.debugOverlappingFrustums|=1<<a}if(t.executeInClosestFrustum){break}}if(e.debugShowFrustums){var f=e._debugFrustumStatistics.commandsInFrustums;f[t.debugOverlappingFrustums]=d(f[t.debugOverlappingFrustums])?f[t.debugOverlappingFrustums]+1:1;++e._debugFrustumStatistics.totalCommands}}var Le=new Y;var Be=new b;function Fe(e,t,r){return d(e)&&(!d(e.boundingVolume)||!e.cull||t.computeVisibility(e.boundingVolume)!==C.OUTSIDE&&(!d(r)||!e.boundingVolume.isOccluded(r)))}function ke(e){var t=e._frameState;var r=t.camera;var i=r.directionWC;var n=r.positionWC;var a=e._computeCommandList;var o=e._overlayCommandList;var s=t.commandList;if(e.debugShowFrustums){e._debugFrustumStatistics={totalCommands:0,commandsInFrustums:{}}}var u=e._frustumCommandsList;var l=u.length;var c=k.NUMBER_OF_PASSES;for(var f=0;f<l;++f){for(var h=0;h<c;++h){u[f].indices[h]=0}}a.length=0;o.length=0;var p=Number.MAX_VALUE;var m=-Number.MAX_VALUE;var v=false;var _=t.shadowHints.shadowsEnabled;var g=Number.MAX_VALUE;var y=-Number.MAX_VALUE;var w=Number.MAX_VALUE;var C=t.mode===pe.SCENE3D?t.occluder:undefined;var b=t.cullingVolume;var S=Le.planes;for(var T=0;T<5;++T){S[T]=b.planes[T]}b=Le;var x=e._environmentState;x.isSkyAtmosphereVisible=d(x.skyAtmosphereCommand)&&x.isReadyForAtmosphere;x.isSunVisible=Fe(x.sunDrawCommand,b,C);x.isMoonVisible=Fe(x.moonCommand,b,C);var A=s.length;for(var P=0;P<A;++P){var D=s[P];var M=D.pass;if(M===k.COMPUTE){a.push(D)}else if(M===k.OVERLAY){o.push(D)}else{var I=D.boundingVolume;if(d(I)){if(!Fe(D,b,C)){continue}Be=I.computePlaneDistances(n,i,Be);p=Math.min(p,Be.start);m=Math.max(m,Be.stop);if(_&&D.receiveShadows&&Be.start<ge.MAXIMUM_DISTANCE&&!(M===k.GLOBE&&Be.start<-100&&Be.stop>100)){var R=Be.stop-Be.start;if(M!==k.GLOBE&&Be.start<100){w=Math.min(w,R)}g=Math.min(g,Be.start);y=Math.max(y,Be.stop)}}else{Be.start=r.frustum.near;Be.stop=r.frustum.far;v=!(D instanceof O)}Ne(e,D,Be)}}if(v){p=r.frustum.near;m=r.frustum.far}else{p=Math.min(Math.max(p,r.frustum.near),r.frustum.far);m=Math.max(Math.min(m,r.frustum.far),p);if(_){g=Math.min(Math.max(g,r.frustum.near),r.frustum.far);y=Math.max(Math.min(y,r.frustum.far),g)}}if(_){t.shadowHints.nearPlane=g;t.shadowHints.farPlane=y;t.shadowHints.closestObjectSize=w}var N=e.mode===pe.SCENE2D;var L=e.farToNearRatio;var B;if(!N){B=Math.ceil(Math.log(m/p)/Math.log(L))}else{m=Math.min(m,r.position.z+e.nearToFarDistance2D);p=Math.min(p,m);B=Math.ceil(Math.max(1,m-p)/e.nearToFarDistance2D)}if(p!==Number.MAX_VALUE&&(B!==l||u.length!==0&&(p<u[0].near||m>u[l-1].far&&!E.equalsEpsilon(m,u[l-1].far,E.EPSILON8)))){Re(p,m,L,B,u,N,e.nearToFarDistance2D);ke(e)}var F=t.frustumSplits;F.length=B+1;for(var V=0;V<B;++V){F[V]=u[V].near;if(V===B-1){F[V+1]=u[V].far}}}function Ve(e){var t={};var r=e.vertexAttributes;for(var i in r){if(r.hasOwnProperty(i)){t[i]=r[i].index}}return t}function ze(e,t,r){var i=t.context;var n=c(r,e.shaderProgram);var a=n.fragmentShaderSource.clone();var o=[];a.sources=a.sources.map(function(e){e=G.replaceMain(e,"czm_Debug_main");var t=/gl_FragData\[(\d+)\]/g;var r;while((r=t.exec(e))!==null){if(o.indexOf(r[1])===-1){o.push(r[1])}}return e});var u=o.length;var l="void main() \n"+"{ \n"+"    czm_Debug_main(); \n";var f;if(t.debugShowCommands){if(!d(e._debugColor)){e._debugColor=s.fromRandom()}var h=e._debugColor;if(u>0){for(f=0;f<u;++f){l+="    gl_FragData["+o[f]+"].rgb *= vec3("+h.red+", "+h.green+", "+h.blue+"); \n"}}else{l+="    "+"gl_FragColor"+".rgb *= vec3("+h.red+", "+h.green+", "+h.blue+"); \n"}}if(t.debugShowFrustums){var p=e.debugOverlappingFrustums&1<<0?"1.0":"0.0";var m=e.debugOverlappingFrustums&1<<1?"1.0":"0.0";var v=e.debugOverlappingFrustums&1<<2?"1.0":"0.0";if(u>0){for(f=0;f<u;++f){l+="    gl_FragData["+o[f]+"].rgb *= vec3("+p+", "+m+", "+v+"); \n"}}else{l+="    "+"gl_FragColor"+".rgb *= vec3("+p+", "+m+", "+v+"); \n"}}l+="}";a.sources.push(l);var _=Ve(n);return q.fromCache({context:i,vertexShaderSource:n.vertexShaderSource,fragmentShaderSource:a,attributeLocations:_})}function Ue(e,t,r){var i=B.shallowClone(e);i.shaderProgram=ze(e,t);i.execute(t.context,r);i.shaderProgram.destroy()}var qe=new T(0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,1);qe=T.inverseTransformation(qe,qe);function Ge(e,t,i,a,o){if(d(t.debugCommandFilter)&&!t.debugCommandFilter(e)){return}var s=t.frameState.shadowHints.shadowsEnabled;var l=s&&t.frameState.shadowHints.lightShadowMaps.length>0;if(t.debugShowCommands||t.debugShowFrustums){Ue(e,t,a)}else if(l&&e.receiveShadows&&d(e.derivedCommands.shadows)){e.derivedCommands.shadows.receiveCommand.execute(i,a)}else if(t.frameState.passes.depth&&d(e.derivedCommands.depth)){e.derivedCommands.depth.depthOnlyCommand.execute(i,a)}else{e.execute(i,a)}if(e.debugShowBoundingVolume&&d(e.boundingVolume)){var c=t._frameState;var f=e.boundingVolume;if(d(t._debugVolume)){t._debugVolume.destroy()}var h;var p=n.clone(f.center);if(c.mode!==pe.SCENE3D){p=T.multiplyByPoint(qe,p,p);var v=c.mapProjection;var _=v.unproject(p);p=v.ellipsoid.cartographicToCartesian(_)}if(d(f.radius)){var w=f.radius;h=y.toWireframe(m.createGeometry(new m({radii:new n(w,w,w),vertexFormat:ue.FLAT_VERTEX_FORMAT})));t._debugVolume=new fe({geometryInstances:new g({geometry:h,modelMatrix:T.fromTranslation(p),attributes:{color:new u(1,0,0,1)}}),appearance:new ue({flat:true,translucent:false}),asynchronous:false})}else{var C=f.halfAxes;h=y.toWireframe(r.createGeometry(r.fromDimensions({dimensions:new n(2,2,2),vertexFormat:ue.FLAT_VERTEX_FORMAT})));t._debugVolume=new fe({geometryInstances:new g({geometry:h,modelMatrix:T.fromRotationTranslation(C,p,new T),attributes:{color:new u(1,0,0,1)}}),appearance:new ue({flat:true,translucent:false}),asynchronous:false})}var b=c.commandList;var S=c.commandList=[];t._debugVolume.update(c);var E;if(d(o)){E=a.framebuffer;a.framebuffer=o}S[0].execute(i,a);if(d(E)){a.framebuffer=E}c.commandList=b}}function He(e,t,r){return t.boundingVolume.distanceSquaredTo(r)-e.boundingVolume.distanceSquaredTo(r)}function We(e,t,r,i){var n=e.context;x(i,He,e._camera.positionWC);var a=i.length;for(var o=0;o<a;++o){t(i[o],e,n,r)}}function je(e,t){var r=e._debugGlobeDepths[t];if(!d(r)&&e.context.depthTexture){r=new te;e._debugGlobeDepths[t]=r}return r}function Ye(e,t){var r=e._pickDepths[t];if(!d(r)){r=new de;e._pickDepths[t]=r}return r}var Xe=new le;var Ze=new ce;var Ke=new ae;var Qe=new oe;function Je(e,t){var r=e._camera;var i=e.context;var n=i.uniformState;n.updateCamera(r);var a;if(d(r.frustum.fov)){a=r.frustum.clone(Xe)}else if(d(r.frustum.infiniteProjectionMatrix)){a=r.frustum.clone(Ze)}else if(d(r.frustum.width)){a=r.frustum.clone(Ke)}else{a=r.frustum.clone(Qe)}a.near=r.frustum.near;a.far=r.frustum.far;n.updateFrustum(a);n.updatePass(k.ENVIRONMENT);var o=e._useWebVR&&e.mode!==pe.SCENE2D;var s=e._frameState.passes;var u=s.pick;var l=s.depth;var c=e._environmentState;if(!u){var f=c.skyBoxCommand;if(d(f)){Ge(f,e,i,t)}if(c.isSkyAtmosphereVisible){Ge(c.skyAtmosphereCommand,e,i,t)}if(c.isSunVisible){c.sunDrawCommand.execute(i,t);if(e.sunBloom&&!o){var h;if(c.useGlobeDepthFramebuffer){h=e._globeDepth.framebuffer}else if(c.useFXAA){h=e._fxaa.getColorFramebuffer()}else{h=c.originalFramebuffer}e._sunPostProcess.execute(i,h);t.framebuffer=h}}if(c.isMoonVisible){c.moonCommand.execute(i,t)}}var p;if(c.useOIT){if(!d(e._executeOITFunction)){e._executeOITFunction=function(e,t,r,i){e._oit.executeCommands(e,t,r,i)}}p=e._executeOITFunction}else{p=We}var m=c.clearGlobeDepth;var v=c.useDepthPlane;var _=e._depthClearCommand;var g=e._depthPlane;var y=r.position.z;var w;var C=e._frustumCommandsList;var b=C.length;for(var S=0;S<b;++S){var E=b-S-1;var T=C[E];if(e.mode===pe.SCENE2D){r.position.z=y-T.near+1;a.far=Math.max(1,T.far-T.near);a.near=1;n.update(e.frameState);n.updateFrustum(a)}else{a.near=E!==0?T.near*be:T.near;a.far=T.far;n.updateFrustum(a)}var x=e.debugShowGlobeDepth?je(e,E):e._globeDepth;var A;if(e.debugShowGlobeDepth&&d(x)&&c.useGlobeDepthFramebuffer){A=t.framebuffer;t.framebuffer=x.framebuffer}_.execute(i,t);n.updatePass(k.GLOBE);var P=T.commands[k.GLOBE];var D=T.indices[k.GLOBE];for(w=0;w<D;++w){Ge(P[w],e,i,t)}if(d(x)&&c.useGlobeDepthFramebuffer&&(e.copyGlobeDepth||e.debugShowGlobeDepth)){x.update(i);x.executeCopyDepth(i,t)}if(e.debugShowGlobeDepth&&d(x)&&c.useGlobeDepthFramebuffer){t.framebuffer=A}n.updatePass(k.GROUND);P=T.commands[k.GROUND];D=T.indices[k.GROUND];for(w=0;w<D;++w){Ge(P[w],e,i,t)}if(D>0&&i.stencilBuffer){e._stencilClearCommand.execute(i,t)}if(m){_.execute(i,t);if(v){g.execute(i,t)}}var M=k.GROUND+1;var I=k.TRANSLUCENT;for(var O=M;O<I;++O){n.updatePass(O);P=T.commands[O];D=T.indices[O];for(w=0;w<D;++w){Ge(P[w],e,i,t)}}if(E!==0&&e.mode!==pe.SCENE2D){a.near=T.near;n.updateFrustum(a)}n.updatePass(k.TRANSLUCENT);P=T.commands[k.TRANSLUCENT];P.length=T.indices[k.TRANSLUCENT];p(e,Ge,t,P);if(d(x)&&(c.useGlobeDepthFramebuffer||l)&&e.useDepthPicking){var R=l?t.framebuffer.depthStencilTexture:x.framebuffer.depthStencilTexture;var N=Ye(e,E);N.update(i,R);N.executeCopyDepth(i,t)}}}function $e(e){var t=e.context.uniformState;t.updatePass(k.COMPUTE);var r=e._environmentState.sunComputeCommand;if(d(r)){r.execute(e._computeEngine)}var i=e._computeCommandList;var n=i.length;for(var a=0;a<n;++a){i[a].execute(e._computeEngine)}}function et(e,t){var r=e.context.uniformState;r.updatePass(k.OVERLAY);var i=e.context;var n=e._overlayCommandList;var a=n.length;for(var o=0;o<a;++o){n[o].execute(i,t)}}function tt(e,t,r){var i=r.shadowMapCullingVolume;var n=r.isPointLight;var a=r.passes;var o=a.length;var s=t.length;for(var u=0;u<s;++u){var l=t[u];Ae(e,l);if(l.castShadows&&(l.pass===k.GLOBE||l.pass===k.OPAQUE||l.pass===k.TRANSLUCENT)){if(Fe(l,i)){if(n){for(var c=0;c<o;++c){a[c].commandList.push(l)}}else if(o===1){a[0].commandList.push(l)}else{var d=false;for(var f=o-1;f>=0;--f){var h=a[f].cullingVolume;if(Fe(l,h)){a[f].commandList.push(l);d=true}else if(d){break}}}}}}}function rt(e){var t=e.frameState;var r=t.shadowHints.shadowMaps;var i=r.length;if(!t.shadowHints.shadowsEnabled){return}var n=e.context;var a=n.uniformState;for(var o=0;o<i;++o){var s=r[o];if(s.outOfView){continue}var u;var l=s.passes;var c=l.length;for(u=0;u<c;++u){l[u].commandList.length=0}var d=e.frameState.commandList;tt(e,d,s);for(u=0;u<c;++u){var f=s.passes[u];a.updateCamera(f.camera);s.updatePass(n,u);var h=f.commandList.length;for(var p=0;p<h;++p){var m=f.commandList[p];a.updatePass(m.pass);Ge(m.derivedCommands.shadows.castCommands[o],e,n,f.passState)}}}}function it(e,t,r){var i=e._context;var a=t.viewport;var o=e._frameState;var s=o.camera;var u=o.mode;var l=o.passes.depth;if(e._useWebVR&&u!==pe.SCENE2D){if(!l){vt(e)}ke(e);_t(e,t,r);if(!l){$e(e);rt(e)}a.x=0;a.y=0;a.width=i.drawingBufferWidth*.5;a.height=i.drawingBufferHeight;var c=W.clone(s,e._cameraVR);var d=s.frustum.near;var f=d*5;var h=f/30;var p=n.multiplyByScalar(c.right,h*.5,wt);s.frustum.aspectRatio=a.width/a.height;var m=.5*h*d/f;n.add(c.position,p,s.position);s.frustum.xOffset=m;Je(e,t);a.x=t.viewport.width;n.subtract(c.position,p,s.position);s.frustum.xOffset=-m;Je(e,t);W.clone(c,s)}else{a.x=0;a.y=0;a.width=i.drawingBufferWidth;a.height=i.drawingBufferHeight;if(u!==pe.SCENE2D||e._mapMode2D===ie.ROTATE){ft(true,e,t,r)}else{dt(e,t,r)}}}var nt=new o(Math.PI,E.PI_OVER_TWO);var at=new n;var ot=new n;var st=new T;var ut=new T;var lt=new n;var ct=new n;function dt(e,t,r){var i=e.context;var a=e.frameState;var o=e.camera;var s=t.viewport;var u=nt;var l=at;var c=e.mapProjection;c.project(u,l);var d=n.clone(o.position,ot);var f=T.clone(o.transform,ut);var h=o.frustum.clone();o._setTransform(T.IDENTITY);var p=T.computeViewportTransformation(s,0,1,st);var m=o.frustum.projectionMatrix;var v=o.positionWC.y;var _=n.fromElements(E.sign(v)*l.x-v,0,-o.positionWC.x,lt);var g=I.pointToGLWindowCoordinates(m,p,_,ct);g.x=Math.floor(g.x);var y=s.x;var w=s.width;if(v===0||g.x<=0||g.x>=i.drawingBufferWidth){ft(true,e,t,r)}else if(Math.abs(i.drawingBufferWidth*.5-g.x)<1){s.width=g.x;o.position.x*=E.sign(o.position.x);o.frustum.right=0;a.cullingVolume=o.frustum.computeCullingVolume(o.positionWC,o.directionWC,o.upWC);i.uniformState.update(a);ft(true,e,t,r);s.x=s.width;o.position.x=-o.position.x;o.frustum.right=-o.frustum.left;o.frustum.left=0;a.cullingVolume=o.frustum.computeCullingVolume(o.positionWC,o.directionWC,o.upWC);i.uniformState.update(a);ft(false,e,t,r)}else if(g.x>i.drawingBufferWidth*.5){s.width=g.x;var C=o.frustum.right;o.frustum.right=l.x-v;a.cullingVolume=o.frustum.computeCullingVolume(o.positionWC,o.directionWC,o.upWC);i.uniformState.update(a);ft(true,e,t,r);s.x+=g.x;s.width=i.drawingBufferWidth-g.x;o.position.x=-o.position.x;o.frustum.left=-o.frustum.right;o.frustum.right=C-o.frustum.right*2;a.cullingVolume=o.frustum.computeCullingVolume(o.positionWC,o.directionWC,o.upWC);i.uniformState.update(a);ft(false,e,t,r)}else{s.x=g.x;s.width=i.drawingBufferWidth-g.x;var b=o.frustum.left;o.frustum.left=-l.x-v;a.cullingVolume=o.frustum.computeCullingVolume(o.positionWC,o.directionWC,o.upWC);i.uniformState.update(a);ft(true,e,t,r);s.x=0;s.width=g.x;o.position.x=-o.position.x;o.frustum.right=-o.frustum.left;o.frustum.left=b-o.frustum.left*2;a.cullingVolume=o.frustum.computeCullingVolume(o.positionWC,o.directionWC,o.upWC);i.uniformState.update(a);ft(false,e,t,r)}o._setTransform(f);n.clone(d,o.position);o.frustum=h.clone();s.x=y;s.width=w}function ft(e,t,r,i){var n=t.frameState.passes.depth;if(!e&&!n){t.frameState.commandList.length=0}if(!n){vt(t)}ke(t);if(e){_t(t,r,i);if(!n){$e(t);rt(t)}}Je(t,r)}function ht(e){var t=e._frameState;var r=e._environmentState;var i=t.passes.render;var n=e.skyAtmosphere;var a=e.globe;if(!i||e._mode!==pe.SCENE2D&&t.camera.frustum instanceof ae){r.skyAtmosphereCommand=undefined;r.skyBoxCommand=undefined;r.sunDrawCommand=undefined;r.sunComputeCommand=undefined;r.moonCommand=undefined}else{if(d(n)&&d(a)){n.setDynamicAtmosphereColor(a.enableLighting);r.isReadyForAtmosphere=r.isReadyForAtmosphere||a._surface._tilesToRender.length>0}r.skyAtmosphereCommand=d(n)?n.update(t):undefined;r.skyBoxCommand=d(e.skyBox)?e.skyBox.update(t):undefined;var o=d(e.sun)?e.sun.update(e):undefined;r.sunDrawCommand=d(o)?o.drawCommand:undefined;r.sunComputeCommand=d(o)?o.computeCommand:undefined;r.moonCommand=d(e.moon)?e.moon.update(t):undefined}var s=r.clearGlobeDepth=d(a)&&(!a.depthTestAgainstTerrain||e.mode===pe.SCENE2D);var u=r.useDepthPlane=s&&e.mode===pe.SCENE3D;if(u){e._depthPlane.update(t)}}function pt(e){var t=e._frameState;if(e.debugShowFrustumPlanes!==e._debugShowFrustumPlanes){if(e.debugShowFrustumPlanes){e._debugFrustumPlanes=new X({camera:e.camera,updateOnChange:false})}else{e._debugFrustumPlanes=e._debugFrustumPlanes&&e._debugFrustumPlanes.destroy()}e._debugShowFrustumPlanes=e.debugShowFrustumPlanes}if(d(e._debugFrustumPlanes)){e._debugFrustumPlanes.update(t)}}function mt(e){var t=e._frameState;var r=t.shadowMaps;var i=r.length;var n=i>0&&!t.passes.pick&&e.mode===pe.SCENE3D;if(n!==t.shadowHints.shadowsEnabled){++t.shadowHints.lastDirtyTime;t.shadowHints.shadowsEnabled=n}if(!n){return}for(var a=0;a<i;++a){if(r[a]!==t.shadowHints.shadowMaps[a]){++t.shadowHints.lastDirtyTime;break}}t.shadowHints.shadowMaps.length=0;t.shadowHints.lightShadowMaps.length=0;for(var o=0;o<i;++o){var s=r[o];s.update(t);t.shadowHints.shadowMaps.push(s);if(s.fromLightSource){t.shadowHints.lightShadowMaps.push(s)}if(s.dirty){++t.shadowHints.lastDirtyTime;s.dirty=false}}}function vt(e){var t=e._frameState;e._groundPrimitives.update(t);e._primitives.update(t);pt(e);mt(e);if(e._globe){e._globe.update(t)}}function _t(e,t,r){var i=e._context;var n=e._environmentState;var a=e._frameState.passes;var o=a.pick;var u=e._useWebVR&&e.mode!==pe.SCENE2D;n.originalFramebuffer=t.framebuffer;if(d(e.sun)&&e.sunBloom!==e._sunBloom){if(e.sunBloom&&!u){e._sunPostProcess=new ye}else if(d(e._sunPostProcess)){e._sunPostProcess=e._sunPostProcess.destroy()}e._sunBloom=e.sunBloom}else if(!d(e.sun)&&d(e._sunPostProcess)){e._sunPostProcess=e._sunPostProcess.destroy();e._sunBloom=false}var l=e._clearColorCommand;s.clone(r,l.color);l.execute(i,t);var c=n.useGlobeDepthFramebuffer=!o&&d(e._globeDepth);if(c){e._globeDepth.update(i);e._globeDepth.clear(i,t,r)}var f=false;var h=e._frustumCommandsList;var p=h.length;for(var m=0;m<p;++m){if(h[m].indices[k.TRANSLUCENT]>0){f=true;break}}var v=n.useOIT=!o&&f&&d(e._oit)&&e._oit.isSupported();if(v){e._oit.update(i,e._globeDepth.framebuffer);e._oit.clear(i,t,r);n.useOIT=e._oit.isSupported()}var _=n.useFXAA=!o&&e.fxaa;if(_){e._fxaa.update(i);e._fxaa.clear(i,t,r)}if(n.isSunVisible&&e.sunBloom&&!u){t.framebuffer=e._sunPostProcess.update(t)}else if(c){t.framebuffer=e._globeDepth.framebuffer}else if(_){t.framebuffer=e._fxaa.getColorFramebuffer()}if(d(t.framebuffer)){l.execute(i,t)}}function gt(e,t){var r=e._context;var i=e._environmentState
;var n=i.useGlobeDepthFramebuffer;if(e.debugShowGlobeDepth&&n){var a=je(e,e.debugShowDepthFrustum-1);a.executeDebugGlobeDepth(r,t)}if(e.debugShowPickDepth&&n){var o=Ye(e,e.debugShowDepthFrustum-1);o.executeDebugPickDepth(r,t)}var s=i.useOIT;var u=i.useFXAA;if(s){t.framebuffer=u?e._fxaa.getColorFramebuffer():undefined;e._oit.execute(r,t)}if(u){if(!s&&n){t.framebuffer=e._fxaa.getColorFramebuffer();e._globeDepth.executeCopyColor(r,t)}t.framebuffer=i.originalFramebuffer;e._fxaa.execute(r,t)}if(!s&&!u&&n){t.framebuffer=i.originalFramebuffer;e._globeDepth.executeCopyColor(r,t)}}function yt(e){var t=e.afterRender;for(var r=0,i=t.length;r<i;++r){t[r]()}t.length=0}Ce.prototype.initializeFrame=function(){if(this._shaderFrameCount++===120){this._shaderFrameCount=0;this._context.shaderCache.destroyReleasedShaderPrograms()}this._tweens.update();this._screenSpaceCameraController.update();if(d(this._deviceOrientationCameraController)){this._deviceOrientationCameraController.update()}this._camera.update(this._mode);this._camera._updateCameraChanged()};var wt=new n;function Ct(e,t){if(!d(t)){t=S.now()}var r=e._camera;if(!xe(r,e._cameraClone,E.EPSILON6)){if(!e._cameraStartFired){r.moveStart.raiseEvent();e._cameraStartFired=true}e._cameraMovedTime=w();W.clone(r,e._cameraClone)}else if(e._cameraStartFired&&w()-e._cameraMovedTime>e.cameraEventWaitTime){r.moveEnd.raiseEvent();e._cameraStartFired=false}e._preRender.raiseEvent(e,t);e._jobScheduler.resetBudgets();D.resetBudgets();var i=e.context;var a=i.uniformState;var o=e._frameState;var u=E.incrementWrap(o.frameNumber,15e6,1);Oe(e,u,t);o.passes.render=true;o.creditDisplay.beginFrame();e.fog.update(o);a.update(o);var l=e.shadowMap;if(d(l)&&l.enabled){n.negate(a.sunDirectionWC,e._sunCamera.direction);o.shadowMaps.push(l)}e._computeCommandList.length=0;e._overlayCommandList.length=0;var f=e._passState;f.framebuffer=undefined;f.blendingEnabled=undefined;f.scissorTest=undefined;if(d(e.globe)){e.globe.beginFrame(o)}ht(e);it(e,f,c(e.backgroundColor,s.BLACK));gt(e,f);et(e,f);if(d(e.globe)){e.globe.endFrame(o)}o.creditDisplay.endFrame();if(e.debugShowFramesPerSecond){if(!d(e._performanceDisplay)){var h=document.createElement("div");h.className="cesium-performanceDisplay-defaultContainer";var p=e._canvas.parentNode;p.appendChild(h);var m=new se({container:h});e._performanceDisplay=m;e._performanceContainer=h}e._performanceDisplay.update()}else if(d(e._performanceDisplay)){e._performanceDisplay=e._performanceDisplay&&e._performanceDisplay.destroy();e._performanceContainer.parentNode.removeChild(e._performanceContainer)}i.endFrame();yt(o);e._postRender.raiseEvent(e,t)}Ce.prototype.render=function(e){try{Ct(this,e)}catch(e){this._renderError.raiseEvent(this,e);if(this.rethrowRenderErrors){throw e}}};Ce.prototype.clampLineWidth=function(e){return Math.max(L.minimumAliasedLineWidth,Math.min(e,L.maximumAliasedLineWidth))};var bt=new oe;var St=new n;var Et=new n;var Tt=new i;var xt=new T;function At(e,t,r,i){var a=e._camera;var o=a.frustum;if(d(o._offCenterFrustum)){o=o._offCenterFrustum}var s=e._passState.viewport;var u=2*(t.x-s.x)/s.width-1;u*=(o.right-o.left)*.5;var l=2*(s.height-t.y-s.y)/s.height-1;l*=(o.top-o.bottom)*.5;var c=T.clone(a.transform,xt);a._setTransform(T.IDENTITY);var f=n.clone(a.position,St);n.multiplyByScalar(a.right,u,Et);n.add(Et,f,f);n.multiplyByScalar(a.up,l,Et);n.add(Et,f,f);a._setTransform(c);if(e.mode===pe.SCENE2D){n.fromElements(f.z,f.x,f.y,f)}var h=o.getPixelDimensions(s.width,s.height,1,Tt);var p=bt;p.right=h.x*.5;p.left=-p.right;p.top=h.y*.5;p.bottom=-p.top;p.near=o.near;p.far=o.far;return p.computeCullingVolume(f,a.directionWC,a.upWC)}var Pt=new ce;function Dt(e,t,r,i){var n=e._camera;var a=n.frustum;var o=a.near;var s=Math.tan(a.fovy*.5);var u=a.aspectRatio*s;var l=e._passState.viewport;var c=2*(t.x-l.x)/l.width-1;var d=2*(l.height-t.y-l.y)/l.height-1;var f=c*o*u;var h=d*o*s;var p=a.getPixelDimensions(l.width,l.height,1,Tt);var m=p.x*r*.5;var v=p.y*i*.5;var _=Pt;_.top=h+v;_.bottom=h-v;_.right=f+m;_.left=f-m;_.near=o;_.far=a.far;return _.computeCullingVolume(n.positionWC,n.directionWC,n.upWC)}function Mt(e,t,r,i){var n=e.camera.frustum;if(n instanceof ae||n instanceof oe){return At(e,t,r,i)}return Dt(e,t,r,i)}var It=3;var Ot=3;var Rt=new e(0,0,It,Ot);var Nt=new s(0,0,0,0);var Lt=new i;Ce.prototype.pick=function(e){if(!d(e)){throw new p("windowPosition is undefined.")}var t=this._context;var r=t.uniformState;var i=this._frameState;var n=me.transformWindowToDrawingBuffer(this,e,Lt);if(!d(this._pickFramebuffer)){this._pickFramebuffer=t.createPickFramebuffer()}this._jobScheduler.disableThisFrame();Oe(this,i.frameNumber,i.time);i.cullingVolume=Mt(this,n,It,Ot);i.passes.pick=true;r.update(i);Rt.x=n.x-(It-1)*.5;Rt.y=this.drawingBufferHeight-n.y-(Ot-1)*.5;var a=this._pickFramebuffer.begin(Rt);it(this,a,Nt);gt(this,a);var o=this._pickFramebuffer.end(Rt);t.endFrame();yt(i);return o};var Bt=/\bgl_FragDepthEXT\b/;var Ft=/\bdiscard\b/;function kt(e,t){var r=e.shaderCache.getDerivedShaderProgram(t,"depthOnly");if(!d(r)){var i=t._attributeLocations;var n=t.fragmentShaderSource;var a=false;var o=n.sources;var s=o.length;for(var u=0;u<s;++u){if(Bt.test(o[u])||Ft.test(o[u])){a=true;break}}if(!a){n=new G({sources:["void main() { gl_FragColor = vec4(1.0); }"]})}r=e.shaderCache.createDerivedShaderProgram(t,"depthOnly",{vertexShaderSource:t.vertexShaderSource,fragmentShaderSource:n,attributeLocations:i})}return r}function Vt(e,t){var r=e._depthOnlyRenderStateCache;var i=r[t.id];if(!d(i)){var n=U.getState(t);n.depthMask=true;n.colorMask={red:false,green:false,blue:false,alpha:false};i=U.fromCache(n);r[t.id]=i}return i}function zt(e,t,r,i){if(!d(i)){i={}}var n;var a;if(d(i.depthOnlyCommand)){n=i.depthOnlyCommand.shaderProgram;a=i.depthOnlyCommand.renderState}i.depthOnlyCommand=B.shallowClone(t,i.depthOnlyCommand);if(!d(n)||i.shaderProgramId!==t.shaderProgram.id){i.depthOnlyCommand.shaderProgram=kt(r,t.shaderProgram);i.depthOnlyCommand.renderState=Vt(e,t.renderState);i.shaderProgramId=t.shaderProgram.id}else{i.depthOnlyCommand.shaderProgram=n;i.depthOnlyCommand.renderState=a}return i}function Ut(t,r){var i=t._context;var n=t._frameState;Ie(n.passes);n.passes.pick=true;n.passes.depth=true;n.cullingVolume=Mt(t,r,1,1);var a=t._pickDepthPassState;if(!d(a)){a=t._pickDepthPassState=new V(i);a.scissorTest={enabled:true,rectangle:new e};a.viewport=new e}var o=i.drawingBufferWidth;var s=i.drawingBufferHeight;var u=t._pickDepthFramebuffer;var l=t._pickDepthFramebufferWidth;var c=t._pickDepthFramebufferHeight;if(!d(u)||l!==o||c!==s){t._pickDepthFramebuffer=t._pickDepthFramebuffer&&t._pickDepthFramebuffer.destroy();u=t._pickDepthFramebuffer=new F({context:i,depthStencilTexture:new H({context:i,width:o,height:s,pixelFormat:P.DEPTH_STENCIL,pixelDatatype:z.UNSIGNED_INT_24_8})});t._pickDepthFramebufferWidth=o;t._pickDepthFramebufferHeight=s}a.framebuffer=u;a.viewport.width=o;a.viewport.height=s;a.scissorTest.rectangle.x=r.x;a.scissorTest.rectangle.y=s-r.y;a.scissorTest.rectangle.width=1;a.scissorTest.rectangle.height=1;it(t,a,Nt);gt(t,a);i.endFrame()}var qt=new a;var Gt=new a(1,1/255,1/65025,1/16581375);Ce.prototype.pickPositionWorldCoordinates=function(e,t){if(!this.useDepthPicking){return undefined}if(!d(e)){throw new p("windowPosition is undefined.")}if(!d(this._globeDepth)){throw new p("Picking from the depth buffer is not supported. Check pickPositionSupported.")}var r=this._context;var i=r.uniformState;var n=me.transformWindowToDrawingBuffer(this,e,Lt);if(this.pickTranslucentDepth){Ut(this,n)}n.y=this.drawingBufferHeight-n.y;var o=this._camera;var s;if(d(o.frustum.fov)){s=o.frustum.clone(Xe)}else if(d(o.frustum.infiniteProjectionMatrix)){s=o.frustum.clone(Ze)}else if(d(o.frustum.width)){s=o.frustum.clone(Ke)}else{s=o.frustum.clone(Qe)}var u=this.numberOfFrustums;for(var l=0;l<u;++l){var c=Ye(this,l);var f=r.readPixels({x:n.x,y:n.y,width:1,height:1,framebuffer:c.framebuffer});var h=a.unpack(f,0,qt);a.divideByScalar(h,255,h);var m=a.dot(h,Gt);if(m>0&&m<1){var v=this._frustumCommandsList[l];var _;if(this.mode===pe.SCENE2D){_=o.position.z;o.position.z=_-v.near+1;s.far=Math.max(1,v.far-v.near);s.near=1;i.update(this.frameState);i.updateFrustum(s)}else{s.near=v.near*(l!==0?be:1);s.far=v.far;i.updateFrustum(s)}t=me.drawingBufferToWgs84Coordinates(this,n,m,t);if(this.mode===pe.SCENE2D){o.position.z=_;i.update(this.frameState)}return t}}return undefined};var Ht=new o;Ce.prototype.pickPosition=function(e,t){t=this.pickPositionWorldCoordinates(e,t);if(d(t)&&this.mode!==pe.SCENE3D){n.fromElements(t.y,t.z,t.x,t);var r=this.mapProjection;var i=r.ellipsoid;var a=r.unproject(t,Ht);i.cartographicToCartesian(a,t)}return t};Ce.prototype.drillPick=function(e,t){if(!d(e)){throw new p("windowPosition is undefined.")}var r;var i;var n=[];var a=[];var o=[];if(!d(t)){t=Number.MAX_VALUE}var s=this.pick(e);while(d(s)&&d(s.primitive)){n.push(s);if(0>=--t){break}var u=s.primitive;var l=false;if(typeof u.getGeometryInstanceAttributes==="function"){if(d(s.id)){i=u.getGeometryInstanceAttributes(s.id);if(d(i)&&d(i.show)){l=true;i.show=M.toValue(false,i.show);o.push(i)}}}if(!l){u.show=false;a.push(u)}s=this.pick(e)}for(r=0;r<a.length;++r){a[r].show=true}for(r=0;r<o.length;++r){i=o[r];i.show=M.toValue(true,i.show)}return n};Ce.prototype.completeMorph=function(){this._transitioner.completeMorph()};Ce.prototype.morphTo2D=function(e){var t;var r=this.globe;if(d(r)){t=r.ellipsoid}else{t=this.mapProjection.ellipsoid}e=c(e,2);this._transitioner.morphTo2D(e,t)};Ce.prototype.morphToColumbusView=function(e){var t;var r=this.globe;if(d(r)){t=r.ellipsoid}else{t=this.mapProjection.ellipsoid}e=c(e,2);this._transitioner.morphToColumbusView(e,t)};Ce.prototype.morphTo3D=function(e){var t;var r=this.globe;if(d(r)){t=r.ellipsoid}else{t=this.mapProjection.ellipsoid}e=c(e,2);this._transitioner.morphTo3D(e,t)};Ce.prototype.isDestroyed=function(){return false};Ce.prototype.destroy=function(){this._tweens.removeAll();this._computeEngine=this._computeEngine&&this._computeEngine.destroy();this._screenSpaceCameraController=this._screenSpaceCameraController&&this._screenSpaceCameraController.destroy();this._deviceOrientationCameraController=this._deviceOrientationCameraController&&!this._deviceOrientationCameraController.isDestroyed()&&this._deviceOrientationCameraController.destroy();this._pickFramebuffer=this._pickFramebuffer&&this._pickFramebuffer.destroy();this._pickDepthFramebuffer=this._pickDepthFramebuffer&&this._pickDepthFramebuffer.destroy();this._primitives=this._primitives&&this._primitives.destroy();this._groundPrimitives=this._groundPrimitives&&this._groundPrimitives.destroy();this._globe=this._globe&&this._globe.destroy();this.skyBox=this.skyBox&&this.skyBox.destroy();this.skyAtmosphere=this.skyAtmosphere&&this.skyAtmosphere.destroy();this._debugSphere=this._debugSphere&&this._debugSphere.destroy();this.sun=this.sun&&this.sun.destroy();this._sunPostProcess=this._sunPostProcess&&this._sunPostProcess.destroy();this._depthPlane=this._depthPlane&&this._depthPlane.destroy();this._transitioner.destroy();this._debugFrustumPlanes=this._debugFrustumPlanes&&this._debugFrustumPlanes.destroy();if(d(this._globeDepth)){this._globeDepth.destroy()}if(d(this._oit)){this._oit.destroy()}this._fxaa.destroy();this._context=this._context&&this._context.destroy();this._frameState.creditDisplay.destroy();if(d(this._performanceDisplay)){this._performanceDisplay=this._performanceDisplay&&this._performanceDisplay.destroy();this._performanceContainer.parentNode.removeChild(this._performanceContainer)}return h(this)};return Ce});define("Scene/SingleTileImageryProvider",["../Core/Credit","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/GeographicTilingScheme","../Core/loadImage","../Core/Rectangle","../Core/RuntimeError","../Core/TileProviderError","../ThirdParty/when"],function(e,t,r,i,n,a,o,s,u,l,c,d){"use strict";function f(i){i=t(i,{});var f=i.url;if(!r(f)){throw new n("url is required.")}this._url=f;var h=i.proxy;this._proxy=h;var p=t(i.rectangle,u.MAX_VALUE);var m=new o({rectangle:p,numberOfLevelZeroTilesX:1,numberOfLevelZeroTilesY:1,ellipsoid:i.ellipsoid});this._tilingScheme=m;this._image=undefined;this._texture=undefined;this._tileWidth=0;this._tileHeight=0;this._errorEvent=new a;this._ready=false;this._readyPromise=d.defer();var v=f;if(r(h)){v=h.getURL(v)}var _=i.credit;if(typeof _==="string"){_=new e(_)}this._credit=_;var g=this;var y;function w(e){g._image=e;g._tileWidth=e.width;g._tileHeight=e.height;g._ready=true;g._readyPromise.resolve(true);c.handleSuccess(g._errorEvent)}function C(e){var t="Failed to load image "+v+".";y=c.handleError(y,g,g._errorEvent,t,0,0,0,b,e);g._readyPromise.reject(new l(t))}function b(){d(s(v),w,C)}b()}i(f.prototype,{url:{get:function(){return this._url}},proxy:{get:function(){return this._proxy}},tileWidth:{get:function(){if(!this._ready){throw new n("tileWidth must not be called before the imagery provider is ready.")}return this._tileWidth}},tileHeight:{get:function(){if(!this._ready){throw new n("tileHeight must not be called before the imagery provider is ready.")}return this._tileHeight}},maximumLevel:{get:function(){if(!this._ready){throw new n("maximumLevel must not be called before the imagery provider is ready.")}return 0}},minimumLevel:{get:function(){if(!this._ready){throw new n("minimumLevel must not be called before the imagery provider is ready.")}return 0}},tilingScheme:{get:function(){if(!this._ready){throw new n("tilingScheme must not be called before the imagery provider is ready.")}return this._tilingScheme}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){if(!this._ready){throw new n("tileDiscardPolicy must not be called before the imagery provider is ready.")}return undefined}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return true}}});f.prototype.getTileCredits=function(e,t,r){return undefined};f.prototype.requestImage=function(e,t,r,i){if(!this._ready){throw new n("requestImage must not be called before the imagery provider is ready.")}return this._image};f.prototype.pickFeatures=function(e,t,r,i,n){return undefined};return f});define("Shaders/SkyAtmosphereFS",[],function(){"use strict";return"#ifdef COLOR_CORRECT\nuniform vec3 u_hsbShift;\n#endif\nconst float g = -0.95;\nconst float g2 = g * g;\nvarying vec3 v_rayleighColor;\nvarying vec3 v_mieColor;\nvarying vec3 v_toCamera;\nvarying vec3 v_positionEC;\nvoid main (void)\n{\nfloat cosAngle = dot(czm_sunDirectionWC, normalize(v_toCamera)) / length(v_toCamera);\nfloat rayleighPhase = 0.75 * (1.0 + cosAngle * cosAngle);\nfloat miePhase = 1.5 * ((1.0 - g2) / (2.0 + g2)) * (1.0 + cosAngle * cosAngle) / pow(1.0 + g2 - 2.0 * g * cosAngle, 1.5);\nconst float exposure = 2.0;\nvec3 rgb = rayleighPhase * v_rayleighColor + miePhase * v_mieColor;\nrgb = vec3(1.0) - exp(-exposure * rgb);\nfloat l = czm_luminance(rgb);\n#ifdef COLOR_CORRECT\nvec3 hsb = czm_RGBToHSB(rgb);\nhsb.x += u_hsbShift.x;\nhsb.y = clamp(hsb.y + u_hsbShift.y, 0.0, 1.0);\nhsb.z = hsb.z > czm_epsilon7 ? hsb.z + u_hsbShift.z : 0.0;\nrgb = czm_HSBToRGB(hsb);\nl = min(l, czm_luminance(rgb));\n#endif\ngl_FragColor = vec4(rgb, min(smoothstep(0.0, 0.1, l), 1.0) * smoothstep(0.0, 1.0, czm_morphTime));\n}\n"});define("Shaders/SkyAtmosphereVS",[],function(){"use strict";return"attribute vec4 position;\nuniform vec4 u_cameraAndRadiiAndDynamicAtmosphereColor;\nconst float Kr = 0.0025;\nconst float Kr4PI = Kr * 4.0 * czm_pi;\nconst float Km = 0.0015;\nconst float Km4PI = Km * 4.0 * czm_pi;\nconst float ESun = 15.0;\nconst float KmESun = Km * ESun;\nconst float KrESun = Kr * ESun;\nconst vec3 InvWavelength = vec3(\n5.60204474633241,\n9.473284437923038,\n19.643802610477206);\nconst float rayleighScaleDepth = 0.25;\nconst int nSamples = 2;\nconst float fSamples = 2.0;\nvarying vec3 v_rayleighColor;\nvarying vec3 v_mieColor;\nvarying vec3 v_toCamera;\nfloat scale(float cosAngle)\n{\nfloat x = 1.0 - cosAngle;\nreturn rayleighScaleDepth  * exp(-0.00287 + x*(0.459 + x*(3.83 + x*(-6.80 + x*5.25))));\n}\nvoid main(void)\n{\nfloat cameraHeight = u_cameraAndRadiiAndDynamicAtmosphereColor.x;\nfloat outerRadius = u_cameraAndRadiiAndDynamicAtmosphereColor.y;\nfloat innerRadius = u_cameraAndRadiiAndDynamicAtmosphereColor.z;\nvec3 positionV3 = position.xyz;\nvec3 ray = positionV3 - czm_viewerPositionWC;\nfloat far = length(ray);\nray /= far;\nfloat atmosphereScale = 1.0 / (outerRadius - innerRadius);\n#ifdef SKY_FROM_SPACE\nfloat B = 2.0 * dot(czm_viewerPositionWC, ray);\nfloat C = cameraHeight * cameraHeight - outerRadius * outerRadius;\nfloat det = max(0.0, B*B - 4.0 * C);\nfloat near = 0.5 * (-B - sqrt(det));\nvec3 start = czm_viewerPositionWC + ray * near;\nfar -= near;\nfloat startAngle = dot(ray, start) / outerRadius;\nfloat startDepth = exp(-1.0 / rayleighScaleDepth );\nfloat startOffset = startDepth*scale(startAngle);\n#else // SKY_FROM_ATMOSPHERE\nvec3 start = czm_viewerPositionWC;\nfloat height = length(start);\nfloat depth = exp((atmosphereScale / rayleighScaleDepth ) * (innerRadius - cameraHeight));\nfloat startAngle = dot(ray, start) / height;\nfloat startOffset = depth*scale(startAngle);\n#endif\nfloat sampleLength = far / fSamples;\nfloat scaledLength = sampleLength * atmosphereScale;\nvec3 sampleRay = ray * sampleLength;\nvec3 samplePoint = start + sampleRay * 0.5;\nvec3 frontColor = vec3(0.0, 0.0, 0.0);\nvec3 lightDir = (u_cameraAndRadiiAndDynamicAtmosphereColor.w > 0.0) ? czm_sunPositionWC - czm_viewerPositionWC : czm_viewerPositionWC;\nlightDir = normalize(lightDir);\nfor(int i=0; i<nSamples; i++)\n{\nfloat height = length(samplePoint);\nfloat depth = exp((atmosphereScale / rayleighScaleDepth ) * (innerRadius - height));\nfloat fLightAngle = dot(lightDir, samplePoint) / height;\nfloat fCameraAngle = dot(ray, samplePoint) / height;\nfloat fScatter = (startOffset + depth*(scale(fLightAngle) - scale(fCameraAngle)));\nvec3 attenuate = exp(-fScatter * (InvWavelength * Kr4PI + Km4PI));\nfrontColor += attenuate * (depth * scaledLength);\nsamplePoint += sampleRay;\n}\nv_mieColor = frontColor * KmESun;\nv_rayleighColor = frontColor * (InvWavelength * KrESun);\nv_toCamera = czm_viewerPositionWC - positionV3;\ngl_Position = czm_modelViewProjection * position;\n}\n"});define("Scene/SkyAtmosphere",["../Core/Cartesian3","../Core/Cartesian4","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/Ellipsoid","../Core/EllipsoidGeometry","../Core/GeometryPipeline","../Core/Math","../Core/VertexFormat","../Renderer/BufferUsage","../Renderer/DrawCommand","../Renderer/RenderState","../Renderer/ShaderProgram","../Renderer/ShaderSource","../Renderer/VertexArray","../Shaders/SkyAtmosphereFS","../Shaders/SkyAtmosphereVS","./BlendingState","./CullFace","./SceneMode"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w,C){"use strict";function b(i){i=r(i,o.WGS84);this.show=true;this._ellipsoid=i;this._command=new f({owner:this});this._spSkyFromSpace=undefined;this._spSkyFromAtmosphere=undefined;this._spSkyFromSpaceColorCorrect=undefined;this._spSkyFromAtmosphereColorCorrect=undefined;this.hueShift=0;this.saturationShift=0;this.brightnessShift=0;this._hueSaturationBrightness=new e;var n=new t;n.w=0;n.y=e.maximumComponent(e.multiplyByScalar(i.radii,1.025,new e));n.z=i.maximumRadius;this._cameraAndRadiiAndDynamicAtmosphereColor=n;var a=this;this._command.uniformMap={u_cameraAndRadiiAndDynamicAtmosphereColor:function(){return a._cameraAndRadiiAndDynamicAtmosphereColor},u_hsbShift:function(){a._hueSaturationBrightness.x=a.hueShift;a._hueSaturationBrightness.y=a.saturationShift;a._hueSaturationBrightness.z=a.brightnessShift;return a._hueSaturationBrightness}}}n(b.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}});b.prototype.setDynamicAtmosphereColor=function(e){this._cameraAndRadiiAndDynamicAtmosphereColor.w=e?1:0};b.prototype.update=function(t){if(!this.show){return undefined}var r=t.mode;if(r!==C.SCENE3D&&r!==C.MORPHING){return undefined}if(!t.passes.render){return undefined}var n=this._command;if(!i(n.vertexArray)){var a=t.context;var o=s.createGeometry(new s({radii:e.multiplyByScalar(this._ellipsoid.radii,1.025,new e),slicePartitions:256,stackPartitions:256,vertexFormat:c.POSITION_ONLY}));n.vertexArray=v.fromGeometry({context:a,geometry:o,attributeLocations:u.createAttributeLocations(o),bufferUsage:d.STATIC_DRAW});n.renderState=h.fromCache({cull:{enabled:true,face:w.FRONT},blending:y.ALPHA_BLEND});var l=new m({defines:["SKY_FROM_SPACE"],sources:[g]});this._spSkyFromSpace=p.fromCache({context:a,vertexShaderSource:l,fragmentShaderSource:_});l=new m({defines:["SKY_FROM_ATMOSPHERE"],sources:[g]});this._spSkyFromAtmosphere=p.fromCache({context:a,vertexShaderSource:l,fragmentShaderSource:_})}var f=S(this);if(f&&(!i(this._spSkyFromSpaceColorCorrect)||!i(this._spSkyFromAtmosphereColorCorrect))){var b=t.context;var E=new m({defines:["SKY_FROM_SPACE"],sources:[g]});var T=new m({defines:["COLOR_CORRECT"],sources:[_]});this._spSkyFromSpaceColorCorrect=p.fromCache({context:b,vertexShaderSource:E,fragmentShaderSource:T});E=new m({defines:["SKY_FROM_ATMOSPHERE"],sources:[g]});this._spSkyFromAtmosphereColorCorrect=p.fromCache({context:b,vertexShaderSource:E,fragmentShaderSource:T})}var x=t.camera.positionWC;var A=e.magnitude(x);this._cameraAndRadiiAndDynamicAtmosphereColor.x=A;if(A>this._cameraAndRadiiAndDynamicAtmosphereColor.y){n.shaderProgram=f?this._spSkyFromSpaceColorCorrect:this._spSkyFromSpace}else{n.shaderProgram=f?this._spSkyFromAtmosphereColorCorrect:this._spSkyFromAtmosphere}return n};function S(e){return!(l.equalsEpsilon(e.hueShift,0,l.EPSILON7)&&l.equalsEpsilon(e.saturationShift,0,l.EPSILON7)&&l.equalsEpsilon(e.brightnessShift,0,l.EPSILON7))}b.prototype.isDestroyed=function(){return false};b.prototype.destroy=function(){var e=this._command;e.vertexArray=e.vertexArray&&e.vertexArray.destroy();this._spSkyFromSpace=this._spSkyFromSpace&&this._spSkyFromSpace.destroy();this._spSkyFromAtmosphere=this._spSkyFromAtmosphere&&this._spSkyFromAtmosphere.destroy();this._spSkyFromSpaceColorCorrect=this._spSkyFromSpaceColorCorrect&&this._spSkyFromSpaceColorCorrect.destroy();this._spSkyFromAtmosphereColorCorrect=this._spSkyFromAtmosphereColorCorrect&&this._spSkyFromAtmosphereColorCorrect.destroy();return a(this)};return b});define("Shaders/SkyBoxFS",[],function(){"use strict";return"uniform samplerCube u_cubeMap;\nvarying vec3 v_texCoord;\nvoid main()\n{\nvec3 rgb = textureCube(u_cubeMap, normalize(v_texCoord)).rgb;\ngl_FragColor = vec4(rgb, czm_morphTime);\n}\n"});define("Shaders/SkyBoxVS",[],function(){"use strict";return"attribute vec3 position;\nvarying vec3 v_texCoord;\nvoid main()\n{\nvec3 p = czm_viewRotation * (czm_temeToPseudoFixed * (czm_entireFrustum.y * position));\ngl_Position = czm_projection * vec4(p, 1.0);\nv_texCoord = position.xyz;\n}\n"});define("Scene/SkyBox",["../Core/BoxGeometry","../Core/Cartesian3","../Core/defaultValue","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Core/GeometryPipeline","../Core/Matrix4","../Core/VertexFormat","../Renderer/BufferUsage","../Renderer/CubeMap","../Renderer/DrawCommand","../Renderer/loadCubeMap","../Renderer/RenderState","../Renderer/ShaderProgram","../Renderer/VertexArray","../Shaders/SkyBoxFS","../Shaders/SkyBoxVS","./BlendingState","./SceneMode"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y){"use strict";function w(e){this.sources=e.sources;this._sources=undefined;this.show=r(e.show,true);this._command=new d({modelMatrix:s.clone(s.IDENTITY),owner:this});this._cubeMap=undefined}w.prototype.update=function(r){if(!this.show){return undefined}if(r.mode!==y.SCENE3D&&r.mode!==y.MORPHING){return undefined}if(!r.passes.render){return undefined}var n=r.context;if(this._sources!==this.sources){this._sources=this.sources;var s=this.sources;if(!i(s.positiveX)||!i(s.negativeX)||!i(s.positiveY)||!i(s.negativeY)||!i(s.positiveZ)||!i(s.negativeZ)){throw new a("this.sources is required and must have positiveX, negativeX, positiveY, negativeY, positiveZ, and negativeZ properties.")}if(typeof s.positiveX!==typeof s.negativeX||typeof s.positiveX!==typeof s.positiveY||typeof s.positiveX!==typeof s.negativeY||typeof s.positiveX!==typeof s.positiveZ||typeof s.positiveX!==typeof s.negativeZ){throw new a("this.sources properties must all be the same type.")}if(typeof s.positiveX==="string"){f(n,this._sources).then(function(e){w._cubeMap=w._cubeMap&&w._cubeMap.destroy();w._cubeMap=e})}else{this._cubeMap=this._cubeMap&&this._cubeMap.destroy();this._cubeMap=new c({context:n,source:s})}}var d=this._command;if(!i(d.vertexArray)){var w=this;d.uniformMap={u_cubeMap:function(){return w._cubeMap}};var C=e.createGeometry(e.fromDimensions({dimensions:new t(2,2,2),vertexFormat:u.POSITION_ONLY}));var b=o.createAttributeLocations(C);d.vertexArray=m.fromGeometry({context:n,geometry:C,attributeLocations:b,bufferUsage:l.STATIC_DRAW});d.shaderProgram=p.fromCache({context:n,vertexShaderSource:_,fragmentShaderSource:v,attributeLocations:b});d.renderState=h.fromCache({blending:g.ALPHA_BLEND})}if(!i(this._cubeMap)){return undefined}return d};w.prototype.isDestroyed=function(){return false};w.prototype.destroy=function(){var e=this._command;e.vertexArray=e.vertexArray&&e.vertexArray.destroy();e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy();this._cubeMap=this._cubeMap&&this._cubeMap.destroy();return n(this)};return w});define("Scene/StyleExpression",["../Core/DeveloperError"],function(e){"use strict";function t(){}t.prototype.evaluate=function(t,r){e.throwInstantiationError()};t.prototype.evaluateColor=function(t,r,i){e.throwInstantiationError()};return t});define("Shaders/SunFS",[],function(){"use strict";return"uniform sampler2D u_texture;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\ngl_FragColor = texture2D(u_texture, v_textureCoordinates);\n}\n"});define("Shaders/SunTextureFS",[],function(){"use strict";return"uniform float u_glowLengthTS;\nuniform float u_radiusTS;\nvarying vec2 v_textureCoordinates;\nvec2 rotate(vec2 p, vec2 direction)\n{\nreturn vec2(p.x * direction.x - p.y * direction.y, p.x * direction.y + p.y * direction.x);\n}\nvec4 addBurst(vec2 position, vec2 direction)\n{\nvec2 rotatedPosition = rotate(position, direction) * vec2(25.0, 0.75);\nfloat radius = length(rotatedPosition);\nfloat burst = 1.0 - smoothstep(0.0, 0.55, radius);\nreturn vec4(burst);\n}\nvoid main()\n{\nvec2 position = v_textureCoordinates - vec2(0.5);\nfloat radius = length(position);\nfloat surface = step(radius, u_radiusTS);\nvec4 color = vec4(1.0, 1.0, surface + 0.2, surface);\nfloat glow = 1.0 - smoothstep(0.0, 0.55, radius);\ncolor.ba += mix(vec2(0.0), vec2(1.0), glow) * 0.75;\nvec4 burst = vec4(0.0);\nburst += 0.4 * addBurst(position, vec2(0.38942,  0.92106));\nburst += 0.4 * addBurst(position, vec2(0.99235,  0.12348));\nburst += 0.4 * addBurst(position, vec2(0.60327, -0.79754));\nburst += 0.3 * addBurst(position, vec2(0.31457,  0.94924));\nburst += 0.3 * addBurst(position, vec2(0.97931,  0.20239));\nburst += 0.3 * addBurst(position, vec2(0.66507, -0.74678));\ncolor += clamp(burst, vec4(0.0), vec4(1.0)) * 0.15;\ngl_FragColor = clamp(color, vec4(0.0), vec4(1.0));\n}\n"});define("Shaders/SunVS",[],function(){"use strict";return"attribute vec2 direction;\nuniform float u_size;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\nvec4 position;\nif (czm_morphTime == 1.0)\n{\nposition = vec4(czm_sunPositionWC, 1.0);\n}\nelse\n{\nposition = vec4(czm_sunPositionColumbusView.zxy, 1.0);\n}\nvec4 positionEC = czm_view * position;\nvec4 positionWC = czm_eyeToWindowCoordinates(positionEC);\nvec2 halfSize = vec2(u_size * 0.5);\nhalfSize *= ((direction * 2.0) - 1.0);\ngl_Position = czm_viewportOrthographic * vec4(positionWC.xy + halfSize, -positionWC.z, 1.0);\nv_textureCoordinates = direction;\n}\n"});define("Scene/Sun",["../Core/BoundingSphere","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/ComponentDatatype","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/IndexDatatype","../Core/Math","../Core/Matrix4","../Core/PixelFormat","../Core/PrimitiveType","../Renderer/Buffer","../Renderer/BufferUsage","../Renderer/ComputeCommand","../Renderer/DrawCommand","../Renderer/RenderState","../Renderer/ShaderProgram","../Renderer/Texture","../Renderer/VertexArray","../Shaders/SunFS","../Shaders/SunTextureFS","../Shaders/SunVS","./BlendingState","./SceneMode","./SceneTransforms"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w,C,b,S,E,T,x){"use strict";function A(){this.show=true;this._drawCommand=new v({primitiveType:f.TRIANGLES,boundingVolume:new e,owner:this});this._commands={drawCommand:this._drawCommand,computeCommand:undefined};this._boundingVolume=new e;this._boundingVolume2D=new e;this._texture=undefined;this._drawingBufferWidth=undefined;this._drawingBufferHeight=undefined;this._radiusTS=undefined;this._size=undefined;this.glowFactor=1;this._glowFactorDirty=false;var t=this;this._uniformMap={u_texture:function(){return t._texture},u_size:function(){return t._size}}}o(A.prototype,{glowFactor:{get:function(){return this._glowFactor},set:function(e){e=Math.max(e,0);this._glowFactor=e;this._glowFactorDirty=true}}});var P=new t;var D=new t;var M=new i;var I=new i;A.prototype.update=function(i){var o=i._passState;var s=i.frameState;var f=i.context;if(!this.show){return undefined}var v=s.mode;if(v===T.SCENE2D||v===T.MORPHING){return undefined}if(!s.passes.render){return undefined}var A=o.viewport.width;var O=o.viewport.height;if(!a(this._texture)||A!==this._drawingBufferWidth||O!==this._drawingBufferHeight||this._glowFactorDirty){this._texture=this._texture&&this._texture.destroy();this._drawingBufferWidth=A;this._drawingBufferHeight=O;this._glowFactorDirty=false;var R=Math.max(A,O);R=Math.pow(2,Math.ceil(Math.log(R)/Math.log(2))-2);R=Math.max(1,R);this._texture=new y({context:f,width:R,height:R,pixelFormat:d.RGBA});this._glowLengthTS=this._glowFactor*5;this._radiusTS=1/(1+2*this._glowLengthTS)*.5;var N=this;var L={u_glowLengthTS:function(){return N._glowLengthTS},u_radiusTS:function(){return N._radiusTS}};this._commands.computeCommand=new m({fragmentShaderSource:b,outputTexture:this._texture,uniformMap:L,persists:false,owner:this,postExecute:function(){N._commands.computeCommand=undefined}})}var B=this._drawCommand;if(!a(B.vertexArray)){var F={direction:0};var k=new Uint8Array(4*2);k[0]=0;k[1]=0;k[2]=255;k[3]=0;k[4]=255;k[5]=255;k[6]=0;k[7]=255;var V=h.createVertexBuffer({context:f,typedArray:k,usage:p.STATIC_DRAW});var z=[{index:F.direction,vertexBuffer:V,componentsPerAttribute:2,normalize:true,componentDatatype:n.UNSIGNED_BYTE}];var U=h.createIndexBuffer({context:f,typedArray:new Uint16Array([0,1,2,0,2,3]),usage:p.STATIC_DRAW,indexDatatype:u.UNSIGNED_SHORT});B.vertexArray=new w({context:f,attributes:z,indexBuffer:U});B.shaderProgram=g.fromCache({context:f,vertexShaderSource:S,fragmentShaderSource:C,attributeLocations:F});B.renderState=_.fromCache({blending:E.ALPHA_BLEND});B.uniformMap=this._uniformMap}var q=f.uniformState.sunPositionWC;var G=f.uniformState.sunPositionColumbusView;var H=this._boundingVolume;var W=this._boundingVolume2D;r.clone(q,H.center);W.center.x=G.z;W.center.y=G.x;W.center.z=G.y;H.radius=l.SOLAR_RADIUS+l.SOLAR_RADIUS*this._glowLengthTS;W.radius=H.radius;if(v===T.SCENE3D){e.clone(H,B.boundingVolume)}else if(v===T.COLUMBUS_VIEW){e.clone(W,B.boundingVolume)}var j=x.computeActualWgs84Position(s,q,I);var Y=r.magnitude(r.subtract(j,i.camera.position,I));var X=f.uniformState.projection;var Z=M;Z.x=0;Z.y=0;Z.z=-Y;Z.w=1;var K=c.multiplyByVector(X,Z,I);var Q=x.clipToGLWindowCoordinates(o.viewport,K,P);Z.x=l.SOLAR_RADIUS;var J=c.multiplyByVector(X,Z,I)
;var $=x.clipToGLWindowCoordinates(o.viewport,J,D);this._size=Math.ceil(t.magnitude(t.subtract($,Q,I)));this._size=2*this._size*(1+2*this._glowLengthTS);return this._commands};A.prototype.isDestroyed=function(){return false};A.prototype.destroy=function(){var e=this._drawCommand;e.vertexArray=e.vertexArray&&e.vertexArray.destroy();e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy();this._texture=this._texture&&this._texture.destroy();return s(this)};return A});define("Scene/TileBoundingVolume",["../Core/DeveloperError"],function(e){"use strict";function t(){}t.prototype.boundingVolume=undefined;t.prototype.boundingSphere=undefined;t.prototype.createDebugVolume=function(t){e.throwInstantiationError()};t.prototype.distanceToCamera=function(t){e.throwInstantiationError()};t.prototype.intersectPlane=function(t){e.throwInstantiationError()};return t});define("Scene/TileCoordinatesImageryProvider",["../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/Event","../Core/GeographicTilingScheme","../ThirdParty/when"],function(e,t,r,i,n,a,o){"use strict";function s(i){i=t(i,t.EMPTY_OBJECT);this._tilingScheme=r(i.tilingScheme)?i.tilingScheme:new a({ellipsoid:i.ellipsoid});this._color=t(i.color,e.YELLOW);this._errorEvent=new n;this._tileWidth=t(i.tileWidth,256);this._tileHeight=t(i.tileHeight,256);this._readyPromise=o.resolve(true)}i(s.prototype,{proxy:{get:function(){return undefined}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return undefined}},minimumLevel:{get:function(){return undefined}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){return undefined}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return true}},readyPromise:{get:function(){return this._readyPromise}},credit:{get:function(){return undefined}},hasAlphaChannel:{get:function(){return true}}});s.prototype.getTileCredits=function(e,t,r){return undefined};s.prototype.requestImage=function(e,t,r,i){var n=document.createElement("canvas");n.width=256;n.height=256;var a=n.getContext("2d");var o=this._color.toCssColorString();a.strokeStyle=o;a.lineWidth=2;a.strokeRect(1,1,255,255);var s="L"+r+"X"+e+"Y"+t;a.font="bold 25px Arial";a.textAlign="center";a.fillStyle="black";a.fillText(s,127,127);a.fillStyle=o;a.fillText(s,124,124);return n};s.prototype.pickFeatures=function(e,t,r,i,n){return undefined};return s});define("Scene/TileDiscardPolicy",["../Core/DeveloperError"],function(e){"use strict";function t(t){e.throwInstantiationError()}t.prototype.isReady=e.throwInstantiationError;t.prototype.shouldDiscardImage=e.throwInstantiationError;return t});define("Scene/TileState",["../Core/freezeObject"],function(e){"use strict";var t={START:0,LOADING:1,READY:2,UPSAMPLED_ONLY:3};return e(t)});define("Shaders/ViewportQuadFS",[],function(){"use strict";return"varying vec2 v_textureCoordinates;\nvoid main()\n{\nczm_materialInput materialInput;\nmaterialInput.s = v_textureCoordinates.s;\nmaterialInput.st = v_textureCoordinates;\nmaterialInput.str = vec3(v_textureCoordinates, 0.0);\nmaterialInput.normalEC = vec3(0.0, 0.0, -1.0);\nczm_material material = czm_getMaterial(materialInput);\ngl_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n}\n"});define("Scene/ViewportQuad",["../Core/BoundingRectangle","../Core/Color","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Renderer/Pass","../Renderer/RenderState","../Renderer/ShaderSource","../Shaders/ViewportQuadFS","./BlendingState","./Material"],function(e,t,r,i,n,a,o,s,u,l,c){"use strict";function d(i,n){this.show=true;if(!r(i)){i=new e}this.rectangle=e.clone(i);if(!r(n)){n=c.fromType(c.ColorType,{color:new t(1,1,1,1)})}this.material=n;this._material=undefined;this._overlayCommand=undefined;this._rs=undefined}d.prototype.update=function(t){if(!this.show){return}if(!r(this.material)){throw new n("this.material must be defined.")}if(!r(this.rectangle)){throw new n("this.rectangle must be defined.")}var i=this._rs;if(!r(i)||!e.equals(i.viewport,this.rectangle)){this._rs=o.fromCache({blending:l.ALPHA_BLEND,viewport:this.rectangle})}var c=t.passes;if(c.render){var d=t.context;if(this._material!==this.material||!r(this._overlayCommand)){this._material=this.material;if(r(this._overlayCommand)){this._overlayCommand.shaderProgram.destroy()}var f=new s({sources:[this._material.shaderSource,u]});this._overlayCommand=d.createViewportQuadCommand(f,{renderState:this._rs,uniformMap:this._material._uniforms,owner:this});this._overlayCommand.pass=a.OVERLAY}this._material.update(d);this._overlayCommand.uniformMap=this._material._uniforms;t.commandList.push(this._overlayCommand)}};d.prototype.isDestroyed=function(){return false};d.prototype.destroy=function(){if(r(this._overlayCommand)){this._overlayCommand.shaderProgram=this._overlayCommand.shaderProgram&&this._overlayCommand.shaderProgram.destroy()}return i(this)};return d});define("Scene/WebMapServiceImageryProvider",["../Core/combine","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/freezeObject","../Core/GeographicTilingScheme","../Core/objectToQuery","../Core/queryToObject","../Core/WebMercatorTilingScheme","../ThirdParty/Uri","./GetFeatureInfoFormat","./UrlTemplateImageryProvider"],function(e,t,r,i,n,a,o,s,u,l,c,d,f){"use strict";function h(i){i=t(i,t.EMPTY_OBJECT);if(!r(i.url)){throw new n("options.url is required.")}if(!r(i.layers)){throw new n("options.layers is required.")}this._url=i.url;this._layers=i.layers;var a=t(i.getFeatureInfoFormats,h.DefaultGetFeatureInfoFormats);var d=new c(i.url);var m=u(t(d.query,""));var v=e(p(t(i.parameters,t.EMPTY_OBJECT)),h.DefaultParameters);m=e(v,m);var _;var g;_=new c(i.url);g=u(t(_.query,""));var y=e(p(t(i.getFeatureInfoParameters,t.EMPTY_OBJECT)),h.GetFeatureInfoDefaultParameters);g=e(y,g);function w(e,t){if(!r(m[e])){m[e]=t}if(r(g)&&!r(g[e])){g[e]=t}}w("layers",i.layers);if(parseFloat(v.version)>=1.3){w("crs",i.tilingScheme instanceof l?"EPSG:3857":"CRS:84")}else{w("srs",i.tilingScheme instanceof l?"EPSG:3857":"EPSG:4326")}w("bbox","{westProjected},{southProjected},{eastProjected},{northProjected}");w("width","{width}");w("height","{height}");d.query=s(m);var C=d.toString().replace(/%7B/g,"{").replace(/%7D/g,"}");var b;if(r(g)){if(!r(g.query_layers)){g.query_layers=i.layers}if(!r(g.x)){g.x="{i}"}if(!r(g.y)){g.y="{j}"}if(!r(g.info_format)){g.info_format="{format}"}_.query=s(g);b=_.toString().replace(/%7B/g,"{").replace(/%7D/g,"}")}this._tileProvider=new f({url:C,pickFeaturesUrl:b,tilingScheme:t(i.tilingScheme,new o({ellipsoid:i.ellipsoid})),rectangle:i.rectangle,tileWidth:i.tileWidth,tileHeight:i.tileHeight,minimumLevel:i.minimumLevel,maximumLevel:i.maximumLevel,proxy:i.proxy,subdomains:i.subdomains,tileDiscardPolicy:i.tileDiscardPolicy,credit:i.credit,getFeatureInfoFormats:a,enablePickFeatures:i.enablePickFeatures})}i(h.prototype,{url:{get:function(){return this._url}},proxy:{get:function(){return this._tileProvider.proxy}},layers:{get:function(){return this._layers}},tileWidth:{get:function(){return this._tileProvider.tileWidth}},tileHeight:{get:function(){return this._tileProvider.tileHeight}},maximumLevel:{get:function(){return this._tileProvider.maximumLevel}},minimumLevel:{get:function(){return this._tileProvider.minimumLevel}},tilingScheme:{get:function(){return this._tileProvider.tilingScheme}},rectangle:{get:function(){return this._tileProvider.rectangle}},tileDiscardPolicy:{get:function(){return this._tileProvider.tileDiscardPolicy}},errorEvent:{get:function(){return this._tileProvider.errorEvent}},ready:{get:function(){return this._tileProvider.ready}},readyPromise:{get:function(){return this._tileProvider.readyPromise}},credit:{get:function(){return this._tileProvider.credit}},hasAlphaChannel:{get:function(){return this._tileProvider.hasAlphaChannel}},enablePickFeatures:{get:function(){return this._tileProvider.enablePickFeatures},set:function(e){this._tileProvider.enablePickFeatures=e}}});h.prototype.getTileCredits=function(e,t,r){return this._tileProvider.getTileCredits(e,t,r)};h.prototype.requestImage=function(e,t,r,i){return this._tileProvider.requestImage(e,t,r,i)};h.prototype.pickFeatures=function(e,t,r,i,n){return this._tileProvider.pickFeatures(e,t,r,i,n)};h.DefaultParameters=a({service:"WMS",version:"1.1.1",request:"GetMap",styles:"",format:"image/jpeg"});h.GetFeatureInfoDefaultParameters=a({service:"WMS",version:"1.1.1",request:"GetFeatureInfo"});h.DefaultGetFeatureInfoFormats=a([a(new d("json","application/json")),a(new d("xml","text/xml")),a(new d("text","text/html"))]);function p(e){var t={};for(var r in e){if(e.hasOwnProperty(r)){t[r.toLowerCase()]=e[r]}}return t}return h});define("Scene/WebMapTileServiceImageryProvider",["../Core/combine","../Core/Credit","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/freezeObject","../Core/isArray","../Core/objectToQuery","../Core/queryToObject","../Core/Rectangle","../Core/WebMercatorTilingScheme","../ThirdParty/Uri","../ThirdParty/when","./ImageryProvider"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m){"use strict";function v(e){e=r(e,r.EMPTY_OBJECT);if(!i(e.url)){throw new a("options.url is required.")}if(!i(e.layer)){throw new a("options.layer is required.")}if(!i(e.style)){throw new a("options.style is required.")}if(!i(e.tileMatrixSetID)){throw new a("options.tileMatrixSetID is required.")}this._url=e.url;this._layer=e.layer;this._style=e.style;this._tileMatrixSetID=e.tileMatrixSetID;this._tileMatrixLabels=e.tileMatrixLabels;this._format=r(e.format,"image/jpeg");this._proxy=e.proxy;this._tileDiscardPolicy=e.tileDiscardPolicy;this._tilingScheme=i(e.tilingScheme)?e.tilingScheme:new f({ellipsoid:e.ellipsoid});this._tileWidth=r(e.tileWidth,256);this._tileHeight=r(e.tileHeight,256);this._minimumLevel=r(e.minimumLevel,0);this._maximumLevel=e.maximumLevel;this._rectangle=r(e.rectangle,this._tilingScheme.rectangle);this._readyPromise=p.resolve(true);var n=this._tilingScheme.positionToTileXY(d.southwest(this._rectangle),this._minimumLevel);var s=this._tilingScheme.positionToTileXY(d.northeast(this._rectangle),this._minimumLevel);var l=(Math.abs(s.x-n.x)+1)*(Math.abs(s.y-n.y)+1);if(l>4){throw new a("The imagery provider's rectangle and minimumLevel indicate that there are "+l+" tiles at the minimum level. Imagery providers with more than four tiles at the minimum level are not supported.")}this._errorEvent=new o;var c=e.credit;this._credit=typeof c==="string"?new t(c):c;this._subdomains=e.subdomains;if(u(this._subdomains)){this._subdomains=this._subdomains.slice()}else if(i(this._subdomains)&&this._subdomains.length>0){this._subdomains=this._subdomains.split("")}else{this._subdomains=["a","b","c"]}}var _=s({service:"WMTS",version:"1.0.0",request:"GetTile"});function g(t,n,a,o){var s=t._tileMatrixLabels;var u=i(s)?s[o]:o.toString();var d=t._subdomains;var f;if(t._url.indexOf("{")>=0){f=t._url.replace("{style}",t._style).replace("{Style}",t._style).replace("{TileMatrixSet}",t._tileMatrixSetID).replace("{TileMatrix}",u).replace("{TileRow}",a.toString()).replace("{TileCol}",n.toString()).replace("{s}",d[(n+a+o)%d.length])}else{var p=new h(t._url);var m=c(r(p.query,""));m=e(_,m);m.tilematrix=u;m.layer=t._layer;m.style=t._style;m.tilerow=a;m.tilecol=n;m.tilematrixset=t._tileMatrixSetID;m.format=t._format;p.query=l(m);f=p.toString()}var v=t._proxy;if(i(v)){f=v.getURL(f)}return f}n(v.prototype,{url:{get:function(){return this._url}},proxy:{get:function(){return this._proxy}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return this._maximumLevel}},minimumLevel:{get:function(){return this._minimumLevel}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._rectangle}},tileDiscardPolicy:{get:function(){return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},format:{get:function(){return this._format}},ready:{value:true},readyPromise:{get:function(){return this._readyPromise}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return true}}});v.prototype.getTileCredits=function(e,t,r){return undefined};v.prototype.requestImage=function(e,t,r,i){var n=g(this,e,t,r);return m.loadImage(this,n,i)};v.prototype.pickFeatures=function(e,t,r,i,n){return undefined};return v});define("ThirdParty/crunch",[],function(){var Module;if(!Module)Module=(typeof Module!=="undefined"?Module:null)||{};var moduleOverrides={};for(var key in Module){if(Module.hasOwnProperty(key)){moduleOverrides[key]=Module[key]}}var ENVIRONMENT_IS_WEB=typeof window==="object";var ENVIRONMENT_IS_WORKER=typeof importScripts==="function";var ENVIRONMENT_IS_NODE=typeof process==="object"&&typeof require==="function"&&!ENVIRONMENT_IS_WEB&&!ENVIRONMENT_IS_WORKER;var ENVIRONMENT_IS_SHELL=!ENVIRONMENT_IS_WEB&&!ENVIRONMENT_IS_NODE&&!ENVIRONMENT_IS_WORKER;if(ENVIRONMENT_IS_NODE){if(!Module["print"])Module["print"]=function e(t){process["stdout"].write(t+"\n")};if(!Module["printErr"])Module["printErr"]=function e(t){process["stderr"].write(t+"\n")};var nodeFS=require("fs");var nodePath=require("path");Module["read"]=function e(t,r){t=nodePath["normalize"](t);var i=nodeFS["readFileSync"](t);if(!i&&t!=nodePath["resolve"](t)){t=path.join(__dirname,"..","src",t);i=nodeFS["readFileSync"](t)}if(i&&!r)i=i.toString();return i};Module["readBinary"]=function e(t){var r=Module["read"](t,true);if(!r.buffer){r=new Uint8Array(r)}assert(r.buffer);return r};Module["load"]=function e(t){globalEval(read(t))};if(!Module["thisProgram"]){if(process["argv"].length>1){Module["thisProgram"]=process["argv"][1].replace(/\\/g,"/")}else{Module["thisProgram"]="unknown-program"}}Module["arguments"]=process["argv"].slice(2);if(typeof module!=="undefined"){module["exports"]=Module}process["on"]("uncaughtException",function(e){if(!(e instanceof ExitStatus)){throw e}});Module["inspect"]=function(){return"[Emscripten Module object]"}}else if(ENVIRONMENT_IS_SHELL){if(!Module["print"])Module["print"]=print;if(typeof printErr!="undefined")Module["printErr"]=printErr;if(typeof read!="undefined"){Module["read"]=read}else{Module["read"]=function e(){throw"no read() available (jsc?)"}}Module["readBinary"]=function e(t){if(typeof readbuffer==="function"){return new Uint8Array(readbuffer(t))}var r=read(t,"binary");assert(typeof r==="object");return r};if(typeof scriptArgs!="undefined"){Module["arguments"]=scriptArgs}else if(typeof arguments!="undefined"){Module["arguments"]=arguments}}else if(ENVIRONMENT_IS_WEB||ENVIRONMENT_IS_WORKER){Module["read"]=function e(t){var r=new XMLHttpRequest;r.open("GET",t,false);r.send(null);return r.responseText};if(typeof arguments!="undefined"){Module["arguments"]=arguments}if(typeof console!=="undefined"){if(!Module["print"])Module["print"]=function e(t){console.log(t)};if(!Module["printErr"])Module["printErr"]=function e(t){console.log(t)}}else{var TRY_USE_DUMP=false;if(!Module["print"])Module["print"]=TRY_USE_DUMP&&typeof dump!=="undefined"?function(e){dump(e)}:function(e){}}if(ENVIRONMENT_IS_WORKER){Module["load"]=importScripts}if(typeof Module["setWindowTitle"]==="undefined"){Module["setWindowTitle"]=function(e){document.title=e}}}else{throw"Unknown runtime environment. Where are we?"}function globalEval(e){eval.call(null,e)}if(!Module["load"]&&Module["read"]){Module["load"]=function e(t){globalEval(Module["read"](t))}}if(!Module["print"]){Module["print"]=function(){}}if(!Module["printErr"]){Module["printErr"]=Module["print"]}if(!Module["arguments"]){Module["arguments"]=[]}if(!Module["thisProgram"]){Module["thisProgram"]="./this.program"}Module.print=Module["print"];Module.printErr=Module["printErr"];Module["preRun"]=[];Module["postRun"]=[];for(var key in moduleOverrides){if(moduleOverrides.hasOwnProperty(key)){Module[key]=moduleOverrides[key]}}var Runtime={setTempRet0:function(e){tempRet0=e},getTempRet0:function(){return tempRet0},stackSave:function(){return STACKTOP},stackRestore:function(e){STACKTOP=e},getNativeTypeSize:function(e){switch(e){case"i1":case"i8":return 1;case"i16":return 2;case"i32":return 4;case"i64":return 8;case"float":return 4;case"double":return 8;default:{if(e[e.length-1]==="*"){return Runtime.QUANTUM_SIZE}else if(e[0]==="i"){var t=parseInt(e.substr(1));assert(t%8===0);return t/8}else{return 0}}}},getNativeFieldSize:function(e){return Math.max(Runtime.getNativeTypeSize(e),Runtime.QUANTUM_SIZE)},STACK_ALIGN:16,prepVararg:function(e,t){if(t==="double"||t==="i64"){if(e&7){assert((e&7)===4);e+=4}}else{assert((e&3)===0)}return e},getAlignSize:function(e,t,r){if(!r&&(e=="i64"||e=="double"))return 8;if(!e)return Math.min(t,8);return Math.min(t||(e?Runtime.getNativeFieldSize(e):0),Runtime.QUANTUM_SIZE)},dynCall:function(e,t,r){if(r&&r.length){if(!r.splice)r=Array.prototype.slice.call(r);r.splice(0,0,t);return Module["dynCall_"+e].apply(null,r)}else{return Module["dynCall_"+e].call(null,t)}},functionPointers:[],addFunction:function(e){for(var t=0;t<Runtime.functionPointers.length;t++){if(!Runtime.functionPointers[t]){Runtime.functionPointers[t]=e;return 2*(1+t)}}throw"Finished up all reserved function pointers. Use a higher value for RESERVED_FUNCTION_POINTERS."},removeFunction:function(e){Runtime.functionPointers[(e-2)/2]=null},warnOnce:function(e){if(!Runtime.warnOnce.shown)Runtime.warnOnce.shown={};if(!Runtime.warnOnce.shown[e]){Runtime.warnOnce.shown[e]=1;Module.printErr(e)}},funcWrappers:{},getFuncWrapper:function(e,t){assert(t);if(!Runtime.funcWrappers[t]){Runtime.funcWrappers[t]={}}var r=Runtime.funcWrappers[t];if(!r[e]){r[e]=function r(){return Runtime.dynCall(t,e,arguments)}}return r[e]},getCompilerSetting:function(e){throw"You must build with -s RETAIN_COMPILER_SETTINGS=1 for Runtime.getCompilerSetting or emscripten_get_compiler_setting to work"},stackAlloc:function(e){var t=STACKTOP;STACKTOP=STACKTOP+e|0;STACKTOP=STACKTOP+15&-16;return t},staticAlloc:function(e){var t=STATICTOP;STATICTOP=STATICTOP+e|0;STATICTOP=STATICTOP+15&-16;return t},dynamicAlloc:function(e){var t=DYNAMICTOP;DYNAMICTOP=DYNAMICTOP+e|0;DYNAMICTOP=DYNAMICTOP+15&-16;if(DYNAMICTOP>=TOTAL_MEMORY){var r=enlargeMemory();if(!r){DYNAMICTOP=t;return 0}}return t},alignMemory:function(e,t){var r=e=Math.ceil(e/(t?t:16))*(t?t:16);return r},makeBigInt:function(e,t,r){var i=r?+(e>>>0)+ +(t>>>0)*+4294967296:+(e>>>0)+ +(t|0)*+4294967296;return i},GLOBAL_BASE:8,QUANTUM_SIZE:4,__dummy__:0};Module["Runtime"]=Runtime;var __THREW__=0;var ABORT=false;var EXITSTATUS=0;var undef=0;var tempValue,tempInt,tempBigInt,tempInt2,tempBigInt2,tempPair,tempBigIntI,tempBigIntR,tempBigIntS,tempBigIntP,tempBigIntD,tempDouble,tempFloat;var tempI64,tempI64b;var tempRet0,tempRet1,tempRet2,tempRet3,tempRet4,tempRet5,tempRet6,tempRet7,tempRet8,tempRet9;function assert(e,t){if(!e){abort("Assertion failed: "+t)}}var globalScope=this;function getCFunc(ident){var func=Module["_"+ident];if(!func){try{func=eval("_"+ident)}catch(e){}}assert(func,"Cannot call unknown function "+ident+" (perhaps LLVM optimizations or closure removed it?)");return func}var cwrap,ccall;(function(){var JSfuncs={stackSave:function(){Runtime.stackSave()},stackRestore:function(){Runtime.stackRestore()},arrayToC:function(e){var t=Runtime.stackAlloc(e.length);writeArrayToMemory(e,t);return t},stringToC:function(e){var t=0;if(e!==null&&e!==undefined&&e!==0){t=Runtime.stackAlloc((e.length<<2)+1);writeStringToMemory(e,t)}return t}};var toC={string:JSfuncs["stringToC"],array:JSfuncs["arrayToC"]};ccall=function e(t,r,i,n,a){var o=getCFunc(t);var s=[];var u=0;if(n){for(var l=0;l<n.length;l++){var c=toC[i[l]];if(c){if(u===0)u=Runtime.stackSave();s[l]=c(n[l])}else{s[l]=n[l]}}}var d=o.apply(null,s);if(r==="string")d=Pointer_stringify(d);if(u!==0){if(a&&a.async){EmterpreterAsync.asyncFinalizers.push(function(){Runtime.stackRestore(u)});return}Runtime.stackRestore(u)}return d};var sourceRegex=/^function\s*\(([^)]*)\)\s*{\s*([^*]*?)[\s;]*(?:return\s*(.*?)[;\s]*)?}$/;function parseJSFunc(e){var t=e.toString().match(sourceRegex).slice(1);return{arguments:t[0],body:t[1],returnValue:t[2]}}var JSsource={};for(var fun in JSfuncs){if(JSfuncs.hasOwnProperty(fun)){JSsource[fun]=parseJSFunc(JSfuncs[fun])}}cwrap=function cwrap(ident,returnType,argTypes){argTypes=argTypes||[];var cfunc=getCFunc(ident);var numericArgs=argTypes.every(function(e){return e==="number"});var numericRet=returnType!=="string";if(numericRet&&numericArgs){return cfunc}var argNames=argTypes.map(function(e,t){return"$"+t});var funcstr="(function("+argNames.join(",")+") {";var nargs=argTypes.length;if(!numericArgs){funcstr+="var stack = "+JSsource["stackSave"].body+";";for(var i=0;i<nargs;i++){var arg=argNames[i],type=argTypes[i];if(type==="number")continue;var convertCode=JSsource[type+"ToC"];funcstr+="var "+convertCode.arguments+" = "+arg+";";funcstr+=convertCode.body+";";funcstr+=arg+"="+convertCode.returnValue+";"}}var cfuncname=parseJSFunc(function(){return cfunc}).returnValue;funcstr+="var ret = "+cfuncname+"("+argNames.join(",")+");";if(!numericRet){var strgfy=parseJSFunc(function(){return Pointer_stringify}).returnValue;funcstr+="ret = "+strgfy+"(ret);"}if(!numericArgs){funcstr+=JSsource["stackRestore"].body.replace("()","(stack)")+";"}funcstr+="return ret})";return eval(funcstr)}})();Module["ccall"]=ccall;Module["cwrap"]=cwrap;function setValue(e,t,r,i){r=r||"i8";if(r.charAt(r.length-1)==="*")r="i32";switch(r){case"i1":HEAP8[e>>0]=t;break;case"i8":HEAP8[e>>0]=t;break;case"i16":HEAP16[e>>1]=t;break;case"i32":HEAP32[e>>2]=t;break;case"i64":tempI64=[t>>>0,(tempDouble=t,+Math_abs(tempDouble)>=+1?tempDouble>+0?(Math_min(+Math_floor(tempDouble/+4294967296),+4294967295)|0)>>>0:~~+Math_ceil((tempDouble-+(~~tempDouble>>>0))/+4294967296)>>>0:0)],HEAP32[e>>2]=tempI64[0],HEAP32[e+4>>2]=tempI64[1];break;case"float":HEAPF32[e>>2]=t;break;case"double":HEAPF64[e>>3]=t;break;default:abort("invalid type for setValue: "+r)}}Module["setValue"]=setValue;function getValue(e,t,r){t=t||"i8";if(t.charAt(t.length-1)==="*")t="i32";switch(t){case"i1":return HEAP8[e>>0];case"i8":return HEAP8[e>>0];case"i16":return HEAP16[e>>1];case"i32":return HEAP32[e>>2];case"i64":return HEAP32[e>>2];case"float":return HEAPF32[e>>2];case"double":return HEAPF64[e>>3];default:abort("invalid type for setValue: "+t)}return null}Module["getValue"]=getValue;var ALLOC_NORMAL=0;var ALLOC_STACK=1;var ALLOC_STATIC=2;var ALLOC_DYNAMIC=3;var ALLOC_NONE=4;Module["ALLOC_NORMAL"]=ALLOC_NORMAL;Module["ALLOC_STACK"]=ALLOC_STACK;Module["ALLOC_STATIC"]=ALLOC_STATIC;Module["ALLOC_DYNAMIC"]=ALLOC_DYNAMIC;Module["ALLOC_NONE"]=ALLOC_NONE;function allocate(e,t,r,i){var n,a;if(typeof e==="number"){n=true;a=e}else{n=false;a=e.length}var o=typeof t==="string"?t:null;var s;if(r==ALLOC_NONE){s=i}else{s=[_malloc,Runtime.stackAlloc,Runtime.staticAlloc,Runtime.dynamicAlloc][r===undefined?ALLOC_STATIC:r](Math.max(a,o?1:t.length))}if(n){var i=s,u;assert((s&3)==0);u=s+(a&~3);for(;i<u;i+=4){HEAP32[i>>2]=0}u=s+a;while(i<u){HEAP8[i++>>0]=0}return s}if(o==="i8"){if(e.subarray||e.slice){HEAPU8.set(e,s)}else{HEAPU8.set(new Uint8Array(e),s)}return s}var l=0,c,d,f;while(l<a){var h=e[l];if(typeof h==="function"){h=Runtime.getFunctionIndex(h)}c=o||t[l];if(c===0){l++;continue}if(c=="i64")c="i32";setValue(s+l,h,c);if(f!==c){d=Runtime.getNativeTypeSize(c);f=c}l+=d}return s}Module["allocate"]=allocate;function getMemory(e){if(!staticSealed)return Runtime.staticAlloc(e);if(typeof _sbrk!=="undefined"&&!_sbrk.called||!runtimeInitialized)return Runtime.dynamicAlloc(e);return _malloc(e)}Module["getMemory"]=getMemory;function Pointer_stringify(e,t){if(t===0||!e)return"";var r=0;var i;var n=0;while(1){i=HEAPU8[e+n>>0];r|=i;if(i==0&&!t)break;n++;if(t&&n==t)break}if(!t)t=n;var a="";if(r<128){var o=1024;var s;while(t>0){s=String.fromCharCode.apply(String,HEAPU8.subarray(e,e+Math.min(t,o)));a=a?a+s:s;e+=o;t-=o}return a}return Module["UTF8ToString"](e)}Module["Pointer_stringify"]=Pointer_stringify;function AsciiToString(e){var t="";while(1){var r=HEAP8[e++>>0];if(!r)return t;t+=String.fromCharCode(r)}}Module["AsciiToString"]=AsciiToString;function stringToAscii(e,t){return writeAsciiToMemory(e,t,false)}Module["stringToAscii"]=stringToAscii;function UTF8ArrayToString(e,t){var r,i,n,a,o,s;var u="";while(1){r=e[t++];if(!r)return u;if(!(r&128)){u+=String.fromCharCode(r);continue}i=e[t++]&63;if((r&224)==192){u+=String.fromCharCode((r&31)<<6|i);continue}n=e[t++]&63;if((r&240)==224){r=(r&15)<<12|i<<6|n}else{a=e[t++]&63;if((r&248)==240){r=(r&7)<<18|i<<12|n<<6|a}else{o=e[t++]&63;if((r&252)==248){r=(r&3)<<24|i<<18|n<<12|a<<6|o}else{s=e[t++]&63;r=(r&1)<<30|i<<24|n<<18|a<<12|o<<6|s}}}if(r<65536){u+=String.fromCharCode(r)}else{var l=r-65536;u+=String.fromCharCode(55296|l>>10,56320|l&1023)}}}Module["UTF8ArrayToString"]=UTF8ArrayToString;function UTF8ToString(e){return UTF8ArrayToString(HEAPU8,e)}Module["UTF8ToString"]=UTF8ToString;function stringToUTF8Array(e,t,r,i){if(!(i>0))return 0;var n=r;var a=r+i-1;for(var o=0;o<e.length;++o){var s=e.charCodeAt(o);if(s>=55296&&s<=57343)s=65536+((s&1023)<<10)|e.charCodeAt(++o)&1023;if(s<=127){if(r>=a)break;t[r++]=s}else if(s<=2047){if(r+1>=a)break;t[r++]=192|s>>6;t[r++]=128|s&63}else if(s<=65535){if(r+2>=a)break;t[r++]=224|s>>12;t[r++]=128|s>>6&63;t[r++]=128|s&63}else if(s<=2097151){if(r+3>=a)break;t[r++]=240|s>>18;t[r++]=128|s>>12&63;t[r++]=128|s>>6&63;t[r++]=128|s&63}else if(s<=67108863){if(r+4>=a)break;t[r++]=248|s>>24;t[r++]=128|s>>18&63;t[r++]=128|s>>12&63;t[r++]=128|s>>6&63;t[r++]=128|s&63}else{if(r+5>=a)break;t[r++]=252|s>>30;t[r++]=128|s>>24&63;t[r++]=128|s>>18&63;t[r++]=128|s>>12&63;t[r++]=128|s>>6&63;t[r++]=128|s&63}}t[r]=0;return r-n}Module["stringToUTF8Array"]=stringToUTF8Array;function stringToUTF8(e,t,r){return stringToUTF8Array(e,HEAPU8,t,r)}Module["stringToUTF8"]=stringToUTF8;function lengthBytesUTF8(e){var t=0;for(var r=0;r<e.length;++r){var i=e.charCodeAt(r);if(i>=55296&&i<=57343)i=65536+((i&1023)<<10)|e.charCodeAt(++r)&1023;if(i<=127){++t}else if(i<=2047){t+=2}else if(i<=65535){t+=3}else if(i<=2097151){t+=4}else if(i<=67108863){t+=5}else{t+=6}}return t}Module["lengthBytesUTF8"]=lengthBytesUTF8;function UTF16ToString(e){var t=0;var r="";while(1){var i=HEAP16[e+t*2>>1];if(i==0)return r;++t;r+=String.fromCharCode(i)}}Module["UTF16ToString"]=UTF16ToString;function stringToUTF16(e,t,r){if(r===undefined){r=2147483647}if(r<2)return 0;r-=2;var i=t;var n=r<e.length*2?r/2:e.length;for(var a=0;a<n;++a){var o=e.charCodeAt(a);HEAP16[t>>1]=o;t+=2}HEAP16[t>>1]=0;return t-i}Module["stringToUTF16"]=stringToUTF16;function lengthBytesUTF16(e){return e.length*2}Module["lengthBytesUTF16"]=lengthBytesUTF16;function UTF32ToString(e){var t=0;var r="";while(1){var i=HEAP32[e+t*4>>2];if(i==0)return r;++t;if(i>=65536){var n=i-65536;r+=String.fromCharCode(55296|n>>10,56320|n&1023)}else{r+=String.fromCharCode(i)}}}Module["UTF32ToString"]=UTF32ToString;function stringToUTF32(e,t,r){if(r===undefined){r=2147483647}if(r<4)return 0;var i=t;var n=i+r-4;for(var a=0;a<e.length;++a){var o=e.charCodeAt(a);if(o>=55296&&o<=57343){var s=e.charCodeAt(++a);o=65536+((o&1023)<<10)|s&1023}HEAP32[t>>2]=o;t+=4;if(t+4>n)break}HEAP32[t>>2]=0;return t-i}Module["stringToUTF32"]=stringToUTF32;function lengthBytesUTF32(e){var t=0;for(var r=0;r<e.length;++r){var i=e.charCodeAt(r);if(i>=55296&&i<=57343)++r;t+=4}return t}Module["lengthBytesUTF32"]=lengthBytesUTF32;function demangle(e){var t=!!Module["___cxa_demangle"];if(t){try{var r=_malloc(e.length);writeStringToMemory(e.substr(1),r);var i=_malloc(4);var n=Module["___cxa_demangle"](r,0,0,i);if(getValue(i,"i32")===0&&n){return Pointer_stringify(n)}}catch(e){}finally{if(r)_free(r);if(i)_free(i);if(n)_free(n)}}var a=3;var o={v:"void",b:"bool",c:"char",s:"short",i:"int",l:"long",f:"float",d:"double",w:"wchar_t",a:"signed char",h:"unsigned char",t:"unsigned short",j:"unsigned int",m:"unsigned long",x:"long long",y:"unsigned long long",z:"..."};var s=[];var u=true;function l(t){if(t)Module.print(t);Module.print(e);var r="";for(var i=0;i<a;i++)r+=" ";Module.print(r+"^")}function c(){a++;if(e[a]==="K")a++;var t=[];while(e[a]!=="E"){if(e[a]==="S"){a++;var r=e.indexOf("_",a);var i=e.substring(a,r)||0;t.push(s[i]||"?");a=r+1;continue}if(e[a]==="C"){t.push(t[t.length-1]);a+=2;continue}var n=parseInt(e.substr(a));var o=n.toString().length;if(!n||!o){a--;break}var u=e.substr(a+o,n);t.push(u);s.push(u);a+=o+n}a++;return t}function d(t,r,i){r=r||Infinity;var n="",s=[];function l(){return"("+s.join(", ")+")"}var f;if(e[a]==="N"){f=c().join("::");r--;if(r===0)return t?[f]:f}else{if(e[a]==="K"||u&&e[a]==="L")a++;var h=parseInt(e.substr(a));if(h){var p=h.toString().length;f=e.substr(a+p,h);a+=p+h}}u=false;if(e[a]==="I"){a++;var m=d(true);var v=d(true,1,true);n+=v[0]+" "+f+"<"+m.join(", ")+">"}else{n=f}e:while(a<e.length&&r-- >0){var _=e[a++];if(_ in o){s.push(o[_])}else{switch(_){case"P":s.push(d(true,1,true)[0]+"*");break;case"R":s.push(d(true,1,true)[0]+"&");break;case"L":{a++;var g=e.indexOf("E",a);var h=g-a;s.push(e.substr(a,h));a+=h+2;break};case"A":{var h=parseInt(e.substr(a));a+=h.toString().length;if(e[a]!=="_")throw"?";a++;s.push(d(true,1,true)[0]+" ["+h+"]");break};case"E":break e;default:n+="?"+_;break e}}}if(!i&&s.length===1&&s[0]==="void")s=[];if(t){if(n){s.push(n+"?")}return s}else{return n+l()}}var f=e;try{if(e=="Object._main"||e=="_main"){return"main()"}if(typeof e==="number")e=Pointer_stringify(e);if(e[0]!=="_")return e;if(e[1]!=="_")return e;if(e[2]!=="Z")return e;switch(e[3]){case"n":return"operator new()";case"d":return"operator delete()"}f=d()}catch(e){f+="?"}if(f.indexOf("?")>=0&&!t){Runtime.warnOnce("warning: a problem occurred in builtin C++ name demangling; build with  -s DEMANGLE_SUPPORT=1  to link in libcxxabi demangling")}return f}function demangleAll(e){return e.replace(/__Z[\w\d_]+/g,function(e){var t=demangle(e);return e===t?e:e+" ["+t+"]"})}function jsStackTrace(){var e=new Error;if(!e.stack){try{throw new Error(0)}catch(t){e=t}if(!e.stack){return"(no stack trace available)"}}return e.stack.toString()}function stackTrace(){return demangleAll(jsStackTrace())}Module["stackTrace"]=stackTrace;var PAGE_SIZE=4096;function alignMemoryPage(e){if(e%4096>0){e+=4096-e%4096}return e}var HEAP;var HEAP8,HEAPU8,HEAP16,HEAPU16,HEAP32,HEAPU32,HEAPF32,HEAPF64;var STATIC_BASE=0,STATICTOP=0,staticSealed=false;var STACK_BASE=0,STACKTOP=0,STACK_MAX=0;var DYNAMIC_BASE=0,DYNAMICTOP=0;function enlargeMemory(){var e=TOTAL_MEMORY;var t=Math.pow(2,31);if(DYNAMICTOP>=t)return false;while(TOTAL_MEMORY<=DYNAMICTOP){if(TOTAL_MEMORY<t/2){TOTAL_MEMORY=alignMemoryPage(2*TOTAL_MEMORY)}else{var r=TOTAL_MEMORY;TOTAL_MEMORY=alignMemoryPage((3*TOTAL_MEMORY+t)/4);if(TOTAL_MEMORY<=r)return false}}TOTAL_MEMORY=Math.max(TOTAL_MEMORY,16*1024*1024);if(TOTAL_MEMORY>=t)return false;try{if(ArrayBuffer.transfer){buffer=ArrayBuffer.transfer(buffer,TOTAL_MEMORY)}else{var i=HEAP8;buffer=new ArrayBuffer(TOTAL_MEMORY)}}catch(e){return false}var n=_emscripten_replace_memory(buffer);if(!n)return false;Module["buffer"]=buffer;Module["HEAP8"]=HEAP8=new Int8Array(buffer);Module["HEAP16"]=HEAP16=new Int16Array(buffer);Module["HEAP32"]=HEAP32=new Int32Array(buffer);Module["HEAPU8"]=HEAPU8=new Uint8Array(buffer);Module["HEAPU16"]=HEAPU16=new Uint16Array(buffer);Module["HEAPU32"]=HEAPU32=new Uint32Array(buffer);Module["HEAPF32"]=HEAPF32=new Float32Array(buffer);Module["HEAPF64"]=HEAPF64=new Float64Array(buffer);if(!ArrayBuffer.transfer){HEAP8.set(i)}return true}var byteLength;try{byteLength=Function.prototype.call.bind(Object.getOwnPropertyDescriptor(ArrayBuffer.prototype,"byteLength").get);byteLength(new ArrayBuffer(4))}catch(e){byteLength=function(e){return e.byteLength}}var TOTAL_STACK=Module["TOTAL_STACK"]||5242880
;var TOTAL_MEMORY=Module["TOTAL_MEMORY"]||16777216;var totalMemory=64*1024;while(totalMemory<TOTAL_MEMORY||totalMemory<2*TOTAL_STACK){if(totalMemory<16*1024*1024){totalMemory*=2}else{totalMemory+=16*1024*1024}}totalMemory=Math.max(totalMemory,16*1024*1024);if(totalMemory!==TOTAL_MEMORY){TOTAL_MEMORY=totalMemory}assert(typeof Int32Array!=="undefined"&&typeof Float64Array!=="undefined"&&!!new Int32Array(1)["subarray"]&&!!new Int32Array(1)["set"],"JS engine does not provide full typed array support");var buffer;buffer=new ArrayBuffer(TOTAL_MEMORY);HEAP8=new Int8Array(buffer);HEAP16=new Int16Array(buffer);HEAP32=new Int32Array(buffer);HEAPU8=new Uint8Array(buffer);HEAPU16=new Uint16Array(buffer);HEAPU32=new Uint32Array(buffer);HEAPF32=new Float32Array(buffer);HEAPF64=new Float64Array(buffer);HEAP32[0]=255;assert(HEAPU8[0]===255&&HEAPU8[3]===0,"Typed arrays 2 must be run on a little-endian system");Module["HEAP"]=HEAP;Module["buffer"]=buffer;Module["HEAP8"]=HEAP8;Module["HEAP16"]=HEAP16;Module["HEAP32"]=HEAP32;Module["HEAPU8"]=HEAPU8;Module["HEAPU16"]=HEAPU16;Module["HEAPU32"]=HEAPU32;Module["HEAPF32"]=HEAPF32;Module["HEAPF64"]=HEAPF64;function callRuntimeCallbacks(e){while(e.length>0){var t=e.shift();if(typeof t=="function"){t();continue}var r=t.func;if(typeof r==="number"){if(t.arg===undefined){Runtime.dynCall("v",r)}else{Runtime.dynCall("vi",r,[t.arg])}}else{r(t.arg===undefined?null:t.arg)}}}var __ATPRERUN__=[];var __ATINIT__=[];var __ATMAIN__=[];var __ATEXIT__=[];var __ATPOSTRUN__=[];var runtimeInitialized=false;var runtimeExited=false;function preRun(){if(Module["preRun"]){if(typeof Module["preRun"]=="function")Module["preRun"]=[Module["preRun"]];while(Module["preRun"].length){addOnPreRun(Module["preRun"].shift())}}callRuntimeCallbacks(__ATPRERUN__)}function ensureInitRuntime(){if(runtimeInitialized)return;runtimeInitialized=true;callRuntimeCallbacks(__ATINIT__)}function preMain(){callRuntimeCallbacks(__ATMAIN__)}function exitRuntime(){callRuntimeCallbacks(__ATEXIT__);runtimeExited=true}function postRun(){if(Module["postRun"]){if(typeof Module["postRun"]=="function")Module["postRun"]=[Module["postRun"]];while(Module["postRun"].length){addOnPostRun(Module["postRun"].shift())}}callRuntimeCallbacks(__ATPOSTRUN__)}function addOnPreRun(e){__ATPRERUN__.unshift(e)}Module["addOnPreRun"]=addOnPreRun;function addOnInit(e){__ATINIT__.unshift(e)}Module["addOnInit"]=addOnInit;function addOnPreMain(e){__ATMAIN__.unshift(e)}Module["addOnPreMain"]=addOnPreMain;function addOnExit(e){__ATEXIT__.unshift(e)}Module["addOnExit"]=addOnExit;function addOnPostRun(e){__ATPOSTRUN__.unshift(e)}Module["addOnPostRun"]=addOnPostRun;function intArrayFromString(e,t,r){var i=r>0?r:lengthBytesUTF8(e)+1;var n=new Array(i);var a=stringToUTF8Array(e,n,0,n.length);if(t)n.length=a;return n}Module["intArrayFromString"]=intArrayFromString;function intArrayToString(e){var t=[];for(var r=0;r<e.length;r++){var i=e[r];if(i>255){i&=255}t.push(String.fromCharCode(i))}return t.join("")}Module["intArrayToString"]=intArrayToString;function writeStringToMemory(e,t,r){var i=intArrayFromString(e,r);var n=0;while(n<i.length){var a=i[n];HEAP8[t+n>>0]=a;n=n+1}}Module["writeStringToMemory"]=writeStringToMemory;function writeArrayToMemory(e,t){for(var r=0;r<e.length;r++){HEAP8[t++>>0]=e[r]}}Module["writeArrayToMemory"]=writeArrayToMemory;function writeAsciiToMemory(e,t,r){for(var i=0;i<e.length;++i){HEAP8[t++>>0]=e.charCodeAt(i)}if(!r)HEAP8[t>>0]=0}Module["writeAsciiToMemory"]=writeAsciiToMemory;function unSign(e,t,r){if(e>=0){return e}return t<=32?2*Math.abs(1<<t-1)+e:Math.pow(2,t)+e}function reSign(e,t,r){if(e<=0){return e}var i=t<=32?Math.abs(1<<t-1):Math.pow(2,t-1);if(e>=i&&(t<=32||e>i)){e=-2*i+e}return e}if(!Math["imul"]||Math["imul"](4294967295,5)!==-5)Math["imul"]=function e(t,r){var i=t>>>16;var n=t&65535;var a=r>>>16;var o=r&65535;return n*o+(i*o+n*a<<16)|0};Math.imul=Math["imul"];if(!Math["clz32"])Math["clz32"]=function(e){e=e>>>0;for(var t=0;t<32;t++){if(e&1<<31-t)return t}return 32};Math.clz32=Math["clz32"];var Math_abs=Math.abs;var Math_cos=Math.cos;var Math_sin=Math.sin;var Math_tan=Math.tan;var Math_acos=Math.acos;var Math_asin=Math.asin;var Math_atan=Math.atan;var Math_atan2=Math.atan2;var Math_exp=Math.exp;var Math_log=Math.log;var Math_sqrt=Math.sqrt;var Math_ceil=Math.ceil;var Math_floor=Math.floor;var Math_pow=Math.pow;var Math_imul=Math.imul;var Math_fround=Math.fround;var Math_min=Math.min;var Math_clz32=Math.clz32;var runDependencies=0;var runDependencyWatcher=null;var dependenciesFulfilled=null;function getUniqueRunDependency(e){return e}function addRunDependency(e){runDependencies++;if(Module["monitorRunDependencies"]){Module["monitorRunDependencies"](runDependencies)}}Module["addRunDependency"]=addRunDependency;function removeRunDependency(e){runDependencies--;if(Module["monitorRunDependencies"]){Module["monitorRunDependencies"](runDependencies)}if(runDependencies==0){if(runDependencyWatcher!==null){clearInterval(runDependencyWatcher);runDependencyWatcher=null}if(dependenciesFulfilled){var t=dependenciesFulfilled;dependenciesFulfilled=null;t()}}}Module["removeRunDependency"]=removeRunDependency;Module["preloadedImages"]={};Module["preloadedAudios"]={};var memoryInitializer=null;var ASM_CONSTS=[];STATIC_BASE=8;STATICTOP=STATIC_BASE+5888;__ATINIT__.push();allocate([116,0,0,0,86,7,0,0,116,0,0,0,99,7,0,0,156,0,0,0,112,7,0,0,16,0,0,0,0,0,0,0,156,0,0,0,145,7,0,0,24,0,0,0,0,0,0,0,156,0,0,0,215,7,0,0,24,0,0,0,0,0,0,0,156,0,0,0,179,7,0,0,56,0,0,0,0,0,0,0,156,0,0,0,249,7,0,0,40,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,40,0,0,0,1,0,0,0,2,0,0,0,3,0,0,0,4,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,88,0,0,0,1,0,0,0,5,0,0,0,3,0,0,0,4,0,0,0,1,0,0,0,2,0,0,0,2,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,108,1,0,0,220,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,4,0,0,0,227,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0,0,0,4,0,0,0,219,16,0,0,0,4,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,10,255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,37,115,40,37,117,41,58,32,65,115,115,101,114,116,105,111,110,32,102,97,105,108,117,114,101,58,32,34,37,115,34,10,0,109,95,115,105,122,101,32,60,61,32,109,95,99,97,112,97,99,105,116,121,0,46,47,105,110,99,92,99,114,110,95,100,101,99,111,109,112,46,104,0,109,105,110,95,110,101,119,95,99,97,112,97,99,105,116,121,32,60,32,40,48,120,55,70,70,70,48,48,48,48,85,32,47,32,101,108,101,109,101,110,116,95,115,105,122,101,41,0,110,101,119,95,99,97,112,97,99,105,116,121,32,38,38,32,40,110,101,119,95,99,97,112,97,99,105,116,121,32,62,32,109,95,99,97,112,97,99,105,116,121,41,0,110,117,109,95,99,111,100,101,115,91,99,93,0,115,111,114,116,101,100,95,112,111,115,32,60,32,116,111,116,97,108,95,117,115,101,100,95,115,121,109,115,0,112,67,111,100,101,115,105,122,101,115,91,115,121,109,95,105,110,100,101,120,93,32,61,61,32,99,111,100,101,115,105,122,101,0,116,32,60,32,40,49,85,32,60,60,32,116,97,98,108,101,95,98,105,116,115,41,0,109,95,108,111,111,107,117,112,91,116,93,32,61,61,32,99,85,73,78,84,51,50,95,77,65,88,0,99,114,110,100,95,109,97,108,108,111,99,58,32,115,105,122,101,32,116,111,111,32,98,105,103,0,99,114,110,100,95,109,97,108,108,111,99,58,32,111,117,116,32,111,102,32,109,101,109,111,114,121,0,40,40,117,105,110,116,51,50,41,112,95,110,101,119,32,38,32,40,67,82,78,68,95,77,73,78,95,65,76,76,79,67,95,65,76,73,71,78,77,69,78,84,32,45,32,49,41,41,32,61,61,32,48,0,99,114,110,100,95,114,101,97,108,108,111,99,58,32,98,97,100,32,112,116,114,0,99,114,110,100,95,102,114,101,101,58,32,98,97,100,32,112,116,114,0,102,97,108,115,101,0,40,116,111,116,97,108,95,115,121,109,115,32,62,61,32,49,41,32,38,38,32,40,116,111,116,97,108,95,115,121,109,115,32,60,61,32,112,114,101,102,105,120,95,99,111,100,105,110,103,58,58,99,77,97,120,83,117,112,112,111,114,116,101,100,83,121,109,115,41,0,17,18,19,20,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15,16,48,0,110,117,109,95,98,105,116,115,32,60,61,32,51,50,85,0,109,95,98,105,116,95,99,111,117,110,116,32,60,61,32,99,66,105,116,66,117,102,83,105,122,101,0,116,32,33,61,32,99,85,73,78,84,51,50,95,77,65,88,0,109,111,100,101,108,46,109,95,99,111,100,101,95,115,105,122,101,115,91,115,121,109,93,32,61,61,32,108,101,110,0,0,2,3,1,0,2,3,4,5,6,7,1,40,108,101,110,32,62,61,32,49,41,32,38,38,32,40,108,101,110,32,60,61,32,99,77,97,120,69,120,112,101,99,116,101,100,67,111,100,101,83,105,122,101,41,0,105,32,60,32,109,95,115,105,122,101,0,110,101,120,116,95,108,101,118,101,108,95,111,102,115,32,62,32,99,117,114,95,108,101,118,101,108,95,111,102,115,0,1,2,2,3,3,3,3,4,0,0,0,0,0,0,1,1,0,1,0,1,0,0,1,2,1,2,0,0,0,1,0,2,1,0,2,0,0,1,2,3,110,117,109,32,38,38,32,40,110,117,109,32,61,61,32,126,110,117,109,95,99,104,101,99,107,41,0,83,116,57,101,120,99,101,112,116,105,111,110,0,83,116,57,116,121,112,101,95,105,110,102,111,0,78,49,48,95,95,99,120,120,97,98,105,118,49,49,54,95,95,115,104,105,109,95,116,121,112,101,95,105,110,102,111,69,0,78,49,48,95,95,99,120,120,97,98,105,118,49,49,55,95,95,99,108,97,115,115,95,116,121,112,101,95,105,110,102,111,69,0,78,49,48,95,95,99,120,120,97,98,105,118,49,49,57,95,95,112,111,105,110,116,101,114,95,116,121,112,101,95,105,110,102,111,69,0,78,49,48,95,95,99,120,120,97,98,105,118,49,49,55,95,95,112,98,97,115,101,95,116,121,112,101,95,105,110,102,111,69,0,78,49,48,95,95,99,120,120,97,98,105,118,49,50,48,95,95,115,105,95,99,108,97,115,115,95,116,121,112,101,95,105,110,102,111,69,0,112,116,104,114,101,97,100,95,111,110,99,101,32,102,97,105,108,117,114,101,32,105,110,32,95,95,99,120,97,95,103,101,116,95,103,108,111,98,97,108,115,95,102,97,115,116,40,41,0,116,101,114,109,105,110,97,116,101,95,104,97,110,100,108,101,114,32,117,110,101,120,112,101,99,116,101,100,108,121,32,114,101,116,117,114,110,101,100,0,99,97,110,110,111,116,32,99,114,101,97,116,101,32,112,116,104,114,101,97,100,32,107,101,121,32,102,111,114,32,95,95,99,120,97,95,103,101,116,95,103,108,111,98,97,108,115,40,41,0,99,97,110,110,111,116,32,122,101,114,111,32,111,117,116,32,116,104,114,101,97,100,32,118,97,108,117,101,32,102,111,114,32,95,95,99,120,97,95,103,101,116,95,103,108,111,98,97,108,115,40,41,0,116,101,114,109,105,110,97,116,105,110,103,32,119,105,116,104,32,37,115,32,101,120,99,101,112,116,105,111,110,32,111,102,32,116,121,112,101,32,37,115,58,32,37,115,0,116,101,114,109,105,110,97,116,105,110,103,32,119,105,116,104,32,37,115,32,101,120,99,101,112,116,105,111,110,32,111,102,32,116,121,112,101,32,37,115,0,116,101,114,109,105,110,97,116,105,110,103,32,119,105,116,104,32,37,115,32,102,111,114,101,105,103,110,32,101,120,99,101,112,116,105,111,110,0,116,101,114,109,105,110,97,116,105,110,103,0,117,110,99,97,117,103,104,116,0,84,33,34,25,13,1,2,3,17,75,28,12,16,4,11,29,18,30,39,104,110,111,112,113,98,32,5,6,15,19,20,21,26,8,22,7,40,36,23,24,9,10,14,27,31,37,35,131,130,125,38,42,43,60,61,62,63,67,71,74,77,88,89,90,91,92,93,94,95,96,97,99,100,101,102,103,105,106,107,108,114,115,116,121,122,123,124,0,73,108,108,101,103,97,108,32,98,121,116,101,32,115,101,113,117,101,110,99,101,0,68,111,109,97,105,110,32,101,114,114,111,114,0,82,101,115,117,108,116,32,110,111,116,32,114,101,112,114,101,115,101,110,116,97,98,108,101,0,78,111,116,32,97,32,116,116,121,0,80,101,114,109,105,115,115,105,111,110,32,100,101,110,105,101,100,0,79,112,101,114,97,116,105,111,110,32,110,111,116,32,112,101,114,109,105,116,116,101,100,0,78,111,32,115,117,99,104,32,102,105,108,101,32,111,114,32,100,105,114,101,99,116,111,114,121,0,78,111,32,115,117,99,104,32,112,114,111,99,101,115,115,0,70,105,108,101,32,101,120,105,115,116,115,0,86,97,108,117,101,32,116,111,111,32,108,97,114,103,101,32,102,111,114,32,100,97,116,97,32,116,121,112,101,0,78,111,32,115,112,97,99,101,32,108,101,102,116,32,111,110,32,100,101,118,105,99,101,0,79,117,116,32,111,102,32,109,101,109,111,114,121,0,82,101,115,111,117,114,99,101,32,98,117,115,121,0,73,110,116,101,114,114,117,112,116,101,100,32,115,121,115,116,101,109,32,99,97,108,108,0,82,101,115,111,117,114,99,101,32,116,101,109,112,111,114,97,114,105,108,121,32,117,110,97,118,97,105,108,97,98,108,101,0,73,110,118,97,108,105,100,32,115,101,101,107,0,67,114,111,115,115,45,100,101,118,105,99,101,32,108,105,110,107,0,82,101,97,100,45,111,110,108,121,32,102,105,108,101,32,115,121,115,116,101,109,0,68,105,114,101,99,116,111,114,121,32,110,111,116,32,101,109,112,116,121,0,67,111,110,110,101,99,116,105,111,110,32,114,101,115,101,116,32,98,121,32,112,101,101,114,0,79,112,101,114,97,116,105,111,110,32,116,105,109,101,100,32,111,117,116,0,67,111,110,110,101,99,116,105,111,110,32,114,101,102,117,115,101,100,0,72,111,115,116,32,105,115,32,100,111,119,110,0,72,111,115,116,32,105,115,32,117,110,114,101,97,99,104,97,98,108,101,0,65,100,100,114,101,115,115,32,105,110,32,117,115,101,0,66,114,111,107,101,110,32,112,105,112,101,0,73,47,79,32,101,114,114,111,114,0,78,111,32,115,117,99,104,32,100,101,118,105,99,101,32,111,114,32,97,100,100,114,101,115,115,0,66,108,111,99,107,32,100,101,118,105,99,101,32,114,101,113,117,105,114,101,100,0,78,111,32,115,117,99,104,32,100,101,118,105,99,101,0,78,111,116,32,97,32,100,105,114,101,99,116,111,114,121,0,73,115,32,97,32,100,105,114,101,99,116,111,114,121,0,84,101,120,116,32,102,105,108,101,32,98,117,115,121,0,69,120,101,99,32,102,111,114,109,97,116,32,101,114,114,111,114,0,73,110,118,97,108,105,100,32,97,114,103,117,109,101,110,116,0,65,114,103,117,109,101,110,116,32,108,105,115,116,32,116,111,111,32,108,111,110,103,0,83,121,109,98,111,108,105,99,32,108,105,110,107,32,108,111,111,112,0,70,105,108,101,110,97,109,101,32,116,111,111,32,108,111,110,103,0,84,111,111,32,109,97,110,121,32,111,112,101,110,32,102,105,108,101,115,32,105,110,32,115,121,115,116,101,109,0,78,111,32,102,105,108,101,32,100,101,115,99,114,105,112,116,111,114,115,32,97,118,97,105,108,97,98,108,101,0,66,97,100,32,102,105,108,101,32,100,101,115,99,114,105,112,116,111,114,0,78,111,32,99,104,105,108,100,32,112,114,111,99,101,115,115,0,66,97,100,32,97,100,100,114,101,115,115,0,70,105,108,101,32,116,111,111,32,108,97,114,103,101,0,84,111,111,32,109,97,110,121,32,108,105,110,107,115,0,78,111,32,108,111,99,107,115,32,97,118,97,105,108,97,98,108,101,0,82,101,115,111,117,114,99,101,32,100,101,97,100,108,111,99,107,32,119,111,117,108,100,32,111,99,99,117,114,0,83,116,97,116,101,32,110,111,116,32,114,101,99,111,118,101,114,97,98,108,101,0,80,114,101,118,105,111,117,115,32,111,119,110,101,114,32,100,105,101,100,0,79,112,101,114,97,116,105,111,110,32,99,97,110,99,101,108,101,100,0,70,117,110,99,116,105,111,110,32,110,111,116,32,105,109,112,108,101,109,101,110,116,101,100,0,78,111,32,109,101,115,115,97,103,101,32,111,102,32,100,101,115,105,114,101,100,32,116,121,112,101,0,73,100,101,110,116,105,102,105,101,114,32,114,101,109,111,118,101,100,0,68,101,118,105,99,101,32,110,111,116,32,97,32,115,116,114,101,97,109,0,78,111,32,100,97,116,97,32,97,118,97,105,108,97,98,108,101,0,68,101,118,105,99,101,32,116,105,109,101,111,117,116,0,79,117,116,32,111,102,32,115,116,114,101,97,109,115,32,114,101,115,111,117,114,99,101,115,0,76,105,110,107,32,104,97,115,32,98,101,101,110,32,115,101,118,101,114,101,100,0,80,114,111,116,111,99,111,108,32,101,114,114,111,114,0,66,97,100,32,109,101,115,115,97,103,101,0,70,105,108,101,32,100,101,115,99,114,105,112,116,111,114,32,105,110,32,98,97,100,32,115,116,97,116,101,0,78,111,116,32,97,32,115,111,99,107,101,116,0,68,101,115,116,105,110,97,116,105,111,110,32,97,100,100,114,101,115,115,32,114,101,113,117,105,114,101,100,0,77,101,115,115,97,103,101,32,116,111,111,32,108,97,114,103,101,0,80,114,111,116,111,99,111,108,32,119,114,111,110,103,32,116,121,112,101,32,102,111,114,32,115,111,99,107,101,116,0,80,114,111,116,111,99,111,108,32,110,111,116,32,97,118,97,105,108,97,98,108,101,0,80,114,111,116,111,99,111,108,32,110,111,116,32,115,117,112,112,111,114,116,101,100,0,83,111,99,107,101,116,32,116,121,112,101,32,110,111,116,32,115,117,112,112,111,114,116,101,100,0,78,111,116,32,115,117,112,112,111,114,116,101,100,0,80,114,111,116,111,99,111,108,32,102,97,109,105,108,121,32,110,111,116,32,115,117,112,112,111,114,116,101,100,0,65,100,100,114,101,115,115,32,102,97,109,105,108,121,32,110,111,116,32,115,117,112,112,111,114,116,101,100,32,98,121,32,112,114,111,116,111,99,111,108,0,65,100,100,114,101,115,115,32,110,111,116,32,97,118,97,105,108,97,98,108,101,0,78,101,116,119,111,114,107,32,105,115,32,100,111,119,110,0,78,101,116,119,111,114,107,32,117,110,114,101,97,99,104,97,98,108,101,0,67,111,110,110,101,99,116,105,111,110,32,114,101,115,101,116,32,98,121,32,110,101,116,119,111,114,107,0,67,111,110,110,101,99,116,105,111,110,32,97,98,111,114,116,101,100,0,78,111,32,98,117,102,102,101,114,32,115,112,97,99,101,32,97,118,97,105,108,97,98,108,101,0,83,111,99,107,101,116,32,105,115,32,99,111,110,110,101,99,116,101,100,0,83,111,99,107,101,116,32,110,111,116,32,99,111,110,110,101,99,116,101,100,0,67,97,110,110,111,116,32,115,101,110,100,32,97,102,116,101,114,32,115,111,99,107,101,116,32,115,104,117,116,100,111,119,110,0,79,112,101,114,97,116,105,111,110,32,97,108,114,101,97,100,121,32,105,110,32,112,114,111,103,114,101,115,115,0,79,112,101,114,97,116,105,111,110,32,105,110,32,112,114,111,103,114,101,115,115,0,83,116,97,108,101,32,102,105,108,101,32,104,97,110,100,108,101,0,82,101,109,111,116,101,32,73,47,79,32,101,114,114,111,114,0,81,117,111,116,97,32,101,120,99,101,101,100,101,100,0,78,111,32,109,101,100,105,117,109,32,102,111,117,110,100,0,87,114,111,110,103,32,109,101,100,105,117,109,32,116,121,112,101,0,78,111,32,101,114,114,111,114,32,105,110,102,111,114,109,97,116,105,111,110,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17,0,10,0,17,17,17,0,0,0,0,5,0,0,0,0,0,0,9,0,0,0,0,11,0,0,0,0,0,0,0,0,17,0,15,10,17,17,17,3,10,7,0,1,19,9,11,11,0,0,9,6,11,0,0,11,0,6,17,0,0,0,17,17,17,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,0,0,0,0,0,0,0,0,17,0,10,10,17,17,17,0,10,0,0,2,0,9,11,0,0,0,9,0,11,0,0,11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,12,0,0,0,0,9,12,0,0,0,0,0,12,0,0,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,14,0,0,0,0,0,0,0,0,0,0,0,13,0,0,0,4,13,0,0,0,0,9,14,0,0,0,0,0,14,0,0,14,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,0,0,0,0,15,0,0,0,0,15,0,0,0,0,9,16,0,0,0,0,0,16,0,0,16,0,0,18,0,0,0,18,18,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,18,0,0,0,18,18,18,0,0,0,0,0,0,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,0,0,0,0,0,0,0,0,0,0,0,10,0,0,0,0,10,0,0,0,0,9,11,0,0,0,0,0,11,0,0,11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,12,0,0,0,0,9,12,0,0,0,0,0,12,0,0,12,0,0,48,49,50,51,52,53,54,55,56,57,65,66,67,68,69,70,45,43,32,32,32,48,88,48,120,0,40,110,117,108,108,41,0,45,48,88,43,48,88,32,48,88,45,48,120,43,48,120,32,48,120,0,105,110,102,0,73,78,70,0,110,97,110,0,78,65,78,0,46,0],"i8",ALLOC_NONE,Runtime.GLOBAL_BASE);var tempDoublePtr=Runtime.alignMemory(allocate(12,"i8",ALLOC_STATIC),8);assert(tempDoublePtr%8==0);function copyTempFloat(e){HEAP8[tempDoublePtr]=HEAP8[e];HEAP8[tempDoublePtr+1]=HEAP8[e+1];HEAP8[tempDoublePtr+2]=HEAP8[e+2];HEAP8[tempDoublePtr+3]=HEAP8[e+3]}function copyTempDouble(e){HEAP8[tempDoublePtr]=HEAP8[e];HEAP8[tempDoublePtr+1]=HEAP8[e+1];HEAP8[tempDoublePtr+2]=HEAP8[e+2];HEAP8[tempDoublePtr+3]=HEAP8[e+3];HEAP8[tempDoublePtr+4]=HEAP8[e+4];HEAP8[tempDoublePtr+5]=HEAP8[e+5];HEAP8[tempDoublePtr+6]=HEAP8[e+6];HEAP8[tempDoublePtr+7]=HEAP8[e+7]}var _BDtoIHigh=true;Module["_i64Subtract"]=_i64Subtract;Module["_i64Add"]=_i64Add;function _pthread_cleanup_push(e,t){__ATEXIT__.push(function(){Runtime.dynCall("vi",e,[t])});_pthread_cleanup_push.level=__ATEXIT__.length}Module["_memset"]=_memset;var _BDtoILow=true;Module["_bitshift64Lshr"]=_bitshift64Lshr;Module["_bitshift64Shl"]=_bitshift64Shl;function _pthread_cleanup_pop(){assert(_pthread_cleanup_push.level==__ATEXIT__.length,"cannot pop if something else added meanwhile!");__ATEXIT__.pop();_pthread_cleanup_push.level=__ATEXIT__.length}function _abort(){Module["abort"]()}function __ZSt18uncaught_exceptionv(){return!!__ZSt18uncaught_exceptionv.uncaught_exception}var EXCEPTIONS={last:0,caught:[],infos:{},deAdjust:function(e){if(!e||EXCEPTIONS.infos[e])return e;for(var t in EXCEPTIONS.infos){var r=EXCEPTIONS.infos[t];if(r.adjusted===e){return t}}return e},addRef:function(e){if(!e)return;var t=EXCEPTIONS.infos[e];t.refcount++},decRef:function(e){if(!e)return;var t=EXCEPTIONS.infos[e];assert(t.refcount>0);t.refcount--;if(t.refcount===0){if(t.destructor){Runtime.dynCall("vi",t.destructor,[e])}delete EXCEPTIONS.infos[e];___cxa_free_exception(e)}},clearRef:function(e){if(!e)return;var t=EXCEPTIONS.infos[e];t.refcount=0}};function ___cxa_begin_catch(e){__ZSt18uncaught_exceptionv.uncaught_exception--;EXCEPTIONS.caught.push(e);EXCEPTIONS.addRef(EXCEPTIONS.deAdjust(e));return e}function _pthread_once(e,t){if(!_pthread_once.seen)_pthread_once.seen={};if(e in _pthread_once.seen)return;Runtime.dynCall("v",t);_pthread_once.seen[e]=1}function _emscripten_memcpy_big(e,t,r){HEAPU8.set(HEAPU8.subarray(t,t+r),e);return e}Module["_memcpy"]=_memcpy;var SYSCALLS={varargs:0,get:function(e){SYSCALLS.varargs+=4;var t=HEAP32[SYSCALLS.varargs-4>>2];return t},getStr:function(){var e=Pointer_stringify(SYSCALLS.get());return e},get64:function(){var e=SYSCALLS.get(),t=SYSCALLS.get();if(e>=0)assert(t===0);else assert(t===-1);return e},getZero:function(){assert(SYSCALLS.get()===0)}};function ___syscall6(e,t){SYSCALLS.varargs=t;try{var r=SYSCALLS.getStreamFromFD();FS.close(r);return 0}catch(e){if(typeof FS==="undefined"||!(e instanceof FS.ErrnoError))abort(e);return-e.errno}}var PTHREAD_SPECIFIC={};function _pthread_getspecific(e){return PTHREAD_SPECIFIC[e]||0}function ___setErrNo(e){if(Module["___errno_location"])HEAP32[Module["___errno_location"]()>>2]=e;return e}var ERRNO_CODES={EPERM:1,ENOENT:2,ESRCH:3,EINTR:4,EIO:5,ENXIO:6,E2BIG:7,ENOEXEC:8,EBADF:9,ECHILD:10,EAGAIN:11,EWOULDBLOCK:11,ENOMEM:12,EACCES:13,EFAULT:14,ENOTBLK:15,EBUSY:16,EEXIST:17,EXDEV:18,ENODEV:19,ENOTDIR:20,EISDIR:21,EINVAL:22,ENFILE:23,EMFILE:24,ENOTTY:25,ETXTBSY:26,EFBIG:27,ENOSPC:28,ESPIPE:29,EROFS:30,EMLINK:31,EPIPE:32,EDOM:33,ERANGE:34,ENOMSG:42,EIDRM:43,ECHRNG:44,EL2NSYNC:45,EL3HLT:46,EL3RST:47,ELNRNG:48,EUNATCH:49,ENOCSI:50,EL2HLT:51,EDEADLK:35,ENOLCK:37,EBADE:52,EBADR:53,EXFULL:54,ENOANO:55,EBADRQC:56,EBADSLT:57,EDEADLOCK:35,EBFONT:59,ENOSTR:60,ENODATA:61,ETIME:62,ENOSR:63,ENONET:64,ENOPKG:65,EREMOTE:66,ENOLINK:67,EADV:68,ESRMNT:69,ECOMM:70,EPROTO:71,EMULTIHOP:72,EDOTDOT:73,EBADMSG:74,ENOTUNIQ:76,EBADFD:77,EREMCHG:78,ELIBACC:79,ELIBBAD:80,ELIBSCN:81,ELIBMAX:82,ELIBEXEC:83,ENOSYS:38,ENOTEMPTY:39,ENAMETOOLONG:36,ELOOP:40,EOPNOTSUPP:95,EPFNOSUPPORT:96,ECONNRESET:104,ENOBUFS:105,EAFNOSUPPORT:97,EPROTOTYPE:91,ENOTSOCK:88,ENOPROTOOPT:92,ESHUTDOWN:108,ECONNREFUSED:111,EADDRINUSE:98,ECONNABORTED:103,ENETUNREACH:101,ENETDOWN:100,ETIMEDOUT:110,EHOSTDOWN:112,EHOSTUNREACH:113,EINPROGRESS:115,EALREADY:114,EDESTADDRREQ:89,EMSGSIZE:90,EPROTONOSUPPORT:93,ESOCKTNOSUPPORT:94,EADDRNOTAVAIL:99,ENETRESET:102,EISCONN:106,ENOTCONN:107,ETOOMANYREFS:109,EUSERS:87,EDQUOT:122,ESTALE:116,ENOTSUP:95,ENOMEDIUM:123,EILSEQ:84,EOVERFLOW:75,ECANCELED:125,ENOTRECOVERABLE:131,EOWNERDEAD:130,ESTRPIPE:86};function _sysconf(e){switch(e){case 30:return PAGE_SIZE;case 85:return totalMemory/PAGE_SIZE;case 132:case 133:case 12:case 137:case 138:case 15:case 235:case 16:case 17:case 18:case 19:case 20:case 149:case 13:case 10:case 236:case 153:case 9:case 21:case 22:case 159:case 154:case 14:case 77:case 78:case 139:case 80:case 81:case 82:case 68:case 67:case 164:case 11:case 29:case 47:case 48:case 95:case 52:case 51:case 46:return 200809;case 79:return 0;case 27:case 246:case 127:case 128:case 23:case 24:case 160:case 161:case 181:case 182:case 242:case 183:case 184:case 243:case 244:case 245:case 165:case 178:case 179:case 49:case 50:case 168:case 169:case 175:case 170:case 171:case 172:case 97:case 76:case 32:case 173:case 35:return-1;case 176:case 177:case 7:case 155:case 8:case 157:case 125:case 126:case 92:case 93:case 129:case 130:case 131:case 94:case 91:return 1;case 74:case 60:case 69:case 70:case 4:return 1024;case 31:case 42:case 72:return 32;case 87:case 26:case 33:return 2147483647;case 34:case 1:return 47839;case 38:case 36:return 99;case 43:case 37:return 2048;case 0:return 2097152;case 3:return 65536;case 28:return 32768;case 44:return 32767;case 75:return 16384;case 39:return 1e3;case 89:return 700;case 71:return 256;case 40:return 255;case 2:return 100;case 180:return 64;case 25:return 20;case 5:return 16;case 6:return 6;case 73:return 4;case 84:{if(typeof navigator==="object")return navigator["hardwareConcurrency"]||1;return 1}}___setErrNo(ERRNO_CODES.EINVAL);return-1}function _sbrk(e){var t=_sbrk;if(!t.called){DYNAMICTOP=alignMemoryPage(DYNAMICTOP);t.called=true;assert(Runtime.dynamicAlloc);t.alloc=Runtime.dynamicAlloc;Runtime.dynamicAlloc=function(){abort("cannot dynamically allocate, sbrk now has control")}}var r=DYNAMICTOP;if(e!=0){var i=t.alloc(e);if(!i)return-1>>>0}return r}var PTHREAD_SPECIFIC_NEXT_KEY=1;function _pthread_key_create(e,t){if(e==0){return ERRNO_CODES.EINVAL}HEAP32[e>>2]=PTHREAD_SPECIFIC_NEXT_KEY;PTHREAD_SPECIFIC[PTHREAD_SPECIFIC_NEXT_KEY]=0;PTHREAD_SPECIFIC_NEXT_KEY++;return 0}var _BItoD=true;var PATH=undefined;function _emscripten_set_main_loop_timing(e,t){Browser.mainLoop.timingMode=e;Browser.mainLoop.timingValue=t;if(!Browser.mainLoop.func){return 1}if(e==0){Browser.mainLoop.scheduler=function e(){setTimeout(Browser.mainLoop.runner,t)};Browser.mainLoop.method="timeout"}else if(e==1){Browser.mainLoop.scheduler=function e(){Browser.requestAnimationFrame(Browser.mainLoop.runner)};Browser.mainLoop.method="rAF"}else if(e==2){if(!window["setImmediate"]){var r=[];var i="__emcc";function n(e){if(e.source===window&&e.data===i){e.stopPropagation();r.shift()()}}window.addEventListener("message",n,true);window["setImmediate"]=function e(t){r.push(t);window.postMessage(i,"*")}}Browser.mainLoop.scheduler=function e(){window["setImmediate"](Browser.mainLoop.runner)};Browser.mainLoop.method="immediate"}return 0}function _emscripten_set_main_loop(e,t,r,i,n){Module["noExitRuntime"]=true;assert(!Browser.mainLoop.func,"emscripten_set_main_loop: there can only be one main loop function at once: call emscripten_cancel_main_loop to cancel the previous one before setting a new one with different parameters.");Browser.mainLoop.func=e;Browser.mainLoop.arg=i;var a=Browser.mainLoop.currentlyRunningMainloop;Browser.mainLoop.runner=function t(){if(ABORT)return;if(Browser.mainLoop.queue.length>0){var r=Date.now();var n=Browser.mainLoop.queue.shift();n.func(n.arg);if(Browser.mainLoop.remainingBlockers){var o=Browser.mainLoop.remainingBlockers;var s=o%1==0?o-1:Math.floor(o);if(n.counted){Browser.mainLoop.remainingBlockers=s}else{s=s+.5;Browser.mainLoop.remainingBlockers=(8*o+s)/9}}console.log('main loop blocker "'+n.name+'" took '+(Date.now()-r)+" ms");Browser.mainLoop.updateStatus();setTimeout(Browser.mainLoop.runner,0);return}if(a<Browser.mainLoop.currentlyRunningMainloop)return;Browser.mainLoop.currentFrameNumber=Browser.mainLoop.currentFrameNumber+1|0;if(Browser.mainLoop.timingMode==1&&Browser.mainLoop.timingValue>1&&Browser.mainLoop.currentFrameNumber%Browser.mainLoop.timingValue!=0){Browser.mainLoop.scheduler();return}if(Browser.mainLoop.method==="timeout"&&Module.ctx){Module.printErr("Looks like you are rendering without using requestAnimationFrame for the main loop. You should use 0 for the frame rate in emscripten_set_main_loop in order to use requestAnimationFrame, as that can greatly improve your frame rates!");Browser.mainLoop.method=""}Browser.mainLoop.runIter(function(){if(typeof i!=="undefined"){Runtime.dynCall("vi",e,[i])}else{Runtime.dynCall("v",e)}});if(a<Browser.mainLoop.currentlyRunningMainloop)return;if(typeof SDL==="object"&&SDL.audio&&SDL.audio.queueNewAudioData)SDL.audio.queueNewAudioData();Browser.mainLoop.scheduler()};if(!n){if(t&&t>0)_emscripten_set_main_loop_timing(0,1e3/t);else _emscripten_set_main_loop_timing(1,1);Browser.mainLoop.scheduler()}if(r){throw"SimulateInfiniteLoop"}}var Browser={mainLoop:{scheduler:null,method:"",currentlyRunningMainloop:0,func:null,arg:0,timingMode:0,timingValue:0,currentFrameNumber:0,queue:[],pause:function(){Browser.mainLoop.scheduler=null;Browser.mainLoop.currentlyRunningMainloop++},resume:function(){Browser.mainLoop.currentlyRunningMainloop++;var e=Browser.mainLoop.timingMode;var t=Browser.mainLoop.timingValue;var r=Browser.mainLoop.func;Browser.mainLoop.func=null
;_emscripten_set_main_loop(r,0,false,Browser.mainLoop.arg,true);_emscripten_set_main_loop_timing(e,t);Browser.mainLoop.scheduler()},updateStatus:function(){if(Module["setStatus"]){var e=Module["statusMessage"]||"Please wait...";var t=Browser.mainLoop.remainingBlockers;var r=Browser.mainLoop.expectedBlockers;if(t){if(t<r){Module["setStatus"](e+" ("+(r-t)+"/"+r+")")}else{Module["setStatus"](e)}}else{Module["setStatus"]("")}}},runIter:function(e){if(ABORT)return;if(Module["preMainLoop"]){var t=Module["preMainLoop"]();if(t===false){return}}try{e()}catch(e){if(e instanceof ExitStatus){return}else{if(e&&typeof e==="object"&&e.stack)Module.printErr("exception thrown: "+[e,e.stack]);throw e}}if(Module["postMainLoop"])Module["postMainLoop"]()}},isFullScreen:false,pointerLock:false,moduleContextCreatedCallbacks:[],workers:[],init:function(){if(!Module["preloadPlugins"])Module["preloadPlugins"]=[];if(Browser.initted)return;Browser.initted=true;try{new Blob;Browser.hasBlobConstructor=true}catch(e){Browser.hasBlobConstructor=false;console.log("warning: no blob constructor, cannot create blobs with mimetypes")}Browser.BlobBuilder=typeof MozBlobBuilder!="undefined"?MozBlobBuilder:typeof WebKitBlobBuilder!="undefined"?WebKitBlobBuilder:!Browser.hasBlobConstructor?console.log("warning: no BlobBuilder"):null;Browser.URLObject=typeof window!="undefined"?window.URL?window.URL:window.webkitURL:undefined;if(!Module.noImageDecoding&&typeof Browser.URLObject==="undefined"){console.log("warning: Browser does not support creating object URLs. Built-in browser image decoding will not be available.");Module.noImageDecoding=true}var e={};e["canHandle"]=function e(t){return!Module.noImageDecoding&&/\.(jpg|jpeg|png|bmp)$/i.test(t)};e["handle"]=function e(t,r,i,n){var a=null;if(Browser.hasBlobConstructor){try{a=new Blob([t],{type:Browser.getMimetype(r)});if(a.size!==t.length){a=new Blob([new Uint8Array(t).buffer],{type:Browser.getMimetype(r)})}}catch(e){Runtime.warnOnce("Blob constructor present but fails: "+e+"; falling back to blob builder")}}if(!a){var o=new Browser.BlobBuilder;o.append(new Uint8Array(t).buffer);a=o.getBlob()}var s=Browser.URLObject.createObjectURL(a);var u=new Image;u.onload=function e(){assert(u.complete,"Image "+r+" could not be decoded");var n=document.createElement("canvas");n.width=u.width;n.height=u.height;var a=n.getContext("2d");a.drawImage(u,0,0);Module["preloadedImages"][r]=n;Browser.URLObject.revokeObjectURL(s);if(i)i(t)};u.onerror=function e(t){console.log("Image "+s+" could not be decoded");if(n)n()};u.src=s};Module["preloadPlugins"].push(e);var t={};t["canHandle"]=function e(t){return!Module.noAudioDecoding&&t.substr(-4)in{".ogg":1,".wav":1,".mp3":1}};t["handle"]=function e(t,r,i,n){var a=false;function o(e){if(a)return;a=true;Module["preloadedAudios"][r]=e;if(i)i(t)}function s(){if(a)return;a=true;Module["preloadedAudios"][r]=new Audio;if(n)n()}if(Browser.hasBlobConstructor){try{var u=new Blob([t],{type:Browser.getMimetype(r)})}catch(e){return s()}var l=Browser.URLObject.createObjectURL(u);var c=new Audio;c.addEventListener("canplaythrough",function(){o(c)},false);c.onerror=function e(i){if(a)return;console.log("warning: browser could not fully decode audio "+r+", trying slower base64 approach");function n(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var r="=";var i="";var n=0;var a=0;for(var o=0;o<e.length;o++){n=n<<8|e[o];a+=8;while(a>=6){var s=n>>a-6&63;a-=6;i+=t[s]}}if(a==2){i+=t[(n&3)<<4];i+=r+r}else if(a==4){i+=t[(n&15)<<2];i+=r}return i}c.src="data:audio/x-"+r.substr(-3)+";base64,"+n(t);o(c)};c.src=l;Browser.safeSetTimeout(function(){o(c)},1e4)}else{return s()}};Module["preloadPlugins"].push(t);var r=Module["canvas"];function i(){Browser.pointerLock=document["pointerLockElement"]===r||document["mozPointerLockElement"]===r||document["webkitPointerLockElement"]===r||document["msPointerLockElement"]===r}if(r){r.requestPointerLock=r["requestPointerLock"]||r["mozRequestPointerLock"]||r["webkitRequestPointerLock"]||r["msRequestPointerLock"]||function(){};r.exitPointerLock=document["exitPointerLock"]||document["mozExitPointerLock"]||document["webkitExitPointerLock"]||document["msExitPointerLock"]||function(){};r.exitPointerLock=r.exitPointerLock.bind(document);document.addEventListener("pointerlockchange",i,false);document.addEventListener("mozpointerlockchange",i,false);document.addEventListener("webkitpointerlockchange",i,false);document.addEventListener("mspointerlockchange",i,false);if(Module["elementPointerLock"]){r.addEventListener("click",function(e){if(!Browser.pointerLock&&r.requestPointerLock){r.requestPointerLock();e.preventDefault()}},false)}}},createContext:function(e,t,r,i){if(t&&Module.ctx&&e==Module.canvas)return Module.ctx;var n;var a;if(t){var o={antialias:false,alpha:false};if(i){for(var s in i){o[s]=i[s]}}a=GL.createContext(e,o);if(a){n=GL.getContext(a).GLctx}e.style.backgroundColor="black"}else{n=e.getContext("2d")}if(!n)return null;if(r){if(!t)assert(typeof GLctx==="undefined","cannot set in module if GLctx is used, but we are a non-GL context that would replace it");Module.ctx=n;if(t)GL.makeContextCurrent(a);Module.useWebGL=t;Browser.moduleContextCreatedCallbacks.forEach(function(e){e()});Browser.init()}return n},destroyContext:function(e,t,r){},fullScreenHandlersInstalled:false,lockPointer:undefined,resizeCanvas:undefined,requestFullScreen:function(e,t,r){Browser.lockPointer=e;Browser.resizeCanvas=t;Browser.vrDevice=r;if(typeof Browser.lockPointer==="undefined")Browser.lockPointer=true;if(typeof Browser.resizeCanvas==="undefined")Browser.resizeCanvas=false;if(typeof Browser.vrDevice==="undefined")Browser.vrDevice=null;var i=Module["canvas"];function n(){Browser.isFullScreen=false;var e=i.parentNode;if((document["webkitFullScreenElement"]||document["webkitFullscreenElement"]||document["mozFullScreenElement"]||document["mozFullscreenElement"]||document["fullScreenElement"]||document["fullscreenElement"]||document["msFullScreenElement"]||document["msFullscreenElement"]||document["webkitCurrentFullScreenElement"])===e){i.cancelFullScreen=document["cancelFullScreen"]||document["mozCancelFullScreen"]||document["webkitCancelFullScreen"]||document["msExitFullscreen"]||document["exitFullscreen"]||function(){};i.cancelFullScreen=i.cancelFullScreen.bind(document);if(Browser.lockPointer)i.requestPointerLock();Browser.isFullScreen=true;if(Browser.resizeCanvas)Browser.setFullScreenCanvasSize()}else{e.parentNode.insertBefore(i,e);e.parentNode.removeChild(e);if(Browser.resizeCanvas)Browser.setWindowedCanvasSize()}if(Module["onFullScreen"])Module["onFullScreen"](Browser.isFullScreen);Browser.updateCanvasDimensions(i)}if(!Browser.fullScreenHandlersInstalled){Browser.fullScreenHandlersInstalled=true;document.addEventListener("fullscreenchange",n,false);document.addEventListener("mozfullscreenchange",n,false);document.addEventListener("webkitfullscreenchange",n,false);document.addEventListener("MSFullscreenChange",n,false)}var a=document.createElement("div");i.parentNode.insertBefore(a,i);a.appendChild(i);a.requestFullScreen=a["requestFullScreen"]||a["mozRequestFullScreen"]||a["msRequestFullscreen"]||(a["webkitRequestFullScreen"]?function(){a["webkitRequestFullScreen"](Element["ALLOW_KEYBOARD_INPUT"])}:null);if(r){a.requestFullScreen({vrDisplay:r})}else{a.requestFullScreen()}},nextRAF:0,fakeRequestAnimationFrame:function(e){var t=Date.now();if(Browser.nextRAF===0){Browser.nextRAF=t+1e3/60}else{while(t+2>=Browser.nextRAF){Browser.nextRAF+=1e3/60}}var r=Math.max(Browser.nextRAF-t,0);setTimeout(e,r)},requestAnimationFrame:function e(t){if(typeof window==="undefined"){Browser.fakeRequestAnimationFrame(t)}else{if(!window.requestAnimationFrame){window.requestAnimationFrame=window["requestAnimationFrame"]||window["mozRequestAnimationFrame"]||window["webkitRequestAnimationFrame"]||window["msRequestAnimationFrame"]||window["oRequestAnimationFrame"]||Browser.fakeRequestAnimationFrame}window.requestAnimationFrame(t)}},safeCallback:function(e){return function(){if(!ABORT)return e.apply(null,arguments)}},allowAsyncCallbacks:true,queuedAsyncCallbacks:[],pauseAsyncCallbacks:function(){Browser.allowAsyncCallbacks=false},resumeAsyncCallbacks:function(){Browser.allowAsyncCallbacks=true;if(Browser.queuedAsyncCallbacks.length>0){var e=Browser.queuedAsyncCallbacks;Browser.queuedAsyncCallbacks=[];e.forEach(function(e){e()})}},safeRequestAnimationFrame:function(e){return Browser.requestAnimationFrame(function(){if(ABORT)return;if(Browser.allowAsyncCallbacks){e()}else{Browser.queuedAsyncCallbacks.push(e)}})},safeSetTimeout:function(e,t){Module["noExitRuntime"]=true;return setTimeout(function(){if(ABORT)return;if(Browser.allowAsyncCallbacks){e()}else{Browser.queuedAsyncCallbacks.push(e)}},t)},safeSetInterval:function(e,t){Module["noExitRuntime"]=true;return setInterval(function(){if(ABORT)return;if(Browser.allowAsyncCallbacks){e()}},t)},getMimetype:function(e){return{jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png",bmp:"image/bmp",ogg:"audio/ogg",wav:"audio/wav",mp3:"audio/mpeg"}[e.substr(e.lastIndexOf(".")+1)]},getUserMedia:function(e){if(!window.getUserMedia){window.getUserMedia=navigator["getUserMedia"]||navigator["mozGetUserMedia"]}window.getUserMedia(e)},getMovementX:function(e){return e["movementX"]||e["mozMovementX"]||e["webkitMovementX"]||0},getMovementY:function(e){return e["movementY"]||e["mozMovementY"]||e["webkitMovementY"]||0},getMouseWheelDelta:function(e){var t=0;switch(e.type){case"DOMMouseScroll":t=e.detail;break;case"mousewheel":t=e.wheelDelta;break;case"wheel":t=e["deltaY"];break;default:throw"unrecognized mouse wheel event: "+e.type}return t},mouseX:0,mouseY:0,mouseMovementX:0,mouseMovementY:0,touches:{},lastTouches:{},calculateMouseEvent:function(e){if(Browser.pointerLock){if(e.type!="mousemove"&&"mozMovementX"in e){Browser.mouseMovementX=Browser.mouseMovementY=0}else{Browser.mouseMovementX=Browser.getMovementX(e);Browser.mouseMovementY=Browser.getMovementY(e)}if(typeof SDL!="undefined"){Browser.mouseX=SDL.mouseX+Browser.mouseMovementX;Browser.mouseY=SDL.mouseY+Browser.mouseMovementY}else{Browser.mouseX+=Browser.mouseMovementX;Browser.mouseY+=Browser.mouseMovementY}}else{var t=Module["canvas"].getBoundingClientRect();var r=Module["canvas"].width;var i=Module["canvas"].height;var n=typeof window.scrollX!=="undefined"?window.scrollX:window.pageXOffset;var a=typeof window.scrollY!=="undefined"?window.scrollY:window.pageYOffset;if(e.type==="touchstart"||e.type==="touchend"||e.type==="touchmove"){var o=e.touch;if(o===undefined){return}var s=o.pageX-(n+t.left);var u=o.pageY-(a+t.top);s=s*(r/t.width);u=u*(i/t.height);var l={x:s,y:u};if(e.type==="touchstart"){Browser.lastTouches[o.identifier]=l;Browser.touches[o.identifier]=l}else if(e.type==="touchend"||e.type==="touchmove"){var c=Browser.touches[o.identifier];if(!c)c=l;Browser.lastTouches[o.identifier]=c;Browser.touches[o.identifier]=l}return}var d=e.pageX-(n+t.left);var f=e.pageY-(a+t.top);d=d*(r/t.width);f=f*(i/t.height);Browser.mouseMovementX=d-Browser.mouseX;Browser.mouseMovementY=f-Browser.mouseY;Browser.mouseX=d;Browser.mouseY=f}},xhrLoad:function(e,t,r){var i=new XMLHttpRequest;i.open("GET",e,true);i.responseType="arraybuffer";i.onload=function e(){if(i.status==200||i.status==0&&i.response){t(i.response)}else{r()}};i.onerror=r;i.send(null)},asyncLoad:function(e,t,r,i){Browser.xhrLoad(e,function(r){assert(r,'Loading data file "'+e+'" failed (no arrayBuffer).');t(new Uint8Array(r));if(!i)removeRunDependency("al "+e)},function(t){if(r){r()}else{throw'Loading data file "'+e+'" failed.'}});if(!i)addRunDependency("al "+e)},resizeListeners:[],updateResizeListeners:function(){var e=Module["canvas"];Browser.resizeListeners.forEach(function(t){t(e.width,e.height)})},setCanvasSize:function(e,t,r){var i=Module["canvas"];Browser.updateCanvasDimensions(i,e,t);if(!r)Browser.updateResizeListeners()},windowedWidth:0,windowedHeight:0,setFullScreenCanvasSize:function(){if(typeof SDL!="undefined"){var e=HEAPU32[SDL.screen+Runtime.QUANTUM_SIZE*0>>2];e=e|8388608;HEAP32[SDL.screen+Runtime.QUANTUM_SIZE*0>>2]=e}Browser.updateResizeListeners()},setWindowedCanvasSize:function(){if(typeof SDL!="undefined"){var e=HEAPU32[SDL.screen+Runtime.QUANTUM_SIZE*0>>2];e=e&~8388608;HEAP32[SDL.screen+Runtime.QUANTUM_SIZE*0>>2]=e}Browser.updateResizeListeners()},updateCanvasDimensions:function(e,t,r){if(t&&r){e.widthNative=t;e.heightNative=r}else{t=e.widthNative;r=e.heightNative}var i=t;var n=r;if(Module["forcedAspectRatio"]&&Module["forcedAspectRatio"]>0){if(i/n<Module["forcedAspectRatio"]){i=Math.round(n*Module["forcedAspectRatio"])}else{n=Math.round(i/Module["forcedAspectRatio"])}}if((document["webkitFullScreenElement"]||document["webkitFullscreenElement"]||document["mozFullScreenElement"]||document["mozFullscreenElement"]||document["fullScreenElement"]||document["fullscreenElement"]||document["msFullScreenElement"]||document["msFullscreenElement"]||document["webkitCurrentFullScreenElement"])===e.parentNode&&typeof screen!="undefined"){var a=Math.min(screen.width/i,screen.height/n);i=Math.round(i*a);n=Math.round(n*a)}if(Browser.resizeCanvas){if(e.width!=i)e.width=i;if(e.height!=n)e.height=n;if(typeof e.style!="undefined"){e.style.removeProperty("width");e.style.removeProperty("height")}}else{if(e.width!=t)e.width=t;if(e.height!=r)e.height=r;if(typeof e.style!="undefined"){if(i!=t||n!=r){e.style.setProperty("width",i+"px","important");e.style.setProperty("height",n+"px","important")}else{e.style.removeProperty("width");e.style.removeProperty("height")}}}},wgetRequests:{},nextWgetRequestHandle:0,getNextWgetRequestHandle:function(){var e=Browser.nextWgetRequestHandle;Browser.nextWgetRequestHandle++;return e}};function _pthread_setspecific(e,t){if(!(e in PTHREAD_SPECIFIC)){return ERRNO_CODES.EINVAL}PTHREAD_SPECIFIC[e]=t;return 0}function _time(e){var t=Date.now()/1e3|0;if(e){HEAP32[e>>2]=t}return t}function _pthread_self(){return 0}function ___syscall140(e,t){SYSCALLS.varargs=t;try{var r=SYSCALLS.getStreamFromFD(),i=SYSCALLS.get(),n=SYSCALLS.get(),a=SYSCALLS.get(),o=SYSCALLS.get();var s=n;assert(i===0);FS.llseek(r,s,o);HEAP32[a>>2]=r.position;if(r.getdents&&s===0&&o===0)r.getdents=null;return 0}catch(e){if(typeof FS==="undefined"||!(e instanceof FS.ErrnoError))abort(e);return-e.errno}}function ___syscall146(e,t){SYSCALLS.varargs=t;try{var r=SYSCALLS.get(),i=SYSCALLS.get(),n=SYSCALLS.get();var a=0;if(!___syscall146.buffer)___syscall146.buffer=[];var o=___syscall146.buffer;for(var s=0;s<n;s++){var u=HEAP32[i+s*8>>2];var l=HEAP32[i+(s*8+4)>>2];for(var c=0;c<l;c++){var d=HEAPU8[u+c];if(d===0||d===10){Module["print"](UTF8ArrayToString(o,0));o.length=0}else{o.push(d)}}a+=l}return a}catch(e){if(typeof FS==="undefined"||!(e instanceof FS.ErrnoError))abort(e);return-e.errno}}function ___syscall54(e,t){SYSCALLS.varargs=t;try{return 0}catch(e){if(typeof FS==="undefined"||!(e instanceof FS.ErrnoError))abort(e);return-e.errno}}Module["requestFullScreen"]=function e(t,r,i){Browser.requestFullScreen(t,r,i)};Module["requestAnimationFrame"]=function e(t){Browser.requestAnimationFrame(t)};Module["setCanvasSize"]=function e(t,r,i){Browser.setCanvasSize(t,r,i)};Module["pauseMainLoop"]=function e(){Browser.mainLoop.pause()};Module["resumeMainLoop"]=function e(){Browser.mainLoop.resume()};Module["getUserMedia"]=function e(){Browser.getUserMedia()};Module["createContext"]=function e(t,r,i,n){return Browser.createContext(t,r,i,n)};STACK_BASE=STACKTOP=Runtime.alignMemory(STATICTOP);staticSealed=true;STACK_MAX=STACK_BASE+TOTAL_STACK;DYNAMIC_BASE=DYNAMICTOP=Runtime.alignMemory(STACK_MAX);assert(DYNAMIC_BASE<TOTAL_MEMORY,"TOTAL_MEMORY not big enough for stack");var cttz_i8=allocate([8,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,6,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,7,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,6,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0],"i8",ALLOC_DYNAMIC);function invoke_iiii(e,t,r,i){try{return Module["dynCall_iiii"](e,t,r,i)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}function invoke_viiiii(e,t,r,i,n,a){try{Module["dynCall_viiiii"](e,t,r,i,n,a)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}function invoke_vi(e,t){try{Module["dynCall_vi"](e,t)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}function invoke_ii(e,t){try{return Module["dynCall_ii"](e,t)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}function invoke_viii(e,t,r,i){try{Module["dynCall_viii"](e,t,r,i)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}function invoke_v(e){try{Module["dynCall_v"](e)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}function invoke_viiiiii(e,t,r,i,n,a,o){try{Module["dynCall_viiiiii"](e,t,r,i,n,a,o)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}function invoke_viiii(e,t,r,i,n){try{Module["dynCall_viiii"](e,t,r,i,n)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}Module.asmGlobalArg={Math:Math,Int8Array:Int8Array,Int16Array:Int16Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array,NaN:NaN,Infinity:Infinity,byteLength:byteLength};Module.asmLibraryArg={abort:abort,assert:assert,invoke_iiii:invoke_iiii,invoke_viiiii:invoke_viiiii,invoke_vi:invoke_vi,invoke_ii:invoke_ii,invoke_viii:invoke_viii,invoke_v:invoke_v,invoke_viiiiii:invoke_viiiiii,invoke_viiii:invoke_viiii,_pthread_cleanup_pop:_pthread_cleanup_pop,_pthread_getspecific:_pthread_getspecific,_pthread_setspecific:_pthread_setspecific,__ZSt18uncaught_exceptionv:__ZSt18uncaught_exceptionv,_emscripten_set_main_loop:_emscripten_set_main_loop,_pthread_self:_pthread_self,_abort:_abort,_pthread_cleanup_push:_pthread_cleanup_push,___syscall6:___syscall6,_sbrk:_sbrk,_time:_time,_pthread_key_create:_pthread_key_create,___setErrNo:___setErrNo,_emscripten_memcpy_big:_emscripten_memcpy_big,___syscall54:___syscall54,___syscall140:___syscall140,_pthread_once:_pthread_once,_emscripten_set_main_loop_timing:_emscripten_set_main_loop_timing,_sysconf:_sysconf,___syscall146:___syscall146,___cxa_begin_catch:___cxa_begin_catch,STACKTOP:STACKTOP,STACK_MAX:STACK_MAX,tempDoublePtr:tempDoublePtr,ABORT:ABORT,cttz_i8:cttz_i8};var asm=function(e,t,r){"use asm";var i=e.Int8Array;var n=e.Int16Array;var a=e.Int32Array;var o=e.Uint8Array;var s=e.Uint16Array;var u=e.Uint32Array;var l=e.Float32Array;var c=e.Float64Array;var d=new i(r);var f=new n(r);var h=new a(r);var p=new o(r);var m=new s(r);var v=new u(r);var _=new l(r);var g=new c(r);var y=e.byteLength;var w=t.STACKTOP|0;var C=t.STACK_MAX|0;var b=t.tempDoublePtr|0;var S=t.ABORT|0;var E=t.cttz_i8|0;var T=0;var x=0;var A=0;var P=0;var D=e.NaN,M=e.Infinity;var I=0,O=0,R=0,N=0,L=0,B=0,F=0,k=0,V=0;var z=0;var U=0;var q=0;var G=0;var H=0;var W=0;var j=0;var Y=0;var X=0;var Z=0;var K=e.Math.floor;var Q=e.Math.abs;var J=e.Math.sqrt;var $=e.Math.pow;var ee=e.Math.cos;var te=e.Math.sin;var re=e.Math.tan;var ie=e.Math.acos;var ne=e.Math.asin;var ae=e.Math.atan;var oe=e.Math.atan2;var se=e.Math.exp;var ue=e.Math.log;var le=e.Math.ceil;var ce=e.Math.imul;var de=e.Math.min;var fe=e.Math.clz32;var he=t.abort;var pe=t.assert;var me=t.invoke_iiii;var ve=t.invoke_viiiii;var _e=t.invoke_vi;var ge=t.invoke_ii;var ye=t.invoke_viii;var we=t.invoke_v;var Ce=t.invoke_viiiiii;var be=t.invoke_viiii;var Se=t._pthread_cleanup_pop;var Ee=t._pthread_getspecific;var Te=t._pthread_setspecific;var xe=t.__ZSt18uncaught_exceptionv;var Ae=t._emscripten_set_main_loop;var Pe=t._pthread_self;var De=t._abort;var Me=t._pthread_cleanup_push;var Ie=t.___syscall6;var Oe=t._sbrk;var Re=t._time;var Ne=t._pthread_key_create;var Le=t.___setErrNo;var Be=t._emscripten_memcpy_big;var Fe=t.___syscall54;var ke=t.___syscall140;var Ve=t._pthread_once;var ze=t._emscripten_set_main_loop_timing;var Ue=t._sysconf;var qe=t.___syscall146;var Ge=t.___cxa_begin_catch;var He=0;function We(e){if(y(e)&16777215||y(e)<=16777215||y(e)>2147483648)return false;d=new i(e);f=new n(e);h=new a(e);p=new o(e);m=new s(e);v=new u(e);_=new l(e);g=new c(e);r=e;return true}function je(e){e=e|0;var t=0;t=w;w=w+e|0;w=w+15&-16;return t|0}function Ye(){return w|0}function Xe(e){e=e|0;w=e}function Ze(e,t){e=e|0;t=t|0;w=e;C=t}function Ke(e,t){e=e|0;t=t|0;if(!T){T=e;x=t}}function Qe(e){e=e|0;d[b>>0]=d[e>>0];d[b+1>>0]=d[e+1>>0];d[b+2>>0]=d[e+2>>0];d[b+3>>0]=d[e+3>>0]}function Je(e){e=e|0;d[b>>0]=d[e>>0];d[b+1>>0]=d[e+1>>0];d[b+2>>0]=d[e+2>>0];d[b+3>>0]=d[e+3>>0];d[b+4>>0]=d[e+4>>0];d[b+5>>0]=d[e+5>>0];d[b+6>>0]=d[e+6>>0];d[b+7>>0]=d[e+7>>0]}function $e(e){e=e|0;z=e}function et(){return z|0}function tt(e,t,r,i,n){e=e|0;t=t|0;r=r|0;i=i|0;n=n|0;var a=0,o=0,s=0,u=0,l=0,c=0,d=0,f=0,p=0;p=w;w=w+576|0;c=p+48|0;s=p+32|0;o=p+16|0;a=p;l=p+64|0;d=p+60|0;u=e+4|0;f=e+8|0;if((h[u>>2]|0)>>>0>(h[f>>2]|0)>>>0){h[a>>2]=1138;h[a+4>>2]=2119;h[a+8>>2]=1117;yr(l,1084,a)|0;gr(l)|0}if((2147418112/(i>>>0)|0)>>>0<=t>>>0){h[o>>2]=1138;h[o+4>>2]=2120;h[o+8>>2]=1157;yr(l,1084,o)|0;gr(l)|0}o=h[f>>2]|0;if(o>>>0>=t>>>0){f=1;w=p;return f|0}do{if(r){if(t){a=t+-1|0;if(!(a&t)){a=11;break}else t=a}else t=-1;t=t>>>16|t;t=t>>>8|t;t=t>>>4|t;t=t>>>2|t;t=(t>>>1|t)+1|0;a=10}else a=10}while(0);if((a|0)==10)if(!t){t=0;a=12}else a=11;if((a|0)==11)if(t>>>0<=o>>>0)a=12;if((a|0)==12){h[s>>2]=1138;h[s+4>>2]=2129;h[s+8>>2]=1205;yr(l,1084,s)|0;gr(l)|0}r=ce(t,i)|0;do{if(!n){a=rt(h[e>>2]|0,r,d,1)|0;if(!a){f=0;w=p;return f|0}else{h[e>>2]=a;break}}else{o=it(r,d)|0;if(!o){f=0;w=p;return f|0}Ai[n&0](o,h[e>>2]|0,h[u>>2]|0);a=h[e>>2]|0;do{if(a)if(!(a&7)){at(a,0,0,1,0)|0;break}else{h[c>>2]=1138;h[c+4>>2]=2502;h[c+8>>2]=1504;yr(l,1084,c)|0;gr(l)|0;break}}while(0);h[e>>2]=o}}while(0);a=h[d>>2]|0;if(a>>>0>r>>>0)t=(a>>>0)/(i>>>0)|0;h[f>>2]=t;f=1;w=p;return f|0}function rt(e,t,r,i){e=e|0;t=t|0;r=r|0;i=i|0;var n=0,a=0,o=0,s=0,u=0,l=0;l=w;w=w+560|0;u=l+32|0;a=l+16|0;n=l;s=l+48|0;o=l+44|0;if(e&7){h[n>>2]=1138;h[n+4>>2]=2502;h[n+8>>2]=1482;yr(s,1084,n)|0;gr(s)|0;u=0;w=l;return u|0}if(t>>>0>2147418112){h[a>>2]=1138;h[a+4>>2]=2502;h[a+8>>2]=1375;yr(s,1084,a)|0;gr(s)|0;u=0;w=l;return u|0}h[o>>2]=t;i=at(e,t,o,i,0)|0;if(r)h[r>>2]=h[o>>2];if(!(i&7)){u=i;w=l;return u|0}h[u>>2]=1138;h[u+4>>2]=2554;h[u+8>>2]=1428;yr(s,1084,u)|0;gr(s)|0;u=i;w=l;return u|0}function it(e,t){e=e|0;t=t|0;var r=0,i=0,n=0,a=0,o=0,s=0,u=0;u=w;w=w+560|0;s=u+32|0;o=u+16|0;r=u;a=u+48|0;n=u+44|0;i=e+3&-4;i=(i|0)!=0?i:4;if(i>>>0>2147418112){h[r>>2]=1138;h[r+4>>2]=2502;h[r+8>>2]=1375;yr(a,1084,r)|0;gr(a)|0;s=0;w=u;return s|0}h[n>>2]=i;r=at(0,i,n,1,0)|0;e=h[n>>2]|0;if(t)h[t>>2]=e;if((r|0)==0|e>>>0<i>>>0){h[o>>2]=1138;h[o+4>>2]=2502;h[o+8>>2]=1401;yr(a,1084,o)|0;gr(a)|0;s=0;w=u;return s|0}if(!(r&7)){s=r;w=u;return s|0}h[s>>2]=1138;h[s+4>>2]=2529;h[s+8>>2]=1428;yr(a,1084,s)|0;gr(a)|0;s=r;w=u;return s|0}function nt(e,t,r,i){e=e|0;t=t|0;r=r|0;i=i|0;var n=0,a=0,o=0,s=0,u=0,l=0,c=0,v=0,_=0,g=0,y=0,C=0,b=0,S=0,E=0,T=0,x=0,A=0,P=0,D=0,M=0,I=0,O=0,R=0,N=0,L=0,B=0,F=0;F=w;w=w+880|0;N=F+144|0;R=F+128|0;O=F+112|0;I=F+96|0;P=F+80|0;b=F+64|0;y=F+48|0;C=F+32|0;v=F+16|0;c=F;M=F+360|0;L=F+296|0;B=F+224|0;g=F+156|0;if((t|0)==0|i>>>0>11){e=0;w=F;return e|0}h[e>>2]=t;n=B;a=n+68|0;do{h[n>>2]=0;n=n+4|0}while((n|0)<(a|0));a=0;do{n=d[r+a>>0]|0;if(n<<24>>24){D=B+((n&255)<<2)|0;h[D>>2]=(h[D>>2]|0)+1}a=a+1|0}while((a|0)!=(t|0));a=0;l=1;o=0;s=-1;u=0;while(1){n=h[B+(l<<2)>>2]|0;if(!n)h[e+28+(l+-1<<2)>>2]=0;else{D=l+-1|0;h[L+(D<<2)>>2]=a;a=n+a|0;A=16-l|0;h[e+28+(D<<2)>>2]=(a+-1<<A|(1<<A)+-1)+1;h[e+96+(D<<2)>>2]=u;h[g+(l<<2)>>2]=u;o=o>>>0>l>>>0?o:l;s=s>>>0<l>>>0?s:l;u=n+u|0}l=l+1|0;if((l|0)==17){D=o;break}else a=a<<1}h[e+4>>2]=u;a=e+172|0;do{if(u>>>0>(h[a>>2]|0)>>>0){h[a>>2]=u;if(u){n=u+-1|0;if(n&u)_=14}else{n=-1;_=14}if((_|0)==14){A=n>>>16|n;A=A>>>8|A;A=A>>>4|A;A=A>>>2|A;A=(A>>>1|A)+1|0;h[a>>2]=A>>>0>t>>>0?t:A}o=e+176|0;n=h[o>>2]|0;do{if(n){A=h[n+-4>>2]|0;n=n+-8|0;if(!((A|0)!=0?(A|0)==(~h[n>>2]|0):0)){h[c>>2]=1138;h[c+4>>2]=647;h[c+8>>2]=1851;yr(M,1084,c)|0;gr(M)|0}if(!(n&7)){at(n,0,0,1,0)|0;break}else{h[v>>2]=1138;h[v+4>>2]=2502;h[v+8>>2]=1504;yr(M,1084,v)|0;gr(M)|0;break}}}while(0);a=h[a>>2]|0;a=(a|0)!=0?a:1;n=it((a<<1)+8|0,0)|0;if(!n){h[o>>2]=0;n=0;break}else{h[n+4>>2]=a;h[n>>2]=~a;h[o>>2]=n+8;_=25;break}}else _=25}while(0);e:do{if((_|0)==25){A=e+24|0;d[A>>0]=s;d[e+25>>0]=D;a=e+176|0;o=0;do{x=d[r+o>>0]|0;n=x&255;if(x<<24>>24){if(!(h[B+(n<<2)>>2]|0)){h[C>>2]=1138;h[C+4>>2]=2272;h[C+8>>2]=1249;yr(M,1084,C)|0;gr(M)|0}x=g+(n<<2)|0;n=h[x>>2]|0;h[x>>2]=n+1;if(n>>>0>=u>>>0){h[y>>2]=1138;h[y+4>>2]=2276;h[y+8>>2]=1262;yr(M,1084,y)|0;gr(M)|0}f[(h[a>>2]|0)+(n<<1)>>1]=o}o=o+1|0}while((o|0)!=(t|0));n=d[A>>0]|0;T=(n&255)>>>0<i>>>0?i:0;x=e+8|0;h[x>>2]=T;E=(T|0)!=0;if(E){S=1<<T;n=e+164|0;do{if(S>>>0>(h[n>>2]|0)>>>0){h[n>>2]=S;o=e+168|0;n=h[o>>2]|0;do{if(n){C=h[n+-4>>2]|0;n=n+-8|0;if(!((C|0)!=0?(C|0)==(~h[n>>2]|0):0)){h[b>>2]=1138;h[b+4>>2]=647;h[b+8>>2]=1851;yr(M,1084,b)|0;gr(M)|0}if(!(n&7)){at(n,0,0,1,0)|0;break}else{h[P>>2]=1138;h[P+4>>2]=2502;h[P+8>>2]=1504;yr(M,1084,P)|0;gr(M)|0;break}}}while(0);n=S<<2;a=it(n+8|0,0)|0;if(!a){h[o>>2]=0;n=0;break e}else{P=a+8|0;h[a+4>>2]=S;h[a>>2]=~S;h[o>>2]=P;a=P;break}}else{a=e+168|0;n=S<<2;o=a;a=h[a>>2]|0}}while(0);Xr(a|0,-1,n|0)|0;g=e+176|0;b=1;do{if(h[B+(b<<2)>>2]|0){y=T-b|0;C=1<<y;a=b+-1|0;s=h[L+(a<<2)>>2]|0;if(a>>>0>=16){h[I>>2]=1138;h[I+4>>2]=1956;h[I+8>>2]=1725;yr(M,1084,I)|0;gr(M)|0}n=h[e+28+(a<<2)>>2]|0;if(!n)t=-1;else t=(n+-1|0)>>>(16-b|0);if(s>>>0<=t>>>0){v=(h[e+96+(a<<2)>>2]|0)-s|0;_=b<<16;do{n=m[(h[g>>2]|0)+(v+s<<1)>>1]|0;if((p[r+n>>0]|0|0)!=(b|0)){h[O>>2]=1138;h[O+4>>2]=2318;h[O+8>>2]=1291;yr(M,1084,O)|0;gr(M)|0}c=s<<y;a=n|_;l=0;do{u=l+c|0;if(u>>>0>=S>>>0){h[R>>2]=1138;h[R+4>>2]=2324;h[R+8>>2]=1325;yr(M,1084,R)|0;gr(M)|0}n=h[o>>2]|0;if((h[n+(u<<2)>>2]|0)!=-1){h[N>>2]=1138;h[N+4>>2]=2326;h[N+8>>2]=1348;yr(M,1084,N)|0;gr(M)|0;n=h[o>>2]|0}h[n+(u<<2)>>2]=a;l=l+1|0}while(l>>>0<C>>>0);s=s+1|0}while(s>>>0<=t>>>0)}}b=b+1|0}while(T>>>0>=b>>>0);n=d[A>>0]|0}a=e+96|0;h[a>>2]=(h[a>>2]|0)-(h[L>>2]|0);a=e+100|0;h[a>>2]=(h[a>>2]|0)-(h[L+4>>2]|0);a=e+104|0;h[a>>2]=(h[a>>2]|0)-(h[L+8>>2]|0);a=e+108|0;h[a>>2]=(h[a>>2]|0)-(h[L+12>>2]|0);a=e+112|0;h[a>>2]=(h[a>>2]|0)-(h[L+16>>2]|0);a=e+116|0;h[a>>2]=(h[a>>2]|0)-(h[L+20>>2]|0);a=e+120|0;h[a>>2]=(h[a>>2]|0)-(h[L+24>>2]|0);a=e+124|0;h[a>>2]=(h[a>>2]|0)-(h[L+28>>2]|0);a=e+128|0;h[a>>2]=(h[a>>2]|0)-(h[L+32>>2]|0);a=e+132|0;h[a>>2]=(h[a>>2]|0)-(h[L+36>>2]|0);a=e+136|0;h[a>>2]=(h[a>>2]|0)-(h[L+40>>2]|0);a=e+140|0;h[a>>2]=(h[a>>2]|0)-(h[L+44>>2]|0);a=e+144|0;h[a>>2]=(h[a>>2]|0)-(h[L+48>>2]|0);a=e+148|0;h[a>>2]=(h[a>>2]|0)-(h[L+52>>2]|0);a=e+152|0;h[a>>2]=(h[a>>2]|0)-(h[L+56>>2]|0);a=e+156|0;h[a>>2]=(h[a>>2]|0)-(h[L+60>>2]|0);a=e+16|0;h[a>>2]=0;o=e+20|0;h[o>>2]=n&255;t:do{if(E){while(1){if(!i)break t;n=i+-1|0;if(!(h[B+(i<<2)>>2]|0))i=n;else break}h[a>>2]=h[e+28+(n<<2)>>2];n=T+1|0;h[o>>2]=n;if(n>>>0<=D>>>0){while(1){if(h[B+(n<<2)>>2]|0)break;n=n+1|0;if(n>>>0>D>>>0)break t}h[o>>2]=n}}}while(0);h[e+92>>2]=-1;h[e+160>>2]=1048575;h[e+12>>2]=32-(h[x>>2]|0);n=1}}while(0);e=n;w=F;return e|0}function at(e,t,r,i,n){e=e|0;t=t|0;r=r|0;i=i|0;n=n|0;do{if(!e){i=Vr(t)|0;if(r){if(!i)e=0;else e=qr(i)|0;h[r>>2]=e}}else{if(!t){zr(e);if(!r){i=0;break}h[r>>2]=0;i=0;break}if(i){i=Ur(e,t)|0;e=(i|0)==0?e:i}else i=0;if(r){t=qr(e)|0;h[r>>2]=t}}}while(0);return i|0}function ot(e,t,r){e=e|0;t=t|0;r=r|0;var i=0;if(!((e|0)!=0&t>>>0>73&(r|0)!=0)){r=0;return r|0}if((h[r>>2]|0)!=40|t>>>0<74){r=0;return r|0}if(((p[e>>0]|0)<<8|(p[e+1>>0]|0)|0)!=18552){r=0;return r|0}if(((p[e+2>>0]|0)<<8|(p[e+3>>0]|0))>>>0<74){r=0;return r|0}if(((p[e+7>>0]|0)<<16|(p[e+6>>0]|0)<<24|(p[e+8>>0]|0)<<8|(p[e+9>>0]|0))>>>0>t>>>0){r=0;return r|0}h[r+4>>2]=(p[e+12>>0]|0)<<8|(p[e+13>>0]|0);h[r+8>>2]=(p[e+14>>0]|0)<<8|(p[e+15>>0]|0);h[r+12>>2]=p[e+16>>0];h[r+16>>2]=p[e+17>>0];t=e+18|0;i=r+32|0;h[i>>2]=p[t>>0];h[i+4>>2]=0;t=d[t>>0]|0;h[r+20>>2]=t<<24>>24==0|t<<24>>24==9?8:16;h[r+24>>2]=(p[e+26>>0]|0)<<16|(p[e+25>>0]|0)<<24|(p[e+27>>0]|0)<<8|(p[e+28>>0]|0);h[r+28>>2]=(p[e+30>>0]|0)<<16|(p[e+29>>0]|0)<<24|(p[e+31>>0]|0)<<8|(p[e+32>>0]|0);r=1;return r|0}function st(e){e=e|0;Ge(e|0)|0;Vt()}function ut(e){e=e|0;var t=0,r=0,i=0,n=0,a=0;a=w;w=w+528|0;n=a;i=a+16|0;t=h[e+20>>2]|0;if(t)lt(t);t=e+4|0;r=h[t>>2]|0;if(!r){n=e+16|0;d[n>>0]=0;w=a;return}if(!(r&7))at(r,0,0,1,0)|0;else{h[n>>2]=1138;h[n+4>>2]=2502;h[n+8>>2]=1504;yr(i,1084,n)|0;gr(i)|0}h[t>>2]=0;h[e+8>>2]=0;h[e+12>>2]=0;n=e+16|0;d[n>>0]=0;w=a;return}function lt(e){e=e|0;var t=0,r=0,i=0,n=0,a=0,o=0,s=0,u=0,l=0;u=w;w=w+592|0;o=u+64|0;a=u+48|0;s=u+32|0;i=u+16|0;r=u;n=u+80|0;if(!e){w=u;return}t=h[e+168>>2]|0;do{if(t){l=h[t+-4>>2]|0;t=t+-8|0;if(!((l|0)!=0?(l|0)==(~h[t>>2]|0):0)){h[r>>2]=1138;h[r+4>>2]=647;h[r+8>>2]=1851;yr(n,1084,r)|0;gr(n)|0}if(!(t&7)){at(t,0,0,1,0)|0;break}else{h[i>>2]=1138;h[i+4>>2]=2502;h[i+8>>2]=1504;yr(n,1084,i)|0;gr(n)|0;break}}}while(0);t=h[e+176>>2]|0;do{if(t){l=h[t+-4>>2]|0;t=t+-8|0;if(!((l|0)!=0?(l|0)==(~h[t>>2]|0):0)){h[s>>2]=1138;h[s+4>>2]=647;h[s+8>>2]=1851;yr(n,1084,s)|0;gr(n)|0}if(!(t&7)){at(t,0,0,1,0)|0;break}else{h[a>>2]=1138;h[a+4>>2]=2502;h[a+8>>2]=1504;yr(n,1084,a)|0;gr(n)|0;break}}}while(0);if(!(e&7)){at(e,0,0,1,0)|0;w=u;return}else{h[o>>2]=1138;h[o+4>>2]=2502;h[o+8>>2]=1504;yr(n,1084,o)|0;gr(n)|0;w=u;return}}function ct(e){e=e|0;var t=0,r=0,i=0,n=0,a=0,o=0,s=0,u=0;u=w;w=w+544|0;o=u+16|0;t=u;a=u+32|0;n=e+8|0;r=h[n>>2]|0;if((r+-1|0)>>>0>=8192){h[t>>2]=1138;h[t+4>>2]=3002;h[t+8>>2]=1529;yr(a,1084,t)|0;gr(a)|0}h[e>>2]=r;i=e+20|0;t=h[i>>2]|0;if(!t){t=it(180,0)|0;if(!t)t=0;else{s=t+164|0;h[s>>2]=0;h[s+4>>2]=0;h[s+8>>2]=0;h[s+12>>2]=0}h[i>>2]=t;s=h[e>>2]|0}else s=r;if(!(h[n>>2]|0)){h[o>>2]=1138;h[o+4>>2]=906;h[o+8>>2]=1769;yr(a,1084,o)|0;gr(a)|0;o=h[e>>2]|0}else o=s;a=h[e+4>>2]|0;if(o>>>0>16){i=o;r=0}else{e=0;e=nt(t,s,a,e)|0;w=u;return e|0}while(1){n=r+1|0;if(i>>>0>3){i=i>>>1;r=n}else{i=n;break}}e=r+2+((i|0)!=32&1<<i>>>0<o>>>0&1)|0;e=e>>>0<11?e&255:11;e=nt(t,s,a,e)|0;w=u;return e|0}function dt(e,t){e=e|0;t=t|0;var r=0,i=0,n=0,a=0,o=0,s=0,u=0,l=0,c=0,f=0,m=0,v=0,_=0,g=0,y=0,C=0,b=0,S=0,E=0,T=0,x=0,A=0,P=0,D=0,M=0;M=w;w=w+720|0;T=M+160|0;E=M+144|0;S=M+128|0;b=M+112|0;C=M+96|0;y=M+80|0;g=M+64|0;_=M+48|0;c=M+32|0;s=M+16|0;n=M;P=M+200|0;D=M+176|0;x=ft(e,14)|0;if(!x){h[t>>2]=0;r=t+4|0;i=h[r>>2]|0;if(i){if(!(i&7))at(i,0,0,1,0)|0;else{h[n>>2]=1138;h[n+4>>2]=2502;h[n+8>>2]=1504;yr(P,1084,n)|0;gr(P)|0}h[r>>2]=0;h[t+8>>2]=0;h[t+12>>2]=0}d[t+16>>0]=0;r=t+20|0;i=h[r>>2]|0;if(!i){t=1;w=M;return t|0}lt(i);h[r>>2]=0;t=1;w=M;return t|0}m=t+4|0;v=t+8|0;r=h[v>>2]|0;if((r|0)!=(x|0)){if(r>>>0<=x>>>0){do{if((h[t+12>>2]|0)>>>0<x>>>0){if(tt(m,x,(r+1|0)==(x|0),1,0)|0){r=h[v>>2]|0;break}d[t+16>>0]=1;t=0;w=M;return t|0}}while(0);Xr((h[m>>2]|0)+r|0,0,x-r|0)|0}h[v>>2]=x}Xr(h[m>>2]|0,0,x|0)|0;f=e+20|0;r=h[f>>2]|0;if((r|0)<5){a=e+4|0;o=e+8|0;n=e+16|0;do{i=h[a>>2]|0;if((i|0)==(h[o>>2]|0))i=0;else{h[a>>2]=i+1;i=p[i>>0]|0}r=r+8|0;h[f>>2]=r;if((r|0)>=33){h[s>>2]=1138;h[s+4>>2]=3204;h[s+8>>2]=1638;yr(P,1084,s)|0;gr(P)|0;r=h[f>>2]|0}i=i<<32-r|h[n>>2];h[n>>2]=i}while((r|0)<5)}else{i=e+16|0;n=i;i=h[i>>2]|0}l=i>>>27;h[n>>2]=i<<5;h[f>>2]=r+-5;if((l+-1|0)>>>0>20){t=0;w=M;return t|0}h[D+20>>2]=0;h[D>>2]=0;h[D+4>>2]=0;h[D+8>>2]=0;h[D+12>>2]=0;d[D+16>>0]=0;r=D+4|0;i=D+8|0;e:do{if(tt(r,21,0,1,0)|0){s=h[i>>2]|0;u=h[r>>2]|0;Xr(u+s|0,0,21-s|0)|0;h[i>>2]=21;if(l){n=e+4|0;a=e+8|0;o=e+16|0;s=0;do{r=h[f>>2]|0;if((r|0)<3)do{i=h[n>>2]|0;if((i|0)==(h[a>>2]|0))i=0;else{h[n>>2]=i+1;i=p[i>>0]|0}r=r+8|0;h[f>>2]=r;if((r|0)>=33){h[c>>2]=1138;h[c+4>>2]=3204;h[c+8>>2]=1638;yr(P,1084,c)|0;gr(P)|0;r=h[f>>2]|0}i=i<<32-r|h[o>>2];h[o>>2]=i}while((r|0)<3);else i=h[o>>2]|0;h[o>>2]=i<<3;h[f>>2]=r+-3;d[u+(p[1599+s>>0]|0)>>0]=i>>>29;s=s+1|0
}while((s|0)!=(l|0))}if(ct(D)|0){l=e+4|0;s=e+8|0;u=e+16|0;i=0;t:while(1){o=x-i|0;r=ht(e,D)|0;r:do{if(r>>>0<17){if((h[v>>2]|0)>>>0<=i>>>0){h[_>>2]=1138;h[_+4>>2]=906;h[_+8>>2]=1769;yr(P,1084,_)|0;gr(P)|0}d[(h[m>>2]|0)+i>>0]=r;r=i+1|0}else switch(r|0){case 17:{r=h[f>>2]|0;if((r|0)<3)do{n=h[l>>2]|0;if((n|0)==(h[s>>2]|0))n=0;else{h[l>>2]=n+1;n=p[n>>0]|0}r=r+8|0;h[f>>2]=r;if((r|0)>=33){h[g>>2]=1138;h[g+4>>2]=3204;h[g+8>>2]=1638;yr(P,1084,g)|0;gr(P)|0;r=h[f>>2]|0}n=n<<32-r|h[u>>2];h[u>>2]=n}while((r|0)<3);else n=h[u>>2]|0;h[u>>2]=n<<3;h[f>>2]=r+-3;r=(n>>>29)+3|0;if(r>>>0>o>>>0){r=0;break e}r=r+i|0;break r}case 18:{r=h[f>>2]|0;if((r|0)<7)do{n=h[l>>2]|0;if((n|0)==(h[s>>2]|0))n=0;else{h[l>>2]=n+1;n=p[n>>0]|0}r=r+8|0;h[f>>2]=r;if((r|0)>=33){h[y>>2]=1138;h[y+4>>2]=3204;h[y+8>>2]=1638;yr(P,1084,y)|0;gr(P)|0;r=h[f>>2]|0}n=n<<32-r|h[u>>2];h[u>>2]=n}while((r|0)<7);else n=h[u>>2]|0;h[u>>2]=n<<7;h[f>>2]=r+-7;r=(n>>>25)+11|0;if(r>>>0>o>>>0){r=0;break e}r=r+i|0;break r}default:{if((r+-19|0)>>>0>=2){A=90;break t}a=h[f>>2]|0;if((r|0)==19){if((a|0)<2){n=a;while(1){r=h[l>>2]|0;if((r|0)==(h[s>>2]|0))a=0;else{h[l>>2]=r+1;a=p[r>>0]|0}r=n+8|0;h[f>>2]=r;if((r|0)>=33){h[C>>2]=1138;h[C+4>>2]=3204;h[C+8>>2]=1638;yr(P,1084,C)|0;gr(P)|0;r=h[f>>2]|0}n=a<<32-r|h[u>>2];h[u>>2]=n;if((r|0)<2)n=r;else break}}else{n=h[u>>2]|0;r=a}h[u>>2]=n<<2;h[f>>2]=r+-2;a=(n>>>30)+3|0}else{if((a|0)<6){n=a;while(1){r=h[l>>2]|0;if((r|0)==(h[s>>2]|0))a=0;else{h[l>>2]=r+1;a=p[r>>0]|0}r=n+8|0;h[f>>2]=r;if((r|0)>=33){h[b>>2]=1138;h[b+4>>2]=3204;h[b+8>>2]=1638;yr(P,1084,b)|0;gr(P)|0;r=h[f>>2]|0}n=a<<32-r|h[u>>2];h[u>>2]=n;if((r|0)<6)n=r;else break}}else{n=h[u>>2]|0;r=a}h[u>>2]=n<<6;h[f>>2]=r+-6;a=(n>>>26)+7|0}if((i|0)==0|a>>>0>o>>>0){r=0;break e}r=i+-1|0;if((h[v>>2]|0)>>>0<=r>>>0){h[S>>2]=1138;h[S+4>>2]=906;h[S+8>>2]=1769;yr(P,1084,S)|0;gr(P)|0}n=d[(h[m>>2]|0)+r>>0]|0;if(!(n<<24>>24)){r=0;break e}r=a+i|0;if(i>>>0>=r>>>0){r=i;break r}do{if((h[v>>2]|0)>>>0<=i>>>0){h[E>>2]=1138;h[E+4>>2]=906;h[E+8>>2]=1769;yr(P,1084,E)|0;gr(P)|0}d[(h[m>>2]|0)+i>>0]=n;i=i+1|0}while((i|0)!=(r|0))}}}while(0);if(x>>>0>r>>>0)i=r;else break}if((A|0)==90){h[T>>2]=1138;h[T+4>>2]=3145;h[T+8>>2]=1620;yr(P,1084,T)|0;gr(P)|0;r=0;break}if((x|0)==(r|0))r=ct(t)|0;else r=0}else r=0}else{d[D+16>>0]=1;r=0}}while(0);ut(D);t=r;w=M;return t|0}function ft(e,t){e=e|0;t=t|0;var r=0,i=0,n=0,a=0,o=0,s=0,u=0,l=0;l=w;w=w+528|0;o=l;a=l+16|0;if(!t){u=0;w=l;return u|0}if(t>>>0<=16){u=pt(e,t)|0;w=l;return u|0}s=pt(e,t+-16|0)|0;u=e+20|0;t=h[u>>2]|0;if((t|0)<16){i=e+4|0;n=e+8|0;r=e+16|0;do{e=h[i>>2]|0;if((e|0)==(h[n>>2]|0))e=0;else{h[i>>2]=e+1;e=p[e>>0]|0}t=t+8|0;h[u>>2]=t;if((t|0)>=33){h[o>>2]=1138;h[o+4>>2]=3204;h[o+8>>2]=1638;yr(a,1084,o)|0;gr(a)|0;t=h[u>>2]|0}e=e<<32-t|h[r>>2];h[r>>2]=e}while((t|0)<16)}else{e=e+16|0;r=e;e=h[e>>2]|0}h[r>>2]=e<<16;h[u>>2]=t+-16;u=e>>>16|s<<16;w=l;return u|0}function ht(e,t){e=e|0;t=t|0;var r=0,i=0,n=0,a=0,o=0,s=0,u=0,l=0,c=0,d=0,f=0,v=0,_=0,g=0;g=w;w=w+576|0;d=g+48|0;c=g+32|0;l=g+16|0;u=g;v=g+64|0;f=h[t+20>>2]|0;_=e+20|0;s=h[_>>2]|0;do{if((s|0)<24){o=e+4|0;i=h[o>>2]|0;n=h[e+8>>2]|0;r=i>>>0<n>>>0;if((s|0)>=16){if(r){h[o>>2]=i+1;r=p[i>>0]|0}else r=0;h[_>>2]=s+8;o=e+16|0;a=r<<24-s|h[o>>2];h[o>>2]=a;break}if(r){a=(p[i>>0]|0)<<8;r=i+1|0}else{a=0;r=i}if(r>>>0<n>>>0){i=p[r>>0]|0;r=r+1|0}else i=0;h[o>>2]=r;h[_>>2]=s+16;o=e+16|0;a=(i|a)<<16-s|h[o>>2];h[o>>2]=a}else{a=e+16|0;o=a;a=h[a>>2]|0}}while(0);n=(a>>>16)+1|0;do{if(n>>>0<=(h[f+16>>2]|0)>>>0){i=h[(h[f+168>>2]|0)+(a>>>(32-(h[f+8>>2]|0)|0)<<2)>>2]|0;if((i|0)==-1){h[u>>2]=1138;h[u+4>>2]=3249;h[u+8>>2]=1665;yr(v,1084,u)|0;gr(v)|0}r=i&65535;i=i>>>16;if((h[t+8>>2]|0)>>>0<=r>>>0){h[l>>2]=1138;h[l+4>>2]=905;h[l+8>>2]=1769;yr(v,1084,l)|0;gr(v)|0}if((p[(h[t+4>>2]|0)+r>>0]|0|0)!=(i|0)){h[c>>2]=1138;h[c+4>>2]=3253;h[c+8>>2]=1682;yr(v,1084,c)|0;gr(v)|0}}else{i=h[f+20>>2]|0;while(1){r=i+-1|0;if(n>>>0>(h[f+28+(r<<2)>>2]|0)>>>0)i=i+1|0;else break}r=(a>>>(32-i|0))+(h[f+96+(r<<2)>>2]|0)|0;if(r>>>0<(h[t>>2]|0)>>>0){r=m[(h[f+176>>2]|0)+(r<<1)>>1]|0;break}h[d>>2]=1138;h[d+4>>2]=3271;h[d+8>>2]=1620;yr(v,1084,d)|0;gr(v)|0;_=0;w=g;return _|0}}while(0);h[o>>2]=h[o>>2]<<i;h[_>>2]=(h[_>>2]|0)-i;_=r;w=g;return _|0}function pt(e,t){e=e|0;t=t|0;var r=0,i=0,n=0,a=0,o=0,s=0,u=0,l=0;l=w;w=w+544|0;s=l+16|0;r=l;o=l+32|0;if(t>>>0>=33){h[r>>2]=1138;h[r+4>>2]=3195;h[r+8>>2]=1622;yr(o,1084,r)|0;gr(o)|0}u=e+20|0;r=h[u>>2]|0;if((r|0)>=(t|0)){n=e+16|0;a=n;n=h[n>>2]|0;o=r;s=32-t|0;s=n>>>s;n=n<<t;h[a>>2]=n;t=o-t|0;h[u>>2]=t;w=l;return s|0}n=e+4|0;a=e+8|0;i=e+16|0;do{e=h[n>>2]|0;if((e|0)==(h[a>>2]|0))e=0;else{h[n>>2]=e+1;e=p[e>>0]|0}r=r+8|0;h[u>>2]=r;if((r|0)>=33){h[s>>2]=1138;h[s+4>>2]=3204;h[s+8>>2]=1638;yr(o,1084,s)|0;gr(o)|0;r=h[u>>2]|0}e=e<<32-r|h[i>>2];h[i>>2]=e}while((r|0)<(t|0));s=32-t|0;s=e>>>s;o=e<<t;h[i>>2]=o;t=r-t|0;h[u>>2]=t;w=l;return s|0}function mt(e,t){e=e|0;t=t|0;var r=0,i=0,n=0,a=0,o=0,s=0,u=0,l=0,c=0,f=0,m=0,v=0,_=0,g=0;v=w;w=w+528|0;f=v;c=v+16|0;if((e|0)==0|t>>>0<62){m=0;w=v;return m|0}l=it(300,0)|0;if(!l){m=0;w=v;return m|0}h[l>>2]=519686845;r=l+4|0;h[r>>2]=0;i=l+8|0;h[i>>2]=0;u=l+88|0;n=l+136|0;a=l+160|0;o=u;s=o+44|0;do{h[o>>2]=0;o=o+4|0}while((o|0)<(s|0));d[u+44>>0]=0;_=l+184|0;o=l+208|0;s=l+232|0;g=l+252|0;h[g>>2]=0;h[g+4>>2]=0;h[g+8>>2]=0;d[g+12>>0]=0;g=l+268|0;h[g>>2]=0;h[g+4>>2]=0;h[g+8>>2]=0;d[g+12>>0]=0;g=l+284|0;h[g>>2]=0;h[g+4>>2]=0;h[g+8>>2]=0;d[g+12>>0]=0;h[n>>2]=0;h[n+4>>2]=0;h[n+8>>2]=0;h[n+12>>2]=0;h[n+16>>2]=0;d[n+20>>0]=0;h[a>>2]=0;h[a+4>>2]=0;h[a+8>>2]=0;h[a+12>>2]=0;h[a+16>>2]=0;d[a+20>>0]=0;h[_>>2]=0;h[_+4>>2]=0;h[_+8>>2]=0;h[_+12>>2]=0;h[_+16>>2]=0;d[_+20>>0]=0;h[o>>2]=0;h[o+4>>2]=0;h[o+8>>2]=0;h[o+12>>2]=0;h[o+16>>2]=0;d[o+20>>0]=0;h[s>>2]=0;h[s+4>>2]=0;h[s+8>>2]=0;h[s+12>>2]=0;d[s+16>>0]=0;do{if(((t>>>0>=74?((p[e>>0]|0)<<8|(p[e+1>>0]|0)|0)==18552:0)?((p[e+2>>0]|0)<<8|(p[e+3>>0]|0))>>>0>=74:0)?((p[e+7>>0]|0)<<16|(p[e+6>>0]|0)<<24|(p[e+8>>0]|0)<<8|(p[e+9>>0]|0))>>>0<=t>>>0:0){h[u>>2]=e;h[r>>2]=e;h[i>>2]=t;if(Tt(l)|0){r=h[u>>2]|0;if((p[r+39>>0]|0)<<8|(p[r+40>>0]|0)){if(!(xt(l)|0))break;if(!(At(l)|0))break;r=h[u>>2]|0}if(!((p[r+55>>0]|0)<<8|(p[r+56>>0]|0))){g=l;w=v;return g|0}if(Pt(l)|0?Dt(l)|0:0){g=l;w=v;return g|0}}}else m=7}while(0);if((m|0)==7)h[u>>2]=0;Nt(l);if(!(l&7)){at(l,0,0,1,0)|0;g=0;w=v;return g|0}else{h[f>>2]=1138;h[f+4>>2]=2502;h[f+8>>2]=1504;yr(c,1084,f)|0;gr(c)|0;g=0;w=v;return g|0}return 0}function vt(e,t,r,i,n){e=e|0;t=t|0;r=r|0;i=i|0;n=n|0;var a=0,o=0,s=0,u=0,l=0,c=0;c=w;w=w+528|0;l=c;u=c+16|0;a=h[e+88>>2]|0;s=(p[a+70+(n<<2)+1>>0]|0)<<16|(p[a+70+(n<<2)>>0]|0)<<24|(p[a+70+(n<<2)+2>>0]|0)<<8|(p[a+70+(n<<2)+3>>0]|0);o=n+1|0;if(o>>>0<(p[a+16>>0]|0)>>>0)a=(p[a+70+(o<<2)+1>>0]|0)<<16|(p[a+70+(o<<2)>>0]|0)<<24|(p[a+70+(o<<2)+2>>0]|0)<<8|(p[a+70+(o<<2)+3>>0]|0);else a=h[e+8>>2]|0;if(a>>>0>s>>>0){u=e+4|0;u=h[u>>2]|0;u=u+s|0;l=a-s|0;l=_t(e,u,l,t,r,i,n)|0;w=c;return l|0}h[l>>2]=1138;h[l+4>>2]=3690;h[l+8>>2]=1780;yr(u,1084,l)|0;gr(u)|0;u=e+4|0;u=h[u>>2]|0;u=u+s|0;l=a-s|0;l=_t(e,u,l,t,r,i,n)|0;w=c;return l|0}function _t(e,t,r,i,n,a,o){e=e|0;t=t|0;r=r|0;i=i|0;n=n|0;a=a|0;o=o|0;var s=0,u=0,l=0,c=0;c=h[e+88>>2]|0;u=((p[c+12>>0]|0)<<8|(p[c+13>>0]|0))>>>o;l=((p[c+14>>0]|0)<<8|(p[c+15>>0]|0))>>>o;u=u>>>0>1?(u+3|0)>>>2:1;l=l>>>0>1?(l+3|0)>>>2:1;c=c+18|0;o=d[c>>0]|0;o=ce(o<<24>>24==0|o<<24>>24==9?8:16,u)|0;if(a)if((a&3|0)==0&o>>>0<=a>>>0)o=a;else{e=0;return e|0}if((ce(o,l)|0)>>>0>n>>>0){e=0;return e|0}a=(u+1|0)>>>1;s=(l+1|0)>>>1;if(!r){e=0;return e|0}h[e+92>>2]=t;h[e+96>>2]=t;h[e+104>>2]=r;h[e+100>>2]=t+r;h[e+108>>2]=0;h[e+112>>2]=0;switch(p[c>>0]|0|0){case 0:{Mt(e,i,n,o,u,l,a,s)|0;e=1;return e|0}case 4:case 6:case 5:case 3:case 2:{It(e,i,n,o,u,l,a,s)|0;e=1;return e|0}case 9:{Ot(e,i,n,o,u,l,a,s)|0;e=1;return e|0}case 8:case 7:{Rt(e,i,n,o,u,l,a,s)|0;e=1;return e|0}default:{e=0;return e|0}}return 0}function gt(e,t){e=e|0;t=t|0;var r=0,i=0;i=w;w=w+48|0;r=i;h[r>>2]=40;ot(e,t,r)|0;w=i;return h[r+4>>2]|0}function yt(e,t){e=e|0;t=t|0;var r=0,i=0;i=w;w=w+48|0;r=i;h[r>>2]=40;ot(e,t,r)|0;w=i;return h[r+8>>2]|0}function wt(e,t){e=e|0;t=t|0;var r=0,i=0;i=w;w=w+48|0;r=i;h[r>>2]=40;ot(e,t,r)|0;w=i;return h[r+12>>2]|0}function Ct(e,t){e=e|0;t=t|0;var r=0,i=0;i=w;w=w+48|0;r=i;h[r>>2]=40;ot(e,t,r)|0;w=i;return h[r+32>>2]|0}function bt(e,t){e=e|0;t=t|0;var r=0,i=0,n=0,a=0;n=w;w=w+576|0;i=n+40|0;r=n+56|0;a=n;h[a>>2]=40;ot(e,t,a)|0;t=a+32|0;e=h[t+4>>2]|0;do{switch(h[t>>2]|0){case 0:{if(!e){a=8;w=n;return a|0}else e=14;break}case 1:{if(!e)e=13;else e=14;break}case 2:{if(!e)e=13;else e=14;break}case 3:{if(!e)e=13;else e=14;break}case 4:{if(!e)e=13;else e=14;break}case 5:{if(!e)e=13;else e=14;break}case 6:{if(!e)e=13;else e=14;break}case 7:{if(!e)e=13;else e=14;break}case 8:{if(!e)e=13;else e=14;break}case 9:{if(!e){a=8;w=n;return a|0}else e=14;break}case 10:{if(!e){a=8;w=n;return a|0}else e=14;break}default:e=14}}while(0);if((e|0)==13){a=16;w=n;return a|0}else if((e|0)==14){h[i>>2]=1138;h[i+4>>2]=2668;h[i+8>>2]=1523;yr(r,1084,i)|0;gr(r)|0;a=0;w=n;return a|0}return 0}function St(e,t,r){e=e|0;t=t|0;r=r|0;var i=0,n=0,a=0,o=0,s=0,u=0;s=w;w=w+576|0;a=s+40|0;n=s+56|0;u=s;h[u>>2]=40;ot(e,t,u)|0;i=(((h[u+4>>2]|0)>>>r)+3|0)>>>2;t=(((h[u+8>>2]|0)>>>r)+3|0)>>>2;r=u+32|0;e=h[r+4>>2]|0;do{switch(h[r>>2]|0){case 0:{if(!e)e=8;else o=14;break}case 1:{if(!e)o=13;else o=14;break}case 2:{if(!e)o=13;else o=14;break}case 3:{if(!e)o=13;else o=14;break}case 4:{if(!e)o=13;else o=14;break}case 5:{if(!e)o=13;else o=14;break}case 6:{if(!e)o=13;else o=14;break}case 7:{if(!e)o=13;else o=14;break}case 8:{if(!e)o=13;else o=14;break}case 9:{if(!e)e=8;else o=14;break}case 10:{if(!e)e=8;else o=14;break}default:o=14}}while(0);if((o|0)==13)e=16;else if((o|0)==14){h[a>>2]=1138;h[a+4>>2]=2668;h[a+8>>2]=1523;yr(n,1084,a)|0;gr(n)|0;e=0}u=ce(ce(t,i)|0,e)|0;w=s;return u|0}function Et(e,t,r,i,n,a){e=e|0;t=t|0;r=r|0;i=i|0;n=n|0;a=a|0;var o=0,s=0,u=0,l=0,c=0,d=0,f=0,p=0,m=0,v=0;v=w;w=w+592|0;m=v+56|0;o=v+40|0;f=v+72|0;d=v;p=v+68|0;h[d>>2]=40;ot(e,t,d)|0;s=(h[d+4>>2]|0)>>>n;u=(h[d+8>>2]|0)>>>n;d=d+32|0;i=h[d+4>>2]|0;do{switch(h[d>>2]|0){case 0:{if(!i)d=8;else l=14;break}case 1:{if(!i)l=13;else l=14;break}case 2:{if(!i)l=13;else l=14;break}case 3:{if(!i)l=13;else l=14;break}case 4:{if(!i)l=13;else l=14;break}case 5:{if(!i)l=13;else l=14;break}case 6:{if(!i)l=13;else l=14;break}case 7:{if(!i)l=13;else l=14;break}case 8:{if(!i)l=13;else l=14;break}case 9:{if(!i)d=8;else l=14;break}case 10:{if(!i)d=8;else l=14;break}default:l=14}}while(0);if((l|0)==13)d=16;else if((l|0)==14){h[o>>2]=1138;h[o+4>>2]=2668;h[o+8>>2]=1523;yr(f,1084,o)|0;gr(f)|0;d=0}h[p>>2]=r;c=mt(e,t)|0;t=a+n|0;if(t>>>0>n>>>0){l=(c|0)==0;e=r;while(1){i=ce((s+3|0)>>>2,d)|0;o=ce(i,(u+3|0)>>>2)|0;if(!(n>>>0>15|(l|o>>>0<8))?(h[c>>2]|0)==519686845:0)vt(c,p,o,i,n)|0;e=e+o|0;h[p>>2]=e;n=n+1|0;if((n|0)==(t|0))break;else{u=u>>>1;s=s>>>1}}}if(!c){w=v;return}if((h[c>>2]|0)!=519686845){w=v;return}Nt(c);if(!(c&7)){at(c,0,0,1,0)|0;w=v;return}else{h[m>>2]=1138;h[m+4>>2]=2502;h[m+8>>2]=1504;yr(f,1084,m)|0;gr(f)|0;w=v;return}}function Tt(e){e=e|0;var t=0,r=0,i=0,n=0,a=0,o=0;o=e+92|0;i=h[e+4>>2]|0;a=e+88|0;n=h[a>>2]|0;t=(p[n+68>>0]|0)<<8|(p[n+67>>0]|0)<<16|(p[n+69>>0]|0);r=i+t|0;n=(p[n+65>>0]|0)<<8|(p[n+66>>0]|0);if(!n){e=0;return e|0}h[o>>2]=r;h[e+96>>2]=r;h[e+104>>2]=n;h[e+100>>2]=i+(n+t);h[e+108>>2]=0;h[e+112>>2]=0;if(!(dt(o,e+116|0)|0)){e=0;return e|0}t=h[a>>2]|0;do{if(!((p[t+39>>0]|0)<<8|(p[t+40>>0]|0))){if(!((p[t+55>>0]|0)<<8|(p[t+56>>0]|0))){e=0;return e|0}}else{if(!(dt(o,e+140|0)|0)){e=0;return e|0}if(dt(o,e+188|0)|0){t=h[a>>2]|0;break}else{e=0;return e|0}}}while(0);if((p[t+55>>0]|0)<<8|(p[t+56>>0]|0)){if(!(dt(o,e+164|0)|0)){e=0;return e|0}if(!(dt(o,e+212|0)|0)){e=0;return e|0}}e=1;return e|0}function xt(e){e=e|0;var t=0,r=0,i=0,n=0,a=0,o=0,s=0,u=0,l=0,c=0,f=0,m=0,v=0;v=w;w=w+576|0;s=v;o=v+64|0;m=v+16|0;i=e+88|0;t=h[i>>2]|0;f=(p[t+39>>0]|0)<<8|(p[t+40>>0]|0);l=e+236|0;a=e+240|0;r=h[a>>2]|0;if((r|0)!=(f|0)){if(r>>>0<=f>>>0){do{if((h[e+244>>2]|0)>>>0<f>>>0){if(tt(l,f,(r+1|0)==(f|0),4,0)|0){t=h[a>>2]|0;break}d[e+248>>0]=1;m=0;w=v;return m|0}else t=r}while(0);Xr((h[l>>2]|0)+(t<<2)|0,0,f-t<<2|0)|0;t=h[i>>2]|0}h[a>>2]=f}u=e+92|0;r=h[e+4>>2]|0;i=(p[t+34>>0]|0)<<8|(p[t+33>>0]|0)<<16|(p[t+35>>0]|0);n=r+i|0;t=(p[t+37>>0]|0)<<8|(p[t+36>>0]|0)<<16|(p[t+38>>0]|0);if(!t){m=0;w=v;return m|0}h[u>>2]=n;h[e+96>>2]=n;h[e+104>>2]=t;h[e+100>>2]=r+(t+i);h[e+108>>2]=0;h[e+112>>2]=0;h[m+20>>2]=0;h[m>>2]=0;h[m+4>>2]=0;h[m+8>>2]=0;h[m+12>>2]=0;d[m+16>>0]=0;e=m+24|0;h[m+44>>2]=0;h[e>>2]=0;h[e+4>>2]=0;h[e+8>>2]=0;h[e+12>>2]=0;d[e+16>>0]=0;if(dt(u,m)|0?(c=m+24|0,dt(u,c)|0):0){if(!(h[a>>2]|0)){h[s>>2]=1138;h[s+4>>2]=906;h[s+8>>2]=1769;yr(o,1084,s)|0;gr(o)|0}if(!f)t=1;else{i=0;n=0;a=0;t=0;o=0;e=0;s=0;r=h[l>>2]|0;while(1){i=(ht(u,m)|0)+i&31;n=(ht(u,c)|0)+n&63;a=(ht(u,m)|0)+a&31;t=(ht(u,m)|0)+t|0;o=(ht(u,c)|0)+o&63;e=(ht(u,m)|0)+e&31;h[r>>2]=n<<5|i<<11|a|t<<27|o<<21|e<<16;s=s+1|0;if((s|0)==(f|0)){t=1;break}else{t=t&31;r=r+4|0}}}}else t=0;ut(m+24|0);ut(m);m=t;w=v;return m|0}function At(e){e=e|0;var t=0,r=0,i=0,n=0,a=0,o=0,s=0,u=0,l=0,c=0,f=0,m=0,v=0,_=0,g=0,y=0,C=0,b=0,S=0,E=0,T=0,x=0,A=0,P=0,D=0,M=0,I=0;D=w;w=w+1008|0;o=D;a=D+496|0;P=D+472|0;x=D+276|0;A=D+80|0;T=D+16|0;n=h[e+88>>2]|0;E=(p[n+47>>0]|0)<<8|(p[n+48>>0]|0);S=e+92|0;t=h[e+4>>2]|0;r=(p[n+42>>0]|0)<<8|(p[n+41>>0]|0)<<16|(p[n+43>>0]|0);i=t+r|0;n=(p[n+45>>0]|0)<<8|(p[n+44>>0]|0)<<16|(p[n+46>>0]|0);if(!n){P=0;w=D;return P|0}h[S>>2]=i;h[e+96>>2]=i;h[e+104>>2]=n;h[e+100>>2]=t+(n+r);h[e+108>>2]=0;h[e+112>>2]=0;h[P+20>>2]=0;h[P>>2]=0;h[P+4>>2]=0;h[P+8>>2]=0;h[P+12>>2]=0;d[P+16>>0]=0;if(dt(S,P)|0){r=0;i=-3;n=-3;while(1){h[x+(r<<2)>>2]=i;h[A+(r<<2)>>2]=n;t=(i|0)>2;r=r+1|0;if((r|0)==49)break;else{i=t?-3:i+1|0;n=(t&1)+n|0}}t=T;r=t+64|0;do{h[t>>2]=0;t=t+4|0}while((t|0)<(r|0));b=e+252|0;r=e+256|0;t=h[r>>2]|0;e:do{if((t|0)==(E|0))s=13;else{if(t>>>0<=E>>>0){do{if((h[e+260>>2]|0)>>>0<E>>>0)if(tt(b,E,(t+1|0)==(E|0),4,0)|0){t=h[r>>2]|0;break}else{d[e+264>>0]=1;t=0;break e}}while(0);Xr((h[b>>2]|0)+(t<<2)|0,0,E-t<<2|0)|0}h[r>>2]=E;s=13}}while(0);do{if((s|0)==13){if(!E){h[o>>2]=1138;h[o+4>>2]=906;h[o+8>>2]=1769;yr(a,1084,o)|0;gr(a)|0;t=1;break}i=T+4|0;n=T+8|0;e=T+12|0;a=T+16|0;o=T+20|0;s=T+24|0;u=T+28|0;l=T+32|0;c=T+36|0;f=T+40|0;m=T+44|0;v=T+48|0;_=T+52|0;g=T+56|0;y=T+60|0;C=0;r=h[b>>2]|0;while(1){t=0;do{M=ht(S,P)|0;b=t<<1;I=T+(b<<2)|0;h[I>>2]=(h[I>>2]|0)+(h[x+(M<<2)>>2]|0)&3;b=T+((b|1)<<2)|0;h[b>>2]=(h[b>>2]|0)+(h[A+(M<<2)>>2]|0)&3;t=t+1|0}while((t|0)!=8);h[r>>2]=(p[1713+(h[i>>2]|0)>>0]|0)<<2|(p[1713+(h[T>>2]|0)>>0]|0)|(p[1713+(h[n>>2]|0)>>0]|0)<<4|(p[1713+(h[e>>2]|0)>>0]|0)<<6|(p[1713+(h[a>>2]|0)>>0]|0)<<8|(p[1713+(h[o>>2]|0)>>0]|0)<<10|(p[1713+(h[s>>2]|0)>>0]|0)<<12|(p[1713+(h[u>>2]|0)>>0]|0)<<14|(p[1713+(h[l>>2]|0)>>0]|0)<<16|(p[1713+(h[c>>2]|0)>>0]|0)<<18|(p[1713+(h[f>>2]|0)>>0]|0)<<20|(p[1713+(h[m>>2]|0)>>0]|0)<<22|(p[1713+(h[v>>2]|0)>>0]|0)<<24|(p[1713+(h[_>>2]|0)>>0]|0)<<26|(p[1713+(h[g>>2]|0)>>0]|0)<<28|(p[1713+(h[y>>2]|0)>>0]|0)<<30;C=C+1|0;if((C|0)==(E|0)){t=1;break}else r=r+4|0}}}while(0)}else t=0;ut(P);I=t;w=D;return I|0}function Pt(e){e=e|0;var t=0,r=0,i=0,n=0,a=0,o=0,s=0,u=0,l=0,c=0,m=0;m=w;w=w+560|0;s=m;o=m+40|0;c=m+16|0;n=h[e+88>>2]|0;l=(p[n+55>>0]|0)<<8|(p[n+56>>0]|0);u=e+92|0;t=h[e+4>>2]|0;r=(p[n+50>>0]|0)<<8|(p[n+49>>0]|0)<<16|(p[n+51>>0]|0);i=t+r|0;n=(p[n+53>>0]|0)<<8|(p[n+52>>0]|0)<<16|(p[n+54>>0]|0);if(!n){c=0;w=m;return c|0}h[u>>2]=i;h[e+96>>2]=i;h[e+104>>2]=n;h[e+100>>2]=t+(n+r);h[e+108>>2]=0;h[e+112>>2]=0;h[c+20>>2]=0;h[c>>2]=0;h[c+4>>2]=0;h[c+8>>2]=0;h[c+12>>2]=0;d[c+16>>0]=0;e:do{if(dt(u,c)|0){a=e+268|0;r=e+272|0;t=h[r>>2]|0;if((t|0)!=(l|0)){if(t>>>0<=l>>>0){do{if((h[e+276>>2]|0)>>>0<l>>>0)if(tt(a,l,(t+1|0)==(l|0),2,0)|0){t=h[r>>2]|0;break}else{d[e+280>>0]=1;t=0;break e}}while(0);Xr((h[a>>2]|0)+(t<<1)|0,0,l-t<<1|0)|0}h[r>>2]=l}if(!l){h[s>>2]=1138;h[s+4>>2]=906;h[s+8>>2]=1769;yr(o,1084,s)|0;gr(o)|0;t=1;break}r=0;i=0;n=0;t=h[a>>2]|0;while(1){s=ht(u,c)|0;r=s+r&255;i=(ht(u,c)|0)+i&255;f[t>>1]=i<<8|r;n=n+1|0;if((n|0)==(l|0)){t=1;break}else t=t+2|0}}else t=0}while(0);ut(c);c=t;w=m;return c|0}function Dt(e){e=e|0;var t=0,r=0,i=0,n=0,a=0,o=0,s=0,u=0,l=0,c=0,m=0,v=0,_=0,g=0,y=0,C=0,b=0,S=0,E=0,T=0,x=0,A=0,P=0,D=0,M=0,I=0,O=0;M=w;w=w+2416|0;o=M;a=M+1904|0;D=M+1880|0;A=M+980|0;P=M+80|0;x=M+16|0;n=h[e+88>>2]|0;T=(p[n+63>>0]|0)<<8|(p[n+64>>0]|0);E=e+92|0;t=h[e+4>>2]|0;r=(p[n+58>>0]|0)<<8|(p[n+57>>0]|0)<<16|(p[n+59>>0]|0);i=t+r|0;n=(p[n+61>>0]|0)<<8|(p[n+60>>0]|0)<<16|(p[n+62>>0]|0);if(!n){D=0;w=M;return D|0}h[E>>2]=i;h[e+96>>2]=i;h[e+104>>2]=n;h[e+100>>2]=t+(n+r);h[e+108>>2]=0;h[e+112>>2]=0;h[D+20>>2]=0;h[D>>2]=0;h[D+4>>2]=0;h[D+8>>2]=0;h[D+12>>2]=0;d[D+16>>0]=0;if(dt(E,D)|0){r=0;i=-7;n=-7;while(1){h[A+(r<<2)>>2]=i;h[P+(r<<2)>>2]=n;t=(i|0)>6;r=r+1|0;if((r|0)==225)break;else{i=t?-7:i+1|0;n=(t&1)+n|0}}t=x;r=t+64|0;do{h[t>>2]=0;t=t+4|0}while((t|0)<(r|0));S=e+284|0;r=T*3|0;i=e+288|0;t=h[i>>2]|0;e:do{if((t|0)==(r|0))s=13;else{if(t>>>0<=r>>>0){do{if((h[e+292>>2]|0)>>>0<r>>>0)if(tt(S,r,(t+1|0)==(r|0),2,0)|0){t=h[i>>2]|0;break}else{d[e+296>>0]=1;t=0;break e}}while(0);Xr((h[S>>2]|0)+(t<<1)|0,0,r-t<<1|0)|0}h[i>>2]=r;s=13}}while(0);do{if((s|0)==13){if(!T){h[o>>2]=1138;h[o+4>>2]=906;h[o+8>>2]=1769;yr(a,1084,o)|0;gr(a)|0;t=1;break}i=x+4|0;n=x+8|0;e=x+12|0;a=x+16|0;o=x+20|0;s=x+24|0;u=x+28|0;l=x+32|0;c=x+36|0;m=x+40|0;v=x+44|0;_=x+48|0;g=x+52|0;y=x+56|0;C=x+60|0;b=0;r=h[S>>2]|0;while(1){t=0;do{I=ht(E,D)|0;S=t<<1;O=x+(S<<2)|0;h[O>>2]=(h[O>>2]|0)+(h[A+(I<<2)>>2]|0)&7;S=x+((S|1)<<2)|0;h[S>>2]=(h[S>>2]|0)+(h[P+(I<<2)>>2]|0)&7;t=t+1|0}while((t|0)!=8);I=p[1717+(h[o>>2]|0)>>0]|0;f[r>>1]=(p[1717+(h[i>>2]|0)>>0]|0)<<3|(p[1717+(h[x>>2]|0)>>0]|0)|(p[1717+(h[n>>2]|0)>>0]|0)<<6|(p[1717+(h[e>>2]|0)>>0]|0)<<9|(p[1717+(h[a>>2]|0)>>0]|0)<<12|I<<15;O=p[1717+(h[m>>2]|0)>>0]|0;f[r+2>>1]=(p[1717+(h[s>>2]|0)>>0]|0)<<2|I>>>1|(p[1717+(h[u>>2]|0)>>0]|0)<<5|(p[1717+(h[l>>2]|0)>>0]|0)<<8|(p[1717+(h[c>>2]|0)>>0]|0)<<11|O<<14;f[r+4>>1]=(p[1717+(h[v>>2]|0)>>0]|0)<<1|O>>>2|(p[1717+(h[_>>2]|0)>>0]|0)<<4|(p[1717+(h[g>>2]|0)>>0]|0)<<7|(p[1717+(h[y>>2]|0)>>0]|0)<<10|(p[1717+(h[C>>2]|0)>>0]|0)<<13;b=b+1|0;if((b|0)==(T|0)){t=1;break}else r=r+6|0}}}while(0)}else t=0;ut(D);O=t;w=M;return O|0}function Mt(e,t,r,i,n,a,o,s){e=e|0;t=t|0;r=r|0;i=i|0;n=n|0;a=a|0;o=o|0;s=s|0;var u=0,l=0,c=0,f=0,m=0,v=0,_=0,g=0,y=0,C=0,b=0,S=0,E=0,T=0,x=0,A=0,P=0,D=0,M=0,I=0,O=0,R=0,N=0,L=0,B=0,F=0,k=0,V=0,z=0,U=0,q=0,G=0,H=0,W=0,j=0,Y=0,X=0,Z=0,K=0,Q=0,J=0,$=0,ee=0,te=0,re=0,ie=0,ne=0,ae=0,oe=0,se=0,ue=0;oe=w;w=w+656|0;ne=oe+112|0;re=oe+96|0;te=oe+80|0;ee=oe+64|0;$=oe+48|0;ae=oe+32|0;ie=oe+16|0;J=oe;K=oe+144|0;Q=oe+128|0;G=e+240|0;H=h[G>>2]|0;Y=e+256|0;X=h[Y>>2]|0;r=d[(h[e+88>>2]|0)+17>>0]|0;Z=i>>>2;if(!(r<<24>>24)){w=oe;return 1}W=(s|0)==0;j=s+-1|0;B=(a&1|0)!=0;F=i<<1;k=e+92|0;V=e+116|0;z=e+140|0;U=e+236|0;q=o+-1|0;L=(n&1|0)!=0;N=e+188|0;D=e+252|0;M=Z+1|0;I=Z+2|0;O=Z+3|0;R=q<<4;A=r&255;r=0;a=0;n=1;P=0;do{if(!W){T=h[t+(P<<2)>>2]|0;x=0;while(1){b=x&1;u=(b|0)==0;C=(b<<5^32)+-16|0;b=(b<<1^2)+-1|0;E=u?o:-1;l=u?0:q;e=(x|0)==(j|0);S=B&e;if((l|0)!=(E|0)){y=B&e^1;g=u?T:T+R|0;while(1){if((n|0)==1)n=ht(k,V)|0|512;_=n&7;n=n>>>3;u=p[1811+_>>0]|0;e=0;do{m=(ht(k,z)|0)+a|0;v=m-H|0;a=v>>31;a=a&m|v&~a;if((h[G>>2]|0)>>>0<=a>>>0){h[J>>2]=1138;h[J+4>>2]=906;h[J+8>>2]=1769;yr(K,1084,J)|0;gr(K)|0}h[Q+(e<<2)>>2]=h[(h[U>>2]|0)+(a<<2)>>2];e=e+1|0}while(e>>>0<u>>>0);v=L&(l|0)==(q|0);if(S|v){m=0;do{c=ce(m,i)|0;e=g+c|0;u=(m|0)==0|y;f=m<<1;ue=(ht(k,N)|0)+r|0;se=ue-X|0;r=se>>31;r=r&ue|se&~r;do{if(v){if(!u){se=(ht(k,N)|0)+r|0;ue=se-X|0;r=ue>>31;r=r&se|ue&~r;break}h[e>>2]=h[Q+((p[1819+(_<<2)+f>>0]|0)<<2)>>2];if((h[Y>>2]|0)>>>0<=r>>>0){h[re>>2]=1138;h[re+4>>2]=906;h[re+8>>2]=1769;yr(K,1084,re)|0;gr(K)|0}h[g+(c+4)>>2]=h[(h[D>>2]|0)+(r<<2)>>2];se=(ht(k,N)|0)+r|0;ue=se-X|0;r=ue>>31;r=r&se|ue&~r}else{if(!u){se=(ht(k,N)|0)+r|0;ue=se-X|0;r=ue>>31;r=r&se|ue&~r;break}h[e>>2]=h[Q+((p[1819+(_<<2)+f>>0]|0)<<2)>>2];if((h[Y>>2]|0)>>>0<=r>>>0){h[te>>2]=1138;h[te+4>>2]=906;h[te+8>>2]=1769;yr(K,1084,te)|0;gr(K)|0}h[g+(c+4)>>2]=h[(h[D>>2]|0)+(r<<2)>>2];se=(ht(k,N)|0)+r|0;ue=se-X|0;r=ue>>31;r=r&se|ue&~r;h[g+(c+8)>>2]=h[Q+((p[(f|1)+(1819+(_<<2))>>0]|0)<<2)>>2];if((h[Y>>2]|0)>>>0<=r>>>0){h[ne>>2]=1138;h[ne+4>>2]=906;h[ne+8>>2]=1769;yr(K,1084,ne)|0;gr(K)|0}h[g+(c+12)>>2]=h[(h[D>>2]|0)+(r<<2)>>2]}}while(0);m=m+1|0}while((m|0)!=2)}else{h[g>>2]=h[Q+((p[1819+(_<<2)>>0]|0)<<2)>>2];se=(ht(k,N)|0)+r|0;ue=se-X|0;r=ue>>31;r=r&se|ue&~r;if((h[Y>>2]|0)>>>0<=r>>>0){h[ie>>2]=1138;h[ie+4>>2]=906;h[ie+8>>2]=1769;yr(K,1084,ie)|0;gr(K)|0}h[g+4>>2]=h[(h[D>>2]|0)+(r<<2)>>2];h[g+8>>2]=h[Q+((p[1819+(_<<2)+1>>0]|0)<<2)>>2];se=(ht(k,N)|0)+r|0;ue=se-X|0;r=ue>>31;r=r&se|ue&~r;if((h[Y>>2]|0)>>>0<=r>>>0){h[ae>>2]=1138;h[ae+4>>2]=906;h[ae+8>>2]=1769;yr(K,1084,ae)|0;gr(K)|0}h[g+12>>2]=h[(h[D>>2]|0)+(r<<2)>>2];h[g+(Z<<2)>>2]=h[Q+((p[1819+(_<<2)+2>>0]|0)<<2)>>2];se=(ht(k,N)|0)+r|0;ue=se-X|0;r=ue>>31;r=r&se|ue&~r;if((h[Y>>2]|0)>>>0<=r>>>0){h[$>>2]=1138;h[$+4>>2]=906;h[$+8>>2]=1769;yr(K,1084,$)|0;gr(K)|0}h[g+(M<<2)>>2]=h[(h[D>>2]|0)+(r<<2)>>2];h[g+(I<<2)>>2]=h[Q+((p[1819+(_<<2)+3>>0]|0)<<2)>>2];se=(ht(k,N)|0)+r|0;ue=se-X|0;r=ue>>31;r=r&se|ue&~r;if((h[Y>>2]|0)>>>0<=r>>>0){h[ee>>2]=1138;h[ee+4>>2]=906;h[ee+8>>2]=1769;yr(K,1084,ee)|0;gr(K)|0}h[g+(O<<2)>>2]=h[(h[D>>2]|0)+(r<<2)>>2]}l=l+b|0;if((l|0)==(E|0))break;else g=g+C|0}}x=x+1|0;if((x|0)==(s|0))break;else T=T+F|0}}P=P+1|0}while((P|0)!=(A|0));w=oe;return 1}function It(e,t,r,i,n,a,o,s){e=e|0;t=t|0;r=r|0;i=i|0;n=n|0;a=a|0;o=o|0;s=s|0;var u=0,l=0,c=0,f=0,v=0,_=0,g=0,y=0,C=0,b=0,S=0,E=0,T=0,x=0,A=0,P=0,D=0,M=0,I=0,O=0,R=0,N=0,L=0,B=0,F=0,k=0,V=0,z=0,U=0,q=0,G=0,H=0,W=0,j=0,Y=0,X=0,Z=0,K=0,Q=0,J=0,$=0,ee=0,te=0,re=0,ie=0,ne=0,ae=0,oe=0,se=0,ue=0,le=0,ce=0,de=0,fe=0,he=0;fe=w;w=w+608|0;le=fe+48|0;de=fe+32|0;ce=fe+16|0;ue=fe;oe=fe+96|0;se=fe+80|0;ae=fe+64|0;H=e+240|0;W=h[H>>2]|0;X=e+256|0;re=h[X>>2]|0;ie=e+272|0;ne=h[ie>>2]|0;r=h[e+88>>2]|0;j=(p[r+63>>0]|0)<<8|(p[r+64>>0]|0);r=d[r+17>>0]|0;if(!(r<<24>>24)){w=fe;return 1}Y=(s|0)==0;Z=s+-1|0;K=i<<1;Q=e+92|0;J=e+116|0;$=o+-1|0;ee=e+212|0;te=e+188|0;G=(n&1|0)==0;q=(a&1|0)==0;B=e+288|0;F=e+284|0;k=e+252|0;V=e+140|0;z=e+236|0;U=e+164|0;N=e+268|0;L=$<<5;O=r&255;r=0;n=0;a=0;e=0;u=1;R=0;do{if(!Y){M=h[t+(R<<2)>>2]|0;I=0;while(1){P=I&1;l=(P|0)==0;A=(P<<6^64)+-32|0;P=(P<<1^2)+-1|0;D=l?o:-1;c=l?0:$;if((c|0)!=(D|0)){x=q|(I|0)!=(Z|0);T=l?M:M+L|0;while(1){if((u|0)==1)u=ht(Q,J)|0|512;E=u&7;u=u>>>3;f=p[1811+E>>0]|0;l=0;do{b=(ht(Q,U)|0)+n|0;S=b-ne|0;n=S>>31;n=n&b|S&~n;if((h[ie>>2]|0)>>>0<=n>>>0){h[ue>>2]=1138;h[ue+4>>2]=906;h[ue+8>>2]=1769;yr(oe,1084,ue)|0;gr(oe)|0}h[ae+(l<<2)>>2]=m[(h[N>>2]|0)+(n<<1)>>1];l=l+1|0}while(l>>>0<f>>>0);l=0;do{b=(ht(Q,V)|0)+e|0;S=b-W|0;e=S>>31;e=e&b|S&~e;if((h[H>>2]|0)>>>0<=e>>>0){h[ce>>2]=1138;h[ce+4>>2]=906;h[ce+8>>2]=1769;yr(oe,1084,ce)|0;gr(oe)|0}h[se+(l<<2)>>2]=h[(h[z>>2]|0)+(e<<2)>>2];l=l+1|0}while(l>>>0<f>>>0);S=G|(c|0)!=($|0);C=0;b=T;while(1){y=x|(C|0)==0;g=C<<1;v=0;_=b;while(1){f=(ht(Q,ee)|0)+r|0;l=f-j|0;r=l>>31;r=r&f|l&~r;l=(ht(Q,te)|0)+a|0;f=l-re|0;a=f>>31;a=a&l|f&~a;if((S|(v|0)==0)&y){l=p[v+g+(1819+(E<<2))>>0]|0;f=r*3|0;if((h[B>>2]|0)>>>0<=f>>>0){h[de>>2]=1138;h[de+4>>2]=906;h[de+8>>2]=1769;yr(oe,1084,de)|0;gr(oe)|0}he=h[F>>2]|0;h[_>>2]=(m[he+(f<<1)>>1]|0)<<16|h[ae+(l<<2)>>2];h[_+4>>2]=(m[he+(f+2<<1)>>1]|0)<<16|(m[he+(f+1<<1)>>1]|0);h[_+8>>2]=h[se+(l<<2)>>2];if((h[X>>2]|0)>>>0<=a>>>0){h[le>>2]=1138;h[le+4>>2]=906;h[le+8>>2]=1769;yr(oe,1084,le)|0;gr(oe)|0}h[_+12>>2]=h[(h[k>>2]|0)+(a<<2)>>2]}v=v+1|0;if((v|0)==2)break;else _=_+16|0}C=C+1|0;if((C|0)==2)break;else b=b+i|0}c=c+P|0;if((c|0)==(D|0))break;else T=T+A|0}}I=I+1|0;if((I|0)==(s|0))break;else M=M+K|0}}R=R+1|0}while((R|0)!=(O|0));w=fe;return 1}function Ot(e,t,r,i,n,a,o,s){e=e|0;t=t|0;r=r|0;i=i|0;n=n|0;a=a|0;o=o|0;s=s|0;var u=0,l=0,c=0,f=0,v=0,_=0,g=0,y=0,C=0,b=0,S=0,E=0,T=0,x=0,A=0,P=0,D=0,M=0,I=0,O=0,R=0,N=0,L=0,B=0,F=0,k=0,V=0,z=0,U=0,q=0,G=0,H=0,W=0,j=0,Y=0,X=0,Z=0,K=0,Q=0,J=0,$=0;$=w;w=w+576|0;J=$+32|0;Q=$+16|0;K=$;Z=$+64|0;X=$+48|0;k=e+272|0;V=h[k>>2]|0;r=h[e+88>>2]|0;z=(p[r+63>>0]|0)<<8|(p[r+64>>0]|0);r=d[r+17>>0]|0;if(!(r<<24>>24)){w=$;return 1}U=(s|0)==0;q=s+-1|0;G=i<<1;H=e+92|0;W=e+116|0;j=o+-1|0;Y=e+212|0;F=(a&1|0)==0;N=e+288|0;L=e+284|0;B=e+164|0;O=e+268|0;R=j<<4;I=r&255;M=(n&1|0)!=0;r=0;a=0;e=1;D=0;do{if(!U){A=h[t+(D<<2)>>2]|0;P=0;while(1){T=P&1;n=(T|0)==0;E=(T<<5^32)+-16|0;T=(T<<1^2)+-1|0;x=n?o:-1;u=n?0:j;if((u|0)!=(x|0)){S=F|(P|0)!=(q|0);b=n?A:A+R|0;while(1){if((e|0)==1)e=ht(H,W)|0|512;C=e&7;e=e>>>3;l=p[1811+C>>0]|0;n=0;do{g=(ht(H,B)|0)+a|0;y=g-V|0;a=y>>31;a=a&g|y&~a;if((h[k>>2]|0)>>>0<=a>>>0){h[K>>2]=1138;h[K+4>>2]=906;h[K+8>>2]=1769;yr(Z,1084,K)|0;gr(Z)|0}h[X+(n<<2)>>2]=m[(h[O>>2]|0)+(a<<1)>>1];n=n+1|0}while(n>>>0<l>>>0);y=(u|0)==(j|0)&M;_=0;g=b;while(1){v=S|(_|0)==0;f=_<<1;n=(ht(H,Y)|0)+r|0;c=n-z|0;l=c>>31;l=l&n|c&~l;if(v){r=p[1819+(C<<2)+f>>0]|0;n=l*3|0;if((h[N>>2]|0)>>>0<=n>>>0){h[Q>>2]=1138;h[Q+4>>2]=906;h[Q+8>>2]=1769;yr(Z,1084,Q)|0;gr(Z)|0}c=h[L>>2]|0;h[g>>2]=(m[c+(n<<1)>>1]|0)<<16|h[X+(r<<2)>>2];h[g+4>>2]=(m[c+(n+2<<1)>>1]|0)<<16|(m[c+(n+1<<1)>>1]|0)}c=g+8|0;n=(ht(H,Y)|0)+l|0;l=n-z|0;r=l>>31;r=r&n|l&~r;if(!(y|v^1)){n=p[(f|1)+(1819+(C<<2))>>0]|0;l=r*3|0;if((h[N>>2]|0)>>>0<=l>>>0){h[J>>2]=1138;h[J+4>>2]=906;h[J+8>>2]=1769;yr(Z,1084,J)|0;gr(Z)|0}v=h[L>>2]|0;h[c>>2]=(m[v+(l<<1)>>1]|0)<<16|h[X+(n<<2)>>2];h[g+12>>2]=(m[v+(l+2<<1)>>1]|0)<<16|(m[v+(l+1<<1)>>1]|0)}_=_+1|0;if((_|0)==2)break;else g=g+i|0}u=u+T|0;if((u|0)==(x|0))break;else b=b+E|0}}P=P+1|0;if((P|0)==(s|0))break;else A=A+G|0}}D=D+1|0}while((D|0)!=(I|0));w=$;return 1}function Rt(e,t,r,i,n,a,o,s){e=e|0;t=t|0;r=r|0;i=i|0;n=n|0;a=a|0;o=o|0;s=s|0;var u=0,l=0,c=0,f=0,v=0,_=0,g=0,y=0,C=0,b=0,S=0,E=0,T=0,x=0,A=0,P=0,D=0,M=0,I=0,O=0,R=0,N=0,L=0,B=0,F=0,k=0,V=0,z=0,U=0,q=0,G=0,H=0,W=0,j=0,Y=0,X=0,Z=0,K=0,Q=0,J=0,$=0,ee=0,te=0,re=0,ie=0,ne=0,ae=0,oe=0,se=0;se=w;w=w+608|0;ne=se+48|0;oe=se+32|0;ae=se+16|0;ie=se;re=se+96|0;ee=se+80|0;te=se+64|0;H=e+272|0;W=h[H>>2]|0;r=h[e+88>>2]|0;j=(p[r+63>>0]|0)<<8|(p[r+64>>0]|0);r=d[r+17>>0]|0;if(!(r<<24>>24)){w=se;return 1}Y=(s|0)==0;X=s+-1|0;Z=i<<1;K=e+92|0;Q=e+116|0;J=o+-1|0;$=e+212|0;G=(n&1|0)==0;q=(a&1|0)==0;V=e+288|0;z=e+284|0;U=e+164|0;F=e+268|0;k=J<<5;L=r&255;r=0;n=0;a=0;e=0;u=1;B=0;do{if(!Y){R=h[t+(B<<2)>>2]|0;N=0;while(1){I=N&1;l=(I|0)==0;M=(I<<6^64)+-32|0;I=(I<<1^2)+-1|0;O=l?o:-1;c=l?0:J;if((c|0)!=(O|0)){D=q|(N|0)!=(X|0);P=l?R:R+k|0;while(1){if((u|0)==1)u=ht(K,Q)|0|512;A=u&7;u=u>>>3;f=p[1811+A>>0]|0;l=0;do{T=(ht(K,U)|0)+e|0;x=T-W|0;e=x>>31;e=e&T|x&~e;if((h[H>>2]|0)>>>0<=e>>>0){h[ie>>2]=1138;h[ie+4>>2]=906;h[ie+8>>2]=1769;yr(re,1084,ie)|0;gr(re)|0}h[ee+(l<<2)>>2]=m[(h[F>>2]|0)+(e<<1)>>1];l=l+1|0}while(l>>>0<f>>>0);l=0;do{T=(ht(K,U)|0)+n|0;x=T-W|0;n=x>>31;n=n&T|x&~n;if((h[H>>2]|0)>>>0<=n>>>0){h[ae>>2]=1138;h[ae+4>>2]=906;h[ae+8>>2]=1769;yr(re,1084,ae)|0;gr(re)|0}h[te+(l<<2)>>2]=m[(h[F>>2]|0)+(n<<1)>>1];l=l+1|0}while(l>>>0<f>>>0);x=G|(c|0)!=(J|0);E=0;T=P;while(1){S=D|(E|0)==0;b=E<<1;y=0;C=T;while(1){g=(ht(K,$)|0)+a|0;_=g-j|0;a=_>>31;a=a&g|_&~a;_=(ht(K,$)|0)+r|0;g=_-j|0;r=g>>31;r=r&_|g&~r;if((x|(y|0)==0)&S){_=p[y+b+(1819+(A<<2))>>0]|0;g=a*3|0;l=h[V>>2]|0;if(l>>>0<=g>>>0){h[oe>>2]=1138;h[oe+4>>2]=906;h[oe+8>>2]=1769;yr(re,1084,oe)|0;gr(re)|0;l=h[V>>2]|0}f=h[z>>2]|0;v=r*3|0;if(l>>>0>v>>>0)l=f;else{h[ne>>2]=1138;h[ne+4>>2]=906;h[ne+8>>2]=1769;yr(re,1084,ne)|0;gr(re)|0;l=h[z>>2]|0}h[C>>2]=(m[f+(g<<1)>>1]|0)<<16|h[ee+(_<<2)>>2];h[C+4>>2]=(m[f+(g+2<<1)>>1]|0)<<16|(m[f+(g+1<<1)>>1]|0);h[C+8>>2]=(m[l+(v<<1)>>1]|0)<<16|h[te+(_<<2)>>2];h[C+12>>2]=(m[l+(v+2<<1)>>1]|0)<<16|(m[l+(v+1<<1)>>1]|0)}y=y+1|0;if((y|0)==2)break;else C=C+16|0}E=E+1|0;if((E|0)==2)break;else T=T+i|0}c=c+I|0;if((c|0)==(O|0))break;else P=P+M|0}}N=N+1|0;if((N|0)==(s|0))break;else R=R+Z|0}}B=B+1|0}while((B|0)!=(L|0));w=se;return 1}function Nt(e){e=e|0;var t=0,r=0,i=0,n=0,a=0,o=0,s=0,u=0;u=w;w=w+576|0;s=u+48|0;a=u+32|0;n=u+16|0;i=u;o=u+64|0;h[e>>2]=0;t=e+284|0;r=h[t>>2]|0;if(r){if(!(r&7))at(r,0,0,1,0)|0;else{h[i>>2]=1138;h[i+4>>2]=2502;h[i+8>>2]=1504;yr(o,1084,i)|0;gr(o)|0}h[t>>2]=0;h[e+288>>2]=0;h[e+292>>2]=0}d[e+296>>0]=0;r=e+268|0;t=h[r>>2]|0;if(t){if(!(t&7))at(t,0,0,1,0)|0;else{h[n>>2]=1138;h[n+4>>2]=2502;h[n+8>>2]=1504;yr(o,1084,n)|0;gr(o)|0}h[r>>2]=0;h[e+272>>2]=0;h[e+276>>2]=0}d[e+280>>0]=0;t=e+252|0;r=h[t>>2]|0;if(r){if(!(r&7))at(r,0,0,1,0)|0;else{h[a>>2]=1138;h[a+4>>2]=2502;h[a+8>>2]=1504;yr(o,1084,a)|0;gr(o)|0}h[t>>2]=0;h[e+256>>2]=0;h[e+260>>2]=0}d[e+264>>0]=0;t=e+236|0;r=h[t>>2]|0;if(!r){s=e+248|0;d[s>>0]=0;s=e+212|0;ut(s);s=e+188|0;ut(s);s=e+164|0;ut(s);s=e+140|0;ut(s);s=e+116|0;ut(s);w=u;return}if(!(r&7))at(r,0,0,1,0)|0;else{h[s>>2]=1138;h[s+4>>2]=2502;h[s+8>>2]=1504;yr(o,1084,s)|0;gr(o)|0}h[t>>2]=0;h[e+240>>2]=0;h[e+244>>2]=0;s=e+248|0;d[s>>0]=0;s=e+212|0;ut(s);s=e+188|0;ut(s);s=e+164|0;ut(s);s=e+140|0;ut(s);s=e+116|0;ut(s);w=u;return}function Lt(e,t){e=e|0;t=t|0;var r=0;r=w;w=w+16|0;h[r>>2]=t;t=h[60]|0;wr(t,e,r)|0;pr(10,t)|0;De()}function Bt(){var e=0,t=0;e=w;w=w+16|0;if(!(Ve(192,2)|0)){t=Ee(h[47]|0)|0;w=e;return t|0}else Lt(2078,e);return 0}function Ft(e){e=e|0;zr(e);return}function kt(e){e=e|0;var t=0;t=w;w=w+16|0;Pi[e&3]();Lt(2127,t)}function Vt(){var e=0,t=0;e=Bt()|0;if(((e|0)!=0?(t=h[e>>2]|0,(t|0)!=0):0)?(e=t+48|0,(h[e>>2]&-256|0)==1126902528?(h[e+4>>2]|0)==1129074247:0):0)kt(h[t+12>>2]|0);t=h[26]|0;h[26]=t+0;kt(t)}function zt(e){e=e|0;return}function Ut(e){e=e|0;return}function qt(e){e=e|0;return}function Gt(e){e=e|0;return}function Ht(e){e=e|0;Ft(e);return}function Wt(e){e=e|0;Ft(e);return}function jt(e,t,r){e=e|0;t=t|0;r=r|0;var i=0,n=0,a=0,o=0;o=w;w=w+64|0;a=o;if((e|0)!=(t|0))if((t|0)!=0?(n=Kt(t,24,40,0)|0,(n|0)!=0):0){t=a;i=t+56|0;do{h[t>>2]=0;t=t+4|0}while((t|0)<(i|0));h[a>>2]=n;h[a+8>>2]=e;h[a+12>>2]=-1;h[a+48>>2]=1;Mi[h[(h[n>>2]|0)+28>>2]&3](n,a,h[r>>2]|0,1);if((h[a+24>>2]|0)==1){h[r>>2]=h[a+16>>2];t=1}else t=0}else t=0;else t=1;w=o;return t|0}function Yt(e,t,r,i){e=e|0;t=t|0;r=r|0;i=i|0;var n=0;e=t+16|0;n=h[e>>2]|0;do{if(n){if((n|0)!=(r|0)){i=t+36|0;h[i>>2]=(h[i>>2]|0)+1;h[t+24>>2]=2;d[t+54>>0]=1;break}e=t+24|0;if((h[e>>2]|0)==2)h[e>>2]=i}else{h[e>>2]=r;h[t+24>>2]=i;h[t+36>>2]=1}}while(0);return}function Xt(e,t,r,i){e=e|0;t=t|0;r=r|0;i=i|0;if((e|0)==(h[t+8>>2]|0))Yt(0,t,r,i);return}function Zt(e,t,r,i){e=e|0;t=t|0;r=r|0;i=i|0;if((e|0)==(h[t+8>>2]|0))Yt(0,t,r,i);else{e=h[e+8>>2]|0;Mi[h[(h[e>>2]|0)+28>>2]&3](e,t,r,i)}return}function Kt(e,t,r,i){e=e|0;t=t|0;r=r|0;i=i|0;var n=0,a=0,o=0,s=0,u=0,l=0,c=0,p=0,m=0,v=0;v=w;w=w+64|0;m=v;p=h[e>>2]|0;c=e+(h[p+-8>>2]|0)|0;p=h[p+-4>>2]|0;h[m>>2]=r;h[m+4>>2]=e;h[m+8>>2]=t;h[m+12>>2]=i;i=m+16|0;e=m+20|0;t=m+24|0;n=m+28|0;a=m+32|0;o=m+40|0;s=(p|0)==(r|0);u=i;l=u+36|0;do{h[u>>2]=0;u=u+4|0}while((u|0)<(l|0));f[i+36>>1]=0;d[i+38>>0]=0;e:do{if(s){h[m+48>>2]=1;Di[h[(h[r>>2]|0)+20>>2]&3](r,m,c,c,1,0);i=(h[t>>2]|0)==1?c:0}else{Ei[h[(h[p>>2]|0)+24>>2]&3](p,m,c,1,0);switch(h[m+36>>2]|0){case 0:{i=(h[o>>2]|0)==1&(h[n>>2]|0)==1&(h[a>>2]|0)==1?h[e>>2]|0:0;break e}case 1:break;default:{i=0;break e}}if((h[t>>2]|0)!=1?!((h[o>>2]|0)==0&(h[n>>2]|0)==1&(h[a>>2]|0)==1):0){i=0;break}i=h[i>>2]|0}}while(0);w=v;return i|0}function Qt(e,t,r,i,n){e=e|0;t=t|0;r=r|0;i=i|0;n=n|0;d[t+53>>0]=1;do{if((h[t+4>>2]|0)==(i|0)){d[t+52>>0]=1;i=t+16|0;e=h[i>>2]|0;if(!e){h[i>>2]=r;h[t+24>>2]=n;h[t+36>>2]=1;if(!((n|0)==1?(h[t+48>>2]|0)==1:0))break;d[t+54>>0]=1;break}if((e|0)!=(r|0)){n=t+36|0;h[n>>2]=(h[n>>2]|0)+1;d[t+54>>0]=1;break}e=t+24|0;i=h[e>>2]|0;if((i|0)==2){h[e>>2]=n;i=n}if((i|0)==1?(h[t+48>>2]|0)==1:0)d[t+54>>0]=1}}while(0);return}function Jt(e,t,r,i,n){e=e|0;t=t|0;r=r|0;i=i|0;n=n|0;var a=0,o=0,s=0,u=0;e:do{if((e|0)==(h[t+8>>2]|0)){if((h[t+4>>2]|0)==(r|0)?(a=t+28|0,(h[a>>2]|0)!=1):0)h[a>>2]=i}else{if((e|0)!=(h[t>>2]|0)){s=h[e+8>>2]|0;Ei[h[(h[s>>2]|0)+24>>2]&3](s,t,r,i,n);break}if((h[t+16>>2]|0)!=(r|0)?(o=t+20|0,(h[o>>2]|0)!=(r|0)):0){h[t+32>>2]=i;i=t+44|0;if((h[i>>2]|0)==4)break;a=t+52|0;d[a>>0]=0;u=t+53|0;d[u>>0]=0;e=h[e+8>>2]|0;Di[h[(h[e>>2]|0)+20>>2]&3](e,t,r,r,1,n);if(d[u>>0]|0){if(!(d[a>>0]|0)){a=1;s=13}}else{a=0;s=13}do{if((s|0)==13){h[o>>2]=r;u=t+40|0;h[u>>2]=(h[u>>2]|0)+1;if((h[t+36>>2]|0)==1?(h[t+24>>2]|0)==2:0){d[t+54>>0]=1;if(a)break}else s=16;if((s|0)==16?a:0)break;h[i>>2]=4;break e}}while(0);h[i>>2]=3;break}if((i|0)==1)h[t+32>>2]=1}}while(0);return}function $t(e,t,r,i,n){e=e|0;t=t|0;r=r|0;i=i|0;n=n|0;var a=0,o=0;do{if((e|0)==(h[t+8>>2]|0)){if((h[t+4>>2]|0)==(r|0)?(o=t+28|0,(h[o>>2]|0)!=1):0)h[o>>2]=i
}else if((e|0)==(h[t>>2]|0)){if((h[t+16>>2]|0)!=(r|0)?(a=t+20|0,(h[a>>2]|0)!=(r|0)):0){h[t+32>>2]=i;h[a>>2]=r;n=t+40|0;h[n>>2]=(h[n>>2]|0)+1;if((h[t+36>>2]|0)==1?(h[t+24>>2]|0)==2:0)d[t+54>>0]=1;h[t+44>>2]=4;break}if((i|0)==1)h[t+32>>2]=1}}while(0);return}function er(e,t,r,i,n,a){e=e|0;t=t|0;r=r|0;i=i|0;n=n|0;a=a|0;if((e|0)==(h[t+8>>2]|0))Qt(0,t,r,i,n);else{e=h[e+8>>2]|0;Di[h[(h[e>>2]|0)+20>>2]&3](e,t,r,i,n,a)}return}function tr(e,t,r,i,n,a){e=e|0;t=t|0;r=r|0;i=i|0;n=n|0;a=a|0;if((e|0)==(h[t+8>>2]|0))Qt(0,t,r,i,n);return}function rr(e,t,r){e=e|0;t=t|0;r=r|0;var i=0,n=0;n=w;w=w+16|0;i=n;h[i>>2]=h[r>>2];e=Si[h[(h[e>>2]|0)+16>>2]&7](e,t,i)|0;if(e)h[r>>2]=h[i>>2];w=n;return e&1|0}function ir(e){e=e|0;if(!e)e=0;else e=(Kt(e,24,72,0)|0)!=0;return e&1|0}function nr(){var e=0,t=0,r=0,i=0,n=0,a=0,o=0,s=0;n=w;w=w+48|0;o=n+32|0;r=n+24|0;s=n+16|0;a=n;n=n+36|0;e=Bt()|0;if((e|0)!=0?(i=h[e>>2]|0,(i|0)!=0):0){e=i+48|0;t=h[e>>2]|0;e=h[e+4>>2]|0;if(!((t&-256|0)==1126902528&(e|0)==1129074247)){h[r>>2]=2406;Lt(2356,r)}if((t|0)==1126902529&(e|0)==1129074247)e=h[i+44>>2]|0;else e=i+80|0;h[n>>2]=e;i=h[i>>2]|0;e=h[i+4>>2]|0;if(Si[h[(h[8>>2]|0)+16>>2]&7](8,i,n)|0){s=h[n>>2]|0;s=xi[h[(h[s>>2]|0)+8>>2]&1](s)|0;h[a>>2]=2406;h[a+4>>2]=e;h[a+8>>2]=s;Lt(2270,a)}else{h[s>>2]=2406;h[s+4>>2]=e;Lt(2315,s)}}Lt(2394,o)}function ar(){var e=0;e=w;w=w+16|0;if(!(Ne(188,6)|0)){w=e;return}else Lt(2167,e)}function or(e){e=e|0;var t=0;t=w;w=w+16|0;zr(e);if(!(Te(h[47]|0,0)|0)){w=t;return}else Lt(2217,t)}function sr(e){e=e|0;var t=0,r=0;t=0;while(1){if((p[2415+t>>0]|0)==(e|0)){r=2;break}t=t+1|0;if((t|0)==87){t=87;e=2503;r=5;break}}if((r|0)==2)if(!t)e=2503;else{e=2503;r=5}if((r|0)==5)while(1){r=e;while(1){e=r+1|0;if(!(d[r>>0]|0))break;else r=e}t=t+-1|0;if(!t)break;else r=5}return e|0}function ur(){var e=0;if(!0)e=248;else{e=(Pe()|0)+60|0;e=h[e>>2]|0}return e|0}function lr(e){e=e|0;var t=0;if(e>>>0>4294963200){t=ur()|0;h[t>>2]=0-e;e=-1}return e|0}function cr(e,t){e=+e;t=t|0;var r=0,i=0,n=0;g[b>>3]=e;r=h[b>>2]|0;i=h[b+4>>2]|0;n=Zr(r|0,i|0,52)|0;n=n&2047;switch(n|0){case 0:{if(e!=0){e=+cr(e*0x10000000000000000,t);r=(h[t>>2]|0)+-64|0}else r=0;h[t>>2]=r;break}case 2047:break;default:{h[t>>2]=n+-1022;h[b>>2]=r;h[b+4>>2]=i&-2146435073|1071644672;e=+g[b>>3]}}return+e}function dr(e,t){e=+e;t=t|0;return+ +cr(e,t)}function fr(e,t,r){e=e|0;t=t|0;r=r|0;do{if(e){if(t>>>0<128){d[e>>0]=t;e=1;break}if(t>>>0<2048){d[e>>0]=t>>>6|192;d[e+1>>0]=t&63|128;e=2;break}if(t>>>0<55296|(t&-8192|0)==57344){d[e>>0]=t>>>12|224;d[e+1>>0]=t>>>6&63|128;d[e+2>>0]=t&63|128;e=3;break}if((t+-65536|0)>>>0<1048576){d[e>>0]=t>>>18|240;d[e+1>>0]=t>>>12&63|128;d[e+2>>0]=t>>>6&63|128;d[e+3>>0]=t&63|128;e=4;break}else{e=ur()|0;h[e>>2]=84;e=-1;break}}else e=1}while(0);return e|0}function hr(e,t){e=e|0;t=t|0;if(!e)e=0;else e=fr(e,t,0)|0;return e|0}function pr(e,t){e=e|0;t=t|0;var r=0,i=0,n=0,a=0,o=0;if((h[t+76>>2]|0)>=0?(Sr(t)|0)!=0:0){if((d[t+75>>0]|0)!=(e|0)?(i=t+20|0,n=h[i>>2]|0,n>>>0<(h[t+16>>2]|0)>>>0):0){h[i>>2]=n+1;d[n>>0]=e;r=e&255}else r=Tr(t,e)|0;Er(t)}else o=3;do{if((o|0)==3){if((d[t+75>>0]|0)!=(e|0)?(a=t+20|0,r=h[a>>2]|0,r>>>0<(h[t+16>>2]|0)>>>0):0){h[a>>2]=r+1;d[r>>0]=e;r=e&255;break}r=Tr(t,e)|0}}while(0);return r|0}function mr(e,t){e=e|0;t=t|0;return(_r(e,Or(e)|0,1,t)|0)+-1|0}function vr(e,t,r){e=e|0;t=t|0;r=r|0;var i=0,n=0,a=0,o=0;i=r+16|0;n=h[i>>2]|0;if(!n)if(!(Mr(r)|0)){n=h[i>>2]|0;a=4}else i=0;else a=4;e:do{if((a|0)==4){o=r+20|0;a=h[o>>2]|0;if((n-a|0)>>>0<t>>>0){i=Si[h[r+36>>2]&7](r,e,t)|0;break}t:do{if((d[r+75>>0]|0)>-1){i=t;while(1){if(!i){n=a;i=0;break t}n=i+-1|0;if((d[e+n>>0]|0)==10)break;else i=n}if((Si[h[r+36>>2]&7](r,e,i)|0)>>>0<i>>>0)break e;t=t-i|0;e=e+i|0;n=h[o>>2]|0}else{n=a;i=0}}while(0);Qr(n|0,e|0,t|0)|0;h[o>>2]=(h[o>>2]|0)+t;i=i+t|0}}while(0);return i|0}function _r(e,t,r,i){e=e|0;t=t|0;r=r|0;i=i|0;var n=0,a=0;n=ce(r,t)|0;if((h[i+76>>2]|0)>-1){a=(Sr(i)|0)==0;e=vr(e,n,i)|0;if(!a)Er(i)}else e=vr(e,n,i)|0;if((e|0)!=(n|0))r=(e>>>0)/(t>>>0)|0;return r|0}function gr(e){e=e|0;var t=0,r=0,i=0,n=0;i=h[61]|0;if((h[i+76>>2]|0)>-1)n=Sr(i)|0;else n=0;do{if((mr(e,i)|0)<0)t=1;else{if((d[i+75>>0]|0)!=10?(t=i+20|0,r=h[t>>2]|0,r>>>0<(h[i+16>>2]|0)>>>0):0){h[t>>2]=r+1;d[r>>0]=10;t=0;break}t=(Tr(i,10)|0)<0}}while(0);if(n)Er(i);return t<<31>>31|0}function yr(e,t,r){e=e|0;t=t|0;r=r|0;var i=0,n=0;i=w;w=w+16|0;n=i;h[n>>2]=r;r=br(e,t,n)|0;w=i;return r|0}function wr(e,t,r){e=e|0;t=t|0;r=r|0;var i=0,n=0,a=0,o=0,s=0,u=0,l=0,c=0,f=0,p=0,m=0,v=0,_=0;_=w;w=w+224|0;f=_+120|0;v=_+80|0;m=_;p=_+136|0;i=v;n=i+40|0;do{h[i>>2]=0;i=i+4|0}while((i|0)<(n|0));h[f>>2]=h[r>>2];if((Rr(0,t,f,m,v)|0)<0)r=-1;else{if((h[e+76>>2]|0)>-1)l=Sr(e)|0;else l=0;r=h[e>>2]|0;c=r&32;if((d[e+74>>0]|0)<1)h[e>>2]=r&-33;r=e+48|0;if(!(h[r>>2]|0)){n=e+44|0;a=h[n>>2]|0;h[n>>2]=p;o=e+28|0;h[o>>2]=p;s=e+20|0;h[s>>2]=p;h[r>>2]=80;u=e+16|0;h[u>>2]=p+80;i=Rr(e,t,f,m,v)|0;if(a){Si[h[e+36>>2]&7](e,0,0)|0;i=(h[s>>2]|0)==0?-1:i;h[n>>2]=a;h[r>>2]=0;h[u>>2]=0;h[o>>2]=0;h[s>>2]=0}}else i=Rr(e,t,f,m,v)|0;r=h[e>>2]|0;h[e>>2]=r|c;if(l)Er(e);r=(r&32|0)==0?i:-1}w=_;return r|0}function Cr(e,t,r,i){e=e|0;t=t|0;r=r|0;i=i|0;var n=0,a=0,o=0,s=0,u=0,l=0,c=0;c=w;w=w+128|0;n=c+112|0;l=c;a=l;o=252;s=a+112|0;do{h[a>>2]=h[o>>2];a=a+4|0;o=o+4|0}while((a|0)<(s|0));if((t+-1|0)>>>0>2147483646)if(!t){t=1;u=4}else{t=ur()|0;h[t>>2]=75;t=-1}else{n=e;u=4}if((u|0)==4){u=-2-n|0;u=t>>>0>u>>>0?u:t;h[l+48>>2]=u;e=l+20|0;h[e>>2]=n;h[l+44>>2]=n;t=n+u|0;n=l+16|0;h[n>>2]=t;h[l+28>>2]=t;t=wr(l,r,i)|0;if(u){r=h[e>>2]|0;d[r+(((r|0)==(h[n>>2]|0))<<31>>31)>>0]=0}}w=c;return t|0}function br(e,t,r){e=e|0;t=t|0;r=r|0;return Cr(e,2147483647,t,r)|0}function Sr(e){e=e|0;return 0}function Er(e){e=e|0;return}function Tr(e,t){e=e|0;t=t|0;var r=0,i=0,n=0,a=0,o=0,s=0,u=0;u=w;w=w+16|0;s=u;o=t&255;d[s>>0]=o;i=e+16|0;n=h[i>>2]|0;if(!n)if(!(Mr(e)|0)){n=h[i>>2]|0;a=4}else r=-1;else a=4;do{if((a|0)==4){i=e+20|0;a=h[i>>2]|0;if(a>>>0<n>>>0?(r=t&255,(r|0)!=(d[e+75>>0]|0)):0){h[i>>2]=a+1;d[a>>0]=o;break}if((Si[h[e+36>>2]&7](e,s,1)|0)==1)r=p[s>>0]|0;else r=-1}}while(0);w=u;return r|0}function xr(e){e=e|0;var t=0,r=0;t=w;w=w+16|0;r=t;h[r>>2]=h[e+60>>2];e=lr(Ie(6,r|0)|0)|0;w=t;return e|0}function Ar(e,t,r){e=e|0;t=t|0;r=r|0;var i=0,n=0,a=0;n=w;w=w+32|0;a=n;i=n+20|0;h[a>>2]=h[e+60>>2];h[a+4>>2]=0;h[a+8>>2]=t;h[a+12>>2]=i;h[a+16>>2]=r;if((lr(ke(140,a|0)|0)|0)<0){h[i>>2]=-1;e=-1}else e=h[i>>2]|0;w=n;return e|0}function Pr(e,t,r){e=e|0;t=t|0;r=r|0;var i=0,n=0,a=0,o=0,s=0,u=0,l=0,c=0,d=0,f=0,p=0,m=0;m=w;w=w+48|0;d=m+16|0;c=m;i=m+32|0;f=e+28|0;n=h[f>>2]|0;h[i>>2]=n;p=e+20|0;n=(h[p>>2]|0)-n|0;h[i+4>>2]=n;h[i+8>>2]=t;h[i+12>>2]=r;u=e+60|0;l=e+44|0;t=2;n=n+r|0;while(1){if(!(h[49]|0)){h[d>>2]=h[u>>2];h[d+4>>2]=i;h[d+8>>2]=t;o=lr(qe(146,d|0)|0)|0}else{Me(7,e|0);h[c>>2]=h[u>>2];h[c+4>>2]=i;h[c+8>>2]=t;o=lr(qe(146,c|0)|0)|0;Se(0)}if((n|0)==(o|0)){n=6;break}if((o|0)<0){n=8;break}n=n-o|0;a=h[i+4>>2]|0;if(o>>>0<=a>>>0)if((t|0)==2){h[f>>2]=(h[f>>2]|0)+o;s=a;t=2}else s=a;else{s=h[l>>2]|0;h[f>>2]=s;h[p>>2]=s;s=h[i+12>>2]|0;o=o-a|0;i=i+8|0;t=t+-1|0}h[i>>2]=(h[i>>2]|0)+o;h[i+4>>2]=s-o}if((n|0)==6){d=h[l>>2]|0;h[e+16>>2]=d+(h[e+48>>2]|0);e=d;h[f>>2]=e;h[p>>2]=e}else if((n|0)==8){h[e+16>>2]=0;h[f>>2]=0;h[p>>2]=0;h[e>>2]=h[e>>2]|32;if((t|0)==2)r=0;else r=r-(h[i+4>>2]|0)|0}w=m;return r|0}function Dr(e,t,r){e=e|0;t=t|0;r=r|0;var i=0,n=0;n=w;w=w+80|0;i=n;h[e+36>>2]=3;if((h[e>>2]&64|0)==0?(h[i>>2]=h[e+60>>2],h[i+4>>2]=21505,h[i+8>>2]=n+12,(Fe(54,i|0)|0)!=0):0)d[e+75>>0]=-1;i=Pr(e,t,r)|0;w=n;return i|0}function Mr(e){e=e|0;var t=0,r=0;t=e+74|0;r=d[t>>0]|0;d[t>>0]=r+255|r;t=h[e>>2]|0;if(!(t&8)){h[e+8>>2]=0;h[e+4>>2]=0;t=h[e+44>>2]|0;h[e+28>>2]=t;h[e+20>>2]=t;h[e+16>>2]=t+(h[e+48>>2]|0);t=0}else{h[e>>2]=t|32;t=-1}return t|0}function Ir(e,t,r){e=e|0;t=t|0;r=r|0;var i=0,n=0,a=0,o=0;a=t&255;i=(r|0)!=0;e:do{if(i&(e&3|0)!=0){n=t&255;while(1){if((d[e>>0]|0)==n<<24>>24){o=6;break e}e=e+1|0;r=r+-1|0;i=(r|0)!=0;if(!(i&(e&3|0)!=0)){o=5;break}}}else o=5}while(0);if((o|0)==5)if(i)o=6;else r=0;e:do{if((o|0)==6){n=t&255;if((d[e>>0]|0)!=n<<24>>24){i=ce(a,16843009)|0;t:do{if(r>>>0>3)while(1){a=h[e>>2]^i;if((a&-2139062144^-2139062144)&a+-16843009)break;e=e+4|0;r=r+-4|0;if(r>>>0<=3){o=11;break t}}else o=11}while(0);if((o|0)==11)if(!r){r=0;break}while(1){if((d[e>>0]|0)==n<<24>>24)break e;e=e+1|0;r=r+-1|0;if(!r){r=0;break}}}}}while(0);return((r|0)!=0?e:0)|0}function Or(e){e=e|0;var t=0,r=0,i=0;i=e;e:do{if(!(i&3))r=4;else{t=e;e=i;while(1){if(!(d[t>>0]|0))break e;t=t+1|0;e=t;if(!(e&3)){e=t;r=4;break}}}}while(0);if((r|0)==4){while(1){t=h[e>>2]|0;if(!((t&-2139062144^-2139062144)&t+-16843009))e=e+4|0;else break}if((t&255)<<24>>24)do{e=e+1|0}while((d[e>>0]|0)!=0)}return e-i|0}function Rr(e,t,r,i,n){e=e|0;t=t|0;r=r|0;i=i|0;n=n|0;var a=0,o=0,s=0,u=0,l=0,c=0,m=0,v=0,_=0,y=0,C=0,S=0,E=0,T=0,x=0,A=0,P=0,D=0,M=0,I=0,O=0,R=0,N=0,L=0,B=0,F=0,k=0,V=0,U=0,q=0,G=0,H=0,W=0,j=0,Y=0,X=0,Z=0,K=0,Q=0,J=0,$=0,ee=0,te=0,re=0,ie=0,ne=0,ae=0,oe=0;oe=w;w=w+624|0;te=oe+24|0;ie=oe+16|0;re=oe+588|0;K=oe+576|0;ee=oe;Y=oe+536|0;ae=oe+8|0;ne=oe+528|0;F=(e|0)!=0;k=Y+40|0;j=k;Y=Y+39|0;X=ae+4|0;Z=K+12|0;K=K+11|0;Q=re;J=Z;$=J-Q|0;V=-2-Q|0;U=J+2|0;q=te+288|0;G=re+9|0;H=G;W=re+8|0;a=0;C=t;o=0;t=0;e:while(1){do{if((a|0)>-1)if((o|0)>(2147483647-a|0)){a=ur()|0;h[a>>2]=75;a=-1;break}else{a=o+a|0;break}}while(0);o=d[C>>0]|0;if(!(o<<24>>24)){B=245;break}else s=C;t:while(1){switch(o<<24>>24){case 37:{o=s;B=9;break t}case 0:{o=s;break t}default:{}}L=s+1|0;o=d[L>>0]|0;s=L}t:do{if((B|0)==9)while(1){B=0;if((d[o+1>>0]|0)!=37)break t;s=s+1|0;o=o+2|0;if((d[o>>0]|0)==37)B=9;else break}}while(0);E=s-C|0;if(F?(h[e>>2]&32|0)==0:0)vr(C,E,e)|0;if((s|0)!=(C|0)){C=o;o=E;continue}c=o+1|0;s=d[c>>0]|0;u=(s<<24>>24)+-48|0;if(u>>>0<10){L=(d[o+2>>0]|0)==36;c=L?o+3|0:c;s=d[c>>0]|0;_=L?u:-1;t=L?1:t}else _=-1;o=s<<24>>24;t:do{if((o&-32|0)==32){u=0;while(1){if(!(1<<o+-32&75913)){m=u;o=c;break t}u=1<<(s<<24>>24)+-32|u;c=c+1|0;s=d[c>>0]|0;o=s<<24>>24;if((o&-32|0)!=32){m=u;o=c;break}}}else{m=0;o=c}}while(0);do{if(s<<24>>24==42){u=o+1|0;s=(d[u>>0]|0)+-48|0;if(s>>>0<10?(d[o+2>>0]|0)==36:0){h[n+(s<<2)>>2]=10;t=1;o=o+3|0;s=h[i+((d[u>>0]|0)+-48<<3)>>2]|0}else{if(t){a=-1;break e}if(!F){S=m;o=u;t=0;L=0;break}t=(h[r>>2]|0)+(4-1)&~(4-1);s=h[t>>2]|0;h[r>>2]=t+4;t=0;o=u}if((s|0)<0){S=m|8192;L=0-s|0}else{S=m;L=s}}else{u=(s<<24>>24)+-48|0;if(u>>>0<10){s=0;do{s=(s*10|0)+u|0;o=o+1|0;u=(d[o>>0]|0)+-48|0}while(u>>>0<10);if((s|0)<0){a=-1;break e}else{S=m;L=s}}else{S=m;L=0}}}while(0);t:do{if((d[o>>0]|0)==46){u=o+1|0;s=d[u>>0]|0;if(s<<24>>24!=42){c=(s<<24>>24)+-48|0;if(c>>>0<10){o=u;s=0}else{o=u;c=0;break}while(1){s=(s*10|0)+c|0;o=o+1|0;c=(d[o>>0]|0)+-48|0;if(c>>>0>=10){c=s;break t}}}u=o+2|0;s=(d[u>>0]|0)+-48|0;if(s>>>0<10?(d[o+3>>0]|0)==36:0){h[n+(s<<2)>>2]=10;o=o+4|0;c=h[i+((d[u>>0]|0)+-48<<3)>>2]|0;break}if(t){a=-1;break e}if(F){o=(h[r>>2]|0)+(4-1)&~(4-1);c=h[o>>2]|0;h[r>>2]=o+4;o=u}else{o=u;c=0}}else c=-1}while(0);v=0;while(1){s=(d[o>>0]|0)+-65|0;if(s>>>0>57){a=-1;break e}u=o+1|0;s=d[5347+(v*58|0)+s>>0]|0;m=s&255;if((m+-1|0)>>>0<8){o=u;v=m}else{N=u;break}}if(!(s<<24>>24)){a=-1;break}u=(_|0)>-1;do{if(s<<24>>24==19)if(u){a=-1;break e}else B=52;else{if(u){h[n+(_<<2)>>2]=m;O=i+(_<<3)|0;R=h[O+4>>2]|0;B=ee;h[B>>2]=h[O>>2];h[B+4>>2]=R;B=52;break}if(!F){a=0;break e}Br(ee,m,r)}}while(0);if((B|0)==52?(B=0,!F):0){C=N;o=E;continue}_=d[o>>0]|0;_=(v|0)!=0&(_&15|0)==3?_&-33:_;u=S&-65537;R=(S&8192|0)==0?S:u;t:do{switch(_|0){case 110:switch(v|0){case 0:{h[h[ee>>2]>>2]=a;C=N;o=E;continue e}case 1:{h[h[ee>>2]>>2]=a;C=N;o=E;continue e}case 2:{C=h[ee>>2]|0;h[C>>2]=a;h[C+4>>2]=((a|0)<0)<<31>>31;C=N;o=E;continue e}case 3:{f[h[ee>>2]>>1]=a;C=N;o=E;continue e}case 4:{d[h[ee>>2]>>0]=a;C=N;o=E;continue e}case 6:{h[h[ee>>2]>>2]=a;C=N;o=E;continue e}case 7:{C=h[ee>>2]|0;h[C>>2]=a;h[C+4>>2]=((a|0)<0)<<31>>31;C=N;o=E;continue e}default:{C=N;o=E;continue e}}case 112:{v=R|8;c=c>>>0>8?c:8;_=120;B=64;break}case 88:case 120:{v=R;B=64;break}case 111:{u=ee;s=h[u>>2]|0;u=h[u+4>>2]|0;if((s|0)==0&(u|0)==0)o=k;else{o=k;do{o=o+-1|0;d[o>>0]=s&7|48;s=Zr(s|0,u|0,3)|0;u=z}while(!((s|0)==0&(u|0)==0))}if(!(R&8)){s=R;v=0;m=5827;B=77}else{v=j-o+1|0;s=R;c=(c|0)<(v|0)?v:c;v=0;m=5827;B=77}break}case 105:case 100:{s=ee;o=h[s>>2]|0;s=h[s+4>>2]|0;if((s|0)<0){o=jr(0,0,o|0,s|0)|0;s=z;u=ee;h[u>>2]=o;h[u+4>>2]=s;u=1;m=5827;B=76;break t}if(!(R&2048)){m=R&1;u=m;m=(m|0)==0?5827:5829;B=76}else{u=1;m=5828;B=76}break}case 117:{s=ee;o=h[s>>2]|0;s=h[s+4>>2]|0;u=0;m=5827;B=76;break}case 99:{d[Y>>0]=h[ee>>2];C=Y;s=1;v=0;_=5827;o=k;break}case 109:{o=ur()|0;o=sr(h[o>>2]|0)|0;B=82;break}case 115:{o=h[ee>>2]|0;o=(o|0)!=0?o:5837;B=82;break}case 67:{h[ae>>2]=h[ee>>2];h[X>>2]=0;h[ee>>2]=ae;c=-1;B=86;break}case 83:{if(!c){kr(e,32,L,0,R);o=0;B=98}else B=86;break}case 65:case 71:case 70:case 69:case 97:case 103:case 102:case 101:{l=+g[ee>>3];h[ie>>2]=0;g[b>>3]=l;if((h[b+4>>2]|0)>=0)if(!(R&2048)){O=R&1;I=O;O=(O|0)==0?5845:5850}else{I=1;O=5847}else{l=-l;I=1;O=5844}g[b>>3]=l;M=h[b+4>>2]&2146435072;do{if(M>>>0<2146435072|(M|0)==2146435072&0<0){y=+dr(l,ie)*2;s=y!=0;if(s)h[ie>>2]=(h[ie>>2]|0)+-1;P=_|32;if((P|0)==97){C=_&32;E=(C|0)==0?O:O+9|0;S=I|2;o=12-c|0;do{if(!(c>>>0>11|(o|0)==0)){l=8;do{o=o+-1|0;l=l*16}while((o|0)!=0);if((d[E>>0]|0)==45){l=-(l+(-y-l));break}else{l=y+l-l;break}}else l=y}while(0);s=h[ie>>2]|0;o=(s|0)<0?0-s|0:s;o=Fr(o,((o|0)<0)<<31>>31,Z)|0;if((o|0)==(Z|0)){d[K>>0]=48;o=K}d[o+-1>>0]=(s>>31&2)+43;v=o+-2|0;d[v>>0]=_+15;m=(c|0)<1;u=(R&8|0)==0;s=re;while(1){O=~~l;o=s+1|0;d[s>>0]=p[5811+O>>0]|C;l=(l-+(O|0))*16;do{if((o-Q|0)==1){if(u&(m&l==0))break;d[o>>0]=46;o=s+2|0}}while(0);if(!(l!=0))break;else s=o}c=(c|0)!=0&(V+o|0)<(c|0)?U+c-v|0:$-v+o|0;u=c+S|0;kr(e,32,L,u,R);if(!(h[e>>2]&32))vr(E,S,e)|0;kr(e,48,L,u,R^65536);o=o-Q|0;if(!(h[e>>2]&32))vr(re,o,e)|0;s=J-v|0;kr(e,48,c-(o+s)|0,0,0);if(!(h[e>>2]&32))vr(v,s,e)|0;kr(e,32,L,u,R^8192);o=(u|0)<(L|0)?L:u;break}o=(c|0)<0?6:c;if(s){s=(h[ie>>2]|0)+-28|0;h[ie>>2]=s;l=y*268435456}else{l=y;s=h[ie>>2]|0}M=(s|0)<0?te:q;D=M;s=M;do{A=~~l>>>0;h[s>>2]=A;s=s+4|0;l=(l-+(A>>>0))*1e9}while(l!=0);u=s;s=h[ie>>2]|0;if((s|0)>0){m=M;while(1){v=(s|0)>29?29:s;c=u+-4|0;do{if(c>>>0<m>>>0)c=m;else{s=0;do{A=Kr(h[c>>2]|0,0,v|0)|0;A=Yr(A|0,z|0,s|0,0)|0;s=z;x=ai(A|0,s|0,1e9,0)|0;h[c>>2]=x;s=ni(A|0,s|0,1e9,0)|0;c=c+-4|0}while(c>>>0>=m>>>0);if(!s){c=m;break}c=m+-4|0;h[c>>2]=s}}while(0);while(1){if(u>>>0<=c>>>0)break;s=u+-4|0;if(!(h[s>>2]|0))u=s;else break}s=(h[ie>>2]|0)-v|0;h[ie>>2]=s;if((s|0)>0)m=c;else break}}else c=M;if((s|0)<0){E=((o+25|0)/9|0)+1|0;T=(P|0)==102;C=c;while(1){S=0-s|0;S=(S|0)>9?9:S;do{if(C>>>0<u>>>0){s=(1<<S)+-1|0;m=1e9>>>S;c=0;v=C;do{A=h[v>>2]|0;h[v>>2]=(A>>>S)+c;c=ce(A&s,m)|0;v=v+4|0}while(v>>>0<u>>>0);s=(h[C>>2]|0)==0?C+4|0:C;if(!c){c=s;break}h[u>>2]=c;c=s;u=u+4|0}else c=(h[C>>2]|0)==0?C+4|0:C}while(0);s=T?M:c;u=(u-s>>2|0)>(E|0)?s+(E<<2)|0:u;s=(h[ie>>2]|0)+S|0;h[ie>>2]=s;if((s|0)>=0){C=c;break}else C=c}}else C=c;do{if(C>>>0<u>>>0){s=(D-C>>2)*9|0;m=h[C>>2]|0;if(m>>>0<10)break;else c=10;do{c=c*10|0;s=s+1|0}while(m>>>0>=c>>>0)}else s=0}while(0);x=(P|0)==103;A=(o|0)!=0;c=o-((P|0)!=102?s:0)+((A&x)<<31>>31)|0;if((c|0)<(((u-D>>2)*9|0)+-9|0)){v=c+9216|0;T=(v|0)/9|0;c=M+(T+-1023<<2)|0;v=((v|0)%9|0)+1|0;if((v|0)<9){m=10;do{m=m*10|0;v=v+1|0}while((v|0)!=9)}else m=10;S=h[c>>2]|0;E=(S>>>0)%(m>>>0)|0;if((E|0)==0?(M+(T+-1022<<2)|0)==(u|0):0)m=C;else B=163;do{if((B|0)==163){B=0;y=(((S>>>0)/(m>>>0)|0)&1|0)==0?9007199254740992:9007199254740994;v=(m|0)/2|0;do{if(E>>>0<v>>>0)l=.5;else{if((E|0)==(v|0)?(M+(T+-1022<<2)|0)==(u|0):0){l=1;break}l=1.5}}while(0);do{if(I){if((d[O>>0]|0)!=45)break;y=-y;l=-l}}while(0);v=S-E|0;h[c>>2]=v;if(!(y+l!=y)){m=C;break}P=v+m|0;h[c>>2]=P;if(P>>>0>999999999){s=C;while(1){m=c+-4|0;h[c>>2]=0;if(m>>>0<s>>>0){s=s+-4|0;h[s>>2]=0}P=(h[m>>2]|0)+1|0;h[m>>2]=P;if(P>>>0>999999999)c=m;else{C=s;c=m;break}}}s=(D-C>>2)*9|0;v=h[C>>2]|0;if(v>>>0<10){m=C;break}else m=10;do{m=m*10|0;s=s+1|0}while(v>>>0>=m>>>0);m=C}}while(0);P=c+4|0;C=m;u=u>>>0>P>>>0?P:u}E=0-s|0;while(1){if(u>>>0<=C>>>0){T=0;P=u;break}c=u+-4|0;if(!(h[c>>2]|0))u=c;else{T=1;P=u;break}}do{if(x){o=(A&1^1)+o|0;if((o|0)>(s|0)&(s|0)>-5){_=_+-1|0;o=o+-1-s|0}else{_=_+-2|0;o=o+-1|0}u=R&8;if(u)break;do{if(T){u=h[P+-4>>2]|0;if(!u){c=9;break}if(!((u>>>0)%10|0)){m=10;c=0}else{c=0;break}do{m=m*10|0;c=c+1|0}while(((u>>>0)%(m>>>0)|0|0)==0)}else c=9}while(0);u=((P-D>>2)*9|0)+-9|0;if((_|32|0)==102){u=u-c|0;u=(u|0)<0?0:u;o=(o|0)<(u|0)?o:u;u=0;break}else{u=u+s-c|0;u=(u|0)<0?0:u;o=(o|0)<(u|0)?o:u;u=0;break}}else u=R&8}while(0);S=o|u;m=(S|0)!=0&1;v=(_|32|0)==102;if(v){s=(s|0)>0?s:0;_=0}else{c=(s|0)<0?E:s;c=Fr(c,((c|0)<0)<<31>>31,Z)|0;if((J-c|0)<2)do{c=c+-1|0;d[c>>0]=48}while((J-c|0)<2);d[c+-1>>0]=(s>>31&2)+43;D=c+-2|0;d[D>>0]=_;s=J-D|0;_=D}E=I+1+o+m+s|0;kr(e,32,L,E,R);if(!(h[e>>2]&32))vr(O,I,e)|0;kr(e,48,L,E,R^65536);do{if(v){c=C>>>0>M>>>0?M:C;s=c;do{u=Fr(h[s>>2]|0,0,G)|0;do{if((s|0)==(c|0)){if((u|0)!=(G|0))break;d[W>>0]=48;u=W}else{if(u>>>0<=re>>>0)break;do{u=u+-1|0;d[u>>0]=48}while(u>>>0>re>>>0)}}while(0);if(!(h[e>>2]&32))vr(u,H-u|0,e)|0;s=s+4|0}while(s>>>0<=M>>>0);do{if(S){if(h[e>>2]&32)break;vr(5879,1,e)|0}}while(0);if((o|0)>0&s>>>0<P>>>0){u=s;while(1){s=Fr(h[u>>2]|0,0,G)|0;if(s>>>0>re>>>0)do{s=s+-1|0;d[s>>0]=48}while(s>>>0>re>>>0);if(!(h[e>>2]&32))vr(s,(o|0)>9?9:o,e)|0;u=u+4|0;s=o+-9|0;if(!((o|0)>9&u>>>0<P>>>0)){o=s;break}else o=s}}kr(e,48,o+9|0,9,0)}else{v=T?P:C+4|0;if((o|0)>-1){m=(u|0)==0;c=C;do{s=Fr(h[c>>2]|0,0,G)|0;if((s|0)==(G|0)){d[W>>0]=48;s=W}do{if((c|0)==(C|0)){u=s+1|0;if(!(h[e>>2]&32))vr(s,1,e)|0;if(m&(o|0)<1){s=u;break}if(h[e>>2]&32){s=u;break}vr(5879,1,e)|0;s=u}else{if(s>>>0<=re>>>0)break;do{s=s+-1|0;d[s>>0]=48}while(s>>>0>re>>>0)}}while(0);u=H-s|0;if(!(h[e>>2]&32))vr(s,(o|0)>(u|0)?u:o,e)|0;o=o-u|0;c=c+4|0}while(c>>>0<v>>>0&(o|0)>-1)}kr(e,48,o+18|0,18,0);if(h[e>>2]&32)break;vr(_,J-_|0,e)|0}}while(0);kr(e,32,L,E,R^8192);o=(E|0)<(L|0)?L:E}else{v=(_&32|0)!=0;m=l!=l|0!=0;s=m?0:I;c=s+3|0;kr(e,32,L,c,u);o=h[e>>2]|0;if(!(o&32)){vr(O,s,e)|0;o=h[e>>2]|0}if(!(o&32))vr(m?v?5871:5875:v?5863:5867,3,e)|0;kr(e,32,L,c,R^8192);o=(c|0)<(L|0)?L:c}}while(0);C=N;continue e}default:{u=R;s=c;v=0;_=5827;o=k}}}while(0);t:do{if((B|0)==64){u=ee;s=h[u>>2]|0;u=h[u+4>>2]|0;m=_&32;if(!((s|0)==0&(u|0)==0)){o=k;do{o=o+-1|0;d[o>>0]=p[5811+(s&15)>>0]|m;s=Zr(s|0,u|0,4)|0;u=z}while(!((s|0)==0&(u|0)==0));B=ee;if((v&8|0)==0|(h[B>>2]|0)==0&(h[B+4>>2]|0)==0){s=v;v=0;m=5827;B=77}else{s=v;v=2;m=5827+(_>>4)|0;B=77}}else{o=k;s=v;v=0;m=5827;B=77}}else if((B|0)==76){o=Fr(o,s,k)|0;s=R;v=u;B=77}else if((B|0)==82){B=0;R=Ir(o,0,c)|0;O=(R|0)==0;C=o;s=O?c:R-o|0;v=0;_=5827;o=O?o+c|0:R}else if((B|0)==86){B=0;s=0;o=0;m=h[ee>>2]|0;while(1){u=h[m>>2]|0;if(!u)break;o=hr(ne,u)|0;if((o|0)<0|o>>>0>(c-s|0)>>>0)break;s=o+s|0;if(c>>>0>s>>>0)m=m+4|0;else break}if((o|0)<0){a=-1;break e}kr(e,32,L,s,R);if(!s){o=0;B=98}else{u=0;c=h[ee>>2]|0;while(1){o=h[c>>2]|0;if(!o){o=s;B=98;break t}o=hr(ne,o)|0;u=o+u|0;if((u|0)>(s|0)){o=s;B=98;break t}if(!(h[e>>2]&32))vr(ne,o,e)|0;if(u>>>0>=s>>>0){o=s;B=98;break}else c=c+4|0}}}}while(0);if((B|0)==98){B=0;kr(e,32,L,o,R^8192);C=N;o=(L|0)>(o|0)?L:o;continue}if((B|0)==77){B=0;u=(c|0)>-1?s&-65537:s;s=ee;s=(h[s>>2]|0)!=0|(h[s+4>>2]|0)!=0;if((c|0)!=0|s){s=(s&1^1)+(j-o)|0;C=o;s=(c|0)>(s|0)?c:s;_=m;o=k}else{C=k;s=0;_=m;o=k}}m=o-C|0;s=(s|0)<(m|0)?m:s;c=v+s|0;o=(L|0)<(c|0)?c:L;kr(e,32,o,c,u);if(!(h[e>>2]&32))vr(_,v,e)|0;kr(e,48,o,c,u^65536);kr(e,48,s,m,0);if(!(h[e>>2]&32))vr(C,m,e)|0;kr(e,32,o,c,u^8192);C=N}e:do{if((B|0)==245)if(!e)if(t){a=1;while(1){t=h[n+(a<<2)>>2]|0;if(!t)break;Br(i+(a<<3)|0,t,r);a=a+1|0;if((a|0)>=10){a=1;break e}}if((a|0)<10)while(1){if(h[n+(a<<2)>>2]|0){a=-1;break e}a=a+1|0;if((a|0)>=10){a=1;break}}else a=1}else a=0}while(0);w=oe;return a|0}function Nr(e){e=e|0;if(!(h[e+68>>2]|0))Er(e);return}function Lr(e,t,r){e=e|0;t=t|0;r=r|0;var i=0,n=0;i=e+20|0;n=h[i>>2]|0;e=(h[e+16>>2]|0)-n|0;e=e>>>0>r>>>0?r:e;Qr(n|0,t|0,e|0)|0;h[i>>2]=(h[i>>2]|0)+e;return r|0}function Br(e,t,r){e=e|0;t=t|0;r=r|0;var i=0,n=0,a=0;e:do{if(t>>>0<=20)do{switch(t|0){case 9:{i=(h[r>>2]|0)+(4-1)&~(4-1);t=h[i>>2]|0;h[r>>2]=i+4;h[e>>2]=t;break e}case 10:{i=(h[r>>2]|0)+(4-1)&~(4-1);t=h[i>>2]|0;h[r>>2]=i+4;i=e;h[i>>2]=t;h[i+4>>2]=((t|0)<0)<<31>>31;break e}case 11:{i=(h[r>>2]|0)+(4-1)&~(4-1);t=h[i>>2]|0;h[r>>2]=i+4;i=e;h[i>>2]=t;h[i+4>>2]=0;break e}case 12:{i=(h[r>>2]|0)+(8-1)&~(8-1);t=i;n=h[t>>2]|0;t=h[t+4>>2]|0;h[r>>2]=i+8;i=e;h[i>>2]=n;h[i+4>>2]=t;break e}case 13:{n=(h[r>>2]|0)+(4-1)&~(4-1);i=h[n>>2]|0;h[r>>2]=n+4;i=(i&65535)<<16>>16;n=e;h[n>>2]=i;h[n+4>>2]=((i|0)<0)<<31>>31;break e}case 14:{n=(h[r>>2]|0)+(4-1)&~(4-1);i=h[n>>2]|0;h[r>>2]=n+4;n=e;h[n>>2]=i&65535;h[n+4>>2]=0;break e}case 15:{n=(h[r>>2]|0)+(4-1)&~(4-1);i=h[n>>2]|0;h[r>>2]=n+4;i=(i&255)<<24>>24;n=e;h[n>>2]=i;h[n+4>>2]=((i|0)<0)<<31>>31;break e}case 16:{n=(h[r>>2]|0)+(4-1)&~(4-1);i=h[n>>2]|0;h[r>>2]=n+4;n=e;h[n>>2]=i&255;h[n+4>>2]=0;break e}case 17:{n=(h[r>>2]|0)+(8-1)&~(8-1);a=+g[n>>3];h[r>>2]=n+8;g[e>>3]=a;break e}case 18:{n=(h[r>>2]|0)+(8-1)&~(8-1);a=+g[n>>3];h[r>>2]=n+8;g[e>>3]=a;break e}default:break e}}while(0)}while(0);return}function Fr(e,t,r){e=e|0;t=t|0;r=r|0;var i=0;if(t>>>0>0|(t|0)==0&e>>>0>4294967295)while(1){i=ai(e|0,t|0,10,0)|0;r=r+-1|0;d[r>>0]=i|48;i=ni(e|0,t|0,10,0)|0;if(t>>>0>9|(t|0)==9&e>>>0>4294967295){e=i;t=z}else{e=i;break}}if(e)while(1){r=r+-1|0;d[r>>0]=(e>>>0)%10|0|48;if(e>>>0<10)break;else e=(e>>>0)/10|0}return r|0}function kr(e,t,r,i,n){e=e|0;t=t|0;r=r|0;i=i|0;n=n|0;var a=0,o=0,s=0;s=w;w=w+256|0;o=s;do{if((r|0)>(i|0)&(n&73728|0)==0){n=r-i|0;Xr(o|0,t|0,(n>>>0>256?256:n)|0)|0;t=h[e>>2]|0;a=(t&32|0)==0;if(n>>>0>255){i=r-i|0;do{if(a){vr(o,256,e)|0;t=h[e>>2]|0}n=n+-256|0;a=(t&32|0)==0}while(n>>>0>255);if(a)n=i&255;else break}else if(!a)break;vr(o,n,e)|0}}while(0);w=s;return}function Vr(e){e=e|0;var t=0,r=0,i=0,n=0,a=0,o=0,s=0,u=0,l=0,c=0,d=0,f=0,p=0,m=0,v=0,_=0,g=0,y=0,w=0,C=0,b=0,S=0,E=0,T=0,x=0,A=0,P=0,D=0,M=0,I=0,O=0,R=0,N=0,L=0,B=0,F=0,k=0;do{if(e>>>0<245){p=e>>>0<11?16:e+11&-8;e=p>>>3;s=h[147]|0;r=s>>>e;if(r&3){e=(r&1^1)+e|0;i=e<<1;r=628+(i<<2)|0;i=628+(i+2<<2)|0;n=h[i>>2]|0;a=n+8|0;o=h[a>>2]|0;do{if((r|0)!=(o|0)){if(o>>>0<(h[151]|0)>>>0)De();t=o+12|0;if((h[t>>2]|0)==(n|0)){h[t>>2]=r;h[i>>2]=o;break}else De()}else h[147]=s&~(1<<e)}while(0);k=e<<3;h[n+4>>2]=k|3;k=n+(k|4)|0;h[k>>2]=h[k>>2]|1;k=a;return k|0}o=h[149]|0;if(p>>>0>o>>>0){if(r){i=2<<e;i=r<<e&(i|0-i);i=(i&0-i)+-1|0;u=i>>>12&16;i=i>>>u;n=i>>>5&8;i=i>>>n;a=i>>>2&4;i=i>>>a;r=i>>>1&2;i=i>>>r;e=i>>>1&1;e=(n|u|a|r|e)+(i>>>e)|0;i=e<<1;r=628+(i<<2)|0;i=628+(i+2<<2)|0;a=h[i>>2]|0;u=a+8|0;n=h[u>>2]|0;do{if((r|0)!=(n|0)){if(n>>>0<(h[151]|0)>>>0)De();t=n+12|0;if((h[t>>2]|0)==(a|0)){h[t>>2]=r;h[i>>2]=n;l=h[149]|0;break}else De()}else{h[147]=s&~(1<<e);l=o}}while(0);k=e<<3;o=k-p|0;h[a+4>>2]=p|3;s=a+p|0;h[a+(p|4)>>2]=o|1;h[a+k>>2]=o;if(l){n=h[152]|0;r=l>>>3;t=r<<1;i=628+(t<<2)|0;e=h[147]|0;r=1<<r;if(e&r){e=628+(t+2<<2)|0;t=h[e>>2]|0;if(t>>>0<(h[151]|0)>>>0)De();else{c=e;d=t}}else{h[147]=e|r;c=628+(t+2<<2)|0;d=i}h[c>>2]=n;h[d+12>>2]=n;h[n+8>>2]=d;h[n+12>>2]=i}h[149]=o;h[152]=s;k=u;return k|0}e=h[148]|0;if(e){r=(e&0-e)+-1|0;F=r>>>12&16;r=r>>>F;B=r>>>5&8;r=r>>>B;k=r>>>2&4;r=r>>>k;e=r>>>1&2;r=r>>>e;i=r>>>1&1;i=h[892+((B|F|k|e|i)+(r>>>i)<<2)>>2]|0;r=(h[i+4>>2]&-8)-p|0;e=i;while(1){t=h[e+16>>2]|0;if(!t){t=h[e+20>>2]|0;if(!t){u=r;break}}e=(h[t+4>>2]&-8)-p|0;k=e>>>0<r>>>0;r=k?e:r;e=t;i=k?t:i}a=h[151]|0;if(i>>>0<a>>>0)De();s=i+p|0;if(i>>>0>=s>>>0)De();o=h[i+24>>2]|0;r=h[i+12>>2]|0;do{if((r|0)==(i|0)){e=i+20|0;t=h[e>>2]|0;if(!t){e=i+16|0;t=h[e>>2]|0;if(!t){f=0;break}}while(1){r=t+20|0;n=h[r>>2]|0;if(n){t=n;e=r;continue}r=t+16|0;n=h[r>>2]|0;if(!n)break;else{t=n;e=r}}if(e>>>0<a>>>0)De();else{h[e>>2]=0;f=t;break}}else{n=h[i+8>>2]|0;if(n>>>0<a>>>0)De();t=n+12|0;if((h[t>>2]|0)!=(i|0))De();e=r+8|0;if((h[e>>2]|0)==(i|0)){h[t>>2]=r;h[e>>2]=n;f=r;break}else De()}}while(0);do{if(o){t=h[i+28>>2]|0;e=892+(t<<2)|0;if((i|0)==(h[e>>2]|0)){h[e>>2]=f;if(!f){h[148]=h[148]&~(1<<t);break}}else{if(o>>>0<(h[151]|0)>>>0)De();t=o+16|0;if((h[t>>2]|0)==(i|0))h[t>>2]=f;else h[o+20>>2]=f;if(!f)break}e=h[151]|0;if(f>>>0<e>>>0)De();h[f+24>>2]=o;t=h[i+16>>2]|0;do{if(t)if(t>>>0<e>>>0)De();else{h[f+16>>2]=t;h[t+24>>2]=f;break}}while(0);t=h[i+20>>2]|0;if(t)if(t>>>0<(h[151]|0)>>>0)De();else{h[f+20>>2]=t;h[t+24>>2]=f;break}}}while(0);if(u>>>0<16){k=u+p|0;h[i+4>>2]=k|3;k=i+(k+4)|0;h[k>>2]=h[k>>2]|1}else{h[i+4>>2]=p|3;h[i+(p|4)>>2]=u|1;h[i+(u+p)>>2]=u;t=h[149]|0;if(t){a=h[152]|0;r=t>>>3;t=r<<1;n=628+(t<<2)|0;e=h[147]|0;r=1<<r;if(e&r){t=628+(t+2<<2)|0;e=h[t>>2]|0;if(e>>>0<(h[151]|0)>>>0)De();else{m=t;v=e}}else{h[147]=e|r;m=628+(t+2<<2)|0;v=n}h[m>>2]=a;h[v+12>>2]=a;h[a+8>>2]=v;h[a+12>>2]=n}h[149]=u;h[152]=s}k=i+8|0;return k|0}else v=p}else v=p}else if(e>>>0<=4294967231){e=e+11|0;d=e&-8;c=h[148]|0;if(c){r=0-d|0;e=e>>>8;if(e)if(d>>>0>16777215)l=31;else{v=(e+1048320|0)>>>16&8;C=e<<v;m=(C+520192|0)>>>16&4;C=C<<m;l=(C+245760|0)>>>16&2;l=14-(m|v|l)+(C<<l>>>15)|0;l=d>>>(l+7|0)&1|l<<1}else l=0;e=h[892+(l<<2)>>2]|0;e:do{if(!e){n=0;e=0;C=86}else{o=r;n=0;s=d<<((l|0)==31?0:25-(l>>>1)|0);u=e;e=0;while(1){a=h[u+4>>2]&-8;r=a-d|0;if(r>>>0<o>>>0)if((a|0)==(d|0)){a=u;e=u;C=90;break e}else e=u;else r=o;C=h[u+20>>2]|0;u=h[u+16+(s>>>31<<2)>>2]|0;n=(C|0)==0|(C|0)==(u|0)?n:C;if(!u){C=86;break}else{o=r;s=s<<1}}}}while(0);if((C|0)==86){if((n|0)==0&(e|0)==0){e=2<<l;e=c&(e|0-e);if(!e){v=d;break}e=(e&0-e)+-1|0;f=e>>>12&16;e=e>>>f;c=e>>>5&8;e=e>>>c;m=e>>>2&4;e=e>>>m;v=e>>>1&2;e=e>>>v;n=e>>>1&1;n=h[892+((c|f|m|v|n)+(e>>>n)<<2)>>2]|0;e=0}if(!n){s=r;u=e}else{a=n;C=90}}if((C|0)==90)while(1){C=0;v=(h[a+4>>2]&-8)-d|0;n=v>>>0<r>>>0;r=n?v:r;e=n?a:e;n=h[a+16>>2]|0;if(n){a=n;C=90;continue}a=h[a+20>>2]|0;if(!a){s=r;u=e;break}else C=90}if((u|0)!=0?s>>>0<((h[149]|0)-d|0)>>>0:0){n=h[151]|0;if(u>>>0<n>>>0)De();o=u+d|0;if(u>>>0>=o>>>0)De();a=h[u+24>>2]|0;r=h[u+12>>2]|0;do{if((r|0)==(u|0)){e=u+20|0;t=h[e>>2]|0;if(!t){e=u+16|0;t=h[e>>2]|0;if(!t){p=0;break}}while(1){r=t+20|0;i=h[r>>2]|0;if(i){t=i;e=r;continue}r=t+16|0;i=h[r>>2]|0;if(!i)break;else{t=i;e=r}}if(e>>>0<n>>>0)De();else{h[e>>2]=0;p=t;break}}else{i=h[u+8>>2]|0;if(i>>>0<n>>>0)De();t=i+12|0;if((h[t>>2]|0)!=(u|0))De();e=r+8|0;if((h[e>>2]|0)==(u|0)){h[t>>2]=r;h[e>>2]=i;p=r;break}else De()}}while(0);do{if(a){t=h[u+28>>2]|0;e=892+(t<<2)|0;if((u|0)==(h[e>>2]|0)){h[e>>2]=p;if(!p){h[148]=h[148]&~(1<<t);break}}else{if(a>>>0<(h[151]|0)>>>0)De();t=a+16|0;if((h[t>>2]|0)==(u|0))h[t>>2]=p;else h[a+20>>2]=p;if(!p)break}e=h[151]|0;if(p>>>0<e>>>0)De();h[p+24>>2]=a;t=h[u+16>>2]|0;do{if(t)if(t>>>0<e>>>0)De();else{h[p+16>>2]=t;h[t+24>>2]=p;break}}while(0);t=h[u+20>>2]|0;if(t)if(t>>>0<(h[151]|0)>>>0)De();else{h[p+20>>2]=t;h[t+24>>2]=p;break}}}while(0);e:do{if(s>>>0>=16){h[u+4>>2]=d|3;h[u+(d|4)>>2]=s|1;h[u+(s+d)>>2]=s;t=s>>>3;if(s>>>0<256){e=t<<1;i=628+(e<<2)|0;r=h[147]|0;t=1<<t;if(r&t){t=628+(e+2<<2)|0;e=h[t>>2]|0;if(e>>>0<(h[151]|0)>>>0)De();else{g=t;y=e}}else{h[147]=r|t;g=628+(e+2<<2)|0;y=i}h[g>>2]=o;h[y+12>>2]=o;h[u+(d+8)>>2]=y;h[u+(d+12)>>2]=i;break}t=s>>>8;if(t)if(s>>>0>16777215)i=31;else{F=(t+1048320|0)>>>16&8;k=t<<F;B=(k+520192|0)>>>16&4;k=k<<B;i=(k+245760|0)>>>16&2;i=14-(B|F|i)+(k<<i>>>15)|0;i=s>>>(i+7|0)&1|i<<1}else i=0;t=892+(i<<2)|0;h[u+(d+28)>>2]=i;h[u+(d+20)>>2]=0;h[u+(d+16)>>2]=0;e=h[148]|0;r=1<<i;if(!(e&r)){h[148]=e|r;h[t>>2]=o;h[u+(d+24)>>2]=t;h[u+(d+12)>>2]=o;h[u+(d+8)>>2]=o;break}t=h[t>>2]|0;t:do{if((h[t+4>>2]&-8|0)!=(s|0)){i=s<<((i|0)==31?0:25-(i>>>1)|0);while(1){e=t+16+(i>>>31<<2)|0;r=h[e>>2]|0;if(!r)break;if((h[r+4>>2]&-8|0)==(s|0)){E=r;break t}else{i=i<<1;t=r}}if(e>>>0<(h[151]|0)>>>0)De();else{h[e>>2]=o;h[u+(d+24)>>2]=t;h[u+(d+12)>>2]=o;h[u+(d+8)>>2]=o;break e}}else E=t}while(0);t=E+8|0;e=h[t>>2]|0;k=h[151]|0;if(e>>>0>=k>>>0&E>>>0>=k>>>0){h[e+12>>2]=o;h[t>>2]=o;h[u+(d+8)>>2]=e;h[u+(d+12)>>2]=E;h[u+(d+24)>>2]=0;break}else De()}else{k=s+d|0;h[u+4>>2]=k|3;k=u+(k+4)|0;h[k>>2]=h[k>>2]|1}}while(0);k=u+8|0;return k|0}else v=d}else v=d}else v=-1}while(0);r=h[149]|0;if(r>>>0>=v>>>0){t=r-v|0;e=h[152]|0;if(t>>>0>15){h[152]=e+v;h[149]=t;h[e+(v+4)>>2]=t|1;h[e+r>>2]=t;h[e+4>>2]=v|3}else{h[149]=0;h[152]=0;h[e+4>>2]=r|3;k=e+(r+4)|0;h[k>>2]=h[k>>2]|1}k=e+8|0;return k|0}e=h[150]|0;if(e>>>0>v>>>0){F=e-v|0;h[150]=F;k=h[153]|0;h[153]=k+v;h[k+(v+4)>>2]=F|1;h[k+4>>2]=v|3;k=k+8|0;return k|0}do{if(!(h[265]|0)){e=Ue(30)|0;if(!(e+-1&e)){h[267]=e;h[266]=e;h[268]=-1;h[269]=-1;h[270]=0;h[258]=0;E=(Re(0)|0)&-16^1431655768;h[265]=E;break}else De()}}while(0);u=v+48|0;s=h[267]|0;l=v+47|0;o=s+l|0;s=0-s|0;c=o&s;if(c>>>0<=v>>>0){k=0;return k|0}e=h[257]|0;if((e|0)!=0?(y=h[255]|0,E=y+c|0,E>>>0<=y>>>0|E>>>0>e>>>0):0){k=0;return k|0}e:do{if(!(h[258]&4)){e=h[153]|0;t:do{if(e){n=1036;while(1){r=h[n>>2]|0;if(r>>>0<=e>>>0?(_=n+4|0,(r+(h[_>>2]|0)|0)>>>0>e>>>0):0){a=n;e=_;break}n=h[n+8>>2]|0;if(!n){C=174;break t}}r=o-(h[150]|0)&s;if(r>>>0<2147483647){n=Oe(r|0)|0;E=(n|0)==((h[a>>2]|0)+(h[e>>2]|0)|0);e=E?r:0;if(E){if((n|0)!=(-1|0)){b=n;m=e;C=194;break e}}else C=184}else e=0}else C=174}while(0);do{if((C|0)==174){a=Oe(0)|0;if((a|0)!=(-1|0)){e=a;r=h[266]|0;n=r+-1|0;if(!(n&e))r=c;else r=c-e+(n+e&0-r)|0;e=h[255]|0;n=e+r|0;if(r>>>0>v>>>0&r>>>0<2147483647){E=h[257]|0;if((E|0)!=0?n>>>0<=e>>>0|n>>>0>E>>>0:0){e=0;break}n=Oe(r|0)|0;E=(n|0)==(a|0);e=E?r:0;if(E){b=a;m=e;C=194;break e}else C=184}else e=0}else e=0}}while(0);t:do{if((C|0)==184){a=0-r|0;do{if(u>>>0>r>>>0&(r>>>0<2147483647&(n|0)!=(-1|0))?(w=h[267]|0,w=l-r+w&0-w,w>>>0<2147483647):0)if((Oe(w|0)|0)==(-1|0)){Oe(a|0)|0;break t}else{r=w+r|0;break}}while(0);if((n|0)!=(-1|0)){b=n;m=r;C=194;break e}}}while(0);h[258]=h[258]|4;C=191}else{e=0;C=191}}while(0);if((((C|0)==191?c>>>0<2147483647:0)?(b=Oe(c|0)|0,S=Oe(0)|0,b>>>0<S>>>0&((b|0)!=(-1|0)&(S|0)!=(-1|0))):0)?(T=S-b|0,x=T>>>0>(v+40|0)>>>0,x):0){m=x?T:e;C=194}if((C|0)==194){e=(h[255]|0)+m|0;h[255]=e;if(e>>>0>(h[256]|0)>>>0)h[256]=e;o=h[153]|0;e:do{if(o){a=1036;do{e=h[a>>2]|0;r=a+4|0;n=h[r>>2]|0;if((b|0)==(e+n|0)){A=e;P=r;D=n;M=a;C=204;break}a=h[a+8>>2]|0}while((a|0)!=0);if(((C|0)==204?(h[M+12>>2]&8|0)==0:0)?o>>>0<b>>>0&o>>>0>=A>>>0:0){h[P>>2]=D+m;k=(h[150]|0)+m|0;F=o+8|0;F=(F&7|0)==0?0:0-F&7;B=k-F|0;h[153]=o+F;h[150]=B;h[o+(F+4)>>2]=B|1;h[o+(k+4)>>2]=40;h[154]=h[269];break}e=h[151]|0;if(b>>>0<e>>>0){h[151]=b;e=b}r=b+m|0;a=1036;while(1){if((h[a>>2]|0)==(r|0)){n=a;r=a;C=212;break}a=h[a+8>>2]|0;if(!a){r=1036;break}}if((C|0)==212)if(!(h[r+12>>2]&8)){h[n>>2]=b;f=r+4|0;h[f>>2]=(h[f>>2]|0)+m;f=b+8|0;f=(f&7|0)==0?0:0-f&7;l=b+(m+8)|0;l=(l&7|0)==0?0:0-l&7;t=b+(l+m)|0;d=f+v|0;p=b+d|0;c=t-(b+f)-v|0;h[b+(f+4)>>2]=v|3;t:do{if((t|0)!=(o|0)){if((t|0)==(h[152]|0)){k=(h[149]|0)+c|0;h[149]=k;h[152]=p;h[b+(d+4)>>2]=k|1;h[b+(k+d)>>2]=k;break}s=m+4|0;r=h[b+(s+l)>>2]|0;if((r&3|0)==1){u=r&-8;a=r>>>3;r:do{if(r>>>0>=256){o=h[b+((l|24)+m)>>2]|0;i=h[b+(m+12+l)>>2]|0;do{if((i|0)==(t|0)){n=l|16;i=b+(s+n)|0;r=h[i>>2]|0;if(!r){i=b+(n+m)|0;r=h[i>>2]|0;if(!r){L=0;break}}while(1){n=r+20|0;a=h[n>>2]|0;if(a){r=a;i=n;continue}n=r+16|0;a=h[n>>2]|0;if(!a)break;else{r=a;i=n}}if(i>>>0<e>>>0)De();else{h[i>>2]=0;L=r;break}}else{n=h[b+((l|8)+m)>>2]|0;if(n>>>0<e>>>0)De();e=n+12|0;if((h[e>>2]|0)!=(t|0))De();r=i+8|0;if((h[r>>2]|0)==(t|0)){h[e>>2]=i;h[r>>2]=n;L=i;break}else De()}}while(0);if(!o)break;e=h[b+(m+28+l)>>2]|0;r=892+(e<<2)|0;do{if((t|0)!=(h[r>>2]|0)){if(o>>>0<(h[151]|0)>>>0)De();e=o+16|0;if((h[e>>2]|0)==(t|0))h[e>>2]=L;else h[o+20>>2]=L;if(!L)break r}else{h[r>>2]=L;if(L)break;h[148]=h[148]&~(1<<e);break r}}while(0);r=h[151]|0;if(L>>>0<r>>>0)De();h[L+24>>2]=o;t=l|16;e=h[b+(t+m)>>2]|0;do{if(e)if(e>>>0<r>>>0)De();else{h[L+16>>2]=e;h[e+24>>2]=L;break}}while(0);t=h[b+(s+t)>>2]|0;if(!t)break;if(t>>>0<(h[151]|0)>>>0)De();else{h[L+20>>2]=t;h[t+24>>2]=L;break}}else{i=h[b+((l|8)+m)>>2]|0;n=h[b+(m+12+l)>>2]|0;r=628+(a<<1<<2)|0;do{if((i|0)!=(r|0)){if(i>>>0<e>>>0)De();if((h[i+12>>2]|0)==(t|0))break;De()}}while(0);if((n|0)==(i|0)){h[147]=h[147]&~(1<<a);break}do{if((n|0)==(r|0))I=n+8|0;else{if(n>>>0<e>>>0)De();e=n+8|0;if((h[e>>2]|0)==(t|0)){I=e;break}De()}}while(0);h[i+12>>2]=n;h[I>>2]=i}}while(0);t=b+((u|l)+m)|0;n=u+c|0}else n=c;t=t+4|0;h[t>>2]=h[t>>2]&-2;h[b+(d+4)>>2]=n|1;h[b+(n+d)>>2]=n;t=n>>>3;if(n>>>0<256){e=t<<1;i=628+(e<<2)|0;r=h[147]|0;t=1<<t;do{if(!(r&t)){h[147]=r|t;B=628+(e+2<<2)|0;F=i}else{t=628+(e+2<<2)|0;e=h[t>>2]|0;if(e>>>0>=(h[151]|0)>>>0){B=t;F=e;break}De()}}while(0);h[B>>2]=p;h[F+12>>2]=p;h[b+(d+8)>>2]=F;h[b+(d+12)>>2]=i;break}t=n>>>8;do{if(!t)i=0;else{
if(n>>>0>16777215){i=31;break}B=(t+1048320|0)>>>16&8;F=t<<B;L=(F+520192|0)>>>16&4;F=F<<L;i=(F+245760|0)>>>16&2;i=14-(L|B|i)+(F<<i>>>15)|0;i=n>>>(i+7|0)&1|i<<1}}while(0);t=892+(i<<2)|0;h[b+(d+28)>>2]=i;h[b+(d+20)>>2]=0;h[b+(d+16)>>2]=0;e=h[148]|0;r=1<<i;if(!(e&r)){h[148]=e|r;h[t>>2]=p;h[b+(d+24)>>2]=t;h[b+(d+12)>>2]=p;h[b+(d+8)>>2]=p;break}t=h[t>>2]|0;r:do{if((h[t+4>>2]&-8|0)!=(n|0)){i=n<<((i|0)==31?0:25-(i>>>1)|0);while(1){e=t+16+(i>>>31<<2)|0;r=h[e>>2]|0;if(!r)break;if((h[r+4>>2]&-8|0)==(n|0)){k=r;break r}else{i=i<<1;t=r}}if(e>>>0<(h[151]|0)>>>0)De();else{h[e>>2]=p;h[b+(d+24)>>2]=t;h[b+(d+12)>>2]=p;h[b+(d+8)>>2]=p;break t}}else k=t}while(0);t=k+8|0;e=h[t>>2]|0;F=h[151]|0;if(e>>>0>=F>>>0&k>>>0>=F>>>0){h[e+12>>2]=p;h[t>>2]=p;h[b+(d+8)>>2]=e;h[b+(d+12)>>2]=k;h[b+(d+24)>>2]=0;break}else De()}else{k=(h[150]|0)+c|0;h[150]=k;h[153]=p;h[b+(d+4)>>2]=k|1}}while(0);k=b+(f|8)|0;return k|0}else r=1036;while(1){e=h[r>>2]|0;if(e>>>0<=o>>>0?(t=h[r+4>>2]|0,i=e+t|0,i>>>0>o>>>0):0)break;r=h[r+8>>2]|0}n=e+(t+-39)|0;e=e+(t+-47+((n&7|0)==0?0:0-n&7))|0;n=o+16|0;e=e>>>0<n>>>0?o:e;t=e+8|0;r=b+8|0;r=(r&7|0)==0?0:0-r&7;k=m+-40-r|0;h[153]=b+r;h[150]=k;h[b+(r+4)>>2]=k|1;h[b+(m+-36)>>2]=40;h[154]=h[269];r=e+4|0;h[r>>2]=27;h[t>>2]=h[259];h[t+4>>2]=h[260];h[t+8>>2]=h[261];h[t+12>>2]=h[262];h[259]=b;h[260]=m;h[262]=0;h[261]=t;t=e+28|0;h[t>>2]=7;if((e+32|0)>>>0<i>>>0)do{k=t;t=t+4|0;h[t>>2]=7}while((k+8|0)>>>0<i>>>0);if((e|0)!=(o|0)){a=e-o|0;h[r>>2]=h[r>>2]&-2;h[o+4>>2]=a|1;h[e>>2]=a;t=a>>>3;if(a>>>0<256){e=t<<1;i=628+(e<<2)|0;r=h[147]|0;t=1<<t;if(r&t){t=628+(e+2<<2)|0;e=h[t>>2]|0;if(e>>>0<(h[151]|0)>>>0)De();else{O=t;R=e}}else{h[147]=r|t;O=628+(e+2<<2)|0;R=i}h[O>>2]=o;h[R+12>>2]=o;h[o+8>>2]=R;h[o+12>>2]=i;break}t=a>>>8;if(t)if(a>>>0>16777215)i=31;else{F=(t+1048320|0)>>>16&8;k=t<<F;B=(k+520192|0)>>>16&4;k=k<<B;i=(k+245760|0)>>>16&2;i=14-(B|F|i)+(k<<i>>>15)|0;i=a>>>(i+7|0)&1|i<<1}else i=0;r=892+(i<<2)|0;h[o+28>>2]=i;h[o+20>>2]=0;h[n>>2]=0;t=h[148]|0;e=1<<i;if(!(t&e)){h[148]=t|e;h[r>>2]=o;h[o+24>>2]=r;h[o+12>>2]=o;h[o+8>>2]=o;break}t=h[r>>2]|0;t:do{if((h[t+4>>2]&-8|0)!=(a|0)){i=a<<((i|0)==31?0:25-(i>>>1)|0);while(1){e=t+16+(i>>>31<<2)|0;r=h[e>>2]|0;if(!r)break;if((h[r+4>>2]&-8|0)==(a|0)){N=r;break t}else{i=i<<1;t=r}}if(e>>>0<(h[151]|0)>>>0)De();else{h[e>>2]=o;h[o+24>>2]=t;h[o+12>>2]=o;h[o+8>>2]=o;break e}}else N=t}while(0);t=N+8|0;e=h[t>>2]|0;k=h[151]|0;if(e>>>0>=k>>>0&N>>>0>=k>>>0){h[e+12>>2]=o;h[t>>2]=o;h[o+8>>2]=e;h[o+12>>2]=N;h[o+24>>2]=0;break}else De()}}else{k=h[151]|0;if((k|0)==0|b>>>0<k>>>0)h[151]=b;h[259]=b;h[260]=m;h[262]=0;h[156]=h[265];h[155]=-1;t=0;do{k=t<<1;F=628+(k<<2)|0;h[628+(k+3<<2)>>2]=F;h[628+(k+2<<2)>>2]=F;t=t+1|0}while((t|0)!=32);k=b+8|0;k=(k&7|0)==0?0:0-k&7;F=m+-40-k|0;h[153]=b+k;h[150]=F;h[b+(k+4)>>2]=F|1;h[b+(m+-36)>>2]=40;h[154]=h[269]}}while(0);t=h[150]|0;if(t>>>0>v>>>0){F=t-v|0;h[150]=F;k=h[153]|0;h[153]=k+v;h[k+(v+4)>>2]=F|1;h[k+4>>2]=v|3;k=k+8|0;return k|0}}k=ur()|0;h[k>>2]=12;k=0;return k|0}function zr(e){e=e|0;var t=0,r=0,i=0,n=0,a=0,o=0,s=0,u=0,l=0,c=0,d=0,f=0,p=0,m=0,v=0,_=0,g=0,y=0,w=0;if(!e)return;t=e+-8|0;s=h[151]|0;if(t>>>0<s>>>0)De();r=h[e+-4>>2]|0;i=r&3;if((i|0)==1)De();p=r&-8;v=e+(p+-8)|0;do{if(!(r&1)){t=h[t>>2]|0;if(!i)return;u=-8-t|0;c=e+u|0;d=t+p|0;if(c>>>0<s>>>0)De();if((c|0)==(h[152]|0)){t=e+(p+-4)|0;r=h[t>>2]|0;if((r&3|0)!=3){w=c;a=d;break}h[149]=d;h[t>>2]=r&-2;h[e+(u+4)>>2]=d|1;h[v>>2]=d;return}n=t>>>3;if(t>>>0<256){i=h[e+(u+8)>>2]|0;r=h[e+(u+12)>>2]|0;t=628+(n<<1<<2)|0;if((i|0)!=(t|0)){if(i>>>0<s>>>0)De();if((h[i+12>>2]|0)!=(c|0))De()}if((r|0)==(i|0)){h[147]=h[147]&~(1<<n);w=c;a=d;break}if((r|0)!=(t|0)){if(r>>>0<s>>>0)De();t=r+8|0;if((h[t>>2]|0)==(c|0))o=t;else De()}else o=r+8|0;h[i+12>>2]=r;h[o>>2]=i;w=c;a=d;break}o=h[e+(u+24)>>2]|0;i=h[e+(u+12)>>2]|0;do{if((i|0)==(c|0)){r=e+(u+20)|0;t=h[r>>2]|0;if(!t){r=e+(u+16)|0;t=h[r>>2]|0;if(!t){l=0;break}}while(1){i=t+20|0;n=h[i>>2]|0;if(n){t=n;r=i;continue}i=t+16|0;n=h[i>>2]|0;if(!n)break;else{t=n;r=i}}if(r>>>0<s>>>0)De();else{h[r>>2]=0;l=t;break}}else{n=h[e+(u+8)>>2]|0;if(n>>>0<s>>>0)De();t=n+12|0;if((h[t>>2]|0)!=(c|0))De();r=i+8|0;if((h[r>>2]|0)==(c|0)){h[t>>2]=i;h[r>>2]=n;l=i;break}else De()}}while(0);if(o){t=h[e+(u+28)>>2]|0;r=892+(t<<2)|0;if((c|0)==(h[r>>2]|0)){h[r>>2]=l;if(!l){h[148]=h[148]&~(1<<t);w=c;a=d;break}}else{if(o>>>0<(h[151]|0)>>>0)De();t=o+16|0;if((h[t>>2]|0)==(c|0))h[t>>2]=l;else h[o+20>>2]=l;if(!l){w=c;a=d;break}}r=h[151]|0;if(l>>>0<r>>>0)De();h[l+24>>2]=o;t=h[e+(u+16)>>2]|0;do{if(t)if(t>>>0<r>>>0)De();else{h[l+16>>2]=t;h[t+24>>2]=l;break}}while(0);t=h[e+(u+20)>>2]|0;if(t)if(t>>>0<(h[151]|0)>>>0)De();else{h[l+20>>2]=t;h[t+24>>2]=l;w=c;a=d;break}else{w=c;a=d}}else{w=c;a=d}}else{w=t;a=p}}while(0);if(w>>>0>=v>>>0)De();t=e+(p+-4)|0;r=h[t>>2]|0;if(!(r&1))De();if(!(r&2)){if((v|0)==(h[153]|0)){y=(h[150]|0)+a|0;h[150]=y;h[153]=w;h[w+4>>2]=y|1;if((w|0)!=(h[152]|0))return;h[152]=0;h[149]=0;return}if((v|0)==(h[152]|0)){y=(h[149]|0)+a|0;h[149]=y;h[152]=w;h[w+4>>2]=y|1;h[w+y>>2]=y;return}a=(r&-8)+a|0;n=r>>>3;do{if(r>>>0>=256){o=h[e+(p+16)>>2]|0;t=h[e+(p|4)>>2]|0;do{if((t|0)==(v|0)){r=e+(p+12)|0;t=h[r>>2]|0;if(!t){r=e+(p+8)|0;t=h[r>>2]|0;if(!t){m=0;break}}while(1){i=t+20|0;n=h[i>>2]|0;if(n){t=n;r=i;continue}i=t+16|0;n=h[i>>2]|0;if(!n)break;else{t=n;r=i}}if(r>>>0<(h[151]|0)>>>0)De();else{h[r>>2]=0;m=t;break}}else{r=h[e+p>>2]|0;if(r>>>0<(h[151]|0)>>>0)De();i=r+12|0;if((h[i>>2]|0)!=(v|0))De();n=t+8|0;if((h[n>>2]|0)==(v|0)){h[i>>2]=t;h[n>>2]=r;m=t;break}else De()}}while(0);if(o){t=h[e+(p+20)>>2]|0;r=892+(t<<2)|0;if((v|0)==(h[r>>2]|0)){h[r>>2]=m;if(!m){h[148]=h[148]&~(1<<t);break}}else{if(o>>>0<(h[151]|0)>>>0)De();t=o+16|0;if((h[t>>2]|0)==(v|0))h[t>>2]=m;else h[o+20>>2]=m;if(!m)break}r=h[151]|0;if(m>>>0<r>>>0)De();h[m+24>>2]=o;t=h[e+(p+8)>>2]|0;do{if(t)if(t>>>0<r>>>0)De();else{h[m+16>>2]=t;h[t+24>>2]=m;break}}while(0);t=h[e+(p+12)>>2]|0;if(t)if(t>>>0<(h[151]|0)>>>0)De();else{h[m+20>>2]=t;h[t+24>>2]=m;break}}}else{i=h[e+p>>2]|0;r=h[e+(p|4)>>2]|0;t=628+(n<<1<<2)|0;if((i|0)!=(t|0)){if(i>>>0<(h[151]|0)>>>0)De();if((h[i+12>>2]|0)!=(v|0))De()}if((r|0)==(i|0)){h[147]=h[147]&~(1<<n);break}if((r|0)!=(t|0)){if(r>>>0<(h[151]|0)>>>0)De();t=r+8|0;if((h[t>>2]|0)==(v|0))f=t;else De()}else f=r+8|0;h[i+12>>2]=r;h[f>>2]=i}}while(0);h[w+4>>2]=a|1;h[w+a>>2]=a;if((w|0)==(h[152]|0)){h[149]=a;return}}else{h[t>>2]=r&-2;h[w+4>>2]=a|1;h[w+a>>2]=a}t=a>>>3;if(a>>>0<256){r=t<<1;n=628+(r<<2)|0;i=h[147]|0;t=1<<t;if(i&t){t=628+(r+2<<2)|0;r=h[t>>2]|0;if(r>>>0<(h[151]|0)>>>0)De();else{_=t;g=r}}else{h[147]=i|t;_=628+(r+2<<2)|0;g=n}h[_>>2]=w;h[g+12>>2]=w;h[w+8>>2]=g;h[w+12>>2]=n;return}t=a>>>8;if(t)if(a>>>0>16777215)n=31;else{_=(t+1048320|0)>>>16&8;g=t<<_;v=(g+520192|0)>>>16&4;g=g<<v;n=(g+245760|0)>>>16&2;n=14-(v|_|n)+(g<<n>>>15)|0;n=a>>>(n+7|0)&1|n<<1}else n=0;t=892+(n<<2)|0;h[w+28>>2]=n;h[w+20>>2]=0;h[w+16>>2]=0;r=h[148]|0;i=1<<n;e:do{if(r&i){t=h[t>>2]|0;t:do{if((h[t+4>>2]&-8|0)!=(a|0)){n=a<<((n|0)==31?0:25-(n>>>1)|0);while(1){r=t+16+(n>>>31<<2)|0;i=h[r>>2]|0;if(!i)break;if((h[i+4>>2]&-8|0)==(a|0)){y=i;break t}else{n=n<<1;t=i}}if(r>>>0<(h[151]|0)>>>0)De();else{h[r>>2]=w;h[w+24>>2]=t;h[w+12>>2]=w;h[w+8>>2]=w;break e}}else y=t}while(0);t=y+8|0;r=h[t>>2]|0;g=h[151]|0;if(r>>>0>=g>>>0&y>>>0>=g>>>0){h[r+12>>2]=w;h[t>>2]=w;h[w+8>>2]=r;h[w+12>>2]=y;h[w+24>>2]=0;break}else De()}else{h[148]=r|i;h[t>>2]=w;h[w+24>>2]=t;h[w+12>>2]=w;h[w+8>>2]=w}}while(0);w=(h[155]|0)+-1|0;h[155]=w;if(!w)t=1044;else return;while(1){t=h[t>>2]|0;if(!t)break;else t=t+8|0}h[155]=-1;return}function Ur(e,t){e=e|0;t=t|0;var r=0,i=0;if(!e){e=Vr(t)|0;return e|0}if(t>>>0>4294967231){e=ur()|0;h[e>>2]=12;e=0;return e|0}r=Gr(e+-8|0,t>>>0<11?16:t+11&-8)|0;if(r){e=r+8|0;return e|0}r=Vr(t)|0;if(!r){e=0;return e|0}i=h[e+-4>>2]|0;i=(i&-8)-((i&3|0)==0?8:4)|0;Qr(r|0,e|0,(i>>>0<t>>>0?i:t)|0)|0;zr(e);e=r;return e|0}function qr(e){e=e|0;var t=0;if(!e){t=0;return t|0}e=h[e+-4>>2]|0;t=e&3;if((t|0)==1){t=0;return t|0}t=(e&-8)-((t|0)==0?8:4)|0;return t|0}function Gr(e,t){e=e|0;t=t|0;var r=0,i=0,n=0,a=0,o=0,s=0,u=0,l=0,c=0,d=0,f=0,p=0,m=0;p=e+4|0;m=h[p>>2]|0;u=m&-8;c=e+u|0;s=h[151]|0;r=m&3;if(!((r|0)!=1&e>>>0>=s>>>0&e>>>0<c>>>0))De();i=e+(u|4)|0;n=h[i>>2]|0;if(!(n&1))De();if(!r){if(t>>>0<256){e=0;return e|0}if(u>>>0>=(t+4|0)>>>0?(u-t|0)>>>0<=h[267]<<1>>>0:0)return e|0;e=0;return e|0}if(u>>>0>=t>>>0){r=u-t|0;if(r>>>0<=15)return e|0;h[p>>2]=m&1|t|2;h[e+(t+4)>>2]=r|3;h[i>>2]=h[i>>2]|1;Hr(e+t|0,r);return e|0}if((c|0)==(h[153]|0)){r=(h[150]|0)+u|0;if(r>>>0<=t>>>0){e=0;return e|0}f=r-t|0;h[p>>2]=m&1|t|2;h[e+(t+4)>>2]=f|1;h[153]=e+t;h[150]=f;return e|0}if((c|0)==(h[152]|0)){i=(h[149]|0)+u|0;if(i>>>0<t>>>0){e=0;return e|0}r=i-t|0;if(r>>>0>15){h[p>>2]=m&1|t|2;h[e+(t+4)>>2]=r|1;h[e+i>>2]=r;i=e+(i+4)|0;h[i>>2]=h[i>>2]&-2;i=e+t|0}else{h[p>>2]=m&1|i|2;i=e+(i+4)|0;h[i>>2]=h[i>>2]|1;i=0;r=0}h[149]=r;h[152]=i;return e|0}if(n&2){e=0;return e|0}d=(n&-8)+u|0;if(d>>>0<t>>>0){e=0;return e|0}f=d-t|0;a=n>>>3;do{if(n>>>0>=256){o=h[e+(u+24)>>2]|0;a=h[e+(u+12)>>2]|0;do{if((a|0)==(c|0)){i=e+(u+20)|0;r=h[i>>2]|0;if(!r){i=e+(u+16)|0;r=h[i>>2]|0;if(!r){l=0;break}}while(1){n=r+20|0;a=h[n>>2]|0;if(a){r=a;i=n;continue}n=r+16|0;a=h[n>>2]|0;if(!a)break;else{r=a;i=n}}if(i>>>0<s>>>0)De();else{h[i>>2]=0;l=r;break}}else{n=h[e+(u+8)>>2]|0;if(n>>>0<s>>>0)De();r=n+12|0;if((h[r>>2]|0)!=(c|0))De();i=a+8|0;if((h[i>>2]|0)==(c|0)){h[r>>2]=a;h[i>>2]=n;l=a;break}else De()}}while(0);if(o){r=h[e+(u+28)>>2]|0;i=892+(r<<2)|0;if((c|0)==(h[i>>2]|0)){h[i>>2]=l;if(!l){h[148]=h[148]&~(1<<r);break}}else{if(o>>>0<(h[151]|0)>>>0)De();r=o+16|0;if((h[r>>2]|0)==(c|0))h[r>>2]=l;else h[o+20>>2]=l;if(!l)break}i=h[151]|0;if(l>>>0<i>>>0)De();h[l+24>>2]=o;r=h[e+(u+16)>>2]|0;do{if(r)if(r>>>0<i>>>0)De();else{h[l+16>>2]=r;h[r+24>>2]=l;break}}while(0);r=h[e+(u+20)>>2]|0;if(r)if(r>>>0<(h[151]|0)>>>0)De();else{h[l+20>>2]=r;h[r+24>>2]=l;break}}}else{n=h[e+(u+8)>>2]|0;i=h[e+(u+12)>>2]|0;r=628+(a<<1<<2)|0;if((n|0)!=(r|0)){if(n>>>0<s>>>0)De();if((h[n+12>>2]|0)!=(c|0))De()}if((i|0)==(n|0)){h[147]=h[147]&~(1<<a);break}if((i|0)!=(r|0)){if(i>>>0<s>>>0)De();r=i+8|0;if((h[r>>2]|0)==(c|0))o=r;else De()}else o=i+8|0;h[n+12>>2]=i;h[o>>2]=n}}while(0);if(f>>>0<16){h[p>>2]=d|m&1|2;t=e+(d|4)|0;h[t>>2]=h[t>>2]|1;return e|0}else{h[p>>2]=m&1|t|2;h[e+(t+4)>>2]=f|3;m=e+(d|4)|0;h[m>>2]=h[m>>2]|1;Hr(e+t|0,f);return e|0}return 0}function Hr(e,t){e=e|0;t=t|0;var r=0,i=0,n=0,a=0,o=0,s=0,u=0,l=0,c=0,d=0,f=0,p=0,m=0,v=0,_=0,g=0,y=0;v=e+t|0;r=h[e+4>>2]|0;do{if(!(r&1)){l=h[e>>2]|0;if(!(r&3))return;f=e+(0-l)|0;d=l+t|0;u=h[151]|0;if(f>>>0<u>>>0)De();if((f|0)==(h[152]|0)){i=e+(t+4)|0;r=h[i>>2]|0;if((r&3|0)!=3){y=f;o=d;break}h[149]=d;h[i>>2]=r&-2;h[e+(4-l)>>2]=d|1;h[v>>2]=d;return}a=l>>>3;if(l>>>0<256){n=h[e+(8-l)>>2]|0;i=h[e+(12-l)>>2]|0;r=628+(a<<1<<2)|0;if((n|0)!=(r|0)){if(n>>>0<u>>>0)De();if((h[n+12>>2]|0)!=(f|0))De()}if((i|0)==(n|0)){h[147]=h[147]&~(1<<a);y=f;o=d;break}if((i|0)!=(r|0)){if(i>>>0<u>>>0)De();r=i+8|0;if((h[r>>2]|0)==(f|0))s=r;else De()}else s=i+8|0;h[n+12>>2]=i;h[s>>2]=n;y=f;o=d;break}s=h[e+(24-l)>>2]|0;n=h[e+(12-l)>>2]|0;do{if((n|0)==(f|0)){n=16-l|0;i=e+(n+4)|0;r=h[i>>2]|0;if(!r){i=e+n|0;r=h[i>>2]|0;if(!r){c=0;break}}while(1){n=r+20|0;a=h[n>>2]|0;if(a){r=a;i=n;continue}n=r+16|0;a=h[n>>2]|0;if(!a)break;else{r=a;i=n}}if(i>>>0<u>>>0)De();else{h[i>>2]=0;c=r;break}}else{a=h[e+(8-l)>>2]|0;if(a>>>0<u>>>0)De();r=a+12|0;if((h[r>>2]|0)!=(f|0))De();i=n+8|0;if((h[i>>2]|0)==(f|0)){h[r>>2]=n;h[i>>2]=a;c=n;break}else De()}}while(0);if(s){r=h[e+(28-l)>>2]|0;i=892+(r<<2)|0;if((f|0)==(h[i>>2]|0)){h[i>>2]=c;if(!c){h[148]=h[148]&~(1<<r);y=f;o=d;break}}else{if(s>>>0<(h[151]|0)>>>0)De();r=s+16|0;if((h[r>>2]|0)==(f|0))h[r>>2]=c;else h[s+20>>2]=c;if(!c){y=f;o=d;break}}n=h[151]|0;if(c>>>0<n>>>0)De();h[c+24>>2]=s;r=16-l|0;i=h[e+r>>2]|0;do{if(i)if(i>>>0<n>>>0)De();else{h[c+16>>2]=i;h[i+24>>2]=c;break}}while(0);r=h[e+(r+4)>>2]|0;if(r)if(r>>>0<(h[151]|0)>>>0)De();else{h[c+20>>2]=r;h[r+24>>2]=c;y=f;o=d;break}else{y=f;o=d}}else{y=f;o=d}}else{y=e;o=t}}while(0);u=h[151]|0;if(v>>>0<u>>>0)De();r=e+(t+4)|0;i=h[r>>2]|0;if(!(i&2)){if((v|0)==(h[153]|0)){g=(h[150]|0)+o|0;h[150]=g;h[153]=y;h[y+4>>2]=g|1;if((y|0)!=(h[152]|0))return;h[152]=0;h[149]=0;return}if((v|0)==(h[152]|0)){g=(h[149]|0)+o|0;h[149]=g;h[152]=y;h[y+4>>2]=g|1;h[y+g>>2]=g;return}o=(i&-8)+o|0;a=i>>>3;do{if(i>>>0>=256){s=h[e+(t+24)>>2]|0;n=h[e+(t+12)>>2]|0;do{if((n|0)==(v|0)){i=e+(t+20)|0;r=h[i>>2]|0;if(!r){i=e+(t+16)|0;r=h[i>>2]|0;if(!r){m=0;break}}while(1){n=r+20|0;a=h[n>>2]|0;if(a){r=a;i=n;continue}n=r+16|0;a=h[n>>2]|0;if(!a)break;else{r=a;i=n}}if(i>>>0<u>>>0)De();else{h[i>>2]=0;m=r;break}}else{a=h[e+(t+8)>>2]|0;if(a>>>0<u>>>0)De();r=a+12|0;if((h[r>>2]|0)!=(v|0))De();i=n+8|0;if((h[i>>2]|0)==(v|0)){h[r>>2]=n;h[i>>2]=a;m=n;break}else De()}}while(0);if(s){r=h[e+(t+28)>>2]|0;i=892+(r<<2)|0;if((v|0)==(h[i>>2]|0)){h[i>>2]=m;if(!m){h[148]=h[148]&~(1<<r);break}}else{if(s>>>0<(h[151]|0)>>>0)De();r=s+16|0;if((h[r>>2]|0)==(v|0))h[r>>2]=m;else h[s+20>>2]=m;if(!m)break}i=h[151]|0;if(m>>>0<i>>>0)De();h[m+24>>2]=s;r=h[e+(t+16)>>2]|0;do{if(r)if(r>>>0<i>>>0)De();else{h[m+16>>2]=r;h[r+24>>2]=m;break}}while(0);r=h[e+(t+20)>>2]|0;if(r)if(r>>>0<(h[151]|0)>>>0)De();else{h[m+20>>2]=r;h[r+24>>2]=m;break}}}else{n=h[e+(t+8)>>2]|0;i=h[e+(t+12)>>2]|0;r=628+(a<<1<<2)|0;if((n|0)!=(r|0)){if(n>>>0<u>>>0)De();if((h[n+12>>2]|0)!=(v|0))De()}if((i|0)==(n|0)){h[147]=h[147]&~(1<<a);break}if((i|0)!=(r|0)){if(i>>>0<u>>>0)De();r=i+8|0;if((h[r>>2]|0)==(v|0))p=r;else De()}else p=i+8|0;h[n+12>>2]=i;h[p>>2]=n}}while(0);h[y+4>>2]=o|1;h[y+o>>2]=o;if((y|0)==(h[152]|0)){h[149]=o;return}}else{h[r>>2]=i&-2;h[y+4>>2]=o|1;h[y+o>>2]=o}r=o>>>3;if(o>>>0<256){i=r<<1;a=628+(i<<2)|0;n=h[147]|0;r=1<<r;if(n&r){r=628+(i+2<<2)|0;i=h[r>>2]|0;if(i>>>0<(h[151]|0)>>>0)De();else{_=r;g=i}}else{h[147]=n|r;_=628+(i+2<<2)|0;g=a}h[_>>2]=y;h[g+12>>2]=y;h[y+8>>2]=g;h[y+12>>2]=a;return}r=o>>>8;if(r)if(o>>>0>16777215)a=31;else{_=(r+1048320|0)>>>16&8;g=r<<_;v=(g+520192|0)>>>16&4;g=g<<v;a=(g+245760|0)>>>16&2;a=14-(v|_|a)+(g<<a>>>15)|0;a=o>>>(a+7|0)&1|a<<1}else a=0;r=892+(a<<2)|0;h[y+28>>2]=a;h[y+20>>2]=0;h[y+16>>2]=0;i=h[148]|0;n=1<<a;if(!(i&n)){h[148]=i|n;h[r>>2]=y;h[y+24>>2]=r;h[y+12>>2]=y;h[y+8>>2]=y;return}r=h[r>>2]|0;e:do{if((h[r+4>>2]&-8|0)!=(o|0)){a=o<<((a|0)==31?0:25-(a>>>1)|0);while(1){i=r+16+(a>>>31<<2)|0;n=h[i>>2]|0;if(!n)break;if((h[n+4>>2]&-8|0)==(o|0)){r=n;break e}else{a=a<<1;r=n}}if(i>>>0<(h[151]|0)>>>0)De();h[i>>2]=y;h[y+24>>2]=r;h[y+12>>2]=y;h[y+8>>2]=y;return}}while(0);i=r+8|0;n=h[i>>2]|0;g=h[151]|0;if(!(n>>>0>=g>>>0&r>>>0>=g>>>0))De();h[n+12>>2]=y;h[i>>2]=y;h[y+8>>2]=n;h[y+12>>2]=r;h[y+24>>2]=0;return}function Wr(){}function jr(e,t,r,i){e=e|0;t=t|0;r=r|0;i=i|0;i=t-i-(r>>>0>e>>>0|0)>>>0;return(z=i,e-r>>>0|0)|0}function Yr(e,t,r,i){e=e|0;t=t|0;r=r|0;i=i|0;r=e+r>>>0;return(z=t+i+(r>>>0<e>>>0|0)>>>0,r|0)|0}function Xr(e,t,r){e=e|0;t=t|0;r=r|0;var i=0,n=0,a=0,o=0;i=e+r|0;if((r|0)>=20){t=t&255;a=e&3;o=t|t<<8|t<<16|t<<24;n=i&~3;if(a){a=e+4-a|0;while((e|0)<(a|0)){d[e>>0]=t;e=e+1|0}}while((e|0)<(n|0)){h[e>>2]=o;e=e+4|0}}while((e|0)<(i|0)){d[e>>0]=t;e=e+1|0}return e-r|0}function Zr(e,t,r){e=e|0;t=t|0;r=r|0;if((r|0)<32){z=t>>>r;return e>>>r|(t&(1<<r)-1)<<32-r}z=0;return t>>>r-32|0}function Kr(e,t,r){e=e|0;t=t|0;r=r|0;if((r|0)<32){z=t<<r|(e&(1<<r)-1<<32-r)>>>32-r;return e<<r}z=e<<r-32;return 0}function Qr(e,t,r){e=e|0;t=t|0;r=r|0;var i=0;if((r|0)>=4096)return Be(e|0,t|0,r|0)|0;i=e|0;if((e&3)==(t&3)){while(e&3){if(!r)return i|0;d[e>>0]=d[t>>0]|0;e=e+1|0;t=t+1|0;r=r-1|0}while((r|0)>=4){h[e>>2]=h[t>>2];e=e+4|0;t=t+4|0;r=r-4|0}}while((r|0)>0){d[e>>0]=d[t>>0]|0;e=e+1|0;t=t+1|0;r=r-1|0}return i|0}function Jr(e,t,r){e=e|0;t=t|0;r=r|0;if((r|0)<32){z=t>>r;return e>>>r|(t&(1<<r)-1)<<32-r}z=(t|0)<0?-1:0;return t>>r-32|0}function $r(e){e=e|0;var t=0;t=d[E+(e&255)>>0]|0;if((t|0)<8)return t|0;t=d[E+(e>>8&255)>>0]|0;if((t|0)<8)return t+8|0;t=d[E+(e>>16&255)>>0]|0;if((t|0)<8)return t+16|0;return(d[E+(e>>>24)>>0]|0)+24|0}function ei(e,t){e=e|0;t=t|0;var r=0,i=0,n=0,a=0;a=e&65535;n=t&65535;r=ce(n,a)|0;i=e>>>16;e=(r>>>16)+(ce(n,i)|0)|0;n=t>>>16;t=ce(n,a)|0;return(z=(e>>>16)+(ce(n,i)|0)+(((e&65535)+t|0)>>>16)|0,e+t<<16|r&65535|0)|0}function ti(e,t,r,i){e=e|0;t=t|0;r=r|0;i=i|0;var n=0,a=0,o=0,s=0,u=0,l=0;l=t>>31|((t|0)<0?-1:0)<<1;u=((t|0)<0?-1:0)>>31|((t|0)<0?-1:0)<<1;a=i>>31|((i|0)<0?-1:0)<<1;n=((i|0)<0?-1:0)>>31|((i|0)<0?-1:0)<<1;s=jr(l^e,u^t,l,u)|0;o=z;e=a^l;t=n^u;return jr((oi(s,o,jr(a^r,n^i,a,n)|0,z,0)|0)^e,z^t,e,t)|0}function ri(e,t,r,i){e=e|0;t=t|0;r=r|0;i=i|0;var n=0,a=0,o=0,s=0,u=0,l=0;n=w;w=w+16|0;s=n|0;o=t>>31|((t|0)<0?-1:0)<<1;a=((t|0)<0?-1:0)>>31|((t|0)<0?-1:0)<<1;l=i>>31|((i|0)<0?-1:0)<<1;u=((i|0)<0?-1:0)>>31|((i|0)<0?-1:0)<<1;e=jr(o^e,a^t,o,a)|0;t=z;oi(e,t,jr(l^r,u^i,l,u)|0,z,s)|0;i=jr(h[s>>2]^o,h[s+4>>2]^a,o,a)|0;r=z;w=n;return(z=r,i)|0}function ii(e,t,r,i){e=e|0;t=t|0;r=r|0;i=i|0;var n=0,a=0;n=e;a=r;r=ei(n,a)|0;e=z;return(z=(ce(t,a)|0)+(ce(i,n)|0)+e|e&0,r|0|0)|0}function ni(e,t,r,i){e=e|0;t=t|0;r=r|0;i=i|0;return oi(e,t,r,i,0)|0}function ai(e,t,r,i){e=e|0;t=t|0;r=r|0;i=i|0;var n=0,a=0;a=w;w=w+16|0;n=a|0;oi(e,t,r,i,n)|0;w=a;return(z=h[n+4>>2]|0,h[n>>2]|0)|0}function oi(e,t,r,i,n){e=e|0;t=t|0;r=r|0;i=i|0;n=n|0;var a=0,o=0,s=0,u=0,l=0,c=0,d=0,f=0,p=0,m=0;c=e;u=t;l=u;o=r;f=i;s=f;if(!l){a=(n|0)!=0;if(!s){if(a){h[n>>2]=(c>>>0)%(o>>>0);h[n+4>>2]=0}f=0;n=(c>>>0)/(o>>>0)>>>0;return(z=f,n)|0}else{if(!a){f=0;n=0;return(z=f,n)|0}h[n>>2]=e|0;h[n+4>>2]=t&0;f=0;n=0;return(z=f,n)|0}}a=(s|0)==0;do{if(o){if(!a){a=(fe(s|0)|0)-(fe(l|0)|0)|0;if(a>>>0<=31){d=a+1|0;s=31-a|0;t=a-31>>31;o=d;e=c>>>(d>>>0)&t|l<<s;t=l>>>(d>>>0)&t;a=0;s=c<<s;break}if(!n){f=0;n=0;return(z=f,n)|0}h[n>>2]=e|0;h[n+4>>2]=u|t&0;f=0;n=0;return(z=f,n)|0}a=o-1|0;if(a&o){s=(fe(o|0)|0)+33-(fe(l|0)|0)|0;m=64-s|0;d=32-s|0;u=d>>31;p=s-32|0;t=p>>31;o=s;e=d-1>>31&l>>>(p>>>0)|(l<<d|c>>>(s>>>0))&t;t=t&l>>>(s>>>0);a=c<<m&u;s=(l<<m|c>>>(p>>>0))&u|c<<d&s-33>>31;break}if(n){h[n>>2]=a&c;h[n+4>>2]=0}if((o|0)==1){p=u|t&0;m=e|0|0;return(z=p,m)|0}else{m=$r(o|0)|0;p=l>>>(m>>>0)|0;m=l<<32-m|c>>>(m>>>0)|0;return(z=p,m)|0}}else{if(a){if(n){h[n>>2]=(l>>>0)%(o>>>0);h[n+4>>2]=0}p=0;m=(l>>>0)/(o>>>0)>>>0;return(z=p,m)|0}if(!c){if(n){h[n>>2]=0;h[n+4>>2]=(l>>>0)%(s>>>0)}p=0;m=(l>>>0)/(s>>>0)>>>0;return(z=p,m)|0}a=s-1|0;if(!(a&s)){if(n){h[n>>2]=e|0;h[n+4>>2]=a&l|t&0}p=0;m=l>>>(($r(s|0)|0)>>>0);return(z=p,m)|0}a=(fe(s|0)|0)-(fe(l|0)|0)|0;if(a>>>0<=30){t=a+1|0;s=31-a|0;o=t;e=l<<s|c>>>(t>>>0);t=l>>>(t>>>0);a=0;s=c<<s;break}if(!n){p=0;m=0;return(z=p,m)|0}h[n>>2]=e|0;h[n+4>>2]=u|t&0;p=0;m=0;return(z=p,m)|0}}while(0);if(!o){l=s;u=0;s=0}else{d=r|0|0;c=f|i&0;l=Yr(d|0,c|0,-1,-1)|0;r=z;u=s;s=0;do{i=u;u=a>>>31|u<<1;a=s|a<<1;i=e<<1|i>>>31|0;f=e>>>31|t<<1|0;jr(l,r,i,f)|0;m=z;p=m>>31|((m|0)<0?-1:0)<<1;s=p&1;e=jr(i,f,p&d,(((m|0)<0?-1:0)>>31|((m|0)<0?-1:0)<<1)&c)|0;t=z;o=o-1|0}while((o|0)!=0);l=u;u=0}o=0;if(n){h[n>>2]=e;h[n+4>>2]=t}p=(a|0)>>>31|(l|o)<<1|(o<<1|a>>>31)&0|u;m=(a<<1|0>>>31)&-2|s;return(z=p,m)|0}function si(e,t,r,i){e=e|0;t=t|0;r=r|0;i=i|0;return Si[e&7](t|0,r|0,i|0)|0}function ui(e,t,r,i,n,a){e=e|0;t=t|0;r=r|0;i=i|0;n=n|0;a=a|0;Ei[e&3](t|0,r|0,i|0,n|0,a|0)}function li(e,t){e=e|0;t=t|0;Ti[e&7](t|0)}function ci(e,t){e=e|0;t=t|0;return xi[e&1](t|0)|0}function di(e,t,r,i){e=e|0;t=t|0;r=r|0;i=i|0;Ai[e&0](t|0,r|0,i|0)}function fi(e){e=e|0;Pi[e&3]()}function hi(e,t,r,i,n,a,o){e=e|0;t=t|0;r=r|0;i=i|0;n=n|0;a=a|0;o=o|0;Di[e&3](t|0,r|0,i|0,n|0,a|0,o|0)}function pi(e,t,r,i,n){e=e|0;t=t|0;r=r|0;i=i|0;n=n|0;Mi[e&3](t|0,r|0,i|0,n|0)}function mi(e,t,r){e=e|0;t=t|0;r=r|0;he(0);return 0}function vi(e,t,r,i,n){e=e|0;t=t|0;r=r|0;i=i|0;n=n|0;he(1)}function _i(e){e=e|0;he(2)}function gi(e){e=e|0;he(3);return 0}function yi(e,t,r){e=e|0;t=t|0;r=r|0;he(4)}function wi(){he(5)}function Ci(e,t,r,i,n,a){e=e|0;t=t|0;r=r|0;i=i|0;n=n|0;a=a|0;he(6)}function bi(e,t,r,i){e=e|0;t=t|0;r=r|0;i=i|0;he(7)}var Si=[mi,jt,Lr,Pr,Ar,Dr,mi,mi];var Ei=[vi,$t,Jt,vi];var Ti=[_i,Ut,Ht,qt,Gt,Wt,or,Nr];var xi=[gi,xr];var Ai=[yi];var Pi=[wi,nr,ar,wi];var Di=[Ci,tr,er,Ci];var Mi=[bi,Xt,Zt,bi];return{___cxa_can_catch:rr,_crn_get_levels:wt,_crn_get_uncompressed_size:St,_crn_decompress:Et,_i64Add:Yr,_crn_get_width:gt,___cxa_is_pointer_type:ir,_crn_get_bytes_per_block:bt,_memset:Xr,_malloc:Vr,_memcpy:Qr,_i64Subtract:jr,_bitshift64Lshr:Zr,_free:zr,_bitshift64Shl:Kr,_crn_get_height:yt,_crn_get_dxt_format:Ct,runPostSets:Wr,_emscripten_replace_memory:We,stackAlloc:je,stackSave:Ye,stackRestore:Xe,establishStackSpace:Ze,setThrew:Ke,setTempRet0:$e,getTempRet0:et,dynCall_iiii:si,dynCall_viiiii:ui,dynCall_vi:li,dynCall_ii:ci,dynCall_viii:di,dynCall_v:fi,dynCall_viiiiii:hi,dynCall_viiii:pi}}(Module.asmGlobalArg,Module.asmLibraryArg,buffer);var ___cxa_can_catch=Module["___cxa_can_catch"]=asm["___cxa_can_catch"];var _crn_get_levels=Module["_crn_get_levels"]=asm["_crn_get_levels"];var runPostSets=Module["runPostSets"]=asm["runPostSets"];var _crn_get_uncompressed_size=Module["_crn_get_uncompressed_size"]=asm["_crn_get_uncompressed_size"];var _crn_decompress=Module["_crn_decompress"]=asm["_crn_decompress"];var _i64Add=Module["_i64Add"]=asm["_i64Add"];var _crn_get_height=Module["_crn_get_height"]=asm["_crn_get_height"];var ___cxa_is_pointer_type=Module["___cxa_is_pointer_type"]=asm["___cxa_is_pointer_type"];var _crn_get_bytes_per_block=Module["_crn_get_bytes_per_block"]=asm["_crn_get_bytes_per_block"];var _memset=Module["_memset"]=asm["_memset"];var _malloc=Module["_malloc"]=asm["_malloc"];var _memcpy=Module["_memcpy"]=asm["_memcpy"];var _emscripten_replace_memory=Module["_emscripten_replace_memory"]=asm["_emscripten_replace_memory"];var _i64Subtract=Module["_i64Subtract"]=asm["_i64Subtract"];var _bitshift64Lshr=Module["_bitshift64Lshr"]=asm["_bitshift64Lshr"];var _free=Module["_free"]=asm["_free"];var _crn_get_dxt_format=Module["_crn_get_dxt_format"]=asm["_crn_get_dxt_format"];var _crn_get_width=Module["_crn_get_width"]=asm["_crn_get_width"];var _bitshift64Shl=Module["_bitshift64Shl"]=asm["_bitshift64Shl"];var dynCall_iiii=Module["dynCall_iiii"]=asm["dynCall_iiii"];var dynCall_viiiii=Module["dynCall_viiiii"]=asm["dynCall_viiiii"];var dynCall_vi=Module["dynCall_vi"]=asm["dynCall_vi"];var dynCall_ii=Module["dynCall_ii"]=asm["dynCall_ii"];var dynCall_viii=Module["dynCall_viii"]=asm["dynCall_viii"];var dynCall_v=Module["dynCall_v"]=asm["dynCall_v"];var dynCall_viiiiii=Module["dynCall_viiiiii"]=asm["dynCall_viiiiii"];var dynCall_viiii=Module["dynCall_viiii"]=asm["dynCall_viiii"];Runtime.stackAlloc=asm["stackAlloc"];Runtime.stackSave=asm["stackSave"];Runtime.stackRestore=asm["stackRestore"];Runtime.establishStackSpace=asm["establishStackSpace"];Runtime.setTempRet0=asm["setTempRet0"];Runtime.getTempRet0=asm["getTempRet0"];function ExitStatus(e){this.name="ExitStatus";this.message="Program terminated with exit("+e+")";this.status=e}ExitStatus.prototype=new Error;ExitStatus.prototype.constructor=ExitStatus;var initialStackTop;var preloadStartTime=null;var calledMain=false;dependenciesFulfilled=function e(){if(!Module["calledRun"])run();if(!Module["calledRun"])dependenciesFulfilled=e};Module["callMain"]=Module.callMain=function e(t){assert(runDependencies==0,"cannot call main when async dependencies remain! (listen on __ATMAIN__)");assert(__ATPRERUN__.length==0,"cannot call main when preRun functions remain to be called");t=t||[];ensureInitRuntime();var r=t.length+1;function i(){for(var e=0;e<4-1;e++){n.push(0)}}var n=[allocate(intArrayFromString(Module["thisProgram"]),"i8",ALLOC_NORMAL)];i();for(var a=0;a<r-1;a=a+1){n.push(allocate(intArrayFromString(t[a]),"i8",ALLOC_NORMAL));i()}n.push(0);n=allocate(n,"i32",ALLOC_NORMAL);try{var o=Module["_main"](r,n,0);exit(o,true)}catch(e){if(e instanceof ExitStatus){return}else if(e=="SimulateInfiniteLoop"){Module["noExitRuntime"]=true;return}else{if(e&&typeof e==="object"&&e.stack)Module.printErr("exception thrown: "+[e,e.stack]);throw e}}finally{calledMain=true}};function run(e){e=e||Module["arguments"];if(preloadStartTime===null)preloadStartTime=Date.now();if(runDependencies>0){return}preRun();if(runDependencies>0)return;if(Module["calledRun"])return;function t(){if(Module["calledRun"])return;Module["calledRun"]=true;if(ABORT)return;ensureInitRuntime();preMain();if(Module["onRuntimeInitialized"])Module["onRuntimeInitialized"]();if(Module["_main"]&&shouldRunNow)Module["callMain"](e);postRun()}if(Module["setStatus"]){Module["setStatus"]("Running...");setTimeout(function(){setTimeout(function(){Module["setStatus"]("")},1);t()},1)}else{t()}}Module["run"]=Module.run=run;function exit(e,t){if(t&&Module["noExitRuntime"]){return}if(Module["noExitRuntime"]){}else{ABORT=true;EXITSTATUS=e;STACKTOP=initialStackTop;exitRuntime();if(Module["onExit"])Module["onExit"](e)}if(ENVIRONMENT_IS_NODE){process["stdout"]["once"]("drain",function(){process["exit"](e)});console.log(" ");setTimeout(function(){process["exit"](e)},500)}else if(ENVIRONMENT_IS_SHELL&&typeof quit==="function"){quit(e)}throw new ExitStatus(e)}Module["exit"]=Module.exit=exit;var abortDecorators=[];function abort(e){if(e!==undefined){Module.print(e);Module.printErr(e);e=JSON.stringify(e)}else{e=""}ABORT=true;EXITSTATUS=1;var t="\nIf this abort() is unexpected, build with -s ASSERTIONS=1 which can give more information.";var r="abort("+e+") at "+stackTrace()+t;if(abortDecorators){abortDecorators.forEach(function(t){r=t(r,e)})}throw r}Module["abort"]=Module.abort=abort;if(Module["preInit"]){if(typeof Module["preInit"]=="function")Module["preInit"]=[Module["preInit"]];while(Module["preInit"].length>0){Module["preInit"].pop()()}}var shouldRunNow=true;if(Module["noInitialRun"]){shouldRunNow=false}Module["noExitRuntime"]=true;run();return Module});(function(){(function(e){var t=this||(0,eval)("this"),r=t.document,i=t.navigator,n=t.jQuery,a=t.JSON;(function(e){"function"===typeof define&&define.amd?define("ThirdParty/knockout-3.4.0",["exports","require"],e):"object"===typeof exports&&"object"===typeof module?e(module.exports||exports):e(t.ko={})})(function(o,s){function u(e,t){return null===e||typeof e in v?e===t:!1}function l(t,r){var i;return function(){i||(i=m.a.setTimeout(function(){i=e;t()},r))}}function c(e,t){var r;return function(){clearTimeout(r);r=m.a.setTimeout(e,t)}}function d(e,t){t&&t!==_?"beforeChange"===t?this.Kb(e):this.Ha(e,t):this.Lb(e)}function f(e,t){null!==t&&t.k&&t.k()}function h(e,t){var r=this.Hc,i=r[b];i.R||(this.lb&&this.Ma[t]?(r.Pb(t,e,this.Ma[t]),this.Ma[t]=null,--this.lb):i.r[t]||r.Pb(t,e,i.s?{ia:e}:r.uc(e)))}function p(e,t,r,i){m.d[e]={init:function(e,n,a,o,s){var u,l;m.m(function(){var a=m.a.c(n()),o=!r!==!a,c=!l;if(c||t||o!==u)c&&m.va.Aa()&&(l=m.a.ua(m.f.childNodes(e),!0)),o?(c||m.f.da(e,m.a.ua(l)),m.eb(i?i(s,a):s,e)):m.f.xa(e),u=o},null,{i:e});return{controlsDescendantBindings:!0}}};m.h.ta[e]=!1;m.f.Z[e]=!0}var m="undefined"!==typeof o?o:{};m.b=function(e,t){for(var r=e.split("."),i=m,n=0;n<r.length-1;n++)i=i[r[n]];i[r[r.length-1]]=t};m.G=function(e,t,r){e[t]=r};m.version="3.4.0";m.b("version",m.version);m.options={deferUpdates:!1,useOnlyNativeEvents:!1};m.a=function(){function o(e,t){for(var r in e)e.hasOwnProperty(r)&&t(r,e[r])}function s(e,t){if(t)for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e}function u(e,t){e.__proto__=t;return e}function l(e,t,r,i){var n=e[t].match(_)||[];m.a.q(r.match(_),function(e){m.a.pa(n,e,i)});e[t]=n.join(" ")}var c={__proto__:[]}instanceof Array,d="function"===typeof Symbol,f={},h={};f[i&&/Firefox\/2/i.test(i.userAgent)?"KeyboardEvent":"UIEvents"]=["keyup","keydown","keypress"];f.MouseEvents="click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave".split(" ");o(f,function(e,t){if(t.length)for(var r=0,i=t.length;r<i;r++)h[t[r]]=e});var p={propertychange:!0},v=r&&function(){for(var t=3,i=r.createElement("div"),n=i.getElementsByTagName("i");i.innerHTML="<!--[if gt IE "+ ++t+"]><i></i><![endif]-->",n[0];);return 4<t?t:e}(),_=/\S+/g;return{cc:["authenticity_token",/^__RequestVerificationToken(_.*)?$/],q:function(e,t){for(var r=0,i=e.length;r<i;r++)t(e[r],r)},o:function(e,t){if("function"==typeof Array.prototype.indexOf)return Array.prototype.indexOf.call(e,t);for(var r=0,i=e.length;r<i;r++)if(e[r]===t)return r;return-1},Sb:function(e,t,r){for(var i=0,n=e.length;i<n;i++)if(t.call(r,e[i],i))return e[i];return null},La:function(e,t){var r=m.a.o(e,t);0<r?e.splice(r,1):0===r&&e.shift()},Tb:function(e){e=e||[];for(var t=[],r=0,i=e.length;r<i;r++)0>m.a.o(t,e[r])&&t.push(e[r]);return t},fb:function(e,t){e=e||[];for(var r=[],i=0,n=e.length;i<n;i++)r.push(t(e[i],i));return r},Ka:function(e,t){e=e||[];for(var r=[],i=0,n=e.length;i<n;i++)t(e[i],i)&&r.push(e[i]);return r},ra:function(e,t){if(t instanceof Array)e.push.apply(e,t);else for(var r=0,i=t.length;r<i;r++)e.push(t[r]);return e},pa:function(e,t,r){var i=m.a.o(m.a.zb(e),t);0>i?r&&e.push(t):r||e.splice(i,1)},ka:c,extend:s,Xa:u,Ya:c?u:s,D:o,Ca:function(e,t){if(!e)return e;var r={},i;for(i in e)e.hasOwnProperty(i)&&(r[i]=t(e[i],i,e));return r},ob:function(e){for(;e.firstChild;)m.removeNode(e.firstChild)},jc:function(e){e=m.a.V(e);for(var t=(e[0]&&e[0].ownerDocument||r).createElement("div"),i=0,n=e.length;i<n;i++)t.appendChild(m.$(e[i]));return t},ua:function(e,t){for(var r=0,i=e.length,n=[];r<i;r++){var a=e[r].cloneNode(!0);n.push(t?m.$(a):a)}return n},da:function(e,t){m.a.ob(e);if(t)for(var r=0,i=t.length;r<i;r++)e.appendChild(t[r])},qc:function(e,t){var r=e.nodeType?[e]:e;if(0<r.length){for(var i=r[0],n=i.parentNode,a=0,o=t.length;a<o;a++)n.insertBefore(t[a],i);a=0;for(o=r.length;a<o;a++)m.removeNode(r[a])}},za:function(e,t){if(e.length){for(t=8===t.nodeType&&t.parentNode||t;e.length&&e[0].parentNode!==t;)e.splice(0,1);for(;1<e.length&&e[e.length-1].parentNode!==t;)e.length--;if(1<e.length){var r=e[0],i=e[e.length-1];for(e.length=0;r!==i;)e.push(r),r=r.nextSibling;e.push(i)}}return e},sc:function(e,t){7>v?e.setAttribute("selected",t):e.selected=t},$a:function(t){return null===t||t===e?"":t.trim?t.trim():t.toString().replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},nd:function(e,t){e=e||"";return t.length>e.length?!1:e.substring(0,t.length)===t},Mc:function(e,t){if(e===t)return!0;if(11===e.nodeType)return!1;if(t.contains)return t.contains(3===e.nodeType?e.parentNode:e);if(t.compareDocumentPosition)return 16==(t.compareDocumentPosition(e)&16);for(;e&&e!=t;)e=e.parentNode;return!!e},nb:function(e){return m.a.Mc(e,e.ownerDocument.documentElement)},Qb:function(e){return!!m.a.Sb(e,m.a.nb)},A:function(e){return e&&e.tagName&&e.tagName.toLowerCase()},Wb:function(e){return m.onError?function(){try{return e.apply(this,arguments)}catch(e){throw m.onError&&m.onError(e),e}}:e},setTimeout:function(e,t){return setTimeout(m.a.Wb(e),t)},$b:function(e){setTimeout(function(){m.onError&&m.onError(e);throw e},0)},p:function(e,t,r){var i=m.a.Wb(r);r=v&&p[t];if(m.options.useOnlyNativeEvents||r||!n)if(r||"function"!=typeof e.addEventListener)if("undefined"!=typeof e.attachEvent){var a=function(t){i.call(e,t)},o="on"+t;e.attachEvent(o,a);m.a.F.oa(e,function(){e.detachEvent(o,a)})}else throw Error("Browser doesn't support addEventListener or attachEvent");else e.addEventListener(t,i,!1);else n(e).bind(t,i)},Da:function(e,i){if(!e||!e.nodeType)throw Error("element must be a DOM node when calling triggerEvent");var a;"input"===m.a.A(e)&&e.type&&"click"==i.toLowerCase()?(a=e.type,a="checkbox"==a||"radio"==a):a=!1;if(m.options.useOnlyNativeEvents||!n||a)if("function"==typeof r.createEvent)if("function"==typeof e.dispatchEvent)a=r.createEvent(h[i]||"HTMLEvents"),a.initEvent(i,!0,!0,t,0,0,0,0,0,!1,!1,!1,!1,0,e),e.dispatchEvent(a);else throw Error("The supplied element doesn't support dispatchEvent");else if(a&&e.click)e.click();else if("undefined"!=typeof e.fireEvent)e.fireEvent("on"+i);else throw Error("Browser doesn't support triggering events");else n(e).trigger(i)},c:function(e){return m.H(e)?e():e},zb:function(e){return m.H(e)?e.t():e},bb:function(e,t,r){var i;t&&("object"===typeof e.classList?(i=e.classList[r?"add":"remove"],m.a.q(t.match(_),function(t){i.call(e.classList,t)})):"string"===typeof e.className.baseVal?l(e.className,"baseVal",t,r):l(e,"className",t,r))},Za:function(t,r){var i=m.a.c(r);if(null===i||i===e)i="";var n=m.f.firstChild(t);!n||3!=n.nodeType||m.f.nextSibling(n)?m.f.da(t,[t.ownerDocument.createTextNode(i)]):n.data=i
;m.a.Rc(t)},rc:function(e,t){e.name=t;if(7>=v)try{e.mergeAttributes(r.createElement("<input name='"+e.name+"'/>"),!1)}catch(e){}},Rc:function(e){9<=v&&(e=1==e.nodeType?e:e.parentNode,e.style&&(e.style.zoom=e.style.zoom))},Nc:function(e){if(v){var t=e.style.width;e.style.width=0;e.style.width=t}},hd:function(e,t){e=m.a.c(e);t=m.a.c(t);for(var r=[],i=e;i<=t;i++)r.push(i);return r},V:function(e){for(var t=[],r=0,i=e.length;r<i;r++)t.push(e[r]);return t},Yb:function(e){return d?Symbol(e):e},rd:6===v,sd:7===v,C:v,ec:function(e,t){for(var r=m.a.V(e.getElementsByTagName("input")).concat(m.a.V(e.getElementsByTagName("textarea"))),i="string"==typeof t?function(e){return e.name===t}:function(e){return t.test(e.name)},n=[],a=r.length-1;0<=a;a--)i(r[a])&&n.push(r[a]);return n},ed:function(e){return"string"==typeof e&&(e=m.a.$a(e))?a&&a.parse?a.parse(e):new Function("return "+e)():null},Eb:function(e,t,r){if(!a||!a.stringify)throw Error("Cannot find JSON.stringify(). Some browsers (e.g., IE < 8) don't support it natively, but you can overcome this by adding a script reference to json2.js, downloadable from http://www.json.org/json2.js");return a.stringify(m.a.c(e),t,r)},fd:function(e,t,i){i=i||{};var n=i.params||{},a=i.includeFields||this.cc,s=e;if("object"==typeof e&&"form"===m.a.A(e))for(var s=e.action,u=a.length-1;0<=u;u--)for(var l=m.a.ec(e,a[u]),c=l.length-1;0<=c;c--)n[l[c].name]=l[c].value;t=m.a.c(t);var d=r.createElement("form");d.style.display="none";d.action=s;d.method="post";for(var f in t)e=r.createElement("input"),e.type="hidden",e.name=f,e.value=m.a.Eb(m.a.c(t[f])),d.appendChild(e);o(n,function(e,t){var i=r.createElement("input");i.type="hidden";i.name=e;i.value=t;d.appendChild(i)});r.body.appendChild(d);i.submitter?i.submitter(d):d.submit();setTimeout(function(){d.parentNode.removeChild(d)},0)}}}();m.b("utils",m.a);m.b("utils.arrayForEach",m.a.q);m.b("utils.arrayFirst",m.a.Sb);m.b("utils.arrayFilter",m.a.Ka);m.b("utils.arrayGetDistinctValues",m.a.Tb);m.b("utils.arrayIndexOf",m.a.o);m.b("utils.arrayMap",m.a.fb);m.b("utils.arrayPushAll",m.a.ra);m.b("utils.arrayRemoveItem",m.a.La);m.b("utils.extend",m.a.extend);m.b("utils.fieldsIncludedWithJsonPost",m.a.cc);m.b("utils.getFormFields",m.a.ec);m.b("utils.peekObservable",m.a.zb);m.b("utils.postJson",m.a.fd);m.b("utils.parseJson",m.a.ed);m.b("utils.registerEventHandler",m.a.p);m.b("utils.stringifyJson",m.a.Eb);m.b("utils.range",m.a.hd);m.b("utils.toggleDomNodeCssClass",m.a.bb);m.b("utils.triggerEvent",m.a.Da);m.b("utils.unwrapObservable",m.a.c);m.b("utils.objectForEach",m.a.D);m.b("utils.addOrRemoveItem",m.a.pa);m.b("utils.setTextContent",m.a.Za);m.b("unwrap",m.a.c);Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if(1===arguments.length)return function(){return t.apply(e,arguments)};var r=Array.prototype.slice.call(arguments,1);return function(){var i=r.slice(0);i.push.apply(i,arguments);return t.apply(e,i)}});m.a.e=new function(){function t(t,a){var o=t[i];if(!o||"null"===o||!n[o]){if(!a)return e;o=t[i]="ko"+r++;n[o]={}}return n[o]}var r=0,i="__ko__"+(new Date).getTime(),n={};return{get:function(r,i){var n=t(r,!1);return n===e?e:n[i]},set:function(r,i,n){if(n!==e||t(r,!1)!==e)t(r,!0)[i]=n},clear:function(e){var t=e[i];return t?(delete n[t],e[i]=null,!0):!1},I:function(){return r+++i}}};m.b("utils.domData",m.a.e);m.b("utils.domData.clear",m.a.e.clear);m.a.F=new function(){function t(t,r){var n=m.a.e.get(t,i);n===e&&r&&(n=[],m.a.e.set(t,i,n));return n}function r(e){var i=t(e,!1);if(i)for(var i=i.slice(0),n=0;n<i.length;n++)i[n](e);m.a.e.clear(e);m.a.F.cleanExternalData(e);if(o[e.nodeType])for(i=e.firstChild;e=i;)i=e.nextSibling,8===e.nodeType&&r(e)}var i=m.a.e.I(),a={1:!0,8:!0,9:!0},o={1:!0,9:!0};return{oa:function(e,r){if("function"!=typeof r)throw Error("Callback must be a function");t(e,!0).push(r)},pc:function(r,n){var a=t(r,!1);a&&(m.a.La(a,n),0==a.length&&m.a.e.set(r,i,e))},$:function(e){if(a[e.nodeType]&&(r(e),o[e.nodeType])){var t=[];m.a.ra(t,e.getElementsByTagName("*"));for(var i=0,n=t.length;i<n;i++)r(t[i])}return e},removeNode:function(e){m.$(e);e.parentNode&&e.parentNode.removeChild(e)},cleanExternalData:function(e){n&&"function"==typeof n.cleanData&&n.cleanData([e])}}};m.$=m.a.F.$;m.removeNode=m.a.F.removeNode;m.b("cleanNode",m.$);m.b("removeNode",m.removeNode);m.b("utils.domNodeDisposal",m.a.F);m.b("utils.domNodeDisposal.addDisposeCallback",m.a.F.oa);m.b("utils.domNodeDisposal.removeDisposeCallback",m.a.F.pc);(function(){var i=[0,"",""],a=[1,"<table>","</table>"],o=[3,"<table><tbody><tr>","</tr></tbody></table>"],s=[1,"<select multiple='multiple'>","</select>"],u={thead:a,tbody:a,tfoot:a,tr:[2,"<table><tbody>","</tbody></table>"],td:o,th:o,option:s,optgroup:s},l=8>=m.a.C;m.a.ma=function(e,a){var o;if(n)if(n.parseHTML)o=n.parseHTML(e,a)||[];else{if((o=n.clean([e],a))&&o[0]){for(var s=o[0];s.parentNode&&11!==s.parentNode.nodeType;)s=s.parentNode;s.parentNode&&s.parentNode.removeChild(s)}}else{(o=a)||(o=r);var s=o.parentWindow||o.defaultView||t,c=m.a.$a(e).toLowerCase(),d=o.createElement("div"),f;f=(c=c.match(/^<([a-z]+)[ >]/))&&u[c[1]]||i;c=f[0];f="ignored<div>"+f[1]+e+f[2]+"</div>";"function"==typeof s.innerShiv?d.appendChild(s.innerShiv(f)):(l&&o.appendChild(d),d.innerHTML=f,l&&d.parentNode.removeChild(d));for(;c--;)d=d.lastChild;o=m.a.V(d.lastChild.childNodes)}return o};m.a.Cb=function(t,r){m.a.ob(t);r=m.a.c(r);if(null!==r&&r!==e)if("string"!=typeof r&&(r=r.toString()),n)n(t).html(r);else for(var i=m.a.ma(r,t.ownerDocument),a=0;a<i.length;a++)t.appendChild(i[a])}})();m.b("utils.parseHtmlFragment",m.a.ma);m.b("utils.setHtml",m.a.Cb);m.M=function(){function t(e,r){if(e)if(8==e.nodeType){var i=m.M.lc(e.nodeValue);null!=i&&r.push({Lc:e,cd:i})}else if(1==e.nodeType)for(var i=0,n=e.childNodes,a=n.length;i<a;i++)t(n[i],r)}var r={};return{wb:function(e){if("function"!=typeof e)throw Error("You can only pass a function to ko.memoization.memoize()");var t=(4294967296*(1+Math.random())|0).toString(16).substring(1)+(4294967296*(1+Math.random())|0).toString(16).substring(1);r[t]=e;return"<!--[ko_memo:"+t+"]-->"},xc:function(t,i){var n=r[t];if(n===e)throw Error("Couldn't find any memo with ID "+t+". Perhaps it's already been unmemoized.");try{return n.apply(null,i||[]),!0}finally{delete r[t]}},yc:function(e,r){var i=[];t(e,i);for(var n=0,a=i.length;n<a;n++){var o=i[n].Lc,s=[o];r&&m.a.ra(s,r);m.M.xc(i[n].cd,s);o.nodeValue="";o.parentNode&&o.parentNode.removeChild(o)}},lc:function(e){return(e=e.match(/^\[ko_memo\:(.*?)\]$/))?e[1]:null}}}();m.b("memoization",m.M);m.b("memoization.memoize",m.M.wb);m.b("memoization.unmemoize",m.M.xc);m.b("memoization.parseMemoText",m.M.lc);m.b("memoization.unmemoizeDomNodeAndDescendants",m.M.yc);m.Y=function(){function e(){if(a)for(var e=a,t=0,r;s<a;)if(r=n[s++]){if(s>e){if(5e3<=++t){s=a;m.a.$b(Error("'Too much recursion' after processing "+t+" task groups."));break}e=a}try{r()}catch(e){m.a.$b(e)}}}function i(){e();s=a=n.length=0}var n=[],a=0,o=1,s=0;return{scheduler:t.MutationObserver?function(e){var t=r.createElement("div");new MutationObserver(e).observe(t,{attributes:!0});return function(){t.classList.toggle("foo")}}(i):r&&"onreadystatechange"in r.createElement("script")?function(e){var t=r.createElement("script");t.onreadystatechange=function(){t.onreadystatechange=null;r.documentElement.removeChild(t);t=null;e()};r.documentElement.appendChild(t)}:function(e){setTimeout(e,0)},Wa:function(e){a||m.Y.scheduler(i);n[a++]=e;return o++},cancel:function(e){e-=o-a;e>=s&&e<a&&(n[e]=null)},resetForTesting:function(){var e=a-s;s=a=n.length=0;return e},md:e}}();m.b("tasks",m.Y);m.b("tasks.schedule",m.Y.Wa);m.b("tasks.runEarly",m.Y.md);m.ya={throttle:function(e,t){e.throttleEvaluation=t;var r=null;return m.B({read:e,write:function(i){clearTimeout(r);r=m.a.setTimeout(function(){e(i)},t)}})},rateLimit:function(e,t){var r,i,n;"number"==typeof t?r=t:(r=t.timeout,i=t.method);e.cb=!1;n="notifyWhenChangesStop"==i?c:l;e.Ta(function(e){return n(e,r)})},deferred:function(t,r){if(!0!==r)throw Error("The 'deferred' extender only accepts the value 'true', because it is not supported to turn deferral off once enabled.");t.cb||(t.cb=!0,t.Ta(function(r){var i;return function(){m.Y.cancel(i);i=m.Y.Wa(r);t.notifySubscribers(e,"dirty")}}))},notify:function(e,t){e.equalityComparer="always"==t?null:u}};var v={undefined:1,boolean:1,number:1,string:1};m.b("extenders",m.ya);m.vc=function(e,t,r){this.ia=e;this.gb=t;this.Kc=r;this.R=!1;m.G(this,"dispose",this.k)};m.vc.prototype.k=function(){this.R=!0;this.Kc()};m.J=function(){m.a.Ya(this,g);g.rb(this)};var _="change",g={rb:function(e){e.K={};e.Nb=1},X:function(e,t,r){var i=this;r=r||_;var n=new m.vc(i,t?e.bind(t):e,function(){m.a.La(i.K[r],n);i.Ia&&i.Ia(r)});i.sa&&i.sa(r);i.K[r]||(i.K[r]=[]);i.K[r].push(n);return n},notifySubscribers:function(e,t){t=t||_;t===_&&this.zc();if(this.Pa(t))try{m.l.Ub();for(var r=this.K[t].slice(0),i=0,n;n=r[i];++i)n.R||n.gb(e)}finally{m.l.end()}},Na:function(){return this.Nb},Uc:function(e){return this.Na()!==e},zc:function(){++this.Nb},Ta:function(e){var t=this,r=m.H(t),i,n,a;t.Ha||(t.Ha=t.notifySubscribers,t.notifySubscribers=d);var o=e(function(){t.Mb=!1;r&&a===t&&(a=t());i=!1;t.tb(n,a)&&t.Ha(n=a)});t.Lb=function(e){t.Mb=i=!0;a=e;o()};t.Kb=function(e){i||(n=e,t.Ha(e,"beforeChange"))}},Pa:function(e){return this.K[e]&&this.K[e].length},Sc:function(e){if(e)return this.K[e]&&this.K[e].length||0;var t=0;m.a.D(this.K,function(e,r){"dirty"!==e&&(t+=r.length)});return t},tb:function(e,t){return!this.equalityComparer||!this.equalityComparer(e,t)},extend:function(e){var t=this;e&&m.a.D(e,function(e,r){var i=m.ya[e];"function"==typeof i&&(t=i(t,r)||t)});return t}};m.G(g,"subscribe",g.X);m.G(g,"extend",g.extend);m.G(g,"getSubscriptionsCount",g.Sc);m.a.ka&&m.a.Xa(g,Function.prototype);m.J.fn=g;m.hc=function(e){return null!=e&&"function"==typeof e.X&&"function"==typeof e.notifySubscribers};m.b("subscribable",m.J);m.b("isSubscribable",m.hc);m.va=m.l=function(){function e(e){r.push(i);i=e}function t(){i=r.pop()}var r=[],i,n=0;return{Ub:e,end:t,oc:function(e){if(i){if(!m.hc(e))throw Error("Only subscribable things can act as dependencies");i.gb.call(i.Gc,e,e.Cc||(e.Cc=++n))}},w:function(r,i,n){try{return e(),r.apply(i,n||[])}finally{t()}},Aa:function(){if(i)return i.m.Aa()},Sa:function(){if(i)return i.Sa}}}();m.b("computedContext",m.va);m.b("computedContext.getDependenciesCount",m.va.Aa);m.b("computedContext.isInitial",m.va.Sa);m.b("ignoreDependencies",m.qd=m.l.w);var y=m.a.Yb("_latestValue");m.N=function(e){function t(){if(0<arguments.length)return t.tb(t[y],arguments[0])&&(t.ga(),t[y]=arguments[0],t.fa()),this;m.l.oc(t);return t[y]}t[y]=e;m.a.ka||m.a.extend(t,m.J.fn);m.J.fn.rb(t);m.a.Ya(t,w);m.options.deferUpdates&&m.ya.deferred(t,!0);return t};var w={equalityComparer:u,t:function(){return this[y]},fa:function(){this.notifySubscribers(this[y])},ga:function(){this.notifySubscribers(this[y],"beforeChange")}};m.a.ka&&m.a.Xa(w,m.J.fn);var C=m.N.gd="__ko_proto__";w[C]=m.N;m.Oa=function(t,r){return null===t||t===e||t[C]===e?!1:t[C]===r?!0:m.Oa(t[C],r)};m.H=function(e){return m.Oa(e,m.N)};m.Ba=function(e){return"function"==typeof e&&e[C]===m.N||"function"==typeof e&&e[C]===m.B&&e.Vc?!0:!1};m.b("observable",m.N);m.b("isObservable",m.H);m.b("isWriteableObservable",m.Ba);m.b("isWritableObservable",m.Ba);m.b("observable.fn",w);m.G(w,"peek",w.t);m.G(w,"valueHasMutated",w.fa);m.G(w,"valueWillMutate",w.ga);m.la=function(e){e=e||[];if("object"!=typeof e||!("length"in e))throw Error("The argument passed when initializing an observable array must be an array, or null, or undefined.");e=m.N(e);m.a.Ya(e,m.la.fn);return e.extend({trackArrayChanges:!0})};m.la.fn={remove:function(e){for(var t=this.t(),r=[],i="function"!=typeof e||m.H(e)?function(t){return t===e}:e,n=0;n<t.length;n++){var a=t[n];i(a)&&(0===r.length&&this.ga(),r.push(a),t.splice(n,1),n--)}r.length&&this.fa();return r},removeAll:function(t){if(t===e){var r=this.t(),i=r.slice(0);this.ga();r.splice(0,r.length);this.fa();return i}return t?this.remove(function(e){return 0<=m.a.o(t,e)}):[]},destroy:function(e){var t=this.t(),r="function"!=typeof e||m.H(e)?function(t){return t===e}:e;this.ga();for(var i=t.length-1;0<=i;i--)r(t[i])&&(t[i]._destroy=!0);this.fa()},destroyAll:function(t){return t===e?this.destroy(function(){return!0}):t?this.destroy(function(e){return 0<=m.a.o(t,e)}):[]},indexOf:function(e){var t=this();return m.a.o(t,e)},replace:function(e,t){var r=this.indexOf(e);0<=r&&(this.ga(),this.t()[r]=t,this.fa())}};m.a.ka&&m.a.Xa(m.la.fn,m.N.fn);m.a.q("pop push reverse shift sort splice unshift".split(" "),function(e){m.la.fn[e]=function(){var t=this.t();this.ga();this.Vb(t,e,arguments);var r=t[e].apply(t,arguments);this.fa();return r===t?this:r}});m.a.q(["slice"],function(e){m.la.fn[e]=function(){var t=this();return t[e].apply(t,arguments)}});m.b("observableArray",m.la);m.ya.trackArrayChanges=function(e,t){function r(){if(!i){i=!0;var t=e.notifySubscribers;e.notifySubscribers=function(e,r){r&&r!==_||++o;return t.apply(this,arguments)};var r=[].concat(e.t()||[]);n=null;a=e.X(function(t){t=[].concat(t||[]);if(e.Pa("arrayChange")){var i;if(!n||1<o)n=m.a.ib(r,t,e.hb);i=n}r=t;n=null;o=0;i&&i.length&&e.notifySubscribers(i,"arrayChange")})}}e.hb={};t&&"object"==typeof t&&m.a.extend(e.hb,t);e.hb.sparse=!0;if(!e.Vb){var i=!1,n=null,a,o=0,s=e.sa,u=e.Ia;e.sa=function(t){s&&s.call(e,t);"arrayChange"===t&&r()};e.Ia=function(t){u&&u.call(e,t);"arrayChange"!==t||e.Pa("arrayChange")||(a.k(),i=!1)};e.Vb=function(e,t,r){function a(e,t,r){return s[s.length]={status:e,value:t,index:r}}if(i&&!o){var s=[],u=e.length,l=r.length,c=0;switch(t){case"push":c=u;case"unshift":for(t=0;t<l;t++)a("added",r[t],c+t);break;case"pop":c=u-1;case"shift":u&&a("deleted",e[c],c);break;case"splice":t=Math.min(Math.max(0,0>r[0]?u+r[0]:r[0]),u);for(var u=1===l?u:Math.min(t+(r[1]||0),u),l=t+l-2,c=Math.max(u,l),d=[],f=[],h=2;t<c;++t,++h)t<u&&f.push(a("deleted",e[t],t)),t<l&&d.push(a("added",r[h],t));m.a.dc(f,d);break;default:return}n=s}}}};var b=m.a.Yb("_state");m.m=m.B=function(t,r,i){function n(){if(0<arguments.length){if("function"===typeof a)a.apply(o.pb,arguments);else throw Error("Cannot write a value to a ko.computed unless you specify a 'write' option. If you wish to read the current value, don't pass any parameters.");return this}m.l.oc(n);(o.S||o.s&&n.Qa())&&n.aa();return o.T}"object"===typeof t?i=t:(i=i||{},t&&(i.read=t));if("function"!=typeof i.read)throw Error("Pass a function that returns the value of the ko.computed");var a=i.write,o={T:e,S:!0,Ra:!1,Fb:!1,R:!1,Va:!1,s:!1,jd:i.read,pb:r||i.owner,i:i.disposeWhenNodeIsRemoved||i.i||null,wa:i.disposeWhen||i.wa,mb:null,r:{},L:0,bc:null};n[b]=o;n.Vc="function"===typeof a;m.a.ka||m.a.extend(n,m.J.fn);m.J.fn.rb(n);m.a.Ya(n,S);i.pure?(o.Va=!0,o.s=!0,m.a.extend(n,E)):i.deferEvaluation&&m.a.extend(n,T);m.options.deferUpdates&&m.ya.deferred(n,!0);o.i&&(o.Fb=!0,o.i.nodeType||(o.i=null));o.s||i.deferEvaluation||n.aa();o.i&&n.ba()&&m.a.F.oa(o.i,o.mb=function(){n.k()});return n};var S={equalityComparer:u,Aa:function(){return this[b].L},Pb:function(e,t,r){if(this[b].Va&&t===this)throw Error("A 'pure' computed must not be called recursively");this[b].r[e]=r;r.Ga=this[b].L++;r.na=t.Na()},Qa:function(){var e,t,r=this[b].r;for(e in r)if(r.hasOwnProperty(e)&&(t=r[e],t.ia.Uc(t.na)))return!0},bd:function(){this.Fa&&!this[b].Ra&&this.Fa()},ba:function(){return this[b].S||0<this[b].L},ld:function(){this.Mb||this.ac()},uc:function(e){if(e.cb&&!this[b].i){var t=e.X(this.bd,this,"dirty"),r=e.X(this.ld,this);return{ia:e,k:function(){t.k();r.k()}}}return e.X(this.ac,this)},ac:function(){var e=this,t=e.throttleEvaluation;t&&0<=t?(clearTimeout(this[b].bc),this[b].bc=m.a.setTimeout(function(){e.aa(!0)},t)):e.Fa?e.Fa():e.aa(!0)},aa:function(e){var t=this[b],r=t.wa;if(!t.Ra&&!t.R){if(t.i&&!m.a.nb(t.i)||r&&r()){if(!t.Fb){this.k();return}}else t.Fb=!1;t.Ra=!0;try{this.Qc(e)}finally{t.Ra=!1}t.L||this.k()}},Qc:function(t){var r=this[b],i=r.Va?e:!r.L,n={Hc:this,Ma:r.r,lb:r.L};m.l.Ub({Gc:n,gb:h,m:this,Sa:i});r.r={};r.L=0;n=this.Pc(r,n);this.tb(r.T,n)&&(r.s||this.notifySubscribers(r.T,"beforeChange"),r.T=n,r.s?this.zc():t&&this.notifySubscribers(r.T));i&&this.notifySubscribers(r.T,"awake")},Pc:function(e,t){try{var r=e.jd;return e.pb?r.call(e.pb):r()}finally{m.l.end(),t.lb&&!e.s&&m.a.D(t.Ma,f),e.S=!1}},t:function(){var e=this[b];(e.S&&!e.L||e.s&&this.Qa())&&this.aa();return e.T},Ta:function(e){m.J.fn.Ta.call(this,e);this.Fa=function(){this.Kb(this[b].T);this[b].S=!0;this.Lb(this)}},k:function(){var e=this[b];!e.s&&e.r&&m.a.D(e.r,function(e,t){t.k&&t.k()});e.i&&e.mb&&m.a.F.pc(e.i,e.mb);e.r=null;e.L=0;e.R=!0;e.S=!1;e.s=!1;e.i=null}},E={sa:function(e){var t=this,r=t[b];if(!r.R&&r.s&&"change"==e){r.s=!1;if(r.S||t.Qa())r.r=null,r.L=0,r.S=!0,t.aa();else{var i=[];m.a.D(r.r,function(e,t){i[t.Ga]=e});m.a.q(i,function(e,i){var n=r.r[e],a=t.uc(n.ia);a.Ga=i;a.na=n.na;r.r[e]=a})}r.R||t.notifySubscribers(r.T,"awake")}},Ia:function(t){var r=this[b];r.R||"change"!=t||this.Pa("change")||(m.a.D(r.r,function(e,t){t.k&&(r.r[e]={ia:t.ia,Ga:t.Ga,na:t.na},t.k())}),r.s=!0,this.notifySubscribers(e,"asleep"))},Na:function(){var e=this[b];e.s&&(e.S||this.Qa())&&this.aa();return m.J.fn.Na.call(this)}},T={sa:function(e){"change"!=e&&"beforeChange"!=e||this.t()}};m.a.ka&&m.a.Xa(S,m.J.fn);var x=m.N.gd;m.m[x]=m.N;S[x]=m.m;m.Xc=function(e){return m.Oa(e,m.m)};m.Yc=function(e){return m.Oa(e,m.m)&&e[b]&&e[b].Va};m.b("computed",m.m);m.b("dependentObservable",m.m);m.b("isComputed",m.Xc);m.b("isPureComputed",m.Yc);m.b("computed.fn",S);m.G(S,"peek",S.t);m.G(S,"dispose",S.k);m.G(S,"isActive",S.ba);m.G(S,"getDependenciesCount",S.Aa);m.nc=function(e,t){if("function"===typeof e)return m.m(e,t,{pure:!0});e=m.a.extend({},e);e.pure=!0;return m.m(e,t)};m.b("pureComputed",m.nc);(function(){function t(n,a,o){o=o||new i;n=a(n);if("object"!=typeof n||null===n||n===e||n instanceof RegExp||n instanceof Date||n instanceof String||n instanceof Number||n instanceof Boolean)return n;var s=n instanceof Array?[]:{};o.save(n,s);r(n,function(r){var i=a(n[r]);switch(typeof i){case"boolean":case"number":case"string":case"function":s[r]=i;break;case"object":case"undefined":var u=o.get(i);s[r]=u!==e?u:t(i,a,o)}});return s}function r(e,t){if(e instanceof Array){for(var r=0;r<e.length;r++)t(r);"function"==typeof e.toJSON&&t("toJSON")}else for(r in e)t(r)}function i(){this.keys=[];this.Ib=[]}m.wc=function(e){if(0==arguments.length)throw Error("When calling ko.toJS, pass the object you want to convert.");return t(e,function(e){for(var t=0;m.H(e)&&10>t;t++)e=e();return e})};m.toJSON=function(e,t,r){e=m.wc(e);return m.a.Eb(e,t,r)};i.prototype={save:function(e,t){var r=m.a.o(this.keys,e);0<=r?this.Ib[r]=t:(this.keys.push(e),this.Ib.push(t))},get:function(t){t=m.a.o(this.keys,t);return 0<=t?this.Ib[t]:e}}})();m.b("toJS",m.wc);m.b("toJSON",m.toJSON);(function(){m.j={u:function(t){switch(m.a.A(t)){case"option":return!0===t.__ko__hasDomDataOptionValue__?m.a.e.get(t,m.d.options.xb):7>=m.a.C?t.getAttributeNode("value")&&t.getAttributeNode("value").specified?t.value:t.text:t.value;case"select":return 0<=t.selectedIndex?m.j.u(t.options[t.selectedIndex]):e;default:return t.value}},ha:function(t,r,i){switch(m.a.A(t)){case"option":switch(typeof r){case"string":m.a.e.set(t,m.d.options.xb,e);"__ko__hasDomDataOptionValue__"in t&&delete t.__ko__hasDomDataOptionValue__;t.value=r;break;default:m.a.e.set(t,m.d.options.xb,r),t.__ko__hasDomDataOptionValue__=!0,t.value="number"===typeof r?r:""}break;case"select":if(""===r||null===r)r=e;for(var n=-1,a=0,o=t.options.length,s;a<o;++a)if(s=m.j.u(t.options[a]),s==r||""==s&&r===e){n=a;break}if(i||0<=n||r===e&&1<t.size)t.selectedIndex=n;break;default:if(null===r||r===e)r="";t.value=r}}}})();m.b("selectExtensions",m.j);m.b("selectExtensions.readValue",m.j.u);m.b("selectExtensions.writeValue",m.j.ha);m.h=function(){function e(e){e=m.a.$a(e);123===e.charCodeAt(0)&&(e=e.slice(1,-1));var t=[],r=e.match(i),o,s=[],u=0;if(r){r.push(",");for(var l=0,c;c=r[l];++l){var d=c.charCodeAt(0);if(44===d){if(0>=u){t.push(o&&s.length?{key:o,value:s.join("")}:{unknown:o||s.join("")});o=u=0;s=[];continue}}else if(58===d){if(!u&&!o&&1===s.length){o=s.pop();continue}}else 47===d&&l&&1<c.length?(d=r[l-1].match(n))&&!a[d[0]]&&(e=e.substr(e.indexOf(c)+1),r=e.match(i),r.push(","),l=-1,c="/"):40===d||123===d||91===d?++u:41===d||125===d||93===d?--u:o||s.length||34!==d&&39!==d||(c=c.slice(1,-1));s.push(c)}}return t}var t=["true","false","null","undefined"],r=/^(?:[$_a-z][$\w]*|(.+)(\.\s*[$_a-z][$\w]*|\[.+\]))$/i,i=RegExp("\"(?:[^\"\\\\]|\\\\.)*\"|'(?:[^'\\\\]|\\\\.)*'|/(?:[^/\\\\]|\\\\.)*/w*|[^\\s:,/][^,\"'{}()/:[\\]]*[^\\s,\"'{}()/:[\\]]|[^\\s]","g"),n=/[\])"'A-Za-z0-9_$]+$/,a={in:1,return:1,typeof:1},o={};return{ta:[],ea:o,yb:e,Ua:function(i,n){function a(e,i){var n;if(!c){var d=m.getBindingHandler(e);if(d&&d.preprocess&&!(i=d.preprocess(i,e,a)))return;if(d=o[e])n=i,0<=m.a.o(t,n)?n=!1:(d=n.match(r),n=null===d?!1:d[1]?"Object("+d[1]+")"+d[2]:n),d=n;d&&u.push("'"+e+"':function(_z){"+n+"=_z}")}l&&(i="function(){return "+i+" }");s.push("'"+e+"':"+i)}n=n||{};var s=[],u=[],l=n.valueAccessors,c=n.bindingParams,d="string"===typeof i?e(i):i;m.a.q(d,function(e){a(e.key||e.unknown,e.value)});u.length&&a("_ko_property_writers","{"+u.join(",")+" }");return s.join(",")},ad:function(e,t){for(var r=0;r<e.length;r++)if(e[r].key==t)return!0;return!1},Ea:function(e,t,r,i,n){if(e&&m.H(e))!m.Ba(e)||n&&e.t()===i||e(i);else if((e=t.get("_ko_property_writers"))&&e[r])e[r](i)}}}();m.b("expressionRewriting",m.h);m.b("expressionRewriting.bindingRewriteValidators",m.h.ta);m.b("expressionRewriting.parseObjectLiteral",m.h.yb);m.b("expressionRewriting.preProcessBindings",m.h.Ua);m.b("expressionRewriting._twoWayBindings",m.h.ea);m.b("jsonExpressionRewriting",m.h);m.b("jsonExpressionRewriting.insertPropertyAccessorsIntoJson",m.h.Ua);(function(){function e(e){return 8==e.nodeType&&o.test(a?e.text:e.nodeValue)}function t(e){return 8==e.nodeType&&s.test(a?e.text:e.nodeValue)}function i(r,i){for(var n=r,a=1,o=[];n=n.nextSibling;){if(t(n)&&(a--,0===a))return o;o.push(n);e(n)&&a++}if(!i)throw Error("Cannot find closing comment tag to match: "+r.nodeValue);return null}function n(e,t){var r=i(e,t);return r?0<r.length?r[r.length-1].nextSibling:e.nextSibling:null}var a=r&&"<!--test-->"===r.createComment("test").text,o=a?/^\x3c!--\s*ko(?:\s+([\s\S]+))?\s*--\x3e$/:/^\s*ko(?:\s+([\s\S]+))?\s*$/,s=a?/^\x3c!--\s*\/ko\s*--\x3e$/:/^\s*\/ko\s*$/,u={ul:!0,ol:!0};m.f={Z:{},childNodes:function(t){return e(t)?i(t):t.childNodes},xa:function(t){if(e(t)){t=m.f.childNodes(t);for(var r=0,i=t.length;r<i;r++)m.removeNode(t[r])}else m.a.ob(t)},da:function(t,r){if(e(t)){m.f.xa(t);for(var i=t.nextSibling,n=0,a=r.length;n<a;n++)i.parentNode.insertBefore(r[n],i)}else m.a.da(t,r)},mc:function(t,r){e(t)?t.parentNode.insertBefore(r,t.nextSibling):t.firstChild?t.insertBefore(r,t.firstChild):t.appendChild(r)},gc:function(t,r,i){i?e(t)?t.parentNode.insertBefore(r,i.nextSibling):i.nextSibling?t.insertBefore(r,i.nextSibling):t.appendChild(r):m.f.mc(t,r)},firstChild:function(r){return e(r)?!r.nextSibling||t(r.nextSibling)?null:r.nextSibling:r.firstChild},nextSibling:function(r){e(r)&&(r=n(r));return r.nextSibling&&t(r.nextSibling)?null:r.nextSibling},Tc:e,pd:function(e){return(e=(a?e.text:e.nodeValue).match(o))?e[1]:null},kc:function(r){if(u[m.a.A(r)]){var i=r.firstChild;if(i){do{if(1===i.nodeType){var a;a=i.firstChild;var o=null;if(a){do{if(o)o.push(a);else if(e(a)){var s=n(a,!0);s?a=s:o=[a]}else t(a)&&(o=[a])}while(a=a.nextSibling)}if(a=o)for(o=i.nextSibling,s=0;s<a.length;s++)o?r.insertBefore(a[s],o):r.appendChild(a[s])}}while(i=i.nextSibling)}}}}})();m.b("virtualElements",m.f);m.b("virtualElements.allowedBindings",m.f.Z);m.b("virtualElements.emptyNode",m.f.xa);m.b("virtualElements.insertAfter",m.f.gc);m.b("virtualElements.prepend",m.f.mc);m.b("virtualElements.setDomNodeChildren",m.f.da);(function(){m.Q=function(){this.Fc={}};m.a.extend(m.Q.prototype,{nodeHasBindings:function(e){switch(e.nodeType){case 1:return null!=e.getAttribute("data-bind")||m.g.getComponentNameForNode(e);case 8:return m.f.Tc(e);default:return!1}},getBindings:function(e,t){var r=this.getBindingsString(e,t),r=r?this.parseBindingsString(r,t,e):null;return m.g.Ob(r,e,t,!1)},getBindingAccessors:function(e,t){var r=this.getBindingsString(e,t),r=r?this.parseBindingsString(r,t,e,{valueAccessors:!0}):null;return m.g.Ob(r,e,t,!0)},getBindingsString:function(e){switch(e.nodeType){case 1:return e.getAttribute("data-bind");case 8:return m.f.pd(e);default:return null}},parseBindingsString:function(e,t,r,i){try{var n=this.Fc,a=e+(i&&i.valueAccessors||""),o;if(!(o=n[a])){var s,u="with($context){with($data||{}){return{"+m.h.Ua(e,i)+"}}}";s=new Function("$context","$element",u);o=n[a]=s}return o(t,r)}catch(t){throw t.message="Unable to parse bindings.\nBindings value: "+e+"\nMessage: "+t.message,t}}});m.Q.instance=new m.Q})();m.b("bindingProvider",m.Q);(function(){function r(e){return function(){return e}}function i(e){return e()}function a(e){return m.a.Ca(m.l.w(e),function(t,r){return function(){return e()[r]}})}function o(e,t,i){return"function"===typeof e?a(e.bind(null,t,i)):m.a.Ca(e,r)}function s(e,t){return a(this.getBindings.bind(this,e,t))}function u(e,t,r){var i,n=m.f.firstChild(t),a=m.Q.instance,o=a.preprocessNode;if(o){for(;i=n;)n=m.f.nextSibling(i),o.call(a,i);n=m.f.firstChild(t)}for(;i=n;)n=m.f.nextSibling(i),l(e,i,r)}function l(e,t,r){var i=!0,n=1===t.nodeType;n&&m.f.kc(t);if(n&&r||m.Q.instance.nodeHasBindings(t))i=d(t,null,e,r).shouldBindDescendants;i&&!h[m.a.A(t)]&&u(e,t,!n)}function c(e){var t=[],r={},i=[];m.a.D(e,function n(a){if(!r[a]){var o=m.getBindingHandler(a);o&&(o.after&&(i.push(a),m.a.q(o.after,function(t){if(e[t]){if(-1!==m.a.o(i,t))throw Error("Cannot combine the following bindings, because they have a cyclic dependency: "+i.join(", "));n(t)}}),i.length--),t.push({key:a,fc:o}));r[a]=!0}});return t}function d(t,r,n,a){var o=m.a.e.get(t,p);if(!r){if(o)throw Error("You cannot apply bindings multiple times to the same element.");m.a.e.set(t,p,!0)}!o&&a&&m.tc(t,n);var u;if(r&&"function"!==typeof r)u=r;else{var l=m.Q.instance,d=l.getBindingAccessors||s,f=m.B(function(){(u=r?r(n,t):d.call(l,t,n))&&n.P&&n.P();return u},null,{i:t});u&&f.ba()||(f=null)}var h;if(u){var v=f?function(e){return function(){return i(f()[e])}}:function(e){return u[e]},_=function(){return m.a.Ca(f?f():u,i)};_.get=function(e){return u[e]&&i(v(e))};_.has=function(e){return e in u};a=c(u);m.a.q(a,function(r){var i=r.fc.init,a=r.fc.update,o=r.key;if(8===t.nodeType&&!m.f.Z[o])throw Error("The binding '"+o+"' cannot be used with virtual elements");try{"function"==typeof i&&m.l.w(function(){var r=i(t,v(o),_,n.$data,n);if(r&&r.controlsDescendantBindings){if(h!==e)throw Error("Multiple bindings ("+h+" and "+o+") are trying to control descendant bindings of the same element. You cannot use these bindings together on the same element.");h=o}}),"function"==typeof a&&m.B(function(){a(t,v(o),_,n.$data,n)},null,{i:t})}catch(e){throw e.message='Unable to process binding "'+o+": "+u[o]+'"\nMessage: '+e.message,e}})}return{shouldBindDescendants:h===e}}function f(e){return e&&e instanceof m.U?e:new m.U(e)}m.d={};var h={script:!0,textarea:!0,template:!0};m.getBindingHandler=function(e){return m.d[e]};m.U=function(t,r,i,n){var a=this,o="function"==typeof t&&!m.H(t),s,u=m.B(function(){var e=o?t():t,s=m.a.c(e);r?(r.P&&r.P(),m.a.extend(a,r),u&&(a.P=u)):(a.$parents=[],a.$root=s,a.ko=m);a.$rawData=e;a.$data=s;i&&(a[i]=s);n&&n(a,r,s);return a.$data},null,{wa:function(){return s&&!m.a.Qb(s)},i:!0});u.ba()&&(a.P=u,u.equalityComparer=null,s=[],u.Ac=function(t){s.push(t);m.a.F.oa(t,function(t){m.a.La(s,t);s.length||(u.k(),a.P=u=e)})})};m.U.prototype.createChildContext=function(e,t,r){return new m.U(e,this,t,function(e,t){e.$parentContext=t;e.$parent=t.$data;e.$parents=(t.$parents||[]).slice(0);e.$parents.unshift(e.$parent);r&&r(e)})};m.U.prototype.extend=function(e){return new m.U(this.P||this.$data,this,null,function(t,r){t.$rawData=r.$rawData;m.a.extend(t,"function"==typeof e?e():e)})};var p=m.a.e.I(),v=m.a.e.I();m.tc=function(e,t){if(2==arguments.length)m.a.e.set(e,v,t),t.P&&t.P.Ac(e);else return m.a.e.get(e,v)};m.Ja=function(e,t,r){1===e.nodeType&&m.f.kc(e);return d(e,t,f(r),!0)};m.Dc=function(e,t,r){r=f(r);return m.Ja(e,o(t,r,e),r)};m.eb=function(e,t){1!==t.nodeType&&8!==t.nodeType||u(f(e),t,!0)};m.Rb=function(e,r){!n&&t.jQuery&&(n=t.jQuery);if(r&&1!==r.nodeType&&8!==r.nodeType)throw Error("ko.applyBindings: first parameter should be your view model; second parameter should be a DOM node");r=r||t.document.body;l(f(e),r,!0)};m.kb=function(t){switch(t.nodeType){case 1:case 8:var r=m.tc(t);if(r)return r;if(t.parentNode)return m.kb(t.parentNode)}return e};m.Jc=function(t){return(t=m.kb(t))?t.$data:e};m.b("bindingHandlers",m.d);m.b("applyBindings",m.Rb);m.b("applyBindingsToDescendants",m.eb);m.b("applyBindingAccessorsToNode",m.Ja);m.b("applyBindingsToNode",m.Dc);m.b("contextFor",m.kb);m.b("dataFor",m.Jc)})();(function(e){function t(t,i){var o=n.hasOwnProperty(t)?n[t]:e,s;o?o.X(i):(o=n[t]=new m.J,o.X(i),r(t,function(e,r){var i=!(!r||!r.synchronous);a[t]={definition:e,Zc:i};delete n[t];s||i?o.notifySubscribers(e):m.Y.Wa(function(){o.notifySubscribers(e)})}),s=!0)}function r(e,t){i("getConfig",[e],function(r){r?i("loadComponent",[e,r],function(e){t(e,r)}):t(null,null)})}function i(t,r,n,a){a||(a=m.g.loaders.slice(0));var o=a.shift();if(o){var s=o[t];if(s){var u=!1;if(s.apply(o,r.concat(function(e){u?n(null):null!==e?n(e):i(t,r,n,a)}))!==e&&(u=!0,!o.suppressLoaderExceptions))throw Error("Component loaders must supply values by invoking the callback, not by returning values synchronously.")}else i(t,r,n,a)}else n(null)}var n={},a={};m.g={get:function(r,i){var n=a.hasOwnProperty(r)?a[r]:e;n?n.Zc?m.l.w(function(){i(n.definition)}):m.Y.Wa(function(){i(n.definition)}):t(r,i)},Xb:function(e){delete a[e]},Jb:i};m.g.loaders=[];m.b("components",m.g);m.b("components.get",m.g.get);m.b("components.clearCachedDefinition",m.g.Xb)})();(function(){function e(e,t,r,i){function n(){0===--s&&i(a)}var a={},s=2,u=r.template;r=r.viewModel;u?o(t,u,function(t){m.g.Jb("loadTemplate",[e,t],function(e){a.template=e;n()})}):n();r?o(t,r,function(t){m.g.Jb("loadViewModel",[e,t],function(e){a[c]=e;n()})}):n()}function i(e,t,r){if("function"===typeof t)r(function(e){return new t(e)});else if("function"===typeof t[c])r(t[c]);else if("instance"in t){var n=t.instance;r(function(){return n})}else"viewModel"in t?i(e,t.viewModel,r):e("Unknown viewModel value: "+t)}function n(e){switch(m.a.A(e)){case"script":return m.a.ma(e.text);case"textarea":return m.a.ma(e.value);case"template":if(a(e.content))return m.a.ua(e.content.childNodes)}return m.a.ua(e.childNodes)}function a(e){return t.DocumentFragment?e instanceof DocumentFragment:e&&11===e.nodeType}function o(e,r,i){"string"===typeof r.require?s||t.require?(s||t.require)([r.require],i):e("Uses require, but no AMD loader is present"):i(r)}function u(e){return function(t){throw Error("Component '"+e+"': "+t)}}var l={};m.g.register=function(e,t){if(!t)throw Error("Invalid configuration for "+e);if(m.g.ub(e))throw Error("Component "+e+" is already registered");l[e]=t};m.g.ub=function(e){return l.hasOwnProperty(e)};m.g.od=function(e){delete l[e];m.g.Xb(e)};m.g.Zb={getConfig:function(e,t){t(l.hasOwnProperty(e)?l[e]:null)},loadComponent:function(t,r,i){var n=u(t);o(n,r,function(r){e(t,n,r,i)})},loadTemplate:function(e,i,o){e=u(e);if("string"===typeof i)o(m.a.ma(i));else if(i instanceof Array)o(i);else if(a(i))o(m.a.V(i.childNodes));else if(i.element)if(i=i.element,t.HTMLElement?i instanceof HTMLElement:i&&i.tagName&&1===i.nodeType)o(n(i));else if("string"===typeof i){var s=r.getElementById(i);s?o(n(s)):e("Cannot find element with ID "+i)}else e("Unknown element type: "+i);else e("Unknown template value: "+i)},loadViewModel:function(e,t,r){i(u(e),t,r)}}
;var c="createViewModel";m.b("components.register",m.g.register);m.b("components.isRegistered",m.g.ub);m.b("components.unregister",m.g.od);m.b("components.defaultLoader",m.g.Zb);m.g.loaders.push(m.g.Zb);m.g.Bc=l})();(function(){function e(e,r){var i=e.getAttribute("params");if(i){var i=t.parseBindingsString(i,r,e,{valueAccessors:!0,bindingParams:!0}),i=m.a.Ca(i,function(t){return m.m(t,null,{i:e})}),n=m.a.Ca(i,function(t){var r=t.t();return t.ba()?m.m({read:function(){return m.a.c(t())},write:m.Ba(r)&&function(e){t()(e)},i:e}):r});n.hasOwnProperty("$raw")||(n.$raw=i);return n}return{$raw:{}}}m.g.getComponentNameForNode=function(e){var t=m.a.A(e);if(m.g.ub(t)&&(-1!=t.indexOf("-")||"[object HTMLUnknownElement]"==""+e||8>=m.a.C&&e.tagName===t))return t};m.g.Ob=function(t,r,i,n){if(1===r.nodeType){var a=m.g.getComponentNameForNode(r);if(a){t=t||{};if(t.component)throw Error('Cannot use the "component" binding on a custom element matching a component');var o={name:a,params:e(r,i)};t.component=n?function(){return o}:o}}return t};var t=new m.Q;9>m.a.C&&(m.g.register=function(e){return function(t){r.createElement(t);return e.apply(this,arguments)}}(m.g.register),r.createDocumentFragment=function(e){return function(){var t=e(),r=m.g.Bc,i;for(i in r)r.hasOwnProperty(i)&&t.createElement(i);return t}}(r.createDocumentFragment))})();(function(e){function t(e,t,r){t=t.template;if(!t)throw Error("Component '"+e+"' has no template");e=m.a.ua(t);m.f.da(r,e)}function r(e,t,r,i){var n=e.createViewModel;return n?n.call(e,i,{element:t,templateNodes:r}):i}var i=0;m.d.component={init:function(n,a,o,s,u){function l(){var e=c&&c.dispose;"function"===typeof e&&e.call(c);d=c=null}var c,d,f=m.a.V(m.f.childNodes(n));m.a.F.oa(n,l);m.m(function(){var o=m.a.c(a()),s,h;"string"===typeof o?s=o:(s=m.a.c(o.name),h=m.a.c(o.params));if(!s)throw Error("No component name specified");var p=d=++i;m.g.get(s,function(i){if(d===p){l();if(!i)throw Error("Unknown component '"+s+"'");t(s,i,n);var a=r(i,n,f,h);i=u.createChildContext(a,e,function(e){e.$component=a;e.$componentTemplateNodes=f});c=a;m.eb(i,n)}})},null,{i:n});return{controlsDescendantBindings:!0}}};m.f.Z.component=!0})();var A={class:"className",for:"htmlFor"};m.d.attr={update:function(t,r){var i=m.a.c(r())||{};m.a.D(i,function(r,i){i=m.a.c(i);var n=!1===i||null===i||i===e;n&&t.removeAttribute(r);8>=m.a.C&&r in A?(r=A[r],n?t.removeAttribute(r):t[r]=i):n||t.setAttribute(r,i.toString());"name"===r&&m.a.rc(t,n?"":i.toString())})}};(function(){m.d.checked={after:["value","attr"],init:function(t,r,i){function n(){var e=t.checked,n=h?o():e;if(!m.va.Sa()&&(!u||e)){var a=m.l.w(r);if(c){var s=d?a.t():a;f!==n?(e&&(m.a.pa(s,n,!0),m.a.pa(s,f,!1)),f=n):m.a.pa(s,n,e);d&&m.Ba(a)&&a(s)}else m.h.Ea(a,i,"checked",n,!0)}}function a(){var e=m.a.c(r());t.checked=c?0<=m.a.o(e,o()):s?e:o()===e}var o=m.nc(function(){return i.has("checkedValue")?m.a.c(i.get("checkedValue")):i.has("value")?m.a.c(i.get("value")):t.value}),s="checkbox"==t.type,u="radio"==t.type;if(s||u){var l=r(),c=s&&m.a.c(l)instanceof Array,d=!(c&&l.push&&l.splice),f=c?o():e,h=u||c;u&&!t.name&&m.d.uniqueName.init(t,function(){return!0});m.m(n,null,{i:t});m.a.p(t,"click",n);m.m(a,null,{i:t});l=e}}};m.h.ea.checked=!0;m.d.checkedValue={update:function(e,t){e.value=m.a.c(t())}}})();m.d.css={update:function(e,t){var r=m.a.c(t());null!==r&&"object"==typeof r?m.a.D(r,function(t,r){r=m.a.c(r);m.a.bb(e,t,r)}):(r=m.a.$a(String(r||"")),m.a.bb(e,e.__ko__cssValue,!1),e.__ko__cssValue=r,m.a.bb(e,r,!0))}};m.d.enable={update:function(e,t){var r=m.a.c(t());r&&e.disabled?e.removeAttribute("disabled"):r||e.disabled||(e.disabled=!0)}};m.d.disable={update:function(e,t){m.d.enable.update(e,function(){return!m.a.c(t())})}};m.d.event={init:function(e,t,r,i,n){var a=t()||{};m.a.D(a,function(a){"string"==typeof a&&m.a.p(e,a,function(e){var o,s=t()[a];if(s){try{var u=m.a.V(arguments);i=n.$data;u.unshift(i);o=s.apply(i,u)}finally{!0!==o&&(e.preventDefault?e.preventDefault():e.returnValue=!1)}!1===r.get(a+"Bubble")&&(e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation())}})})}};m.d.foreach={ic:function(e){return function(){var t=e(),r=m.a.zb(t);if(!r||"number"==typeof r.length)return{foreach:t,templateEngine:m.W.sb};m.a.c(t);return{foreach:r.data,as:r.as,includeDestroyed:r.includeDestroyed,afterAdd:r.afterAdd,beforeRemove:r.beforeRemove,afterRender:r.afterRender,beforeMove:r.beforeMove,afterMove:r.afterMove,templateEngine:m.W.sb}}},init:function(e,t){return m.d.template.init(e,m.d.foreach.ic(t))},update:function(e,t,r,i,n){return m.d.template.update(e,m.d.foreach.ic(t),r,i,n)}};m.h.ta.foreach=!1;m.f.Z.foreach=!0;m.d.hasfocus={init:function(e,t,r){function i(i){e.__ko_hasfocusUpdating=!0;var n=e.ownerDocument;if("activeElement"in n){var a;try{a=n.activeElement}catch(e){a=n.body}i=a===e}n=t();m.h.Ea(n,r,"hasfocus",i,!0);e.__ko_hasfocusLastValue=i;e.__ko_hasfocusUpdating=!1}var n=i.bind(null,!0),a=i.bind(null,!1);m.a.p(e,"focus",n);m.a.p(e,"focusin",n);m.a.p(e,"blur",a);m.a.p(e,"focusout",a)},update:function(e,t){var r=!!m.a.c(t());e.__ko_hasfocusUpdating||e.__ko_hasfocusLastValue===r||(r?e.focus():e.blur(),!r&&e.__ko_hasfocusLastValue&&e.ownerDocument.body.focus(),m.l.w(m.a.Da,null,[e,r?"focusin":"focusout"]))}};m.h.ea.hasfocus=!0;m.d.hasFocus=m.d.hasfocus;m.h.ea.hasFocus=!0;m.d.html={init:function(){return{controlsDescendantBindings:!0}},update:function(e,t){m.a.Cb(e,t())}};p("if");p("ifnot",!1,!0);p("with",!0,!1,function(e,t){return e.createChildContext(t)});var P={};m.d.options={init:function(e){if("select"!==m.a.A(e))throw Error("options binding applies only to SELECT elements");for(;0<e.length;)e.remove(0);return{controlsDescendantBindings:!0}},update:function(t,r,i){function n(){return m.a.Ka(t.options,function(e){return e.selected})}function a(e,t,r){var i=typeof t;return"function"==i?t(e):"string"==i?e[t]:r}function o(e,r){if(p&&c)m.j.ha(t,m.a.c(i.get("value")),!0);else if(h.length){var n=0<=m.a.o(h,m.j.u(r[0]));m.a.sc(r[0],n);p&&!n&&m.l.w(m.a.Da,null,[t,"change"])}}var s=t.multiple,u=0!=t.length&&s?t.scrollTop:null,l=m.a.c(r()),c=i.get("valueAllowUnset")&&i.has("value"),d=i.get("optionsIncludeDestroyed");r={};var f,h=[];c||(s?h=m.a.fb(n(),m.j.u):0<=t.selectedIndex&&h.push(m.j.u(t.options[t.selectedIndex])));l&&("undefined"==typeof l.length&&(l=[l]),f=m.a.Ka(l,function(t){return d||t===e||null===t||!m.a.c(t._destroy)}),i.has("optionsCaption")&&(l=m.a.c(i.get("optionsCaption")),null!==l&&l!==e&&f.unshift(P)));var p=!1;r.beforeRemove=function(e){t.removeChild(e)};l=o;i.has("optionsAfterRender")&&"function"==typeof i.get("optionsAfterRender")&&(l=function(t,r){o(0,r);m.l.w(i.get("optionsAfterRender"),null,[r[0],t!==P?t:e])});m.a.Bb(t,f,function(r,n,o){o.length&&(h=!c&&o[0].selected?[m.j.u(o[0])]:[],p=!0);n=t.ownerDocument.createElement("option");r===P?(m.a.Za(n,i.get("optionsCaption")),m.j.ha(n,e)):(o=a(r,i.get("optionsValue"),r),m.j.ha(n,m.a.c(o)),r=a(r,i.get("optionsText"),o),m.a.Za(n,r));return[n]},r,l);m.l.w(function(){c?m.j.ha(t,m.a.c(i.get("value")),!0):(s?h.length&&n().length<h.length:h.length&&0<=t.selectedIndex?m.j.u(t.options[t.selectedIndex])!==h[0]:h.length||0<=t.selectedIndex)&&m.a.Da(t,"change")});m.a.Nc(t);u&&20<Math.abs(u-t.scrollTop)&&(t.scrollTop=u)}};m.d.options.xb=m.a.e.I();m.d.selectedOptions={after:["options","foreach"],init:function(e,t,r){m.a.p(e,"change",function(){var i=t(),n=[];m.a.q(e.getElementsByTagName("option"),function(e){e.selected&&n.push(m.j.u(e))});m.h.Ea(i,r,"selectedOptions",n)})},update:function(e,t){if("select"!=m.a.A(e))throw Error("values binding applies only to SELECT elements");var r=m.a.c(t()),i=e.scrollTop;r&&"number"==typeof r.length&&m.a.q(e.getElementsByTagName("option"),function(e){var t=0<=m.a.o(r,m.j.u(e));e.selected!=t&&m.a.sc(e,t)});e.scrollTop=i}};m.h.ea.selectedOptions=!0;m.d.style={update:function(t,r){var i=m.a.c(r()||{});m.a.D(i,function(r,i){i=m.a.c(i);if(null===i||i===e||!1===i)i="";t.style[r]=i})}};m.d.submit={init:function(e,t,r,i,n){if("function"!=typeof t())throw Error("The value for a submit binding must be a function");m.a.p(e,"submit",function(r){var i,a=t();try{i=a.call(n.$data,e)}finally{!0!==i&&(r.preventDefault?r.preventDefault():r.returnValue=!1)}})}};m.d.text={init:function(){return{controlsDescendantBindings:!0}},update:function(e,t){m.a.Za(e,t())}};m.f.Z.text=!0;(function(){if(t&&t.navigator)var r=function(e){if(e)return parseFloat(e[1])},i=t.opera&&t.opera.version&&parseInt(t.opera.version()),n=t.navigator.userAgent,a=r(n.match(/^(?:(?!chrome).)*version\/([^ ]*) safari/i)),o=r(n.match(/Firefox\/([^ ]*)/));if(10>m.a.C)var s=m.a.e.I(),u=m.a.e.I(),l=function(e){var t=this.activeElement;(t=t&&m.a.e.get(t,u))&&t(e)},c=function(e,t){var r=e.ownerDocument;m.a.e.get(r,s)||(m.a.e.set(r,s,!0),m.a.p(r,"selectionchange",l));m.a.e.set(e,u,t)};m.d.textInput={init:function(t,r,n){function s(e,r){m.a.p(t,e,r)}function u(){var i=m.a.c(r());if(null===i||i===e)i="";p!==e&&i===p?m.a.setTimeout(u,4):t.value!==i&&(f=i,t.value=i)}function l(){h||(p=t.value,h=m.a.setTimeout(d,4))}function d(){clearTimeout(h);p=h=e;var i=t.value;f!==i&&(f=i,m.h.Ea(r(),n,"textInput",i))}var f=t.value,h,p,v=9==m.a.C?l:d;10>m.a.C?(s("propertychange",function(e){"value"===e.propertyName&&v(e)}),8==m.a.C&&(s("keyup",d),s("keydown",d)),8<=m.a.C&&(c(t,v),s("dragend",l))):(s("input",d),5>a&&"textarea"===m.a.A(t)?(s("keydown",l),s("paste",l),s("cut",l)):11>i?s("keydown",l):4>o&&(s("DOMAutoComplete",d),s("dragdrop",d),s("drop",d)));s("change",d);m.m(u,null,{i:t})}};m.h.ea.textInput=!0;m.d.textinput={preprocess:function(e,t,r){r("textInput",e)}}})();m.d.uniqueName={init:function(e,t){if(t()){var r="ko_unique_"+ ++m.d.uniqueName.Ic;m.a.rc(e,r)}}};m.d.uniqueName.Ic=0;m.d.value={after:["options","foreach"],init:function(e,t,r){if("input"!=e.tagName.toLowerCase()||"checkbox"!=e.type&&"radio"!=e.type){var i=["change"],n=r.get("valueUpdate"),a=!1,o=null;n&&("string"==typeof n&&(n=[n]),m.a.ra(i,n),i=m.a.Tb(i));var s=function(){o=null;a=!1;var i=t(),n=m.j.u(e);m.h.Ea(i,r,"value",n)};!m.a.C||"input"!=e.tagName.toLowerCase()||"text"!=e.type||"off"==e.autocomplete||e.form&&"off"==e.form.autocomplete||-1!=m.a.o(i,"propertychange")||(m.a.p(e,"propertychange",function(){a=!0}),m.a.p(e,"focus",function(){a=!1}),m.a.p(e,"blur",function(){a&&s()}));m.a.q(i,function(t){var r=s;m.a.nd(t,"after")&&(r=function(){o=m.j.u(e);m.a.setTimeout(s,0)},t=t.substring(5));m.a.p(e,t,r)});var u=function(){var i=m.a.c(t()),n=m.j.u(e);if(null!==o&&i===o)m.a.setTimeout(u,0);else if(i!==n)if("select"===m.a.A(e)){var a=r.get("valueAllowUnset"),n=function(){m.j.ha(e,i,a)};n();a||i===m.j.u(e)?m.a.setTimeout(n,0):m.l.w(m.a.Da,null,[e,"change"])}else m.j.ha(e,i)};m.m(u,null,{i:e})}else m.Ja(e,{checkedValue:t})},update:function(){}};m.h.ea.value=!0;m.d.visible={update:function(e,t){var r=m.a.c(t()),i="none"!=e.style.display;r&&!i?e.style.display="":!r&&i&&(e.style.display="none")}};(function(e){m.d[e]={init:function(t,r,i,n,a){return m.d.event.init.call(this,t,function(){var t={};t[e]=r();return t},i,n,a)}}})("click");m.O=function(){};m.O.prototype.renderTemplateSource=function(){throw Error("Override renderTemplateSource")};m.O.prototype.createJavaScriptEvaluatorBlock=function(){throw Error("Override createJavaScriptEvaluatorBlock")};m.O.prototype.makeTemplateSource=function(e,t){if("string"==typeof e){t=t||r;var i=t.getElementById(e);if(!i)throw Error("Cannot find template with ID "+e);return new m.v.n(i)}if(1==e.nodeType||8==e.nodeType)return new m.v.qa(e);throw Error("Unknown template type: "+e)};m.O.prototype.renderTemplate=function(e,t,r,i){e=this.makeTemplateSource(e,i);return this.renderTemplateSource(e,t,r,i)};m.O.prototype.isTemplateRewritten=function(e,t){return!1===this.allowTemplateRewriting?!0:this.makeTemplateSource(e,t).data("isRewritten")};m.O.prototype.rewriteTemplate=function(e,t,r){e=this.makeTemplateSource(e,r);t=t(e.text());e.text(t);e.data("isRewritten",!0)};m.b("templateEngine",m.O);m.Gb=function(){function e(e,t,r,i){e=m.h.yb(e);for(var n=m.h.ta,a=0;a<e.length;a++){var o=e[a].key;if(n.hasOwnProperty(o)){var s=n[o];if("function"===typeof s){if(o=s(e[a].value))throw Error(o)}else if(!s)throw Error("This template engine does not support the '"+o+"' binding within its templates")}}r="ko.__tr_ambtns(function($context,$element){return(function(){return{ "+m.h.Ua(e,{valueAccessors:!0})+" } })()},'"+r.toLowerCase()+"')";return i.createJavaScriptEvaluatorBlock(r)+t}var t=/(<([a-z]+\d*)(?:\s+(?!data-bind\s*=\s*)[a-z0-9\-]+(?:=(?:\"[^\"]*\"|\'[^\']*\'|[^>]*))?)*\s+)data-bind\s*=\s*(["'])([\s\S]*?)\3/gi,r=/\x3c!--\s*ko\b\s*([\s\S]*?)\s*--\x3e/g;return{Oc:function(e,t,r){t.isTemplateRewritten(e,r)||t.rewriteTemplate(e,function(e){return m.Gb.dd(e,t)},r)},dd:function(i,n){return i.replace(t,function(t,r,i,a,o){return e(o,r,i,n)}).replace(r,function(t,r){return e(r,"<!-- ko -->","#comment",n)})},Ec:function(e,t){return m.M.wb(function(r,i){var n=r.nextSibling;n&&n.nodeName.toLowerCase()===t&&m.Ja(n,e,i)})}}}();m.b("__tr_ambtns",m.Gb.Ec);(function(){m.v={};m.v.n=function(e){if(this.n=e){var t=m.a.A(e);this.ab="script"===t?1:"textarea"===t?2:"template"==t&&e.content&&11===e.content.nodeType?3:4}};m.v.n.prototype.text=function(){var e=1===this.ab?"text":2===this.ab?"value":"innerHTML";if(0==arguments.length)return this.n[e];var t=arguments[0];"innerHTML"===e?m.a.Cb(this.n,t):this.n[e]=t};var t=m.a.e.I()+"_";m.v.n.prototype.data=function(e){if(1===arguments.length)return m.a.e.get(this.n,t+e);m.a.e.set(this.n,t+e,arguments[1])};var r=m.a.e.I();m.v.n.prototype.nodes=function(){var t=this.n;if(0==arguments.length)return(m.a.e.get(t,r)||{}).jb||(3===this.ab?t.content:4===this.ab?t:e);m.a.e.set(t,r,{jb:arguments[0]})};m.v.qa=function(e){this.n=e};m.v.qa.prototype=new m.v.n;m.v.qa.prototype.text=function(){if(0==arguments.length){var t=m.a.e.get(this.n,r)||{};t.Hb===e&&t.jb&&(t.Hb=t.jb.innerHTML);return t.Hb}m.a.e.set(this.n,r,{Hb:arguments[0]})};m.b("templateSources",m.v);m.b("templateSources.domElement",m.v.n);m.b("templateSources.anonymousTemplate",m.v.qa)})();(function(){function t(e,t,r){var i;for(t=m.f.nextSibling(t);e&&(i=e)!==t;)e=m.f.nextSibling(i),r(i,e)}function r(e,r){if(e.length){var i=e[0],n=e[e.length-1],a=i.parentNode,o=m.Q.instance,s=o.preprocessNode;if(s){t(i,n,function(e,t){var r=e.previousSibling,a=s.call(o,e);a&&(e===i&&(i=a[0]||t),e===n&&(n=a[a.length-1]||r))});e.length=0;if(!i)return;i===n?e.push(i):(e.push(i,n),m.a.za(e,a))}t(i,n,function(e){1!==e.nodeType&&8!==e.nodeType||m.Rb(r,e)});t(i,n,function(e){1!==e.nodeType&&8!==e.nodeType||m.M.yc(e,[r])});m.a.za(e,a)}}function i(e){return e.nodeType?e:0<e.length?e[0]:null}function n(e,t,n,a,s){s=s||{};var u=(e&&i(e)||n||{}).ownerDocument,l=s.templateEngine||o;m.Gb.Oc(n,l,u);n=l.renderTemplate(n,a,s,u);if("number"!=typeof n.length||0<n.length&&"number"!=typeof n[0].nodeType)throw Error("Template engine must return an array of DOM nodes");u=!1;switch(t){case"replaceChildren":m.f.da(e,n);u=!0;break;case"replaceNode":m.a.qc(e,n);u=!0;break;case"ignoreTargetNode":break;default:throw Error("Unknown renderMode: "+t)}u&&(r(n,a),s.afterRender&&m.l.w(s.afterRender,null,[n,a.$data]));return n}function a(e,t,r){return m.H(e)?e():"function"===typeof e?e(t,r):e}var o;m.Db=function(t){if(t!=e&&!(t instanceof m.O))throw Error("templateEngine must inherit from ko.templateEngine");o=t};m.Ab=function(t,r,s,u,l){s=s||{};if((s.templateEngine||o)==e)throw Error("Set a template engine before calling renderTemplate");l=l||"replaceChildren";if(u){var c=i(u);return m.B(function(){var e=r&&r instanceof m.U?r:new m.U(m.a.c(r)),o=a(t,e.$data,e),e=n(u,l,o,e,s);"replaceNode"==l&&(u=e,c=i(u))},null,{wa:function(){return!c||!m.a.nb(c)},i:c&&"replaceNode"==l?c.parentNode:c})}return m.M.wb(function(e){m.Ab(t,r,s,e,"replaceNode")})};m.kd=function(t,i,o,s,u){function l(e,t){r(t,d);o.afterRender&&o.afterRender(t,e);d=null}function c(e,r){d=u.createChildContext(e,o.as,function(e){e.$index=r});var i=a(t,e,d);return n(null,"ignoreTargetNode",i,d,o)}var d;return m.B(function(){var t=m.a.c(i)||[];"undefined"==typeof t.length&&(t=[t]);t=m.a.Ka(t,function(t){return o.includeDestroyed||t===e||null===t||!m.a.c(t._destroy)});m.l.w(m.a.Bb,null,[s,t,c,o,l])},null,{i:s})};var s=m.a.e.I();m.d.template={init:function(e,t){var r=m.a.c(t());if("string"==typeof r||r.name)m.f.xa(e);else{if("nodes"in r){if(r=r.nodes||[],m.H(r))throw Error('The "nodes" option must be a plain, non-observable array.')}else r=m.f.childNodes(e);r=m.a.jc(r);new m.v.qa(e).nodes(r)}return{controlsDescendantBindings:!0}},update:function(t,r,i,n,a){var o=r(),u;r=m.a.c(o);i=!0;n=null;"string"==typeof r?r={}:(o=r.name,"if"in r&&(i=m.a.c(r["if"])),i&&"ifnot"in r&&(i=!m.a.c(r.ifnot)),u=m.a.c(r.data));"foreach"in r?n=m.kd(o||t,i&&r.foreach||[],r,t,a):i?(a="data"in r?a.createChildContext(u,r.as):a,n=m.Ab(o||t,a,r,t)):m.f.xa(t);a=n;(u=m.a.e.get(t,s))&&"function"==typeof u.k&&u.k();m.a.e.set(t,s,a&&a.ba()?a:e)}};m.h.ta.template=function(e){e=m.h.yb(e);return 1==e.length&&e[0].unknown||m.h.ad(e,"name")?null:"This template engine does not support anonymous templates nested within its templates"};m.f.Z.template=!0})();m.b("setTemplateEngine",m.Db);m.b("renderTemplate",m.Ab);m.a.dc=function(e,t,r){if(e.length&&t.length){var i,n,a,o,s;for(i=n=0;(!r||i<r)&&(o=e[n]);++n){for(a=0;s=t[a];++a)if(o.value===s.value){o.moved=s.index;s.moved=o.index;t.splice(a,1);i=a=0;break}i+=a}}};m.a.ib=function(){function e(e,t,r,i,n){var a=Math.min,o=Math.max,s=[],u,l=e.length,c,d=t.length,f=d-l||1,h=l+d+1,p,v,_;for(u=0;u<=l;u++)for(v=p,s.push(p=[]),_=a(d,u+f),c=o(0,u-1);c<=_;c++)p[c]=c?u?e[u-1]===t[c-1]?v[c-1]:a(v[c]||h,p[c-1]||h)+1:c+1:u+1;a=[];o=[];f=[];u=l;for(c=d;u||c;)d=s[u][c]-1,c&&d===s[u][c-1]?o.push(a[a.length]={status:r,value:t[--c],index:c}):u&&d===s[u-1][c]?f.push(a[a.length]={status:i,value:e[--u],index:u}):(--c,--u,n.sparse||a.push({status:"retained",value:t[c]}));m.a.dc(f,o,!n.dontLimitMoves&&10*l);return a.reverse()}return function(t,r,i){i="boolean"===typeof i?{dontLimitMoves:i}:i||{};t=t||[];r=r||[];return t.length<r.length?e(t,r,"added","deleted",i):e(r,t,"deleted","added",i)}}();m.b("utils.compareArrays",m.a.ib);(function(){function t(t,r,i,n,a){var o=[],s=m.B(function(){var e=r(i,a,m.a.za(o,t))||[];0<o.length&&(m.a.qc(o,e),n&&m.l.w(n,null,[i,e,a]));o.length=0;m.a.ra(o,e)},null,{i:t,wa:function(){return!m.a.Qb(o)}});return{ca:o,B:s.ba()?s:e}}var r=m.a.e.I(),i=m.a.e.I();m.a.Bb=function(n,a,o,s,u){function l(e,t){b=f[t];g!==t&&(C[e]=b);b.qb(g++);m.a.za(b.ca,n);v.push(b);w.push(b)}function c(e,t){if(e)for(var r=0,i=t.length;r<i;r++)t[r]&&m.a.q(t[r].ca,function(i){e(i,r,t[r].ja)})}a=a||[];s=s||{};var d=m.a.e.get(n,r)===e,f=m.a.e.get(n,r)||[],h=m.a.fb(f,function(e){return e.ja}),p=m.a.ib(h,a,s.dontLimitMoves),v=[],_=0,g=0,y=[],w=[];a=[];for(var C=[],h=[],b,S=0,E,T;E=p[S];S++)switch(T=E.moved,E.status){case"deleted":T===e&&(b=f[_],b.B&&(b.B.k(),b.B=e),m.a.za(b.ca,n).length&&(s.beforeRemove&&(v.push(b),w.push(b),b.ja===i?b=null:a[S]=b),b&&y.push.apply(y,b.ca)));_++;break;case"retained":l(S,_++);break;case"added":T!==e?l(S,T):(b={ja:E.value,qb:m.N(g++)},v.push(b),w.push(b),d||(h[S]=b))}m.a.e.set(n,r,v);c(s.beforeMove,C);m.a.q(y,s.beforeRemove?m.$:m.removeNode);for(var S=0,d=m.f.firstChild(n),x;b=w[S];S++){b.ca||m.a.extend(b,t(n,o,b.ja,u,b.qb));for(_=0;p=b.ca[_];d=p.nextSibling,x=p,_++)p!==d&&m.f.gc(n,p,x);!b.Wc&&u&&(u(b.ja,b.ca,b.qb),b.Wc=!0)}c(s.beforeRemove,a);for(S=0;S<a.length;++S)a[S]&&(a[S].ja=i);c(s.afterMove,C);c(s.afterAdd,h)}})();m.b("utils.setDomNodeChildrenFromArrayMapping",m.a.Bb);m.W=function(){this.allowTemplateRewriting=!1};m.W.prototype=new m.O;m.W.prototype.renderTemplateSource=function(e,t,r,i){if(t=(9>m.a.C?0:e.nodes)?e.nodes():null)return m.a.V(t.cloneNode(!0).childNodes);e=e.text();return m.a.ma(e,i)};m.W.sb=new m.W;m.Db(m.W.sb);m.b("nativeTemplateEngine",m.W);(function(){m.vb=function(){var e=this.$c=function(){if(!n||!n.tmpl)return 0;try{if(0<=n.tmpl.tag.tmpl.open.toString().indexOf("__"))return 2}catch(e){}return 1}();this.renderTemplateSource=function(t,i,a,o){o=o||r;a=a||{};if(2>e)throw Error("Your version of jQuery.tmpl is too old. Please upgrade to jQuery.tmpl 1.0.0pre or later.");var s=t.data("precompiled");s||(s=t.text()||"",s=n.template(null,"{{ko_with $item.koBindingContext}}"+s+"{{/ko_with}}"),t.data("precompiled",s));t=[i.$data];i=n.extend({koBindingContext:i},a.templateOptions);i=n.tmpl(s,t,i);i.appendTo(o.createElement("div"));n.fragments={};return i};this.createJavaScriptEvaluatorBlock=function(e){return"{{ko_code ((function() { return "+e+" })()) }}"};this.addTemplate=function(e,t){r.write("<script type='text/html' id='"+e+"'>"+t+"</script>")};0<e&&(n.tmpl.tag.ko_code={open:"__.push($1 || '');"},n.tmpl.tag.ko_with={open:"with($1) {",close:"} "})};m.vb.prototype=new m.O;var e=new m.vb;0<e.$c&&m.Db(e);m.b("jqueryTmplTemplateEngine",m.vb)})()})})()})();define("ThirdParty/knockout-es5",[],function(){"use strict";var e="__knockoutObservables";var t="__knockoutSubscribable";function r(r,n){if(!r){throw new Error("When calling ko.track, you must pass an object as the first parameter.")}var o=this,s=i(r,true);n=n||Object.getOwnPropertyNames(r);n.forEach(function(i){if(i===e||i===t){return}if(i in s){return}var n=r[i],u=n instanceof Array,l=o.isObservable(n)?n:u?o.observableArray(n):o.observable(n);Object.defineProperty(r,i,{configurable:true,enumerable:true,get:l,set:o.isWriteableObservable(l)?l:undefined});s[i]=l;if(u){a(o,l)}});return r}function i(t,r){var i=t[e];if(!i&&r){i={};Object.defineProperty(t,e,{value:i})}return i}function n(e,t,i){var n=this,a={owner:e,deferEvaluation:true};if(typeof i==="function"){a.read=i}else{if("value"in i){throw new Error('For ko.defineProperty, you must not specify a "value" for the property. You must provide a "get" function.')}if(typeof i.get!=="function"){throw new Error('For ko.defineProperty, the third parameter must be either an evaluator function, or an options object containing a function called "get".')}a.read=i.get;a.write=i.set}e[t]=n.computed(a);r.call(n,e,[t]);return e}function a(e,t){var r=null;e.computed(function(){if(r){r.dispose();r=null}var i=t();if(i instanceof Array){r=o(e,t,i)}})}function o(e,t,r){var i=s(e,r);return i.subscribe(t)}function s(e,r){var i=r[t];if(!i){i=new e.subscribable;Object.defineProperty(r,t,{value:i});var n={};u(r,i,n);l(e,r,i,n)}return i}function u(e,t,r){["pop","push","reverse","shift","sort","splice","unshift"].forEach(function(i){var n=e[i];e[i]=function(){var e=n.apply(this,arguments);if(r.pause!==true){t.notifySubscribers(this)}return e}})}function l(e,t,r,i){["remove","removeAll","destroy","destroyAll","replace"].forEach(function(n){Object.defineProperty(t,n,{enumerable:false,value:function(){var a;i.pause=true;try{a=e.observableArray.fn[n].apply(e.observableArray(t),arguments)}finally{i.pause=false}r.notifySubscribers(t);return a}})})}function c(e,t){if(!e){return null}var r=i(e,false);return r&&r[t]||null}function d(e,t){var r=c(e,t);if(r){r.valueHasMutated()}}function f(e){e.track=r;e.getObservable=c;e.valueHasMutated=d;e.defineProperty=n}return{attachToKo:f}});define("Widgets/SvgPathBindingHandler",[],function(){"use strict";var e="http://www.w3.org/2000/svg";var t="cesium-svgPath-svg";var r={register:function(r){r.bindingHandlers.cesiumSvgPath={init:function(i,n){var a=document.createElementNS(e,"svg:svg");a.setAttribute("class",t);var o=document.createElementNS(e,"path");a.appendChild(o);r.virtualElements.setDomNodeChildren(i,[a]);r.computed({read:function(){var e=r.unwrap(n());o.setAttribute("d",r.unwrap(e.path));var i=r.unwrap(e.width);var s=r.unwrap(e.height);a.setAttribute("width",i);a.setAttribute("height",s);a.setAttribute("viewBox","0 0 "+i+" "+s);if(e.css){a.setAttribute("class",t+" "+r.unwrap(e.css))}},disposeWhenNodeIsRemoved:i});return{controlsDescendantBindings:true}}};r.virtualElements.allowedBindings.cesiumSvgPath=true}};return r});define("ThirdParty/knockout",["./knockout-3.4.0","./knockout-es5","../Widgets/SvgPathBindingHandler"],function(e,t,r){"use strict";t.attachToKo(e);r.register(e);return e});define("ThirdParty/NoSleep",[],function(){"use strict";var e={Android:typeof navigator!=="undefined"&&/Android/gi.test(navigator.userAgent),iOS:typeof navigator!=="undefined"&&/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent)};var t={WebM:"data:video/webm;base64,GkXfo0AgQoaBAUL3gQFC8oEEQvOBCEKCQAR3ZWJtQoeBAkKFgQIYU4BnQI0VSalmQCgq17FAAw9CQE2AQAZ3aGFtbXlXQUAGd2hhbW15RIlACECPQAAAAAAAFlSua0AxrkAu14EBY8WBAZyBACK1nEADdW5khkAFVl9WUDglhohAA1ZQOIOBAeBABrCBCLqBCB9DtnVAIueBAKNAHIEAAIAwAQCdASoIAAgAAUAmJaQAA3AA/vz0AAA=",MP4:"data:video/mp4;base64,AAAAHGZ0eXBpc29tAAACAGlzb21pc28ybXA0MQAAAAhmcmVlAAAAG21kYXQAAAGzABAHAAABthADAowdbb9/AAAC6W1vb3YAAABsbXZoZAAAAAB8JbCAfCWwgAAAA+gAAAAAAAEAAAEAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAIVdHJhawAAAFx0a2hkAAAAD3wlsIB8JbCAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAIAAAACAAAAAABsW1kaWEAAAAgbWRoZAAAAAB8JbCAfCWwgAAAA+gAAAAAVcQAAAAAAC1oZGxyAAAAAAAAAAB2aWRlAAAAAAAAAAAAAAAAVmlkZW9IYW5kbGVyAAAAAVxtaW5mAAAAFHZtaGQAAAABAAAAAAAAAAAAAAAkZGluZgAAABxkcmVmAAAAAAAAAAEAAAAMdXJsIAAAAAEAAAEcc3RibAAAALhzdHNkAAAAAAAAAAEAAACobXA0dgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAIAAgASAAAAEgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABj//wAAAFJlc2RzAAAAAANEAAEABDwgEQAAAAADDUAAAAAABS0AAAGwAQAAAbWJEwAAAQAAAAEgAMSNiB9FAEQBFGMAAAGyTGF2YzUyLjg3LjQGAQIAAAAYc3R0cwAAAAAAAAABAAAAAQAAAAAAAAAcc3RzYwAAAAAAAAABAAAAAQAAAAEAAAABAAAAFHN0c3oAAAAAAAAAEwAAAAEAAAAUc3RjbwAAAAAAAAABAAAALAAAAGB1ZHRhAAAAWG1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAAK2lsc3QAAAAjqXRvbwAAABtkYXRhAAAAAQAAAABMYXZmNTIuNzguMw=="};function r(e,t,r){var i=document.createElement("source");i.src=r;i.type="video/"+t;e.appendChild(i)}var i=function(){if(e.iOS){this.noSleepTimer=null}else if(e.Android){this.noSleepVideo=document.createElement("video");this.noSleepVideo.setAttribute("loop","");r(this.noSleepVideo,"webm",t.WebM);r(this.noSleepVideo,"mp4",t.MP4)}return this};i.prototype.enable=function(t){if(e.iOS){this.disable();this.noSleepTimer=window.setInterval(function(){window.location=window.location;window.setTimeout(window.stop,0)},t||15e3)}else if(e.Android){this.noSleepVideo.play()}};i.prototype.disable=function(){if(e.iOS){if(this.noSleepTimer){window.clearInterval(this.noSleepTimer);this.noSleepTimer=null}}else if(e.Android){this.noSleepVideo.pause()}};return i});define("Widgets/subscribeAndEvaluate",["../ThirdParty/knockout"],function(e){"use strict";function t(t,r,i,n,a){i.call(n,t[r]);return e.getObservable(t,r).subscribe(i,n,a)}return t});define("Widgets/Animation/Animation",["../../Core/Color","../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../getElement","../subscribeAndEvaluate"],function(e,t,r,i,n,a,o){"use strict";var s="http://www.w3.org/2000/svg";var u="http://www.w3.org/1999/xlink";var l;var c=e.fromCssColorString("rgba(247,250,255,0.384)");var d=e.fromCssColorString("rgba(143,191,255,0.216)");var f=e.fromCssColorString("rgba(153,197,255,0.098)");var h=e.fromCssColorString("rgba(255,255,255,0.086)");var p=e.fromCssColorString("rgba(255,255,255,0.267)");var m=e.fromCssColorString("rgba(255,255,255,0)");var v=e.fromCssColorString("rgba(66,67,68,0.3)");var _=e.fromCssColorString("rgba(0,0,0,0.5)");function g(t){return e.fromCssColorString(window.getComputedStyle(t).getPropertyValue("color"))}function y(e){var t=document.createElementNS(s,e.tagName);for(var r in e){if(e.hasOwnProperty(r)&&r!=="tagName"){if(r==="children"){var i;var n=e.children.length;for(i=0;i<n;++i){t.appendChild(y(e.children[i]))}}else if(r.indexOf("xlink:")===0){t.setAttributeNS(u,r.substring(6),e[r])}else if(r==="textContent"){t.textContent=e[r]}else{t.setAttribute(r,e[r])}}}return t}function w(e,t,r){var i=document.createElementNS(s,"text");i.setAttribute("x",e);i.setAttribute("y",t);i.setAttribute("class","cesium-animation-svgText");var n=document.createElementNS(s,"tspan");n.textContent=r;i.appendChild(n);return i}function C(e,t,r){e.setAttribute("transform","translate(100,100) rotate("+r+")");t.setAttribute("transform","rotate("+r+")")}var b=new e;function S(e,t){var r=t.alpha;var i=1-r;b.red=e.red*i+t.red*r;b.green=e.green*i+t.green*r;b.blue=e.blue*i+t.blue*r;return b.toCssColorString()}function E(e,t,r){var i={tagName:"g",class:"cesium-animation-rectButton",transform:"translate("+e+","+t+")",children:[{tagName:"rect",class:"cesium-animation-buttonGlow",width:32,height:32,rx:2,ry:2},{tagName:"rect",class:"cesium-animation-buttonMain",width:32,height:32,rx:4,ry:4},{tagName:"use",class:"cesium-animation-buttonPath","xlink:href":r},{tagName:"title",textContent:""}]};return y(i)}function T(e,t,r){var i={tagName:"g",class:"cesium-animation-rectButton",transform:"translate("+e+","+t+")",children:[{tagName:"use",class:"cesium-animation-buttonGlow","xlink:href":"#animation_pathWingButton"},{tagName:"use",class:"cesium-animation-buttonMain","xlink:href":"#animation_pathWingButton"},{tagName:"use",class:"cesium-animation-buttonPath","xlink:href":r},{tagName:"title",textContent:""}]};return y(i)}function x(e,t){var r=e._viewModel;var i=r.shuttleRingDragging;if(i&&l!==e){return}if(t.type==="mousedown"||i&&t.type==="mousemove"||t.type==="touchstart"&&t.touches.length===1||i&&t.type==="touchmove"&&t.touches.length===1){var n=e._centerX;var a=e._centerY;var o=e._svgNode;var s=o.getBoundingClientRect();var u;var c;if(t.type==="touchstart"||t.type==="touchmove"){u=t.touches[0].clientX;c=t.touches[0].clientY}else{u=t.clientX;c=t.clientY}if(!i&&(u>s.right||u<s.left||c<s.top||c>s.bottom)){return}var d=e._shuttleRingPointer.getBoundingClientRect();var f=u-n-s.left;var h=c-a-s.top;var p=Math.atan2(h,f)*180/Math.PI+90;if(p>180){p-=360}var m=r.shuttleRingAngle;if(i||u<d.right&&u>d.left&&c>d.top&&c<d.bottom){l=e;r.shuttleRingDragging=true;r.shuttleRingAngle=p}else if(p<m){r.slower()}else if(p>m){r.faster()}t.preventDefault()}else{if(e===l){l=undefined}r.shuttleRingDragging=false}}function A(e,t){this._viewModel=t;this.svgElement=e;this._enabled=undefined;this._toggled=undefined;var r=this;this._clickFunction=function(){var e=r._viewModel.command;if(e.canExecute){e()}};e.addEventListener("click",this._clickFunction,true);this._subscriptions=[o(t,"toggled",this.setToggled,this),o(t,"tooltip",this.setTooltip,this),o(t.command,"canExecute",this.setEnabled,this)]}A.prototype.destroy=function(){this.svgElement.removeEventListener("click",this._clickFunction,true);var e=this._subscriptions;for(var t=0,r=e.length;t<r;t++){e[t].dispose()}i(this)};A.prototype.isDestroyed=function(){return false};A.prototype.setEnabled=function(e){if(this._enabled!==e){this._enabled=e;if(!e){this.svgElement.setAttribute("class","cesium-animation-buttonDisabled");return}if(this._toggled){this.svgElement.setAttribute("class","cesium-animation-rectButton cesium-animation-buttonToggled");return}this.svgElement.setAttribute("class","cesium-animation-rectButton")}};A.prototype.setToggled=function(e){if(this._toggled!==e){this._toggled=e;if(this._enabled){if(e){this.svgElement.setAttribute("class","cesium-animation-rectButton cesium-animation-buttonToggled")}else{this.svgElement.setAttribute("class","cesium-animation-rectButton")}}}};A.prototype.setTooltip=function(e){this.svgElement.getElementsByTagName("title")[0].textContent=e};function P(e,r){if(!t(e)){throw new n("container is required.")}if(!t(r)){throw new n("viewModel is required.")}e=a(e);this._viewModel=r;this._container=e;this._centerX=0;this._centerY=0;this._defsElement=undefined;this._svgNode=undefined;this._topG=undefined;this._lastHeight=undefined;this._lastWidth=undefined;var i=document.createElement("style")
;i.textContent=".cesium-animation-rectButton .cesium-animation-buttonGlow { filter: url(#animation_blurred); }.cesium-animation-rectButton .cesium-animation-buttonMain { fill: url(#animation_buttonNormal); }.cesium-animation-buttonToggled .cesium-animation-buttonMain { fill: url(#animation_buttonToggled); }.cesium-animation-rectButton:hover .cesium-animation-buttonMain { fill: url(#animation_buttonHovered); }.cesium-animation-buttonDisabled .cesium-animation-buttonMain { fill: url(#animation_buttonDisabled); }.cesium-animation-shuttleRingG .cesium-animation-shuttleRingSwoosh { fill: url(#animation_shuttleRingSwooshGradient); }.cesium-animation-shuttleRingG:hover .cesium-animation-shuttleRingSwoosh { fill: url(#animation_shuttleRingSwooshHovered); }.cesium-animation-shuttleRingPointer { fill: url(#animation_shuttleRingPointerGradient); }.cesium-animation-shuttleRingPausePointer { fill: url(#animation_shuttleRingPointerPaused); }.cesium-animation-knobOuter { fill: url(#animation_knobOuter); }.cesium-animation-knobInner { fill: url(#animation_knobInner); }";document.head.insertBefore(i,document.head.childNodes[0]);var l=document.createElement("div");l.className="cesium-animation-theme";l.innerHTML='<div class="cesium-animation-themeNormal"></div><div class="cesium-animation-themeHover"></div><div class="cesium-animation-themeSelect"></div><div class="cesium-animation-themeDisabled"></div><div class="cesium-animation-themeKnob"></div><div class="cesium-animation-themePointer"></div><div class="cesium-animation-themeSwoosh"></div><div class="cesium-animation-themeSwooshHover"></div>';this._theme=l;this._themeNormal=l.childNodes[0];this._themeHover=l.childNodes[1];this._themeSelect=l.childNodes[2];this._themeDisabled=l.childNodes[3];this._themeKnob=l.childNodes[4];this._themePointer=l.childNodes[5];this._themeSwoosh=l.childNodes[6];this._themeSwooshHover=l.childNodes[7];var c=document.createElementNS(s,"svg:svg");this._svgNode=c;c.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink",u);var d=document.createElementNS(s,"g");this._topG=d;this._realtimeSVG=new A(T(3,4,"#animation_pathClock"),r.playRealtimeViewModel);this._playReverseSVG=new A(E(44,99,"#animation_pathPlayReverse"),r.playReverseViewModel);this._playForwardSVG=new A(E(124,99,"#animation_pathPlay"),r.playForwardViewModel);this._pauseSVG=new A(E(84,99,"#animation_pathPause"),r.pauseViewModel);var f=document.createElementNS(s,"g");f.appendChild(this._realtimeSVG.svgElement);f.appendChild(this._playReverseSVG.svgElement);f.appendChild(this._playForwardSVG.svgElement);f.appendChild(this._pauseSVG.svgElement);var h=y({tagName:"circle",class:"cesium-animation-shuttleRingBack",cx:100,cy:100,r:99});this._shuttleRingBackPanel=h;var p=y({tagName:"g",class:"cesium-animation-shuttleRingSwoosh",children:[{tagName:"use",transform:"translate(100,97) scale(-1,1)","xlink:href":"#animation_pathSwooshFX"},{tagName:"use",transform:"translate(100,97)","xlink:href":"#animation_pathSwooshFX"},{tagName:"line",x1:100,y1:8,x2:100,y2:22}]});this._shuttleRingSwooshG=p;this._shuttleRingPointer=y({tagName:"use",class:"cesium-animation-shuttleRingPointer","xlink:href":"#animation_pathPointer"});var m=y({tagName:"g",transform:"translate(100,100)"});this._knobOuter=y({tagName:"circle",class:"cesium-animation-knobOuter",cx:0,cy:0,r:71});var v=61;var _=y({tagName:"circle",class:"cesium-animation-knobInner",cx:0,cy:0,r:v});this._knobDate=w(0,-24,"");this._knobTime=w(0,-7,"");this._knobStatus=w(0,-41,"");var g=y({tagName:"circle",class:"cesium-animation-blank",cx:0,cy:0,r:v});var b=document.createElementNS(s,"g");b.setAttribute("class","cesium-animation-shuttleRingG");e.appendChild(l);d.appendChild(b);d.appendChild(m);d.appendChild(f);b.appendChild(h);b.appendChild(p);b.appendChild(this._shuttleRingPointer);m.appendChild(this._knobOuter);m.appendChild(_);m.appendChild(this._knobDate);m.appendChild(this._knobTime);m.appendChild(this._knobStatus);m.appendChild(g);c.appendChild(d);e.appendChild(c);var S=this;function P(e){x(S,e)}this._mouseCallback=P;h.addEventListener("mousedown",P,true);h.addEventListener("touchstart",P,true);p.addEventListener("mousedown",P,true);p.addEventListener("touchstart",P,true);document.addEventListener("mousemove",P,true);document.addEventListener("touchmove",P,true);document.addEventListener("mouseup",P,true);document.addEventListener("touchend",P,true);document.addEventListener("touchcancel",P,true);this._shuttleRingPointer.addEventListener("mousedown",P,true);this._shuttleRingPointer.addEventListener("touchstart",P,true);this._knobOuter.addEventListener("mousedown",P,true);this._knobOuter.addEventListener("touchstart",P,true);var D=this._knobTime.childNodes[0];var M=this._knobDate.childNodes[0];var I=this._knobStatus.childNodes[0];var O;this._subscriptions=[o(r.pauseViewModel,"toggled",function(e){if(O!==e){O=e;if(O){S._shuttleRingPointer.setAttribute("class","cesium-animation-shuttleRingPausePointer")}else{S._shuttleRingPointer.setAttribute("class","cesium-animation-shuttleRingPointer")}}}),o(r,"shuttleRingAngle",function(e){C(S._shuttleRingPointer,S._knobOuter,e)}),o(r,"dateLabel",function(e){if(M.textContent!==e){M.textContent=e}}),o(r,"timeLabel",function(e){if(D.textContent!==e){D.textContent=e}}),o(r,"multiplierLabel",function(e){if(I.textContent!==e){I.textContent=e}})];this.applyThemeChanges();this.resize()}r(P.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}});P.prototype.isDestroyed=function(){return false};P.prototype.destroy=function(){var e=this._mouseCallback;this._shuttleRingBackPanel.removeEventListener("mousedown",e,true);this._shuttleRingBackPanel.removeEventListener("touchstart",e,true);this._shuttleRingSwooshG.removeEventListener("mousedown",e,true);this._shuttleRingSwooshG.removeEventListener("touchstart",e,true);document.removeEventListener("mousemove",e,true);document.removeEventListener("touchmove",e,true);document.removeEventListener("mouseup",e,true);document.removeEventListener("touchend",e,true);document.removeEventListener("touchcancel",e,true);this._shuttleRingPointer.removeEventListener("mousedown",e,true);this._shuttleRingPointer.removeEventListener("touchstart",e,true);this._knobOuter.removeEventListener("mousedown",e,true);this._knobOuter.removeEventListener("touchstart",e,true);this._container.removeChild(this._svgNode);this._container.removeChild(this._theme);this._realtimeSVG.destroy();this._playReverseSVG.destroy();this._playForwardSVG.destroy();this._pauseSVG.destroy();var t=this._subscriptions;for(var r=0,n=t.length;r<n;r++){t[r].dispose()}return i(this)};P.prototype.resize=function(){var e=this._container.clientWidth;var t=this._container.clientHeight;if(e===this._lastWidth&&t===this._lastHeight){return}var r=this._svgNode;var i=200;var n=132;var a=e;var o=t;if(e===0&&t===0){a=i;o=n}else if(e===0){o=t;a=i*(t/n)}else if(t===0){a=e;o=n*(e/i)}var s=a/i;var u=o/n;r.style.cssText="width: "+a+"px; height: "+o+"px; position: absolute; bottom: 0; left: 0; overflow: hidden;";r.setAttribute("width",a);r.setAttribute("height",o);r.setAttribute("viewBox","0 0 "+a+" "+o);this._topG.setAttribute("transform","scale("+s+","+u+")");this._centerX=Math.max(1,100*s);this._centerY=Math.max(1,100*u);this._lastHeight=e;this._lastWidth=t};P.prototype.applyThemeChanges=function(){var e=g(this._themeNormal);var r=g(this._themeHover);var i=g(this._themeSelect);var n=g(this._themeDisabled);var a=g(this._themeKnob);var o=g(this._themePointer);var s=g(this._themeSwoosh);var u=g(this._themeSwooshHover);var l=y({tagName:"defs",children:[{id:"animation_buttonNormal",tagName:"linearGradient",x1:"50%",y1:"0%",x2:"50%",y2:"100%",children:[{tagName:"stop",offset:"0%","stop-color":S(e,c)},{tagName:"stop",offset:"12%","stop-color":S(e,d)},{tagName:"stop",offset:"46%","stop-color":S(e,f)},{tagName:"stop",offset:"81%","stop-color":S(e,h)}]},{id:"animation_buttonHovered",tagName:"linearGradient",x1:"50%",y1:"0%",x2:"50%",y2:"100%",children:[{tagName:"stop",offset:"0%","stop-color":S(r,c)},{tagName:"stop",offset:"12%","stop-color":S(r,d)},{tagName:"stop",offset:"46%","stop-color":S(r,f)},{tagName:"stop",offset:"81%","stop-color":S(r,h)}]},{id:"animation_buttonToggled",tagName:"linearGradient",x1:"50%",y1:"0%",x2:"50%",y2:"100%",children:[{tagName:"stop",offset:"0%","stop-color":S(i,c)},{tagName:"stop",offset:"12%","stop-color":S(i,d)},{tagName:"stop",offset:"46%","stop-color":S(i,f)},{tagName:"stop",offset:"81%","stop-color":S(i,h)}]},{id:"animation_buttonDisabled",tagName:"linearGradient",x1:"50%",y1:"0%",x2:"50%",y2:"100%",children:[{tagName:"stop",offset:"0%","stop-color":S(n,p)},{tagName:"stop",offset:"75%","stop-color":S(n,m)}]},{id:"animation_blurred",tagName:"filter",width:"200%",height:"200%",x:"-50%",y:"-50%",children:[{tagName:"feGaussianBlur",stdDeviation:4,in:"SourceGraphic"}]},{id:"animation_shuttleRingSwooshGradient",tagName:"linearGradient",x1:"50%",y1:"0%",x2:"50%",y2:"100%",children:[{tagName:"stop",offset:"0%","stop-opacity":.2,"stop-color":s.toCssColorString()},{tagName:"stop",offset:"85%","stop-opacity":.85,"stop-color":s.toCssColorString()},{tagName:"stop",offset:"95%","stop-opacity":.05,"stop-color":s.toCssColorString()}]},{id:"animation_shuttleRingSwooshHovered",tagName:"linearGradient",x1:"50%",y1:"0%",x2:"50%",y2:"100%",children:[{tagName:"stop",offset:"0%","stop-opacity":.2,"stop-color":u.toCssColorString()},{tagName:"stop",offset:"85%","stop-opacity":.85,"stop-color":u.toCssColorString()},{tagName:"stop",offset:"95%","stop-opacity":.05,"stop-color":u.toCssColorString()}]},{id:"animation_shuttleRingPointerGradient",tagName:"linearGradient",x1:"0%",y1:"50%",x2:"100%",y2:"50%",children:[{tagName:"stop",offset:"0%","stop-color":o.toCssColorString()},{tagName:"stop",offset:"40%","stop-color":o.toCssColorString()},{tagName:"stop",offset:"60%","stop-color":S(o,_)},{tagName:"stop",offset:"100%","stop-color":S(o,_)}]},{id:"animation_shuttleRingPointerPaused",tagName:"linearGradient",x1:"0%",y1:"50%",x2:"100%",y2:"50%",children:[{tagName:"stop",offset:"0%","stop-color":"#CCC"},{tagName:"stop",offset:"40%","stop-color":"#CCC"},{tagName:"stop",offset:"60%","stop-color":"#555"},{tagName:"stop",offset:"100%","stop-color":"#555"}]},{id:"animation_knobOuter",tagName:"linearGradient",x1:"20%",y1:"0%",x2:"90%",y2:"100%",children:[{tagName:"stop",offset:"5%","stop-color":S(a,c)},{tagName:"stop",offset:"60%","stop-color":S(a,v)},{tagName:"stop",offset:"85%","stop-color":S(a,d)}]},{id:"animation_knobInner",tagName:"linearGradient",x1:"20%",y1:"0%",x2:"90%",y2:"100%",children:[{tagName:"stop",offset:"5%","stop-color":S(a,v)},{tagName:"stop",offset:"60%","stop-color":S(a,c)},{tagName:"stop",offset:"85%","stop-color":S(a,h)}]},{id:"animation_pathReset",tagName:"path",transform:"translate(16,16) scale(0.85) translate(-16,-16)",d:"M24.316,5.318,9.833,13.682,9.833,5.5,5.5,5.5,5.5,25.5,9.833,25.5,9.833,17.318,24.316,25.682z"},{id:"animation_pathPause",tagName:"path",transform:"translate(16,16) scale(0.85) translate(-16,-16)",d:"M13,5.5,7.5,5.5,7.5,25.5,13,25.5zM24.5,5.5,19,5.5,19,25.5,24.5,25.5z"},{id:"animation_pathPlay",tagName:"path",transform:"translate(16,16) scale(0.85) translate(-16,-16)",d:"M6.684,25.682L24.316,15.5L6.684,5.318V25.682z"},{id:"animation_pathPlayReverse",tagName:"path",transform:"translate(16,16) scale(-0.85,0.85) translate(-16,-16)",d:"M6.684,25.682L24.316,15.5L6.684,5.318V25.682z"},{id:"animation_pathLoop",tagName:"path",transform:"translate(16,16) scale(0.85) translate(-16,-16)",d:"M24.249,15.499c-0.009,4.832-3.918,8.741-8.75,8.75c-2.515,0-4.768-1.064-6.365-2.763l2.068-1.442l-7.901-3.703l0.744,8.694l2.193-1.529c2.244,2.594,5.562,4.242,9.26,4.242c6.767,0,12.249-5.482,12.249-12.249H24.249zM15.499,6.75c2.516,0,4.769,1.065,6.367,2.764l-2.068,1.443l7.901,3.701l-0.746-8.693l-2.192,1.529c-2.245-2.594-5.562-4.245-9.262-4.245C8.734,3.25,3.25,8.734,3.249,15.499H6.75C6.758,10.668,10.668,6.758,15.499,6.75z"},{id:"animation_pathClock",tagName:"path",transform:"translate(16,16) scale(0.85) translate(-16,-15.5)",d:"M15.5,2.374C8.251,2.375,2.376,8.251,2.374,15.5C2.376,22.748,8.251,28.623,15.5,28.627c7.249-0.004,13.124-5.879,13.125-13.127C28.624,8.251,22.749,2.375,15.5,2.374zM15.5,25.623C9.909,25.615,5.385,21.09,5.375,15.5C5.385,9.909,9.909,5.384,15.5,5.374c5.59,0.01,10.115,4.535,10.124,10.125C25.615,21.09,21.091,25.615,15.5,25.623zM8.625,15.5c-0.001-0.552-0.448-0.999-1.001-1c-0.553,0-1,0.448-1,1c0,0.553,0.449,1,1,1C8.176,16.5,8.624,16.053,8.625,15.5zM8.179,18.572c-0.478,0.277-0.642,0.889-0.365,1.367c0.275,0.479,0.889,0.641,1.365,0.365c0.479-0.275,0.643-0.887,0.367-1.367C9.27,18.461,8.658,18.297,8.179,18.572zM9.18,10.696c-0.479-0.276-1.09-0.112-1.366,0.366s-0.111,1.09,0.365,1.366c0.479,0.276,1.09,0.113,1.367-0.366C9.821,11.584,9.657,10.973,9.18,10.696zM22.822,12.428c0.478-0.275,0.643-0.888,0.366-1.366c-0.275-0.478-0.89-0.642-1.366-0.366c-0.479,0.278-0.642,0.89-0.366,1.367C21.732,12.54,22.344,12.705,22.822,12.428zM12.062,21.455c-0.478-0.275-1.089-0.111-1.366,0.367c-0.275,0.479-0.111,1.09,0.366,1.365c0.478,0.277,1.091,0.111,1.365-0.365C12.704,22.344,12.54,21.732,12.062,21.455zM12.062,9.545c0.479-0.276,0.642-0.888,0.366-1.366c-0.276-0.478-0.888-0.642-1.366-0.366s-0.642,0.888-0.366,1.366C10.973,9.658,11.584,9.822,12.062,9.545zM22.823,18.572c-0.48-0.275-1.092-0.111-1.367,0.365c-0.275,0.479-0.112,1.092,0.367,1.367c0.477,0.275,1.089,0.113,1.365-0.365C23.464,19.461,23.3,18.848,22.823,18.572zM19.938,7.813c-0.477-0.276-1.091-0.111-1.365,0.366c-0.275,0.48-0.111,1.091,0.366,1.367s1.089,0.112,1.366-0.366C20.581,8.702,20.418,8.089,19.938,7.813zM23.378,14.5c-0.554,0.002-1.001,0.45-1.001,1c0.001,0.552,0.448,1,1.001,1c0.551,0,1-0.447,1-1C24.378,14.949,23.929,14.5,23.378,14.5zM15.501,6.624c-0.552,0-1,0.448-1,1l-0.466,7.343l-3.004,1.96c-0.478,0.277-0.642,0.889-0.365,1.365c0.275,0.479,0.889,0.643,1.365,0.367l3.305-1.676C15.39,16.99,15.444,17,15.501,17c0.828,0,1.5-0.671,1.5-1.5l-0.5-7.876C16.501,7.072,16.053,6.624,15.501,6.624zM15.501,22.377c-0.552,0-1,0.447-1,1s0.448,1,1,1s1-0.447,1-1S16.053,22.377,15.501,22.377zM18.939,21.455c-0.479,0.277-0.643,0.889-0.366,1.367c0.275,0.477,0.888,0.643,1.366,0.365c0.478-0.275,0.642-0.889,0.366-1.365C20.028,21.344,19.417,21.18,18.939,21.455z"},{id:"animation_pathWingButton",tagName:"path",d:"m 4.5,0.5 c -2.216,0 -4,1.784 -4,4 l 0,24 c 0,2.216 1.784,4 4,4 l 13.71875,0 C 22.478584,27.272785 27.273681,22.511272 32.5,18.25 l 0,-13.75 c 0,-2.216 -1.784,-4 -4,-4 l -24,0 z"},{id:"animation_pathPointer",tagName:"path",d:"M-15,-65,-15,-55,15,-55,15,-65,0,-95z"},{id:"animation_pathSwooshFX",tagName:"path",d:"m 85,0 c 0,16.617 -4.813944,35.356 -13.131081,48.4508 h 6.099803 c 8.317138,-13.0948 13.13322,-28.5955 13.13322,-45.2124 0,-46.94483 -38.402714,-85.00262 -85.7743869,-85.00262 -1.0218522,0 -2.0373001,0.0241 -3.0506131,0.0589 45.958443,1.59437 82.723058,35.77285 82.723058,81.70532 z"}]});if(!t(this._defsElement)){this._svgNode.appendChild(l)}else{this._svgNode.replaceChild(l,this._defsElement)}this._defsElement=l};return P});define("Widgets/createCommand",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../ThirdParty/knockout"],function(e,t,r,i,n,a){"use strict";function o(o,s){if(!t(o)){throw new i("func is required.")}s=e(s,true);var u=new n;var l=new n;function c(){if(!c.canExecute){throw new i("Cannot execute command, canExecute is false.")}var e={args:arguments,cancel:false};var t;u.raiseEvent(e);if(!e.cancel){t=o.apply(null,arguments);l.raiseEvent(t)}return t}c.canExecute=s;a.track(c,["canExecute"]);r(c,{beforeExecute:{value:u},afterExecute:{value:l}});return c}return o});define("Widgets/ToggleButtonViewModel",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../ThirdParty/knockout"],function(e,t,r,i,n){"use strict";function a(r,a){if(!t(r)){throw new i("command is required.")}this._command=r;a=e(a,e.EMPTY_OBJECT);this.toggled=e(a.toggled,false);this.tooltip=e(a.tooltip,"");n.track(this,["toggled","tooltip"])}r(a.prototype,{command:{get:function(){return this._command}}});return a});define("Widgets/Animation/AnimationViewModel",["../../Core/binarySearch","../../Core/ClockRange","../../Core/ClockStep","../../Core/defined","../../Core/defineProperties","../../Core/DeveloperError","../../Core/JulianDate","../../ThirdParty/knockout","../../ThirdParty/sprintf","../createCommand","../ToggleButtonViewModel"],function(e,t,r,i,n,a,o,s,u,l,c){"use strict";var d=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var f=15;var h=105;function p(e,t){return e-t}function m(t,r){var i=e(r,t,p);return i<0?~i:i}function v(e,t){if(Math.abs(e)<=f){return e/f}var r=f;var i=h;var n;var a=0;var o;if(e>0){n=Math.log(t[t.length-1]);o=(n-a)/(i-r);return Math.exp(a+o*(e-r))}n=Math.log(-t[0]);o=(n-a)/(i-r);return-Math.exp(a+o*(Math.abs(e)-r))}function _(e,t,i){if(i.clockStep===r.SYSTEM_CLOCK){return f}if(Math.abs(e)<=1){return e*f}var n=t[t.length-1];if(e>n){e=n}else if(e<-n){e=-n}var a=f;var o=h;var s;var u=0;var l;if(e>0){s=Math.log(n);l=(s-u)/(o-a);return(Math.log(e)-u)/l+a}s=Math.log(-t[0]);l=(s-u)/(o-a);return-((Math.log(Math.abs(e))-u)/l+a)}function g(e){if(!i(e)){throw new a("clockViewModel is required.")}var n=this;this._clockViewModel=e;this._allShuttleRingTicks=[];this._dateFormatter=g.defaultDateFormatter;this._timeFormatter=g.defaultTimeFormatter;this.shuttleRingDragging=false;this.snapToTicks=false;s.track(this,["_allShuttleRingTicks","_dateFormatter","_timeFormatter","shuttleRingDragging","snapToTicks"]);this._sortedFilteredPositiveTicks=[];this.setShuttleRingTicks(g.defaultTicks);this.timeLabel=undefined;s.defineProperty(this,"timeLabel",function(){return n._timeFormatter(n._clockViewModel.currentTime,n)});this.dateLabel=undefined;s.defineProperty(this,"dateLabel",function(){return n._dateFormatter(n._clockViewModel.currentTime,n)});this.multiplierLabel=undefined;s.defineProperty(this,"multiplierLabel",function(){var e=n._clockViewModel;if(e.clockStep===r.SYSTEM_CLOCK){return"Today"}var t=e.multiplier;if(t%1===0){return t.toFixed(0)+"x"}return t.toFixed(3).replace(/0{0,3}$/,"")+"x"});this.shuttleRingAngle=undefined;s.defineProperty(this,"shuttleRingAngle",{get:function(){return _(e.multiplier,n._allShuttleRingTicks,e)},set:function(e){e=Math.max(Math.min(e,h),-h);var t=n._allShuttleRingTicks;var i=n._clockViewModel;i.clockStep=r.SYSTEM_CLOCK_MULTIPLIER;if(Math.abs(e)===h){i.multiplier=e>0?t[t.length-1]:t[0];return}var a=v(e,t);if(n.snapToTicks){a=t[m(a,t)]}else{if(a!==0){var o=Math.abs(a);if(o>100){var s=o.toFixed(0).length-2;var u=Math.pow(10,s);a=Math.round(a/u)*u|0}else if(o>f){a=Math.round(a)}else if(o>1){a=+a.toFixed(1)}else if(o>0){a=+a.toFixed(2)}}}i.multiplier=a}});this._canAnimate=undefined;s.defineProperty(this,"_canAnimate",function(){var e=n._clockViewModel;var r=e.clockRange;if(n.shuttleRingDragging||r===t.UNBOUNDED){return true}var i=e.multiplier;var a=e.currentTime;var s=e.startTime;var u=false;if(r===t.LOOP_STOP){u=o.greaterThan(a,s)||a.equals(s)&&i>0}else{var l=e.stopTime;u=o.greaterThan(a,s)&&o.lessThan(a,l)||a.equals(s)&&i>0||a.equals(l)&&i<0}if(!u){e.shouldAnimate=false}return u});this._isSystemTimeAvailable=undefined;s.defineProperty(this,"_isSystemTimeAvailable",function(){var e=n._clockViewModel;var r=e.clockRange;if(r===t.UNBOUNDED){return true}var i=e.systemTime;return o.greaterThanOrEquals(i,e.startTime)&&o.lessThanOrEquals(i,e.stopTime)});this._isAnimating=undefined;s.defineProperty(this,"_isAnimating",function(){return n._clockViewModel.shouldAnimate&&(n._canAnimate||n.shuttleRingDragging)});var u=l(function(){var e=n._clockViewModel;if(e.shouldAnimate){e.shouldAnimate=false}else if(n._canAnimate){e.shouldAnimate=true}});this._pauseViewModel=new c(u,{toggled:s.computed(function(){return!n._isAnimating}),tooltip:"Pause"});var d=l(function(){var e=n._clockViewModel;var t=e.multiplier;if(t>0){e.multiplier=-t}e.shouldAnimate=true});this._playReverseViewModel=new c(d,{toggled:s.computed(function(){return n._isAnimating&&e.multiplier<0}),tooltip:"Play Reverse"});var p=l(function(){var e=n._clockViewModel;var t=e.multiplier;if(t<0){e.multiplier=-t}e.shouldAnimate=true});this._playForwardViewModel=new c(p,{toggled:s.computed(function(){return n._isAnimating&&e.multiplier>0&&e.clockStep!==r.SYSTEM_CLOCK}),tooltip:"Play Forward"});var y=l(function(){n._clockViewModel.clockStep=r.SYSTEM_CLOCK},s.getObservable(this,"_isSystemTimeAvailable"));this._playRealtimeViewModel=new c(y,{toggled:s.computed(function(){return e.clockStep===r.SYSTEM_CLOCK}),tooltip:s.computed(function(){return n._isSystemTimeAvailable?"Today (real-time)":"Current time not in range"})});this._slower=l(function(){var e=n._clockViewModel;var t=n._allShuttleRingTicks;var r=e.multiplier;var i=m(r,t)-1;if(i>=0){e.multiplier=t[i]}});this._faster=l(function(){var e=n._clockViewModel;var t=n._allShuttleRingTicks;var r=e.multiplier;var i=m(r,t)+1;if(i<t.length){e.multiplier=t[i]}})}g.defaultDateFormatter=function(e,t){var r=o.toGregorianDate(e);return d[r.month-1]+" "+r.day+" "+r.year};g.defaultTicks=[.001,.002,.005,.01,.02,.05,.1,.25,.5,1,2,5,10,15,30,60,120,300,600,900,1800,3600,7200,14400,21600,43200,86400,172800,345600,604800];g.defaultTimeFormatter=function(e,t){var r=o.toGregorianDate(e);var i=Math.round(r.millisecond);if(Math.abs(t._clockViewModel.multiplier)<1){return u("%02d:%02d:%02d.%03d",r.hour,r.minute,r.second,i)}return u("%02d:%02d:%02d UTC",r.hour,r.minute,r.second)};g.prototype.getShuttleRingTicks=function(){return this._sortedFilteredPositiveTicks.slice(0)};g.prototype.setShuttleRingTicks=function(e){if(!i(e)){throw new a("positiveTicks is required.")}var t;var r;var n;var o={};var s=this._sortedFilteredPositiveTicks;s.length=0;for(t=0,r=e.length;t<r;++t){n=e[t];if(!o.hasOwnProperty(n)){o[n]=true;s.push(n)}}s.sort(p);var u=[];for(r=s.length,t=r-1;t>=0;--t){n=s[t];if(n!==0){u.push(-n)}}Array.prototype.push.apply(u,s);this._allShuttleRingTicks=u};n(g.prototype,{slower:{get:function(){return this._slower}},faster:{get:function(){return this._faster}},clockViewModel:{get:function(){return this._clockViewModel}},pauseViewModel:{get:function(){return this._pauseViewModel}},playReverseViewModel:{get:function(){return this._playReverseViewModel}},playForwardViewModel:{get:function(){return this._playForwardViewModel}},playRealtimeViewModel:{get:function(){return this._playRealtimeViewModel}},dateFormatter:{get:function(){return this._dateFormatter},set:function(e){if(typeof e!=="function"){throw new a("dateFormatter must be a function")}this._dateFormatter=e}},timeFormatter:{get:function(){return this._timeFormatter},set:function(e){if(typeof e!=="function"){throw new a("timeFormatter must be a function")}this._timeFormatter=e}}});g._maxShuttleRingAngle=h;g._realtimeShuttleRingAngle=f;return g});define("Widgets/BaseLayerPicker/BaseLayerPickerViewModel",["../../Core/defaultValue","../../Core/defined","../../Core/defineProperties","../../Core/DeveloperError","../../Core/EllipsoidTerrainProvider","../../Core/isArray","../../ThirdParty/knockout","../createCommand"],function(e,t,r,i,n,a,o,s){"use strict";function u(r){r=e(r,e.EMPTY_OBJECT);var u=r.globe;var l=e(r.imageryProviderViewModels,[]);var c=e(r.terrainProviderViewModels,[]);if(!t(u)){throw new i("globe is required")}this._globe=u;this.imageryProviderViewModels=l.slice(0);this.terrainProviderViewModels=c.slice(0);this.dropDownVisible=false;o.track(this,["imageryProviderViewModels","terrainProviderViewModels","dropDownVisible"]);this.buttonTooltip=undefined;o.defineProperty(this,"buttonTooltip",function(){var e=this.selectedImagery;var r=this.selectedTerrain;var i=t(e)?e.name:undefined;var n=t(r)?r.name:undefined;if(t(i)&&t(n)){return i+"\n"+n}else if(t(i)){return i}return n});this.buttonImageUrl=undefined;o.defineProperty(this,"buttonImageUrl",function(){var e=this.selectedImagery;return t(e)?e.iconUrl:undefined});this.selectedImagery=undefined;var d=o.observable();this._currentImageryProviders=[];o.defineProperty(this,"selectedImagery",{get:function(){return d()},set:function(e){if(d()===e){this.dropDownVisible=false;return}var r;var i=this._currentImageryProviders;var n=i.length;var o=this._globe.imageryLayers;for(r=0;r<n;r++){var s=o.length;for(var u=0;u<s;u++){var l=o.get(u);if(l.imageryProvider===i[r]){o.remove(l);break}}}if(t(e)){var c=e.creationCommand();if(a(c)){var f=c.length;for(r=f-1;r>=0;r--){o.addImageryProvider(c[r],0)}this._currentImageryProviders=c.slice(0)}else{this._currentImageryProviders=[c];o.addImageryProvider(c,0)}}d(e);this.dropDownVisible=false}});this.selectedTerrain=undefined;var f=o.observable();o.defineProperty(this,"selectedTerrain",{get:function(){return f()},set:function(e){if(f()===e){this.dropDownVisible=false;return}var r;if(t(e)){r=e.creationCommand()}this._globe.depthTestAgainstTerrain=!(r instanceof n);this._globe.terrainProvider=r;f(e);this.dropDownVisible=false}});var h=this;this._toggleDropDown=s(function(){h.dropDownVisible=!h.dropDownVisible});this.selectedImagery=e(r.selectedImageryProviderViewModel,l[0]);this.selectedTerrain=e(r.selectedTerrainProviderViewModel,c[0])}r(u.prototype,{toggleDropDown:{get:function(){return this._toggleDropDown}},globe:{get:function(){return this._globe}}});return u});define("Widgets/BaseLayerPicker/BaseLayerPicker",["../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../Core/FeatureDetection","../../ThirdParty/knockout","../getElement","./BaseLayerPickerViewModel"],function(e,t,r,i,n,a,o,s){"use strict";function u(t,r){if(!e(t)){throw new i("container is required.")}t=o(t);var u=new s(r);var l=document.createElement("button");l.type="button";l.className="cesium-button cesium-toolbar-button";l.setAttribute("data-bind","attr: { title: buttonTooltip },click: toggleDropDown");t.appendChild(l);var c=document.createElement("img");c.setAttribute("draggable","false");c.className="cesium-baseLayerPicker-selected";c.setAttribute("data-bind","attr: { src: buttonImageUrl }");l.appendChild(c);var d=document.createElement("div");d.className="cesium-baseLayerPicker-dropDown";d.setAttribute("data-bind",'css: { "cesium-baseLayerPicker-dropDown-visible" : dropDownVisible }');t.appendChild(d);var f=document.createElement("div");f.className="cesium-baseLayerPicker-sectionTitle";f.setAttribute("data-bind","visible: imageryProviderViewModels.length > 0");f.innerHTML="Imagery";d.appendChild(f);var h=document.createElement("div");h.className="cesium-baseLayerPicker-choices";h.setAttribute("data-bind","foreach: imageryProviderViewModels");d.appendChild(h);var p=document.createElement("div");p.className="cesium-baseLayerPicker-item";p.setAttribute("data-bind",'css: { "cesium-baseLayerPicker-selectedItem" : $data === $parent.selectedImagery },attr: { title: tooltip },visible: creationCommand.canExecute,click: function($data) { $parent.selectedImagery = $data; }');h.appendChild(p);var m=document.createElement("img");m.className="cesium-baseLayerPicker-itemIcon";m.setAttribute("data-bind","attr: { src: iconUrl }");m.setAttribute("draggable","false");p.appendChild(m);var v=document.createElement("div");v.className="cesium-baseLayerPicker-itemLabel";v.setAttribute("data-bind","text: name");p.appendChild(v);var _=document.createElement("div");_.className="cesium-baseLayerPicker-sectionTitle";_.setAttribute("data-bind","visible: terrainProviderViewModels.length > 0");_.innerHTML="Terrain";d.appendChild(_);var g=document.createElement("div");g.className="cesium-baseLayerPicker-choices";g.setAttribute("data-bind","foreach: terrainProviderViewModels");d.appendChild(g);var y=document.createElement("div");y.className="cesium-baseLayerPicker-item";y.setAttribute("data-bind",'css: { "cesium-baseLayerPicker-selectedItem" : $data === $parent.selectedTerrain },attr: { title: tooltip },visible: creationCommand.canExecute,click: function($data) { $parent.selectedTerrain = $data; }');g.appendChild(y);var w=document.createElement("img");w.className="cesium-baseLayerPicker-itemIcon";w.setAttribute("data-bind","attr: { src: iconUrl }");w.setAttribute("draggable","false");y.appendChild(w);var C=document.createElement("div");C.className="cesium-baseLayerPicker-itemLabel";C.setAttribute("data-bind","text: name");y.appendChild(C);a.applyBindings(u,l);a.applyBindings(u,d);this._viewModel=u;this._container=t;this._element=l;this._dropPanel=d;this._closeDropDown=function(e){if(!(l.contains(e.target)||d.contains(e.target))){u.dropDownVisible=false}};if(n.supportsPointerEvents()){document.addEventListener("pointerdown",this._closeDropDown,true)}else{document.addEventListener("mousedown",this._closeDropDown,true);document.addEventListener("touchstart",this._closeDropDown,true)}}t(u.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}});u.prototype.isDestroyed=function(){return false};u.prototype.destroy=function(){if(n.supportsPointerEvents()){document.removeEventListener("pointerdown",this._closeDropDown,true)}else{document.removeEventListener("mousedown",this._closeDropDown,true);document.removeEventListener("touchstart",this._closeDropDown,true)}a.cleanNode(this._element);a.cleanNode(this._dropPanel);this._container.removeChild(this._element);this._container.removeChild(this._dropPanel);return r(this)};return u});define("Widgets/BaseLayerPicker/ProviderViewModel",["../../Core/defined","../../Core/defineProperties","../../Core/DeveloperError","../../ThirdParty/knockout","../createCommand"],function(e,t,r,i,n){"use strict";function a(t){if(!e(t.name)){throw new r("options.name is required.")}if(!e(t.tooltip)){throw new r("options.tooltip is required.")}if(!e(t.iconUrl)){throw new r("options.iconUrl is required.")}if(typeof t.creationFunction!=="function"){throw new r("options.creationFunction is required.")}var a=t.creationFunction;if(!e(a.canExecute)){a=n(a)}this._creationCommand=a;this.name=t.name;this.tooltip=t.tooltip;this.iconUrl=t.iconUrl;i.track(this,["name","tooltip","iconUrl"])}t(a.prototype,{creationCommand:{get:function(){return this._creationCommand}}});return a});define("Widgets/BaseLayerPicker/createDefaultImageryProviderViewModels",["../../Core/buildModuleUrl","../../Scene/ArcGisMapServerImageryProvider","../../Scene/BingMapsImageryProvider","../../Scene/BingMapsStyle","../../Scene/createOpenStreetMapImageryProvider","../../Scene/createTileMapServiceImageryProvider","../../Scene/MapboxImageryProvider","../BaseLayerPicker/ProviderViewModel"],function(e,t,r,i,n,a,o,s){"use strict";function u(){var u=[];u.push(new s({name:"Bing Maps Aerial",iconUrl:e("Widgets/Images/ImageryProviders/bingAerial.png"),tooltip:"Bing Maps aerial imagery \nhttp://www.bing.com/maps",creationFunction:function(){return new r({url:"https://dev.virtualearth.net",mapStyle:i.AERIAL})}}));u.push(new s({name:"Bing Maps Aerial with Labels",iconUrl:e("Widgets/Images/ImageryProviders/bingAerialLabels.png"),tooltip:"Bing Maps aerial imagery with label overlays \nhttp://www.bing.com/maps",creationFunction:function(){return new r({url:"https://dev.virtualearth.net",mapStyle:i.AERIAL_WITH_LABELS})}}));u.push(new s({name:"Bing Maps Roads",iconUrl:e("Widgets/Images/ImageryProviders/bingRoads.png"),tooltip:"Bing Maps standard road maps\nhttp://www.bing.com/maps",creationFunction:function(){return new r({url:"https://dev.virtualearth.net",mapStyle:i.ROAD})}}));u.push(new s({name:"Mapbox Satellite",tooltip:"Mapbox satellite imagery https://www.mapbox.com/maps/",iconUrl:e("Widgets/Images/ImageryProviders/mapboxSatellite.png"),creationFunction:function(){return new o({mapId:"mapbox.satellite"})}}));u.push(new s({name:"Mapbox Streets",tooltip:"Mapbox streets imagery https://www.mapbox.com/maps/",iconUrl:e("Widgets/Images/ImageryProviders/mapboxTerrain.png"),creationFunction:function(){return new o({mapId:"mapbox.streets"})}}));u.push(new s({name:"Mapbox Streets Classic",
tooltip:"Mapbox streets basic imagery https://www.mapbox.com/maps/",iconUrl:e("Widgets/Images/ImageryProviders/mapboxStreets.png"),creationFunction:function(){return new o({mapId:"mapbox.streets-basic"})}}));u.push(new s({name:"ESRI World Imagery",iconUrl:e("Widgets/Images/ImageryProviders/esriWorldImagery.png"),tooltip:"World Imagery provides one meter or better satellite and aerial imagery in many parts of the world and lower resolution satellite imagery worldwide.  The map includes NASA Blue Marble: Next Generation 500m resolution imagery at small scales (above 1:1,000,000), i-cubed 15m eSAT imagery at medium-to-large scales (down to 1:70,000) for the world, and USGS 15m Landsat imagery for Antarctica. The map features 0.3m resolution imagery in the continental United States and 0.6m resolution imagery in parts of Western Europe from DigitalGlobe. In other parts of the world, 1 meter resolution imagery is available from GeoEye IKONOS, i-cubed Nationwide Prime, Getmapping, AeroGRID, IGN Spain, and IGP Portugal.  Additionally, imagery at different resolutions has been contributed by the GIS User Community.\nhttp://www.esri.com",creationFunction:function(){return new t({url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",enablePickFeatures:false})}}));u.push(new s({name:"ESRI World Street Map",iconUrl:e("Widgets/Images/ImageryProviders/esriWorldStreetMap.png"),tooltip:"This worldwide street map presents highway-level data for the world. Street-level data includes the United States; much of Canada; Japan; most countries in Europe; Australia and New Zealand; India; parts of South America including Argentina, Brazil, Chile, Colombia, and Venezuela; Ghana; and parts of southern Africa including Botswana, Lesotho, Namibia, South Africa, and Swaziland.\nhttp://www.esri.com",creationFunction:function(){return new t({url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer",enablePickFeatures:false})}}));u.push(new s({name:"ESRI National Geographic",iconUrl:e("Widgets/Images/ImageryProviders/esriNationalGeographic.png"),tooltip:"This web map contains the National Geographic World Map service. This map service is designed to be used as a general reference map for informational and educational purposes as well as a basemap by GIS professionals and other users for creating web maps and web mapping applications.\nhttp://www.esri.com",creationFunction:function(){return new t({url:"https://services.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer/",enablePickFeatures:false})}}));u.push(new s({name:"OpenStreetMap",iconUrl:e("Widgets/Images/ImageryProviders/openStreetMap.png"),tooltip:"OpenStreetMap (OSM) is a collaborative project to create a free editable map of the world.\nhttp://www.openstreetmap.org",creationFunction:function(){return n({url:"https://a.tile.openstreetmap.org/"})}}));u.push(new s({name:"Stamen Watercolor",iconUrl:e("Widgets/Images/ImageryProviders/stamenWatercolor.png"),tooltip:"Reminiscent of hand drawn maps, Stamen watercolor maps apply raster effect area washes and organic edges over a paper texture to add warm pop to any map.\nhttp://maps.stamen.com",creationFunction:function(){return n({url:"https://stamen-tiles.a.ssl.fastly.net/watercolor/",credit:"Map tiles by Stamen Design, under CC BY 3.0. Data by OpenStreetMap, under CC BY SA."})}}));u.push(new s({name:"Stamen Toner",iconUrl:e("Widgets/Images/ImageryProviders/stamenToner.png"),tooltip:"A high contrast black and white map.\nhttp://maps.stamen.com",creationFunction:function(){return n({url:"https://stamen-tiles.a.ssl.fastly.net/toner/",credit:"Map tiles by Stamen Design, under CC BY 3.0. Data by OpenStreetMap, under CC BY SA."})}}));u.push(new s({name:"The Black Marble",iconUrl:e("Widgets/Images/ImageryProviders/blackMarble.png"),tooltip:"The lights of cities and villages trace the outlines of civilization in this global view of the Earth at night as seen by NASA/NOAA's Suomi NPP satellite.",creationFunction:function(){return a({url:"https://cesiumjs.org/blackmarble",flipXY:true,credit:"Black Marble imagery courtesy NASA Earth Observatory"})}}));u.push(new s({name:"Natural EarthII",iconUrl:e("Widgets/Images/ImageryProviders/naturalEarthII.png"),tooltip:"Natural Earth II, darkened for contrast.\nhttp://www.naturalearthdata.com/",creationFunction:function(){return a({url:e("Assets/Textures/NaturalEarthII")})}}));return u}return u});define("Widgets/BaseLayerPicker/createDefaultTerrainProviderViewModels",["../../Core/buildModuleUrl","../../Core/CesiumTerrainProvider","../../Core/EllipsoidTerrainProvider","../BaseLayerPicker/ProviderViewModel"],function(e,t,r,i){"use strict";function n(){var n=[];n.push(new i({name:"WGS84 Ellipsoid",iconUrl:e("Widgets/Images/TerrainProviders/Ellipsoid.png"),tooltip:"WGS84 standard ellipsoid, also known as EPSG:4326",creationFunction:function(){return new r}}));n.push(new i({name:"STK World Terrain meshes",iconUrl:e("Widgets/Images/TerrainProviders/STK.png"),tooltip:"High-resolution, mesh-based terrain for the entire globe. Free for use on the Internet. Closed-network options are available.\nhttp://www.agi.com",creationFunction:function(){return new t({url:"https://assets.agi.com/stk-terrain/world",requestWaterMask:true,requestVertexNormals:true})}}));return n}return n});define("Widgets/CesiumInspector/Cesium3DTilesInspectorViewModel",["../../Core/Cartesian3","../../Core/Cartographic","../../Scene/Cesium3DTileFeature","../../Scene/Cesium3DTileset","../../Scene/Cesium3DTileStyle","../../Scene/Cesium3DTileColorBlendMode","../../Core/Check","../../Core/Color","../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../ThirdParty/knockout","../../Scene/PerformanceDisplay","../../Core/ScreenSpaceEventHandler","../../Core/ScreenSpaceEventType","../../ThirdParty/when","../createCommand"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v){"use strict";function _(e,t){var r=[];var i;for(i in t){if(t.hasOwnProperty(i)){r.push(i);e[i]=t[i].default}}d.track(e,r);for(i in t){if(t.hasOwnProperty(i)){var n=t[i].subscribe;if(n){e._subscriptions[i]=d.getObservable(e,i).subscribe(n)}}}}function g(e){o.typeOf.object("scene",e);var t=this;var n=e.canvas;this._eventHandler=new h(n);this._scene=e;this._canvas=n;function l(e){var r=t._scene.pick(e.position);if(u(r)&&r.primitive instanceof i){t.tileset=r.primitive}t._pickActive=false}this._togglePickTileset=v(function(){t._pickActive=!t._pickActive});this._performanceDisplay=new f({container:document.createElement("div")});this.highlightColor=new s(1,1,0,.4);this._colorBlendModes=[{text:"Highlight",val:a.HIGHLIGHT},{text:"Replace",val:a.REPLACE},{text:"Mix",val:a.MIX}];this._style=undefined;this._shouldStyle=false;this._subscriptions={};var c={showStats:{default:true,subscribe:function(e){if(t._tileset){t._updateStats(false)}}},showPickStats:{default:true,subscribe:function(e){if(t._tileset){t._updateStats(true)}}},picking:{default:true,subscribe:function(){return function(i){if(i){t._eventHandler.setInputAction(function(i){var n=e.pick(i.endPosition);if(n instanceof r){t._feature=n;t._updateStats(true)}else{t._feature=undefined}},p.MOUSE_MOVE)}else{t._feature=undefined;t._eventHandler.removeInputAction(p.MOUSE_MOVE)}}}()},freezeFrame:{default:false,subscribe:function(e){if(t._tileset){t._tileset.debugFreezeFrame=e;t._scene.debugShowFrustumPlanes=e}}},colorize:{default:false,subscribe:function(e){if(u(t._tileset)){t._tileset.debugColorizeTiles=e;if(!e){t._shouldStyle=true}}}},wireframe:{default:false,subscribe:function(e){if(t._tileset){t._tileset.debugWireframe=e}}},showBoundingVolumes:{default:false,subscribe:function(e){if(t._tileset){t._tileset.debugShowBoundingVolume=e}}},showContentBoundingVolumes:{default:false,subscribe:function(e){if(t._tileset){t._tileset.debugShowContentBoundingVolume=e}}},showRequestVolumes:{default:false,subscribe:function(e){if(t._tileset){t._tileset.debugShowViewerRequestVolume=e}}},showGeometricError:{default:false,subscribe:function(e){if(t._tileset){t._tileset.debugShowGeometricError=e}}},maximumSSE:{default:16,subscribe:function(e){if(t._tileset){t._tileset.maximumScreenSpaceError=e}}},dynamicSSE:{default:false,subscribe:function(e){if(t._tileset){t._tileset.dynamicScreenSpaceError=e}}},dynamicSSEDensity:{default:.00278,subscribe:function(e){if(t._tileset){t._tileset.dynamicScreenSpaceErrorDensity=e}}},dynamicSSEFactor:{default:4,subscribe:function(e){if(t._tileset){t._tileset.dynamicScreenSpaceErrorFactor=e}}},performance:{default:false},statsText:{default:""},pickStatsText:{default:""},styleString:{default:"{}",subscribe:function(e){t._styleString=e;t._applyStyle()}},colorBlendMode:{default:a.HIGHLIGHT,subscribe:function(e){if(u(t._tileset)){t._tileset.colorBlendMode=e}}}};_(this,c);_(this,{_tileset:{default:undefined,subscribe:function(e){t._style=undefined;t.statsText="";t.pickStatsText="";t._properties={};if(u(e)){e.readyPromise.then(function(e){t._properties=e.properties;t._tilesetLoaded.resolve(e)});var r=["colorize","wireframe","showBoundingVolumes","showContentBoundingVolumes","showRequestVolumes","showGeometricError","freezeFrame"];var i=r.length;for(var n=0;n<i;++n){d.getObservable(t,r[n]).valueHasMutated()}t.maximumSSE=e.maximumScreenSpaceError;t.dynamicSSE=e.dynamicScreenSpaceError;t.dynamicSSEDensity=e.dynamicScreenSpaceErrorDensity;t.dynamicSSEFactor=e.dynamicScreenSpaceErrorFactor;t.colorBlendMode=e.colorBlendMode;t._updateStats(false);t._updateStats(true)}}},_feature:{default:undefined,subscribe:function(){var e;var r=new s;var i=new s;return function(n){if(e!==n){if(u(e)&&u(e._batchTable)&&!e._batchTable.isDestroyed()){var a=t._scene.frameState;if(!t._colorOverriden&&u(t._style)){e.color=t._style.color.evaluateColor(a,e,r)}else{e.color=i}e=undefined}if(u(n)){e=n;s.clone(n.color,i);n.color=t.highlightColor}}}}()},_pickActive:{default:false,subscribe:function(e){if(e){t._eventHandler.setInputAction(l,p.LEFT_CLICK)}else{t._eventHandler.removeInputAction(p.LEFT_CLICK)}}},_styleString:{default:"{}"},_editorError:{default:""},_properties:{default:{}}});for(var m in c){if(c.hasOwnProperty(m)){d.getObservable(t,m).valueHasMutated()}}this.propertiesText=d.pureComputed(function(){var e=[];for(var r in t._properties){if(t._properties.hasOwnProperty(r)){e.push(r)}}return e.join(", ")})}l(g.prototype,{tileset:{get:function(){return this._tileset},set:function(e){this._feature=undefined;this._tilesetLoaded=m.defer();this._tileset=e}},feature:{get:function(){return this._feature}},trimTilesCache:{get:function(){var e=this;return v(function(){if(u(e._tileset)){e._tileset.trimLoadedTiles()}})}},_compileStyle:{get:function(){var e=this;return v(function(){e.styleString=e._styleString;e._applyStyle()})}},_checkCompile:{get:function(){var e=this;return v(function(t,r){if(r.ctrlKey&&(r.keyCode===10||r.keyCode===13)){e._compileStyle()}return true})}},_colorOverriden:{get:function(){return this.colorize}}});g.prototype._applyStyle=function(){if(u(this._style)){if(this._styleString!==JSON.stringify(this._style.style)){if(u(this._tileset)){var e=this._tileset.style;this._editorError="";try{if(this._styleString.length===0){this._styleString="{}"}var t=new n(JSON.parse(this._styleString));this._tileset.style=t;this._style=t;this._tileset.update(this._scene.frameState)}catch(t){this._tileset.style=e;this._style=e;this._editorError=t.toString()}var r=this._feature;this._feature=undefined;this._feature=r}}}};g.prototype._updateStats=function(e){var t=this._tileset;if(!u(t)){return}var r=t.statistics;var i=this.showStats&&!e||this.showPickStats&&e;if(i){var n='<ul class="cesium-cesiumInspector-stats">';n+="<li><strong>Visited: </strong>"+r.visited.toLocaleString()+"</li>"+"<li><strong>Selected: </strong>"+t._selectedTiles.length.toLocaleString()+"</li>"+"<li><strong>Commands: </strong>"+r.numberOfCommands.toLocaleString()+"</li>";n+="</ul>";n+='<ul class="cesium-cesiumInspector-stats">';if(!e){n+="<li><strong>Requests: </strong>"+r.numberOfPendingRequests.toLocaleString()+"</li>"+"<li><strong>Attempted: </strong>"+r.numberOfAttemptedRequests.toLocaleString()+"</li>"+"<li><strong>Processing: </strong>"+r.numberProcessing.toLocaleString()+"</li>"+"<li><strong>Content Ready: </strong>"+r.numberContentReady.toLocaleString()+"</li>"+"<li><strong>Total: </strong>"+r.numberTotal.toLocaleString()+"</li>";n+="</ul>";n+='<ul class="cesium-cesiumInspector-stats">';n+="<li><strong>Features Selected: </strong>"+r.numberOfFeaturesSelected.toLocaleString()+"</li>"+"<li><strong>Features Loaded: </strong>"+r.numberOfFeaturesLoaded.toLocaleString()+"</li>"+"<li><strong>Points Selected: </strong>"+r.numberOfPointsSelected.toLocaleString()+"</li>"+"<li><strong>Points Loaded: </strong>"+r.numberOfPointsLoaded.toLocaleString()+"</li>";n+="</ul>";n+='<ul class="cesium-cesiumInspector-stats">';n+="<li><strong>Tiles styled: </strong>"+r.numberOfTilesStyled.toLocaleString()+"</li>"+"<li><strong>Features styled: </strong>"+r.numberOfFeaturesStyled.toLocaleString()+"</li>";n+="</ul>";n+='<ul class="cesium-cesiumInspector-stats">';n+="<li><strong>Children Union Culled: </strong>"+r.numberOfTilesCulledWithChildrenUnion.toLocaleString()+"</li>";n+="</ul>";n+='<ul class="cesium-cesiumInspector-stats">';n+="<li><strong>Vertex Memory (MB): </strong>"+Math.round(r.vertexMemorySizeInBytes/1048576).toLocaleString()+"</li>"+"<li><strong>Texture Memory (MB): </strong>"+Math.round(r.textureMemorySizeInBytes/1048576).toLocaleString()+"</li>"+"<li><strong>Batch Table Memory (MB): </strong>"+Math.round(r.batchTableMemorySizeInBytes/1048576).toLocaleString()+"</li>";n+="</ul>"}if(e){this.pickStatsText=n}else{this.statsText=n}}this.pickStatsText=this.showPickStats?this.pickStatsText:"";this.statsText=this.showStats?this.statsText:""};g.prototype.update=function(){var e=this._tileset;if(this.performance){this._performanceDisplay.update()}if(u(e)&&(!u(this._style)||this._style!==e.style)){this._style=e.style;if(u(this._style)){this.styleString=JSON.stringify(this._style.style,null,"  ")}else{this.styleString=""}}if(this._shouldStyle&&u(e)){e._styleEngine.makeDirty();this._shouldStyle=false}this._updateStats(false)};g.prototype.isDestroyed=function(){return false};g.prototype.destroy=function(){this._eventHandler.destroy();for(var e in this._subscriptions){if(this._subscriptions.hasOwnProperty(e)){this._subscriptions[e].dispose()}}return c(this)};return g});define("Widgets/CesiumInspector/Cesium3DTilesInspector",["../../Core/Check","../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../ThirdParty/knockout","../getElement","../CesiumInspector/Cesium3DTilesInspectorViewModel"],function(e,t,r,i,n,a,o){"use strict";function s(t,r){e.defined("container",t);e.typeOf.object("scene",r);t=a(t);var i=this;var s=new o(r);this._viewModel=s;this._container=t;this._inspectorModel={inspectorVisible:true,tilesetVisible:false,displayVisible:false,updateVisible:false,loggingVisible:false,styleVisible:false,toggleInspector:function(){i._inspectorModel.inspectorVisible=!i._inspectorModel.inspectorVisible},toggleTileset:function(){i._inspectorModel.tilesetVisible=!i._inspectorModel.tilesetVisible},toggleDisplay:function(){i._inspectorModel.displayVisible=!i._inspectorModel.displayVisible},toggleUpdate:function(){i._inspectorModel.updateVisible=!i._inspectorModel.updateVisible},toggleLogging:function(){i._inspectorModel.loggingVisible=!i._inspectorModel.loggingVisible},toggleStyle:function(){i._inspectorModel.styleVisible=!i._inspectorModel.styleVisible}};n.track(this._inspectorModel,["inspectorVisible","tilesetVisible","displayVisible","updateVisible","loggingVisible","styleVisible"]);var h=document.createElement("div");this._element=h;var p=document.createElement("div");p.textContent="3D Tiles Inspector";p.className="cesium-cesiumInspector-button";p.setAttribute("data-bind","click: toggleInspector");h.appendChild(p);h.className="cesium-cesiumInspector cesium-3DTilesInspector";h.setAttribute("data-bind",'css: { "cesium-cesiumInspector-visible" : inspectorVisible, "cesium-cesiumInspector-hidden" : !inspectorVisible }');t.appendChild(this._element);var m=u("Tileset","tilesetVisible","toggleTileset");var v=u("Display","displayVisible","toggleDisplay");var _=u("Update","updateVisible","toggleUpdate");var g=u("Logging","loggingVisible","toggleLogging");var y=u("Style","styleVisible","toggleStyle");h.appendChild(m);h.appendChild(v);h.appendChild(_);h.appendChild(g);h.appendChild(y);n.applyBindings(this._inspectorModel,h);var w=document.createElement("div");w.className="field-group";var C=document.createElement("label");C.className="field-label";C.appendChild(document.createTextNode("Properties: "));var b=document.createElement("div");b.setAttribute("data-bind","text: propertiesText");w.appendChild(C);w.appendChild(b);m.contents.appendChild(w);m.contents.appendChild(f("_togglePickTileset","Pick Tileset","_pickActive"));m.contents.appendChild(f("trimTilesCache","Trim Tiles Cache"));m.contents.appendChild(l("picking","Enable Picking"));n.applyBindings(s,m.contents);v.contents.appendChild(l("colorize","Colorize"));v.contents.appendChild(l("wireframe","Wireframe"));v.contents.appendChild(l("showBoundingVolumes","Bounding Volumes"));v.contents.appendChild(l("showContentBoundingVolumes","Content Volumes"));v.contents.appendChild(l("showRequestVolumes","Request Volumes"));v.contents.appendChild(l("showGeometricError","Geometric Error"));n.applyBindings(s,v.contents);_.contents.appendChild(l("freezeFrame","Freeze Frame"));_.contents.appendChild(l("dynamicSSE","Dynamic SSE"));var S=document.createElement("div");S.appendChild(c("maximumSSE",0,128,1,"Maximum SSE"));_.contents.appendChild(S);var E=document.createElement("div");E.setAttribute("data-bind",'css: {"cesium-cesiumInspector-show" : dynamicSSE, "cesium-cesiumInspector-hide" : !dynamicSSE}');E.appendChild(d(s,"dynamicSSEDensity",0,1,200,6,"SSE Density"));E.appendChild(c("dynamicSSEFactor",1,10,.1,"SSE Factor"));_.contents.appendChild(E);n.applyBindings(s,_.contents);g.contents.appendChild(l("performance","Performance"));g.contents.appendChild(this._viewModel._performanceDisplay._container);this._viewModel._performanceDisplay._container.setAttribute("data-bind",'css: {"cesium-cesiumInspector-show" : performance, "cesium-cesiumInspector-hide" : !performance}');g.contents.appendChild(l("showStats","Stats"));var T=document.createElement("div");T.setAttribute("data-bind",'html: statsText, css: {"cesium-cesiumInspector-show" : showStats, "cesium-cesiumInspector-hide" : !showStats}');T.setAttribute("style","font-size: 11px");g.contents.appendChild(T);g.contents.appendChild(l("showPickStats","Pick Stats"));var x=document.createElement("div");x.setAttribute("data-bind",'html: pickStatsText, css: {"cesium-cesiumInspector-show" : showPickStats, "cesium-cesiumInspector-hide" : !showPickStats}');x.setAttribute("style","font-size: 11px");g.contents.appendChild(x);n.applyBindings(s,g.contents);y.contents.appendChild(document.createTextNode("Color Blend Mode: "));var A=document.createElement("select");A.setAttribute("data-bind","options: _colorBlendModes, "+'optionsText: "text", '+'optionsValue: "val", '+"value: colorBlendMode");y.contents.appendChild(A);var P=document.createElement("textarea");P.setAttribute("wrap","soft");P.setAttribute("data-bind",'valueUpdate: "keyup", value: _styleString, event: { keypress: _checkCompile }');y.contents.className="cesium-cesiumInspector-styleEditor";y.contents.appendChild(P);var D=f("_compileStyle","Compile (Ctrl+Enter)");y.contents.appendChild(D);var M=document.createElement("div");M.className="cesium-cesiumInspector-error";M.setAttribute("data-bind","text: _editorError");y.contents.appendChild(M);n.applyBindings(s,y.contents);P.addEventListener("keydown",function(e){if(e.keyCode===9){e.preventDefault();var t=this.selectionStart;var r=this.selectionEnd;var i=r;var n=this.value.slice(t,r);var a=n.split("\n");var o=a.length;var s;if(!e.shiftKey){for(s=0;s<o;++s){a[s]="  "+a[s];i+=2}}else{for(s=0;s<o;++s){if(a[s][0]===" "){if(a[s][1]===" "){a[s]=a[s].substr(2);i-=2}else{a[s]=a[s].substr(1);i-=1}}}}var u=a.join("\n");this.value=this.value.slice(0,t)+u+this.value.slice(r);this.selectionStart=t!==r?t:i;this.selectionEnd=i}})}r(s.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}});s.prototype.isDestroyed=function(){return false};s.prototype.destroy=function(){n.cleanNode(this._element);this._container.removeChild(this._element);this.viewModel.destroy();return i(this)};function u(e,r,i){var n=document.createElement("div");n.className="cesium-cesiumInspector-dropDown";var a=document.createElement("div");a.className="cesium-cesiumInspector-sectionHeader";var o=document.createElement("span");o.className="cesium-cesiumInspector-toggleSwitch";var s=[];if(t(i)){if(t(r)){s.push("text: "+r+' ? "-" : "+"')}s.push("click: "+i)}o.setAttribute("data-bind",s.join(", "));a.appendChild(o);a.appendChild(document.createTextNode(e));var u=document.createElement("div");u.className="cesium-cesiumInspector-section";if(t(r)){u.setAttribute("data-bind",'css: {"cesium-cesiumInspector-show" : '+r+', "cesium-cesiumInspector-hide" : !'+r+"}")}n.appendChild(a);n.appendChild(u);var l=document.createElement("div");u.appendChild(l);n.contents=l;return n}function l(e,r,i){var n=document.createElement("div");var a=document.createElement("input");a.type="checkbox";var o="checked: "+e;if(t(i)){o+=", enable: "+i}a.setAttribute("data-bind",o);n.appendChild(a);n.appendChild(document.createTextNode(r));return n}function c(e,t,r,i,n){var a=document.createElement("div");a.className="cesium-cesiumInspector-slider";var o=document.createElement("input");o.setAttribute("data-bind","value: "+e);o.type="number";var s=document.createElement("input");s.type="range";s.min=t;s.max=r;s.step=i;s.setAttribute("data-bind",'valueUpdate: "input", value: '+e);a.appendChild(document.createTextNode(n));a.appendChild(o);var u=document.createElement("div");u.appendChild(s);a.appendChild(u);return a}function d(e,t,r,i,n,a,o){var s=document.createElement("div");s.className="cesium-cesiumInspector-slider";var u=document.createElement("input");u.setAttribute("data-bind","value: "+t);u.type="number";var l=document.createElement("input");l.type="range";l.min=r;l.max=i;l.step=(i-r)/n;l.setAttribute("data-bind","value: (Math.pow("+t+", 1 / "+a+"))");l.oninput=function(){e[t]=Math.pow(this.value,a)};s.appendChild(document.createTextNode(o));s.appendChild(u);var c=document.createElement("div");c.appendChild(l);s.appendChild(c);return s}function f(e,r,i){var n=document.createElement("input");n.type="button";n.value=r;n.className="cesium-cesiumInspector-pickButton";var a="click: "+e;if(t(i)){a+=', css: {"cesium-cesiumInspector-pickButtonHighlight" : '+i+"}"}n.setAttribute("data-bind",a);return n}return s});define("Widgets/CesiumInspector/CesiumInspectorViewModel",["../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../Core/Rectangle","../../Core/ScreenSpaceEventHandler","../../Core/ScreenSpaceEventType","../../Scene/DebugModelMatrixPrimitive","../../Scene/PerformanceDisplay","../../Scene/TileCoordinatesImageryProvider","../../ThirdParty/knockout","../createCommand"],function(e,t,r,i,n,a,o,s,u,l,c,d){"use strict";function f(t){var r;if(e(t)){r="Command Statistics";var i=t.commandsInFrustums;for(var n in i){if(i.hasOwnProperty(n)){var a=parseInt(n,10);var o;if(a===7){o="1, 2 and 3"}else{var s=[];for(var u=2;u>=0;u--){var l=Math.pow(2,u);if(a>=l){s.push(u+1);a-=l}}o=s.reverse().join(" and ")}r+="<br>&nbsp;&nbsp;&nbsp;&nbsp;"+i[n]+" in frustum "+o}}r+="<br>Total: "+t.totalCommands}return r}function h(e,t,r){var i=Math.min(r,t);i=Math.max(i,e);return i}function p(t,r){if(!e(t)){throw new i("scene is required")}if(!e(r)){throw new i("performanceContainer is required")}var f=this;var p=t.canvas;var m=new a(p);this._eventHandler=m;this._scene=t;this._canvas=p;this._primitive=undefined;this._tile=undefined;this._modelMatrixPrimitive=undefined;this._performanceDisplay=undefined;this._performanceContainer=r;var v=this._scene.globe;v.depthTestAgainstTerrain=true;this.frustums=false;this.frustumPlanes=false;this.performance=false;this.shaderCacheText="";this.primitiveBoundingSphere=false;this.primitiveReferenceFrame=false;this.filterPrimitive=false;this.tileBoundingSphere=false;this.filterTile=false;this.wireframe=false;this.globeDepth=false;this.pickDepth=false;this.depthFrustum=1;this._numberOfFrustums=1;this.suspendUpdates=false;this.tileCoordinates=false;this.frustumStatisticText=false;this.tileText="";this.hasPickedPrimitive=false;this.hasPickedTile=false;this.pickPrimitiveActive=false;this.pickTileActive=false;this.dropDownVisible=true;this.generalVisible=true;this.primitivesVisible=false;this.terrainVisible=false;this.depthFrustumText="";this.generalSwitchText=c.pureComputed(function(){return f.generalVisible?"-":"+"});this.primitivesSwitchText=c.pureComputed(function(){return f.primitivesVisible?"-":"+"});this.terrainSwitchText=c.pureComputed(function(){return f.terrainVisible?"-":"+"});c.track(this,["frustums","frustumPlanes","performance","shaderCacheText","primitiveBoundingSphere","primitiveReferenceFrame","filterPrimitive","tileBoundingSphere","filterTile","wireframe","globeDepth","pickDepth","depthFrustum","suspendUpdates","tileCoordinates","frustumStatisticText","tileText","hasPickedPrimitive","hasPickedTile","pickPrimitiveActive","pickTileActive","dropDownVisible","generalVisible","primitivesVisible","terrainVisible","depthFrustumText"]);this._toggleDropDown=d(function(){f.dropDownVisible=!f.dropDownVisible});this._toggleGeneral=d(function(){f.generalVisible=!f.generalVisible});this._togglePrimitives=d(function(){f.primitivesVisible=!f.primitivesVisible});this._toggleTerrain=d(function(){f.terrainVisible=!f.terrainVisible});this._frustumsSubscription=c.getObservable(this,"frustums").subscribe(function(e){f._scene.debugShowFrustums=e});this._frustumPlanesSubscription=c.getObservable(this,"frustumPlanes").subscribe(function(e){f._scene.debugShowFrustumPlanes=e});this._performanceSubscription=c.getObservable(this,"performance").subscribe(function(e){if(e){f._performanceDisplay=new u({container:f._performanceContainer})}else{f._performanceContainer.innerHTML=""}});this._showPrimitiveBoundingSphere=d(function(){f._primitive.debugShowBoundingVolume=f.primitiveBoundingSphere;return true});this._primitiveBoundingSphereSubscription=c.getObservable(this,"primitiveBoundingSphere").subscribe(function(){f._showPrimitiveBoundingSphere()});this._showPrimitiveReferenceFrame=d(function(){if(f.primitiveReferenceFrame){var t=f._primitive.modelMatrix;f._modelMatrixPrimitive=new s({modelMatrix:t});f._scene.primitives.add(f._modelMatrixPrimitive)}else if(e(f._modelMatrixPrimitive)){f._scene.primitives.remove(f._modelMatrixPrimitive);f._modelMatrixPrimitive=undefined}return true});this._primitiveReferenceFrameSubscription=c.getObservable(this,"primitiveReferenceFrame").subscribe(function(){f._showPrimitiveReferenceFrame()});this._doFilterPrimitive=d(function(){if(f.filterPrimitive){f._scene.debugCommandFilter=function(t){if(e(f._modelMatrixPrimitive)&&t.owner===f._modelMatrixPrimitive._primitive){return true}else if(e(f._primitive)){return t.owner===f._primitive||t.owner===f._primitive._billboardCollection||t.owner.primitive===f._primitive}return false}}else{f._scene.debugCommandFilter=undefined}return true});this._filterPrimitiveSubscription=c.getObservable(this,"filterPrimitive").subscribe(function(){f._doFilterPrimitive()});this._wireframeSubscription=c.getObservable(this,"wireframe").subscribe(function(e){v._surface.tileProvider._debug.wireframe=e});this._globeDepthSubscription=c.getObservable(this,"globeDepth").subscribe(function(e){f._scene.debugShowGlobeDepth=e});this._pickDepthSubscription=c.getObservable(this,"pickDepth").subscribe(function(e){f._scene.debugShowPickDepth=e});this._depthFrustumSubscription=c.getObservable(this,"depthFrustum").subscribe(function(e){f.scene.debugShowDepthFrustum=e});this._incrementDepthFrustum=d(function(){var e=f.depthFrustum+1;f.depthFrustum=h(1,f._numberOfFrustums,e);return true});this._decrementDepthFrustum=d(function(){var e=f.depthFrustum-1;f.depthFrustum=h(1,f._numberOfFrustums,e);return true});this._suspendUpdatesSubscription=c.getObservable(this,"suspendUpdates").subscribe(function(e){v._surface._debug.suspendLodUpdate=e;if(!e){f.filterTile=false}});var _;this._showTileCoordinates=d(function(){if(f.tileCoordinates&&!e(_)){_=t.imageryLayers.addImageryProvider(new l({tilingScheme:t.terrainProvider.tilingScheme}))}else if(!f.tileCoordinates&&e(_)){t.imageryLayers.remove(_);_=undefined}return true});this._tileCoordinatesSubscription=c.getObservable(this,"tileCoordinates").subscribe(function(){f._showTileCoordinates()});this._tileBoundingSphereSubscription=c.getObservable(this,"tileBoundingSphere").subscribe(function(){f._showTileBoundingSphere()});this._showTileBoundingSphere=d(function(){if(f.tileBoundingSphere){v._surface.tileProvider._debug.boundingSphereTile=f._tile}else{v._surface.tileProvider._debug.boundingSphereTile=undefined}return true});this._doFilterTile=d(function(){if(!f.filterTile){f.suspendUpdates=false}else{f.suspendUpdates=true;v._surface._tilesToRender=[];if(e(f._tile)&&f._tile.renderable){v._surface._tilesToRender.push(f._tile)}}return true});this._filterTileSubscription=c.getObservable(this,"filterTile").subscribe(function(){f.doFilterTile()});function g(t){var r=f._scene.pick({x:t.position.x,y:t.position.y});if(e(r)){f.primitive=e(r.collection)?r.collection:r.primitive}f.pickPrimitiveActive=false}this._pickPrimitive=d(function(){f.pickPrimitiveActive=!f.pickPrimitiveActive});this._pickPrimitiveActiveSubscription=c.getObservable(this,"pickPrimitiveActive").subscribe(function(e){if(e){m.setInputAction(g,o.LEFT_CLICK)}else{m.removeInputAction(o.LEFT_CLICK)}});function y(t){var r;var i=v.ellipsoid;var a=f._scene.camera.pickEllipsoid({x:t.position.x,y:t.position.y},i);if(e(a)){var o=i.cartesianToCartographic(a);var s=v._surface.tileProvider._tilesToRenderByTextureCount;for(var u=0;!r&&u<s.length;++u){var l=s[u];if(!e(l)){continue}for(var c=0;!r&&c<l.length;++c){var d=l[c];if(n.contains(d.rectangle,o)){r=d}}}}f.tile=r;f.pickTileActive=false}this._pickTile=d(function(){f.pickTileActive=!f.pickTileActive});this._pickTileActiveSubscription=c.getObservable(this,"pickTileActive").subscribe(function(e){if(e){m.setInputAction(y,o.LEFT_CLICK)}else{m.removeInputAction(o.LEFT_CLICK)}})}t(p.prototype,{scene:{get:function(){return this._scene}},performanceContainer:{get:function(){return this._performanceContainer}},toggleDropDown:{get:function(){return this._toggleDropDown}},showPrimitiveBoundingSphere:{get:function(){return this._showPrimitiveBoundingSphere}},showPrimitiveReferenceFrame:{get:function(){return this._showPrimitiveReferenceFrame}},doFilterPrimitive:{get:function(){return this._doFilterPrimitive}},incrementDepthFrustum:{get:function(){return this._incrementDepthFrustum}},decrementDepthFrustum:{get:function(){return this._decrementDepthFrustum}},showTileCoordinates:{get:function(){return this._showTileCoordinates}},showTileBoundingSphere:{get:function(){return this._showTileBoundingSphere}},doFilterTile:{get:function(){return this._doFilterTile}},toggleGeneral:{get:function(){return this._toggleGeneral}},togglePrimitives:{get:function(){return this._togglePrimitives}},toggleTerrain:{get:function(){return this._toggleTerrain}},pickPrimitive:{get:function(){return this._pickPrimitive}},pickTile:{get:function(){return this._pickTile}},selectParent:{get:function(){var e=this;return d(function(){e.tile=e.tile.parent})}},selectNW:{get:function(){var e=this;return d(function(){e.tile=e.tile.northwestChild})}},selectNE:{get:function(){var e=this;return d(function(){e.tile=e.tile.northeastChild})}},selectSW:{get:function(){var e=this
;return d(function(){e.tile=e.tile.southwestChild})}},selectSE:{get:function(){var e=this;return d(function(){e.tile=e.tile.southeastChild})}},primitive:{set:function(t){var r=this._primitive;if(t!==r){this.hasPickedPrimitive=true;if(e(r)){r.debugShowBoundingVolume=false}this._scene.debugCommandFilter=undefined;if(e(this._modelMatrixPrimitive)){this._scene.primitives.remove(this._modelMatrixPrimitive);this._modelMatrixPrimitive=undefined}this._primitive=t;t.show=false;setTimeout(function(){t.show=true},50);this.showPrimitiveBoundingSphere();this.showPrimitiveReferenceFrame();this.doFilterPrimitive()}},get:function(){return this._primitive}},tile:{set:function(t){if(e(t)){this.hasPickedTile=true;var r=this._tile;if(t!==r){this.tileText="L: "+t.level+" X: "+t.x+" Y: "+t.y;this.tileText+="<br>SW corner: "+t.rectangle.west+", "+t.rectangle.south;this.tileText+="<br>NE corner: "+t.rectangle.east+", "+t.rectangle.north;var i=t.data;if(e(i)){this.tileText+="<br>Min: "+i.minimumHeight+" Max: "+i.maximumHeight}else{this.tileText+="<br>(Tile is not loaded)"}}this._tile=t;this.showTileBoundingSphere();this.doFilterTile()}else{this.hasPickedTile=false;this._tile=undefined}},get:function(){return this._tile}},update:{get:function(){var e=this;return function(){if(e.frustums){e.frustumStatisticText=f(e._scene.debugFrustumStatistics)}var t=e._scene.numberOfFrustums;e._numberOfFrustums=t;e.depthFrustum=h(1,t,e.depthFrustum);e.depthFrustumText=e.depthFrustum+" of "+t;if(e.performance){e._performanceDisplay.update()}if(e.primitiveReferenceFrame){e._modelMatrixPrimitive.modelMatrix=e._primitive.modelMatrix}e.shaderCacheText="Cached shaders: "+e._scene.context.shaderCache.numberOfShaders}}}});p.prototype.isDestroyed=function(){return false};p.prototype.destroy=function(){this._eventHandler.destroy();this._frustumsSubscription.dispose();this._frustumPlanesSubscription.dispose();this._performanceSubscription.dispose();this._primitiveBoundingSphereSubscription.dispose();this._primitiveReferenceFrameSubscription.dispose();this._filterPrimitiveSubscription.dispose();this._wireframeSubscription.dispose();this._globeDepthSubscription.dispose();this._pickDepthSubscription.dispose();this._depthFrustumSubscription.dispose();this._suspendUpdatesSubscription.dispose();this._tileCoordinatesSubscription.dispose();this._tileBoundingSphereSubscription.dispose();this._filterTileSubscription.dispose();this._pickPrimitiveActiveSubscription.dispose();this._pickTileActiveSubscription.dispose();return r(this)};return p});define("Widgets/CesiumInspector/CesiumInspector",["../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../ThirdParty/knockout","../getElement","./CesiumInspectorViewModel"],function(e,t,r,i,n,a,o){"use strict";function s(t,r){if(!e(t)){throw new i("container is required.")}if(!e(r)){throw new i("scene is required.")}t=a(t);var s=document.createElement("div");var u=new o(r,s);this._viewModel=u;this._container=t;var l=document.createElement("div");this._element=l;var c=document.createElement("div");c.textContent="Cesium Inspector";c.className="cesium-cesiumInspector-button";c.setAttribute("data-bind","click: toggleDropDown");l.appendChild(c);l.className="cesium-cesiumInspector";l.setAttribute("data-bind",'css: { "cesium-cesiumInspector-visible" : dropDownVisible, "cesium-cesiumInspector-hidden" : !dropDownVisible }');t.appendChild(this._element);var d=document.createElement("div");this._panel=d;d.className="cesium-cesiumInspector-dropDown";l.appendChild(d);var f=document.createElement("div");f.className="cesium-cesiumInspector-sectionHeader";var h=document.createElement("span");h.className="cesium-cesiumInspector-toggleSwitch";h.setAttribute("data-bind","click: toggleGeneral, text: generalSwitchText");f.appendChild(h);f.appendChild(document.createTextNode("General"));d.appendChild(f);var p=document.createElement("div");p.className="cesium-cesiumInspector-section";p.setAttribute("data-bind",'css: {"cesium-cesiumInspector-show" : generalVisible, "cesium-cesiumInspector-hide" : !generalVisible}');d.appendChild(p);var m=document.createElement("div");p.appendChild(m);var v=document.createElement("div");v.className="cesium-cesiumInspector-frustumStats";v.setAttribute("data-bind",'css: {"cesium-cesiumInspector-show" : frustums, "cesium-cesiumInspector-hide" :  !frustums}, html: frustumStatisticText');var _=document.createElement("input");_.type="checkbox";_.setAttribute("data-bind","checked: frustums");m.appendChild(_);m.appendChild(document.createTextNode("Show Frustums"));m.appendChild(v);var g=document.createElement("div");p.appendChild(g);var y=document.createElement("input");y.type="checkbox";y.setAttribute("data-bind","checked: frustumPlanes");g.appendChild(y);g.appendChild(document.createTextNode("Show Frustum Planes"));var w=document.createElement("div");p.appendChild(w);var C=document.createElement("input");C.type="checkbox";C.setAttribute("data-bind","checked: performance");w.appendChild(C);w.appendChild(document.createTextNode("Performance Display"));s.className="cesium-cesiumInspector-performanceDisplay";p.appendChild(s);var b=document.createElement("div");b.className="cesium-cesiumInspector-shaderCache";b.setAttribute("data-bind","html: shaderCacheText");p.appendChild(b);var S=document.createElement("div");p.appendChild(S);var E=document.createElement("input");E.type="checkbox";E.setAttribute("data-bind","checked: globeDepth");S.appendChild(E);S.appendChild(document.createTextNode("Show globe depth"));var T=document.createElement("div");S.appendChild(T);var x=document.createElement("div");p.appendChild(x);var A=document.createElement("input");A.type="checkbox";A.setAttribute("data-bind","checked: pickDepth");x.appendChild(A);x.appendChild(document.createTextNode("Show pick depth"));var P=document.createElement("div");p.appendChild(P);var D=document.createElement("span");D.setAttribute("data-bind",'html: "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Frustum:"');P.appendChild(D);var M=document.createElement("span");M.setAttribute("data-bind","text: depthFrustumText");P.appendChild(M);var I=document.createElement("input");I.type="button";I.value="-";I.className="cesium-cesiumInspector-pickButton";I.setAttribute("data-bind","click: decrementDepthFrustum");P.appendChild(I);var O=document.createElement("input");O.type="button";O.value="+";O.className="cesium-cesiumInspector-pickButton";O.setAttribute("data-bind","click: incrementDepthFrustum");P.appendChild(O);var R=document.createElement("div");R.className="cesium-cesiumInspector-sectionHeader";h=document.createElement("span");h.className="cesium-cesiumInspector-toggleSwitch";h.setAttribute("data-bind","click: togglePrimitives, text: primitivesSwitchText");R.appendChild(h);R.appendChild(document.createTextNode("Primitives"));d.appendChild(R);var N=document.createElement("div");N.className="cesium-cesiumInspector-section";N.setAttribute("data-bind",'css: {"cesium-cesiumInspector-show" : primitivesVisible, "cesium-cesiumInspector-hide" : !primitivesVisible}');d.appendChild(N);var L=document.createElement("div");L.className="cesium-cesiumInspector-pickSection";N.appendChild(L);var B=document.createElement("input");B.type="button";B.value="Pick a primitive";B.className="cesium-cesiumInspector-pickButton";B.setAttribute("data-bind",'css: {"cesium-cesiumInspector-pickButtonHighlight" : pickPrimitiveActive}, click: pickPrimitive');var F=document.createElement("div");F.className="cesium-cesiumInspector-center";F.appendChild(B);L.appendChild(F);var k=document.createElement("div");L.appendChild(k);var V=document.createElement("input");V.type="checkbox";V.setAttribute("data-bind","checked: primitiveBoundingSphere, enable: hasPickedPrimitive");k.appendChild(V);k.appendChild(document.createTextNode("Show bounding sphere"));var z=document.createElement("div");L.appendChild(z);var U=document.createElement("input");U.type="checkbox";U.setAttribute("data-bind","checked: primitiveReferenceFrame, enable: hasPickedPrimitive");z.appendChild(U);z.appendChild(document.createTextNode("Show reference frame"));var q=document.createElement("div");this._primitiveOnly=q;L.appendChild(q);var G=document.createElement("input");G.type="checkbox";G.setAttribute("data-bind","checked: filterPrimitive, enable: hasPickedPrimitive");q.appendChild(G);q.appendChild(document.createTextNode("Show only selected"));var H=document.createElement("div");H.className="cesium-cesiumInspector-sectionHeader";h=document.createElement("span");h.className="cesium-cesiumInspector-toggleSwitch";h.setAttribute("data-bind","click: toggleTerrain, text: terrainSwitchText");H.appendChild(h);H.appendChild(document.createTextNode("Terrain"));d.appendChild(H);var W=document.createElement("div");W.className="cesium-cesiumInspector-section";W.setAttribute("data-bind",'css: {"cesium-cesiumInspector-show" : terrainVisible, "cesium-cesiumInspector-hide" :  !terrainVisible}');d.appendChild(W);var j=document.createElement("div");j.className="cesium-cesiumInspector-pickSection";W.appendChild(j);var Y=document.createElement("input");Y.type="button";Y.value="Pick a tile";Y.className="cesium-cesiumInspector-pickButton";Y.setAttribute("data-bind",'css: {"cesium-cesiumInspector-pickButtonHighlight" : pickTileActive}, click: pickTile');F=document.createElement("div");F.appendChild(Y);F.className="cesium-cesiumInspector-center";j.appendChild(F);var X=document.createElement("div");j.appendChild(X);var Z=document.createElement("input");Z.type="button";Z.value="Parent";Z.className="cesium-cesiumInspector-pickButton";Z.setAttribute("data-bind","click: selectParent");var K=document.createElement("input");K.type="button";K.value="NW";K.className="cesium-cesiumInspector-pickButton";K.setAttribute("data-bind","click: selectNW");var Q=document.createElement("input");Q.type="button";Q.value="NE";Q.className="cesium-cesiumInspector-pickButton";Q.setAttribute("data-bind","click: selectNE");var J=document.createElement("input");J.type="button";J.value="SW";J.className="cesium-cesiumInspector-pickButton";J.setAttribute("data-bind","click: selectSW");var $=document.createElement("input");$.type="button";$.value="SE";$.className="cesium-cesiumInspector-pickButton";$.setAttribute("data-bind","click: selectSE");var ee=document.createElement("div");ee.className="cesium-cesiumInspector-tileText";X.className="cesium-cesiumInspector-frustumStats";X.appendChild(ee);X.setAttribute("data-bind",'css: {"cesium-cesiumInspector-show" : hasPickedTile, "cesium-cesiumInspector-hide" :  !hasPickedTile}');ee.setAttribute("data-bind","html: tileText");var te=document.createElement("div");te.className="cesium-cesiumInspector-relativeText";te.textContent="Select relative:";X.appendChild(te);var re=document.createElement("table");var ie=document.createElement("tr");var ne=document.createElement("tr");var ae=document.createElement("td");ae.appendChild(Z);var oe=document.createElement("td");oe.appendChild(K);var se=document.createElement("td");se.appendChild(Q);ie.appendChild(ae);ie.appendChild(oe);ie.appendChild(se);var ue=document.createElement("td");var le=document.createElement("td");le.appendChild(J);var ce=document.createElement("td");ce.appendChild($);ne.appendChild(ue);ne.appendChild(le);ne.appendChild(ce);re.appendChild(ie);re.appendChild(ne);X.appendChild(re);var de=document.createElement("div");j.appendChild(de);var fe=document.createElement("input");fe.type="checkbox";fe.setAttribute("data-bind","checked: tileBoundingSphere, enable: hasPickedTile");de.appendChild(fe);de.appendChild(document.createTextNode("Show bounding volume"));var he=document.createElement("div");j.appendChild(he);var pe=document.createElement("input");pe.type="checkbox";pe.setAttribute("data-bind","checked: filterTile, enable: hasPickedTile");he.appendChild(pe);he.appendChild(document.createTextNode("Show only selected"));var me=document.createElement("div");W.appendChild(me);var ve=document.createElement("input");ve.type="checkbox";ve.setAttribute("data-bind","checked: wireframe");me.appendChild(ve);me.appendChild(document.createTextNode("Wireframe"));var _e=document.createElement("div");W.appendChild(_e);var ge=document.createElement("input");ge.type="checkbox";ge.setAttribute("data-bind","checked: suspendUpdates");_e.appendChild(ge);_e.appendChild(document.createTextNode("Suspend LOD update"));var ye=document.createElement("div");W.appendChild(ye);var we=document.createElement("input");we.type="checkbox";we.setAttribute("data-bind","checked: tileCoordinates");ye.appendChild(we);ye.appendChild(document.createTextNode("Show tile coordinates"));n.applyBindings(u,this._element)}t(s.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}});s.prototype.isDestroyed=function(){return false};s.prototype.destroy=function(){n.cleanNode(this._element);this._container.removeChild(this._element);this.viewModel.destroy();return r(this)};return s});define("Widgets/CesiumWidget/CesiumWidget",["../../Core/buildModuleUrl","../../Core/Cartesian3","../../Core/Clock","../../Core/Credit","../../Core/defaultValue","../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../Core/Ellipsoid","../../Core/FeatureDetection","../../Core/formatError","../../Core/requestAnimationFrame","../../Core/ScreenSpaceEventHandler","../../Scene/BingMapsImageryProvider","../../Scene/Globe","../../Scene/Moon","../../Scene/Scene","../../Scene/SceneMode","../../Scene/ShadowMode","../../Scene/SkyAtmosphere","../../Scene/SkyBox","../../Scene/Sun","../getElement"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w,C,b,S){"use strict";function E(t){return e("Assets/Textures/SkyBox/tycho2t3_80_"+t+".jpg")}function T(e){e._renderLoopRunning=true;var t=0;function r(i){if(e.isDestroyed()){return}if(e._useDefaultRenderLoop){try{var n=e._targetFrameRate;if(!a(n)){e.resize();e.render();f(r)}else{var o=1e3/n;var s=i-t;if(s>o){e.resize();e.render();t=i-s%o}f(r)}}catch(t){e._useDefaultRenderLoop=false;e._renderLoopRunning=false;if(e._showRenderLoopErrors){var u="An error occurred while rendering.  Rendering has stopped.";e.showErrorPanel(u,undefined,t)}}}else{e._renderLoopRunning=false}}f(r)}function x(e){var t=e._canvas;var r=t.clientWidth;var i=t.clientHeight;var a=e._resolutionScale;if(!e._supportsImageRenderingPixelated){a*=n(window.devicePixelRatio,1)}e._canvasWidth=r;e._canvasHeight=i;r*=a;i*=a;t.width=r;t.height=i;e._canRender=r!==0&&i!==0}function A(e){var t=e._canvas;var r=t.width;var i=t.height;if(r!==0&&i!==0){var n=e._scene.camera.frustum;if(a(n.aspectRatio)){n.aspectRatio=r/i}else{n.top=n.right*(i/r);n.bottom=-n.top}}}var P="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHYAAAAeCAYAAAD5AOomAAAQWUlEQVR42u1beXxOxxpudrEktkbUkriI4lZpq5JbW6pJuFG0qrFeexVRak3TBm3RUgS1hFhrCdKgQWKLrUGQBiVBJMgiq0Qiuyxzn/fzTu74ZPnS9nfrj4zf8/ty5sw7M+c8824zx0svVa3oAfqAAWAIGAHGCoy43oDb6TGqywta9JgsIq4GUAswB+oDDRXU5/ragCm3N6gm+MUkVJ+1kAg1AyyA5oAN8BrQCXiTfzsArwLWgCVQF6jJBOtXk/tikWrMGkiEtgTeAOyBfsAQS0vL8YMHD/aws7ObiuthwAeAA/A20AZozAvCRNHe6vI3k2rCprUp8DoR1qVLF1c/P7+A5OTkhyUlJaKwuETkPSkRBUUlgkpmZmbW2bNnQyZOnLgA7Z2BzkALNtM1qsl9MTSVSLUCugADAwMDTxKZVI7cfCw8DiWK6fselMLtlwSxJyxDPM4vFsXFxSWRkZFRkBsOdAdaAw2qyf37ij77RDMm1a5evXojY2NjH5BW7ruaIab4xotPd8cJV/xO0cKkPXGae97n0kR6TpHIzs7O7d279xdsvoncemwJqn3u/1lbDTnqfYXN6JCUlJS03CfFwt0/4TkiK8IEEBydWiBIy21tbaejr24cWJlpBVT6ShpVFvS10iddZP6MbFkyqpw2Kor6K5P9M33onG1Iv0omsz3Q//79+7HpuUViDsys697KyZy89ynk9Wc/x4u7DwvE48ePs2mRcARtqUTLRjxmDa6rpYWanDqZKHmyzJ+lTFlyUrZGGbIm3GdF49VQcnMjZUwTJW83Ua4NtayQmlEYKW1NlOc11RrLoAxLpqdYUSmnPlOlbk1qa21OZ7ovX758E/lTz1MpOmvp5gvp4qeL6c8sAjLNOQXF4sKFC6Hotw+nSrR46rAfb8hkN+WxVTTlyPplNuNmDArGGgFNgGZloClbHQtua8bj1eW+GnObZspY2nL1WKaOkreraKDk7jXLsEJGXG+u1b4Bz/0VZayyUkO5f2DCc5DvyZL/1inb0ONVU5+1dSBMcHrIvRwNMbqQ6u6fKGSZ4POszFaQDZNc0q9fvzkcjFkzKf/gfJjSo3c40OrBoL+7cvvXeUFYM17l1MuOTbxEV8a/uE8pZ8Ww4bouPJ62bFlyzXmebRg2jLY8jxa8WGopxEiX9jLff1Vp357zfluefyeOPxpp9WHAGl2fn/k1do+Ef/K86lYWs+hzJ7SSbXv06OFGAfAMRLtlBUjkPyfuidMyw3Fi37UM8TMCLFVj6W9qW1BYIg4ePBjEWkukdCTyZsyYMcvX13f7iRMnDv36669B0OxTBKRNx4OCggIPHDiwa+XKld+j7Xv84v/l4+Oz6PLlywHnzp07Su0gdyw4OPgYXQNHzp8/f+TixYuHw8LCDuDeGiaLXqLj6tWrlyLC9ztz5gy1PwEcV3AU89i3detWT2NjYyeWedvLy2va77//7hcREeHfsWPH91HX6/r16/7h4eH+6H+ZVtQvN3ToujXm9wPJYS6+FhYWzggmh4eGhh6hsTHnE/j7eN++fQczWY1Yc6WrIVJb0SLEu9iJ93I0JCTkKMY+PHLkSGe2MLV5TL3ytgxr88pwuHLlyvXY9CcaH6mSR5HwwRuPRWZekTgXnfPcfW0QqfMDk0Qc+nqCnDc+Pj6FNzJoE+PfeDEXhQ6FtD0rKyu9Tp06LpAbBN9/S+hYEJmnck79EazQA5myVTKeyM/Pp7jgI2AAXv4JeW/AgAGzUTdKXj969CiOF04T1jhj/qXrzrgfQ+0KUdq1azdt6tSpntrjxcTEUGroyBrdkLmoy3x0HT9+vIe2zIoVK9y5fT0eU688/2rOJqY/bTRcjsl5hqRPYF5P38nSdJrwMErzezMpX1NfHrELjiQ9fbl56SIjO5leViH6nwwMnjZt2gL5EmWh/Lf4f+U5BtauXbsJshPu3LkTLQl/+PBhVmpqagZ+HxHS0tLSCShpGRkZqXhp12i8RYsWrVP7wr1ctM9E2wy0lch88uRJoWwTFRV1A7JjoVnBss7BwWEJ6ubIa/SRgOt32VybKduvZILtMbd4JraoZcuWC8eMGbNN+7noWTt06DCVXUIL9rtNOdj8uABFW+bbb7/9js34y4o5fo5YI14h7QwNDV1yc3MLAsIfP0PS9kvpmg6Db+wXn6/pKrwOztBcn7mTXWbEPHlPvMguKBFFxYXiq819hZu3k6Y9xpgFjN+xY8cBOcmkpKQ0rh8HDCUieHNjHExgmGwHQomkKbdu3bpP10VFRcU2NjZ7UbcKWATMB74C3IBpSn8jTp48eVb2k5iYSNq4BVjJcl8zFrq5ue3Py8vLB/Kg4USa6+nTp0OkLNwUmfYFckGiTRJZH1YKc3Zp5mye+yQnJydQOyyYImtr65XDhw/3lX2B7BJlgaSxhXiL+6K99z4wwadkG/RRLP/28PBYxpaiES+mcokllW4PczcUz1Twy++ZpSTRrhJtUCSnx4gvNzkL9419xBfevUVIxEHNIEuDUp4j90ZCHjSqUHj+/AnaOmnkmFgyIa6Y8Hk5SScnp6VMwLs82Tc5wOkJv9Tfz89v3f79+73xMPTyJyrEloCI8+PGjTs0adIkX1dXVx+Yuu2ff/75tlmzZm1A+xUDBw6kHHo4/GqQHA8Lt9DT0/OSu7v70SlTpuwdMmTIFhC2tlmzZivQ9geAtOFLgLRoGhbFJSnbrVu3DahbrEXs+4pZrMm/FGj1xaJNlMRaWVmtGTZs2D7ZV3R0dA6sWJG8Riayhd1GNzbNo0nTpWWbP3/+dYXY5fyOLCsjti5Hbh/hwfODbmeVkkS5rCgpFgt2DNaQKjHTy16kZsRpBpp1IKE0uNoSkqapO3llp2YBUFuPLf01Jgf9007UFAQCv8lJmpubf4Y6J478rNgMWfHL6cRBE+1e9SXTKInVpdy7d+8KmbOhQ4d+rasMLRjML5xMLlkSBFShCrEbiXxJLDQymQ8/2rN/lKkJXQ+AdUiSxDZv3nydSuzNmzczQWaEvIZbeESuhhf5mLt375Y+Z0BAQDQW7Dl5PXfu3KW6EGvIfoEisL6Ya+p1aBz5z/N3czQdbQ5w12ieSizhu13DEPHmajYiKDXyPJmiaX8t6pSYs8FB04bM8ObAL2ijIg/9zyCtU4lFBDqJA6p2nE/KPLMVmyRbToGcq0osAq0rrFEu8Eve5IfJhOsiCxN8FXJzjx07FqYQ6426JZJYaGQKu463eO4W/EvXLiqx0Ni1MMV+ig9PR5ut0PosWbd582bKHL50cXHZIOMMGqtJkybrQWZpEDdv3rwfdCHWgCM5yo3s/f39j9G8H2Y/tRKXbgUItw2Oz5EqSfMJWvT0dCefA5PsVPHNTx+VtpkFzb4Ve0ncuHHjLq/I0UhJSv1W27Zt57F/6cpp0Gv8awfz6Lxq1ar5P/7448KxY8eSH/5UNcUffPBBQKdOnTZ37tx5la2t7VI7O7vv33nnnYUwrR6Ojo7TEIm6sFkjckfxwvIAaMyvTE1NPRC4LEFQtAH9+yOVSFYiXvLFC48ePXpF1nXv3n09mWqF2Ie4/oTHeIM19Q2+/iQhISFVIXb1iBEj9irWhCL2pXPmzPlF9aOoW4+gL13W7d69+ywtMASApe1glhez2yqXWJnH1uDVRv5tpMY0PE4Qu4IWlkmoNlb6TRKRcaHiQoS/+Ir9sMTCnYM1q27NmjW+tIqJxMOHDwfISe7bty8YdZ8pZ7r9aZOEruE7F2lFqZ+pwRNI8WG/SGTNZuKm8gIawlrusGDBgi+wsEJ+Q8Fq38W+fg7LkHv4hoKwUaNGlWoFLEwuEatqrL29PQVq86TW5+Tk5LP8aDK9PN4AvnaXPhKBbSEW6bLRo0fvkH3FxsYmcaA3m6JzWR8ZGVlKKmUoHAhORFywSysqfqui4Enbz1JE5nz16tXwrNx0nUh9Gkw5QTPfFbPX93pWo6Hpp6740EqkVOc/lNzTZgM0cKVq9qAdmSlPS5IEHjaN8h7Z5iAKpUt48LsyTYCGPcBc7+L3DvLi2xEREYSbt2/fDkdwci0sLOwwRZfbt29frmhFIdpEgehIkqFfRN9RQAzmkSvbQdvIzLqdOnWqNN+GFaAoeircVYr68rHoohG138KYN+mXji1Rny1NKeKWXDMzM/cJEyZskHIPUMiX0ntp06aNm5riSYsA0+zLpn6Ql5fXRnl/8eLFX7NVsygv3VHNcU3ev+xC23800NlrvqUBUFVBckv3jNZMBNHnSvajr/OEHLDaM3X1lSCjoFGjRmRKhyGoiKziBgWZRWf0kSeqUGbOnOlJmod44Iys+/DDD8kiuMAULlMXXWUFUfkhIhB9LpZ1WBwxHBDSexmIBXFTlcHCeMQuqidh586dK+S91atXu3EkXp83KPQrOt0xZq2loMVh2bJlmmT6+OVt0MT3qkiqk1jsM0LkFWQL0iI2rx2UjXfyo73gPzZCu64iyIhHYJMMJU2RoJ0ikBiOiNBn0KBBY/gB7UNDQ3/B/QTcT1SRmpqaQEA/D3A/HtoXGxcXd07uy3bt2nUQSPKHJkbLthIsnwifGY/5/oZ0gnxwb5ojTPG6jIyMGCySBCz4gTJKnz59+szg4OBAjBEFkuIg+wxQojHXszD983hx9Zw8efI4EBZHgFYHsjnV7JdjfkMw50R+hnikauM4QKJspb23t/dkuAeaR9ySJUuG8Lusw9ZWr7KvEU15N4P2Lt9HZKjZdTkeuk3MRcpSVmT8DKEbe2vaePlPFyX4B8IoHfiYH6AJJ+/m7PRtuL47r9revJfch/92YDK78Hxas0xHDrTeU2R6c8rkWIZcK/5mqx1vondnWUeWUdGL++7EL9SG5Tooc2ihFbH3VPpzVOZgz4ugI6durVjLpNV6lRd5Y/5tx3Puxv3Kzf5G3KaFcpjQvCqfHKmH7Y15An3hqDeRWaZo1+fkIjFjXQ9NKiNNNJFJvpR87JLdI8X95HCNj6CjOtrJ4uituXLUZKwk8pbKCUpr5fSkNZNhxe6hIbeXR3bNFBlttOKX0Izb1mfZhtyXFcu20kFOfmZrwQteHtXJI8AmvKfbUulPLiRrTtvk8WFdPhyw4P4b8DupxZrXgOfXTHnmOvyu5P6x/NxX7nIZVuXA3Yg7asyrxoG+RER4HoMorzj/SY64ijw18OIm4Xd2uTh4fq04f+OASEy7pyGUvrqYPXv2CvYfb/JEzbUOlA342lR5MDNFo+UZam1+MBPlgNuU69X25mXI1lIO6qVsTUXWrAK5GloH49qH3Ophf21l/mZlzL2G1gG9aTkfEJgoHwDU1LpvqIxZ0eG8TuTKM8VWbCKcoYGj1q1btwehegJtPVIuSVEmnd8iQDhtbW3tamxs/CGbs7a8OOooDr68z1QMlQdUH0b7kxX1sxbDSmBQzqcoBpXIGJQjo/1ZSmVzqaivyvozqOB96f+Z78b0lLPFumwabFgDe3K+NpDz0kH8rXEvNrttWUvr6/DRuJ6O+CMyf0a2Ku+pqn390Xt/6QduBopPNFe2zFrJaI2dfmv2XZbsz2op5qL6v3m8oF8vqv9/R/oB+Q1RPf41U3yT0R+x/9Xlryn/BY268qsf3smdAAAAAElFTkSuQmCC";function D(e,o){if(!a(e)){throw new u("container is required.")}e=S(e);o=n(o,{});var s=document.createElement("div");s.className="cesium-widget";e.appendChild(s);var d=document.createElement("canvas");var f=c.supportsImageRenderingPixelated();this._supportsImageRenderingPixelated=f;if(f){d.style.imageRendering=c.imageRenderingValue()}d.oncontextmenu=function(){return false};d.onselectstart=function(){return false};s.appendChild(d);var T=document.createElement("div");T.className="cesium-widget-credits";var D=a(o.creditContainer)?S(o.creditContainer):s;D.appendChild(T);var M=n(o.showRenderLoopErrors,true);this._element=s;this._container=e;this._canvas=d;this._canvasWidth=0;this._canvasHeight=0;this._creditContainer=T;this._canRender=false;this._renderLoopRunning=false;this._showRenderLoopErrors=M;this._resolutionScale=1;this._forceResize=false;this._clock=a(o.clock)?o.clock:new r;x(this);try{var I=new _({canvas:d,contextOptions:o.contextOptions,creditContainer:T,mapProjection:o.mapProjection,orderIndependentTranslucency:o.orderIndependentTranslucency,scene3DOnly:n(o.scene3DOnly,false),terrainExaggeration:o.terrainExaggeration,shadows:o.shadows,mapMode2D:o.mapMode2D});this._scene=I;I.camera.constrainedAxis=t.UNIT_Z;A(this);var O=n(I.mapProjection.ellipsoid,l.WGS84);var R=I.frameState.creditDisplay;var N=new i("Cesium",P,"http://cesiumjs.org/");R.addDefaultCredit(N);var L=o.globe;if(!a(L)){L=new m(O)}if(L!==false){I.globe=L;I.globe.shadows=n(o.terrainShadows,y.RECEIVE_ONLY)}var B=o.skyBox;if(!a(B)){B=new C({sources:{positiveX:E("px"),negativeX:E("mx"),positiveY:E("py"),negativeY:E("my"),positiveZ:E("pz"),negativeZ:E("mz")}})}if(B!==false){I.skyBox=B;I.sun=new b;I.moon=new v}var F=o.skyAtmosphere;if(!a(F)){F=new w(O)}if(F!==false){I.skyAtmosphere=F}var k=o.globe===false?false:o.imageryProvider;if(!a(k)){k=new p({url:"https://dev.virtualearth.net"})}if(k!==false){I.imageryLayers.addImageryProvider(k)}if(a(o.terrainProvider)&&o.globe!==false){I.terrainProvider=o.terrainProvider}this._screenSpaceEventHandler=new h(d,false);if(a(o.sceneMode)){if(o.sceneMode===g.SCENE2D){this._scene.morphTo2D(0)}if(o.sceneMode===g.COLUMBUS_VIEW){this._scene.morphToColumbusView(0)}}this._useDefaultRenderLoop=undefined;this.useDefaultRenderLoop=n(o.useDefaultRenderLoop,true);this._targetFrameRate=undefined;this.targetFrameRate=o.targetFrameRate;var V=this;I.renderError.addEventListener(function(e,t){V._useDefaultRenderLoop=false;V._renderLoopRunning=false;if(V._showRenderLoopErrors){var r="An error occurred while rendering.  Rendering has stopped.";V.showErrorPanel(r,undefined,t)}})}catch(e){if(M){var z="Error constructing CesiumWidget.";var U='Visit <a href="http://get.webgl.org">http://get.webgl.org</a> to verify that your web browser and hardware support WebGL.  Consider trying a different web browser or updating your video drivers.  Detailed error information is below:';this.showErrorPanel(z,U,e)}throw e}}o(D.prototype,{container:{get:function(){return this._container}},canvas:{get:function(){return this._canvas}},creditContainer:{get:function(){return this._creditContainer}},scene:{get:function(){return this._scene}},imageryLayers:{get:function(){return this._scene.imageryLayers}},terrainProvider:{get:function(){return this._scene.terrainProvider},set:function(e){this._scene.terrainProvider=e}},camera:{get:function(){return this._scene.camera}},clock:{get:function(){return this._clock}},screenSpaceEventHandler:{get:function(){return this._screenSpaceEventHandler}},targetFrameRate:{get:function(){return this._targetFrameRate},set:function(e){if(e<=0){throw new u("targetFrameRate must be greater than 0, or undefined.")}this._targetFrameRate=e}},useDefaultRenderLoop:{get:function(){return this._useDefaultRenderLoop},set:function(e){if(this._useDefaultRenderLoop!==e){this._useDefaultRenderLoop=e;if(e&&!this._renderLoopRunning){T(this)}}}},resolutionScale:{get:function(){return this._resolutionScale},set:function(e){if(e<=0){throw new u("resolutionScale must be greater than 0.")}this._resolutionScale=e;this._forceResize=true}}});D.prototype.showErrorPanel=function(e,t,r){var i=this._element;var n=document.createElement("div");n.className="cesium-widget-errorPanel";var o=document.createElement("div");o.className="cesium-widget-errorPanel-content";n.appendChild(o);var s=document.createElement("div");s.className="cesium-widget-errorPanel-header";s.appendChild(document.createTextNode(e));o.appendChild(s);var u=document.createElement("div");u.className="cesium-widget-errorPanel-scroll";o.appendChild(u);function l(){u.style.maxHeight=Math.max(Math.round(i.clientHeight*.9-100),30)+"px"}l();if(a(window.addEventListener)){window.addEventListener("resize",l,false)}if(a(t)){var c=document.createElement("div");c.className="cesium-widget-errorPanel-message";c.innerHTML="<p>"+t+"</p>";u.appendChild(c)}var f="(no error details available)";if(a(r)){f=d(r)}var h=document.createElement("div");h.className="cesium-widget-errorPanel-message";h.appendChild(document.createTextNode(f));u.appendChild(h);var p=document.createElement("div");p.className="cesium-widget-errorPanel-buttonPanel";o.appendChild(p);var m=document.createElement("button");m.setAttribute("type","button");m.className="cesium-button";m.appendChild(document.createTextNode("OK"));m.onclick=function(){if(a(l)&&a(window.removeEventListener)){window.removeEventListener("resize",l,false)}i.removeChild(n)};p.appendChild(m);i.appendChild(n);if(typeof console!=="undefined"){console.error(e+"\n"+t+"\n"+f)}};D.prototype.isDestroyed=function(){return false};D.prototype.destroy=function(){this._scene=this._scene&&this._scene.destroy();this._container.removeChild(this._element);s(this)};D.prototype.resize=function(){var e=this._canvas;var t=e.clientWidth;var r=e.clientHeight;if(!this._forceResize&&this._canvasWidth===t&&this._canvasHeight===r){return}this._forceResize=false;x(this);A(this)};D.prototype.render=function(){if(this._canRender){this._scene.initializeFrame();var e=this._clock.tick();this._scene.render(e)}else{this._clock.tick()}};return D});define("Widgets/ClockViewModel",["../Core/Clock","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/EventHelper","../Core/JulianDate","../ThirdParty/knockout"],function(e,t,r,i,n,a,o){"use strict";function s(r){if(!t(r)){r=new e}this._clock=r;this._eventHelper=new n;this._eventHelper.add(r.onTick,this.synchronize,this);this.systemTime=o.observable(a.now());this.systemTime.equalityComparer=a.equals;this.startTime=o.observable(r.startTime);this.startTime.equalityComparer=a.equals;this.startTime.subscribe(function(e){r.startTime=e;this.synchronize()},this);this.stopTime=o.observable(r.stopTime);this.stopTime.equalityComparer=a.equals;this.stopTime.subscribe(function(e){r.stopTime=e;this.synchronize()},this);this.currentTime=o.observable(r.currentTime);this.currentTime.equalityComparer=a.equals;this.currentTime.subscribe(function(e){r.currentTime=e;this.synchronize()},this);this.multiplier=o.observable(r.multiplier);this.multiplier.subscribe(function(e){r.multiplier=e;this.synchronize()},this);this.clockStep=o.observable(r.clockStep);this.clockStep.subscribe(function(e){r.clockStep=e;this.synchronize()},this);this.clockRange=o.observable(r.clockRange);this.clockRange.subscribe(function(e){r.clockRange=e;this.synchronize()},this);this.canAnimate=o.observable(r.canAnimate);this.canAnimate.subscribe(function(e){r.canAnimate=e;this.synchronize()},this);this.shouldAnimate=o.observable(r.shouldAnimate);this.shouldAnimate.subscribe(function(e){r.shouldAnimate=e;this.synchronize()},this);o.track(this,["systemTime","startTime","stopTime","currentTime","multiplier","clockStep","clockRange","canAnimate","shouldAnimate"])}r(s.prototype,{clock:{get:function(){return this._clock}}});s.prototype.synchronize=function(){var e=this._clock;this.systemTime=a.now();this.startTime=e.startTime;this.stopTime=e.stopTime;this.currentTime=e.currentTime;this.multiplier=e.multiplier;this.clockStep=e.clockStep;this.clockRange=e.clockRange;this.canAnimate=e.canAnimate;this.shouldAnimate=e.shouldAnimate};s.prototype.isDestroyed=function(){return false};s.prototype.destroy=function(){this._eventHelper.removeAll();i(this)};return s});define("Widgets/Command",["../Core/DeveloperError"],function(e){"use strict";function t(){this.canExecute=undefined;this.beforeExecute=undefined;this.afterExecute=undefined;e.throwInstantiationError()}return t});define("Widgets/FullscreenButton/FullscreenButtonViewModel",["../../Core/defaultValue","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../Core/Fullscreen","../../ThirdParty/knockout","../createCommand","../getElement"],function(e,t,r,i,n,a,o,s){"use strict";function u(t){var r=this;var i=a.observable(n.fullscreen);var u=a.observable(n.enabled);this.isFullscreen=undefined;a.defineProperty(this,"isFullscreen",{get:function(){return i()}});this.isFullscreenEnabled=undefined;a.defineProperty(this,"isFullscreenEnabled",{get:function(){return u()},set:function(e){u(e&&n.enabled)}});this.tooltip=undefined;a.defineProperty(this,"tooltip",function(){if(!this.isFullscreenEnabled){return"Full screen unavailable"}return i()?"Exit full screen":"Full screen"});this._command=o(function(){if(n.fullscreen){n.exitFullscreen()}else{n.requestFullscreen(r._fullscreenElement)}},a.getObservable(this,"isFullscreenEnabled"));this._fullscreenElement=e(s(t),document.body);this._callback=function(){i(n.fullscreen)};document.addEventListener(n.changeEventName,this._callback)}t(u.prototype,{fullscreenElement:{get:function(){return this._fullscreenElement},set:function(e){if(!(e instanceof Element)){throw new i("value must be a valid Element.")}this._fullscreenElement=e}},command:{get:function(){return this._command}}});u.prototype.isDestroyed=function(){return false};u.prototype.destroy=function(){document.removeEventListener(n.changeEventName,this._callback);r(this)};return u});define("Widgets/FullscreenButton/FullscreenButton",["../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../ThirdParty/knockout","../getElement","./FullscreenButtonViewModel"],function(e,t,r,i,n,a,o){"use strict";var s="M 83.96875 17.5625 L 83.96875 17.59375 L 76.65625 24.875 L 97.09375 24.96875 L 76.09375 45.96875 L 81.9375 51.8125 L 102.78125 30.9375 L 102.875 51.15625 L 110.15625 43.875 L 110.1875 17.59375 L 83.96875 17.5625 z M 44.125 17.59375 L 17.90625 17.625 L 17.9375 43.90625 L 25.21875 51.1875 L 25.3125 30.96875 L 46.15625 51.8125 L 52 45.96875 L 31 25 L 51.4375 24.90625 L 44.125 17.59375 z M 46.0625 76.03125 L 25.1875 96.875 L 25.09375 76.65625 L 17.8125 83.9375 L 17.8125 110.21875 L 44 110.25 L 51.3125 102.9375 L 30.90625 102.84375 L 51.875 81.875 L 46.0625 76.03125 z M 82 76.15625 L 76.15625 82 L 97.15625 103 L 76.71875 103.0625 L 84.03125 110.375 L 110.25 110.34375 L 110.21875 84.0625 L 102.9375 76.8125 L 102.84375 97 L 82 76.15625 z"
;var u="M 104.34375 17.5625 L 83.5 38.4375 L 83.40625 18.21875 L 76.125 25.5 L 76.09375 51.78125 L 102.3125 51.8125 L 102.3125 51.78125 L 109.625 44.5 L 89.1875 44.40625 L 110.1875 23.40625 L 104.34375 17.5625 z M 23.75 17.59375 L 17.90625 23.4375 L 38.90625 44.4375 L 18.5 44.53125 L 25.78125 51.8125 L 52 51.78125 L 51.96875 25.53125 L 44.6875 18.25 L 44.625 38.46875 L 23.75 17.59375 z M 25.6875 76.03125 L 18.375 83.3125 L 38.78125 83.40625 L 17.8125 104.40625 L 23.625 110.25 L 44.5 89.375 L 44.59375 109.59375 L 51.875 102.3125 L 51.875 76.0625 L 25.6875 76.03125 z M 102.375 76.15625 L 76.15625 76.1875 L 76.1875 102.4375 L 83.46875 109.71875 L 83.5625 89.53125 L 104.40625 110.375 L 110.25 104.53125 L 89.25 83.53125 L 109.6875 83.46875 L 102.375 76.15625 z";function l(t,r){if(!e(t)){throw new i("container is required.")}t=a(t);var l=new o(r);l._exitFullScreenPath=u;l._enterFullScreenPath=s;var c=document.createElement("button");c.type="button";c.className="cesium-button cesium-fullscreenButton";c.setAttribute("data-bind","attr: { title: tooltip },click: command,enable: isFullscreenEnabled,cesiumSvgPath: { path: isFullscreen ? _exitFullScreenPath : _enterFullScreenPath, width: 128, height: 128 }");t.appendChild(c);n.applyBindings(l,c);this._container=t;this._viewModel=l;this._element=c}t(l.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}});l.prototype.isDestroyed=function(){return false};l.prototype.destroy=function(){this._viewModel.destroy();n.cleanNode(this._element);this._container.removeChild(this._element);return r(this)};return l});define("Widgets/Geocoder/GeocoderViewModel",["../../Core/BingMapsGeocoderService","../../Core/defaultValue","../../Core/defined","../../Core/defineProperties","../../Core/DeveloperError","../../Core/Event","../../Core/CartographicGeocoderService","../../Core/Matrix4","../../ThirdParty/knockout","../../ThirdParty/when","../createCommand","../getElement"],function(e,t,r,i,n,a,o,s,u,l,c,d){"use strict";function f(i){if(!r(i)||!r(i.scene)){throw new n("options.scene is required.")}if(r(i.geocoderServices)){this._geocoderServices=i.geocoderServices}else{this._geocoderServices=[new o,new e({scene:i.scene})]}this._viewContainer=i.container;this._scene=i.scene;this._flightDuration=i.flightDuration;this._searchText="";this._isSearchInProgress=false;this._geocodePromise=undefined;this._complete=new a;this._suggestions=[];this._selectedSuggestion=undefined;this._showSuggestions=true;this._updateCamera=m;this._adjustSuggestionsScroll=g;this._updateSearchSuggestions=b;this._handleArrowDown=p;this._handleArrowUp=h;var s=this;this._suggestionsVisible=u.pureComputed(function(){var e=u.getObservable(s,"_suggestions");var t=e().length>0;var r=u.getObservable(s,"_showSuggestions")();return t&&r});this._searchCommand=c(function(){s.hideSuggestions();s._focusTextbox=false;if(r(s._selectedSuggestion)){s.activateSuggestion(s._selectedSuggestion);return false}if(s.isSearchInProgress){y(s)}else{_(s,s._geocoderServices)}});this.deselectSuggestion=function(){s._selectedSuggestion=undefined};this.handleKeyDown=function(e,t){var r=t.key==="ArrowDown"||t.key==="Down"||t.keyCode===40;var i=t.key==="ArrowUp"||t.key==="Up"||t.keyCode===38;if(r||i){t.preventDefault()}return true};this.handleKeyUp=function(e,t){var r=t.key==="ArrowDown"||t.key==="Down"||t.keyCode===40;var i=t.key==="ArrowUp"||t.key==="Up"||t.keyCode===38;var n=t.key==="Enter"||t.keyCode===13;if(i){h(s)}else if(r){p(s)}else if(n){s._searchCommand()}return true};this.activateSuggestion=function(e){s.hideSuggestions();s._searchText=e.displayName;var t=e.destination;C(s);m(s,t)};this.hideSuggestions=function(){s._showSuggestions=false;s._selectedSuggestion=undefined};this.showSuggestions=function(){s._showSuggestions=true};this.handleMouseover=function(e,t){if(e!==s._selectedSuggestion){s._selectedSuggestion=e}};this.keepExpanded=false;this.autoComplete=t(i.autocomplete,true);this._focusTextbox=false;u.track(this,["_searchText","_isSearchInProgress","keepExpanded","_suggestions","_selectedSuggestion","_showSuggestions","_focusTextbox"]);var l=u.getObservable(this,"_searchText");l.extend({rateLimit:{timeout:500}});this._suggestionSubscription=l.subscribe(function(){b(s)});this.isSearchInProgress=undefined;u.defineProperty(this,"isSearchInProgress",{get:function(){return this._isSearchInProgress}});this.searchText=undefined;u.defineProperty(this,"searchText",{get:function(){if(this.isSearchInProgress){return"Searching..."}return this._searchText},set:function(e){if(typeof e!=="string"){throw new n("value must be a valid string.")}this._searchText=e}});this.flightDuration=undefined;u.defineProperty(this,"flightDuration",{get:function(){return this._flightDuration},set:function(e){if(r(e)&&e<0){throw new n("value must be positive.")}this._flightDuration=e}})}i(f.prototype,{complete:{get:function(){return this._complete}},scene:{get:function(){return this._scene}},search:{get:function(){return this._searchCommand}},selectedSuggestion:{get:function(){return this._selectedSuggestion}},suggestions:{get:function(){return this._suggestions}}});f.prototype.destroy=function(){this._suggestionSubscription.dispose()};function h(e){if(e._suggestions.length===0){return}var t;var r=e._suggestions.indexOf(e._selectedSuggestion);if(r===-1||r===0){e._selectedSuggestion=undefined;return}t=r-1;e._selectedSuggestion=e._suggestions[t];g(e,t)}function p(e){if(e._suggestions.length===0){return}var t=e._suggestions.length;var r=e._suggestions.indexOf(e._selectedSuggestion);var i=(r+1)%t;e._selectedSuggestion=e._suggestions[i];g(e,i)}function m(e,t){e._scene.camera.flyTo({destination:t,complete:function(){e._complete.raiseEvent()},duration:e._flightDuration,endTransform:s.IDENTITY})}function v(e,t,i){return e.then(function(e){if(r(e)&&e.state==="fulfilled"&&e.value.length>0){return e}var n=t.geocode(i).then(function(e){return{state:"fulfilled",value:e}}).otherwise(function(e){return{state:"rejected",reason:e}});return n})}function _(e,t){var i=e._searchText;if(w(i)){e.showSuggestions();return}e._isSearchInProgress=true;var n=l.resolve();for(var a=0;a<t.length;a++){n=v(n,t[a],i)}e._geocodePromise=n;n.then(function(t){if(n.cancel){return}e._isSearchInProgress=false;var a=t.value;if(t.state==="fulfilled"&&r(a)&&a.length>0){e._searchText=a[0].displayName;m(e,a[0].destination);return}e._searchText=i+" (not found)"})}function g(e,t){var r=d(e._viewContainer);var i=r.getElementsByClassName("search-results")[0];var n=r.getElementsByTagName("li");var a=n[t];if(t===0){i.scrollTop=0;return}var o=a.offsetTop;if(o+a.clientHeight>i.clientHeight){i.scrollTop=o+a.clientHeight}else if(o<i.scrollTop){i.scrollTop=o}}function y(e){e._isSearchInProgress=false;if(r(e._geocodePromise)){e._geocodePromise.cancel=true;e._geocodePromise=undefined}}function w(e){return/^\s*$/.test(e)}function C(e){u.getObservable(e,"_suggestions").removeAll()}function b(e){if(!e.autoComplete){return}var t=e._searchText;C(e);if(w(t)){return}var r=l.resolve([]);e._geocoderServices.forEach(function(e){r=r.then(function(r){if(r.length>=5){return r}return e.geocode(t).then(function(e){r=r.concat(e);return r})})});r.then(function(t){var r=e._suggestions;for(var i=0;i<t.length;i++){r.push(t[i])}})}return f});define("Widgets/Geocoder/Geocoder",["../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../Core/FeatureDetection","../../ThirdParty/knockout","../getElement","./GeocoderViewModel"],function(e,t,r,i,n,a,o,s){"use strict";var u="M29.772,26.433l-7.126-7.126c0.96-1.583,1.523-3.435,1.524-5.421C24.169,8.093,19.478,3.401,13.688,3.399C7.897,3.401,3.204,8.093,3.204,13.885c0,5.789,4.693,10.481,10.484,10.481c1.987,0,3.839-0.563,5.422-1.523l7.128,7.127L29.772,26.433zM7.203,13.885c0.006-3.582,2.903-6.478,6.484-6.486c3.579,0.008,6.478,2.904,6.484,6.486c-0.007,3.58-2.905,6.476-6.484,6.484C10.106,20.361,7.209,17.465,7.203,13.885z";var l="M24.778,21.419 19.276,15.917 24.777,10.415 21.949,7.585 16.447,13.087 10.945,7.585 8.117,10.415 13.618,15.917 8.116,21.419 10.946,24.248 16.447,18.746 21.948,24.248z";function c(t){if(!e(t)||!e(t.container)){throw new i("options.container is required.")}if(!e(t.scene)){throw new i("options.scene is required.")}var r=o(t.container);var c=new s(t);c._startSearchPath=u;c._stopSearchPath=l;var d=document.createElement("form");d.setAttribute("data-bind","submit: search");var f=document.createElement("input");f.type="search";f.className="cesium-geocoder-input";f.setAttribute("placeholder","Enter an address or landmark...");f.setAttribute("data-bind",'textInput: searchText,disable: isSearchInProgress,event: { keyup: handleKeyUp, keydown: handleKeyDown, mouseover: deselectSuggestion },css: { "cesium-geocoder-input-wide" : keepExpanded || searchText.length > 0 },hasFocus: _focusTextbox');this._onTextBoxFocus=function(){setTimeout(function(){f.select()},0)};f.addEventListener("focus",this._onTextBoxFocus,false);d.appendChild(f);this._textBox=f;var h=document.createElement("span");h.className="cesium-geocoder-searchButton";h.setAttribute("data-bind","click: search,cesiumSvgPath: { path: isSearchInProgress ? _stopSearchPath : _startSearchPath, width: 32, height: 32 }");d.appendChild(h);r.appendChild(d);var p=document.createElement("div");p.className="search-results";p.setAttribute("data-bind","visible: _suggestionsVisible");var m=document.createElement("ul");m.setAttribute("data-bind","foreach: _suggestions");var v=document.createElement("li");m.appendChild(v);v.setAttribute("data-bind","text: $data.displayName, click: $parent.activateSuggestion, event: { mouseover: $parent.handleMouseover}, css: { active: $data === $parent._selectedSuggestion }");p.appendChild(m);r.appendChild(p);a.applyBindings(c,d);a.applyBindings(c,p);this._container=r;this._searchSuggestionsContainer=p;this._viewModel=c;this._form=d;this._onInputBegin=function(e){if(!r.contains(e.target)){c._focusTextbox=false;c.hideSuggestions()}};this._onInputEnd=function(e){if(r.contains(e.target)){c._focusTextbox=true;c.showSuggestions()}};if(n.supportsPointerEvents()){document.addEventListener("pointerdown",this._onInputBegin,true);document.addEventListener("pointerup",this._onInputEnd,true);document.addEventListener("pointercancel",this._onInputEnd,true)}else{document.addEventListener("mousedown",this._onInputBegin,true);document.addEventListener("mouseup",this._onInputEnd,true);document.addEventListener("touchstart",this._onInputBegin,true);document.addEventListener("touchend",this._onInputEnd,true);document.addEventListener("touchcancel",this._onInputEnd,true)}}t(c.prototype,{container:{get:function(){return this._container}},searchSuggestionsContainer:{get:function(){return this._searchSuggestionsContainer}},viewModel:{get:function(){return this._viewModel}}});c.prototype.isDestroyed=function(){return false};c.prototype.destroy=function(){if(n.supportsPointerEvents()){document.removeEventListener("pointerdown",this._onInputBegin,true);document.removeEventListener("pointerup",this._onInputEnd,true)}else{document.removeEventListener("mousedown",this._onInputBegin,true);document.removeEventListener("mouseup",this._onInputEnd,true);document.removeEventListener("touchstart",this._onInputBegin,true);document.removeEventListener("touchend",this._onInputEnd,true)}this._viewModel.destroy();a.cleanNode(this._form);a.cleanNode(this._searchSuggestionsContainer);this._container.removeChild(this._form);this._container.removeChild(this._searchSuggestionsContainer);this._textBox.removeEventListener("focus",this._onTextBoxFocus,false);return r(this)};return c});define("Widgets/HomeButton/HomeButtonViewModel",["../../Core/defined","../../Core/defineProperties","../../Core/DeveloperError","../../ThirdParty/knockout","../createCommand"],function(e,t,r,i,n){"use strict";function a(t,a){if(!e(t)){throw new r("scene is required.")}this._scene=t;this._duration=a;var o=this;this._command=n(function(){o._scene.camera.flyHome(o._duration)});this.tooltip="View Home";i.track(this,["tooltip"])}t(a.prototype,{scene:{get:function(){return this._scene}},command:{get:function(){return this._command}},duration:{get:function(){return this._duration},set:function(t){if(e(t)&&t<0){throw new r("value must be positive.")}this._duration=t}}});return a});define("Widgets/HomeButton/HomeButton",["../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../ThirdParty/knockout","../getElement","./HomeButtonViewModel"],function(e,t,r,i,n,a,o){"use strict";function s(t,r,s){if(!e(t)){throw new i("container is required.")}t=a(t);var u=new o(r,s);u._svgPath="M14,4l-10,8.75h20l-4.25-3.7188v-4.6562h-2.812v2.1875l-2.938-2.5625zm-7.0938,9.906v10.094h14.094v-10.094h-14.094zm2.1876,2.313h3.3122v4.25h-3.3122v-4.25zm5.8442,1.281h3.406v6.438h-3.406v-6.438z";var l=document.createElement("button");l.type="button";l.className="cesium-button cesium-toolbar-button cesium-home-button";l.setAttribute("data-bind","attr: { title: tooltip },click: command,cesiumSvgPath: { path: _svgPath, width: 28, height: 28 }");t.appendChild(l);n.applyBindings(u,l);this._container=t;this._viewModel=u;this._element=l}t(s.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}});s.prototype.isDestroyed=function(){return false};s.prototype.destroy=function(){n.cleanNode(this._element);this._container.removeChild(this._element);return r(this)};return s});define("Widgets/InfoBox/InfoBoxViewModel",["../../Core/defined","../../Core/defineProperties","../../Core/Event","../../ThirdParty/knockout"],function(e,t,r,i){"use strict";var n="M 13.84375 7.03125 C 11.412798 7.03125 9.46875 8.975298 9.46875 11.40625 L 9.46875 11.59375 L 2.53125 7.21875 L 2.53125 24.0625 L 9.46875 19.6875 C 9.4853444 22.104033 11.423165 24.0625 13.84375 24.0625 L 25.875 24.0625 C 28.305952 24.0625 30.28125 22.087202 30.28125 19.65625 L 30.28125 11.40625 C 30.28125 8.975298 28.305952 7.03125 25.875 7.03125 L 13.84375 7.03125 z";var a="M 27.34375 1.65625 L 5.28125 27.9375 L 8.09375 30.3125 L 30.15625 4.03125 L 27.34375 1.65625 z M 13.84375 7.03125 C 11.412798 7.03125 9.46875 8.975298 9.46875 11.40625 L 9.46875 11.59375 L 2.53125 7.21875 L 2.53125 24.0625 L 9.46875 19.6875 C 9.4724893 20.232036 9.5676108 20.7379 9.75 21.21875 L 21.65625 7.03125 L 13.84375 7.03125 z M 28.21875 7.71875 L 14.53125 24.0625 L 25.875 24.0625 C 28.305952 24.0625 30.28125 22.087202 30.28125 19.65625 L 30.28125 11.40625 C 30.28125 9.8371439 29.456025 8.4902779 28.21875 7.71875 z";function o(){this._cameraClicked=new r;this._closeClicked=new r;this.maxHeight=500;this.enableCamera=false;this.isCameraTracking=false;this.showInfo=false;this.titleText="";this.description="";i.track(this,["showInfo","titleText","description","maxHeight","enableCamera","isCameraTracking"]);this._loadingIndicatorHtml='<div class="cesium-infoBox-loadingContainer"><span class="cesium-infoBox-loading"></span></div>';this.cameraIconPath=undefined;i.defineProperty(this,"cameraIconPath",{get:function(){return!this.enableCamera||this.isCameraTracking?a:n}});i.defineProperty(this,"_bodyless",{get:function(){return!e(this.description)||this.description.length===0}})}o.prototype.maxHeightOffset=function(e){return this.maxHeight-e+"px"};t(o.prototype,{cameraClicked:{get:function(){return this._cameraClicked}},closeClicked:{get:function(){return this._closeClicked}}});return o});define("Widgets/InfoBox/InfoBox",["../../Core/buildModuleUrl","../../Core/Color","../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../ThirdParty/knockout","../getElement","../subscribeAndEvaluate","./InfoBoxViewModel"],function(e,t,r,i,n,a,o,s,u,l){"use strict";function c(i){if(!r(i)){throw new a("container is required.")}i=s(i);var n=document.createElement("div");n.className="cesium-infoBox";n.setAttribute("data-bind",'css: { "cesium-infoBox-visible" : showInfo, "cesium-infoBox-bodyless" : _bodyless }');i.appendChild(n);var c=document.createElement("div");c.className="cesium-infoBox-title";c.setAttribute("data-bind","text: titleText");n.appendChild(c);var d=document.createElement("button");d.type="button";d.className="cesium-button cesium-infoBox-camera";d.setAttribute("data-bind",'attr: { title: "Focus camera on object" },click: function () { cameraClicked.raiseEvent(this); },enable: enableCamera,cesiumSvgPath: { path: cameraIconPath, width: 32, height: 32 }');n.appendChild(d);var f=document.createElement("button");f.type="button";f.className="cesium-infoBox-close";f.setAttribute("data-bind","click: function () { closeClicked.raiseEvent(this); }");f.innerHTML="&times;";n.appendChild(f);var h=document.createElement("iframe");h.className="cesium-infoBox-iframe";h.setAttribute("sandbox","allow-same-origin allow-popups allow-forms");h.setAttribute("data-bind","style : { maxHeight : maxHeightOffset(40) }");h.setAttribute("allowfullscreen",true);n.appendChild(h);var p=new l;o.applyBindings(p,n);this._container=i;this._element=n;this._frame=h;this._viewModel=p;this._descriptionSubscription=undefined;var m=this;h.addEventListener("load",function(){var i=h.contentDocument;var a=i.createElement("link");a.href=e("Widgets/InfoBox/InfoBoxDescription.css");a.rel="stylesheet";a.type="text/css";var o=i.createElement("div");o.className="cesium-infoBox-description";i.head.appendChild(a);i.body.appendChild(o);m._descriptionSubscription=u(p,"description",function(e){h.style.height="5px";o.innerHTML=e;var i=null;var a=o.firstElementChild;if(a!==null&&o.childNodes.length===1){var s=window.getComputedStyle(a);if(s!==null){var u=s["background-color"];var l=t.fromCssColorString(u);if(r(l)&&l.alpha!==0){i=s["background-color"]}}}n.style["background-color"]=i;var c=o.getBoundingClientRect().height;h.style.height=c+"px"})});h.setAttribute("src","about:blank")}i(c.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}},frame:{get:function(){return this._frame}}});c.prototype.isDestroyed=function(){return false};c.prototype.destroy=function(){var e=this._container;o.cleanNode(this._element);e.removeChild(this._element);if(r(this._descriptionSubscription)){this._descriptionSubscription.dispose()}return n(this)};return c});define("Widgets/NavigationHelpButton/NavigationHelpButtonViewModel",["../../Core/defineProperties","../../ThirdParty/knockout","../createCommand"],function(e,t,r){"use strict";function i(){this.showInstructions=false;var e=this;this._command=r(function(){e.showInstructions=!e.showInstructions});this._showClick=r(function(){e._touch=false});this._showTouch=r(function(){e._touch=true});this._touch=false;this.tooltip="Navigation Instructions";t.track(this,["tooltip","showInstructions","_touch"])}e(i.prototype,{command:{get:function(){return this._command}},showClick:{get:function(){return this._showClick}},showTouch:{get:function(){return this._showTouch}}});return i});define("Widgets/NavigationHelpButton/NavigationHelpButton",["../../Core/buildModuleUrl","../../Core/defaultValue","../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../Core/FeatureDetection","../../ThirdParty/knockout","../getElement","./NavigationHelpButtonViewModel"],function(e,t,r,i,n,a,o,s,u,l){"use strict";function c(i){if(!r(i)||!r(i.container)){throw new a("options.container is required.")}var n=u(i.container);var c=new l;var d=t(i.instructionsInitiallyVisible,false);c.showInstructions=d;c._svgPath="M16,1.466C7.973,1.466,1.466,7.973,1.466,16c0,8.027,6.507,14.534,14.534,14.534c8.027,0,14.534-6.507,14.534-14.534C30.534,7.973,24.027,1.466,16,1.466z M17.328,24.371h-2.707v-2.596h2.707V24.371zM17.328,19.003v0.858h-2.707v-1.057c0-3.19,3.63-3.696,3.63-5.963c0-1.034-0.924-1.826-2.134-1.826c-1.254,0-2.354,0.924-2.354,0.924l-1.541-1.915c0,0,1.519-1.584,4.137-1.584c2.487,0,4.796,1.54,4.796,4.136C21.156,16.208,17.328,16.627,17.328,19.003z";var f=document.createElement("span");f.className="cesium-navigationHelpButton-wrapper";n.appendChild(f);var h=document.createElement("button");h.type="button";h.className="cesium-button cesium-toolbar-button cesium-navigation-help-button";h.setAttribute("data-bind","attr: { title: tooltip },click: command,cesiumSvgPath: { path: _svgPath, width: 32, height: 32 }");f.appendChild(h);var p=document.createElement("div");p.className="cesium-navigation-help";p.setAttribute("data-bind",'css: { "cesium-navigation-help-visible" : showInstructions}');f.appendChild(p);var m=document.createElement("button");m.type="button";m.className="cesium-navigation-button cesium-navigation-button-left";m.setAttribute("data-bind",'click: showClick, css: {"cesium-navigation-button-selected": !_touch, "cesium-navigation-button-unselected": _touch}');var v=document.createElement("img");v.src=e("Widgets/Images/NavigationHelp/Mouse.svg");v.className="cesium-navigation-button-icon";v.style.width="25px";v.style.height="25px";m.appendChild(v);m.appendChild(document.createTextNode("Mouse"));var _=document.createElement("button");_.type="button";_.className="cesium-navigation-button cesium-navigation-button-right";_.setAttribute("data-bind",'click: showTouch, css: {"cesium-navigation-button-selected": _touch, "cesium-navigation-button-unselected": !_touch}');var g=document.createElement("img");g.src=e("Widgets/Images/NavigationHelp/Touch.svg");g.className="cesium-navigation-button-icon";g.style.width="25px";g.style.height="25px";_.appendChild(g);_.appendChild(document.createTextNode("Touch"));p.appendChild(m);p.appendChild(_);var y=document.createElement("div");y.className="cesium-click-navigation-help cesium-navigation-help-instructions";y.setAttribute("data-bind",'css: { "cesium-click-navigation-help-visible" : !_touch}');y.innerHTML='            <table>                <tr>                    <td><img src="'+e("Widgets/Images/NavigationHelp/MouseLeft.svg")+'" width="48" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-pan">Pan view</div>                        <div class="cesium-navigation-help-details">Left click + drag</div>                    </td>                </tr>                <tr>                    <td><img src="'+e("Widgets/Images/NavigationHelp/MouseRight.svg")+'" width="48" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-zoom">Zoom view</div>                        <div class="cesium-navigation-help-details">Right click + drag, or</div>                        <div class="cesium-navigation-help-details">Mouse wheel scroll</div>                    </td>                </tr>                <tr>                    <td><img src="'+e("Widgets/Images/NavigationHelp/MouseMiddle.svg")+'" width="48" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-rotate">Rotate view</div>                        <div class="cesium-navigation-help-details">Middle click + drag, or</div>                        <div class="cesium-navigation-help-details">CTRL + Left/Right click + drag</div>                    </td>                </tr>            </table>';p.appendChild(y);var w=document.createElement("div");w.className="cesium-touch-navigation-help cesium-navigation-help-instructions";w.setAttribute("data-bind",'css: { "cesium-touch-navigation-help-visible" : _touch}');w.innerHTML='            <table>                <tr>                    <td><img src="'+e("Widgets/Images/NavigationHelp/TouchDrag.svg")+'" width="70" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-pan">Pan view</div>                        <div class="cesium-navigation-help-details">One finger drag</div>                    </td>                </tr>                <tr>                    <td><img src="'+e("Widgets/Images/NavigationHelp/TouchZoom.svg")+'" width="70" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-zoom">Zoom view</div>                        <div class="cesium-navigation-help-details">Two finger pinch</div>                    </td>                </tr>                <tr>                    <td><img src="'+e("Widgets/Images/NavigationHelp/TouchTilt.svg")+'" width="70" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-rotate">Tilt view</div>                        <div class="cesium-navigation-help-details">Two finger drag, same direction</div>                    </td>                </tr>                <tr>                    <td><img src="'+e("Widgets/Images/NavigationHelp/TouchRotate.svg")+'" width="70" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-tilt">Rotate view</div>                        <div class="cesium-navigation-help-details">Two finger drag, opposite direction</div>                    </td>                </tr>            </table>';p.appendChild(w);s.applyBindings(c,f);this._container=n;this._viewModel=c;this._wrapper=f;this._closeInstructions=function(e){if(!f.contains(e.target)){c.showInstructions=false}};if(o.supportsPointerEvents()){document.addEventListener("pointerdown",this._closeInstructions,true)}else{document.addEventListener("mousedown",this._closeInstructions,true);document.addEventListener("touchstart",this._closeInstructions,true)}}i(c.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}});c.prototype.isDestroyed=function(){return false};c.prototype.destroy=function(){if(o.supportsPointerEvents()){document.removeEventListener("pointerdown",this._closeInstructions,true)}else{document.removeEventListener("mousedown",this._closeInstructions,true);document.removeEventListener("touchstart",this._closeInstructions,true)}s.cleanNode(this._wrapper);this._container.removeChild(this._wrapper);return n(this)};return c});define("Widgets/PerformanceWatchdog/PerformanceWatchdogViewModel",["../../Core/defaultValue","../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../Scene/FrameRateMonitor","../../ThirdParty/knockout","../createCommand"],function(e,t,r,i,n,a,o,s){"use strict";function u(r){if(!t(r)||!t(r.scene)){throw new n("options.scene is required.")}this._scene=r.scene;this.lowFrameRateMessage=e(r.lowFrameRateMessage,"This application appears to be performing poorly on your system.  Please try using a different web browser or updating your video drivers.");this.lowFrameRateMessageDismissed=false;this.showingLowFrameRateMessage=false;o.track(this,["lowFrameRateMessage","lowFrameRateMessageDismissed","showingLowFrameRateMessage"]);var i=this;this._dismissMessage=s(function(){i.showingLowFrameRateMessage=false;i.lowFrameRateMessageDismissed=true});var u=a.fromScene(r.scene);this._unsubscribeLowFrameRate=u.lowFrameRate.addEventListener(function(){if(!i.lowFrameRateMessageDismissed){i.showingLowFrameRateMessage=true}});this._unsubscribeNominalFrameRate=u.nominalFrameRate.addEventListener(function(){i.showingLowFrameRateMessage=false})}r(u.prototype,{scene:{get:function(){return this._scene}},dismissMessage:{get:function(){return this._dismissMessage}}});u.prototype.destroy=function(){this._unsubscribeLowFrameRate();this._unsubscribeNominalFrameRate();return i(this)};return u});define("Widgets/PerformanceWatchdog/PerformanceWatchdog",["../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../ThirdParty/knockout","../getElement","./PerformanceWatchdogViewModel"],function(e,t,r,i,n,a,o){"use strict";function s(t){if(!e(t)||!e(t.container)){throw new i("options.container is required.")}if(!e(t.scene)){throw new i("options.scene is required.")}var r=a(t.container);var s=new o(t);var u=document.createElement("div");u.className="cesium-performance-watchdog-message-area";u.setAttribute("data-bind","visible: showingLowFrameRateMessage");var l=document.createElement("button");l.setAttribute("type","button");l.className="cesium-performance-watchdog-message-dismiss";l.innerHTML="&times;";l.setAttribute("data-bind","click: dismissMessage");u.appendChild(l);var c=document.createElement("div");c.className="cesium-performance-watchdog-message";c.setAttribute("data-bind","html: lowFrameRateMessage");u.appendChild(c);r.appendChild(u);n.applyBindings(s,u);this._container=r;this._viewModel=s;this._element=u}t(s.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}});s.prototype.isDestroyed=function(){return false};s.prototype.destroy=function(){this._viewModel.destroy();n.cleanNode(this._element);this._container.removeChild(this._element);return r(this)};return s});define("Widgets/ProjectionPicker/ProjectionPickerViewModel",["../../Core/Cartesian2","../../Core/Cartesian3","../../Core/defaultValue","../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../Core/EventHelper","../../Core/Math","../../Core/Matrix4","../../Core/Ray","../../Scene/OrthographicFrustum","../../Scene/PerspectiveFrustum","../../Scene/SceneMode","../../ThirdParty/knockout","../createCommand"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m){"use strict";function v(e){if(!i(e)){throw new o("scene is required.")}this._scene=e;this._orthographic=e.camera.frustum instanceof d;this._flightInProgress=false;this.dropDownVisible=false;this.tooltipPerspective="Perspective Projection";this.tooltipOrthographic="Orthographic Projection";this.selectedTooltip=undefined;this.sceneMode=e.mode;p.track(this,["_orthographic","_flightInProgress","sceneMode","dropDownVisible","tooltipPerspective","tooltipOrthographic"]);var t=this;p.defineProperty(this,"selectedTooltip",function(){if(t._orthographic){return t.tooltipOrthographic}return t.tooltipPerspective});this._toggleDropDown=m(function(){if(t.sceneMode===h.SCENE2D||t._flightInProgress){return}t.dropDownVisible=!t.dropDownVisible});this._eventHelper=new s;this._eventHelper.add(e.morphComplete,function(e,r,i,n){t.sceneMode=i;t._orthographic=i===h.SCENE2D||t._scene.camera.frustum instanceof d});this._eventHelper.add(e.preRender,function(){t._flightInProgress=i(e.camera._currentFlight)});this._switchToPerspective=m(function(){if(t.sceneMode===h.SCENE2D){return}t._scene.camera.switchToPerspectiveFrustum();t._orthographic=false;t.dropDownVisible=false});this._switchToOrthographic=m(function(){if(t.sceneMode===h.SCENE2D){return}t._scene.camera.switchToOrthographicFrustum();t._orthographic=true;t.dropDownVisible=false});this._sceneMode=h}n(v.prototype,{scene:{get:function(){return this._scene}},toggleDropDown:{get:function(){return this._toggleDropDown}},switchToPerspective:{get:function(){return this._switchToPerspective}},switchToOrthographic:{get:function(){return this._switchToOrthographic}},isOrthographicProjection:{get:function(){return this._orthographic}}});v.prototype.isDestroyed=function(){return false};v.prototype.destroy=function(){this._eventHelper.removeAll();a(this)};return v});define("Widgets/ProjectionPicker/ProjectionPicker",["../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../Core/FeatureDetection","../../ThirdParty/knockout","../getElement","./ProjectionPickerViewModel"],function(e,t,r,i,n,a,o,s){"use strict";var u="M 28.15625,10.4375 9.125,13.21875 13.75,43.25 41.75,55.09375 50.8125,37 54.5,11.9375 z m 0.125,3 19.976451,0.394265 L 43.03125,16.875 22.6875,14.28125 z M 50.971746,15.705477 47.90625,36.03125 42.53125,46 44.84375,19.3125 z M 12.625,16.03125 l 29.15625,3.6875 -2.65625,31 L 16.4375,41.125 z"
;var l="m 31.560594,6.5254438 -20.75,12.4687502 0.1875,24.5625 22.28125,11.8125 19.5,-12 0.65625,-0.375 0,-0.75 0.0312,-23.21875 z m 0.0625,3.125 16.65625,9.5000002 -16.125,10.28125 -17.34375,-9.71875 z m 18.96875,11.1875002 0.15625,20.65625 -17.46875,10.59375 0.15625,-20.28125 z m -37.0625,1.25 17.21875,9.625 -0.15625,19.21875 -16.9375,-9 z";function c(t,r){if(!e(t)){throw new i("container is required.")}if(!e(r)){throw new i("scene is required.")}t=o(t);var c=new s(r);c._perspectivePath=u;c._orthographicPath=l;var d=document.createElement("span");d.className="cesium-projectionPicker-wrapper cesium-toolbar-button";t.appendChild(d);var f=document.createElement("button");f.type="button";f.className="cesium-button cesium-toolbar-button";f.setAttribute("data-bind",'css: { "cesium-projectionPicker-buttonPerspective": !_orthographic,       "cesium-projectionPicker-buttonOrthographic": _orthographic,       "cesium-button-disabled" : sceneMode === _sceneMode.SCENE2D || _flightInProgress,        "cesium-projectionPicker-selected": dropDownVisible },attr: { title: selectedTooltip },click: toggleDropDown');f.innerHTML='<!-- ko cesiumSvgPath: { path: _perspectivePath, width: 64, height: 64, css: "cesium-projectionPicker-iconPerspective" } --><!-- /ko --><!-- ko cesiumSvgPath: { path: _orthographicPath, width: 64, height: 64, css: "cesium-projectionPicker-iconOrthographic" } --><!-- /ko -->';d.appendChild(f);var h=document.createElement("button");h.type="button";h.className="cesium-button cesium-toolbar-button cesium-projectionPicker-dropDown-icon";h.setAttribute("data-bind",'css: { "cesium-projectionPicker-visible" : (dropDownVisible && _orthographic),       "cesium-projectionPicker-none" : !_orthographic,       "cesium-projectionPicker-hidden" : !dropDownVisible },attr: { title: tooltipPerspective },click: switchToPerspective,cesiumSvgPath: { path: _perspectivePath, width: 64, height: 64 }');d.appendChild(h);var p=document.createElement("button");p.type="button";p.className="cesium-button cesium-toolbar-button cesium-projectionPicker-dropDown-icon";p.setAttribute("data-bind",'css: { "cesium-projectionPicker-visible" : (dropDownVisible && !_orthographic),       "cesium-projectionPicker-none" : _orthographic,       "cesium-projectionPicker-hidden" : !dropDownVisible},attr: { title: tooltipOrthographic },click: switchToOrthographic,cesiumSvgPath: { path: _orthographicPath, width: 64, height: 64 }');d.appendChild(p);a.applyBindings(c,d);this._viewModel=c;this._container=t;this._wrapper=d;this._closeDropDown=function(e){if(!d.contains(e.target)){c.dropDownVisible=false}};if(n.supportsPointerEvents()){document.addEventListener("pointerdown",this._closeDropDown,true)}else{document.addEventListener("mousedown",this._closeDropDown,true);document.addEventListener("touchstart",this._closeDropDown,true)}}t(c.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}});c.prototype.isDestroyed=function(){return false};c.prototype.destroy=function(){this._viewModel.destroy();if(n.supportsPointerEvents()){document.removeEventListener("pointerdown",this._closeDropDown,true)}else{document.removeEventListener("mousedown",this._closeDropDown,true);document.removeEventListener("touchstart",this._closeDropDown,true)}a.cleanNode(this._wrapper);this._container.removeChild(this._wrapper);return r(this)};return c});define("Widgets/SceneModePicker/SceneModePickerViewModel",["../../Core/defaultValue","../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../Core/EventHelper","../../Scene/SceneMode","../../ThirdParty/knockout","../createCommand"],function(e,t,r,i,n,a,o,s,u){"use strict";function l(r,i){if(!t(r)){throw new n("scene is required.")}this._scene=r;var l=this;var c=function(e,t,r,i){l.sceneMode=r;l.dropDownVisible=false};this._eventHelper=new a;this._eventHelper.add(r.morphStart,c);this._duration=e(i,2);this.sceneMode=r.mode;this.dropDownVisible=false;this.tooltip2D="2D";this.tooltip3D="3D";this.tooltipColumbusView="Columbus View";s.track(this,["sceneMode","dropDownVisible","tooltip2D","tooltip3D","tooltipColumbusView"]);this.selectedTooltip=undefined;s.defineProperty(this,"selectedTooltip",function(){var e=l.sceneMode;if(e===o.SCENE2D){return l.tooltip2D}if(e===o.SCENE3D){return l.tooltip3D}return l.tooltipColumbusView});this._toggleDropDown=u(function(){l.dropDownVisible=!l.dropDownVisible});this._morphTo2D=u(function(){r.morphTo2D(l._duration)});this._morphTo3D=u(function(){r.morphTo3D(l._duration)});this._morphToColumbusView=u(function(){r.morphToColumbusView(l._duration)});this._sceneMode=o}r(l.prototype,{scene:{get:function(){return this._scene}},duration:{get:function(){return this._duration},set:function(e){if(e<0){throw new n("duration value must be positive.")}this._duration=e}},toggleDropDown:{get:function(){return this._toggleDropDown}},morphTo2D:{get:function(){return this._morphTo2D}},morphTo3D:{get:function(){return this._morphTo3D}},morphToColumbusView:{get:function(){return this._morphToColumbusView}}});l.prototype.isDestroyed=function(){return false};l.prototype.destroy=function(){this._eventHelper.removeAll();i(this)};return l});define("Widgets/SceneModePicker/SceneModePicker",["../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../Core/FeatureDetection","../../ThirdParty/knockout","../getElement","./SceneModePickerViewModel"],function(e,t,r,i,n,a,o,s){"use strict";var u="m 32.401392,4.9330437 c -7.087603,0 -14.096095,2.884602 -19.10793,7.8946843 -5.0118352,5.010083 -7.9296167,11.987468 -7.9296167,19.072999 0,7.085531 2.9177815,14.097848 7.9296167,19.107931 4.837653,4.835961 11.541408,7.631372 18.374354,7.82482 0.05712,0.01231 0.454119,0.139729 0.454119,0.139729 l 0.03493,-0.104797 c 0.08246,7.84e-4 0.162033,0.03493 0.244525,0.03493 0.08304,0 0.161515,-0.03414 0.244526,-0.03493 l 0.03493,0.104797 c 0,0 0.309474,-0.129487 0.349323,-0.139729 6.867765,-0.168094 13.582903,-2.965206 18.444218,-7.82482 2.558195,-2.5573 4.551081,-5.638134 5.903547,-8.977584 1.297191,-3.202966 2.02607,-6.661489 2.02607,-10.130347 0,-6.237309 -2.366261,-12.31219 -6.322734,-17.116794 -0.0034,-0.02316 0.0049,-0.04488 0,-0.06986 -0.01733,-0.08745 -0.104529,-0.278855 -0.104797,-0.279458 -5.31e-4,-0.0012 -0.522988,-0.628147 -0.523984,-0.62878         -3.47e-4,-2.2e-4 -0.133444,-0.03532 -0.244525,-0.06987 C 51.944299,13.447603 51.751076,13.104317 51.474391,12.827728 46.462556,7.8176457 39.488996,4.9330437 32.401392,4.9330437 z m -2.130866,3.5281554 0.104797,9.6762289 c -4.111695,-0.08361 -7.109829,-0.423664 -9.257041,-0.943171 1.198093,-2.269271 2.524531,-4.124404 3.91241,-5.414496 2.167498,-2.0147811 3.950145,-2.8540169 5.239834,-3.3185619 z m 2.794579,0 c 1.280302,0.4754953 3.022186,1.3285948 5.065173,3.2486979 1.424667,1.338973 2.788862,3.303645 3.982275,5.728886 -2.29082,0.403367 -5.381258,0.621049 -8.942651,0.698645 L 33.065105,8.4611991 z m 5.728886,0.2445256 c 4.004072,1.1230822 7.793098,3.1481363 10.724195,6.0782083 0.03468,0.03466 0.07033,0.06991 0.104797,0.104797 -0.45375,0.313891 -0.923054,0.663002 -1.956205,1.082899 -0.647388,0.263114 -1.906242,0.477396 -2.829511,0.733577 -1.382296,-2.988132         -3.027146,-5.368585 -4.785716,-7.0213781 -0.422866,-0.397432 -0.835818,-0.6453247 -1.25756,-0.9781032 z m -15.33525,0.7685092 c -0.106753,0.09503 -0.207753,0.145402 -0.31439,0.244526 -1.684973,1.5662541 -3.298068,3.8232211 -4.680919,6.5672591 -0.343797,-0.14942 -1.035052,-0.273198 -1.292493,-0.419186 -0.956528,-0.542427 -1.362964,-1.022024 -1.537018,-1.292493 -0.0241,-0.03745 -0.01868,-0.0401 -0.03493,-0.06986 2.250095,-2.163342 4.948824,-3.869984 7.859752,-5.0302421 z m -9.641296,7.0912431 c 0.464973,0.571618 0.937729,1.169056 1.956205,1.746612 0.349907,0.198425 1.107143,0.335404 1.537018,0.523983 -1.20166,3.172984 -1.998037,7.051901 -2.165798,11.772162 C 14.256557,30.361384 12.934823,30.161483 12.280427,29.90959 10.644437,29.279855 9.6888882,28.674891 9.1714586,28.267775 8.6540289,27.860658 8.6474751,27.778724 8.6474751,27.778724 l -0.069864,0.03493 C 9.3100294,23.691285         11.163248,19.798527 13.817445,16.565477 z m 37.552149,0.523984 c 2.548924,3.289983 4.265057,7.202594 4.890513,11.318043 -0.650428,0.410896 -1.756876,1.001936 -3.563088,1.606882 -1.171552,0.392383 -3.163859,0.759153 -4.960377,1.117832 -0.04367,-4.752703 -0.784809,-8.591423 -1.88634,-11.807094 0.917574,-0.263678 2.170552,-0.486495 2.864443,-0.76851 1.274693,-0.518066 2.003942,-1.001558 2.654849,-1.467153 z m -31.439008,2.619917 c 2.487341,0.672766 5.775813,1.137775 10.479669,1.222628 l 0.104797,10.689263 0,0.03493 0,0.733577 c -5.435005,-0.09059 -9.512219,-0.519044 -12.610536,-1.117831 0.106127,-4.776683 0.879334,-8.55791 2.02607,-11.562569 z m 23.264866,0.31439 c 1.073459,3.067541 1.833795,6.821314 1.816476,11.702298 -3.054474,0.423245 -7.062018,0.648559 -11.702298,0.698644 l 0,-0.838373 -0.104796,-10.654331 c 4.082416,-0.0864 7.404468,-0.403886 9.990618,-0.908238 z         M 8.2632205,30.922625 c 0.7558676,0.510548 1.5529563,1.013339 3.0041715,1.57195 0.937518,0.360875 2.612202,0.647642 3.91241,0.978102 0.112814,3.85566 0.703989,7.107756 1.606883,9.920754 -1.147172,-0.324262 -2.644553,-0.640648 -3.423359,-0.978102 -1.516688,-0.657177 -2.386627,-1.287332 -2.864443,-1.71168 -0.477816,-0.424347 -0.489051,-0.489051 -0.489051,-0.489051 L 9.8002387,40.319395 C 8.791691,37.621767 8.1584238,34.769583 8.1584238,31.900727 c 0,-0.330153 0.090589,-0.648169 0.1047967,-0.978102 z m 48.2763445,0.419186 c 0.0047,0.188973 0.06986,0.36991 0.06986,0.558916 0,2.938869 -0.620228,5.873558 -1.676747,8.628261 -0.07435,0.07583 -0.06552,0.07411 -0.454119,0.349323 -0.606965,0.429857 -1.631665,1.042044 -3.318562,1.676747 -1.208528,0.454713 -3.204964,0.850894 -5.135038,1.25756 0.84593,-2.765726 1.41808,-6.005357 1.606883,-9.815957 2.232369,-0.413371 4.483758,-0.840201         5.938479,-1.327425 1.410632,-0.472457 2.153108,-0.89469 2.96924,-1.327425 z m -38.530252,2.864443 c 3.208141,0.56697 7.372279,0.898588 12.575603,0.978103 l 0.174662,9.885821 c -4.392517,-0.06139 -8.106722,-0.320566 -10.863925,-0.803441 -1.051954,-2.664695 -1.692909,-6.043794 -1.88634,-10.060483 z m 26.793022,0.31439 c -0.246298,3.923551 -0.877762,7.263679 -1.816476,9.885822 -2.561957,0.361954 -5.766249,0.560708 -9.431703,0.62878 l -0.174661,-9.815957 c 4.491734,-0.04969 8.334769,-0.293032 11.42284,-0.698645 z M 12.035901,44.860585 c 0.09977,0.04523 0.105535,0.09465 0.209594,0.139729 1.337656,0.579602 3.441099,1.058072 5.589157,1.537018 1.545042,3.399208 3.548524,5.969402 5.589157,7.789888 -3.034411,-1.215537 -5.871615,-3.007978 -8.174142,-5.309699 -1.245911,-1.245475 -2.271794,-2.662961 -3.213766,-4.156936 z m 40.69605,0 c -0.941972,1.493975 -1.967855,2.911461         -3.213765,4.156936 -2.74253,2.741571 -6.244106,4.696717 -9.955686,5.868615 0.261347,-0.241079 0.507495,-0.394491 0.768509,-0.663713 1.674841,-1.727516 3.320792,-4.181056 4.645987,-7.265904 2.962447,-0.503021 5.408965,-1.122293 7.161107,-1.781544 0.284034,-0.106865 0.337297,-0.207323 0.593848,-0.31439 z m -31.404076,2.305527 c 2.645807,0.376448 5.701178,0.649995 9.466635,0.698645 l 0.139729,7.789888 c -1.38739,-0.480844 -3.316218,-1.29837 -5.659022,-3.388427 -1.388822,-1.238993 -2.743668,-3.0113 -3.947342,-5.100106 z m 20.365491,0.104797 c -1.04872,2.041937 -2.174337,3.779068 -3.353494,4.995309 -1.853177,1.911459 -3.425515,2.82679 -4.611055,3.353494 l -0.139729,-7.789887 c 3.13091,-0.05714 5.728238,-0.278725 8.104278,-0.558916 z";var l="m 2.9825053,17.550598 0,1.368113 0,26.267766 0,1.368113 1.36811,0 54.9981397,0 1.36811,0 0,-1.368113 0,-26.267766 0,-1.368113 -1.36811,0 -54.9981397,0 -1.36811,0 z m 2.73623,2.736226 10.3292497,0 0,10.466063 -10.3292497,0 0,-10.466063 z m 13.0654697,0 11.69737,0 0,10.466063 -11.69737,0 0,-10.466063 z m 14.43359,0 11.69737,0 0,10.466063 -11.69737,0 0,-10.466063 z m 14.43359,0 10.32926,0 0,10.466063 -10.32926,0 0,-10.466063 z m -41.9326497,13.202288 10.3292497,0 0,10.329252 -10.3292497,0 0,-10.329252 z m 13.0654697,0 11.69737,0 0,10.329252 -11.69737,0 0,-10.329252 z m 14.43359,0 11.69737,0 0,10.329252 -11.69737,0 0,-10.329252 z m 14.43359,0 10.32926,0 0,10.329252 -10.32926,0 0,-10.329252 z";var c="m 14.723969,17.675598 -0.340489,0.817175 -11.1680536,26.183638 -0.817175,1.872692 2.076986,0 54.7506996,0 2.07698,0 -0.81717,-1.872692 -11.16805,-26.183638 -0.34049,-0.817175 -0.91933,0 -32.414586,0 -0.919322,0 z m 1.838643,2.723916 6.196908,0 -2.928209,10.418977 -7.729111,0 4.460412,-10.418977 z m 9.02297,0 4.903049,0 0,10.418977 -7.831258,0 2.928209,-10.418977 z m 7.626964,0 5.584031,0 2.62176,10.418977 -8.205791,0 0,-10.418977 z m 8.410081,0 5.51593,0 4.46042,10.418977 -7.38863,0 -2.58772,-10.418977 z m -30.678091,13.142892 8.103649,0 -2.89416,10.282782 -9.6018026,0 4.3923136,-10.282782 z m 10.929711,0 8.614384,0 0,10.282782 -11.508544,0 2.89416,-10.282782 z m 11.338299,0 8.852721,0 2.58772,10.282782 -11.440441,0 0,-10.282782 z m 11.678781,0 7.86531,0 4.39231,10.282782 -9.6699,0 -2.58772,-10.282782 z";function d(t,r,d){if(!e(t)){throw new i("container is required.")}if(!e(r)){throw new i("scene is required.")}t=o(t);var f=new s(r,d);f._globePath=u;f._flatMapPath=l;f._columbusViewPath=c;var h=document.createElement("span");h.className="cesium-sceneModePicker-wrapper cesium-toolbar-button";t.appendChild(h);var p=document.createElement("button");p.type="button";p.className="cesium-button cesium-toolbar-button";p.setAttribute("data-bind",'css: { "cesium-sceneModePicker-button2D": sceneMode === _sceneMode.SCENE2D,       "cesium-sceneModePicker-button3D": sceneMode === _sceneMode.SCENE3D,       "cesium-sceneModePicker-buttonColumbusView": sceneMode === _sceneMode.COLUMBUS_VIEW,       "cesium-sceneModePicker-selected": dropDownVisible },attr: { title: selectedTooltip },click: toggleDropDown');p.innerHTML='<!-- ko cesiumSvgPath: { path: _globePath, width: 64, height: 64, css: "cesium-sceneModePicker-slide-svg cesium-sceneModePicker-icon3D" } --><!-- /ko --><!-- ko cesiumSvgPath: { path: _flatMapPath, width: 64, height: 64, css: "cesium-sceneModePicker-slide-svg cesium-sceneModePicker-icon2D" } --><!-- /ko --><!-- ko cesiumSvgPath: { path: _columbusViewPath, width: 64, height: 64, css: "cesium-sceneModePicker-slide-svg cesium-sceneModePicker-iconColumbusView" } --><!-- /ko -->';h.appendChild(p);var m=document.createElement("button");m.type="button";m.className="cesium-button cesium-toolbar-button cesium-sceneModePicker-dropDown-icon";m.setAttribute("data-bind",'css: { "cesium-sceneModePicker-visible" : (dropDownVisible && (sceneMode !== _sceneMode.SCENE3D)) || (!dropDownVisible && (sceneMode === _sceneMode.SCENE3D)),       "cesium-sceneModePicker-none" : sceneMode === _sceneMode.SCENE3D,       "cesium-sceneModePicker-hidden" : !dropDownVisible },attr: { title: tooltip3D },click: morphTo3D,cesiumSvgPath: { path: _globePath, width: 64, height: 64 }');h.appendChild(m);var v=document.createElement("button");v.type="button";v.className="cesium-button cesium-toolbar-button cesium-sceneModePicker-dropDown-icon";v.setAttribute("data-bind",'css: { "cesium-sceneModePicker-visible" : (dropDownVisible && (sceneMode !== _sceneMode.SCENE2D)),       "cesium-sceneModePicker-none" : sceneMode === _sceneMode.SCENE2D,       "cesium-sceneModePicker-hidden" : !dropDownVisible },attr: { title: tooltip2D },click: morphTo2D,cesiumSvgPath: { path: _flatMapPath, width: 64, height: 64 }');h.appendChild(v);var _=document.createElement("button");_.type="button";_.className="cesium-button cesium-toolbar-button cesium-sceneModePicker-dropDown-icon";_.setAttribute("data-bind",'css: { "cesium-sceneModePicker-visible" : (dropDownVisible && (sceneMode !== _sceneMode.COLUMBUS_VIEW)) || (!dropDownVisible && (sceneMode === _sceneMode.COLUMBUS_VIEW)),       "cesium-sceneModePicker-none" : sceneMode === _sceneMode.COLUMBUS_VIEW,       "cesium-sceneModePicker-hidden" : !dropDownVisible},attr: { title: tooltipColumbusView },click: morphToColumbusView,cesiumSvgPath: { path: _columbusViewPath, width: 64, height: 64 }');h.appendChild(_);a.applyBindings(f,h);this._viewModel=f;this._container=t;this._wrapper=h;this._closeDropDown=function(e){if(!h.contains(e.target)){f.dropDownVisible=false}};if(n.supportsPointerEvents()){document.addEventListener("pointerdown",this._closeDropDown,true)}else{document.addEventListener("mousedown",this._closeDropDown,true);document.addEventListener("touchstart",this._closeDropDown,true)}}t(d.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}});d.prototype.isDestroyed=function(){return false};d.prototype.destroy=function(){this._viewModel.destroy();if(n.supportsPointerEvents()){document.removeEventListener("pointerdown",this._closeDropDown,true)}else{document.removeEventListener("mousedown",this._closeDropDown,true);document.removeEventListener("touchstart",this._closeDropDown,true)}a.cleanNode(this._wrapper);this._container.removeChild(this._wrapper);return r(this)};return d});define("Widgets/SelectionIndicator/SelectionIndicatorViewModel",["../../Core/Cartesian2","../../Core/defaultValue","../../Core/defined","../../Core/defineProperties","../../Core/DeveloperError","../../Core/EasingFunction","../../Scene/SceneTransforms","../../ThirdParty/knockout"],function(e,t,r,i,n,a,o,s){"use strict";var u=new e;var l="-1000px";function c(e,i,a){if(!r(e)){throw new n("scene is required.")}if(!r(i)){throw new n("selectionIndicatorElement is required.")}if(!r(a)){throw new n("container is required.")}this._scene=e;this._screenPositionX=l;this._screenPositionY=l;this._tweens=e.tweens;this._container=t(a,document.body);this._selectionIndicatorElement=i;this._scale=1;this.position=undefined;this.showSelection=false;s.track(this,["position","_screenPositionX","_screenPositionY","_scale","showSelection"]);this.isVisible=undefined;s.defineProperty(this,"isVisible",{get:function(){return this.showSelection&&r(this.position)}});s.defineProperty(this,"_transform",{get:function(){return"scale("+this._scale+")"}});this.computeScreenSpacePosition=function(t,r){return o.wgs84ToWindowCoordinates(e,t,r)}}c.prototype.update=function(){if(this.showSelection&&r(this.position)){var e=this.computeScreenSpacePosition(this.position,u);if(!r(e)){this._screenPositionX=l;this._screenPositionY=l}else{var t=this._container;var i=t.parentNode.clientWidth;var n=t.parentNode.clientHeight;var a=this._selectionIndicatorElement.clientWidth;var o=a*.5;e.x=Math.min(Math.max(e.x,-a),i+a)-o;e.y=Math.min(Math.max(e.y,-a),n+a)-o;this._screenPositionX=Math.floor(e.x+.25)+"px";this._screenPositionY=Math.floor(e.y+.25)+"px"}}};c.prototype.animateAppear=function(){this._tweens.addProperty({object:this,property:"_scale",startValue:2,stopValue:1,duration:.8,easingFunction:a.EXPONENTIAL_OUT})};c.prototype.animateDepart=function(){this._tweens.addProperty({object:this,property:"_scale",startValue:this._scale,stopValue:1.5,duration:.8,easingFunction:a.EXPONENTIAL_OUT})};i(c.prototype,{container:{get:function(){return this._container}},selectionIndicatorElement:{get:function(){return this._selectionIndicatorElement}},scene:{get:function(){return this._scene}}});return c});define("Widgets/SelectionIndicator/SelectionIndicator",["../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../ThirdParty/knockout","../getElement","./SelectionIndicatorViewModel"],function(e,t,r,i,n,a,o){"use strict";function s(t,r){if(!e(t)){throw new i("container is required.")}t=a(t);this._container=t;var s=document.createElement("div");s.className="cesium-selection-wrapper";s.setAttribute("data-bind",'style: { "top" : _screenPositionY, "left" : _screenPositionX },css: { "cesium-selection-wrapper-visible" : isVisible }');t.appendChild(s);this._element=s;var u="http://www.w3.org/2000/svg";var l="M -34 -34 L -34 -11.25 L -30 -15.25 L -30 -30 L -15.25 -30 L -11.25 -34 L -34 -34 z M 11.25 -34 L 15.25 -30 L 30 -30 L 30 -15.25 L 34 -11.25 L 34 -34 L 11.25 -34 z M -34 11.25 L -34 34 L -11.25 34 L -15.25 30 L -30 30 L -30 15.25 L -34 11.25 z M 34 11.25 L 30 15.25 L 30 30 L 15.25 30 L 11.25 34 L 34 34 L 34 11.25 z";var c=document.createElementNS(u,"svg:svg");c.setAttribute("width",160);c.setAttribute("height",160);c.setAttribute("viewBox","0 0 160 160");var d=document.createElementNS(u,"g");d.setAttribute("transform","translate(80,80)");c.appendChild(d);var f=document.createElementNS(u,"path");f.setAttribute("data-bind","attr: { transform: _transform }");f.setAttribute("d",l);d.appendChild(f);s.appendChild(c);var h=new o(r,this._element,this._container);this._viewModel=h;n.applyBindings(this._viewModel,this._element)}t(s.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}});s.prototype.isDestroyed=function(){return false};s.prototype.destroy=function(){var e=this._container;n.cleanNode(this._element);e.removeChild(this._element);return r(this)};return s});define("Widgets/Timeline/TimelineHighlightRange",["../../Core/defaultValue","../../Core/JulianDate"],function(e,t){"use strict";function r(t,r,i){this._color=t;this._height=r;this._base=e(i,0)}r.prototype.getHeight=function(){return this._height};r.prototype.getBase=function(){return this._base};r.prototype.getStartTime=function(){return this._start};r.prototype.getStopTime=function(){return this._stop};r.prototype.setRange=function(e,t){this._start=e;this._stop=t};r.prototype.render=function(e){var r="";if(this._start&&this._stop&&this._color){var i=t.secondsDifference(this._start,e.epochJulian);var n=Math.round(e.timeBarWidth*e.getAlpha(i));var a=t.secondsDifference(this._stop,e.epochJulian);var o=Math.round(e.timeBarWidth*e.getAlpha(a))-n;if(n<0){o+=n;n=0}if(n+o>e.timeBarWidth){o=e.timeBarWidth-n}if(o>0){r='<span class="cesium-timeline-highlight" style="left: '+n.toString()+"px; width: "+o.toString()+"px; bottom: "+this._base.toString()+"px; height: "+this._height+"px; background-color: "+this._color+';"></span>'}}return r};return r});define("Widgets/Timeline/TimelineTrack",["../../Core/Color","../../Core/defined","../../Core/JulianDate"],function(e,t,r){"use strict";function i(t,r,i,n){this.interval=t;this.height=r;this.color=i||new e(.5,.5,.5,1);this.backgroundColor=n||new e(0,0,0,0)}i.prototype.render=function(e,i){var n=this.interval.start;var a=this.interval.stop;var o=i.startJulian;var s=r.addSeconds(i.startJulian,i.duration,new r);if(r.lessThan(n,o)&&r.greaterThan(a,s)){e.fillStyle=this.color.toCssColorString();e.fillRect(0,i.y,i.timeBarWidth,this.height)}else if(r.lessThanOrEquals(n,s)&&r.greaterThanOrEquals(a,o)){var u;var l,c;for(u=0;u<i.timeBarWidth;++u){var d=r.addSeconds(i.startJulian,u/i.timeBarWidth*i.duration,new r);if(!t(l)&&r.greaterThanOrEquals(d,n)){l=u}else if(!t(c)&&r.greaterThanOrEquals(d,a)){c=u}}e.fillStyle=this.backgroundColor.toCssColorString();e.fillRect(0,i.y,i.timeBarWidth,this.height);if(t(l)){if(!t(c)){c=i.timeBarWidth}e.fillStyle=this.color.toCssColorString();e.fillRect(l,i.y,Math.max(c-l,1),this.height)}}};return i});define("Widgets/Timeline/Timeline",["../../Core/ClockRange","../../Core/defined","../../Core/destroyObject","../../Core/DeveloperError","../../Core/JulianDate","../getElement","./TimelineHighlightRange","./TimelineTrack"],function(e,t,r,i,n,a,o,s){"use strict";var u=1e12;var l={none:0,scrub:1,slide:2,zoom:3,touchOnly:4};var c={none:0,scrub:1,slideZoom:2,singleTap:3,ignore:4};var d=[.001,.002,.005,.01,.02,.05,.1,.25,.5,1,2,5,10,15,30,60,120,300,600,900,1800,3600,7200,14400,21600,43200,86400,172800,345600,604800,1296e3,2592e3,5184e3,7776e3,15552e3,31536e3,63072e3,126144e3,15768e4,31536e4,63072e4,126144e4,15768e5,31536e5,63072e5,126144e5,15768e6,31536e6];var f=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function h(e,r){if(!t(e)){throw new i("container is required.")}if(!t(r)){throw new i("clock is required.")}e=a(e);this.container=e;var n=document.createElement("div");n.className="cesium-timeline-main";e.appendChild(n);this._topDiv=n;this._endJulian=undefined;this._epochJulian=undefined;this._lastXPos=undefined;this._scrubElement=undefined;this._startJulian=undefined;this._timeBarSecondsSpan=undefined;this._clock=r;this._scrubJulian=r.currentTime;this._mainTicSpan=-1;this._mouseMode=l.none;this._touchMode=c.none;this._touchState={centerX:0,spanX:0};this._mouseX=0;this._timelineDrag=0;this._timelineDragLocation=undefined;this._lastHeight=undefined;this._lastWidth=undefined;this._topDiv.innerHTML='<div class="cesium-timeline-bar"></div><div class="cesium-timeline-trackContainer">'+'<canvas class="cesium-timeline-tracks" width="10" height="1">'+'</canvas></div><div class="cesium-timeline-needle"></div><span class="cesium-timeline-ruler"></span>';this._timeBarEle=this._topDiv.childNodes[0];this._trackContainer=this._topDiv.childNodes[1];this._trackListEle=this._topDiv.childNodes[1].childNodes[0];this._needleEle=this._topDiv.childNodes[2];this._rulerEle=this._topDiv.childNodes[3];this._context=this._trackListEle.getContext("2d");this._trackList=[];this._highlightRanges=[];this.zoomTo(r.startTime,r.stopTime);this._onMouseDown=m(this);this._onMouseUp=v(this);this._onMouseMove=_(this);this._onMouseWheel=g(this);this._onTouchStart=y(this);this._onTouchMove=C(this);this._onTouchEnd=w(this);var o=this._timeBarEle;document.addEventListener("mouseup",this._onMouseUp,false);document.addEventListener("mousemove",this._onMouseMove,false);o.addEventListener("mousedown",this._onMouseDown,false);o.addEventListener("DOMMouseScroll",this._onMouseWheel,false);o.addEventListener("mousewheel",this._onMouseWheel,false);o.addEventListener("touchstart",this._onTouchStart,false);o.addEventListener("touchmove",this._onTouchMove,false);o.addEventListener("touchend",this._onTouchEnd,false);o.addEventListener("touchcancel",this._onTouchEnd,false);this._topDiv.oncontextmenu=function(){return false};r.onTick.addEventListener(this.updateFromClock,this);this.updateFromClock()}h.prototype.addEventListener=function(e,t,r){this._topDiv.addEventListener(e,t,r)};h.prototype.removeEventListener=function(e,t,r){this._topDiv.removeEventListener(e,t,r)};h.prototype.isDestroyed=function(){return false};h.prototype.destroy=function(){this._clock.onTick.removeEventListener(this.updateFromClock,this);document.removeEventListener("mouseup",this._onMouseUp,false);document.removeEventListener("mousemove",this._onMouseMove,false);var e=this._timeBarEle;e.removeEventListener("mousedown",this._onMouseDown,false);e.removeEventListener("DOMMouseScroll",this._onMouseWheel,false);e.removeEventListener("mousewheel",this._onMouseWheel,false);e.removeEventListener("touchstart",this._onTouchStart,false);e.removeEventListener("touchmove",this._onTouchMove,false);e.removeEventListener("touchend",this._onTouchEnd,false);e.removeEventListener("touchcancel",this._onTouchEnd,false);this.container.removeChild(this._topDiv);r(this)};h.prototype.addHighlightRange=function(e,t,r){var i=new o(e,t,r);this._highlightRanges.push(i);this.resize();return i};h.prototype.addTrack=function(e,t,r,i){var n=new s(e,t,r,i);this._trackList.push(n);this._lastHeight=undefined;this.resize();return n};h.prototype.zoomTo=function(r,a){if(!t(r)){throw new i("startTime is required.")}if(!t(a)){throw new i("stopTime is required")}if(n.lessThanOrEquals(a,r)){throw new i("Start time must come before end time.")}this._startJulian=r;this._endJulian=a;this._timeBarSecondsSpan=n.secondsDifference(a,r);if(this._clock&&this._clock.clockRange!==e.UNBOUNDED){var o=this._clock.startTime;var s=this._clock.stopTime;var u=n.secondsDifference(s,o);var l=n.secondsDifference(o,this._startJulian);var c=n.secondsDifference(s,this._endJulian);if(this._timeBarSecondsSpan>=u){this._timeBarSecondsSpan=u;this._startJulian=this._clock.startTime;this._endJulian=this._clock.stopTime}else if(l>0){this._endJulian=n.addSeconds(this._endJulian,l,new n);this._startJulian=o;this._timeBarSecondsSpan=n.secondsDifference(this._endJulian,this._startJulian)}else if(c<0){this._startJulian=n.addSeconds(this._startJulian,c,new n);this._endJulian=s;this._timeBarSecondsSpan=n.secondsDifference(this._endJulian,this._startJulian)}}this._makeTics();var d=document.createEvent("Event");d.initEvent("setzoom",true,true);d.startJulian=this._startJulian;d.endJulian=this._endJulian;d.epochJulian=this._epochJulian;d.totalSpan=this._timeBarSecondsSpan;d.mainTicSpan=this._mainTicSpan;this._topDiv.dispatchEvent(d)};h.prototype.zoomFrom=function(e){var t=n.secondsDifference(this._scrubJulian,this._startJulian);if(e>1||t<0||t>this._timeBarSecondsSpan){t=this._timeBarSecondsSpan*.5}else{t+=t-this._timeBarSecondsSpan*.5}var r=this._timeBarSecondsSpan-t;this.zoomTo(n.addSeconds(this._startJulian,t-t*e,new n),n.addSeconds(this._endJulian,r*e-r,new n))};function p(e){return e<10?"0"+e.toString():e.toString()}h.prototype.makeLabel=function(e){var t=n.toGregorianDate(e);var r=t.millisecond,i=" UTC";if(r>0&&this._timeBarSecondsSpan<3600){i=Math.floor(r).toString();while(i.length<3){i="0"+i}i="."+i}return f[t.month-1]+" "+t.day+" "+t.year+" "+p(t.hour)+":"+p(t.minute)+":"+p(t.second)+i};h.prototype.smallestTicInPixels=7;h.prototype._makeTics=function(){var e=this._timeBarEle;var t=n.secondsDifference(this._scrubJulian,this._startJulian);var r=Math.round(t*this._topDiv.clientWidth/this._timeBarSecondsSpan);var i=r-8,a;var o=this;this._needleEle.style.left=r.toString()+"px";var s="";var u=.01;var l=31536e6;var c=1e-10;var f=0;var h=this._timeBarSecondsSpan;if(h<u){h=u;this._timeBarSecondsSpan=u;this._endJulian=n.addSeconds(this._startJulian,u,new n)}else if(h>l){h=l;this._timeBarSecondsSpan=l;this._endJulian=n.addSeconds(this._startJulian,l,new n)}var p=this._timeBarEle.clientWidth;if(p<10){p=10}var m=this._startJulian;var v=Math.min(h/p*1e-5,.4);var _;var g=n.toGregorianDate(m);if(h>31536e4){_=n.fromDate(new Date(Date.UTC(Math.floor(g.year/100)*100,0)))}else if(h>31536e3){_=n.fromDate(new Date(Date.UTC(Math.floor(g.year/10)*10,0)))}else if(h>86400){_=n.fromDate(new Date(Date.UTC(g.year,0)))}else{_=n.fromDate(new Date(Date.UTC(g.year,g.month,g.day)))}var y=n.secondsDifference(this._startJulian,n.addSeconds(_,v,new n));var w=y+h;this._epochJulian=_;function C(e){return Math.floor(y/e)*e}function b(e,t){return Math.ceil(e/t+.5)*t}function S(e){return(e-y)/h}function E(e,t){return e-t*Math.round(e/t)}this._rulerEle.innerHTML=this.makeLabel(n.addSeconds(this._endJulian,-u,new n));var T=this._rulerEle.offsetWidth+20;if(T<30){T=180}var x=f;f-=c;var A={startTime:y,startJulian:m,epochJulian:_,duration:h,timeBarWidth:p,getAlpha:S};this._highlightRanges.forEach(function(e){s+=e.render(A)});var P=0,D=0,M=0;var I=T/p;if(I>1){I=1}I*=this._timeBarSecondsSpan;var O=-1,R=-1;var N,L=d.length;for(N=0;N<L;++N){var B=d[N];++O;P=B;if(B>I&&B>f){break}if(R<0&&p*(B/this._timeBarSecondsSpan)>=this.smallestTicInPixels){R=O}}if(O>0){while(O>0){--O;if(Math.abs(E(P,d[O]))<1e-5){if(d[O]>=f){D=d[O]}break}}if(R>=0){while(R<O){if(Math.abs(E(D,d[R]))<1e-5&&d[R]>=f){M=d[R];break}++R}}}f=x;if(f>c&&M<1e-5&&Math.abs(f-P)>c){M=f;if(f<=P+c){D=0}}var F=-999999,k;if(p*(M/this._timeBarSecondsSpan)>=3){for(a=C(M);a<=w;a=b(a,M)){s+='<span class="cesium-timeline-ticTiny" style="left: '+Math.round(p*S(a)).toString()+'px;"></span>'}}if(p*(D/this._timeBarSecondsSpan)>=3){for(a=C(D);a<=w;a=b(a,D)){s+='<span class="cesium-timeline-ticSub" style="left: '+Math.round(p*S(a)).toString()+'px;"></span>'}}if(p*(P/this._timeBarSecondsSpan)>=2){this._mainTicSpan=P;w+=P;a=C(P);var V=n.computeTaiMinusUtc(_);while(a<=w){var z=n.addSeconds(m,a-y,new n);if(P>2.1){var U=n.computeTaiMinusUtc(z);if(Math.abs(U-V)>.1){a+=U-V;z=n.addSeconds(m,a-y,new n)}}var q=Math.round(p*S(a));var G=this.makeLabel(z);this._rulerEle.innerHTML=G;k=this._rulerEle.offsetWidth;if(k<10){k=T}var H=q-(k/2-1);if(H>F){F=H+k+5
;s+='<span class="cesium-timeline-ticMain" style="left: '+q.toString()+'px;"></span>'+'<span class="cesium-timeline-ticLabel" style="left: '+H.toString()+'px;">'+G+"</span>"}else{s+='<span class="cesium-timeline-ticSub" style="left: '+q.toString()+'px;"></span>'}a=b(a,P)}}else{this._mainTicSpan=-1}s+='<span class="cesium-timeline-icon16" style="left:'+i+'px;bottom:0;background-position: 0 0;"></span>';e.innerHTML=s;this._scrubElement=e.lastChild;this._context.clearRect(0,0,this._trackListEle.width,this._trackListEle.height);A.y=0;this._trackList.forEach(function(e){e.render(o._context,A);A.y+=e.height})};h.prototype.updateFromClock=function(){this._scrubJulian=this._clock.currentTime;var e=this._scrubElement;if(t(this._scrubElement)){var r=n.secondsDifference(this._scrubJulian,this._startJulian);var i=Math.round(r*this._topDiv.clientWidth/this._timeBarSecondsSpan);if(this._lastXPos!==i){this._lastXPos=i;e.style.left=i-8+"px";this._needleEle.style.left=i+"px"}}if(t(this._timelineDragLocation)){this._setTimeBarTime(this._timelineDragLocation,this._timelineDragLocation*this._timeBarSecondsSpan/this._topDiv.clientWidth);this.zoomTo(n.addSeconds(this._startJulian,this._timelineDrag,new n),n.addSeconds(this._endJulian,this._timelineDrag,new n))}};h.prototype._setTimeBarTime=function(e,t){e=Math.round(e);this._scrubJulian=n.addSeconds(this._startJulian,t,new n);if(this._scrubElement){var r=e-8;this._scrubElement.style.left=r.toString()+"px";this._needleEle.style.left=e.toString()+"px"}var i=document.createEvent("Event");i.initEvent("settime",true,true);i.clientX=e;i.timeSeconds=t;i.timeJulian=this._scrubJulian;i.clock=this._clock;this._topDiv.dispatchEvent(i)};function m(e){return function(t){if(e._mouseMode!==l.touchOnly){if(t.button===0){e._mouseMode=l.scrub;if(e._scrubElement){e._scrubElement.style.backgroundPosition="-16px 0"}e._onMouseMove(t)}else{e._mouseX=t.clientX;if(t.button===2){e._mouseMode=l.zoom}else{e._mouseMode=l.slide}}}t.preventDefault()}}function v(e){return function(t){e._mouseMode=l.none;if(e._scrubElement){e._scrubElement.style.backgroundPosition="0 0"}e._timelineDrag=0;e._timelineDragLocation=undefined}}function _(e){return function(t){var r;if(e._mouseMode===l.scrub){t.preventDefault();var i=t.clientX-e._topDiv.getBoundingClientRect().left;if(i<0){e._timelineDragLocation=0;e._timelineDrag=-.01*e._timeBarSecondsSpan}else if(i>e._topDiv.clientWidth){e._timelineDragLocation=e._topDiv.clientWidth;e._timelineDrag=.01*e._timeBarSecondsSpan}else{e._timelineDragLocation=undefined;e._setTimeBarTime(i,i*e._timeBarSecondsSpan/e._topDiv.clientWidth)}}else if(e._mouseMode===l.slide){r=e._mouseX-t.clientX;e._mouseX=t.clientX;if(r!==0){var a=r*e._timeBarSecondsSpan/e._topDiv.clientWidth;e.zoomTo(n.addSeconds(e._startJulian,a,new n),n.addSeconds(e._endJulian,a,new n))}}else if(e._mouseMode===l.zoom){r=e._mouseX-t.clientX;e._mouseX=t.clientX;if(r!==0){e.zoomFrom(Math.pow(1.01,r))}}}}function g(e){return function(t){var r=t.wheelDeltaY||t.wheelDelta||-t.detail;u=Math.max(Math.min(Math.abs(r),u),1);r/=u;e.zoomFrom(Math.pow(1.05,-r))}}function y(e){return function(t){var r=t.touches.length,i,a,o=e._topDiv.getBoundingClientRect().left;t.preventDefault();e._mouseMode=l.touchOnly;if(r===1){i=n.secondsDifference(e._scrubJulian,e._startJulian);a=Math.round(i*e._topDiv.clientWidth/e._timeBarSecondsSpan+o);if(Math.abs(t.touches[0].clientX-a)<50){e._touchMode=c.scrub;if(e._scrubElement){e._scrubElement.style.backgroundPosition=r===1?"-16px 0":"0 0"}}else{e._touchMode=c.singleTap;e._touchState.centerX=t.touches[0].clientX-o}}else if(r===2){e._touchMode=c.slideZoom;e._touchState.centerX=(t.touches[0].clientX+t.touches[1].clientX)*.5-o;e._touchState.spanX=Math.abs(t.touches[0].clientX-t.touches[1].clientX)}else{e._touchMode=c.ignore}}}function w(e){return function(t){var r=t.touches.length,i=e._topDiv.getBoundingClientRect().left;if(e._touchMode===c.singleTap){e._touchMode=c.scrub;e._onTouchMove(t)}else if(e._touchMode===c.scrub){e._onTouchMove(t)}e._mouseMode=l.touchOnly;if(r!==1){e._touchMode=r>0?c.ignore:c.none}else if(e._touchMode===c.slideZoom){e._touchState.centerX=t.touches[0].clientX-i}if(e._scrubElement){e._scrubElement.style.backgroundPosition="0 0"}}}function C(e){return function(r){var i,a,o,s,u,d,f=1,h=e._topDiv.getBoundingClientRect().left;if(e._touchMode===c.singleTap){e._touchMode=c.slideZoom}e._mouseMode=l.touchOnly;if(e._touchMode===c.scrub){r.preventDefault();if(r.changedTouches.length===1){a=r.changedTouches[0].clientX-h;if(a>=0&&a<=e._topDiv.clientWidth){e._setTimeBarTime(a,a*e._timeBarSecondsSpan/e._topDiv.clientWidth)}}}else if(e._touchMode===c.slideZoom){o=r.touches.length;if(o===2){s=(r.touches[0].clientX+r.touches[1].clientX)*.5-h;u=Math.abs(r.touches[0].clientX-r.touches[1].clientX)}else if(o===1){s=r.touches[0].clientX-h;u=0}if(t(s)){if(u>0&&e._touchState.spanX>0){f=e._touchState.spanX/u;d=n.addSeconds(e._startJulian,(e._touchState.centerX*e._timeBarSecondsSpan-s*e._timeBarSecondsSpan*f)/e._topDiv.clientWidth,new n)}else{i=e._touchState.centerX-s;d=n.addSeconds(e._startJulian,i*e._timeBarSecondsSpan/e._topDiv.clientWidth,new n)}e.zoomTo(d,n.addSeconds(d,e._timeBarSecondsSpan*f,new n));e._touchState.centerX=s;e._touchState.spanX=u}}}}h.prototype.resize=function(){var e=this.container.clientWidth;var t=this.container.clientHeight;if(e===this._lastWidth&&t===this._lastHeight){return}this._trackContainer.style.height=t+"px";var r=1;this._trackList.forEach(function(e){r+=e.height});this._trackListEle.style.height=r.toString()+"px";this._trackListEle.width=this._trackListEle.clientWidth;this._trackListEle.height=r;this._makeTics();this._lastXPos=undefined;this._lastWidth=e;this._lastHeight=t};return h});define("Widgets/VRButton/VRButtonViewModel",["../../Core/defaultValue","../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../Core/EventHelper","../../Core/Fullscreen","../../Scene/OrthographicFrustum","../../ThirdParty/knockout","../../ThirdParty/NoSleep","../createCommand","../getElement"],function(e,t,r,i,n,a,o,s,u,l,c,d){"use strict";function f(e){var r=false;var i=window.screen;if(t(i)){if(t(i.lockOrientation)){r=i.lockOrientation(e)}else if(t(i.mozLockOrientation)){r=i.mozLockOrientation(e)}else if(t(i.msLockOrientation)){r=i.msLockOrientation(e)}else if(t(i.orientation&&i.orientation.lock)){r=i.orientation.lock(e)}}return r}function h(){var e=window.screen;if(t(e)){if(t(e.unlockOrientation)){e.unlockOrientation()}else if(t(e.mozUnlockOrientation)){e.mozUnlockOrientation()}else if(t(e.msUnlockOrientation)){e.msUnlockOrientation()}else if(t(e.orientation&&e.orientation.unlock)){e.orientation.unlock()}}}function p(e,t,r,i){if(i()){return}if(r()){t.useWebVR=false;if(e._locked){h();e._locked=false}e._noSleep.disable();o.exitFullscreen();r(false)}else{if(!o.fullscreen){o.requestFullscreen(e._vrElement)}e._noSleep.enable();if(!e._locked){e._locked=f("landscape")}t.useWebVR=true;r(true)}}function m(r,i){if(!t(r)){throw new n("scene is required.")}var f=this;var m=u.observable(o.enabled);var v=u.observable(false);this.isVRMode=undefined;u.defineProperty(this,"isVRMode",{get:function(){return v()}});this.isVREnabled=undefined;u.defineProperty(this,"isVREnabled",{get:function(){return m()},set:function(e){m(e&&o.enabled)}});this.tooltip=undefined;u.defineProperty(this,"tooltip",function(){if(!m()){return"VR mode is unavailable"}return v()?"Exit VR mode":"Enter VR mode"});var _=u.observable(false);this._isOrthographic=undefined;u.defineProperty(this,"_isOrthographic",{get:function(){return _()}});this._eventHelper=new a;this._eventHelper.add(r.preRender,function(){_(r.camera.frustum instanceof s)});this._locked=false;this._noSleep=new l;this._command=c(function(){p(f,r,v,_)},u.getObservable(this,"isVREnabled"));this._vrElement=e(d(i),document.body);this._callback=function(){if(!o.fullscreen&&v()){r.useWebVR=false;if(f._locked){h();f._locked=false}f._noSleep.disable();v(false)}};document.addEventListener(o.changeEventName,this._callback)}r(m.prototype,{vrElement:{get:function(){return this._vrElement},set:function(e){if(!(e instanceof Element)){throw new n("value must be a valid Element.")}this._vrElement=e}},command:{get:function(){return this._command}}});m.prototype.isDestroyed=function(){return false};m.prototype.destroy=function(){this._eventHelper.removeAll();document.removeEventListener(o.changeEventName,this._callback);i(this)};return m});define("Widgets/VRButton/VRButton",["../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../ThirdParty/knockout","../getElement","./VRButtonViewModel"],function(e,t,r,i,n,a,o){"use strict";var s="M 5.3125 6.375 C 4.008126 6.375 2.96875 7.4141499 2.96875 8.71875 L 2.96875 19.5 C 2.96875 20.8043 4.008126 21.875 5.3125 21.875 L 13.65625 21.875 C 13.71832 20.0547 14.845166 18.59375 16.21875 18.59375 C 17.592088 18.59375 18.71881 20.0552 18.78125 21.875 L 27.09375 21.875 C 28.398125 21.875 29.4375 20.8043 29.4375 19.5 L 29.4375 8.71875 C 29.4375 7.4141499 28.398125 6.375 27.09375 6.375 L 5.3125 6.375 z M 9.625 10.4375 C 11.55989 10.4375 13.125 12.03385 13.125 13.96875 C 13.125 15.90365 11.55989 17.46875 9.625 17.46875 C 7.69011 17.46875 6.125 15.90365 6.125 13.96875 C 6.125 12.03385 7.69011 10.4375 9.625 10.4375 z M 22.46875 10.4375 C 24.40364 10.4375 25.96875 12.03385 25.96875 13.96875 C 25.96875 15.90365 24.40364 17.46875 22.46875 17.46875 C 20.53386 17.46875 18.96875 15.90365 18.96875 13.96875 C 18.96875 12.03385 20.53386 10.4375 22.46875 10.4375 z";var u="M 25.770585,2.4552065 C 15.72282,13.962707 10.699956,19.704407 8.1768352,22.580207 c -1.261561,1.4379 -1.902282,2.1427 -2.21875,2.5 -0.141624,0.1599 -0.208984,0.2355 -0.25,0.2813 l 0.6875,0.75 c 10e-5,-10e-5 0.679191,0.727 0.6875,0.7187 0.01662,-0.016 0.02451,-0.024 0.03125,-0.031 0.01348,-0.014 0.04013,-0.038 0.0625,-0.062 0.04474,-0.05 0.120921,-0.1315 0.28125,-0.3126 0.320657,-0.3619 0.956139,-1.0921 2.2187499,-2.5312 2.5252219,-2.8781 7.5454589,-8.6169 17.5937499,-20.1250005 l -1.5,-1.3125 z m -20.5624998,3.9063 c -1.304375,0 -2.34375,1.0391 -2.34375,2.3437 l 0,10.8125005 c 0,1.3043 1.039375,2.375 2.34375,2.375 l 2.25,0 c 1.9518039,-2.2246 7.4710958,-8.5584 13.5624998,-15.5312005 l -15.8124998,0 z m 21.1249998,0 c -1.855467,2.1245 -2.114296,2.4005 -3.59375,4.0936995 1.767282,0.1815 3.15625,1.685301 3.15625,3.500001 0,1.9349 -1.56511,3.5 -3.5,3.5 -1.658043,0 -3.043426,-1.1411 -3.40625,-2.6875 -1.089617,1.2461 -2.647139,2.9988 -3.46875,3.9375 0.191501,-0.062 0.388502,-0.094 0.59375,-0.094 1.373338,0 2.50006,1.4614 2.5625,3.2812 l 8.3125,0 c 1.304375,0 2.34375,-1.0707 2.34375,-2.375 l 0,-10.8125005 c 0,-1.3046 -1.039375,-2.3437 -2.34375,-2.3437 l -0.65625,0 z M 9.5518351,10.423906 c 1.9348899,0 3.4999999,1.596401 3.4999999,3.531301 0,1.9349 -1.56511,3.5 -3.4999999,3.5 -1.9348899,0 -3.4999999,-1.5651 -3.4999999,-3.5 0,-1.9349 1.56511,-3.531301 3.4999999,-3.531301 z m 4.2187499,10.312601 c -0.206517,0.2356 -0.844218,0.9428 -1.03125,1.1562 l 0.8125,0 c 0.01392,-0.4081 0.107026,-0.7968 0.21875,-1.1562 z";function l(t,r,l){if(!e(t)){throw new i("container is required.")}if(!e(r)){throw new i("scene is required.")}t=a(t);var c=new o(r,l);c._exitVRPath=u;c._enterVRPath=s;var d=document.createElement("button");d.type="button";d.className="cesium-button cesium-vrButton";d.setAttribute("data-bind",'css: { "cesium-button-disabled" : _isOrthographic }, attr: { title: tooltip },click: command,enable: isVREnabled,cesiumSvgPath: { path: isVRMode ? _exitVRPath : _enterVRPath, width: 32, height: 32 }');t.appendChild(d);n.applyBindings(c,d);this._container=t;this._viewModel=c;this._element=d}t(l.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}});l.prototype.isDestroyed=function(){return false};l.prototype.destroy=function(){this._viewModel.destroy();n.cleanNode(this._element);this._container.removeChild(this._element);return r(this)};return l});define("Widgets/Viewer/Viewer",["../../Core/BoundingSphere","../../Core/Cartesian3","../../Core/defaultValue","../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../Core/Event","../../Core/EventHelper","../../Core/isArray","../../Core/Matrix4","../../Core/Rectangle","../../Core/ScreenSpaceEventType","../../DataSources/BoundingSphereState","../../DataSources/ConstantPositionProperty","../../DataSources/DataSourceCollection","../../DataSources/DataSourceDisplay","../../DataSources/Entity","../../DataSources/EntityView","../../DataSources/Property","../../Scene/ImageryLayer","../../Scene/SceneMode","../../ThirdParty/knockout","../../ThirdParty/when","../Animation/Animation","../Animation/AnimationViewModel","../BaseLayerPicker/BaseLayerPicker","../BaseLayerPicker/createDefaultImageryProviderViewModels","../BaseLayerPicker/createDefaultTerrainProviderViewModels","../CesiumWidget/CesiumWidget","../ClockViewModel","../FullscreenButton/FullscreenButton","../Geocoder/Geocoder","../getElement","../HomeButton/HomeButton","../InfoBox/InfoBox","../NavigationHelpButton/NavigationHelpButton","../ProjectionPicker/ProjectionPicker","../SceneModePicker/SceneModePicker","../SelectionIndicator/SelectionIndicator","../subscribeAndEvaluate","../Timeline/Timeline","../VRButton/VRButton"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w,C,b,S,E,T,x,A,P,D,M,I,O,R,N,L,B,F,k,V,z,U,q){"use strict";var G=new e;function H(e){var t=e.clock;t.currentTime=e.timeJulian;t.shouldAnimate=false}function W(e,t){var n=e.scene.pick(t.position);if(i(n)){var a=r(n.id,n.primitive.id);if(a instanceof _){return a}}if(i(e.scene.globe)){return X(e,t.position)}}function j(e,t,r){if(i(r)){var n=r.clock;if(i(n)){n.getValue(t);if(i(e)){e.updateFromClock();e.zoomTo(n.startTime,n.stopTime)}}}}var Y=new t;function X(e,t){var r=e.scene;var n=r.camera.getPickRay(t);var a=r.imageryLayers.pickImageryLayerFeatures(n,r);if(!i(a)){return}var o=new _({id:"Loading...",description:"Loading feature information..."});S(a,function(t){if(e.selectedEntity!==o){return}if(!i(t)||t.length===0){e.selectedEntity=Z();return}var r=t[0];var n=new _({id:r.name,description:r.description});if(i(r.position)){var a=e.scene.globe.ellipsoid.cartographicToCartesian(r.position,Y);n.position=new p(a)}e.selectedEntity=n},function(){if(e.selectedEntity!==o){return}e.selectedEntity=Z()});return o}function Z(){return new _({id:"None",description:"No features found."})}function K(e,t){var r=e._geocoder;var n=e._homeButton;var a=e._sceneModePicker;var o=e._projectionPicker;var s=e._baseLayerPicker;var u=e._animation;var l=e._timeline;var c=e._fullscreenButton;var d=e._infoBox;var f=e._selectionIndicator;var h=t?"hidden":"visible";if(i(r)){r.container.style.visibility=h}if(i(n)){n.container.style.visibility=h}if(i(a)){a.container.style.visibility=h}if(i(o)){o.container.style.visibility=h}if(i(s)){s.container.style.visibility=h}if(i(u)){u.container.style.visibility=h}if(i(l)){l.container.style.visibility=h}if(i(c)&&c.viewModel.isFullscreenEnabled){c.container.style.visibility=h}if(i(d)){d.container.style.visibility=h}if(i(f)){f.container.style.visibility=h}if(e._container){var p=t||!i(c)?0:c.container.clientWidth;e._vrButton.container.style.right=p+"px";e.forceResize()}}function Q(e,t){if(!i(e)){throw new o("container is required.")}e=R(e);t=r(t,r.EMPTY_OBJECT);var n=(!i(t.globe)||t.globe!==false)&&(!i(t.baseLayerPicker)||t.baseLayerPicker!==false);if(n&&i(t.imageryProvider)){throw new o("options.imageryProvider is not available when using the BaseLayerPicker widget. Either specify options.selectedImageryProviderViewModel instead or set options.baseLayerPicker to false.")}if(!n&&i(t.selectedImageryProviderViewModel)){throw new o("options.selectedImageryProviderViewModel is not available when not using the BaseLayerPicker widget. Either specify options.imageryProvider instead or set options.baseLayerPicker to true.")}if(n&&i(t.terrainProvider)){throw new o("options.terrainProvider is not available when using the BaseLayerPicker widget. Either specify options.selectedTerrainProviderViewModel instead or set options.baseLayerPicker to false.")}if(!n&&i(t.selectedTerrainProviderViewModel)){throw new o("options.selectedTerrainProviderViewModel is not available when not using the BaseLayerPicker widget. Either specify options.terrainProvider instead or set options.baseLayerPicker to true.")}var a=this;var c=document.createElement("div");c.className="cesium-viewer";e.appendChild(c);var d=document.createElement("div");d.className="cesium-viewer-cesiumWidgetContainer";c.appendChild(d);var h=document.createElement("div");h.className="cesium-viewer-bottom";c.appendChild(h);var p=r(t.scene3DOnly,false);var _=new D(d,{terrainProvider:t.terrainProvider,imageryProvider:n?false:t.imageryProvider,clock:t.clock,skyBox:t.skyBox,skyAtmosphere:t.skyAtmosphere,sceneMode:t.sceneMode,mapProjection:t.mapProjection,globe:t.globe,orderIndependentTranslucency:t.orderIndependentTranslucency,contextOptions:t.contextOptions,useDefaultRenderLoop:t.useDefaultRenderLoop,targetFrameRate:t.targetFrameRate,showRenderLoopErrors:t.showRenderLoopErrors,creditContainer:i(t.creditContainer)?t.creditContainer:h,scene3DOnly:p,terrainExaggeration:t.terrainExaggeration,shadows:t.shadows,terrainShadows:t.terrainShadows,mapMode2D:t.mapMode2D});var g=t.dataSources;var w=false;if(!i(g)){g=new m;w=true}var C=new v({scene:_.scene,dataSourceCollection:g});var S=_.clock;var G=new M(S);var j=new u;j.add(S.onTick,Q.prototype._onTick,this);j.add(_.scene.morphStart,Q.prototype._clearTrackedObject,this);var Y;if(!i(t.selectionIndicator)||t.selectionIndicator!==false){var X=document.createElement("div");X.className="cesium-viewer-selectionIndicatorContainer";c.appendChild(X);Y=new V(X,_.scene)}var Z;if(!i(t.infoBox)||t.infoBox!==false){var J=document.createElement("div");J.className="cesium-viewer-infoBoxContainer";c.appendChild(J);Z=new L(J);var $=Z.viewModel;j.add($.cameraClicked,Q.prototype._onInfoBoxCameraClicked,this);j.add($.closeClicked,Q.prototype._onInfoBoxClockClicked,this)}var ee=document.createElement("div");ee.className="cesium-viewer-toolbar";c.appendChild(ee);var te;if(!i(t.geocoder)||t.geocoder!==false){var re=document.createElement("div");re.className="cesium-viewer-geocoderContainer";ee.appendChild(re);te=new O({container:re,geocoderServices:i(t.geocoder)?l(t.geocoder)?t.geocoder:[t.geocoder]:undefined,scene:_.scene});j.add(te.viewModel.search.beforeExecute,Q.prototype._clearObjects,this)}var ie;if(!i(t.homeButton)||t.homeButton!==false){ie=new N(ee,_.scene);if(i(te)){j.add(ie.viewModel.command.afterExecute,function(){var e=te.viewModel;e.searchText="";if(e.isSearchInProgress){e.search()}})}j.add(ie.viewModel.command.beforeExecute,Q.prototype._clearTrackedObject,this)}if(t.sceneModePicker===true&&p){throw new o("options.sceneModePicker is not available when options.scene3DOnly is set to true.")}var ne;if(!p&&(!i(t.sceneModePicker)||t.sceneModePicker!==false)){ne=new k(ee,_.scene)}var ae;if(t.projectionPicker){ae=new F(ee,_.scene)}var oe;var se;if(n){var ue=r(t.imageryProviderViewModels,A());var le=r(t.terrainProviderViewModels,P());oe=new x(ee,{globe:_.scene.globe,imageryProviderViewModels:ue,selectedImageryProviderViewModel:t.selectedImageryProviderViewModel,terrainProviderViewModels:le,selectedTerrainProviderViewModel:t.selectedTerrainProviderViewModel});var ce=ee.getElementsByClassName("cesium-baseLayerPicker-dropDown");se=ce[0]}var de;if(!i(t.navigationHelpButton)||t.navigationHelpButton!==false){var fe=true;try{if(i(window.localStorage)){var he=window.localStorage.getItem("cesium-hasSeenNavHelp");if(i(he)&&Boolean(he)){fe=false}else{window.localStorage.setItem("cesium-hasSeenNavHelp","true")}}}catch(e){}de=new B({container:ee,instructionsInitiallyVisible:r(t.navigationInstructionsInitiallyVisible,fe)})}var pe;if(!i(t.animation)||t.animation!==false){var me=document.createElement("div");me.className="cesium-viewer-animationContainer";c.appendChild(me);pe=new E(me,new T(G))}var ve;if(!i(t.timeline)||t.timeline!==false){var _e=document.createElement("div");_e.className="cesium-viewer-timelineContainer";c.appendChild(_e);ve=new U(_e,S);ve.addEventListener("settime",H,false);ve.zoomTo(S.startTime,S.stopTime)}var ge;var ye;if(!i(t.fullscreenButton)||t.fullscreenButton!==false){var we=document.createElement("div");we.className="cesium-viewer-fullscreenContainer";c.appendChild(we);ge=new I(we,t.fullscreenElement);ye=z(ge.viewModel,"isFullscreenEnabled",function(e){we.style.display=e?"block":"none";if(i(ve)){ve.container.style.right=we.clientWidth+"px";ve.resize()}})}var Ce;var be;var Se;if(t.vrButton){var Ee=document.createElement("div");Ee.className="cesium-viewer-vrContainer";c.appendChild(Ee);Ce=new q(Ee,_.scene,t.fullScreenElement);be=z(Ce.viewModel,"isVREnabled",function(e){Ee.style.display=e?"block":"none";if(i(ge)){Ee.style.right=we.clientWidth+"px"}if(i(ve)){ve.container.style.right=Ee.clientWidth+"px";ve.resize()}});Se=z(Ce.viewModel,"isVRMode",function(e){K(a,e)})}this._baseLayerPickerDropDown=se;this._fullscreenSubscription=ye;this._vrSubscription=be;this._vrModeSubscription=Se;this._dataSourceChangedListeners={};this._automaticallyTrackDataSourceClocks=r(t.automaticallyTrackDataSourceClocks,true);this._container=e;this._bottomContainer=h;this._element=c;this._cesiumWidget=_;this._selectionIndicator=Y;this._infoBox=Z;this._dataSourceCollection=g;this._destroyDataSourceCollection=w;this._dataSourceDisplay=C;this._clockViewModel=G;this._toolbar=ee;this._homeButton=ie;this._sceneModePicker=ne;this._projectionPicker=ae;this._baseLayerPicker=oe;this._navigationHelpButton=de;this._animation=pe;this._timeline=ve;this._fullscreenButton=ge;this._vrButton=Ce;this._geocoder=te;this._eventHelper=j;this._lastWidth=0;this._lastHeight=0;this._allowDataSourcesToSuspendAnimation=true;this._entityView=undefined;this._enableInfoOrSelection=i(Z)||i(Y);this._clockTrackedDataSource=undefined;this._trackedEntity=undefined;this._needTrackedEntityUpdate=false;this._selectedEntity=undefined;this._clockTrackedDataSource=undefined;this._forceResize=false;this._zoomIsFlight=false;this._zoomTarget=undefined;this._zoomPromise=undefined;this._zoomOptions=undefined;this._selectedEntityChanged=new s;this._trackedEntityChanged=new s;b.track(this,["_trackedEntity","_selectedEntity","_clockTrackedDataSource"]);j.add(g.dataSourceAdded,Q.prototype._onDataSourceAdded,this);j.add(g.dataSourceRemoved,Q.prototype._onDataSourceRemoved,this);j.add(_.scene.preRender,Q.prototype.resize,this);j.add(_.scene.postRender,Q.prototype._postRender,this);var Te=g.length;for(var xe=0;xe<Te;xe++){this._dataSourceAdded(g,g.get(xe))}this._dataSourceAdded(undefined,C.defaultDataSource);j.add(g.dataSourceAdded,Q.prototype._dataSourceAdded,this);j.add(g.dataSourceRemoved,Q.prototype._dataSourceRemoved,this);function Ae(e){var t=W(a,e);if(i(t)){if(y.getValueOrUndefined(t.position,a.clock.currentTime)){a.trackedEntity=t}else{a.zoomTo(t)}}}function Pe(e){a.selectedEntity=W(a,e)}_.screenSpaceEventHandler.setInputAction(Pe,f.LEFT_CLICK);_.screenSpaceEventHandler.setInputAction(Ae,f.LEFT_DOUBLE_CLICK)}n(Q.prototype,{container:{get:function(){return this._container}},bottomContainer:{get:function(){return this._bottomContainer}},cesiumWidget:{get:function(){return this._cesiumWidget}},selectionIndicator:{get:function(){return this._selectionIndicator}},infoBox:{get:function(){return this._infoBox}},geocoder:{get:function(){return this._geocoder}},homeButton:{get:function(){return this._homeButton}},sceneModePicker:{get:function(){return this._sceneModePicker}},projectionPicker:{get:function(){return this._projectionPicker}},baseLayerPicker:{get:function(){return this._baseLayerPicker}},navigationHelpButton:{get:function(){return this._navigationHelpButton}},animation:{get:function(){return this._animation}},timeline:{get:function(){return this._timeline}},fullscreenButton:{get:function(){return this._fullscreenButton}},vrButton:{get:function(){return this._vrButton}},dataSourceDisplay:{get:function(){return this._dataSourceDisplay}},entities:{get:function(){return this._dataSourceDisplay.defaultDataSource.entities}},dataSources:{get:function(){return this._dataSourceCollection}},canvas:{get:function(){return this._cesiumWidget.canvas}},cesiumLogo:{get:function(){return this._cesiumWidget.cesiumLogo}},scene:{get:function(){return this._cesiumWidget.scene}},shadows:{get:function(){return this.scene.shadowMap.enabled},set:function(e){this.scene.shadowMap.enabled=e}},terrainShadows:{get:function(){return this.scene.globe.shadows},set:function(e){this.scene.globe.shadows=e}},shadowMap:{get:function(){return this.scene.shadowMap}},imageryLayers:{get:function(){return this.scene.imageryLayers}},terrainProvider:{get:function(){return this.scene.terrainProvider},set:function(e){this.scene.terrainProvider=e}},camera:{get:function(){return this.scene.camera}},clock:{get:function(){return this._cesiumWidget.clock}},screenSpaceEventHandler:{get:function(){return this._cesiumWidget.screenSpaceEventHandler}},targetFrameRate:{get:function(){return this._cesiumWidget.targetFrameRate},set:function(e){this._cesiumWidget.targetFrameRate=e}},useDefaultRenderLoop:{get:function(){return this._cesiumWidget.useDefaultRenderLoop},set:function(e){this._cesiumWidget.useDefaultRenderLoop=e}},resolutionScale:{get:function(){return this._cesiumWidget.resolutionScale},set:function(e){this._cesiumWidget.resolutionScale=e;this._forceResize=true}},allowDataSourcesToSuspendAnimation:{get:function(){return this._allowDataSourcesToSuspendAnimation},set:function(e){this._allowDataSourcesToSuspendAnimation=e}},trackedEntity:{get:function(){return this._trackedEntity},set:function(e){if(this._trackedEntity!==e){this._trackedEntity=e;ee(this);var t=this.scene;var r=t.mode;if(!i(e)||!i(e.position)){this._needTrackedEntityUpdate=false;if(r===C.COLUMBUS_VIEW||r===C.SCENE2D){t.screenSpaceCameraController.enableTranslate=true}if(r===C.COLUMBUS_VIEW||r===C.SCENE3D){t.screenSpaceCameraController.enableTilt=true}this._entityView=undefined;this.camera.lookAtTransform(c.IDENTITY)}else{this._needTrackedEntityUpdate=true}this._trackedEntityChanged.raiseEvent(e)}}},selectedEntity:{get:function(){return this._selectedEntity},set:function(e){if(this._selectedEntity!==e){this._selectedEntity=e;var t=i(this._selectionIndicator)?this._selectionIndicator.viewModel:undefined;if(i(e)){if(i(t)){t.animateAppear()}}else{if(i(t)){t.animateDepart()}}this._selectedEntityChanged.raiseEvent(e)}}},selectedEntityChanged:{get:function(){return this._selectedEntityChanged}},trackedEntityChanged:{get:function(){return this._trackedEntityChanged}},clockTrackedDataSource:{get:function(){return this._clockTrackedDataSource},set:function(e){if(this._clockTrackedDataSource!==e){this._clockTrackedDataSource=e;j(this._timeline,this.clock,e)}}}});Q.prototype.extend=function(e,t){if(!i(e)){throw new o("mixin is required.")}e(this,t)};Q.prototype.resize=function(){var e=this._cesiumWidget;var t=this._container;var r=t.clientWidth;var n=t.clientHeight;var a=i(this._animation);var o=i(this._timeline);if(!this._forceResize&&r===this._lastWidth&&n===this._lastHeight){return}e.resize();this._forceResize=false;var s=n-125;var u=this._baseLayerPickerDropDown;if(i(u)){u.style.maxHeight=s+"px"}if(i(this._geocoder)){var l=this._geocoder.searchSuggestionsContainer;l.style.maxHeight=s+"px"}if(i(this._infoBox)){this._infoBox.viewModel.maxHeight=s}var c=this._timeline;var d;var f=0;var h=0;var p=0;if(a&&window.getComputedStyle(this._animation.container).visibility!=="hidden"){var m=this._lastWidth;d=this._animation.container;if(r>900){f=169;if(m<=900){d.style.width="169px";d.style.height="112px";this._animation.resize()}}else if(r>=600){f=136;if(m<600||m>900){d.style.width="136px";d.style.height="90px";this._animation.resize()}}else{f=106;if(m>600||m===0){d.style.width="106px";d.style.height="70px";this._animation.resize()}}h=f+5}if(o&&window.getComputedStyle(this._timeline.container).visibility!=="hidden"){var v=this._fullscreenButton;var _=this._vrButton;var g=c.container;var y=g.style;p=g.clientHeight+3;y.left=f+"px";var w=0;if(i(v)){w+=v.container.clientWidth}if(i(_)){w+=_.container.clientWidth}y.right=w+"px";c.resize()}this._bottomContainer.style.left=h+"px";this._bottomContainer.style.bottom=p+"px";this._lastWidth=r;this._lastHeight=n};Q.prototype.forceResize=function(){this._lastWidth=0;this.resize()};Q.prototype.render=function(){this._cesiumWidget.render()};Q.prototype.isDestroyed=function(){return false};Q.prototype.destroy=function(){var e;this.screenSpaceEventHandler.removeInputAction(f.LEFT_CLICK);this.screenSpaceEventHandler.removeInputAction(f.LEFT_DOUBLE_CLICK);var t=this.dataSources;var r=t.length;for(e=0;e<r;e++){this._dataSourceRemoved(t,t.get(e))}this._dataSourceRemoved(undefined,this._dataSourceDisplay.defaultDataSource);this._container.removeChild(this._element);this._element.removeChild(this._toolbar);this._eventHelper.removeAll();if(i(this._geocoder)){this._geocoder=this._geocoder.destroy()}if(i(this._homeButton)){this._homeButton=this._homeButton.destroy()}if(i(this._sceneModePicker)){this._sceneModePicker=this._sceneModePicker.destroy()}if(i(this._projectionPicker)){this._projectionPicker=this._projectionPicker.destroy()}if(i(this._baseLayerPicker)){this._baseLayerPicker=this._baseLayerPicker.destroy()}if(i(this._animation)){this._element.removeChild(this._animation.container);this._animation=this._animation.destroy()}if(i(this._timeline)){this._timeline.removeEventListener("settime",H,false);this._element.removeChild(this._timeline.container);this._timeline=this._timeline.destroy()}if(i(this._fullscreenButton)){this._fullscreenSubscription.dispose();this._element.removeChild(this._fullscreenButton.container);this._fullscreenButton=this._fullscreenButton.destroy()}if(i(this._vrButton)){this._vrSubscription.dispose();this._vrModeSubscription.dispose();this._element.removeChild(this._vrButton.container);this._vrButton=this._vrButton.destroy()}if(i(this._infoBox)){this._element.removeChild(this._infoBox.container);this._infoBox=this._infoBox.destroy()}if(i(this._selectionIndicator)){this._element.removeChild(this._selectionIndicator.container);this._selectionIndicator=this._selectionIndicator.destroy()}this._clockViewModel=this._clockViewModel.destroy();this._dataSourceDisplay=this._dataSourceDisplay.destroy();this._cesiumWidget=this._cesiumWidget.destroy();if(this._destroyDataSourceCollection){this._dataSourceCollection=this._dataSourceCollection.destroy()}return a(this)};Q.prototype._dataSourceAdded=function(e,t){var r=t.entities;r.collectionChanged.addEventListener(Q.prototype._onEntityCollectionChanged,this)};Q.prototype._dataSourceRemoved=function(e,t){var r=t.entities;r.collectionChanged.removeEventListener(Q.prototype._onEntityCollectionChanged,this);if(i(this.trackedEntity)){if(r.getById(this.trackedEntity.id)===this.trackedEntity){this.trackedEntity=undefined}}if(i(this.selectedEntity)){if(r.getById(this.selectedEntity.id)===this.selectedEntity){this.selectedEntity=undefined}}};Q.prototype._onTick=function(e){var n=e.currentTime;var a=this._dataSourceDisplay.update(n);if(this._allowDataSourcesToSuspendAnimation){this._clockViewModel.canAnimate=a}var o=this._entityView;if(i(o)){var s=this._trackedEntity;var u=this._dataSourceDisplay.getBoundingSphere(s,false,G);if(u===h.DONE){o.update(n,G)}}var l;var c=false;var d=this.selectedEntity;var f=i(d)&&this._enableInfoOrSelection;if(f&&d.isShowing&&d.isAvailable(n)){var p=this._dataSourceDisplay.getBoundingSphere(d,true,G);if(p!==h.FAILED){l=G.center}else if(i(d.position)){l=d.position.getValue(n,l)}c=i(l)}var m=i(this._selectionIndicator)?this._selectionIndicator.viewModel:undefined;if(i(m)){m.position=t.clone(l,m.position);m.showSelection=f&&c;m.update()}var v=i(this._infoBox)?this._infoBox.viewModel:undefined;if(i(v)){v.showInfo=f
;v.enableCamera=c;v.isCameraTracking=this.trackedEntity===this.selectedEntity;if(f){v.titleText=r(d.name,d.id);v.description=y.getValueOrDefault(d.description,n,"")}else{v.titleText="";v.description=""}}};Q.prototype._onEntityCollectionChanged=function(e,t,r){var i=r.length;for(var n=0;n<i;n++){var a=r[n];if(this.trackedEntity===a){this.trackedEntity=undefined}if(this.selectedEntity===a){this.selectedEntity=undefined}}};Q.prototype._onInfoBoxCameraClicked=function(e){if(e.isCameraTracking&&this.trackedEntity===this.selectedEntity){this.trackedEntity=undefined}else{var t=this.selectedEntity;var r=t.position;if(i(r)){this.trackedEntity=this.selectedEntity}else{this.zoomTo(this.selectedEntity)}}};Q.prototype._clearTrackedObject=function(){this.trackedEntity=undefined};Q.prototype._onInfoBoxClockClicked=function(e){this.selectedEntity=undefined};Q.prototype._clearObjects=function(){this.trackedEntity=undefined;this.selectedEntity=undefined};Q.prototype._onDataSourceChanged=function(e){if(this.clockTrackedDataSource===e){j(this.timeline,this.clock,e)}};Q.prototype._onDataSourceAdded=function(e,t){if(this._automaticallyTrackDataSourceClocks){this.clockTrackedDataSource=t}var r=t.entities.id;var i=this._eventHelper.add(t.changedEvent,Q.prototype._onDataSourceChanged,this);this._dataSourceChangedListeners[r]=i};Q.prototype._onDataSourceRemoved=function(e,t){var r=this.clockTrackedDataSource===t;var i=t.entities.id;this._dataSourceChangedListeners[i]();this._dataSourceChangedListeners[i]=undefined;if(r){var n=e.length;if(this._automaticallyTrackDataSourceClocks&&n>0){this.clockTrackedDataSource=e.get(n-1)}else{this.clockTrackedDataSource=undefined}}};Q.prototype.zoomTo=function(e,t){return J(this,e,t,false)};Q.prototype.flyTo=function(e,t){return J(this,e,t,true)};function J(e,t,n,a){if(!i(t)){throw new o("zoomTarget is required.")}ee(e);var s=S.defer();e._zoomPromise=s;e._zoomIsFlight=a;e._zoomOptions=n;S(t,function(t){if(e._zoomPromise!==s){return}if(t instanceof w){t.getViewableRectangle().then(function(t){if(e._zoomPromise===s){e._zoomTarget=t}});return}if(t.isLoading&&i(t.loadingEvent)){var n=t.loadingEvent.addEventListener(function(){n();if(e._zoomPromise===s){e._zoomTarget=t.entities.values.slice(0)}});return}if(l(t)){e._zoomTarget=t.slice(0);return}t=r(t.values,t);if(i(t.entities)){t=t.entities.values}if(l(t)){e._zoomTarget=t.slice(0)}else{e._zoomTarget=[t]}});return s.promise}function $(e){e._zoomPromise=undefined;e._zoomTarget=undefined;e._zoomOptions=undefined}function ee(e){var t=e._zoomPromise;if(i(t)){$(e);t.resolve(false)}}Q.prototype._postRender=function(){te(this);re(this)};function te(t){var n=t._zoomTarget;if(!i(n)||t.scene.mode===C.MORPHING){return}var a=t.scene;var o=a.camera;var s=t._zoomPromise;var u=r(t._zoomOptions,{});if(n instanceof d){var l={destination:n,duration:u.duration,maximumHeight:u.maximumHeight,complete:function(){s.resolve(true)},cancel:function(){s.resolve(false)}};if(t._zoomIsFlight){o.flyTo(l)}else{o.setView(l);s.resolve(true)}$(t);return}var f=[];for(var p=0,m=n.length;p<m;p++){var v=t._dataSourceDisplay.getBoundingSphere(n[p],false,G);if(v===h.PENDING){return}else if(v!==h.FAILED){f.push(e.clone(G))}}if(f.length===0){ee(t);return}t.trackedEntity=undefined;var _=e.fromBoundingSpheres(f);var g=a.screenSpaceCameraController;g.minimumZoomDistance=Math.min(g.minimumZoomDistance,_.radius*.5);if(!t._zoomIsFlight){o.viewBoundingSphere(_,t._zoomOptions);o.lookAtTransform(c.IDENTITY);$(t);s.resolve(true)}else{$(t);o.flyToBoundingSphere(_,{duration:u.duration,maximumHeight:u.maximumHeight,complete:function(){s.resolve(true)},cancel:function(){s.resolve(false)},offset:u.offset})}}function re(e){if(!e._needTrackedEntityUpdate){return}var t=e._trackedEntity;var r=e.clock.currentTime;var n=y.getValueOrUndefined(t.position,r);if(!i(n)){return}var a=e.scene;var o=e._dataSourceDisplay.getBoundingSphere(t,false,G);if(o===h.PENDING){return}var s=a.mode;if(s===C.COLUMBUS_VIEW||s===C.SCENE2D){a.screenSpaceCameraController.enableTranslate=false}if(s===C.COLUMBUS_VIEW||s===C.SCENE3D){a.screenSpaceCameraController.enableTilt=false}var u=o!==h.FAILED?G:undefined;e._entityView=new g(t,a,a.mapProjection.ellipsoid);e._entityView.update(r,u);e._needTrackedEntityUpdate=false}return Q});define("Widgets/Viewer/viewerCesium3DTilesInspectorMixin",["../../Core/Check","../../Core/defineProperties","../CesiumInspector/Cesium3DTilesInspector"],function(e,t,r){"use strict";function i(i){e.typeOf.object("viewer",i);var n=document.createElement("div");n.className="cesium-viewer-cesium3DTilesInspectorContainer";i.container.appendChild(n);var a=new r(n,i.scene);t(i,{cesium3DTilesInspector:{get:function(){return a}}});i.scene.postRender.addEventListener(function(){i.cesium3DTilesInspector.viewModel.update()})}return i});define("Widgets/Viewer/viewerCesiumInspectorMixin",["../../Core/defined","../../Core/defineProperties","../../Core/DeveloperError","../CesiumInspector/CesiumInspector"],function(e,t,r,i){"use strict";function n(n){if(!e(n)){throw new r("viewer is required.")}var a=document.createElement("div");a.className="cesium-viewer-cesiumInspectorContainer";n.container.appendChild(a);var o=new i(a,n.scene);t(n,{cesiumInspector:{get:function(){return o}}});n.scene.postRender.addEventListener(function(){n.cesiumInspector.viewModel.update()})}return n});define("Widgets/Viewer/viewerDragDropMixin",["../../Core/defaultValue","../../Core/defined","../../Core/defineProperties","../../Core/DeveloperError","../../Core/Event","../../Core/wrapFunction","../../DataSources/CzmlDataSource","../../DataSources/GeoJsonDataSource","../../DataSources/KmlDataSource","../getElement"],function(e,t,r,i,n,a,o,s,u,l){"use strict";function c(o,s){if(!t(o)){throw new i("viewer is required.")}if(o.hasOwnProperty("dropTarget")){throw new i("dropTarget is already defined by another mixin.")}if(o.hasOwnProperty("dropEnabled")){throw new i("dropEnabled is already defined by another mixin.")}if(o.hasOwnProperty("dropError")){throw new i("dropError is already defined by another mixin.")}if(o.hasOwnProperty("clearOnDrop")){throw new i("clearOnDrop is already defined by another mixin.")}if(o.hasOwnProperty("flyToOnDrop")){throw new i("flyToOnDrop is already defined by another mixin.")}s=e(s,e.EMPTY_OBJECT);var u=true;var c=e(s.flyToOnDrop,true);var v=new n;var _=e(s.clearOnDrop,true);var g=e(s.dropTarget,o.container);var y=e(s.clampToGround,true);var w=s.proxy;g=l(g);r(o,{dropTarget:{get:function(){return g},set:function(e){if(!t(e)){throw new i("value is required.")}f(g,C);g=e;h(g,C)}},dropEnabled:{get:function(){return u},set:function(e){if(e!==u){if(e){h(g,C)}else{f(g,C)}u=e}}},dropError:{get:function(){return v}},clearOnDrop:{get:function(){return _},set:function(e){_=e}},flyToOnDrop:{get:function(){return c},set:function(e){c=e}},proxy:{get:function(){return w},set:function(e){w=e}},clampToGround:{get:function(){return y},set:function(e){y=e}}});function C(e){d(e);if(_){o.entities.removeAll();o.dataSources.removeAll()}var t=e.dataTransfer.files;var r=t.length;for(var i=0;i<r;i++){var n=t[i];var a=new FileReader;a.onload=p(o,n,w,y);a.onerror=m(o,n);a.readAsText(n)}}h(g,C);o.destroy=a(o,o.destroy,function(){o.dropEnabled=false});o._handleDrop=C}function d(e){e.stopPropagation();e.preventDefault()}function f(e,r){var i=e;if(t(i)){i.removeEventListener("drop",r,false);i.removeEventListener("dragenter",d,false);i.removeEventListener("dragover",d,false);i.removeEventListener("dragexit",d,false)}}function h(e,t){e.addEventListener("drop",t,false);e.addEventListener("dragenter",d,false);e.addEventListener("dragover",d,false);e.addEventListener("dragexit",d,false)}function p(e,r,i,n){var a=e.scene;return function(l){var c=r.name;try{var d;if(/\.czml$/i.test(c)){d=o.load(JSON.parse(l.target.result),{sourceUri:c})}else if(/\.geojson$/i.test(c)||/\.json$/i.test(c)||/\.topojson$/i.test(c)){d=s.load(JSON.parse(l.target.result),{sourceUri:c,clampToGround:n})}else if(/\.(kml|kmz)$/i.test(c)){d=u.load(r,{sourceUri:c,proxy:i,camera:a.camera,canvas:a.canvas})}else{e.dropError.raiseEvent(e,c,"Unrecognized file: "+c);return}if(t(d)){e.dataSources.add(d).then(function(t){if(e.flyToOnDrop){e.flyTo(t)}}).otherwise(function(t){e.dropError.raiseEvent(e,c,t)})}}catch(t){e.dropError.raiseEvent(e,c,t)}}}function m(e,t){return function(r){e.dropError.raiseEvent(e,t.name,r.target.error)}}return c});define("Widgets/Viewer/viewerPerformanceWatchdogMixin",["../../Core/defaultValue","../../Core/defined","../../Core/defineProperties","../../Core/DeveloperError","../PerformanceWatchdog/PerformanceWatchdog"],function(e,t,r,i,n){"use strict";function a(a,o){if(!t(a)){throw new i("viewer is required.")}o=e(o,e.EMPTY_OBJECT);var s=new n({scene:a.scene,container:a.bottomContainer,lowFrameRateMessage:o.lowFrameRateMessage});r(a,{performanceWatchdog:{get:function(){return s}}})}return a});define("Workers/createTaskProcessorWorker",["../Core/defaultValue","../Core/defined","../Core/formatError"],function(e,t,r){"use strict";function i(i){var n;var a=[];var o={id:undefined,result:undefined,error:undefined};return function(s){var u=s.data;a.length=0;o.id=u.id;o.error=undefined;o.result=undefined;try{o.result=i(u.parameters,a)}catch(e){if(e instanceof Error){o.error={name:e.name,message:e.message,stack:e.stack}}else{o.error=e}}if(!t(n)){n=e(self.webkitPostMessage,self.postMessage)}if(!u.canTransferArrayBuffer){a.length=0}try{n(o,a)}catch(e){o.result=undefined;o.error="postMessage failed with error: "+r(e)+"\n  with responseMessage: "+JSON.stringify(o);n(o)}}}return i})
;define("Cesium",["./Core/appendForwardSlash","./Core/arrayFill","./Core/arrayRemoveDuplicates","./Core/AssociativeArray","./Core/AttributeCompression","./Core/AxisAlignedBoundingBox","./Core/barycentricCoordinates","./Core/binarySearch","./Core/BingMapsApi","./Core/BingMapsGeocoderService","./Core/BoundingRectangle","./Core/BoundingSphere","./Core/BoxGeometry","./Core/BoxOutlineGeometry","./Core/buildModuleUrl","./Core/cancelAnimationFrame","./Core/Cartesian2","./Core/Cartesian3","./Core/Cartesian4","./Core/Cartographic","./Core/CartographicGeocoderService","./Core/CatmullRomSpline","./Core/CesiumTerrainProvider","./Core/Check","./Core/CircleGeometry","./Core/CircleOutlineGeometry","./Core/Clock","./Core/ClockRange","./Core/ClockStep","./Core/clone","./Core/Color","./Core/ColorGeometryInstanceAttribute","./Core/combine","./Core/ComponentDatatype","./Core/CompressedTextureBuffer","./Core/CornerType","./Core/CorridorGeometry","./Core/CorridorGeometryLibrary","./Core/CorridorOutlineGeometry","./Core/createGuid","./Core/Credit","./Core/CubicRealPolynomial","./Core/CylinderGeometry","./Core/CylinderGeometryLibrary","./Core/CylinderOutlineGeometry","./Core/DefaultProxy","./Core/defaultValue","./Core/defined","./Core/defineProperties","./Core/deprecationWarning","./Core/destroyObject","./Core/DeveloperError","./Core/DistanceDisplayCondition","./Core/DistanceDisplayConditionGeometryInstanceAttribute","./Core/DoublyLinkedList","./Core/EarthOrientationParameters","./Core/EarthOrientationParametersSample","./Core/EasingFunction","./Core/EllipseGeometry","./Core/EllipseGeometryLibrary","./Core/EllipseOutlineGeometry","./Core/Ellipsoid","./Core/EllipsoidalOccluder","./Core/EllipsoidGeodesic","./Core/EllipsoidGeometry","./Core/EllipsoidOutlineGeometry","./Core/EllipsoidTangentPlane","./Core/EllipsoidTerrainProvider","./Core/EncodedCartesian3","./Core/Event","./Core/EventHelper","./Core/ExtrapolationType","./Core/FeatureDetection","./Core/formatError","./Core/freezeObject","./Core/Fullscreen","./Core/GeocoderService","./Core/GeographicProjection","./Core/GeographicTilingScheme","./Core/Geometry","./Core/GeometryAttribute","./Core/GeometryAttributes","./Core/GeometryInstance","./Core/GeometryInstanceAttribute","./Core/GeometryPipeline.bak","./Core/GeometryPipeline","./Core/GeometryType","./Core/getAbsoluteUri","./Core/getBaseUri","./Core/getExtensionFromUri","./Core/getFilenameFromUri","./Core/getImagePixels","./Core/getMagic","./Core/getStringFromTypedArray","./Core/getTimestamp","./Core/GregorianDate","./Core/HeadingPitchRange","./Core/HeadingPitchRoll","./Core/HeightmapTerrainData","./Core/HeightmapTessellator","./Core/HermitePolynomialApproximation","./Core/HermiteSpline","./Core/Iau2000Orientation","./Core/Iau2006XysData","./Core/Iau2006XysSample","./Core/IauOrientationAxes","./Core/IauOrientationParameters","./Core/IndexDatatype","./Core/InterpolationAlgorithm","./Core/Intersect","./Core/Intersections2D","./Core/IntersectionTests","./Core/Interval","./Core/isArray","./Core/isCrossOriginUrl","./Core/isDataUri","./Core/isLeapYear","./Core/Iso8601","./Core/joinUrls","./Core/JulianDate","./Core/KeyboardEventModifier","./Core/LagrangePolynomialApproximation","./Core/LeapSecond","./Core/LinearApproximation","./Core/LinearSpline","./Core/loadArrayBuffer","./Core/loadBlob","./Core/loadCRN","./Core/loadImage","./Core/loadImageFromTypedArray","./Core/loadImageViaBlob","./Core/loadJson","./Core/loadJsonp","./Core/loadKTX","./Core/loadText","./Core/loadWithXhr","./Core/loadXML","./Core/MapboxApi","./Core/MapProjection","./Core/Math","./Core/Matrix2","./Core/Matrix3","./Core/Matrix4","./Core/mergeSort","./Core/NearFarScalar","./Core/objectToQuery","./Core/Occluder","./Core/oneTimeWarning","./Core/OrientedBoundingBox","./Core/Packable","./Core/PackableForInterpolation","./Core/parseResponseHeaders","./Core/PinBuilder","./Core/PixelFormat","./Core/Plane","./Core/PointGeometry","./Core/pointInsideTriangle","./Core/PolygonGeometry","./Core/PolygonGeometryLibrary","./Core/PolygonHierarchy","./Core/PolygonOutlineGeometry","./Core/PolygonPipeline","./Core/PolylineGeometry","./Core/PolylinePipeline","./Core/PolylineVolumeGeometry","./Core/PolylineVolumeGeometryLibrary","./Core/PolylineVolumeOutlineGeometry","./Core/PrimitiveType","./Core/QuadraticRealPolynomial","./Core/QuantizedMeshTerrainData","./Core/QuarticRealPolynomial","./Core/Quaternion","./Core/QuaternionSpline","./Core/queryToObject","./Core/Queue","./Core/Ray","./Core/Rectangle","./Core/RectangleGeometry","./Core/RectangleGeometryLibrary","./Core/RectangleOutlineGeometry","./Core/ReferenceFrame","./Core/Request","./Core/requestAnimationFrame","./Core/RequestErrorEvent","./Core/RequestScheduler","./Core/RequestType","./Core/RuntimeError","./Core/sampleTerrain","./Core/sampleTerrainMostDetailed","./Core/scaleToGeodeticSurface","./Core/ScreenSpaceEventHandler","./Core/ScreenSpaceEventType","./Core/ShowGeometryInstanceAttribute","./Core/Simon1994PlanetaryPositions","./Core/SimplePolylineGeometry","./Core/SphereGeometry","./Core/SphereOutlineGeometry","./Core/Spherical","./Core/Spline","./Core/subdivideArray","./Core/TaskProcessor","./Core/TerrainData","./Core/TerrainEncoding","./Core/TerrainMesh","./Core/TerrainProvider","./Core/TerrainQuantization","./Core/TileAvailability","./Core/TileProviderError","./Core/TilingScheme","./Core/TimeConstants","./Core/TimeInterval","./Core/TimeIntervalCollection","./Core/TimeStandard","./Core/Tipsify","./Core/Transforms","./Core/TranslationRotationScale","./Core/TridiagonalSystemSolver","./Core/TrustedServers","./Core/VertexFormat","./Core/VideoSynchronizer","./Core/Visibility","./Core/VRTheWorldTerrainProvider","./Core/WallGeometry","./Core/WallGeometryLibrary","./Core/WallOutlineGeometry","./Core/WebGLConstants","./Core/WebMercatorProjection","./Core/WebMercatorTilingScheme","./Core/WindingOrder","./Core/wrapFunction","./Core/writeTextToCanvas","./DataSources/BillboardGraphics","./DataSources/BillboardVisualizer","./DataSources/BoundingSphereState","./DataSources/BoxGeometryUpdater","./DataSources/BoxGraphics","./DataSources/CallbackProperty","./DataSources/CheckerboardMaterialProperty","./DataSources/ColorMaterialProperty","./DataSources/CompositeEntityCollection","./DataSources/CompositeMaterialProperty","./DataSources/CompositePositionProperty","./DataSources/CompositeProperty","./DataSources/ConstantPositionProperty","./DataSources/ConstantProperty","./DataSources/CorridorGeometryUpdater","./DataSources/CorridorGraphics","./DataSources/createMaterialPropertyDescriptor","./DataSources/createPropertyDescriptor","./DataSources/createRawPropertyDescriptor","./DataSources/CustomDataSource","./DataSources/CylinderGeometryUpdater","./DataSources/CylinderGraphics","./DataSources/CzmlDataSource","./DataSources/DataSource","./DataSources/DataSourceClock","./DataSources/DataSourceCollection","./DataSources/DataSourceDisplay","./DataSources/dynamicGeometryGetBoundingSphere","./DataSources/DynamicGeometryUpdater","./DataSources/EllipseGeometryUpdater","./DataSources/EllipseGraphics","./DataSources/EllipsoidGeometryUpdater","./DataSources/EllipsoidGraphics","./DataSources/Entity","./DataSources/EntityCluster","./DataSources/EntityCollection","./DataSources/EntityView","./DataSources/GeoJsonDataSource","./DataSources/GeometryUpdater","./DataSources/GeometryVisualizer","./DataSources/GridMaterialProperty","./DataSources/ImageMaterialProperty","./DataSources/KmlDataSource","./DataSources/LabelGraphics","./DataSources/LabelVisualizer","./DataSources/MaterialProperty","./DataSources/ModelGraphics","./DataSources/ModelVisualizer","./DataSources/NodeTransformationProperty","./DataSources/PathGraphics","./DataSources/PathVisualizer","./DataSources/PointGraphics","./DataSources/PointVisualizer","./DataSources/PolygonGeometryUpdater","./DataSources/PolygonGraphics","./DataSources/PolylineArrowMaterialProperty","./DataSources/PolylineGeometryUpdater","./DataSources/PolylineGlowMaterialProperty","./DataSources/PolylineGraphics","./DataSources/PolylineOutlineMaterialProperty","./DataSources/PolylineVolumeGeometryUpdater","./DataSources/PolylineVolumeGraphics","./DataSources/PositionProperty","./DataSources/PositionPropertyArray","./DataSources/Property","./DataSources/PropertyArray","./DataSources/PropertyBag","./DataSources/RectangleGeometryUpdater","./DataSources/RectangleGraphics","./DataSources/ReferenceProperty","./DataSources/Rotation","./DataSources/SampledPositionProperty","./DataSources/SampledProperty","./DataSources/ScaledPositionProperty","./DataSources/StaticGeometryColorBatch","./DataSources/StaticGeometryPerMaterialBatch","./DataSources/StaticGroundGeometryColorBatch","./DataSources/StaticOutlineGeometryBatch","./DataSources/StripeMaterialProperty","./DataSources/StripeOrientation","./DataSources/TimeIntervalCollectionPositionProperty","./DataSources/TimeIntervalCollectionProperty","./DataSources/VelocityOrientationProperty","./DataSources/VelocityVectorProperty","./DataSources/Visualizer","./DataSources/WallGeometryUpdater","./DataSources/WallGraphics","./Renderer/AutomaticUniforms","./Renderer/Buffer","./Renderer/BufferUsage","./Renderer/ClearCommand","./Renderer/ComputeCommand","./Renderer/ComputeEngine","./Renderer/Context","./Renderer/ContextLimits","./Renderer/createUniform","./Renderer/createUniformArray","./Renderer/CubeMap","./Renderer/CubeMapFace","./Renderer/DrawCommand","./Renderer/Framebuffer","./Renderer/loadCubeMap","./Renderer/MipmapHint","./Renderer/Pass","./Renderer/PassState","./Renderer/PickFramebuffer","./Renderer/PixelDatatype","./Renderer/Renderbuffer","./Renderer/RenderbufferFormat","./Renderer/RenderState","./Renderer/Sampler","./Renderer/ShaderCache","./Renderer/ShaderProgram","./Renderer/ShaderSource","./Renderer/Texture","./Renderer/TextureMagnificationFilter","./Renderer/TextureMinificationFilter","./Renderer/TextureWrap","./Renderer/UniformState","./Renderer/VertexArray","./Renderer/VertexArrayFacade","./Scene/Appearance","./Scene/ArcGisMapServerImageryProvider","./Scene/Axis","./Scene/Batched3DModel3DTileContent","./Scene/BatchTable","./Scene/Billboard","./Scene/BillboardCollection","./Scene/BingMapsImageryProvider","./Scene/BingMapsStyle","./Scene/BlendEquation","./Scene/BlendFunction","./Scene/BlendingState","./Scene/BlendOption","./Scene/Camera","./Scene/CameraEventAggregator","./Scene/CameraEventType","./Scene/CameraFlightPath","./Scene/Cesium3DTile","./Scene/Cesium3DTileBatchTable","./Scene/Cesium3DTileChildrenVisibility","./Scene/Cesium3DTileColorBlendMode","./Scene/Cesium3DTileContent","./Scene/Cesium3DTileContentFactory","./Scene/Cesium3DTileContentState","./Scene/Cesium3DTileFeature","./Scene/Cesium3DTileFeatureTable","./Scene/Cesium3DTileOptimizationHint","./Scene/Cesium3DTileOptimizations","./Scene/Cesium3DTileRefine","./Scene/Cesium3DTileset","./Scene/Cesium3DTileStyle","./Scene/Cesium3DTileStyleEngine","./Scene/ColorBlendMode","./Scene/Composite3DTileContent","./Scene/ConditionsExpression","./Scene/createOpenStreetMapImageryProvider","./Scene/createTangentSpaceDebugPrimitive","./Scene/createTileMapServiceImageryProvider","./Scene/CreditDisplay","./Scene/CullFace","./Scene/CullingVolume","./Scene/DebugAppearance","./Scene/DebugCameraPrimitive","./Scene/DebugModelMatrixPrimitive","./Scene/DepthFunction","./Scene/DepthPlane","./Scene/DeviceOrientationCameraController","./Scene/DiscardMissingTileImagePolicy","./Scene/EllipsoidPrimitive","./Scene/EllipsoidSurfaceAppearance","./Scene/Empty3DTileContent","./Scene/Expression","./Scene/ExpressionNodeType","./Scene/Fog","./Scene/FrameRateMonitor","./Scene/FrameState","./Scene/FrustumCommands","./Scene/FXAA","./Scene/getAttributeOrUniformBySemantic","./Scene/getBinaryAccessor","./Scene/GetFeatureInfoFormat","./Scene/Globe","./Scene/GlobeDepth","./Scene/GlobeSurfaceShaderSet","./Scene/GlobeSurfaceTile","./Scene/GlobeSurfaceTileProvider","./Scene/GoogleEarthImageryProvider","./Scene/GridImageryProvider","./Scene/GroundPrimitive","./Scene/HeightReference","./Scene/HorizontalOrigin","./Scene/Imagery","./Scene/ImageryLayer","./Scene/ImageryLayerCollection","./Scene/ImageryLayerFeatureInfo","./Scene/ImageryProvider","./Scene/ImagerySplitDirection","./Scene/ImageryState","./Scene/Instanced3DModel3DTileContent","./Scene/JobScheduler","./Scene/JobType","./Scene/Label","./Scene/LabelCollection","./Scene/LabelStyle","./Scene/MapboxImageryProvider","./Scene/MapMode2D","./Scene/Material","./Scene/MaterialAppearance","./Scene/Model","./Scene/ModelAnimation","./Scene/ModelAnimationCache","./Scene/ModelAnimationCollection","./Scene/ModelAnimationLoop","./Scene/ModelAnimationState","./Scene/ModelInstance","./Scene/ModelInstanceCollection","./Scene/ModelMaterial","./Scene/modelMaterialsCommon","./Scene/ModelMesh","./Scene/ModelNode","./Scene/Moon","./Scene/NeverTileDiscardPolicy","./Scene/OIT","./Scene/OrthographicFrustum","./Scene/OrthographicOffCenterFrustum","./Scene/PerformanceDisplay","./Scene/PerInstanceColorAppearance","./Scene/PerspectiveFrustum","./Scene/PerspectiveOffCenterFrustum","./Scene/PickDepth","./Scene/PointAppearance","./Scene/PointCloud3DTileContent","./Scene/PointPrimitive","./Scene/PointPrimitiveCollection","./Scene/Polyline","./Scene/PolylineCollection","./Scene/PolylineColorAppearance","./Scene/PolylineMaterialAppearance","./Scene/Primitive","./Scene/PrimitiveCollection","./Scene/PrimitivePipeline","./Scene/PrimitiveState","./Scene/QuadtreeOccluders","./Scene/QuadtreePrimitive","./Scene/QuadtreeTile","./Scene/QuadtreeTileLoadState","./Scene/QuadtreeTileProvider","./Scene/Scene","./Scene/SceneMode","./Scene/SceneTransforms","./Scene/SceneTransitioner","./Scene/ScreenSpaceCameraController","./Scene/ShadowMap","./Scene/ShadowMapShader","./Scene/ShadowMode","./Scene/SingleTileImageryProvider","./Scene/SkyAtmosphere","./Scene/SkyBox","./Scene/StencilFunction","./Scene/StencilOperation","./Scene/StyleExpression","./Scene/Sun","./Scene/SunPostProcess","./Scene/TerrainState","./Scene/TextureAtlas","./Scene/TileBoundingRegion","./Scene/TileBoundingSphere","./Scene/TileBoundingVolume","./Scene/TileCoordinatesImageryProvider","./Scene/TileDiscardPolicy","./Scene/TileImagery","./Scene/TileOrientedBoundingBox","./Scene/TileReplacementQueue","./Scene/Tileset3DTileContent","./Scene/TileState","./Scene/TileTerrain","./Scene/TweenCollection","./Scene/UrlTemplateImageryProvider","./Scene/VerticalOrigin","./Scene/ViewportQuad","./Scene/WebMapServiceImageryProvider","./Scene/WebMapTileServiceImageryProvider","./Shaders/AdjustTranslucentFS","./Shaders/Appearances/AllMaterialAppearanceFS","./Shaders/Appearances/AllMaterialAppearanceVS","./Shaders/Appearances/BasicMaterialAppearanceFS","./Shaders/Appearances/BasicMaterialAppearanceVS","./Shaders/Appearances/EllipsoidSurfaceAppearanceFS","./Shaders/Appearances/EllipsoidSurfaceAppearanceVS","./Shaders/Appearances/PerInstanceColorAppearanceFS","./Shaders/Appearances/PerInstanceColorAppearanceVS","./Shaders/Appearances/PerInstanceFlatColorAppearanceFS","./Shaders/Appearances/PerInstanceFlatColorAppearanceVS","./Shaders/Appearances/PointAppearanceFS","./Shaders/Appearances/PointAppearanceVS","./Shaders/Appearances/PolylineColorAppearanceVS","./Shaders/Appearances/PolylineMaterialAppearanceVS","./Shaders/Appearances/TexturedMaterialAppearanceFS","./Shaders/Appearances/TexturedMaterialAppearanceVS","./Shaders/BillboardCollectionFS","./Shaders/BillboardCollectionVS","./Shaders/Builtin/Constants/degreesPerRadian","./Shaders/Builtin/Constants/depthRange","./Shaders/Builtin/Constants/epsilon1","./Shaders/Builtin/Constants/epsilon2","./Shaders/Builtin/Constants/epsilon3","./Shaders/Builtin/Constants/epsilon4","./Shaders/Builtin/Constants/epsilon5","./Shaders/Builtin/Constants/epsilon6","./Shaders/Builtin/Constants/epsilon7","./Shaders/Builtin/Constants/infinity","./Shaders/Builtin/Constants/oneOverPi","./Shaders/Builtin/Constants/oneOverTwoPi","./Shaders/Builtin/Constants/passCompute","./Shaders/Builtin/Constants/passEnvironment","./Shaders/Builtin/Constants/passGlobe","./Shaders/Builtin/Constants/passGround","./Shaders/Builtin/Constants/passOpaque","./Shaders/Builtin/Constants/passOverlay","./Shaders/Builtin/Constants/passTranslucent","./Shaders/Builtin/Constants/pi","./Shaders/Builtin/Constants/piOverFour","./Shaders/Builtin/Constants/piOverSix","./Shaders/Builtin/Constants/piOverThree","./Shaders/Builtin/Constants/piOverTwo","./Shaders/Builtin/Constants/radiansPerDegree","./Shaders/Builtin/Constants/sceneMode2D","./Shaders/Builtin/Constants/sceneMode3D","./Shaders/Builtin/Constants/sceneModeColumbusView","./Shaders/Builtin/Constants/sceneModeMorphing","./Shaders/Builtin/Constants/solarRadius","./Shaders/Builtin/Constants/threePiOver2","./Shaders/Builtin/Constants/twoPi","./Shaders/Builtin/Constants/webMercatorMaxLatitude","./Shaders/Builtin/CzmBuiltins","./Shaders/Builtin/Functions/alphaWeight","./Shaders/Builtin/Functions/antialias","./Shaders/Builtin/Functions/cascadeColor","./Shaders/Builtin/Functions/cascadeDistance","./Shaders/Builtin/Functions/cascadeMatrix","./Shaders/Builtin/Functions/cascadeWeights","./Shaders/Builtin/Functions/columbusViewMorph","./Shaders/Builtin/Functions/computePosition","./Shaders/Builtin/Functions/cosineAndSine","./Shaders/Builtin/Functions/decompressTextureCoordinates","./Shaders/Builtin/Functions/eastNorthUpToEyeCoordinates","./Shaders/Builtin/Functions/ellipsoidContainsPoint","./Shaders/Builtin/Functions/ellipsoidNew","./Shaders/Builtin/Functions/ellipsoidWgs84TextureCoordinates","./Shaders/Builtin/Functions/equalsEpsilon","./Shaders/Builtin/Functions/eyeOffset","./Shaders/Builtin/Functions/eyeToWindowCoordinates","./Shaders/Builtin/Functions/fog","./Shaders/Builtin/Functions/geodeticSurfaceNormal","./Shaders/Builtin/Functions/getDefaultMaterial","./Shaders/Builtin/Functions/getLambertDiffuse","./Shaders/Builtin/Functions/getSpecular","./Shaders/Builtin/Functions/getWaterNoise","./Shaders/Builtin/Functions/getWgs84EllipsoidEC","./Shaders/Builtin/Functions/HSBToRGB","./Shaders/Builtin/Functions/HSLToRGB","./Shaders/Builtin/Functions/hue","./Shaders/Builtin/Functions/isEmpty","./Shaders/Builtin/Functions/isFull","./Shaders/Builtin/Functions/latitudeToWebMercatorFraction","./Shaders/Builtin/Functions/luminance","./Shaders/Builtin/Functions/metersPerPixel","./Shaders/Builtin/Functions/modelToWindowCoordinates","./Shaders/Builtin/Functions/multiplyWithColorBalance","./Shaders/Builtin/Functions/nearFarScalar","./Shaders/Builtin/Functions/octDecode","./Shaders/Builtin/Functions/packDepth","./Shaders/Builtin/Functions/phong","./Shaders/Builtin/Functions/pointAlongRay","./Shaders/Builtin/Functions/rayEllipsoidIntersectionInterval","./Shaders/Builtin/Functions/RGBToHSB","./Shaders/Builtin/Functions/RGBToHSL","./Shaders/Builtin/Functions/RGBToXYZ","./Shaders/Builtin/Functions/saturation","./Shaders/Builtin/Functions/shadowDepthCompare","./Shaders/Builtin/Functions/shadowVisibility","./Shaders/Builtin/Functions/signNotZero","./Shaders/Builtin/Functions/tangentToEyeSpaceMatrix","./Shaders/Builtin/Functions/translateRelativeToEye","./Shaders/Builtin/Functions/translucentPhong","./Shaders/Builtin/Functions/transpose","./Shaders/Builtin/Functions/unpackDepth","./Shaders/Builtin/Functions/windowToEyeCoordinates","./Shaders/Builtin/Functions/XYZToRGB","./Shaders/Builtin/Structs/depthRangeStruct","./Shaders/Builtin/Structs/ellipsoid","./Shaders/Builtin/Structs/material","./Shaders/Builtin/Structs/materialInput","./Shaders/Builtin/Structs/ray","./Shaders/Builtin/Structs/raySegment","./Shaders/Builtin/Structs/shadowParameters","./Shaders/CompositeOITFS","./Shaders/DepthPlaneFS","./Shaders/DepthPlaneVS","./Shaders/EllipsoidFS","./Shaders/EllipsoidVS","./Shaders/GlobeFS","./Shaders/GlobeVS","./Shaders/GroundAtmosphere","./Shaders/Materials/BumpMapMaterial","./Shaders/Materials/CheckerboardMaterial","./Shaders/Materials/DotMaterial","./Shaders/Materials/FadeMaterial","./Shaders/Materials/GridMaterial","./Shaders/Materials/NormalMapMaterial","./Shaders/Materials/PolylineArrowMaterial","./Shaders/Materials/PolylineGlowMaterial","./Shaders/Materials/PolylineOutlineMaterial","./Shaders/Materials/RimLightingMaterial","./Shaders/Materials/StripeMaterial","./Shaders/Materials/Water","./Shaders/PointPrimitiveCollectionFS","./Shaders/PointPrimitiveCollectionVS","./Shaders/PolylineCommon","./Shaders/PolylineFS","./Shaders/PolylineVS","./Shaders/PostProcessFilters/AdditiveBlend","./Shaders/PostProcessFilters/BrightPass","./Shaders/PostProcessFilters/FXAA","./Shaders/PostProcessFilters/GaussianBlur1D","./Shaders/PostProcessFilters/PassThrough","./Shaders/ReprojectWebMercatorFS","./Shaders/ReprojectWebMercatorVS","./Shaders/ShadowVolumeFS","./Shaders/ShadowVolumeVS","./Shaders/SkyAtmosphereFS","./Shaders/SkyAtmosphereVS","./Shaders/SkyBoxFS","./Shaders/SkyBoxVS","./Shaders/SunFS","./Shaders/SunTextureFS","./Shaders/SunVS","./Shaders/ViewportQuadFS","./Shaders/ViewportQuadVS","./ThirdParty/Autolinker","./ThirdParty/crunch","./ThirdParty/earcut-2.1.1","./ThirdParty/gltfDefaults","./ThirdParty/jsep","./ThirdParty/kdbush","./ThirdParty/knockout-3.4.0","./ThirdParty/knockout-es5","./ThirdParty/knockout","./ThirdParty/measureText","./ThirdParty/mersenne-twister","./ThirdParty/NoSleep","./ThirdParty/sprintf","./ThirdParty/topojson","./ThirdParty/Tween","./ThirdParty/Uri","./ThirdParty/when","./ThirdParty/zip","./Widgets/Animation/Animation","./Widgets/Animation/AnimationViewModel","./Widgets/BaseLayerPicker/BaseLayerPicker","./Widgets/BaseLayerPicker/BaseLayerPickerViewModel","./Widgets/BaseLayerPicker/createDefaultImageryProviderViewModels","./Widgets/BaseLayerPicker/createDefaultTerrainProviderViewModels","./Widgets/BaseLayerPicker/ProviderViewModel","./Widgets/CesiumInspector/Cesium3DTilesInspector","./Widgets/CesiumInspector/Cesium3DTilesInspectorViewModel","./Widgets/CesiumInspector/CesiumInspector","./Widgets/CesiumInspector/CesiumInspectorViewModel","./Widgets/CesiumWidget/CesiumWidget","./Widgets/ClockViewModel","./Widgets/Command","./Widgets/createCommand","./Widgets/FullscreenButton/FullscreenButton","./Widgets/FullscreenButton/FullscreenButtonViewModel","./Widgets/Geocoder/Geocoder","./Widgets/Geocoder/GeocoderViewModel","./Widgets/getElement","./Widgets/HomeButton/HomeButton","./Widgets/HomeButton/HomeButtonViewModel","./Widgets/InfoBox/InfoBox","./Widgets/InfoBox/InfoBoxViewModel","./Widgets/NavigationHelpButton/NavigationHelpButton","./Widgets/NavigationHelpButton/NavigationHelpButtonViewModel","./Widgets/PerformanceWatchdog/PerformanceWatchdog","./Widgets/PerformanceWatchdog/PerformanceWatchdogViewModel","./Widgets/ProjectionPicker/ProjectionPicker","./Widgets/ProjectionPicker/ProjectionPickerViewModel","./Widgets/SceneModePicker/SceneModePicker","./Widgets/SceneModePicker/SceneModePickerViewModel","./Widgets/SelectionIndicator/SelectionIndicator","./Widgets/SelectionIndicator/SelectionIndicatorViewModel","./Widgets/subscribeAndEvaluate","./Widgets/SvgPathBindingHandler","./Widgets/Timeline/Timeline","./Widgets/Timeline/TimelineHighlightRange","./Widgets/Timeline/TimelineTrack","./Widgets/ToggleButtonViewModel","./Widgets/Viewer/Viewer","./Widgets/Viewer/viewerCesium3DTilesInspectorMixin","./Widgets/Viewer/viewerCesiumInspectorMixin","./Widgets/Viewer/viewerDragDropMixin","./Widgets/Viewer/viewerPerformanceWatchdogMixin","./Widgets/VRButton/VRButton","./Widgets/VRButton/VRButtonViewModel","./Workers/createTaskProcessorWorker"],function(e,t,r,i,n,a,o,s,u,l,c,d,f,h,p,m,v,_,g,y,w,C,b,S,E,T,x,A,P,D,M,I,O,R,N,L,B,F,k,V,z,U,q,G,H,W,j,Y,X,Z,K,Q,J,$,ee,te,re,ie,ne,ae,oe,se,ue,le,ce,de,fe,he,pe,me,ve,_e,ge,ye,we,Ce,be,Se,Ee,Te,xe,Ae,Pe,De,Me,Ie,Oe,Re,Ne,Le,Be,Fe,ke,Ve,ze,Ue,qe,Ge,He,We,je,Ye,Xe,Ze,Ke,Qe,Je,$e,et,tt,rt,it,nt,at,ot,st,ut,lt,ct,dt,ft,ht,pt,mt,vt,_t,gt,yt,wt,Ct,bt,St,Et,Tt,xt,At,Pt,Dt,Mt,It,Ot,Rt,Nt,Lt,Bt,Ft,kt,Vt,zt,Ut,qt,Gt,Ht,Wt,jt,Yt,Xt,Zt,Kt,Qt,Jt,$t,er,tr,rr,ir,nr,ar,or,sr,ur,lr,cr,dr,fr,hr,pr,mr,vr,_r,gr,yr,wr,Cr,br,Sr,Er,Tr,xr,Ar,Pr,Dr,Mr,Ir,Or,Rr,Nr,Lr,Br,Fr,kr,Vr,zr,Ur,qr,Gr,Hr,Wr,jr,Yr,Xr,Zr,Kr,Qr,Jr,$r,ei,ti,ri,ii,ni,ai,oi,si,ui,li,ci,di,fi,hi,pi,mi,vi,_i,gi,yi,wi,Ci,bi,Si,Ei,Ti,xi,Ai,Pi,Di,Mi,Ii,Oi,Ri,Ni,Li,Bi,Fi,ki,Vi,zi,Ui,qi,Gi,Hi,Wi,ji,Yi,Xi,Zi,Ki,Qi,Ji,$i,en,tn,rn,nn,an,on,sn,un,ln,cn,dn,fn,hn,pn,mn,vn,_n,gn,yn,wn,Cn,bn,Sn,En,Tn,xn,An,Pn,Dn,Mn,In,On,Rn,Nn,Ln,Bn,Fn,kn,Vn,zn,Un,qn,Gn,Hn,Wn,jn,Yn,Xn,Zn,Kn,Qn,Jn,$n,ea,ta,ra,ia,na,aa,oa,sa,ua,la,ca,da,fa,ha,pa,ma,va,_a,ga,ya,wa,Ca,ba,Sa,Ea,Ta,xa,Aa,Pa,Da,Ma,Ia,Oa,Ra,Na,La,Ba,Fa,ka,Va,za,Ua,qa,Ga,Ha,Wa,ja,Ya,Xa,Za,Ka,Qa,Ja,$a,eo,to,ro,io,no,ao,oo,so,uo,lo,co,fo,ho,po,mo,vo,_o,go,yo,wo,Co,bo,So,Eo,To,xo,Ao,Po,Do,Mo,Io,Oo,Ro,No,Lo,Bo,Fo,ko,Vo,zo,Uo,qo,Go,Ho,Wo,jo,Yo,Xo,Zo,Ko,Qo,Jo,$o,es,ts,rs,is,ns,as,os,ss,us,ls,cs,ds,fs,hs,ps,ms,vs,_s,gs,ys,ws,Cs,bs,Ss,Es,Ts,xs,As,Ps,Ds,Ms,Is,Os,Rs,Ns,Ls,Bs,Fs,ks,Vs,zs,Us,qs,Gs,Hs,Ws,js,Ys,Xs,Zs,Ks,Qs,Js,$s,eu,tu,ru,iu,nu,au,ou,su,uu,lu,cu,du,fu,hu,pu,mu,vu,_u,gu,yu,wu,Cu,bu,Su,Eu,Tu,xu,Au,Pu,Du,Mu,Iu,Ou,Ru,Nu,Lu,Bu,Fu,ku,Vu,zu,Uu,qu,Gu,Hu,Wu,ju,Yu,Xu,Zu,Ku,Qu,Ju,$u,el,tl,rl,il,nl,al,ol,sl,ul,ll,cl,dl,fl,hl,pl,ml,vl,_l,gl,yl,wl,Cl,bl,Sl,El,Tl,xl,Al,Pl,Dl,Ml,Il,Ol,Rl,Nl,Ll,Bl,Fl,kl,Vl,zl,Ul,ql,Gl,Hl,Wl,jl,Yl,Xl,Zl,Kl,Ql,Jl,$l,ec,tc,rc,ic,nc,ac,oc,sc,uc,lc,cc,dc,fc,hc,pc,mc,vc,_c,gc,yc,wc,Cc,bc,Sc,Ec,Tc,xc,Ac,Pc,Dc,Mc,Ic,Oc,Rc,Nc,Lc,Bc,Fc,kc,Vc,zc,Uc,qc,Gc,Hc,Wc,jc,Yc,Xc,Zc,Kc,Qc,Jc,$c,ed,td,rd,id,nd,ad,od,sd,ud,ld,cd,dd,fd,hd,pd,md,vd,_d,gd,yd,wd,Cd,bd,Sd,Ed,Td,xd,Ad,Pd,Dd,Md,Id,Od,Rd,Nd,Ld,Bd,Fd,kd,Vd,zd,Ud,qd,Gd,Hd,Wd,jd,Yd,Xd,Zd,Kd,Qd,Jd,$d,ef,tf,rf,nf,af,of,sf,uf,lf,cf,df,ff,hf,pf,mf,vf,_f,gf,yf,wf,Cf,bf,Sf,Ef,Tf,xf,Af,Pf,Df,Mf,If,Of,Rf,Nf,Lf,Bf,Ff){"use strict";var kf={VERSION:"1.31",_shaders:{}};kf["appendForwardSlash"]=e;kf["arrayFill"]=t;kf["arrayRemoveDuplicates"]=r;kf["AssociativeArray"]=i;kf["AttributeCompression"]=n;kf["AxisAlignedBoundingBox"]=a;kf["barycentricCoordinates"]=o;kf["binarySearch"]=s;kf["BingMapsApi"]=u;kf["BingMapsGeocoderService"]=l;kf["BoundingRectangle"]=c;kf["BoundingSphere"]=d;kf["BoxGeometry"]=f;kf["BoxOutlineGeometry"]=h;kf["buildModuleUrl"]=p;kf["cancelAnimationFrame"]=m;kf["Cartesian2"]=v;kf["Cartesian3"]=_;kf["Cartesian4"]=g;kf["Cartographic"]=y;kf["CartographicGeocoderService"]=w;kf["CatmullRomSpline"]=C;kf["CesiumTerrainProvider"]=b;kf["Check"]=S;kf["CircleGeometry"]=E;kf["CircleOutlineGeometry"]=T;kf["Clock"]=x;kf["ClockRange"]=A;kf["ClockStep"]=P;kf["clone"]=D;kf["Color"]=M;kf["ColorGeometryInstanceAttribute"]=I;kf["combine"]=O;kf["ComponentDatatype"]=R;kf["CompressedTextureBuffer"]=N;kf["CornerType"]=L;kf["CorridorGeometry"]=B;kf["CorridorGeometryLibrary"]=F;kf["CorridorOutlineGeometry"]=k;kf["createGuid"]=V;kf["Credit"]=z;kf["CubicRealPolynomial"]=U;kf["CylinderGeometry"]=q;kf["CylinderGeometryLibrary"]=G;kf["CylinderOutlineGeometry"]=H;kf["DefaultProxy"]=W;kf["defaultValue"]=j;kf["defined"]=Y;kf["defineProperties"]=X;kf["deprecationWarning"]=Z;kf["destroyObject"]=K;kf["DeveloperError"]=Q;kf["DistanceDisplayCondition"]=J;kf["DistanceDisplayConditionGeometryInstanceAttribute"]=$;kf["DoublyLinkedList"]=ee;kf["EarthOrientationParameters"]=te;kf["EarthOrientationParametersSample"]=re;kf["EasingFunction"]=ie;kf["EllipseGeometry"]=ne;kf["EllipseGeometryLibrary"]=ae;kf["EllipseOutlineGeometry"]=oe;kf["Ellipsoid"]=se;kf["EllipsoidalOccluder"]=ue;kf["EllipsoidGeodesic"]=le;kf["EllipsoidGeometry"]=ce;kf["EllipsoidOutlineGeometry"]=de;kf["EllipsoidTangentPlane"]=fe;kf["EllipsoidTerrainProvider"]=he;kf["EncodedCartesian3"]=pe;kf["Event"]=me;kf["EventHelper"]=ve;kf["ExtrapolationType"]=_e;kf["FeatureDetection"]=ge;kf["formatError"]=ye;kf["freezeObject"]=we;kf["Fullscreen"]=Ce;kf["GeocoderService"]=be;kf["GeographicProjection"]=Se;kf["GeographicTilingScheme"]=Ee;kf["Geometry"]=Te;kf["GeometryAttribute"]=xe;kf["GeometryAttributes"]=Ae;kf["GeometryInstance"]=Pe;kf["GeometryInstanceAttribute"]=De;kf["GeometryPipeline.bak"]=Me;kf["GeometryPipeline"]=Ie;kf["GeometryType"]=Oe;kf["getAbsoluteUri"]=Re;kf["getBaseUri"]=Ne;kf["getExtensionFromUri"]=Le;kf["getFilenameFromUri"]=Be;kf["getImagePixels"]=Fe;kf["getMagic"]=ke;kf["getStringFromTypedArray"]=Ve;kf["getTimestamp"]=ze;kf["GregorianDate"]=Ue;kf["HeadingPitchRange"]=qe;kf["HeadingPitchRoll"]=Ge;kf["HeightmapTerrainData"]=He;kf["HeightmapTessellator"]=We;kf["HermitePolynomialApproximation"]=je;kf["HermiteSpline"]=Ye;kf["Iau2000Orientation"]=Xe;kf["Iau2006XysData"]=Ze;kf["Iau2006XysSample"]=Ke;kf["IauOrientationAxes"]=Qe;kf["IauOrientationParameters"]=Je;kf["IndexDatatype"]=$e;kf["InterpolationAlgorithm"]=et;kf["Intersect"]=tt;kf["Intersections2D"]=rt;kf["IntersectionTests"]=it;kf["Interval"]=nt;kf["isArray"]=at;kf["isCrossOriginUrl"]=ot;kf["isDataUri"]=st;kf["isLeapYear"]=ut;kf["Iso8601"]=lt;kf["joinUrls"]=ct;kf["JulianDate"]=dt;kf["KeyboardEventModifier"]=ft;kf["LagrangePolynomialApproximation"]=ht;kf["LeapSecond"]=pt;kf["LinearApproximation"]=mt;kf["LinearSpline"]=vt;kf["loadArrayBuffer"]=_t;kf["loadBlob"]=gt;kf["loadCRN"]=yt;kf["loadImage"]=wt;kf["loadImageFromTypedArray"]=Ct;kf["loadImageViaBlob"]=bt;kf["loadJson"]=St;kf["loadJsonp"]=Et;kf["loadKTX"]=Tt;kf["loadText"]=xt;kf["loadWithXhr"]=At;kf["loadXML"]=Pt;kf["MapboxApi"]=Dt;kf["MapProjection"]=Mt;kf["Math"]=It;kf["Matrix2"]=Ot;kf["Matrix3"]=Rt;kf["Matrix4"]=Nt;kf["mergeSort"]=Lt;kf["NearFarScalar"]=Bt;kf["objectToQuery"]=Ft;kf["Occluder"]=kt;kf["oneTimeWarning"]=Vt;kf["OrientedBoundingBox"]=zt;kf["Packable"]=Ut;kf["PackableForInterpolation"]=qt;kf["parseResponseHeaders"]=Gt;kf["PinBuilder"]=Ht;kf["PixelFormat"]=Wt;kf["Plane"]=jt;kf["PointGeometry"]=Yt;kf["pointInsideTriangle"]=Xt;kf["PolygonGeometry"]=Zt;kf["PolygonGeometryLibrary"]=Kt;kf["PolygonHierarchy"]=Qt;kf["PolygonOutlineGeometry"]=Jt;kf["PolygonPipeline"]=$t;kf["PolylineGeometry"]=er;kf["PolylinePipeline"]=tr;kf["PolylineVolumeGeometry"]=rr;kf["PolylineVolumeGeometryLibrary"]=ir;kf["PolylineVolumeOutlineGeometry"]=nr;kf["PrimitiveType"]=ar;kf["QuadraticRealPolynomial"]=or;kf["QuantizedMeshTerrainData"]=sr;kf["QuarticRealPolynomial"]=ur;kf["Quaternion"]=lr;kf["QuaternionSpline"]=cr;kf["queryToObject"]=dr;kf["Queue"]=fr;kf["Ray"]=hr;kf["Rectangle"]=pr;kf["RectangleGeometry"]=mr;kf["RectangleGeometryLibrary"]=vr;kf["RectangleOutlineGeometry"]=_r;kf["ReferenceFrame"]=gr;kf["Request"]=yr;kf["requestAnimationFrame"]=wr;kf["RequestErrorEvent"]=Cr;kf["RequestScheduler"]=br;kf["RequestType"]=Sr;kf["RuntimeError"]=Er;kf["sampleTerrain"]=Tr;kf["sampleTerrainMostDetailed"]=xr;kf["scaleToGeodeticSurface"]=Ar;kf["ScreenSpaceEventHandler"]=Pr;kf["ScreenSpaceEventType"]=Dr;kf["ShowGeometryInstanceAttribute"]=Mr;kf["Simon1994PlanetaryPositions"]=Ir;kf["SimplePolylineGeometry"]=Or;kf["SphereGeometry"]=Rr;kf["SphereOutlineGeometry"]=Nr;kf["Spherical"]=Lr;kf["Spline"]=Br;kf["subdivideArray"]=Fr;kf["TaskProcessor"]=kr;kf["TerrainData"]=Vr;kf["TerrainEncoding"]=zr;kf["TerrainMesh"]=Ur;kf["TerrainProvider"]=qr;kf["TerrainQuantization"]=Gr;kf["TileAvailability"]=Hr;kf["TileProviderError"]=Wr;kf["TilingScheme"]=jr;kf["TimeConstants"]=Yr;kf["TimeInterval"]=Xr;kf["TimeIntervalCollection"]=Zr;kf["TimeStandard"]=Kr;kf["Tipsify"]=Qr;kf["Transforms"]=Jr;kf["TranslationRotationScale"]=$r;kf["TridiagonalSystemSolver"]=ei;kf["TrustedServers"]=ti;kf["VertexFormat"]=ri;kf["VideoSynchronizer"]=ii;kf["Visibility"]=ni;kf["VRTheWorldTerrainProvider"]=ai;kf["WallGeometry"]=oi;kf["WallGeometryLibrary"]=si;kf["WallOutlineGeometry"]=ui;kf["WebGLConstants"]=li;kf["WebMercatorProjection"]=ci;kf["WebMercatorTilingScheme"]=di;kf["WindingOrder"]=fi;kf["wrapFunction"]=hi;kf["writeTextToCanvas"]=pi;kf["BillboardGraphics"]=mi;kf["BillboardVisualizer"]=vi;kf["BoundingSphereState"]=_i;kf["BoxGeometryUpdater"]=gi;kf["BoxGraphics"]=yi;kf["CallbackProperty"]=wi;kf["CheckerboardMaterialProperty"]=Ci;kf["ColorMaterialProperty"]=bi;kf["CompositeEntityCollection"]=Si;kf["CompositeMaterialProperty"]=Ei;kf["CompositePositionProperty"]=Ti;kf["CompositeProperty"]=xi;kf["ConstantPositionProperty"]=Ai;kf["ConstantProperty"]=Pi;kf["CorridorGeometryUpdater"]=Di;kf["CorridorGraphics"]=Mi
;kf["createMaterialPropertyDescriptor"]=Ii;kf["createPropertyDescriptor"]=Oi;kf["createRawPropertyDescriptor"]=Ri;kf["CustomDataSource"]=Ni;kf["CylinderGeometryUpdater"]=Li;kf["CylinderGraphics"]=Bi;kf["CzmlDataSource"]=Fi;kf["DataSource"]=ki;kf["DataSourceClock"]=Vi;kf["DataSourceCollection"]=zi;kf["DataSourceDisplay"]=Ui;kf["dynamicGeometryGetBoundingSphere"]=qi;kf["DynamicGeometryUpdater"]=Gi;kf["EllipseGeometryUpdater"]=Hi;kf["EllipseGraphics"]=Wi;kf["EllipsoidGeometryUpdater"]=ji;kf["EllipsoidGraphics"]=Yi;kf["Entity"]=Xi;kf["EntityCluster"]=Zi;kf["EntityCollection"]=Ki;kf["EntityView"]=Qi;kf["GeoJsonDataSource"]=Ji;kf["GeometryUpdater"]=$i;kf["GeometryVisualizer"]=en;kf["GridMaterialProperty"]=tn;kf["ImageMaterialProperty"]=rn;kf["KmlDataSource"]=nn;kf["LabelGraphics"]=an;kf["LabelVisualizer"]=on;kf["MaterialProperty"]=sn;kf["ModelGraphics"]=un;kf["ModelVisualizer"]=ln;kf["NodeTransformationProperty"]=cn;kf["PathGraphics"]=dn;kf["PathVisualizer"]=fn;kf["PointGraphics"]=hn;kf["PointVisualizer"]=pn;kf["PolygonGeometryUpdater"]=mn;kf["PolygonGraphics"]=vn;kf["PolylineArrowMaterialProperty"]=_n;kf["PolylineGeometryUpdater"]=gn;kf["PolylineGlowMaterialProperty"]=yn;kf["PolylineGraphics"]=wn;kf["PolylineOutlineMaterialProperty"]=Cn;kf["PolylineVolumeGeometryUpdater"]=bn;kf["PolylineVolumeGraphics"]=Sn;kf["PositionProperty"]=En;kf["PositionPropertyArray"]=Tn;kf["Property"]=xn;kf["PropertyArray"]=An;kf["PropertyBag"]=Pn;kf["RectangleGeometryUpdater"]=Dn;kf["RectangleGraphics"]=Mn;kf["ReferenceProperty"]=In;kf["Rotation"]=On;kf["SampledPositionProperty"]=Rn;kf["SampledProperty"]=Nn;kf["ScaledPositionProperty"]=Ln;kf["StaticGeometryColorBatch"]=Bn;kf["StaticGeometryPerMaterialBatch"]=Fn;kf["StaticGroundGeometryColorBatch"]=kn;kf["StaticOutlineGeometryBatch"]=Vn;kf["StripeMaterialProperty"]=zn;kf["StripeOrientation"]=Un;kf["TimeIntervalCollectionPositionProperty"]=qn;kf["TimeIntervalCollectionProperty"]=Gn;kf["VelocityOrientationProperty"]=Hn;kf["VelocityVectorProperty"]=Wn;kf["Visualizer"]=jn;kf["WallGeometryUpdater"]=Yn;kf["WallGraphics"]=Xn;kf["AutomaticUniforms"]=Zn;kf["Buffer"]=Kn;kf["BufferUsage"]=Qn;kf["ClearCommand"]=Jn;kf["ComputeCommand"]=$n;kf["ComputeEngine"]=ea;kf["Context"]=ta;kf["ContextLimits"]=ra;kf["createUniform"]=ia;kf["createUniformArray"]=na;kf["CubeMap"]=aa;kf["CubeMapFace"]=oa;kf["DrawCommand"]=sa;kf["Framebuffer"]=ua;kf["loadCubeMap"]=la;kf["MipmapHint"]=ca;kf["Pass"]=da;kf["PassState"]=fa;kf["PickFramebuffer"]=ha;kf["PixelDatatype"]=pa;kf["Renderbuffer"]=ma;kf["RenderbufferFormat"]=va;kf["RenderState"]=_a;kf["Sampler"]=ga;kf["ShaderCache"]=ya;kf["ShaderProgram"]=wa;kf["ShaderSource"]=Ca;kf["Texture"]=ba;kf["TextureMagnificationFilter"]=Sa;kf["TextureMinificationFilter"]=Ea;kf["TextureWrap"]=Ta;kf["UniformState"]=xa;kf["VertexArray"]=Aa;kf["VertexArrayFacade"]=Pa;kf["Appearance"]=Da;kf["ArcGisMapServerImageryProvider"]=Ma;kf["Axis"]=Ia;kf["Batched3DModel3DTileContent"]=Oa;kf["BatchTable"]=Ra;kf["Billboard"]=Na;kf["BillboardCollection"]=La;kf["BingMapsImageryProvider"]=Ba;kf["BingMapsStyle"]=Fa;kf["BlendEquation"]=ka;kf["BlendFunction"]=Va;kf["BlendingState"]=za;kf["BlendOption"]=Ua;kf["Camera"]=qa;kf["CameraEventAggregator"]=Ga;kf["CameraEventType"]=Ha;kf["CameraFlightPath"]=Wa;kf["Cesium3DTile"]=ja;kf["Cesium3DTileBatchTable"]=Ya;kf["Cesium3DTileChildrenVisibility"]=Xa;kf["Cesium3DTileColorBlendMode"]=Za;kf["Cesium3DTileContent"]=Ka;kf["Cesium3DTileContentFactory"]=Qa;kf["Cesium3DTileContentState"]=Ja;kf["Cesium3DTileFeature"]=$a;kf["Cesium3DTileFeatureTable"]=eo;kf["Cesium3DTileOptimizationHint"]=to;kf["Cesium3DTileOptimizations"]=ro;kf["Cesium3DTileRefine"]=io;kf["Cesium3DTileset"]=no;kf["Cesium3DTileStyle"]=ao;kf["Cesium3DTileStyleEngine"]=oo;kf["ColorBlendMode"]=so;kf["Composite3DTileContent"]=uo;kf["ConditionsExpression"]=lo;kf["createOpenStreetMapImageryProvider"]=co;kf["createTangentSpaceDebugPrimitive"]=fo;kf["createTileMapServiceImageryProvider"]=ho;kf["CreditDisplay"]=po;kf["CullFace"]=mo;kf["CullingVolume"]=vo;kf["DebugAppearance"]=_o;kf["DebugCameraPrimitive"]=go;kf["DebugModelMatrixPrimitive"]=yo;kf["DepthFunction"]=wo;kf["DepthPlane"]=Co;kf["DeviceOrientationCameraController"]=bo;kf["DiscardMissingTileImagePolicy"]=So;kf["EllipsoidPrimitive"]=Eo;kf["EllipsoidSurfaceAppearance"]=To;kf["Empty3DTileContent"]=xo;kf["Expression"]=Ao;kf["ExpressionNodeType"]=Po;kf["Fog"]=Do;kf["FrameRateMonitor"]=Mo;kf["FrameState"]=Io;kf["FrustumCommands"]=Oo;kf["FXAA"]=Ro;kf["getAttributeOrUniformBySemantic"]=No;kf["getBinaryAccessor"]=Lo;kf["GetFeatureInfoFormat"]=Bo;kf["Globe"]=Fo;kf["GlobeDepth"]=ko;kf["GlobeSurfaceShaderSet"]=Vo;kf["GlobeSurfaceTile"]=zo;kf["GlobeSurfaceTileProvider"]=Uo;kf["GoogleEarthImageryProvider"]=qo;kf["GridImageryProvider"]=Go;kf["GroundPrimitive"]=Ho;kf["HeightReference"]=Wo;kf["HorizontalOrigin"]=jo;kf["Imagery"]=Yo;kf["ImageryLayer"]=Xo;kf["ImageryLayerCollection"]=Zo;kf["ImageryLayerFeatureInfo"]=Ko;kf["ImageryProvider"]=Qo;kf["ImagerySplitDirection"]=Jo;kf["ImageryState"]=$o;kf["Instanced3DModel3DTileContent"]=es;kf["JobScheduler"]=ts;kf["JobType"]=rs;kf["Label"]=is;kf["LabelCollection"]=ns;kf["LabelStyle"]=as;kf["MapboxImageryProvider"]=os;kf["MapMode2D"]=ss;kf["Material"]=us;kf["MaterialAppearance"]=ls;kf["Model"]=cs;kf["ModelAnimation"]=ds;kf["ModelAnimationCache"]=fs;kf["ModelAnimationCollection"]=hs;kf["ModelAnimationLoop"]=ps;kf["ModelAnimationState"]=ms;kf["ModelInstance"]=vs;kf["ModelInstanceCollection"]=_s;kf["ModelMaterial"]=gs;kf["modelMaterialsCommon"]=ys;kf["ModelMesh"]=ws;kf["ModelNode"]=Cs;kf["Moon"]=bs;kf["NeverTileDiscardPolicy"]=Ss;kf["OIT"]=Es;kf["OrthographicFrustum"]=Ts;kf["OrthographicOffCenterFrustum"]=xs;kf["PerformanceDisplay"]=As;kf["PerInstanceColorAppearance"]=Ps;kf["PerspectiveFrustum"]=Ds;kf["PerspectiveOffCenterFrustum"]=Ms;kf["PickDepth"]=Is;kf["PointAppearance"]=Os;kf["PointCloud3DTileContent"]=Rs;kf["PointPrimitive"]=Ns;kf["PointPrimitiveCollection"]=Ls;kf["Polyline"]=Bs;kf["PolylineCollection"]=Fs;kf["PolylineColorAppearance"]=ks;kf["PolylineMaterialAppearance"]=Vs;kf["Primitive"]=zs;kf["PrimitiveCollection"]=Us;kf["PrimitivePipeline"]=qs;kf["PrimitiveState"]=Gs;kf["QuadtreeOccluders"]=Hs;kf["QuadtreePrimitive"]=Ws;kf["QuadtreeTile"]=js;kf["QuadtreeTileLoadState"]=Ys;kf["QuadtreeTileProvider"]=Xs;kf["Scene"]=Zs;kf["SceneMode"]=Ks;kf["SceneTransforms"]=Qs;kf["SceneTransitioner"]=Js;kf["ScreenSpaceCameraController"]=$s;kf["ShadowMap"]=eu;kf["ShadowMapShader"]=tu;kf["ShadowMode"]=ru;kf["SingleTileImageryProvider"]=iu;kf["SkyAtmosphere"]=nu;kf["SkyBox"]=au;kf["StencilFunction"]=ou;kf["StencilOperation"]=su;kf["StyleExpression"]=uu;kf["Sun"]=lu;kf["SunPostProcess"]=cu;kf["TerrainState"]=du;kf["TextureAtlas"]=fu;kf["TileBoundingRegion"]=hu;kf["TileBoundingSphere"]=pu;kf["TileBoundingVolume"]=mu;kf["TileCoordinatesImageryProvider"]=vu;kf["TileDiscardPolicy"]=_u;kf["TileImagery"]=gu;kf["TileOrientedBoundingBox"]=yu;kf["TileReplacementQueue"]=wu;kf["Tileset3DTileContent"]=Cu;kf["TileState"]=bu;kf["TileTerrain"]=Su;kf["TweenCollection"]=Eu;kf["UrlTemplateImageryProvider"]=Tu;kf["VerticalOrigin"]=xu;kf["ViewportQuad"]=Au;kf["WebMapServiceImageryProvider"]=Pu;kf["WebMapTileServiceImageryProvider"]=Du;kf._shaders["AdjustTranslucentFS"]=Mu;kf._shaders["AllMaterialAppearanceFS"]=Iu;kf._shaders["AllMaterialAppearanceVS"]=Ou;kf._shaders["BasicMaterialAppearanceFS"]=Ru;kf._shaders["BasicMaterialAppearanceVS"]=Nu;kf._shaders["EllipsoidSurfaceAppearanceFS"]=Lu;kf._shaders["EllipsoidSurfaceAppearanceVS"]=Bu;kf._shaders["PerInstanceColorAppearanceFS"]=Fu;kf._shaders["PerInstanceColorAppearanceVS"]=ku;kf._shaders["PerInstanceFlatColorAppearanceFS"]=Vu;kf._shaders["PerInstanceFlatColorAppearanceVS"]=zu;kf._shaders["PointAppearanceFS"]=Uu;kf._shaders["PointAppearanceVS"]=qu;kf._shaders["PolylineColorAppearanceVS"]=Gu;kf._shaders["PolylineMaterialAppearanceVS"]=Hu;kf._shaders["TexturedMaterialAppearanceFS"]=Wu;kf._shaders["TexturedMaterialAppearanceVS"]=ju;kf._shaders["BillboardCollectionFS"]=Yu;kf._shaders["BillboardCollectionVS"]=Xu;kf._shaders["degreesPerRadian"]=Zu;kf._shaders["depthRange"]=Ku;kf._shaders["epsilon1"]=Qu;kf._shaders["epsilon2"]=Ju;kf._shaders["epsilon3"]=$u;kf._shaders["epsilon4"]=el;kf._shaders["epsilon5"]=tl;kf._shaders["epsilon6"]=rl;kf._shaders["epsilon7"]=il;kf._shaders["infinity"]=nl;kf._shaders["oneOverPi"]=al;kf._shaders["oneOverTwoPi"]=ol;kf._shaders["passCompute"]=sl;kf._shaders["passEnvironment"]=ul;kf._shaders["passGlobe"]=ll;kf._shaders["passGround"]=cl;kf._shaders["passOpaque"]=dl;kf._shaders["passOverlay"]=fl;kf._shaders["passTranslucent"]=hl;kf._shaders["pi"]=pl;kf._shaders["piOverFour"]=ml;kf._shaders["piOverSix"]=vl;kf._shaders["piOverThree"]=_l;kf._shaders["piOverTwo"]=gl;kf._shaders["radiansPerDegree"]=yl;kf._shaders["sceneMode2D"]=wl;kf._shaders["sceneMode3D"]=Cl;kf._shaders["sceneModeColumbusView"]=bl;kf._shaders["sceneModeMorphing"]=Sl;kf._shaders["solarRadius"]=El;kf._shaders["threePiOver2"]=Tl;kf._shaders["twoPi"]=xl;kf._shaders["webMercatorMaxLatitude"]=Al;kf._shaders["CzmBuiltins"]=Pl;kf._shaders["alphaWeight"]=Dl;kf._shaders["antialias"]=Ml;kf._shaders["cascadeColor"]=Il;kf._shaders["cascadeDistance"]=Ol;kf._shaders["cascadeMatrix"]=Rl;kf._shaders["cascadeWeights"]=Nl;kf._shaders["columbusViewMorph"]=Ll;kf._shaders["computePosition"]=Bl;kf._shaders["cosineAndSine"]=Fl;kf._shaders["decompressTextureCoordinates"]=kl;kf._shaders["eastNorthUpToEyeCoordinates"]=Vl;kf._shaders["ellipsoidContainsPoint"]=zl;kf._shaders["ellipsoidNew"]=Ul;kf._shaders["ellipsoidWgs84TextureCoordinates"]=ql;kf._shaders["equalsEpsilon"]=Gl;kf._shaders["eyeOffset"]=Hl;kf._shaders["eyeToWindowCoordinates"]=Wl;kf._shaders["fog"]=jl;kf._shaders["geodeticSurfaceNormal"]=Yl;kf._shaders["getDefaultMaterial"]=Xl;kf._shaders["getLambertDiffuse"]=Zl;kf._shaders["getSpecular"]=Kl;kf._shaders["getWaterNoise"]=Ql;kf._shaders["getWgs84EllipsoidEC"]=Jl;kf._shaders["HSBToRGB"]=$l;kf._shaders["HSLToRGB"]=ec;kf._shaders["hue"]=tc;kf._shaders["isEmpty"]=rc;kf._shaders["isFull"]=ic;kf._shaders["latitudeToWebMercatorFraction"]=nc;kf._shaders["luminance"]=ac;kf._shaders["metersPerPixel"]=oc;kf._shaders["modelToWindowCoordinates"]=sc;kf._shaders["multiplyWithColorBalance"]=uc;kf._shaders["nearFarScalar"]=lc;kf._shaders["octDecode"]=cc;kf._shaders["packDepth"]=dc;kf._shaders["phong"]=fc;kf._shaders["pointAlongRay"]=hc;kf._shaders["rayEllipsoidIntersectionInterval"]=pc;kf._shaders["RGBToHSB"]=mc;kf._shaders["RGBToHSL"]=vc;kf._shaders["RGBToXYZ"]=_c;kf._shaders["saturation"]=gc;kf._shaders["shadowDepthCompare"]=yc;kf._shaders["shadowVisibility"]=wc;kf._shaders["signNotZero"]=Cc;kf._shaders["tangentToEyeSpaceMatrix"]=bc;kf._shaders["translateRelativeToEye"]=Sc;kf._shaders["translucentPhong"]=Ec;kf._shaders["transpose"]=Tc;kf._shaders["unpackDepth"]=xc;kf._shaders["windowToEyeCoordinates"]=Ac;kf._shaders["XYZToRGB"]=Pc;kf._shaders["depthRangeStruct"]=Dc;kf._shaders["ellipsoid"]=Mc;kf._shaders["material"]=Ic;kf._shaders["materialInput"]=Oc;kf._shaders["ray"]=Rc;kf._shaders["raySegment"]=Nc;kf._shaders["shadowParameters"]=Lc;kf._shaders["CompositeOITFS"]=Bc;kf._shaders["DepthPlaneFS"]=Fc;kf._shaders["DepthPlaneVS"]=kc;kf._shaders["EllipsoidFS"]=Vc;kf._shaders["EllipsoidVS"]=zc;kf._shaders["GlobeFS"]=Uc;kf._shaders["GlobeVS"]=qc;kf._shaders["GroundAtmosphere"]=Gc;kf._shaders["BumpMapMaterial"]=Hc;kf._shaders["CheckerboardMaterial"]=Wc;kf._shaders["DotMaterial"]=jc;kf._shaders["FadeMaterial"]=Yc;kf._shaders["GridMaterial"]=Xc;kf._shaders["NormalMapMaterial"]=Zc;kf._shaders["PolylineArrowMaterial"]=Kc;kf._shaders["PolylineGlowMaterial"]=Qc;kf._shaders["PolylineOutlineMaterial"]=Jc;kf._shaders["RimLightingMaterial"]=$c;kf._shaders["StripeMaterial"]=ed;kf._shaders["Water"]=td;kf._shaders["PointPrimitiveCollectionFS"]=rd;kf._shaders["PointPrimitiveCollectionVS"]=id;kf._shaders["PolylineCommon"]=nd;kf._shaders["PolylineFS"]=ad;kf._shaders["PolylineVS"]=od;kf._shaders["AdditiveBlend"]=sd;kf._shaders["BrightPass"]=ud;kf._shaders["FXAA"]=ld;kf._shaders["GaussianBlur1D"]=cd;kf._shaders["PassThrough"]=dd;kf._shaders["ReprojectWebMercatorFS"]=fd;kf._shaders["ReprojectWebMercatorVS"]=hd;kf._shaders["ShadowVolumeFS"]=pd;kf._shaders["ShadowVolumeVS"]=md;kf._shaders["SkyAtmosphereFS"]=vd;kf._shaders["SkyAtmosphereVS"]=_d;kf._shaders["SkyBoxFS"]=gd;kf._shaders["SkyBoxVS"]=yd;kf._shaders["SunFS"]=wd;kf._shaders["SunTextureFS"]=Cd;kf._shaders["SunVS"]=bd;kf._shaders["ViewportQuadFS"]=Sd;kf._shaders["ViewportQuadVS"]=Ed;kf["Autolinker"]=Td;kf["crunch"]=xd;kf["earcut-2.1.1"]=Ad;kf["gltfDefaults"]=Pd;kf["jsep"]=Dd;kf["kdbush"]=Md;kf["knockout-3.4.0"]=Id;kf["knockout-es5"]=Od;kf["knockout"]=Rd;kf["measureText"]=Nd;kf["mersenne-twister"]=Ld;kf["NoSleep"]=Bd;kf["sprintf"]=Fd;kf["topojson"]=kd;kf["Tween"]=Vd;kf["Uri"]=zd;kf["when"]=Ud;kf["zip"]=qd;kf["Animation"]=Gd;kf["AnimationViewModel"]=Hd;kf["BaseLayerPicker"]=Wd;kf["BaseLayerPickerViewModel"]=jd;kf["createDefaultImageryProviderViewModels"]=Yd;kf["createDefaultTerrainProviderViewModels"]=Xd;kf["ProviderViewModel"]=Zd;kf["Cesium3DTilesInspector"]=Kd;kf["Cesium3DTilesInspectorViewModel"]=Qd;kf["CesiumInspector"]=Jd;kf["CesiumInspectorViewModel"]=$d;kf["CesiumWidget"]=ef;kf["ClockViewModel"]=tf;kf["Command"]=rf;kf["createCommand"]=nf;kf["FullscreenButton"]=af;kf["FullscreenButtonViewModel"]=of;kf["Geocoder"]=sf;kf["GeocoderViewModel"]=uf;kf["getElement"]=lf;kf["HomeButton"]=cf;kf["HomeButtonViewModel"]=df;kf["InfoBox"]=ff;kf["InfoBoxViewModel"]=hf;kf["NavigationHelpButton"]=pf;kf["NavigationHelpButtonViewModel"]=mf;kf["PerformanceWatchdog"]=vf;kf["PerformanceWatchdogViewModel"]=_f;kf["ProjectionPicker"]=gf;kf["ProjectionPickerViewModel"]=yf;kf["SceneModePicker"]=wf;kf["SceneModePickerViewModel"]=Cf;kf["SelectionIndicator"]=bf;kf["SelectionIndicatorViewModel"]=Sf;kf["subscribeAndEvaluate"]=Ef;kf["SvgPathBindingHandler"]=Tf;kf["Timeline"]=xf;kf["TimelineHighlightRange"]=Af;kf["TimelineTrack"]=Pf;kf["ToggleButtonViewModel"]=Df;kf["Viewer"]=Mf;kf["viewerCesium3DTilesInspectorMixin"]=If;kf["viewerCesiumInspectorMixin"]=Of;kf["viewerDragDropMixin"]=Rf;kf["viewerPerformanceWatchdogMixin"]=Nf;kf["VRButton"]=Lf;kf["VRButtonViewModel"]=Bf;kf["createTaskProcessorWorker"]=Ff;return kf});require(["Cesium"],function(e){"use strict";var t=typeof window!=="undefined"?window:typeof self!=="undefined"?self:{};t.Cesium=e},undefined,true)})();
